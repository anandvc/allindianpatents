<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/252037-motion-vector-calculation-method by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 13:35:24 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 252037:MOTION VECTOR CALCULATION METHOD</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">MOTION VECTOR CALCULATION METHOD</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>When a block (MB22) of which motion vector is referred to in the direct mode contains a plurality of motion vectors, 2 motion vectors MV23 and MV24, which are used for inter picture prediction of a target picture (P23) to be coded, are determined by scaling a value obtained from averaging the plurality of motion vectors or selecting one of the plurality of the motion vectors.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>DESCRIPTION<br>
MOTION VECTOR CALCULATION METHOD<br>
Technical Field<br>
The present invention relates to a moving picture coding method and a decoding method, and particularly to a prediction coding method referring to plural coded pictures proceeding in display order or plural coded pictures following in display order or plural pictures both preceding and following in display order.<br>
Background Art<br>
Generally, information volume is compressed by reducing redundancy in temporal and spatial directions for moving picture coding. Therefore, motion deriving and motion compensation are performed on block-to-block basis referring to a preceding or a following picture, and a coding is performed for a difference value between an obtained predictive picture and a current picture for inter picture prediction coding aimed at reducing a temporal redundancy.<br>
In a moving picture coding method H.26L, which is currently under standardization, a picture with only intra picture prediction coding (I picture), a picture for which inter picture prediction coding is performed referring to one picture (hereinafter P picture) and a picture for which inter picture prediction coding is performed referring to 2 pictures preceding in display order or 2 pictures following in display order or each one of pictures preceding and following in display order (hereinafter B picture) are proposed.<br>
Fig. 1 is at! illustration showing an example of a reference relation between each picture according to above-mentioned moving picture coding method and reference pictures.<br><br>
In picture II intra picture prediction coding is performed without a reference picture, and in picture PIO inter picture prediction coding is performed referring to a picture preceding in display order, P7. In a picture B6 inter picture prediction coding is performed referring to 2 pictures preceding in display order, in a picture B12 inter picture prediction coding is performed referring to 2 pictures following in display order and in a picture B18 inter picture prediction coding is performed referring to each one of pictures preceding and following in display order.<br>
A direct mode is one of prediction mode of bi-predictions which perform inter picture prediction coding referring to each of pictures preceding and following in display order. In the direct mode, motion vectors for a block to be coded are not coded in the bit stream directly, and 2 motion vectors for actual motion compensation are calculated referring to a motion vector of a co-located block in a coded picture close to the picture including the block to be coded in display order, and a predictive block is generated.<br>
Fig. 2 shows an example that a coded picture which is referred to in order to determine a motion vector in the direct mode contains a motion vector which refers to a preceding picture in display order. "P" indicated by a vertical line in Fig. 2 have nothing to do with a picture type and it shows a mere picture. In Fig. 2, for example, a picture P83, in which bi-prediction is performed referring to pictures P82 and P84 is a current target picture to be coded. If it is assumed that a block with coding in the picture P83 is a block MB81, a motion vector of the block MB81 is determined using a motion vector of a co-located block MB82 in the picture P84 which is a coded backward reference picture. Since the block MB82 contains only one motion vector MV81 as a motion vector, 2 motion vectors MV82 and MV83 to be obtained are calculated directly by applying a scaling to a motion vector MV81 and a time<br><br>
interval TR81 based on Equation 1 (a) and Equation 1 (b).<br>
MV82 = MV81/TR81 x TR82	Equation 1 (a)<br>
MV83 = -MV81/TR81 x TR83	Equation 1 (b)<br>
In these equations, the time interval TR81 shows an interval between the picture P84 and the picture P82, that is, a time interval between the picture P84 and a reference picture indicated by the motion vector MV81. The time interval TR82 shows a time interval between the picture P83 and a reference picture indicated by the motion vector MV82. The time interval TR83 shows a time interval between the picture P83 and a reference picture indicated by the motion vector MV83.<br>
The direct mode includes 2 methods, the temporal prediction already explained and the spatial prediction, and the spatial prediction is explained below. In the spatial prediction in the direct mode, for example, coding is performed on a macroblock of 16 X 16 pixels basis, and a motion vector, which is obtained referring to a picture closest from a target picture to be coded in display order, is selected from motion vectors in 3 macroblocks in the neighbor of the target macroblock to be coded, and the selected motion vector is a motion vector for the target macroblock to be coded. If 3 motion vectors refer to a same picture, a median value is selected. If 2 of 3 motion vectors refer to a picture closest from a target picture to be coded in display order, the remainder is considered as "0" vector, and a median value of these values is selected. If only 1 motion vector refers to a picture closest from a target picture to be coded in display order, this motion vector is selected. Thus a motion vector is not coded for a target macroblock to be coded in the direct mode, and motion prediction is performed using a motion vector contained in other macroblock. Fig. 3A is an illustration showing an example of motion vector predicting method in the case that a picture preceding in a B picture in display order is referred to using a conventional spatial<br><br>
predicting method in the direct mode. In this Fig. 3A, P indicates a P picture, B indicates a B picture and numbers assigned to picture types in right 4 pictures indicate an order in which each picture is coded. It should be assumed that a macrobiock diagonally shaded in a picture B4 is a target macrobiock to be coded. When a motion vector of a target macrobiock to be coded is calculated using a spatial predicting method in the direct mode, first, 3 coded macroblocks (area shaded with broken lines) are selected from the neighbor of the target macrobiock to be coded. Explanation of a method for selecting 3 neighbouring macroblocks is omitted here. Motion vectors in coded 3 macroblocks have been calculated and stored already. There is a case that the motion vector is obtained referring different pictures for each macrobiock even if macroblocks are in a same picture. Reference indices in reference pictures used for coding each macrobiock can show which picture is referred to by the 3 neighbouring macroblocks respectively from. Detail of reference indices will be explained later.<br>
Now, for example, it is assumed that 3 neighbouring macroblocks are selected for a target macrobiock to be coded shown in Fig. 3A, and motion vectors in each coded macrobiock are a motion vector a, b and c respectively. Here, it is assumed that the motion vector and the motion vector b are obtained referring to a P picture with a picture number 11 of "11", and the motion vector c is obtained referring to a P picture with the picture number 11 of "8". In this case, among these motion vectors, a, b, and c, the motion vectors a and b which refer to a picture closest to a target picture to be coded in order or display time are candidates for a motion vector of a target macrobiock to be coded. In this case, the motion vector c is considered as "0", and a median value of these 3 motion vectors a, b and c is selected and determined as a motion vector of the target macrobiock to be coded.<br>
However, a coding method such as MPEG-4 can  perform<br><br>
coding for each macroblock in a picture using a field structure and a frame structure. Therefore, in a coding method such as MPEG-4, there is a case that a macroblock coded in the field structure and a macroblock coded in the frame structure are mixed in one frame of reference frame. Even In such a case, if 3 macroblocks in the neighbor of a target macroblock to be coded are coded in the same structure as the target macroblock to be coded, it is possible to derive a motion vector of the target macroblock to be coded using the above-mentioned spatial predicting method in the direct mode without any problems. That is, a case that 3 neighbouring macroblocks are coded in the frame structure for a target macroblock to be coded in the frame structure, or a case that 3 neighbouring macroblocks are coded in the field structure for a target macroblock to be coded in the field structure. The former case is as already explained. In the latter case, by using 3 motion vectors corresponding to top fields of 3 neighbouring macroblocks for a top field of a target macroblock to be coded, and by using 3 motion vectors corresponding to bottom fields of 3 neighbouring macroblocks for a bottom field of the target macroblock to be coded, a motion vector of the target macroblock to be coded can be derived for the top field and the bottom field respectively using the above-mentioned method.<br>
However, in the temporal prediction method in the direct mode, since the above-mentioned block contains plural motion vectors for temporal prediction in the direct mode when in a block with intra picture prediction coding, motion compensation in the direct mode is performed, if a block of which motion vector Is referred to belongs to a B picture such as B6 shown in Fig. 1, a problem that a calculation of motion vector by a scaling based on Equation 1 can not be applied directly occurs. Furthermore, there is a case that precision of motion vector value (half pixel precision and    quarter    pixel    precision,    for   example)    does    not    meet<br><br>
predetermined   precision  since  dividing  operation   is  performed after the calculation of motion vector.<br>
When a target macroblock to be coded and one of neighbouring macroblocks are coded in a different structure for a spatial prediction, it is not specified which one of a field structure or a frame structure is used for coding the target macroblock to be coded, and a method for selecting a motion vector of the target macroblock to be coded from motion vectors of neighbouring macroblocks coded in both the field structure and the frame structure is not specified.<br>
The first object of the present invention is to offer a motion vector predicting method in temporal direction with high precision in the direct mode even if a block of which motion vector belongs to a B picture.<br>
The second object of the present invention is to offer a motion vector prediction method in spatial direction with high precision in the direct mode even if a block of which motion vector is referred to belongs to a B picture.<br>
Disclosure of Invention<br>
In order to achieve above object, a motion vector calculation method according to the present invention is a motion vector calculation method for inter picture prediction with reference to a plurality of pictures. The motion vector calculation method comprises a referring step for referring to a plurality of pictures preceding in display order or a plurality of pictures following in display order or a plurality of pictures both preceding and following in display order, and a motion compensating step, with reference to a motion vector of a co-located block in a picture other than a picture to vyhich an inter picture predictive block belongs when performing motion compensation of the inter picture predictive block, for calculating a motion vector of the inter picture predictive<br><br>
block using at least one motion vector, which satisfies a predetermined condition, among motion vectors already calculated for the co-located block of which motion vector is referred to. Therefore according to the motion vector calculation method of the present invention, when in a block with inter picture predictive coding motion compensation is performed referring to a motion vector of a co-located block in a coded other picture, and when a block of which motion vector is referred to contains a plurality of motion vectors, it is possible to actualize the motion compensation without contradiction by generating one motion vector used for scaling among the plurality of motion vectors.<br>
For the motion vector calculation method according to the present invention, in the reference step, each one of pictures selected from a first picture order and a second picture order can be referred to. Here the first picture order is the order in which identifying numbers are assigned to pictures in ascending sequence giving priority to a picture precedent in display order, and the second picture order is the order in which identifying numbers are assigned to pictures in ascending sequence giving priority to a picture following in display order. In the motion compensating step, a motion vector, which refers to a picture in the first picture order, of the block of which motion vector is referred to may be used. For the method, even if a block of which motion vector is referred to belongs to the B picture, the one used for the motion compensation of the block with inter picture prediction can be determined as a motion vector referring to a picture in the first picture order, and motion vector calculation method by scaling can be applied.<br>
Moreover, another motion vector calculation method according to the present invention includes an assigning step, a first selecting step and a deriving step. The assigning step is for assigning one of a first reference index or a second reference index<br><br>
to the coded picture. Here, the first reference index and the second reference index are used for selecting at lest one of a first reference picture or a second reference picture which are referred to when obtaining a block in a target picture to be coded by motion compensation from a plurality of coded pictures stored in a storing unit. The first selecting step is for selecting a motion vector indicating a median value of the motion vectors, when performing motion compensation of a block in the target picture to be coded, there are a plurality of motion vectors containing the first reference indices among motion vectors of blocks in the neighbor of the target picture to be coded. The deriving step is for deriving a motion vector referring to a picture preceding the target picture to be coded in display order or a picture following the target picture to be coded in display order or pictures preceding and following the target picture to be coded in display order using the motion vector selected in the first selecting step. Therefore, when motion compensation is performed for a block in the target picture to be coded and when there are a plurality of motion vectors containing the first reference index among motion vectors of blocks in the neighbor of the block in the target picture to be coded, the motion vector of the target picture to be coded can be derived using a motion vector indicating a median value of motion vectors.<br>
For the motion vector calculation method according to the present invention, a motion vector indicating a median value of the smallest first reference indices may be further selected from motion vectors containing the first reference indices in the first selecting step.<br>
Further Information about Technical Background to this Application Japanese Patent Application No. 2002 - 118598 filed April 19,<br>
2002:<br>
Japanese Patent Application No. 2002 - 121053 filed April 23,<br><br>
2002:<br>
Japanese Patent Application No. 2002 - 156266 filed May 29,<br>
2002:<br>
Japanese Patent Application No. 2002 - 177889 filed June 19,<br>
2002:<br>
Japanese Patent Application No. 2002 - 193027 filed July 2,<br>
2002:<br>
Japanese Patent Application No. 2002 - 204713 filed July 12,<br>
2002:<br>
Japanese Patent Application No. 2002 - 262151 filed September 6, 2002:<br>
Japanese Patent Application No. 2002 - 290542 filed October 2, 2002:<br>
Japanese Patent Application No. 2002 - 323096 filed November 6, 2002:<br>
Japanese Patent Application No. 60 / 378643 filed May 9, 2002:<br>
Japanese Patent Application No. 60 / 378954 filed May 10, 2002:<br>
, are incorporated herein by reference.<br>
Brief Description of Drawings<br>
These and other objects, advantages and features of the invention will become apparent from the following description thereof taken In conjunction with the accompanying drawings that illustrate a specific embodiment of the invention. In the Drawings:<br>
These and other subjects, advantages and features of the invention will become apparent from the following description thereof taken in conjunction with the accompanying drawings that illustrate a specific embodiment of the invention. In the Drawings:<br><br>
2002:<br>
Japanese Patent Application No. 2002 - 156266 filed May 29,<br>
2002:<br>
Japanese Patent Application No. 2002 - 177889 filed June 19,<br>
2002:<br>
Japanese Patent Application No. 2002 - 193027 filed July 1,<br>
2002:<br>
Japanese Patent Application No. 2002 - 204713 filed July 12,<br>
2002:<br>
Japanese Patent Application No. 2002 - 262151 filed September 6, 2002:<br>
Japanese Patent Application No. 2002 - 290542 filed October 2, 2002:<br>
Japanese Patent Application No. 2002 - 323096 filed November 6, 2002:<br>
Japanese Patent Application No. 60 / 378643 filed May 9, 2002:<br>
Japanese Patent Application No. 60 / 378954 filed May 10, 2002:<br>
, are incorporated herein by reference.<br>
Brief Description of Drawings<br>
These and other objects, advantages and features of the invention will become apparent from the following description thereof taken in conjunction with the accompanying drawings that illustrate a specific embodiment of the invention. In the Drawings:<br>
These and other subjects, advantages and features of the invention will become apparent from the following description thereof taken in conjunction with the accompanying drawings that illustrate a specific embodiment of the invention. In the Drawings:<br><br>
Fig. 1 is a schematic diagram showing a referential relation of pictures of a conventional example.<br>
Fig. 2 is a schematic diagram showing an operation in a conventional direct mode.<br>
Fig. 3A is an illustration showing an example of a motion vector predicting method when a temporally preceding picture is referred to in a B picture using a spatial predicting method of a conventional direct mode.<br>
Fig. 3B is an illustration showing an example of a reference list generated in each target picture to be coded.<br>
Fig. 4 is an explanatory illustration of picture numbers and reference indices.<br>
Fig. 5 is an illustration showing a concept of a picture coding signal format of a conventional picture coding apparatus.<br>
Fig. 6 is a block diagram showing an operation of coding according to the first and the second embodiments of this invention.<br>
Fig, 7 is a schematic diagram showing an operation when a block of which motion vector is referred to in the direct mode contains 2 motion vectors which refer to preceding time in display order.<br>
Fig. 8 is a schematic diagram comparing a referential relation of pictures in display order and coding order.<br>
Fig. 9 is a schematic diagram showing an operation when a block of which motion vector is referred to in the direct mode contains 2 motion vectors which refer to following time in display order.<br>
Fig. 10 is a schematic diagram comparing a referential relation of pictures in the display order and the coding order.<br>
Fig. 11 is a block diagram showing an operation of decoding according to the fifth and sixth embodiments of the present invention.<br><br>
Fig. 12 is a schematic diagram showing an operation when a block of which motion vector is referred to in the direct mode contains 2 motion vectors which refer to preceding time in display<br>
order.<br>
Fig, 13 is a schematic diagram to show an operation when a block of which motion vector is referred to in the direct mode contains 2 motion vectors which refer to following time in display<br>
order.<br>
Fig. 14 is a schematic diagram to show an operation when a block of which motion vector is referred to in the direct mode contains 2 motion vectors which refer to following time in display order.<br>
Fig. 15 is a schematic diagram to show an operation when a block of which motion vector is referred to in the direct mode contains 2 motion vectors which refer to preceding time in display order.<br>
Fig. 16 is a schematic diagram to show an operation when a block of which motion vector is referred to in the direct mode contains 2 motion vectors which refer to preceding time in display order.<br>
Fig. 17 is a schematic diagram to show an operation when a block of which motion vector is referred to in the direct mode contains 2 motion vectors which refer to preceding time in display order.<br>
Fig. 18 is a schematic diagram to show an operation when a block of which motion vector is referred to in the direct mode contains 2 motion vectors which refer to preceding time in display order.<br>
Fig. 19 is a schematic diagram to show an operation when a block of which motion vector is referred to in the direct mode contains 2 motion vectors which refer to following time in display order.<br><br>
Fig. 20 is a schematic diagram to show an operation when a block of which motion vector is referred to in the direct mode contains 2 motion vectors which refer to following time in display<br>
order.<br>
Fig. 21 is a schematic diagram to show an operation when a block of which motion vector is referred to in the direct mode contains 2 motion vectors which refer to following time in display order.<br>
Fig. 22 is a schematic diagram to show an operation when a block of which motion vector is referred to in the direct mode contains 2 motion vectors which refer to following time in display order.<br>
Fig. 23 is a schematic diagram to show an operation when a motion vector of a neighbouring block is referred to in the direct mode.<br>
Fig. 24 is an illustration showing a bit stream.<br>
Fig. 25 is an illustration showing a relation between a target block to be coded and a block in the neighbor of the target block to be coded.<br>
Fig. 26 is an illustration showing a motion vector contained in a block in the neighbor of a target block to be coded.<br>
Fig. 27 is an illustration showinga motion vector contained in a block in the neighbor of a target block to be coded.<br>
Fig. 28 is an illustration showing a motion vector contained in a block in the neighbor of a target block to be coded.<br>
Fig. 29 is an illustration showing a motion vector contained in a block in the neighbor of a target block to be coded.<br>
Fig. 30 is an illustration showing a motion vector contained in a block in the neighbor of a target block to be coded.<br>
Fig. 31 is an illustration showing a motion vector contained in a block in the neighbor of a target block to be coded.<br>
Fig. 32 is an illustration showing a motion vector contained<br><br>
in a block in the neighbor of a target block to be coded.<br>
Fig. 33 is an illustration showing a motion vector contained in a block in the neighbor of a target block to be coded.<br>
Fig. 34 is an illustration showing a procedure for determining a motion vector to be used in the direct mode.<br>
Fig. 35 is an illustration showing a relation between a target block to be coded and a block in the neighbor of the target block to be coded.<br>
Fig. 36 is an illustration showing a procedure for determining a motion vector of a target block to be coded using a value of a reference index.<br>
Fig. 37 is an illustration showing bi-prediction in the direct mode when a motion vector referring to a picture stored in a long term picture buffer is only one.<br>
Fig. 38 is an illustration showing bi- prediction in the direct mode when motion vectors referring to a picture stored in the long term picture buffer are 2.<br>
Fig. 39 is an illustration showing a process flow of a motion vector calculation method.<br>
Fig. 40 is a block diagram showing a configuration of a moving picture coding apparatus 100 according to the eleventh embodiment of the present invention.<br>
Fig. 41A is an illustration showing an order of flames inputted into the moving picture coding apparatus 100 in order of time on picture-to-picture basis.<br>
Fig. 41B is an illustration showing the case that the order of flames shown in Fig. 41A is reordered in the coding order.<br>
Fig. 42 is an illustration showing a structure of a reference picture list to explain the first embodiment.<br>
Fig. 43A is a flow chart showing an example of a motion vector calculation procedure using a spatial predicting method in the direct mode when a macroblock pair to be coded in a field<br><br>
structure and a macroblock pair to be coded in a frame structure<br>
are mixed.<br>
Fig. 43B is an illustration showing an example of a location of neighbouring macroblock pairs to which the present invention is applied when a target macroblock pair to be coded is coded in a frame structure.<br>
Fig. 43C is an illustration showing an example of location of neighbouring macroblock pairs to which the present invention is applied when a target macroblock pair to be coded is coded in a field structure.<br>
Fig. 44 Is an illustration showing a data configuration of a macroblock pair when coding is performed in a frame structure, and a data configuration of a macroblock pair when coding is performed in a field structure.<br>
Fig. 45 is a flow chart showing a detailed processing procedure in a step S302 shown in Fig. 43.<br>
Fig. 46 is an indicator chart showing a relation between reference field indices and reference frame indices.<br>
Fig. 47 is a flow chart showing a detailed processing procedure in a step S303 shown in Fig. 43.<br>
Fig. 48 is an illustration showing a relation of position between a target macroblock pair to be coded and neighbouring macroblock pairs in order to explain the first embodiment.<br>
Fig. 49 Is an illustration showing a positional relation between a target macroblock pair to be coded and neighbouring macroblock pairs In order to explain the first embodiment.<br>
Fig. 50 is an Illustration showing an example of a data configuration of a bit stream 700 generated by a bit stream generating unit 104.<br>
Fig. 51 Is a block diagram showing a configuration of a moving picture decoding apparatus 800 which decodes the bit stream 700 shown in Fig. 50.<br><br>
Fig. 52A is an illustration showing an example of a physical format of a flexible disk which is a body of a storage medium.<br>
Fig. 52B is an illustration showing an external view of the flexible disk viewed from the front, a configuration of the section and the flexible disk.<br>
Fig. 52C is an illustration showing a configuration to record and read the above-mentioned program on a flexible disk, FD.<br>
Fig. 53 is a block diagram showing an entire configuration of contents supply system implementing a contents delivery service.<br>
Fig. 54 is an illustration showing an example of an appearance of a cell phone.<br>
Fig. 55 is a block diagram showing a configuration of the cell phone.<br>
Fig. 56 is an illustration to show a device performing the coding or the decoding process shown in above embodiments and a system using the device.<br>
Best Mode for Carrying Out the Invention<br>
The present invention is to solve problems of the conventional technology, and aims at proposing a moving picture coding method and a decoding method which can determine a motion vector used for motion compensation without contradiction even if a block of which motion vector is referred to in a direct mode Is a B picture.    First, reference indices are explained here.<br>
Fig. 3B Is an Illustration showing an example of a reference picture list 10 generated for each target picture to be coded. In the reference picture list 10 shown in Fig. 3B, pictures are shown preceding and following a B picture in display order with one B picture at the center, and pictures to which the B picture can refer, picture types, a picture number 11, the first reference index 12 and the second reference index 13 are shown. The picture number 11 Is, for example, a number showing an order in which each picture<br><br>
is coded. The first reference index 12 is the first index showing a relative positional relation between a target picture to be coded and neighbouring pictures, and, for example, is used mainly as an index when a target picture to be coded refers to a picture preceding in display order. A list of the first reference index 12 is called a "reference index listO (listO)" or "the first reference index list ". Moreover, the reference index is called a relative index. First, in the reference picture list 10 shown in Fig. 3B, integer which is advanced by "1" is assigned to a value of the first reference index 12 from "0" from the closest to a target picture to be coded in a time sequence for a reference picture preceding a target picture to be coded in display order. Next, after a value advanced by "1" from "0" is assigned to all reference pictures following a target picture to be coded in display order, following values are assigned to reference pictures following the target picture to be coded in display order from closest to the target picture to be coded in display order.<br>
The second reference index 13 is the second index showing a relative positional relation between a target picture to be coded and neighbouring pictures, and, for example, is used mainly as an index when a target picture to be coded refers to a picture following in display order. A list of the second reference index 13 is called "reference index listl (listl)" or "the second reference index list". First, integer which is advanced by "1" is assigned to a value of the second reference index 13 is from "0" from the closest to a target picture to be coded in display order. Next, after a value advanced by "1" from "0" is assigned to all reference pictures following a target picture to be coded in display order, following values are assigned to reference pictures preceding a target picture to be coded in display order from the closest value to a target picture to be coded in display order. Therefore, it is found in the reference picture list 10 that as for the first reference index<br><br>
12 and the second reference index, a reference picture with smaller reference index value is closer to the target picture to be coded in display order. A method for assigning a reference index number in initial state of is explained above, however, the method for assigning a reference index number can be changed on a picture-by-picture basis or a slice-by-slice basis. In the method for assigning a reference index number is, for example, a small number may be assigned to a picture far in display order, however, such a reference index is used, for example, when coding efficiency is improved by referring to the picture far in display order. In other words, since reference indices in a block are presented by variable length code words and data with shorter lengths are assigned to the indices of the smaller values, by assigning smaller reference index to the reference picture which improves coding efficiency if it is referred to, the amount of codes in reference indices is reduced and further coding efficiency is improved.<br>
Fig. 4 is an explanatory illustration for picture numbers and reference indices. Fig. 4 shows an example of the reference picture list, and shows a reference picture, a picture number and a reference index used when coding the B picture at the center (indicated by a broken line). Fig. 4A shows the case assigning reference indices by the method for assigning reference indices in initial state explained using Fig. 3.<br>
Fig. 5 is a conceptual diagram of a picture coding signal format of a conventional picture coding apparatus. Picture indicates a coding signal for one picture. Header indicates a header coding signal included in the head of a picture, Blockl indicates a coding signal in a block coded in a direct mode, Block2 indicates a coding signal in a block coded by an interpolation prediction other than the direct mode, RidxO and Ridxl are the first reference index and the second reference index respectively, and MVO and MVl are the first motion vector and the second motion vector respectively.<br><br>
The coded block Block2 has 2 reference indices RidxO and Ridxl in a coding signal in this order for indicating 2 reference pictures to be used for motion compensation. Moreover, the first motion vector MVl and the second motion vector I^V2 are coded in the coding signal of the coded block Block2 in this order. It can be judged by PredType that which of the reference indices RidxO and/or Ridxl is used. A picture (the first reference picture) referred to by the first motion vector MVO is indicated by the first reference index RidxO, and a picture (the second reference picture) referred to by the second motion vector MVl is indicated by the second reference index Ridxl. For example, when it is indicated that pictures are referred to bi-directionally by the motion vectors MVO and MVl, RidxO and Ridxl are used, when it is indicated that pictures are referred to unit-directionally by one of motion vector MVO or MVl, one of RidxO or Ridxl corresponding to the motion vector is used, and when the direct mode is indicated, neither RidxO nor Ridxl are used. The first reference picture is specified by the first reference index and generally has display time preceding a target picture to be coded, and the second reference picture is specified by the second reference index and generally has display time following the target picture to be coded. However, as the method for assigning reference indices in Fig. 4 shows, there is a case that the first reference picture contains display time following the target picture to be coded and the second reference picture contains display time preceding the target picture to be coded. The first reference index RidxO is a reference index indicating the first reference picture referred to by the first motion vector MVO of the block Block2, and the second reference index Ridxl is a reference index indicating the second reference picture referred to by the second motion vector MVl of the block Block2.<br>
On the other hand, an assignment of reference pictures to reference indices can be changed arbitrarily by indicating explicitly<br><br>
using a memory control signal in a coded signal (RPSL in Header in Fig. 5). This makes it possible to change the reference picture with the second reference index "0" to an arbitrary reference picture. For example, as shown in Fig. 4B, assignment of reference indices to picture numbers can be changed.<br>
Thus, since assignment of reference picture to reference indices can be changed arbitrarily and the change of the assignment of reference pictures to reference indices generally assigns a smaller reference index to a picture which improves coding efficiency if selected as a reference picture, coding efficiency can be improved by using a motion vector, which refers to a picture of which reference index is the smallest, as a motion vector used in the direct mode.<br>
(First Embodiment)<br>
A moving picture coding method according to the first embodiment of the present invention is explained using the block diagram shown in Fig. 6.<br>
A target moving picture to be coded is inputted into a frame memory 101 in display order on picture-to-picture basis, and reordered in coding order. Each picture is divided into a group called a block, which is 16 (horizontal) x 16 (vertical) pixels in size, for example, and following processes are performed on block-to-block basis.<br>
A block read from the frame memory 101 is inputted into a motion vector detecting unit 106. Here, a motion vector of a target block to be coded is detected using a decoded picture of a coded picture stored in the frame memory 105 as a reference picture. In this case, in a mode selecting unit 107, an optimum prediction mode is determined with reference to a motion vector obtained in the motion vector detecting unit 106 and a motion vector used in a coded picture stored in a motion vector storing<br><br>
unit 108. A prediction mode obtained in the mode selecting unit 107 and a motion vector used in the obtained mode are inputted to a difference calculating unit 109, and a predictive residual picture is generated by calculating difference from a target block to be coded, and coding is performed in a predictive residual coding unit 102. Moreover, the motion vector used in the mode obtained in the mode selecting unit 107 is stored in a motion vector storing unit 108 in order to use for coding following blocks and pictures. Above processing flow is an operation when an inter picture prediction coding is selected, however, a switch 111 switches to an intra picture prediction coding. Eventually, variable length coding is performed for control information, such as a motion vector, and picture information, such as picture information outputted from the predictive residual coding unit 102, and a bit stream outputted eventually is generated by a bit stream generating unit 103.<br>
A summary of coding flow is explained above, however, detail of process in the motion vector detecting unit 106 and the mode selecting unit 107 is explained below.<br>
Motion vector detecting is performed on block-by-block basis or area-by-area (area is a divided block) basis. Using coded pictures preceding and following a target picture to be coded in display order as reference pictures, a predictive picture and a prediction mode showing a location which is predicted optimum in the search area in the picture is generated by deciding a motion vector.<br>
A direct mode is one of bi-predictions which perform inter picture prediction coding prediction referring to 2 pictures preceding and/or following in display order. In the direct mode, a target block to be coded does not contain a motion vector directly, and 2 motion vectors for actual motion compensation are calculated referring to a motion vector of a co-located block in a coded  picture close in display order,  and a  predictive block is<br><br>
generated.<br>
Fig. 7 shows an operation when a coded block referred to in order to determine a motion vector in the direct mode contains 2 motion vectors which refer to 2 pictures preceding in display order. A picture P23 is a current target picture to be coded, and performs bi-prediction referring to pictures P22 and P24. Assuming that a block to be coded is a block MB21, 2 required motion vectors are determined using a motion vector contained in a block MB22, which is a co-located block in the coded following reference picture (the second reference picture specified by the second reference index) P24. Since the block MB22 contains motion vectors MV21 and MV22 as a motion vector, it is impossible to calculate 2 required motion vectors M\/23 and MV24 by scaling directly similarly to Equation 1. Therefore, similarly to Equation 2 shows, a motion vector MV_REF is calculated as a motion vector to be scaled from an average value of 2 motion vectors contained in the block MB22, and a time interval TR_REF at that time is calculated from the average value likewise. Then motion vectors MV23 and MV24 are calculated by scaling the motion vector MV_REF and the time interval TR_REF based on Equation 3. In this case, the time interval TR21 indicates a time interval between the picture P24 and the picture P21, that is, a picture referred to by the motion vector MV21, and the time interval TR22 indicates a time interval until a picture referred to by the motion vector MV22. Moreover, the time interval TR23 is a time interval until a picture referred to by the motion vector MV23, and the time interval TR24 is a time interval until a picture referred to by the motion vector MV24. Time intervals between these pictures can be determined based on, for example, information indicating display time and display order added to each picture or difference of information. Note that a target picture to be coded refers to a next picture in the example of Fig. 7, however, the case referring to a picture which is not next<br><br>
may be treated in the same manner.<br>
MV_REF = (MV21 + MV22)/2	.... Equation 2 (a)<br>
TR_REF = (TR21 + TR22)/2	.... Equation 2 (b)<br>
MV23 = MV_REF/TR_REF x TR23	.... Equation 3 (a)<br>
MV24 = -MV_REF/TR_REF x TR24	.... Equation 3 (b)<br>
The above embodiment shows the coding method in which an inter picture prediction coding can be performed using the direct mode without contradiction even if a block of which motion vector is referred to in the direct mode belongs to a B picture. In the coding method, when a block of which motion vector is referred to in the direct mode contains plural motion vectors which refer to a picture preceding in display order, one motion vector is generated using the plural motion vectors, and 2 motion vectors to be used for actual motion compensation are determined by scaling.<br>
Note that when 2 motion vectors MV23 and MV24 in Fig. 7<br>
are calculated, it is possible to use Equation 4 instead of Equation<br>
2 as a method for averaging motion vectors MV21 and MV22, and<br>
for averaging time intervals TR21 and TR22 in order to calculate<br>
the motion vector MV_REF and the time interval TR_REF to be<br>
scaled.    First, as Equation 4 (a) shows, the motion vector MV21' is<br>
calculated by scaling MV21 to equate the time interval with the<br>
motion vector MV22.    Then the motion vector MV_REF is<br>
determined by averaging motion vectors MV21' and MV22.    Here,<br>
the time interval TR22 is used directly as the time interval TR_RF.<br>
Note that the case calculating a motion vector MV22' by scaling the<br>
motion vector MV22 instead of calculating the motion vector MV21'<br>
by scaling a motion vector MV21 may be treated in the same<br>
manner.<br>
MV21' = MV21/TR21 x TR22	.... Equation 4 (a)<br>
MV_RF = (MV21' + MV22)/2	.... Equation 4 (b)<br>
TR_REF = TR22	.... Equation 4 (c)<br>
Note that when 2 motion vectors MV23 and MV24 in Fig. 7<br><br>
are calculated, as a motion vector MV_REF and a time interval TR_REF which are scaled, a motion vector MV22 and a time interval TR22, which refer to a picture P22 located temporally closer to a picture P24 of which motion vector is referred to, can be directly used as Equation 5 shows instead of using an average value of 2 motion vectors as Equation 2 shows. Likewise, as a motion vector MV_REF and a time interval TR_REF, a motion vector MV21 and a time interval TR21, which refer to a picture P21 located temporally farther, can be directly used as Equation 6 shows. This makes it possible to reduce capacity of a motion vector storing unit in a coding apparatus since each block belonging to a picture P24 of which motion vector is referred to can perform motion compensation by storing only one of 2 motion vectors.<br>
MV_REF = MV22	.... Equation 5 (a)<br>
TR_REF = TR22	.... Equation 5 (b)<br>
MV_REF =MV21	.... Equation 6 (a)<br>
TR_REF = TR21	.... Equation 6 (b)<br>
Note that when 2 motion vectors MV23 and MV24 in Fig. 7 are calculated, as a motion vector MV_REF and a time interval TR_REF which are scaled, a motion vector which refers to a picture to be coded precedently can be directly used instead of using an average value of 2 motion vectors as Equation 2 shows. Fig. 8A shows a reference relation in display order of moving pictures as Fig. 7 shows, and Fig. 8B shows an example of an order in which pictures are reordered by coding order in the frame memory 101 shown in Fig. 6. Here, a picture P23 indicates a picture to be coded in the direct mode, and a picture P24 indicates a picture of which motion vector is referred to for the coding. When pictures are reordered as shown in Fig. SB, since a motion vector which refers to a picture to be coded precedently is directly used, a motion vector MV22 and a time interval TR22 are directly used as a motion vector MV_REF and a time interval TR_REF as shown in<br><br>
Equation 5. Likewise, it is possible to directly use a motion vector \Which refers to a picture to be coded later. In this case, a motion vector MV21 and a time interval TR21 are directly applied as a motion vector M\/_REF and a time interval TR_REF as Equation 6 shows. This make it possible to reduce capacity of a motion vector storing unit in a coding apparatus since each block belonging to a picture P24 of which motion vector is referred to can perform motion compensation by storing only one of 2 motion vectors.<br>
Note that in this embodiment, the case that a motion vector used in the direct mode is calculated by scaling a referenced motion vector using a time interval between pictures is explained, however, the motion vector may be calculated by multiplying by a constant number. Here, a constant used for the multiplication may be variable when coding or decoding is performed on plural blocks basis or on plural pictures basis.<br>
Note that in Equation 2 (a) or 4 (b), when a motion vector MV_REF is calculated, after calculating the right side of Equation 2 (a) or 4 (b), the motion vector may be rounded to a predetermined motion vector precision (for example, round to a value of 0.5 pixel unit for a motion vector with half pixel precision). Precision of a motion vector is not limited to half pixel precision. In addition, precision of a motion vector can be determined on block basis, picture basis, and sequence basis, for example. Moreover, in Equations, 3 (a), 3 (b) and 4 (a), when motion vectors MV23, MV24 and MV21' are calculated, motion vectors may be rounded to a predetermined precision of a motion vector after calculating the right side of Equations 3 (a), 3 (b) and 4 (a).<br>
(Second Embodiment)<br>
An overview of coding process based on Fig. 6 is completely equal to the first embodiment. Here, a detailed operation of bi-prediction in the direct mode is explained using Fig. 9.<br><br>
Fig. 9 shows an operation when a block referred to in order to determine a motion vector in the direct mode contains 2 motion vectors which refer to following 2 pictures in display order. A picture P43 is a current target picture to be coded, and performs bi-prediction referring to pictures P42 and P44. If it is assumed that a block to be coded is a block MB41, 2 required motion vectors are determined using a motion vector of a co-located block MB42 in the coded backward reference picture (the second reference picture specified by the second reference index) P44. Since the block MB42 contains 2 motion vectors MV45 and MV46 as motion vectors, 2 required motion vectors MV43 and M\/44 cannot be calculated by applying directly scaling similarly to Equation 1. Therefore, as Equation 7, a motion vector MV_REF is determined as a motion vector to be scaled from an average value of 2 motion vectors of the block MB42, and a time interval TR_REF at that time is determined from an average value likewise. Then motion vectors MV43 and MV44 are calculated by scaling a motion vector MV_REF and a time Interval TR_REF based on Equation 8. In this case, a time interval TR45 indicates a time interval between a picture P44 and P45, that is, until a picture which is referred to by a motion vector MV45, and a time interval TR46 indicates a time interval until a picture which is referred to by a motion vector MV46. A time interval TR43 indicates a time interval until a picture which is referred to by a motion vector MV43, and a time interval TR44 indicates a time interval until a picture which is referred to by a motion vector MV44. Time intervals between these pictures can be determined based on, for example, information indicating display time and display order added to each picture or difference of information as explained in the first embodiment. Note that a target picture to be coded refers to a next picture in the example of Fig. 9, however, the case referring to a picture which is not next may be treated in the same manner.<br><br>
MV_REF = (MV45 + MV46)/2	.... Equation 7 (a)<br>
TR_REF = (TR45 + TR46)/2	.... Equation 7 (b)<br>
MV43 = -MV_REF/TR_REF x TR43	.... Equation 8 (a)<br>
MV44 = MV_REF/TR_REF x TR44	.... Equation 8 (b)<br>
The above embodiment shows the coding method in which an inter picture prediction coding can be performed using the direct mode without contradiction even if a block of which motion vector is referred to in the direct hiode belongs to a B picture. In the coding method, when a block of which motion vector is referred to in the direct mode contains plural motion vectors which refer to a following picture in display order, a motion vector is generated using the plural motion vectors, and 2 motion vectors to be used for actual motion compensation are determined by scaling.<br>
Note that when 2 motion vectors M\/43 and MV44 in Fig. 9 are calculated, it is possible to use Equation 9 instead of Equation 7 as a method for averaging motion vectors MV45 and MV46 and for averaging time intervals TR45 and TR46 in order to calculate the motion vector MV_REF and the time interval TR_REF to be scaled. First, as Equation 9 (a) shows, the motion vector MV46' is calculated by scaling MV46 to equate the time interval with the motion vector MV45. Then the motion vector MV_REF is determined by averaging motion vectors MV46' and MV45. Here, the time interval TR41 is used directly as the time interval TR_REF. Note that the case calculating a motion vector MV45' by scaling the motion vector MV45 instead of calculating the motion vector MV46' by scaling a motion vector MV46 may be treated in the same manner.<br>
MV46' = MV46/TR46 x TR45	.... Equation 9 (a)<br>
MV_REF = (MV46' + MV45)/2	.... Equation 9 (b)<br>
TR_REF = TR45	.... Equation 9 (c)<br>
Note that when 2 motion vectors MV43 and MV44 in Fig. 9 are calculated, as a motion vector MV_REF and a time interval<br><br>
TR_REF which are scaled, a motion vector M\/45 and a time interval TR45, which refer to a picture P45 located temporally closer to a picture P44 of which motion vector is referred to, can be directly used as Equation 10 shows instead of using an average value of 2 motion vectors as Equation 7 shows. Likewise, as a motion vector MV_REF and a time interval TR_REF, a motion vector MV46 and a time interval TR46, which refer to a picture P46 located temporally farther can be directly used as Equation 11 shows. This method makes it possible to reduce capacity of a motion vector storing unit in a coding apparatus since each block belonging to a picture P44 of which motion vector is referred to can implement motion compensation by storing only one of 2 motion vectors.<br>
MV_REF = MV45	.... Equation 10 (a)<br>
TR_REF = TR45	.... Equation 10 (b)<br>
MV_REF = MV46	.... Equation 11 (a)<br>
TR_REF = TR46	.... Equation 11 (b)<br>
Note that when 2 motion vectors MV43 and M\/44 in Fig. 9<br>
are calculated, as a motion vector MV_REF and a time interval<br>
TR_REF which are scaled, a motion vector which refers to a picture<br>
to be coded precedently can be directly used instead of using an<br>
average value of 2 motion vectors as Equation 7 shows.    Fig. lOA<br>
shows a referential relation of pictures in display order of moving<br>
pictures as Fig. 9 shows, and Fig. lOB shows an example of an<br>
order in which pictures are reordered in coding order in the frame<br>
memory 101 shown in Fig. 6.    Here, a  picture P43 indicates a<br>
picture to be coded in the direct mode, and a picture P44 indicates<br>
a picture of which motion vector is referred to for the coding.<br>
When pictures are reordered as shown in Fig. lOB, since a motion<br>
vector which refers to a picture to be coded precedently is directly<br>
used, a motion vector MV46 and a time interval TR46 are directly<br>
used as a motion vector MV_REF and a time interval TR_REF as<br>
shown in Equation 11.    Likewise, it is possible to directly use a<br><br>
motion vector which refers to a picture to be coded later. In this case, a motion vector MV45 and a time interval TR45 are directly applied as a motion vector MV_REF and a time interval TR_REF. This method makes it possible to reduce capacity of a motion vector storing unit in a coding apparatus since each block belonging to a picture P44 of which motion vector is referred to can perform motion compensation by storing only one of 2 motion vectors.<br>
Note that when a picture which is referred to in order to determine a motion vector in the direct mode contains 2 motion vectors which refer to 2 following pictures in display order, it is possible to perform motion compensation assuming that 2 required motion vectors MV43 and MV44 are "0". This method makes it possible to reduce capacity of a motion vector storing unit in a decoding apparatus, and further makes it possible to omit a process of calculating a motion vector, since each block belonging to a picture P44 of which motion vector is referred to does not have to store a motion vector.<br>
Note that when a picture which is referred to in order to determine a motion vector in the direct mode contains 2 motion vectors which refer to 2 following pictures in display order, it is possible to inhibit referring to a motion vector and to apply only a prediction coding other than the direct mode. When following 2 pictures in display order are referred to as a picture P44 shown in Fig. 9, since it is conceivable that correlation with a preceding picture in display order is low, it is possible to generate a more precise predictive picture by inhibiting the direct mode and selecting other predicting method.<br>
Note that in this embodiment, the case that a motion vector used in the direct mode is calculated by scaling a referenced motion vector using a time interval between pictures is explained, however, the motion vector may be calculated by multiplying by a<br><br>
constant number. Here, a constant used for the multiplication may be variable when coding or decoding is performed on plural blocks basis or on plural pictures basis.<br>
Note that in Equation 7 (a) or 9 (b), when a motion vector MV_REF is calculated, after calculating the right side of Equation 7<br>
(a)	or 9 (b), the motion vector may be rounded to a predetermined motion vector precision. Precision of a motion vector includes half pixel precision, one-third pixel precision and quarter pixel precision or the like. In addition, the precision of a motion vector can be determined, for example, on block basis, picture basis, and sequence basis. Moreover, in Equations, 8 (a), 8 (b) and 9 (a), when motion vectors MV43, MV44 and MV46' are calculated, motion vectors may be rounded to a predetermined precision of a motion vector after calculating the right side of Equations 8 (a), 8<br>
(b)	and 9 (a).<br>
(Third Embodiment)<br>
A moving picture decoding method according to the third embodiment of the present invention is explained using the block diagram shown in Fig. 11. However, it is assumed that the bit stream generated in the picture coding method of the first embodiment is inputted.<br>
First, various information such as a prediction mode, motion vector information and predictive residual coding data is extracted from inputted bit stream by a bit stream analyzer 601.<br>
The prediction mode and the motion vector information are outputted to a prediction mode / motion vector decoding unit 608, and a predictive residual coding data is outputted to a predictive residual decoding unit 602. The prediction mode / motion compensation decoding unit 608 decodes the prediction mode and a motion vector used in the prediction mode. When decoding the motion vector, a decoded motion vector stored in the<br><br>
motion vector storing unit 605 is used. Decoded prediction mode<br>
and motion vector are outputted to a motion compensation<br>
decoding unit 604. In addition, decoded motion vector is stored in<br>
the motion vector storing unit 605 in order to be used for decoding<br>
motion vectors of following blocks. In the motion compensation<br>
decoding unit 604, a predictive picture is generated based on the<br>
inputted prediction mode and motion vector information using a<br>
decoded picture of a decoded picture stored in a frame memory<br>
603 as a reference picture. A decoded picture is generated by<br>
inputting the above generated predictive picture into an add<br>
operating unit 606 and adding the inputted picture to the predictive<br>
residual picture generated in a predictive residual decoding unit<br>
602.	Above    embodiment    shows    an    operation    for    an<br>
inter-picture-prediction-bit stream, however, a switch 607 switches to a decoding process for an intra-picture-prediction-bit stream.<br>
A summary of a decoding flow is shown above, however, detailed process in the motion compensation decoding unit 604 is explained below.<br>
Motion vector information is added on block basis or area (a divided block) basis. By using decoded pictures preceding and following a target picture to be coded in display order as reference pictures, a predictive picture to perform motion compensation from the pictures is generated.<br>
A direct mode is one of bi-predictions which perform inter picture prediction coding referring to each of pictures preceding and following in display order. In the direct mode, since a target block to be coded inputs a bit stream which does not contain a motion vector directly, 2 motion vectors for actual motion compensation are calculated referring to a motion vector of a co-located block in a decoded picture close in display order, and a predictive picture is generated.<br><br>
Fig. 7 shows an operation when a decoded picture referred to in order to determine a motion vector in the direct mode contains 2 motion vectors which refer to preceding 2 in display order. A picture P23 is a current target picture to be coded, and performs bi-prediction referring to pictures P22 and P24. When it is assumed that a block to be decoded is a block MB21, 2 required motion vectors are determined using a motion vector of a co-located block MB22 in the decoded backward reference picture (the second reference picture specified by the second reference index) P24. Since the block MB22 contains 2 motion vectors MV21 and MV22 as the motion vectors, 2 required motion vectors MV23 and MV24 cannot be calculated by applying the direct scaling similarly to Equation 1. Therefore, as Equation 2, a motion vector M\/_REF is determined as a motion vector to-be scaled from an average value of 2 motion vectors of the block MB22, and a time interval TR_REF at that time is determined from an average value likewise. Then motion vectors MV23 and MV24 are calculated by scaling a motion vector MV_REF and a time interval TR_REF based on Equation 3. In this case, a time interval TR21 indicates a time interval between a picture P24 and P21, that is, until a picture which is referred to by a motion vector M\/21, and a time interval TR22 indicates a time interval until a picture which is referred to by a motion vector MV22. A time interval TR23 indicates a time interval until a picture which is referred to by a motion vector MV23, and a time interval TR24 indicates a time interval until a picture which is referred to by a motion vector MV24. Time intervals between these pictures can be determined based on, for example, information indicating display time and display order added to each picture or difference of information. Note that a target picture to be coded refers to a next picture in the example of Fig. 7, however, the case referring to a picture which is not next may be treated in the same manner.<br><br>
The above embodiment shows the decoding method in which an inter picture prediction decoding can be performed using the direct mode without contradiction even if a block of which motion vector is referred to belongs to a B picture. In the decoding method, when a block of which motion vector is referred to in the direct mode contains plural motion vectors which refer to a preceding picture, a motion vector is generated using the plural motion vectors, and 2 motion vectors to be used for actual motion compensation are determined by scaling.<br>
Note that when 2 motion vectors M\/23 and MV24 in Fig. 7 are calculated, it is possible to use Equation 4 instead of Equation 2 as a method for averaging motion vectors MV21 and MV22 and for averaging time intervals TR21 and TR22 in order to calculate the motion vector MV_REF and the time interval TR_REF to be scaled. First, as Equation 4 (a) shows, the motion vector MV21' is calculated by scaling M\/21 to equate the time interval with the motion vector MV22. Then the motion vector MV_REF is determined by averaging motion vectors MV21* and MV22. Here, the time interval TR22 is used directly as the time interval TR_REF. Note that the case calculating a motion vector MV22' by scaling the motion vector MV22 instead of calculating the motion vector MV21' by scaling a motion vector MV21 may be treated in the same manner.<br>
Note that when 2 motion vectors MV23 and MV24 in Fig. 7 are calculated, as a motion vector MV_REF and a time interval TR_REF which are scaled, a motion vector MV22 and a time interval TR22, which refer to a picture P22 located temporally closer to a picture P24 of which motion vector is referred to, can be directly used as Equation 5 shows instead of using an average value of 2 motion vectors as Equation 2 shows. Likewise, as a motion vector MV_REF and a time interval TR_REF, a motion vector MV21 and a time interval TR21, which refer to a picture P21 located temporally<br><br>
farther can be directly used as Equation 6 shows. This method makes it possible to reduce capacity of a motion vector storing unit in a coding apparatus since each block belonging to a picture P24 of which motion vector is referred to can actualize motion compensation by storing only one of 2 motion vectors.<br>
Note that when 2 motion vectors MV23 and MV24 in Fig. 7 are calculated, as a motion vector MV_REF and a time interval TR_REF which are scaled, a motion vector which refers to a picture to be decoded precedently can be directly used, instead of using an average value of 2 motion vectors as Equation 2 shows. Fig. 8A shows a referential relation in display order of moving pictures as Fig. 7 shows, and Fig. 8B shows an order in which a bit stream is inputted, that is, a decoding order. Here, a picture P23 indicates a picture decoded in the direct mode, and a picture P24 indicates a picture of which motion vector is referred to for the decoding. When considering an order as shown in Fig. 8B, since a motion vector which refers to a picture to be decoded precedently is directly used, a motion vector MV22 and a time interval TR22 are directly applied as a motion vector MV_REF and a time interval TR_REF as Equation 5 shows. Likewise, it is possible to directly use a motion vector which refers to a picture to be decoded later. In this case, a motion vector MV21 and a time interval TR21 are directly applied as a motion vector MV_REF and a time interval TR_REF as Equation 6 shows. This makes possible to reduce capacity of a motion vector storing unit in a decoding apparatus since each block belonging to a picture P24 of which motion vector is referred to can perform motion compensation by storing only one of 2 motion vectors.<br>
Note that in this embodiment, the case that a motion vector used in the direct mode is calculated by scaling a referenced motion vector using a time interval between pictures is explained, however, the motion vector may be calculated by multiplying by a<br><br>
constant number. Here, a constant used for the multiplication may be variable when coding or decoding is performed on plural blocks basis or on plural pictures basis.<br>
(Fourth Embodiment)<br>
An overview of coding process based on Fig. 11 is completely equal to the third embodiment. Here, a detailed operation of bi-prediction in the direct mode is explained using Fig. 9. However, it is assumed that the bit stream generated in the picture coding method of the first embodiment is inputted.<br>
Fig. 9 shows an operation when a picture referred to in order to determine a motion vector in the direct mode contains 2 motion vectors which refer to following 2 pictures in display order. A picture P43 is a current target picture to be decoded, and performs bi-prediction referring to pictures P42 and P44. When it is assumed that a block to be decoded is a block MB41, 2 required motion vectors are determined using a motion vector of a co-located block MB42 in the decoded backward reference picture (the second reference picture specified by the second reference index) P44. Since the block MB42 contains 2 motion vectors MV45 and MV46 as motion vectors, 2 motion vectors MV43 and MV44 cannot be calculated by directly scaling similarly to Equation 1. Therefore, as Equation 7, a motion vector MV_REF is determined as a motion vector to be scaled from an average value of 2 motion vectors of the block MB42, and a time interval TR_REF at that time is determined from an average value likewise. Then motion vectors MV43 and MV44 are calculated by scaling a motion vector MV_REF and a time interval TR_REF based on Equation 8. In this case, a time interval TR45 indicates a time interval between a picture P44 and P45, that is, until a picture which is referred to by a motion vector MV45, and a time interval TR46 indicates a time interval between until a picture which is referred to by a motion<br><br>
vector MV46. A time interval TR43 indicates a time interval until a picture which is referred to by a motion vector MV43, and a time interval TR44 indicates a time interval until a picture which is referred to by a motion vector MV44. Note that a target picture to be decoded refers to a next picture in the example of Fig. 9, however, the case referring to a picture which is not adjacent may be treated in the same manner.<br>
The above embodiment shows the decoding method in which an inter picture prediction decoding can be performed using the direct mode without contradiction even if a block of which motion vector is referred to in the direct mode belongs to a B picture. In the decoding method, when a block of which motion vector is referred to in the direct mode contains plural motion vectors which refer to a following picture in display order, a motion vector is generated using the plural motion vectors, and 2 motion vectors to be used for actual motion compensation are determined by scaling.<br>
Note that when 2 motion vectors MV43 and MV44 in Fig. 9 are calculated, it is possible to use Equation 7 instead of Equation 9 as a method for averaging motion vectors MV45 and MV46 and for averaging time intervals TR45 and TR46 in order to calculate the motion vector MV_REF and the time interval TR_REF to be scaled. First, as Equation 9 (a) shows, the motion vector MV46' is calculated by scaling MV46 to equate the time interval with the motion vector MV45. Then the motion vector MV_REF is determined by averaging motion vectors MV46' and MV45. Here, the time interval TR45 is used directly as the time interval TR_RF. Note that the case calculating a motion vector MV45' by scaling the motion vector MV45 instead of calculating the motion vector MV46' by scaling a motion vector MV46 may be treated in the same manner.<br>
Note that when 2 motion vectors MV43 and MV44 in Fig. 9 are calculated, as a motion vector MV_REF and a time interval<br><br>
TR_REF which are scaled, a motion vector MV45 and a time interval TR45, which refer to a picture P45 located temporally closer to a picture P44 of which motion vector is referred to, can be directly used as Equation 10 shows instead of using an average value of 2 motion vectors as Equation 7 shows. Likewise, as a motion vector MV_REF and a time interval TR_REF, a motion vector MV46 and a time interval TR46, which refer to a picture P46 located temporally farther can be directly used as Equation 11 shows. This method makes it possible to reduce capacity of a motion vector storing unit in a decoding apparatus since each block belonging to a picture P44 of which motion vector is referred to can implement motion compensation by storing only one of 2 motion vectors.<br>
Note that when 2 motion vectors MV43 and MV44 in Frg. 9 are calculated, as a motion vector MV_REF and a time interval TR_REF which are scaled, a motion vector which refers to a picture to be decoded precedently can be directly used, instead of using an average value of 2 motion vectors as Equation 7 shows. Fig. lOA shows a referential relation in display order of moving pictures as Fig. 9 shows, and Fig. lOB shows an order in which a bit stream is inputted, that is, a decoding order. Here, a picture P43 indicates a picture which is decoded in the direct mode, and a picture P44 indicates a picture of which motion vector is referred to for the decoding. When considering an order as shown in Fig, lOB, since a motion vector which refers to a picture to be decoded precedently is directly used, a motion vector MV46 and a time interval TR46 are directly applied as a motion vector MV_REF and a time interval TR_REF as Equation 10 shows. This method makes it possible to reduce capacity of a motion vector storing unit in a decoding apparatus since each block belonging to a picture P44 of which motion vector is referred to can perform motion compensation by storing only one of 2 motion vectors.<br>
Note that when a block which is referred to in order to<br><br>
determine a motion vector in the direct mode contains 2 motion vectors which refer to 2 following pictures in display order, it is possible to perform motion compensation assuming 2 required motion vectors MV43 and MV44 are "0". This method makes it possible to reduce capacity of a motion vector storing unit in a decoding apparatus and further makes it possible to omit a process of calculating a motion vector since each block belonging to a picture P44 of which motion vector is referred to does not have to store a motion vector.<br>
Note that in this embodiment, the case that a motion vector used in the direct mode is calculated by scaling a referenced motion vector using a time interval between pictures is explained, however, the motion vector may be calculated by multiplying by a constant number. Here, a constant used for the multiplication may be variable when coding or decoding is performed on plural blocks basis or on plural pictures basis.<br>
(Fifth Embodiment)<br>
Coding/decoding method can be actualized not only by the coding/decoding method shown in the above first embodiment through fourth embodiment but also by a motion vector calculation method shown below.<br>
Fig. 12 shows an operation when a coded or decoded block referred to in order to calculate a motion vector in the direct mode contains 2 motion vectors which refer to preceding 2 pictures in display order. A picture P23 is a current target picture to be coded or decoded. When it is assumed that a block to be coded or decoded is a block MBl, 2 required motion vectors are determined using a motion vector of a co-located block MB2 in the coded or decoded backward reference picture (the second reference picture specified by the second reference index) P24. Note that in Fig. 12, the block MBl is a target block of process, the blocks MBl and MB2<br><br>
are co-located blocks in other pictures, and the motion vectors M\/21 is first forward motion vector that the reference picture is specified by first reference index and MV22 is forward motion vector that the reference picture is specified by second reference index, and these motion vectors are used for coding or decoding the block MB2 and refer to pictures P21 and P22 respectively. The pictures P21, P22 and P24 are coded or decoded pictures. A time interval TR21 is a time interval between the picture P21 and the picture P24, a time interval TR22 is a time interval between the picture P22 and the picture P24, a time interval TR21' is a time interval between P21 and the picture P23, and a time interval TR 24' is a time interval between the picture P23 and the picture P24.<br>
In the motion vector calculation method, as shown in Fig. 12, only the forward motion vector (the first motion vector)  MV21 coded or decoded precedently is used out of motion vectors of the block MB2 in the reference picture P24, and a motion vectors M\/21' and MV24' of the block MBl are calculated by following equations.<br>
MV21' = MV21 X TR21'/TR21<br>
MV24' = -MV21 X TR247TR21<br>
Then bi-prediction is performed from the pictures P21 and P24 using the motion vectors MV21' and MV24'. Note that a motion vector of the block MBl may be calculated using only a motion vector (the second motion vector) MV22 coded or decoded later out of motion vectors of the block MB2 in the reference picture P24, instead of calculating motion vectors MV21' and MV24' of the block* MBl using only the motion vector MV21. Moreover, as shown in the first embodiment through the fourth embodiment, a motion vector of the block MBl may be determined using both the motion vectors MV21 and MV22. When selecting one of the motion vectors MV21 and MV22, a motion vector of a block coded or decoded precedently may be selected, and it may be set arbitrarily   in   a   coding   apparatus  and   a   decoding  apparatus.<br><br>
Motion compensation is possible either when the picture P21 is in the short term reference picture buffer or in the long term reference picture buffer. Explanation will be given for the short term reference picture buffer and the long term reference picture buffer later.<br>
Fig. 13 shows an operation when a coded or decoded block referred to in order to calculate a motion vector in the direct mode contains 2 motion vectors which refer to following 2 pictures in display order. A picture P22 is a current target picture to be coded or decoded. When it is assumed that a block to be coded or decoded is a block MBl, 2 required motion vectors are determined using a motion vector of a co-located block MB2 in the coded or decoded backward reference picture (the second reference picture) P23. Note that in Fig. 13 the block MBl is a target block of processing, the blocks MBl and MB2 are co-located blocks in pictures, and the motion vectors MV24 and MV25 are backward motion vectors used for coding or decoding the block MB2 and refer to pictures P21 and P22 respectively. The pictures P21, P23, P24 and P25 are coded or decoded pictures. A time interval TR24 is a time Interval between the picture P23 and the picture P24, a time interval TR25 is a time interval between the picture P23 and the picture P25, a time interval TR24' is a time interval between P22 and the picture P24, and a time interval TR 21' is a time interval between the picture P21 and the picture P22.<br>
In a motion vector calculation method, as shown in Fig. 13, only the backward motion vector MV24, which refers to the picture P24, of the block MB2 in the reference picture P23 is used, and a motion vectors M\/21' and MV24' are calculated by following equations,<br>
MV21' = -MV24 X TR217TR24<br>
MV24' = MV24 x TR247TR24<br>
Then bi-prediction is performed from the pictures P21 and<br><br>
P24 using the motion vectors MV21' and MV24'.<br>
Note that, as shown in Fig. 14, when only a backward motion vector MV 25, which points at the picture P25, of the block MB2 in the reference picture P23 is used, motion vectors MV21' and MV24' are calculated by following equations. Here, a time interval TR24 is a time interval between the picture P23 and the picture P24, a time interval TR25 is a time interval between the picture P23 and the picture P25, a time interval TR25' is a time interval between the picture P22 and the picture P25, and a time interval TR21' is a time interval between the picture P21 and the picture P22.<br>
MV21' = -MV25 XTR21VTR25<br>
MV25' = MV25 x TR25'/TR25<br>
Then bi-prediction is performed from the pictures P21 and P24 using the motion vectors MV21' and MV24'.<br>
Fig. 15 shows an operation when a coded or decoded block referred to in order to calculate a motion vector in the direct mode contains 2 motion vectors which refer to a preceding picture in display order. A picture P23 is a current target picture to be coded or decoded. When it is assumed that a block to be coded or decoded is a block MBl, 2 required motion vectors are determined using a motion vector of a co-located block MB2 in the coded or decoded backward reference picture (the second reference picture specified by the second reference index) P24. Note that in Fig. 15, the block MBl is a target block of processing, the blocks MBl and MB2 are co-located blocks in other pictures. The motion vectors MV21A and MV21B are forward motion vectors used for coding or decoding the block MB2, and both refer to the picture P21. The pictures P21, P22 and P24 are coded or decoded pictures. Time intervals TR21A and TR 21B are a time interval between the picture P21 and the picture P24, a time interval TR21' is a time interval between the picture P21 and the picture P23, and a time interva TR24' is a time interval between P23 and the picture P24.<br><br>
In a motion vector calculation method, as shown in Fig. 15, only the forward motion vector MV21A, which points at the picture P21, of the block MB2 in the reference picture P24 is used, and a motion vectors MV21A' and M\/24' are calculated by following equations.<br>
MV21A' = MV21A x TR217TR21A<br>
MV24' = -MV21A x TR24VTR21A<br>
Then bi-prediction is performed from the pictures P21 and P24 using the motion vectors MV21A' and MV24'.<br>
Note that a motion vector of the block MBl may be calculated using only a forward motion vector MV21B, which points at the picture P21, of the block MB2 in the reference picture P24. Moreover, as shown in the first embodiment through the fourth embodiment, a motion vector of the block MBl may be determined using both forward motion vectors MV21A and MV21B. When selecting one of the forward motion vectors MV21A and MV21B, a motion vector of a block coded or decoded precedently (described earlier in a bit stream) may be selected, and it may be set arbitrarily by a coding apparatus and a decoding apparatus. Here, the motion vector coded or decoded precedent means the first motion vector. Motion compensation is possible either when the picture P21 in the short term reference picture buffer or in the long term reference picture buffer. Explanation will be given for the short term reference picture buffer and the long term reference picture buffer later.<br>
Note that in this embodiment, the case that a motion vector used in the direct mode is calculated by scaling a referenced motion vector using a time interval between pictures is explained, however, the motion vector may be calculated by multiplying by a constant number. Here, a constant used for the multiplication may be variable when coding or decoding is performed on plural blocks basis or on plural pictures basis.<br><br>
Note that, in the above-mentioned equations to calculate motion vectors Vl', MV24', MV25' and MV21A', motion vectors may be rounded to a predetermined precision of a motion vector after calculating the right side of the equations. Precision of motion vector includes half pixel precision, one-third pixel precision and quarter pixel precision or the like. In addition, precision of a motion vector can be determined, for example, on block basis, picture basis, and sequence basis.<br>
(Sixth Embodiment)<br>
In this sixth embodiment, a method for calculating a target motion vector by scaling only one of 2 forward motion vectors when a reference picture referred to in order to determine a target motion vector in the direct mode contains 2 forward motion vectors which refer to 2 pictures preceding in display order is explained using Figs. 14, 15 and 16. Note that the block MBl is a target block of processing, the blocks MBl and MB2 are co-located blocks in other pictures, and the motion vectors MV21 and MV22 are forward motion vectors used for coding or decoding the block MB2 and refer to pictures P21 and P22 respectively. The pictures P21, P22 and P24 are coded or decoded pictures. A time interval TR21 is a time interval between the picture P21 and the picture P24, a time interval TR22 is a time interval between the picture P22 and the picture P24, a time interval TR21' is a time interval between P21 and the picture P23, and a time interval TR22' is a time interval between P22 and the picture P23.<br>
In the first method, when a block MB2 in a reference picture P24 contains a forward motion vector MVZl referring to a picture P22 and a forward motion vector MV22 referring to a picture P23 as shown In Fig. 16, a motion vector MV22' of the block MBl Is calculated using only a motion vector MV22 which refers to a picture P22 close to a target picture P23 in display order by a<br><br>
following equation.<br>
MV22' = MV22 x TR227TR22<br>
Then motion compensation Is performed from the picture P22 using the motion vector MV22'.<br>
In the second method, when a block MB2 of a reference picture P24 contains a forward motion vector MV21 referring to a picture P21 and a forward motion vector MV22 referring to a picture P22 as shown In Fig. 17, a motion vector MV21' of the block MBl is calculated using only a motion vector MV21 which refers to a picture P21 being far from a target picture P23 in display order by a following equation.<br>
MV21' = MV21 X TR21VTR21<br>
Then motion compensation is performed from the picture P21 using the motion vector MV21'.<br>
The first and the second methods make it possible to reduce capacity of a motion vector storing unit since the block MB2 belonging to a picture P24 of which motion vector is referred to can actualize motion compensation by storing only one of 2 motion vectors.<br>
Note that motion compensation can be performed from a picture P22 close in display order, using the forward motion vector MV21 same as the first embodiment. A motion vector MVN (not shown in this figure) used for the motion compensation is calculated by a following equation.<br>
MVN = MV21 X TR227TR21<br>
In the third method, as shown in Fig.16, a motion compensation block is obtained from the pictures P21 and P22 respectively using the motion vectors MV21' and M\/22' calculated above, and an average picture is used as an interpolation picture in motion compensation.<br>
The third method increases calculated amount, however, improves precision of motion compensation.<br><br>
Moreover, it is possible to obtain a motion compensation block from the picture P22 using the above-mentioned motion vectors MVN and MV22', and to use an average picture as an interpolation picture in motion compensation.<br>
Note that in this embodiment, the case that a motion vector used in the direct mode is calculated by scaling a referenced motion vector using a time interval between pictures is explained, however, the motion vector may be calculated by multiplying a reference motion vector by a constant number. Here, a constant used for the multiplication may be variable when coding or decoding is performed on plural blocks basis or on plural pictures basis.<br>
Note that, in the above-mentioned equations to calculate the motion vectors M\/21', MV22' and MVN, the motion vectors may be rounded to a predetermined precision of a motion vector after calculating the right side of the equations. Precision of motion vector includes half pixel precision, one-third pixel precision and quarter pixel precision or the like. In addition, precision of a motion vector can be determined, for example, on block basis, picture basis, and sequence basis.<br>
(Seventh Embodiment)<br>
In the above sixth embodiment, the case that a reference picture referred to in order to determine a motion vector of a target block to be coded or decoded in the direct mode contains 2 forward motion vectors which refer to 2 preceding pictures in display order is described, however, when the reference picture contains 2 backward motion vectors which refer to 2 following pictures in display order, it is possible to calculate a target motion vector by scaling only one of 2 backward motion vectors (the second motion vectors of which reference picture is specified by the second reference indices), likewise.    Explanation will be given using Figs.<br><br>
17 ~ 20 below. Note that the block MBl is a target block of process, the blocks MBl and MB2 are co-located blocks in other pictures, and the motion vectors MV24 and MV25 are backward motion vectors (the second motion vectors of which reference picture is specified by the second reference indices) used for coding or decoding the block MB2. The pictures P21, P23, P24 and P25 are coded or decoded pictures. A time interval TR24 is a time interval between the picture P23 and the picture P24, a time interval TR25 is a time interval between the picture P23 and the picture P25, a time interval TR24' is a time interval between P22 and the picture P25, and a time interval TR25' is a time interval between P22 and the picture P25.<br>
In the first method, when a block MB2-of a reference picture P23 contains 2 backward motion vectors MV24 referring to a picture P24 and MV25 referring to a picture P25 as shown in Fig. 19, a motion vector MV24' of the block MBl is calculated using only a backward motion vector MV24 which refers to a picture P24 being temporally close to a target picture P22 by a following equation.<br>
MV24' = MV24 x TR24VTR24<br>
Then motion compensation is performed from the picture P24 using the motion vector MV24'.<br>
Note that motion compensation can be performed from a picture P23 close in display order, using a backward motion vector MV24 same as the first embodiment. A motion vector MVNl (not shown in this figure) used for the motion compensation is calculated by a following equation.<br>
MVNl = MV24 X TRN1/TR24<br>
In the second method, when a block MB2 of a reference picture P23 contains 2 backward motion vectors MV24 referring to a picture P24 and MV25 referring to a picture P25 as shown in Fig. 20, a motion vector MV25' of the block MBl is calculated using only a backward motion vector MV25 which refers to a picture P25 far<br><br>
rom a target picture P23 in display order by a following equation.<br>
MV25' = MV25 x TR25'/TR25<br>
Then motion compensation is performed from the picture   using the motion vector MV25'.<br>
The first and the second methods make it possible to reduce :apacity of a motion vector storing unit since the block MB2 belonging to a picture P23 of which motion vector is referred to can implement motion compensation by storing only one of 2 motion vectors.<br>
Note that a motion compensation can be performed from a picture P23 close in display order, using a backward motion vector MV25 as same as the first embodiment. A motion vector M\/N2 (not shown in this figure) used for the motion compensation is calculated using a following equation.<br>
MVN2 = MV25 x TRN1/TR25<br>
In the third method, as shown in Fig.21, a motion compensation block is obtained from the pictures P24 and P25 respectively using the motion vectors MV24' and M\/25' calculated above, and an average picture is used as an interpolation picture in a motion compensation.<br>
The third method increases the amount of calculation, however, improves precision of motion compensation.<br>
Note that, it is possible to obtain a motion compensation block from the picture P24 using the above-mentioned motion vectors MVNl and MVN2, and use an average picture as an interpolation picture in motion compensation.<br>
Moreover, as shown in Fig. 22, when a reference picture referred to in order to determine a motion vector of a target motion vector in the direct mode contains a backward motion vector which refers to a picture following in display order, for example, a motion vector MV24' is calculated using a following equation.<br>
MV24' = MV24 x TR247TR24<br><br>
Then motion compensation is performed from the picture P24 using the motion vector MV24',<br>
Note that motion compensation can be performed from a picture P23 close in display order, using a backward motion vector MV25 as same as the first embodiment. A motion vector MVN3 (not shown in this figure) used for the motion compensation is calculated by a following equation.<br>
MVN3 = MV24 x TRN1/TR24<br>
Note that in this embodiment, the case when containing 2 backward motion vectors, which refer to 2 pictures following in display order, and when containing a backward motion vector, which refers to a picture following in display order, a target motion vector is calculated by scaling the backward motion vector is explained, however, a target motion vector may be calculated referring to a motion vector of a neighbouring block in a same picture without using a backward motion vector, and when intra picture coding is performed, a target motion vector may be calculated referring to a motion vector of a neighbouring block in a same picture. To begin with, the first calculation method will be described.<br>
Fig. 23 shows a positional relation between a motion vector to be referred to and a target block. A block MB 1 is a target block, and refers to a motion vector of a block including 3 pixels located on A, B and C. Note that when a pixel C cannot be referred to since it locates outside of a frame or it has not been coded/decoded, a motion vector of a block including a pixel D is used instead of a block including the pixel C. BY calculating a median value of motion vectors of 3 target blocks Including pixels A, B and C to be referred to, a motion vector used actually in the direct mode is determined. By calculating a median value of motion vectors of 3 blocks, additional information showing which motion vector is selected is not necessary to be described in a bit stream.    Hence,<br><br>
t is possible to obtain a motion vector expressing motion close to actual motion of the block MBl. In this case, motion :compensation may be performed by only forward reference [reference to the first reference picture) using the determined notion vector and by bi-directional reference (reference to the first -deference picture and the second reference picture) using a motion actor parallel with the determined motion vector-Next, the second calculation method will be described. In the second calculation method, an median value is not selected as the first calculation method, and a motion vector used n actual direct mode is determined by selecting a motion vector of  which coding efficiency is the highest of motion vectors of 3 blocks including pixels A, B and C. In this case, motion compensation may be performed by only forward reference (reference to the first reference picture) using the determined motion vector and by bi-directional reference (reference to the first reference picture and the second reference picture) using a motion vector parallel with the determined motion vector. Information indicating a motion vector with the highest coding efficiency is, for example as shown in Fig. 24A, added to a header area of a block in a bit stream generated by a bit stream generating unit 103 with information indicating a direct mode outputted from a mode selecting unit 107. Note that as shown in Fig, 24B, the information indicating a motion vector with the highest coding efficiency may be added to a header area of a macroblock. Here, information indicating a motion vector with the highest coding efficiency is, for example, a number identifying a block including a target pixel to be referred to, and an identification number given to every block. When a block is identified by the identification number, a motion vector with the highest coding efficiency may be indicated by using only one of motion vectors used for coding a block corresponding to an identification number, and when motion vectors are more than 1, a<br><br>
motion vector with the highest coding efficiency may be indicated by using plural motion vectors. Or, a motion vector with the highest coding efficiency may be indicated by using an identification number given to every block to every motion vector in bi-direction (reference to the first reference picture and the second reference picture). This selecting method makes it possible to always select a motion vector which makes coding efficiency the highest. However, since additional information showing which motion vector is selected needs to be described in a bit stream, extra amount of code for the additional information is necessary.    In addition, the third calculation method is explained.<br>
In the third calculation method, a motion vector referring to a reference picture with the smallest reference index is determined as a motion vector used in an actual direct mode. The smallest reference index means generally a motion vector which refers to a picture close in display order or a motion vector with the highest coding efficiency. Therefore, this motion vector selecting method makes it possible to improve coding efficiency, since a motion vector used in the direct mode is generated using a motion vector which refers to a picture closest in display order or a motion vector with the highest coding efficiency.<br>
Note that when all of 3 motion vectors refer to a same reference picture, a median value of the 3 motion vectors may be used. On the other hand, when 2 of 3 motion vectors refer to a reference picture with the smallest reference index value, for example, same one of the 2 motion vectors may be always selected. As an example, referring to Fig. 23, there are 3 blocks including pixels A, B and C respectively, and when reference index values of blocks including pixels A and B are the smallest, and a same reference picture is referred to, a motion vector in the block including the pixel A may be selected. However, when reference index values of blocks including pixels A and C are the smallest.<br><br>
and a same reference picture is referred to, a motion vector in a block BLl including the pixel A located closer to a block may be selected.<br>
Note that the above-mentioned median value may be a median value of components in horizontal direction and vertical direction of each motion vector, and may be a median value of value (absolute value) of each motion vector.<br>
In the case as shown in Fig. 25, a median value of motion vectors may be a median value of motion vectors contained in 5 blocks: a co-located block of a block BLl in a following reference picture, blocks including pixels A, B and C respectively, and a block including a pixel D shown in Fig. 25. As described above, when a co-located block, which is close to a target pixel to be coded, of the block BLl in a following reference picture is used, a process of calculating a median value of motion vectors becomes easier by using a block including the pixel D in order to make the number of blocks an odd number. Note that when plural blocks are on a co-located area of the block BLl in a following reference picture, a motion compensation may be performed for the block BLl by using a motion vector in a block which occupies the largest area overlapped with the block BLl, or by dividing the block BLl corresponding to area of the plural block in the following reference picture and a motion compensation may be performed on divided block basis.<br>
An explanation will be further given using concrete examples.<br>
As shown in Figs. 26 and 27, when all blocks including pixels A, B and C contain a motion vector which refers to a picture preceding a target picture to be coded, any of the above-mentioned the first through the third calculation methods may be used.<br>
Likewise, as shown in Figs. 28 and 29, when all  blocks<br><br>
including pixels A, B and C contain a motion vector which refers to a picture following a target picture to be coded, any of the above-mentioned the first through the third calculation methods may be used.<br>
Next, the case shown in Fig. 30 is explained. Fig. 30 shows the case that each of blocks including pixels A, B and C respectively contains each of motion vectors, one refers to picture preceding a target picture to be coded and another refers to a picture following a target picture to be coded.<br>
According to the above first calculation method, a forward motion vector used for motion compensation of the block BLl is selected by a median value of motion vectors MVAf, MVBf and MVCf, and a backward motion vector used for motion compensation of the block BLl is selected by a median value of motion vectors MVAb, MVBb and MVCb. Here, the motion vector MVAf is a forward motion vector of a block containing the pixel A, the motion vector MVAb is a backward motion vector of a block containing the pixel A, the motion vector MVBf is a forward motion vector of a block containing the pixel B, the motion vector MVBb is a backward motion vector of a block containing the pixel B, the motion vector MVCf is a forward motion vector of a block containing the pixel C, the motion vector MVCb is a backward motion vector of a block containing the pixel C. Motion vectors such as the motion vector MVAf are not limited to the case referring to a picture as shown in the figure.    Same applies to a following explanation.<br>
According to the above second calculation method, a motion vector to be used in the actual direct mode is determined by selecting a motion vector with the highest coding efficiency of forward reference motion vectors MVAf, MVBf and MVCf, and selecting a motion vector with the highest coding efficiency of backward reference motion vectors MVAb, MVBb and MVCb. In this case, motion compensation may be performed by only forward<br><br>
reference using a motion vector with the highest coding efficiency of forward reference motion vectors MVAf, MVBf and MVCf, and by bi-prediction using a motion vector parallel with the determined motion vector. Note that, in order to achieve the highest coding efficiency, a motion compensation may be performed by selecting one block and using forward and backward reference motion vectors of the selected block instead of selecting for forward and backward reference motion vectors respectively. In this case, since information indicating a selection can be reduced as compared with the case that selecting information indicating a block which contains a pixel having a forward motion vector selected for the highest coding efficiency and a block which contains a pixel having a backward motion vector selected for the highest coding efficiency, coding efficiency can be improved. The selection of the block may be from followings: 1. A block includes a pixel having a forward reference motion vector which refers to a reference picture with the smallest reference index value, 2. A block has the smallest value which is a sum of a reference index value of a picture referred to by a forward reference motion vector of a block including each pixel and a reference index value of a picture referred to by a backward reference motion vector of a block including each pixel, 3. A block selects a median value of reference indices of a picture referred to by a forward reference motion vector and includes a pixel having a forward reference motion vector with the selected median value, and a backward motion vector is included in the block, and 4. A block selects a median value of reference indices in a picture referred to by a backward reference motion vector and includes a pixel having a backward motion vector with the selected median value, and a forward motion vector is included in the block. Note that when each of backward motion vectors refers to a same picture, above selecting method 1 and 3 are adequate.<br><br>
In the above-mentioned third calculation method, one of forward reference motion vectors MVAf, MVBf and MVCf, which refers to a reference picture with the smallest reference index value, is a forward reference (the first reference) motion vector used in the direct mode. Or, one of backward reference motion vectors MVAb, MVBb and MVCb, which refers to a reference picture with the smallest reference index value, is a backward reference (the second reference) motion vector used in the direct mode. Note that, in the third calculation method, the forward motion vector referring to the reference picture with the smallest reference index is a forward motion vector of a block BLl, and the backward motion vector referring to the reference picture with the smallest reference index is a backward motion vector of the block BLl, however, 2 motion vectors BLl and BL2 may be derived using one of a forward motion vector or a backward motion vector referring to a reference picture with the smallest reference index, and motion compensation may be performed using the derived motion vector.<br>
Next, the case shown in Fig. 31 is explained. Fig. 31 shows a case the pixel A contains each of motion vectors, one refers to preceding picture and another refers to a following picture, the pixel B contains only a motion vector which refers to a preceding picture, and the pixel C contains only a motion vector which refers a following picture.<br>
Thus, when there is a block including a pixel containing only a motion vector referring a picture uni-directionally, assuming that a motion vector referring to a picture in another direction is 0, the calculation method in above-mentioned Fig.30 may be used for motion compensation. Specifically, using the first or the third calculation method in Fig. 30, calculation may be performed assuming MVCf = MVBb = 0. That is, in the first calculation method,   when   a   forward   motion   vector  of the  block  BLl   is<br><br>
calculated, assuming that a motion vector MVCf of the pixel C referring to a preceding picture is 0, a median value of motion vectors MVAf, MVBf and MVCf is calculated. On the other hand, when a backward motion vector of the block BLl is calculated, assuming a motion vector MVBb, which refers to a following picture, of the pixel B is 0, a median value of motion vectors MVAb, MVBb and MVCb is calculated.<br>
In the third calculation method, assuming that a motion vector MVCf, which refers to a preceding picture, of the pixel C and a motion vector, which refers to a following picture, of the pixel B are 0, a motion vector, which refers to a reference picture with the smallest reference index value, of the block BLl is calculated. For example, when a block including a pixel A refers to a picture with the first reference index of "0" and a block including a pixel B refers to a picture with the first reference index of "1", the smallest value of reference index is "0". Therefore, since only the motion vector MVBf, which refers to a preceding picture, of the block including the pixel refers to a picture with the smallest first reference index, the motion vector MVBf is selected as a forward motion vector of the block BLl. Moreover, for example, when both pixels A and C refer to a following picture with the smallest second reference index, for example "0", assuming a motion vector MVBb, which refers to a following picture, of a pixel B is 0, a median value of motion vectors MVAb, MVBb and MBCb is calculated. The motion vector resulted from the calculation is set as a forward motion vector of the block BLl.<br>
Next, a case shown in Fig. 32 is explained.   Fig. 32 shows a case the pixel A contains each of motion vectors, one refers to preceding picture and another refers to a following picture, the pixel B contains only a motion vector which refers to a preceding picture and the pixel C does not contain a motion vector and is intra-picture coded.<br><br>
When a block including a target pixel C to be coded is intra-picture coded, assuming that motion vectors which refer to pictures preceding and following the block are both 0, the calculation method in above-mentioned Fig.30 may be used for motion compensation.    Specifically, calculation may be performed assuming MVCf = MVCb = 0.    Note that, in Fig. 30, MVBb is 0.<br>
Lastly, a case shown in Fig. 33 is explained.    Fig. 33 shows a case that a pixel C is coded by the direct mode.<br>
When a block including a target pixel referred to contain a block coded by the direct mode, motion compensation of the block BLl may be performed using a motion vector used for coding a block coded by the direct mode and using the calculation method in the above-mentioned Fig. 30.<br>
Note that it is determined which of a forward or a backward reference motion vector is used depending on a picture to be referred to, a picture to be coded and time information included in each picture.    Therefore, when a motion vector is derived after differentiate between a forward reference and a backward reference, a motion vector of each block is judged if a forward reference or a backward reference from time information contained in each picture.<br>
In addition, an example of a calculation method combining the above-mentioned calculation methods is explained.   Fig. 34 is an illustration showing a procedure for determining a motion vector to be used in the direct mode.    Fig. 34 is an example of a method for determining a motion vector using reference Indices. Note that RidxO and Ridxl shown in Fig. 34 are reference indices explained above.    Fig. 34A shows a procedure for determining a motion vector using the first reference index RidxO, and Fig. 34B shows a procedure for determining a motion vector using the second reference index Ridxl.    First, Fig. 34A is explained.<br>
In a step S3701, there are 3 blocks including pixels A, B and<br><br>
C respectively, and the number of blocks referring to a picture using the first reference index RidxO is calculated.<br>
When the number of blocks calculated in the step S3701 is "0", the number of blocks referring to a picture using the second reference index Ridxl is further calculated in a step S3702.    When the number of blocks calculated in the step S3702 is "0", motion compensation is performed bi-directionally for a target block to be coded assuming that a motion block of the target block to be coded is "0" in a step S3703.    On the other hand, when the number of blocks calculated in the step S3702 is "1" or more, a motion vector of a target block to be coded is determined in a step S3704 by the number of blocks containing the second reference index Ridxl. For example, motion compensation of a target block to be coded is performed using the motion vector determined by the number of blocks containing the second reference index Ridxl.<br>
When the number of blocks calculated in the step S3701 is "1", a motion vector containing the first reference index RidxO is used In a step S3705.<br>
When the number of blocks calculated in the step S3701 is "2", assuming that a block which does not contain the first index RidxO contains a motion vector of MV = 0 of the first reference index RidxO, a motion vector corresponding to a median value of 3 motion vectors is used in a step S3706<br>
When the number of blocks calculated in the step S3701 is "3", a motion vector corresponding to a median value of 3 motion vectors is used in a step S3707. Note that motion compensation in the step S3704 may be performed bi-directionally using one motion vector. Here, bi-directional motion compensation may be performed after calculating a motion vector In the same direction as one motion vector and a motion vector In the opposite direction to one motion vector, for example, by scaling one motion vector, or may be performed using a motion vector In the same direction as<br><br>
Dne motion vector and a motion vector of "0".    Next, Fig. 34B is explained.<br>
The number of blocks containing the second reference index Ridxl is calculated in a step S3711,.<br>
When the number of blocks calculated in the step S3711 is "0", the number of blocks containing the first reference index Rlxdl is further calculated in a step S3712.    When the number of blocks calculated in the step S3712 is "0", motion compensation is performed bi-directionally for a target block to be coded assume ng that a motion block of the target block to be coded is "0" in a step S3713.    On the other hand, the number of blocks calculated in the step S3712 is "1" or more, a motion vector of a target blocs' "-   be coded is determined in a step S3714 by the number of blocs^ containing the first reference index RidxO.    For example, n-c-ion compensation of a target block to be coded is performed    : , ;: the motion vector determined by the number of blocks conic   in the first reference index RidxO.<br>
When the number of blocks calculated in the step S3711 is "1", a motion vector containing the second reference index Ridxl is used in a step S3715.<br>
When the number of blocks calculated in the step S3711 is "2", assuming that a block which does not contain the first index RidxO contains a motion vector of MV = 0 of the first reference index RidxO, a motion vector corresponding to a median value of 3 motion vectors is used in a step S3716.<br>
When the number of blocks calculated in the step S3711 is "3", a motion vector corresponding to a median value of 3 motion vectors is used in a step S3717. Note that motion compensation in the step S3714 may be performed bi-directionally using one motion vector. Here, bi-directional motion compensation may be performed after calculating a motion vector in the same direction as one motion vector and a motion vector in the opposite direction<br><br>
to one motion vector, for example, by scaling one motion vector, or may be performed using a motion vector in the same direction as one motion vector and a motion vector of "0".<br>
Note that Figs. 34A and 34B are explained respectively, however, both methods may be used or one of those methods may be used.    However, when one of those methods is used, for example, when a process started form the step 3704 shown in Fig. 34A is used and a process up to the step S3704 is used, a process after the step S3711 shown in Fig. 34B may be used.    When a process up to the step 53704 is used, since a process after the step S3712 is not used, a motion vector can be determined uniquely. When both processes of Figs. 34A and 34B are used, either process may be used first, or 2 processes may be used together.    When a block in the neighbor of a target block to be coded is coded in the direct mode, a reference index referred to by a motion vector used for coding the block coded in the direct mode may be assumed to be contained in a block coded in the direct mode and located in the neighbor of a target block to be coded-Detailed explanation of method for determining a motion vector will be given below using concrete examples of a block.    Fig. 35 is an illustration showing types of motion vectors contained in each block referred to by a target block BLl to be coded.    In Fig. 35A, a block containing a pixel A is a block intra picture coded, and a block containing a pixel B includes one motion vector and motion compensation is performed for the block using one motion vector, and a block containing a pixel C is a block including 2 motion vectors and motion compensation is performed bi-directionally. The block containing the pixel B contains a motion vector indicated by the second reference index Ridxl,    Since the block containing the pixel A is a block intra picture coded, it does not contain a motion vector, that is, it does not contain a reference index, too. In the step S3701, the number of blocks containing the first<br><br>
reference index RidxO is calculated. As shown in Fig. 35, since the number of blocks containing the first reference index RidxO is 2, assuming that a block which does not contain the first reference index RidxO contains a motion vector of MV = 0 of the first reference index RidxO, a motion vector corresponding to a median value of 3 motion vectors is used in a step S3706. Bi-directional motion compensation may be performed for a target block to be coded using only the above motion vector, or may be performed using the second reference index Ridxl and other motion vector as shown below.<br>
In the step S3711, the number of blocks containing the second reference index Ridxl is calculated. As shown in Fig. 35, since the number of blocks containing the second reference index Ridxl is 1, a motion vector containing the second reference index Ridxl is used in the step S3715.<br>
In addition, an example of another calculation method combining the above-mentioned calculation methods is explained. Fig. 38 is an illustration showing a procedure for determining a motion vector of a target block to be coded using reference index values showing a picture referred to by a motion vector contained in blocks including pixels A, B and C respectively. Figs. 36A and 36B are illustrations showing a procedure for determining a motion vector based on the first reference index RidxO, and Figs, 36C and 36D are illustrations showing a procedure for determining a motion vector based on the second reference index Ridxl. Fig. 36A shows a procedure based on the first reference index RidxO, on the other hand. Fig. 36C shows a procedure based on the second reference index Ridxl. Fig. 36B shows a procedure based on the first reference index RidxO, on the other hand. Fig. 36D shows a procedure based on the second reference index Ridxl. Hence, only Figs. 36A and 36B is explained below. To begin with. Fig. 36A is explained.<br><br>
In a step S3801, it is judged if the smallest first reference index RidxO of effective first reference indices RidxOs can be selected.<br>
When it is possible to select the smallest first reference index RidxO from the effective first reference indices RidxOs, the motion vector selected in the step S3802 is used.<br>
When the effective first reference indices RidxOs include the plural smallest reference indices RidxOs in the step S3801, a motion vector contained in a block selected by priority in a step S3803 is used. Here, the priority, for example, determines a motion vector to be used for motion compensation of a target block to be coded in alphabetical order of pixels contained in blocks.<br>
When there is no effective first reference index RidxO in the step S3801, process different from the steps S3802 and S3803 is used in a step S3804. For example, a process after a step S3711 explained in Fig. 374B may be used. Next, Fig. 36B is explained. The different point between Figs. 36A and 36B is that a process in the steps S3803 and S3804 in Fig. 36A is changed to a step S3813 in Fig. 36B.<br>
In a step S3811, it is judged if the smallest first reference index RidxO of effective first reference indices RidxOs can be selected.<br>
When it is possible to select the smallest first reference index RidxO from the effective first reference indices RidxOs, the motion vector selected in the step S3812 is used.<br>
When there is no effective first reference index RidxO in the step S3811, process different from S3812 is used in the step S3813. For example, a process after a step S3711 explained in Fig. 374B may be used.<br>
Note that the above-mentioned effective first reference index RidxO is indicated by "0" in Fig. 35B, and is a reference index showing to have a motion vector.    In Fig. 35B, the places in which<br><br>
"x" is written indicates that reference indices are not assigned. In a step S3824 in Fig. 36C and in a step S3833 in Fig. 36D, a process after the step S3701 explained in Fig. 34A may be used.<br>
Detailed explanation of method for determining a motion vector will be given below using concrete examples of a block and Fig. 35.<br>
In a step S3801, it is judged if the smallest first reference index RidxO of effective first reference indices RidxOs can be selected.<br>
In the case shown in Fig. 35, there are 2 effective first reference indices RidxO, however, when it is possible to select one smallest first reference index RidxO from effective first reference indices RidxOs in the step S3801, a motion vector selected in the step S3802 is used.<br>
When the effective first reference indices RidxOs include the plural smallest reference indices RidxOs in the step S3801, a motion vector contained in a block selected by priority in a step S3803 is used. Here, the priority, for example, determines a motion vector to be used for motion compensation of a target block to be coded in alphabetical order of pixels contained in blocks. When blocks including pixels B and C respectively contain the same first reference index RidxO, the first reference index RidxO of the block including the pixel B is employed by the priority, and motion compensation is preformed for a target block BLl to be coded using a motion vector corresponding to the first reference index RidxO of the block containing the pixel B. In this case, motion compensation may be performed for the target block BLl to be coded bi-directionally using only the determined motion vector, or may be performed using the second reference index Ridxl and other motion vector as shown below.<br>
In a step S3821, it is judged if the smallest second reference index Ridxl of effective second reference indices Ridxls can be<br><br>
selected.<br>
In the case shown in Fig. 35, since the effective second reference index Ridxl is one, a motion vector corresponding to the second reference index Ridxl of a block containing the pixel C is used in a step S3822.<br>
Note that in the above explanation, as for the block which does not contain reference indices, assuming that the block contains a motion vector of "0", a median value of 3 motion vectors is selected, however, assuming that that the block contains a motion vector of "0", an average value of 3 vectors may be selected, or an average value of motion vectors of blocks containing reference indices may be selected.<br>
Note that a motion vector used for motion compensation of a target block to be coded may be determined by priority different from the one explained above, for example, in order of pixels B - A - C, which are contained in blocks.<br>
Thus, through determining a motion vector used for motion compensation of a target block to be coded by using a reference index, a motion vector can be determined uniquely. Moreover, according to the above-mentioned example, coding efficiency can be improved. In addition, since it is not necessary to judge whether a motion vector is a forward reference or a backward reference using time information, it is possible to simplify a process for determining a motion vector. When concerning a prediction mode for every block and a motion vector used for motion compensation or the like, there are a lot of patterns, however, as mentioned above since a process is done by a series of flows, it is useful.<br>
Note that in this embodiment, the case calculating a motion vector used in the direct mode by scaling a motion vector referred to using a time interval between pictures is explained, however, a calculation may be performed by multiplying by a constant number.<br><br>
Here, a constant used for the multiplication may be variable when coding or decoding is performed on plural blocks basis or on plural pictures basis. Note that a calculation method using reference indices RidxO and Ridxl are not only a method using a median value, and calculation methods may be combined with other calculation methods. For example, in the above-mentioned third calculation method, when motion vectors contained in blocks having pixels A, B and C respectively referring to a same picture of which reference index is the smallest are plural, it is not necessary to calculate a median value of these motion vectors, and a motion vector obtained from averaging these motion vectors may be used as a motion vector of the block BLl used in the direct mode. Or, for example, a motion vector of which coding efficiency is the highest may be selected from plural motion vectors with the smallest reference indices.<br>
Moreover, a forward motion vector and a backward motion vector of the block BLl may be calculated independently or dependently. For example, a forward motion vector and a backward motion vector may be calculated from a same motion vector.<br>
On the other hand, either a forward motion vector or a backward motion vector both obtained from the calculation may be used as a motion vector of the block BLl.<br>
(Eighth Embodiment)<br>
In this embodiment, a reference block MB in a reference picture contains a forward (the first) motion vector referring to a reference picture stored in the long term picture buffer as the first reference picture and a backward (the second) motion vector referring to a reference picture stored in the short term picture buffer as the second reference picture.<br>
Fig. 37 is an illustration showing a bi-prediction in the direct<br><br>
mode when only one reference picture is stored in the long term picture buffer.<br>
The different point of the eighth embodiment from above-mentioned plural embodiments is that a forward motion vector MVZl of a block MB2 in a reference picture refers to a reference picture stored in the long term picture buffer.<br>
The short term picture buffer is a buffer for storing reference pictures temporarily, and, for example, pictures are stored in order in which pictures are stored in a buffer (that is, coding/decoding order). When pictures are newly stored in the buffer there is not enough storage capacity, pictures are deleted from a picture stored most previously in the buffer<br>
In the long term picture buffer, pictures are not always stored in the long term picture buffer in time order as the short term picture buffer. For example, as an order of storing pictures, time order of pictures may be corresponded, and order of address in a buffer in which pictures are stored may be corresponded. Therefore, It is Impossible to scale a motion vector MV21 referring to a picture stored in the long term picture buffer based on a time interval.<br>
A long term picture buffer is not for storing a reference picture temporarily as the short term picture buffer, but for storing a reference picture continuously. Therefore, a time interval corresponding to a motion vector stored in the long term picture buffer is much wider than a time interval corresponding to a motion vector stored In the short term picture buffer.<br>
In Fig. 37, a boundary between the long term picture buffer and the short term picture buffer is indicated by a dotted vertical line as shown in the figure, and information about pictures on the left side of the dotted vertical line is stored in the long term picture buffer, and Information about pictures on the right side of the dotted vertical line is stored in short term picture buffer.    Here, a<br><br>
lock MBl in a picture P23 is a target block. A block MB2 is a o-located reference block of the block MBl in a picture P24. A Dwarf motion vector MV21 of the block MB2 in the reference picture P24 is the first motion vector referring to a picture P21 tored in the long term picture buffer as the first reference picture, dn a backward motion vector MV25 of the block MB2 in the deference picture P24 is the second motion vector referring to a picture P25 stored in the short term picture buffer as the second deference picture.<br>
As mentioned above, a time interval TR21 between the lectures P21 and P24 is corresponded to a forward motion vector 1V21 referring to a picture stored in the long term picture buffer, I time interval TR25 between the pictures P24 and P25 is corresponded to a backward motion vector MV25 referring to a  picture stored in the short term picture buffer, and the time interval "R21 between the pictures P21 and P24 can become much wider hand the time interval TR25 between the pictures P24 and P25 or :an be undefined.<br>
Therefore, a motion vector of the block MBl in the target  picture P23 is not calculated by scaling a motion vector of the block ^B2 in the reference picture P24 as previous embodiments, but the notion vector is calculated using a following method.<br>
MV21 = MV21'<br>
MV24' = 0<br>
The upper equation shows that the first motion vector MV21 stored in the long term picture buffer is used directly as the first notion vector M\/21' in a target picture.<br>
The lower equation shows that since the second motion /actor MV24', which refers to the picture 24 stored in the short :term picture buffer, of the block MBl in the target picture for the picture P23 is enough smaller than the first motion vector MV21', MV24' is negligible.   The second motion vector MV24' is treated as<br><br>
As described above, when a reference block MB contains one motion vector referring to a reference picture stored in the long term picture buffer as the first reference picture and one motion vector referring to a reference picture stored in the short term picture buffer as the second reference picture, bi-prediction i performed using the motion vector stored in the long term picture buffer out of motion vectors of the block in the reference picture directly as a motion vector of a block in a target picture.<br>
Note that a reference picture stored in the long term picture buffer may be either the first reference picture or the second reference   picture,   and   a   motion   vector   MV21   referring   to reference picture stored in the long term picture buffer may be backward motion vector.    Moreover, when the second reference picture is stored  in the long term  picture buffer and the firs reference  picture is stored  in the short term picture buffer, motion vector in a target picture is calculated by scaling a motion vector referring to the first reference picture.<br>
This makes it possible to perform bi-prediction withal using time which is considerably large in the long term picture buffer or undefined.<br>
Note that bi-prediction may be performed not directly using a motion vector referred to but using a motion vector b multiplying by a constant number.<br>
In addition, a constant used for the multiplication may b variable when coding or decoding is performed on plural block basis or on plural pictures basis.<br>
(Ninth Embodiment)<br>
In this embodiment, bi-prediction in the direct mode when reference block MB in a reference picture contains 2 forward motion vectors referring to a reference picture stored in a Ion<br><br>
term picture buffer is shown.<br>
Fig. 38 is an illustration showing bi-prediction in the direct mode when a reference block MB in a reference picture contains 2 forward motion vectors referring to a reference picture stored in the long term picture buffer.<br>
The different point of the ninth embodiment from the eighth embodiment is that both motion vectors M\/21 and MV22 of a block MB2 in a reference picture refer to a picture stored in the long term picture buffer.<br>
In Fig. 38, a boundary between the long term picture buffer and the short term picture buffer is indicated by a dotted vertical line as shown in the figure, and information about pictures on the left side of the dotted vertical line is stored in the long term picture buffer and information about pictures on the right side of the dotted vertical line is stored in short term picture buffer. Motion vectors MV21 and MV22 of the block MB2 in a reference picture P24 both refer to a picture stored in the long term picture buffer. The motion vector MV21 corresponds to a reference picture P21, and the motion vector MV22 corresponds to a reference picture P22.<br>
A time interval TR22 between the pictures P22 and P24 can become much wider than the time interval TR25 between the pictures P24 and P25 or can be undefined corresponding to the motion vector MV22 referring to the picture P22 stored in the long term picture buffer.<br>
In Fig. 38, pictures are stored in order of pictures P22 - P21 in that order in the long term picture buffer. Here the picture P21 corresponds to a motion vector MV21 and the picture P22 corresponds to a motion vector MV22. In Fig. 38, a motion vector of a block MBl in a target picture is calculated as follows.<br>
MV22' = MV22<br>
MV24' = 0<br>
The   upper  equation   shows  that  a   motion   vector  MV22<br><br>
referring to a picture P22 to which the smallest order is assigned is used directly as a motion vector MV22' of the block MBl in a target<br>
picture P23.<br>
The lower equation shows that since the backward motion vector MV24' of the block MBl in the target picture P23 stored in the short term picture buffer is enough smaller than the motion vector MV21', MV24' is negligible. The backward motion vector MV24' is treated as "0".<br>
As described above, by directly using a motion vector referring to a picture to which the smallest order is assigned out of motion vectors of a block in a reference picture stored in the long term picture buffer, bi-prediction can be made without using time which is considerably large in the long term picture buffer or undefined.<br>
Note that bi-prediction may be made not directly using a motion vector referred to but using a motion vector by multiplying by a constant number.<br>
In addition, a constant used for the multiplication may be variable when coding or decoding is performed on plural blocks basis or on plural pictures basis.<br>
Furthermore, when motion vectors MV21 and MV22 of the block MB2 in a reference picture both refer to a picture stored in the long term picture buffer, a motion vector referring to the first reference picture may be selected. For example, when MV21 is a motion vector referring to the first reference picture and MV22 is a motion vector referring to the second reference picture, the motion vector MV21 referring to a picture P21 and a motion vector "0" referring to a picture P24 are used as motion vectors of a block MBl.<br>
(Tenth Embodiment)<br>
In this embodiment, a calculation method of a motion vector<br><br>
in the direct mode shown in the fifth embodiment through the ninth embodiment is explained. This calculation method of a motion vector is applied to either of coding and decoding a picture. Here, a target block to be coded or decoded is called a target block MB. A co-located block of the target block MB in a reference picture is called a reference block.<br>
Fig. 39 is an illustration showing a process flow of a motion vector calculation method of this embodiment.<br>
First, it is judged if a reference block MB in a backward reference picture referred by a target block MB contains a motion vector (step SI). If the reference block MB does not contain a motion vector (No in step SI), bi-prediction is performed assuming that a motion vector is "0" (step S2) and a process for a motion vector calculation is completed.<br>
If the reference block MB contains a motion vector (Yes in step SI), it is judged if the reference block contains a forward motion vector (step S3).<br>
If the reference block does not contain a forward motion vector (No in step S3), since the reference block MB contains only a backward motion vector, the number of backward motion vectors is judged (step S14). When the number of backward motion vectors of the reference block MB is "2", bi-prediction is performed using 2 backward motion vectors scaled based on one of the calculation method mentioned in Figs. 17, 18, 19 and 20.<br>
On the other hand, when the number of backward motion vectors of the reference block MB is "1", the only backward motion vector contained in the reference block MB is scaled and motion compensation is performed using the scaled backward motion vector (step S16). After completing the bi-prediction in the step S15 or S16, a process of the motion vector calculation method is completed.<br>
On the other hand, if the reference block MB contains a<br><br>
forward motion vector (Yes in step S3), the number of forward motion vectors of the reference block MB is judged (step S4).<br>
When the number of forward motion vectors of the reference block MB is "1", it is judged if a reference picture corresponding to the forward motion vector of the reference block MB is stored in the long term picture buffer or the short term picture buffer (step S5).<br>
When the reference picture corresponding to the forward motion vector of the reference block MB is stored in the short term picture buffer, the forward motion vector of the reference block MB is scaled and bi-prediction is performed using the scaled forward motion vector (step 56).<br>
When the reference picture corresponding to the forward motion vector of the reference block MB is stored in the long term picture buffer, bi-prediction is performed based on the motion vector calculation method shown in Fig. 37 assuming that a backward motion vector is 0 and using the forward motion vector of the reference block MB directly without scaling (step S7). After completing the bi-prediction in the step S6 or S7, a process of the motion vector calculation method is completed.<br>
When the number of forward motion vectors of the reference block MB Is "2", the number of forward motion vectors corresponding to a reference picture stored in the long term picture buffer is judged (step S8).<br>
When the number of forward motion vectors corresponding to a reference picture stored In the long term picture buffer Is "0" in the step 58, a motion vector which is temporally close to a target picture containing the target block MB is scaled and bi-prediction is performed using the scaled forward motion vector based on the motion vector calculation method shown in Fig. 14 (step 59).<br>
When the number of forward motion vectors corresponding to a reference picture stored in the long term picture buffer is "1" in the step 58, a motion vector in a picture stored in the short term<br><br>
picture buffer Is scaled and bi-prediction is performed using the scaled motion vector (step SIO).<br>
When the number of forward motion vectors corresponding to a reference picture stored in the long term picture buffer is "2" in the step S8, it is judged if a same picture in the long term picture buffer is referred to by both of 2 forward motion vectors (step Sll). If the same picture in the long term picture buffer is referred to by both of 2 forward motion vectors (Yes in step Sll), bi-prediction is performed using a motion vector previously coded or decoded in the picture referred to by 2 forward motion vectors in the long term picture buffer based on the motion vector calculation method shown in Fig. 13 (step S12).<br>
If a same picture in the long term picture buffer is not referred to by both of 2 forward motion vectors (No in step Sll), bi-prediction is performed using a forward motion vector corresponding to a picture to which a small order is assigned in the long term picture buffer (step S13). In the long term picture buffer, since reference pictures are stored regardless of actual time of pictures, a forward motion vector to be used for bi-prediction Is selected in concordance with an order assigned to each reference picture. There is a case that the order of reference pictures stored in the long term picture buffer coincides with time of pictures, however, it may be merely coincided with an address in the buffer. In other words, the order of pictures stored in the long term picture buffer does not necessarily coincide with time of pictures. After completing bi-prediction in steps S12 and S13, process of the motion vector calculation method is completed.<br>
(Eleventh Embodiment)<br>
Detailed explanation of the eleventh embodiment according to the present invention will be given below using illustrations.<br>
Fig. 40 is a block diagram showing a configuration of a<br><br>
moving picture coding apparatus 1100 according to the eleventh embodiment of the present invention. The moving picture coding apparatus 1100 is an apparatus which can code moving pictures by applying a spatial prediction method in the direct mode even if a block coded in a field structure and a block coded in a frame structure are mixed, and includes a frame memory 1101, a difference calculating unit 1102, a predictive difference coding unit 1103, a bit stream generating unit 1104, a predictive difference decoding unit 1105, an add operating unit 1106, a frame memory 1107, a motion vector detecting unit 1108, a mode selecting unit 1109, a coding control unit 110, a switch 1111, a switch 1112, a switch 1113, a switch 1114, a switch 1115 and a motion vector storing unit 1116.<br>
The frame memory 1101 is a picture memory storing inputted pictures on picture basis. The difference calculating unit 1102 calculates prediction error, which is difference between an inputted picture from the frame memory 1101 and a reference picture obtained from a decoded picture based on a motion vector, and outputs it. The prediction difference coding unit 1103 performs frequency conversion for the prediction error obtained in the difference calculating unit 1102, quantizes and outputs it. The bit stream generating unit 1104 converts into a format of output coded bit stream after performing variable length coding of the coded result from the predictive difference coding unit 1103, and generates a bit stream adding additional information such as header information in which related information on the coded prediction error is described. The predictive difference decoding unit 1105 performs variable length coding and inverse humanization of the coded result from the predictive difference coding unit 1103, and after that performs inverse frequency conversion such as IDCT conversion after performing, and decodes the coded result to output predictive residual.   The add operating unit 1106 adds a<br><br>
predictive residual as a decoded result, to the above-mentioned reference picture, and outputs a reference picture showing a same picture as an inputted picture by coded and decoded picture data. The frame memory 1107 is a picture memory storing reference pictures on picture basis.<br>
The motion vector detecting unit 1108 derives a motion vector for every coding of a target frame to be coded. The mode selecting unit 1109 selects if calculation of a motion vector is performed in the direct mode or in other mode. The coding control unit 1110 reorders inputted pictures stored in the frame memory 1101 in input order to coding order. Additionally, the coding control unit 1110 judges which of a field structure or a frame structure is used for coding for every predetermined size of a target frame to be coded. Here, the predetermined size is a size of 2 macroblocks (for example, 16 (horizontal) x 16 (vertical) pixels) combined vertically (hereinafter, macroblock pair). If a field structure is used for coding, a pixel value is read every other horizontal scanning line corresponding to interlace from the frame memory 1101, if a frame basis is used for coding, each pixel value in inputted picture is read sequentially from the frame memory 1101 and each read pixel value is placed on the memory in order to configure a target macroblock pair to be coded corresponding to the field structure or the frame structure. The motion vector storing unit 1116 stores a motion vector of a coded macroblock and reference indices of frames referred to by the motion vector. Reference indices are stored for each macroblock of coded macro block pairs.<br>
Next, an operation of the moving picture coding apparatus configured as above is explained.    Pictures to be inputted are inputted into the frame memory 1101 on picture basis in time order. Fig. 41A is an illustration showing an order of frames inputted into the moving picture coding apparatus 100 on picture basis in time<br><br>
order. Fig. 416 is an illustration showing an order of pictures reordering the order of pictures shown in Fig. 41A to coding order. In Fig. 41A, a vertical lines indicate pictures, and the number indicated on the lower right side each picture shows the picture types (I, P and B) with the first alphabet letters and the picture numbers in time order with following numbers. Fig. 42 is an illustration showing a structure of a reference frame list 300 to explain the eleventh embodiment. Each picture inputted into the frame memory 1101 is reordered in coding order by the coding control unit 1110. Pictures are reordered in coding order based on referential relation of an inter picture prediction coding, and in the coding order, a picture used as a reference picture is coded previously to a picture referring to a picture.<br>
For example, it is assumed that a P picture uses one of preceding and neighboring 3 I or P pictures as a reference picture. On the other hand, It is assumed that a B picture uses one of preceding and neighboring 3 I or P pictures and one of following and neighboring I or P picture as a reference picture. Specifically, a picture P7 which is inputted after pictures B5 and B6 in Fig. 41A is reordered and placed before pictures 85 and B6 since the picture P7 is referred to by pictures B5 and B6. Likewise, a picture PIO inputted after pictures B8 and B9 is reordered and placed before pictures B8 and B9, and a picture P13 inputted after pictures Bll and B12 is reordered and placed before pictures Bll and B12. Hence, the result of reordering an order of pictures shown in Fig. 41A is as shown in Fig. 41B.<br>
It is assumed that each picture reordered by the frame memory 1101 is read on macroblock pair basis, and each macroblock pair is 16 (horizontal) x 16 (vertical) pixels in size. Here a macroblock pair combines 2 macroblocks vertically. Therefore, a macroblock pair is 16 (horizontal) x 32 (vertical) pixels in size.    A process of coding a picture Bll is explained below.<br><br>
Note that in this embodiment it is assumed that the coding control unit 1110 controls reference indices, that is, a reference frame list.<br>
Since the picture Bll is a B picture, inter picture prediction coding is performed using bi-directional reference. It is assumed that the picture Bll uses 2 of preceding pictures PIO, P7, P4, and a following picture P13 as a reference picture. Additionally, it is assumed that selection of 2 pictures from these 4 pictures can be specified on macroblock basis. Here, it is assumed that reference indices are assigned using a method of initial condition. In other words, a reference frame list 300 during coding the picture Bll is as shown in Fig. 42. Regarding a reference picture in this case, the first reference picture is specified by the first reference index in Fig. 42 and the second reference picture is specified by the second reference index.<br>
In a process for the picture Bll, it is assumed that the coding control unit 1110 controls the switch 1113 to be on, the switches 1114 and 1115 to be off. Therefore, a macroblock pair in the picture Bll read from the frame memory 1101 is inputted into the motion vector detecting unit 1108, the mode selecting unit 109 and difference calculating unit 1102. In the motion vector detecting unit 108, by using decoded data of pictures PIO, P7 and P4 stored in the frame memory 1107 as a reference picture, the first motion vector and the second motion vector of each macroblock contained in a macroblock pair is derived. In the mode selecting unit 1109, a coding mode for a macroblock pair is determined using motion vectors derived in the motion vector detecting unit 1108. Here, it is assumed that coding mode for a B picture may be selected from, for example, intra picture coding, inter picture prediction coding using uni-directional motion vector, inter picture prediction coding using bi-directional motion vector and a direct mode. When coding modes other than the direct mode are selected, it is determined which one of a frame structure<br><br>
or a field structure is used for coding a macroblock pair at the same time.<br>
Here, a motion vector calculation method using a spatial predicting method in the direct mode is explained. Fig. 43A is a flow chart showing an example of a motion vector calculation procedure using a spatial predicting method in the direct mode when a macroblock pair to be coded in a field structure and a macroblock pair to be coded in a frame structure are mixed.<br>
Fig. 43B is an illustration showing an example of a location of neighbouring macroblock pairs to which the present invention is applied when a target macroblock pair to be coded is coded in a frame structure. Fig. 43C is an illustration showing an example of location of neighbouring macroblock pairs to which the present invention is applied when a target macroblock pair to be coded is coded in a field structure. A macroblock pair diagonally shaded in Figs. 43B and 43C is a target macroblock pair to be coded.<br>
When a target macroblock pair to be coded is coded using a spatial prediction in the direct mode, 3 coded macroblock pairs in the neighbor of the target macroblock pair to be coded are selected. In this case, the target macroblock pair may be coded in either of a field structure and a frame structure. Therefore, the coding control unit 1110 first determines which one of a field structure or a frame structure is used for coding a target macroblock pair to be coded. For example, when the number of neighbouring macroblock pairs coded in a field structure is great, a target macroblock pair is coded in a field structure, and if the number of neighbouring macroblock pairs coded in a frame structure is great, a target macroblock pair is coded in a field structure. Thus, by determining which one of a field structure or a frame structure is used for coding a target macroblock pair to be coded by using information on neighbouring blocks, it is not necessary to describe information showing which structure is used for coding a target<br><br>
macroblock pair to be coded in a bit stream. Additionally, since a structure is predicted from neighbouring macroblock pairs, it is possible to select an adequate structure.<br>
Next, the motion vector detecting unit 1108 calculates a motion vector of a target macroblock pair to be coded according to determination of the coding control 1110. First, the motion vector detecting unit 1108 checks which one of a field structure or a frame structure is determined to be used for coding by the control unit 110 (S301), and when the frame structure is determined to be used for coding, a motion vector of a target macroblock pair to be coded is derived using the frame structure (S302), and when the field structure is determined to be used for coding, a motion vector of the target macroblock pair to be coded is derived using the field structure (S303).<br>
Fig. 44 is an illustration showing a data configuration of a macroblock pair when coding is performed using a frame structure, and a data configuration of a macroblock pair when coding is performed using a field structure. In Fig. 44, a white circle indicates a pixel on odd-numbered horizontal scanning lines, and a black circle shaded with a hatch pattern of oblique lines indicates a pixel on even-numbered horizontal scanning lines. When a macroblock pair is cut from each frame showing an inputted picture, pixels on odd-numbered horizontal scanning lines and pixels on even-numbered horizontal scanning lines are placed alternately in a vertical direction as shown in Fig. 44. When the above-mentioned macroblock pair is coded in the frame structure, a process is performed every macroblock MBl and every macroblock MB2 for the macroblock pair, and a motion vector is calculated for each of macroblocks MBl and MB2 forming a macroblock pair. When the macroblock pair is coded in the field structure, the macroblock pair is divided into a macroblocks TF and BF.      Here,   the   macroblock  TF   indicates   a   top   field   and   the<br><br>
macroblock BF indicates a bottom field when interlacing a macroblock pair in a horizontal scanning line direction, and the two fields form a macroblock pair. Then one motion vector is calculated for the two fields respectively<br>
Based on such a macroblock pair, the case that a target macroblock pair to be coded is coded in a frame structure is explained as shown in Fig. 43B. Fig. 45 is a flow chart showing a detailed processing procedure in a step S302 shown in Fig. 43. Note that in Fig. 45 a macroblock pair is indicated as MBP, and a macroblock is indicated as MB.<br>
The mode selecting unit 1109 first calculates a motion vector of a macroblock MBl (an upper macroblock), which is one of macroblocks forming a target macroblock pair to be coded, using a spatial prediction in the direct mode. First, the mode selecting unit 1109 calculates the smallest value of indices in pictures referred to by neighbouring macroblock pairs for the first and the second indices respectively (S501). In this case, however, when a neighbouring macroblock pair is coded in the frame structure, the value is determined using only a macroblock adjacent to a target macroblock to be coded. Next, it is checked if neighbouring macroblock pairs are coded in the field structure (S502), and if coding is performed using the field structure, it is further checked the number of fields to which the smallest index are assigned in fields referred to by 2 macroblocks forming the neighbouring macroblock pairs from a reference frame list in Fig. 42 (S503).<br>
When the check result of the step S503 shows that the smallest index is assigned to either field referred to by the 2 macroblocks (that is, fields to which the same index is assigned), an average value of motion vectors of 2 macroblocks is calculated and made to be a motion vector of the neighbouring macroblock pair. This is since, when considering based on a interlace structure, 2 macroblocks of neighbouring macroblock pairs with<br><br><br>
When the check result of the step S503 shows that the smallest index is assigned to only a field referred to by one macroblock, a motion vector of the macroblock is determined as a motion vector of the neighbouring macroblock pair (S504A). When the smallest index is assigned to none of fields referred to, a motion vector of the neighbouring macroblock pair is assumed to be "0"(S505).<br>
In above cases, from motion vectors of the neighbouring macroblocks, by using only motion vectors referring to fields to which the smallest index is assigned, it is possible to select a motion vector with higher coding efficiency. A process in a step S505 shows that there is no adequate motion vector for prediction.<br>
When the check result of the step S502 shows the neighbouring macroblock pairs are coded in the frame structure, among the neighbouring macroblock pairs, a motion vector of a macroblock adjacent to a target macroblock to be coded is determined as a motion vector of the neighbouring macroblock pair (S506).<br>
The mode selecting unit 1109 repeats processes from above steps S501 to S506 for selected 3 neighbouring macroblock pairs. As a result, a motion vector is calculated for each of 3 neighbouring macroblock pairs as for one macroblock of a target macroblock pair to be coded, for example, a macroblock MBl.<br>
Next, the mode selecting unit 1109 checks if the number of neighbouring macroblock pairs referring to a frame with the smallest index or a field of the frame among 3 neighbouring macroblock pairs is 1 (S507).<br>
In this case, the mode selecting unit 1109 unifies reference indices of 3 neighbouring macroblock pairs to a reference frame index  or  a   reference  field  index,  and   compares  them.     In  a<br><br>
reference frame list shown in Fig. 42, reference indices are merely assigned to every frame, however, since relation between the reference frame indices and reference field indices to which indices are assigned every field are constant, it is possible to convert one of reference frame list or a reference field list into another reference indices by calculation.<br>
Fig. 46 is an indicator chart showing a relation between reference field indices and reference frame indices.<br>
As shown in Fig. 46, there are several frames indicated by the first field fl and the second field f2 in chronological order in a reference field list, and reference frame indices such as 0, 1, and 2 are assigned to each frame based on frames including a target block to be coded (frames shown in Fig. 46). In addition, reference field indices such as 0, 1 and 2 are assigned to the first field fl and the second field f2 of each frame based on the first field fl of a frame including a target block to be coded (when the first field is a target field to be coded). Note that the reference field indices are assigned from the first field f 1 and the second field f2 of a frame close to a target field to be coded. Here, if the target block to be coded is the first field fl, the indices are assigned giving priority to the first field fl, and if the target block to be coded is the second field f2, the indices are assigned giving priority to the second field f2.<br>
For example, when a neighbouring macroblock coded in the frame structure refers to a frame with a reference frame index "1" and a neighbouring macroblock coded in the field structure refers to the first field fl with a reference field index "2", the above-mentioned neighbouring macroblocks are treated as they refer to a same picture. In other words, when a precondition that a reference frame index referred to by one neighbouring macroblock is equal to half the reference field index (round down after decimal   point)  assigned  to  a  reference  field   of another<br><br>
neighbouring     macroblock     is     satisfied,     the     neighbouring macroblocks are treated as they refer to a same picture.<br>
For example, when a target block to be coded included in the first field fl indicated by A in Fig. 46 refers to the first field fl with the reference field index "2", and a neighbouring macroblock with the frame structure refers to a frame with the reference frame index "1", the above-mentioned neighbouring blocks are treated as they refer to a same picture since the above-mentioned precondition is satisfied. On the other hand, when a neighbouring macroblock refers to the first field with a reference field index "2" and other neighbouring macroblock refers to a frame with a reference frame index "3", the neighbouring blocks are treated as they do not refer to a same picture since the precondition is not satisfied.<br>
As mentioned above, if the check result of the step S507 shows the number is 1, a motion vector of a neighbouring macroblock pair referring to a field a frame with the smallest index or a field in the frame is determined as a motion vector of a target macroblock to be coded (S508). If the check result of the step S507 shows the number is not 1, it is further checked if the number of neighbouring macroblock pairs of 3 neighbouring macroblock pairs referring to a frame with the smallest index or a field in the frame is 2 or more (S509). Then if the number is 2 or more, assuming that a motion vector of neighbouring macroblock pairs not referring to a frame with the smallest index or a field in the frame is "0" (S510), a median value of 3 motion vectors of the neighbouring macroblock pairs is determined as a motion vector of a target macroblock to be coded (S511). If the check result of the step S509 is less than 2, since the number of the neighbouring macroblock pairs referring to the frame with the smallest index or the field in the frame is "0", a motion vector of a target macroblock to be coded is determined as "0" (S512).<br><br>
As a result of the above process, one motion vector MVl can be obtained as a calculation result for a macroblock forming a target macroblock pair to be coded, for example, MBl. The mode selecting unit 109 performs the above process for a motion vector with the second reference index, and performs motion compensation by bi-prediction using the 2 obtained motion vectors. However, when none of neighbouring macroblocks contains the first or the second motion vector, motion compensation is performed not using a motion vector in the direction indicated by a motion vector not contained in the neighbouring macroblocks but using a motion vector in unit-direction. Moreover, the same process Is repeated for the other macroblock in the target macroblock pair to be coded, for example, MB2. As a result, it is equal to perform motion compensation in the direct mode for each of 2 macroblocks in a target macroblock pair to be coded.<br>
Next, the case that a target macroblock pair to be coded is coded in the field structure as shown in Fig. 43C is explained. Fig. 47 is a flow chart showing a detailed processing procedure in a step S303 shown In Fig. 43. The mode selecting unit 1109 calculates one motion vector Met using a spatial prediction in the direct mode for a macroblock forming a target macroblock pair to be coded, for example, a macroblock TF corresponding to a top field of the macroblock pair. First, the mode selecting unit 1109 calculates the smallest value of indices in pictures referred to by neighbouring macroblock pairs (S601). However, when the macroblock pairs are processed by the field structure, only a macroblock of a field (a top field or a bottom field) same as the target macroblock to be coded is considered. Next, it is checked if the neighbouring macroblock pairs are coded by the frame structure (S602), and if coding is performed using the frame structure, it is further judged if frames referred to by 2 macroblocks in the neighbouring macroblock pair are frames with the smallest index based on the<br><br>
index value assigned to each frame by a reference frame list 300 (S603).<br>
If the check result of the step S603 shows that the smallest index is assigned to either of the frames referred to by the 2 macroblocks, an average value of motion vectors of the 2 macroblocks is calculated, and the calculation result is determined as a motion vector of the neighbouring macroblock pair (S604). If the check result of the step S603 shows that one or both of the frames referred to are not frames with the smallest index, it is further checked if a frame referred to by either of macroblocks contains the smallest index (S605). If the check result shows that the smallest index is assigned to a frame referred to by one of macroblocks, a motion vector of the macroblock is determined as a motion vector of the neighbouring macroblock pair (S606). On the other hand, if the check result of the step S605 shows that none of macroblocks refers to a frame with the smallest index, a motion vector of the neighbouring macroblock pair is determined as "0" (S607). In above cases, from motion vectors of the neighbouring macroblocks, by using only motion vectors referring to frames to which the smallest index is assigned, it is possible to select a motion vector with higher coding efficiency. A process in a step S607 shows that there is no adequate motion vector for prediction.<br>
When the check result of the step S602 shows the neighbouring macroblock pairs are coded in the field structure, in the neighbouring macroblock pair, motion vectors of the whole neighbouring macroblock pair is determined as a motion vector of the macroblock pair corresponding to a target macroblock in a target macroblock pair to be coded (S608). The mode selecting unit 109 repeats processes from above steps S601 to S608 for selected 3 neighbouring macroblock pairs. As a result, it is equal to obtain a motion vector for 3 neighbouring macroblock pairs<br><br>
 respectively as for a macroblock of the target macroblock pair to be :owed, for example, a macroblock TF.<br>
Next, the motion vector detecting unit 108 checks if the number of neighbouring macroblock pairs referring to a frame with the smallest index among 3 neighbouring macroblock pairs is 1 [S609). If it is 1, a motion vector of a neighbouring macroblock pair referring to a frame with the smallest index is determined as a motion vector of the target macroblock to be coded (S610). If the check result of the step S609 shows the number is not 1, it is Further checked if the number of neighbouring macroblock pairs referring to a frame with the smallest index among 3 neighbouring macroblock pairs is 2 or more (S611). Then if the number is 2 or more, assuming that a motion vector of neighbouring macroblock pairs not referring to a frame with the smallest index is "0" (S612), a median value of 3 motion vectors of neighbouring macroblock pairs is determined as a motion vector of the target macroblock to be coded (S613). If the check result of the step S611 is less than 2, since the number of neighbouring macroblock pairs referring to a frame with the smallest index is "0", a motion vector of the target macroblock to be coded is determined as "0" (S614).<br>
As a result of the above process, a motion vector MVt can be obtained as a calculation result for a macroblock forming a target macroblock pair to be coded, for example, a macroblock TF corresponding to a top field. The mode selecting unit 109 repeats the above process also for the second motion vector (corresponding to the second reference index). As for a macroblock TF, 2 motion vectors can be obtained by above process, and motion compensation is performed using the 2 motion vectors. However, when none of neighbouring macroblocks contains the first or the second motion vector, motion compensation is performed not using a motion vector in the direction indicated by a motion vector not contained in the neighbouring macroblocks but<br><br>
using a motion vector in unit-direction. This is because when a neighbouring macroblock pair refers to only unidirectional, it is conceivable that coding efficiency becomes higher when a neighbouring macroblock pair also refers to only unit-direction.<br>
Moreover, the same process is repeated for another macroblock in the target macroblock pair to be coded, for example, BF corresponding to a bottom field. As a result, it is equal to perform motion compensation in the direct mode for each of 2 macroblocks in the target macroblock pair to be coded, for example, the macroblocks TF and BF.<br>
Note that in the above cases, when a coding structure for a target macroblock pair to be coded and a coding structure for a neighbouring macroblock pair are different, a calculation is performed by a process such as calculating an average value of motion vectors of 2 macroblocks in the neighbouring macroblock pair, however, the present invention is not limited to the above cases. For example, only when a coding structure for a target macroblock pair to be coded and a neighbouring macroblock pair are the same, a motion vector of the neighbouring macroblock pair may be used, and when a coding structure for a target macroblock pair to be coded and a neighbouring macroblock pair are different, a motion vector of the neighbouring macroblock pair of which coding structure is different is not used. Specifically, 1, When a target macroblock pair to be coded is coded in the frame structure, only a motion vector of a neighbouring macroblock pair coded in the frame structure is used. In this case, when none of motion vectors of the neighbouring macroblock pair coded in the frame structure refers to a frame with the smallest index, a motion vector of the target macroblock pair to be coded is determined as "0". When a neighbouring macroblock pair is coded in the field structure, a motion vector of the neighbouring macroblock pair is determined as "0".<br><br>
Next, 2. When a target macroblock pair to be coded is coded in the field structure, only a motion vector of a neighbouring macroblock pair coded in a field structure is used. In this case, when none of motion vectors of the neighbouring macroblock pair coded in the field structure refers to a frame with the smallest index, a motion vector of the target macroblock pair to be coded is determined as "0". When a neighbouring macroblock pair is coded in the frame structure, a motion vector of the neighbouring macroblock pair is determined as "0". Thus, after calculating a motion vector of each neighbouring macroblock pair, 3. When the number of motion vectors obtained by referring to a frame with the smallest index or a field in the frame among these motion vectors is only one, the motion vector is determined as a motion vector of a target macroblock pair in the direct mode, and if the number is not 1, a median value of 3 motion vectors is determined as a motion vector of the target macroblock pair in the direct mode.<br>
Note that in the above cases, which one of a field structure or a frame structure is used for coding a target macroblock pair to be coded is determined based on the majority of a coding structure of coded neighbouring macroblock pairs, however, the present invention is not limited to the above case. A coding structure may be fixed, for example, a frame structure is always used for coding in the direct mode, or a field structure is always used for coding in the direct mode. In this case, for example, when the field structure and the frame structure are switched for an every target frame to be coded, it may be described in a header of whole bit stream or in a frame header of every frame. Switching is performed, for example, on sequence basis, GOP basis, picture basis, and slice basis, and in this case, it may be described in a corresponding header of a bit stream or the like. Needless to say, even in the above cases, only when coding structures used for a target macroblock pair to be coded and a neighbouring macroblock<br><br>
pair are the same, a motion vector of the target macroblock pair to be coded in the direct mode can be calculated by a method using a motion vector of the neighbouring macroblock pair. In addition, when transmitting in such as packets, a header part and a data part may be separated and transmitted respectively. In this case, the header part and the data part are never included in one bit stream. However, as for packets, although a transmission order can be more or less out of sequence, a header part corresponding to a corresponding data part is just transmitted in other packet, and there is no difference even if it is not included in one bit stream. Thus, through fixing which one of the frame structure or the field structure is used, a process for determining a coding structure by using information of neighbor becomes unnecessary, and a process can be simplified.<br>
In addition, in the direct mode, after processing a target macroblock pair using both the frame structure and the field structure, a coding structure with higher coding efficiency may be selected. In this case, it may be described which one of the frame structure and the field structure is selected in a header part of a macroblock pair under coding. Needless to say, even in the above cases, only when coding structures used for a target macroblock pair to be coded and a neighbouring macroblock pair are the same, a motion vector of the target macroblock pair to be coded in the direct mode can be calculated by a method using a motion vector of the neighbouring macroblock pair. By using such a method, information showing which one of the frame structure or the field structure is used becomes necessary in a bit stream, however, it is possible to reduce residual data for motion compensation and coding efficiency can be improved.<br>
In the above explanation, the case that motion compensation is performed for neighbouring macroblock pairs on macroblock size  basis,  however,  motion  compensation  may  be<br><br>
performed on a different size basis. In this case, as shown in Figs. 48A and 48B, a motion vector containing pixels located on a, b and c is used as a motion vector of neighbouring macrobiock pair for each macrobiock of a target macrobiock pair to be coded. Fig. 48A shows the case processing an upper macrobiock, and Fig. 48B shows the case processing a lower macrobiock. When structures (a frame structure/a field structure) for a target macrobiock pair and neighbouring macrobiock pairs are different, a process is performed using a block including pixels located on a, b and c, and a block including pixels located on a', b' and c' as shown in Figs. 49A and 49B. Here, locations a', b' and c' are a block included in another macrobiock in the same macrobiock pair corresponding to locations of pixels a, b, and c. For example, in the case of Fig. 49A, when coding structures (a frame structure/a field structure) for a target macrobiock pair and neighbouring macrobiock pairs are different, a motion vector of a block on the left side of an upper target macrobiock to be coded is determined using motion vectors of BLl and BL2. In the case of Fig. 49B, when coding structures (a frame structure/a field structure) for a target macrobiock pair and neighbouring macrobiock pairs are different, a motion vector of a block on the left side of an upper target macrobiock to be coded is determined using motion vectors of BL3 and BL4. By using such a processing method, even if motion compensation is performed for neighbouring macrobiock on a size basis using a different size from a macrobiock, a process in the direct mode can be performed in consideration of the difference of the frame structure and the field structure.<br>
Moreover, when motion compensation is performed for neighbouring macrobiock on a size basis different from a macrobiock, by calculating an average value of motion vectors of a block included in the macrobiock, the calculated value may be a motion vector of the macrobiock.    Even if motion compensation is<br><br>
performed for neighbouring macroblocks on a size basis using a different size from a macroblock, a process in the direct mode can be performed in consideration of the difference of a frame structure and a field structure.<br>
By the way, as mentioned above, a motion vector is derived, and inter picture prediction coding is performed based on the derived motion vector. As a result, the motion vector derived in the motion vector detecting unit 108 and the coded predictive error picture are stored in a bit stream on macroblock basis. However, as for a motion vector of a macroblock coded in the direct mode, it is merely described that it is coded in the direct mode, and the motion vector and reference indices are not described in a bit stream. Fig. 50 is an illustration showing an example of a data configuration of a bit stream 700 generated by a bit stream generating unit 104. As shown Fig. 50, in the bit stream 700 generated by the bit stream generating unit 104, a Header is provided for every Picture. The Header contains, for example, items such as an Item RPSL showing the change of a reference frame list 10, and an item showing a picture type of the picture and not shown in this figure, and when an assignment method of the first reference index 12 and the second reference index 13 in the frame list 10 is changed form initial settings, an assignment method after change is described In the item RPSL.<br>
On the other hand, coded predictive error is recorded on macroblock basis. For example, when a macroblock is coded using a spatial prediction in the direct mode, a motion vector of the macroblock is not described in an item Blockl, and information showing a coding mode is the direct mode is described in an item PredType. Here, the item Blockl Is an item in which a predictive error corresponding to the macroblock is described, and the item PredType shows a coding mode of the macroblock. When it is selected which one of the frame structure or the field structure is<br><br>
used for coding from the viewpoint of the above-mentioned coding efficiency, information showing the choice between the frame structure and the field structure is described. Subsequently, coded predictive error is described in an item CodedRes. When another macroblock is a macroblock coded in an inter picture prediction coding mode, it is described in the item PredType in an item Block2 that a coding mode for the macroblock is the inter prediction coding mode. Here, the item CodeRes shows a coding mode described and the item PredType is an item in which a predictive error corresponding to the macroblock is described. In this case, the first reference index 12 of the macroblock is further described in an item RidxO, and the second reference index 13 is further described in an item Ridxl other than the coding mode. Reference indices in a block are represented by variable length code words, and the shorter code length is assigned to the smaller value. Subsequently, a motion vector of the macroblock during forward frame reference is described in an item MVO, and a motion vector during backward frame reference is described In an Item MVl. Then coded predictive error is described in the item CodeRes.<br>
Fig. 51 is a block diagram showing a configuration of a moving picture decoding apparatus 800 which decodes the bit stream 700 shown in Fig. 50. The moving picture decoding apparatus 800 is a moving picture decoding apparatus which decodes the bit stream 700 in which a predictive error including a macroblock coded in the direct mode is described, and includes a bit stream analyzing unit 701, a predictive difference decoding unit 702, a mode decoding unit 703, a motion compensation decoding unit 705, a motion vector storing unit 706, a frame memory 707, an add operating unit 708, switches 709 and 710, and a motion vector decoding unit 711. The bit stream analyzing unit 701 extracts various data from inputted bit stream 700.    Here, various<br><br>
lata includes Information such as information on a coding mode mad information on a motion vector or the like. Extracted information on a coding mode is outputted to the mode decoding nit 703, On the other hand, extracted information on a motion ('hector is outputted to the motion vector decoding unit 705. -furthermore, extracted predictive difference coding data is Outputted to the predictive difference decoding unit 702. The Predictive difference decoding unit 702 decodes inputted predictive difference coding data and generates a predictive difference picture. Generated predictive difference picture is Outputted to the switch 709. For example, when the switch 709 is connected to a terminal b, a predictive difference picture is Outputted to the add operating unit 708,<br>
The mode decoding unit 703 controls the switches 709 and<br>
710	referring to a coding mode information extracted form a bit stream. When a coding mode is intra picture coding mode, the mode decoding unit 703 controls to connect the switch 709 with a terminal a and to connect the switch 710 with a terminal c. Moreover, the mode decoding unit 703 outputs a coding mode information to the motion compensation decoding unit 705 and the motion vector decoding unit 711.   The motion vector decoding unit<br>
711	decodes a coded motion vector inputted from the bit stream analyzing unit 701. Decoded reference picture number and a decoded motion vector are stored in the motion vector storing unit 706 and outputted to the motion vector compensation decoding unit 705 at the same time.<br>
When a coding mode is the direct mode, the mode decoding unit 703 controls to connect the switch 709 with the terminal b and to connect the switch 710 with a terminal d. Moreover, the mode decoding unit 703 outputs a coding mode information to the motion compensation decoding unit 705 and the motion vector decoding unit 711.    The motion vector decoding  unit 711  determines a<br><br>
motion vector to be used in the direct mode using a motion vector of neighbouring macroblock pair and a reference picture number stored in the motion vector storing unit 705, when a coding mode is the direct mode. Since the method for determining a motion vector is same as the contents explained for the operation of the mode selecting unit 109 shown in Fig. 40, the explanation will be omitted here.<br>
Based on decoded reference picture number and decoded motion vector, the motion compensation decoding unit 705 obtains a motion compensation picture on macroblock basis from the frame memory 707. The obtained motion compensation picture is outputted to the add operating unit 708. The frame memory 707 is a memory storing decoding pictures on frame basis. The add operating unit 708 adds inputted predictive difference picture to a motion compensation picture, and generates a decoded picture. The generated decoded picture is outputted to the frame memory 707.<br>
As mentioned above, according to this embodiment, even if a neighbouring macroblock pair coded by a frame structure and a neighbouring macroblock pair coded by a field structure are mixed in coded neighbouring macroblock pairs corresponding to a target macroblock pair to be coded include in a spatial prediction method in the direct mode, a motion vector can be easily calculated.<br>
Note that in the above embodiment, the case that each picture is processed on macroblock pair (connecting 2 macroblocks vertically) basis using either a frame structure or a field structure is explained, however, a process may be performed by switching a frame structure and a field structure on a different basis, for example, on macroblock basis.<br>
Moreover, in above embodiment, the case that a macroblock in a B picture is processed in the direct mode, however, a macroblock in a P picture can be processed likewise.    When coding<br><br>
and decoding a P picture, each block performs motion compensation from only one picture, and a reference frame list is only one. Therefore, in order to perform the process same as this embodiment in a P picture, the process calculating 2 motion vectors of a target block to be coded/decoded (the first reference frame and the second reference frame) in this embodiment may be changed to a process calculating one motion vector.<br>
In addition, in the above embodiment, the case that predictive generation of a motion vector used in the direct mode is performed using motion vectors of 3 neighbouring macroblock pairs is explained, however, the number of neighbouring macroblock pairs to be used may be different. For example, a case using only a motion vector of a neighbouring macroblock pair located on the left side is conceivable.<br>
(Twelfth embodiment)<br>
Through storing a program to realize a configuration of the picture coding method and the picture decoding method mentioned in the above embodiment on a storage medium such as a flexible disk, It becomes possible to easily perform the process mentioned in the above embodiment on an independent computer system.<br>
Fig. 52 is an illustration explaining a Storage medium which stores a program to realize the picture coding method and the decoding method of the above first embodiment through eleventh embodiment on a computer system.<br>
Fig. 52B shows an external view of the flexible disk viewed from the front, a configuration of a cross section and the flexible disk, and Fig. 52A shows an example of a physical format of a flexible disk as a body of storage medium. A flexible disk FD is contained in a case F, and plural tracks Tr are formed concentrically on the surface of the disk from outer to inner radius, and each track is divided into 16 sectors Se in angular direction.   Therefore, as<br><br>
for the flexible disk storing the above-mentioned program, a picture coding method and a picture decoding method as the above program are stored in an allocated area on the above-mentioned flexible disk FD.<br>
Fig. 52C shows a configuration for recording and reading the above-mentioned program on and from a flexible disk FD. When above-mentioned program is stored on the flexible disk FD, the picture coding method and a picture decoding method as above-mentioned program are written via a flexible disk drive from a computer system Cs. When the above coding or decoding method is constructed in the computer system by the program on the flexible disk, the program is read from the flexible disk and transferred to the computer system-Note that in the above explanation, a flexible disk is used as a storage medium, however it is possible to perform likewise using an optical disk. Moreover, a storage medium is not limited to a flexible disk and media capable of storing a program such as a CD-ROM, a memory card and a ROM cassette can execute likewise. Applications of the picture coding method and the picture decoding method shown in the above embodiment and a system using the applications will be further explained.<br>
Fig. 53 is a block diagram showing an overall configuration of a content supply system exlOO for realizing content distribution service. The area for providing communication service is divided into cells of desired size, and cell sites exl07 ~ exllO which are fixed wireless stations are placed in each cell.<br>
In this content supply system exlOO, for example, the Internet exlOl is connected to devices such as a computer exlll, a PDA (Personal Digital Assistant) exll2, a camera ells, a cell phone exll4 and a cell phone with a camera exll5 via the Internet service provider exl02, a telephone network exl04 and cell sites exlOlexllO.<br><br>
However, the content supply system exlOO is not limited to the configuration as shown in Fig. 53, and may be connected to a combination of any of them. Also, each device may be connected directly to the telephone network exl04, not through the cell sites exalt-exllO.<br>
The camera exll3 is a device such as a digital video camera capable of shooting moving pictures. The cell phone may be a cell phone of a PDC (Personal Digital Communication) system, a CDMA (Code Division Multiple Access) system, a W-CDMA (Wideband-Code Division Multiple Access) system or a GSM (Global System for Mobile Communications) system, a PHS (Personal Handy phone system) or the like.<br>
A streaming server exl03 is connected to the camera exll3 via the cell site exl09 and the telephone network exl04, and live distribution or the like using the camera exll3 based on the coded data transmitted from the user becomes possible. Either the camera exll3 or the server for transmitting the data may code the data. Also, the moving picture data shot by a camera exll6 may be transmitted to the streaming server exl03 via the computer exlll. The camera exll6 is a device such as a digital camera capable of shooting still and moving pictures. Either the camera exll6 or the computer exlll may code the moving picture data. An LSI exll7 included in the computer exlll or the camera exll6 performs coding processing. Software for coding and decoding pictures may be integrated into any type of storage medium (such as a CD-ROM, a flexible disk and a hard disk) that is a recording medium which is readable by the computer exlll or the like. Furthermore, a cell phone with a camera exll5 may transmit the moving picture data. This moving picture data is the data coded by the LSI included in the cell phone exll5.<br>
The content supply system exlOO codes contents (such as a music live video)  shot by users  using  the camera  exll3,  the<br><br>
camera exll6 or the like in the same manner as the above embodiment and transmits them to the streaming server exl03, while the streaming server exl03 makes stream distribution of the content data to the clients at their request. The clients include the computer exlll, the PDA exll2, the camera exll3, the cell phone exll4 and so on capable of decoding the above-mentioned coded data. In the content supply system exlOO, the clients can thus receive and reproduce the coded data, and further can receive, decode and reproduce the data in real time so as to realize personal broadcasting.<br>
When each device in this system performs coding and decoding, the picture coding apparatus or the picture decoding apparatus shown in the above embodiment may be used. A cell phone is explained as an example.<br>
Fig. 54 is an illustration showing the cell phone exll5 using the picture coding method and the picture decoding method explained in the above embodiments. The cell phone exll5 has an antenna ex201 for communicating with the cell site exllO via radio waves, a camera unit ex203 such as a CCD camera capable of shooting moving and still pictures, a display unit ex202 such as a liquid crystal display for displaying the data obtained by decoding pictures and the like shot by the camera unit ex203 and received by the antenna ex201, a body unit including a set of operation keys ex204, a voice output unit ex208 such as a speaker for outputting voices, a voice input unit 205 such as a microphone for inputting voices, a storage medium ex207 for storing coded or decoded data such as data of moving or still pictures shot by the camera, data of received e-mails and data of moving or still pictures, and a slot unit ex206 for attaching the storage medium ex207 to the cell phone exll5. The storage medium ex207 stores in itself a flash memory element, a kind of EEPROM (Electrically Erasable and Programmable Read Only Memory) that is an electrically erasable<br><br>
and Rewriteable nonvolatile memory, in a plastic case such as a SD card.<br>
Next, the cell phone exll5 is explained with reference to Fig. 55. In the cell phone exll5, a main control unit ex311 for overall controlling each unit of the body unit including the display unit ex202 and the operation keys ex204 is connected to a power supply circuit unit ex310, an operation input control unit ex304, a picture coding unit ex312, a camera interface unit ex303, a LCD (Liquid Crystal Display) control unit ex302, a picture decoding unit ex309, a multiplexing/separating unit ex308, a recording and reading unit ex307, a modem circuit unit ex306 and a voice processing unit ex305 to each other via a synchronous bus ex313.<br>
When a call-end key or a power key is turned ON by a user's operation, the power supply circuit unit ex310 supplies respective components with power from a battery pack so as to activate the digital cell phone with a camera exll5 for making it into a ready state.<br>
In the cell phone exlll, the voice processing unit ex305 converts the voice signals received by the voice input unit ex205 in conversation mode into digital voice data under the control of the main control unitex311 including a CPU, ROM and RAM, the modem circuit unit ex306 performs spread spectrum processing of the digital voice data, and the communication circuit unit ex301 performs digital-to-analog conversion and frequency transform of the data, so as to transmit it via the antenna ex201. Also, in the cell phone exll5, the communication circuit unit ex301 amplifies the data received by the antenna ex201 in conversation mode and performs frequency transform and analog-to-digital conversion for the data, the modem circuit unit ex306 performs inverse spread spectrum processing of the data, and the voice processing unit ex305 converts it Into analog voice data, so as to output it via the voice output unit 208.<br><br>
Furthermore, when transmitting an e-mail in data communication mode, the text data of the e-mail inputted by operating the operation keys ex204 on the body unit is sent out to the main control unit ex311 via the operation input control unit ex304. In the main control unit ex311, after the modem circuit unit ex306 performs spread spectrum processing of the text data and the communication circuit unit ex301 performs digital-to-analog conversion and frequency transform for it, the data is transmitted to the cell site exllO via the antenna ex201.<br>
When picture data is transmitted in data communication mode, the picture data shot by the camera unit ex203 is supplied to the picture coding unit ex312 via the camera interface unit ex303. When it is not transmitted, it is also possible to display the picture data shot by the camera unit ex203 directly on the display unit 202 via the camera interface unit ex303 and the LCD control unit ex302.<br>
The picture coding unit ex312, which includes the picture coding apparatus as explained in the present invention, compresses and codes the picture data supplied from the camera unit ex203 by the coding method used for the picture coding apparatus as shown in the above-mentioned embodiment so as to transform it into coded picture data, and sends it out to the multiplexing/separating unit ex308. At this time, the cell phone exll5 sends out the voices received by the voice input unit ex205 during shooting by the camera unit ex203 to the multiplexing/separating unit ex308 as digital voice data via the voice processing unit ex305.<br>
The multiplexing/separating unit ex308 multiplexes the coded picture data supplied from the picture coding unit ex312 and the voice data supplied from the voice processing unit ex305 by a predetermined method, the modem circuit unit ex306 performs spread spectrum processing of the multiplexed data obtained as a<br><br>
result of the multiplexing, and the communication circuit unit ex301 performs digital-to-analog conversion and frequency transform of the data for transmitting via the antenna ex201.<br>
As for receiving data of a moving picture file which is linked to a Web page or the like in data communication mode, the modem circuit unit ex306 performs inverse spread spectrum processing of the data received from the cell site exllO via the antenna ex201, and sends out the multiplexed data obtained as a result of the processing to the multiplexing/separating unit ex308.<br>
In order to decode the multiplexed data received via the antenna ex201, the multiplexing/separating unit ex308 separates the multiplexed data into a bit stream of picture data and a bit stream of voice data, and supplies the coded picture data to the picture decoding unit ex309 and the voice data to the voice processing unit ex305 respectively via the synchronous bus ex313.<br>
Next, the picture decoding unit ex309, which includes the picture decoding apparatus as explained in the present invention, decodes the bit stream of picture data by the decoding method corresponding to the coding method as shown in the above-mentioned embodiment to generate reproduced moving picture data, and supplies this data to the display unit ex202 via the LCD control unit ex302, and thus moving picture data included in a moving picture file linked to a Web page, for instance, is displayed. At the same time, the voice processing unit ex305 converts the voice data into analog voice data, and supplies this data to the voice output unit ex208, and thus voice data included in a moving picture file linked to a Web page, for instance, is reproduced.<br>
The present invention is not limited to the above-mentioned system, and at least either the picture coding apparatus or the picture decoding apparatus in the above-mentioned embodiments can be incorporated into a digital broadcasting system as shown in<br><br>
  56.    Such satellite or terrestrial digital broadcasting has been<br>
1  the  news  lately.     More  specifically,   a   bit stream  of video<br>
information is transmitted from a broadcast station ex409 to or<br>
communicated with a broadcast satellite ex410 via radio waves.<br>
Ion receipt of it, the broadcast satellite ex410 transmits radio<br>
/avers for broadcasting, a home-use antenna ex406 with a satellite<br>
broadcast  reception function   receives  the  radio  waves,  and  a<br>
television (receiver) ex401 or a set top box (STB) ex407 decodes<br>
he bit stream for reproduction.   The picture decoding apparatus<br>
IS    shown    in    the    above-mentioned    embodiment    can    be<br>
implemented in the reproducing apparatus ex403 for reading off<br>
ind decoding the bit stream recorded on a storage medium ex402<br>
hat is a storage medium such as a CD and a DVD.    In this case,<br>
he reproduced video signals are displayed on a monitor ex404.    It<br>
s also conceived to implement the picture decoding apparatus in<br>
:he set top box ex407 connected to a cable ex405 for a cable<br>
:television or the antenna ex406 for satellite and/or terrestrial<br>
broadcasting so as to reproduce them on a monitor ex408 of the<br>
:television   ex401.      The   picture   decoding   apparatus   may   be<br>
incorporated into the television, not in the set top box.    Or, a car<br>
sx412 having an antenna ex411 can  receive signals from the<br>
satellite ex410  or the cell site exl07 for reproducing  moving<br>
pictures on a display apparatus such as a car navigation system<br>
ex413.<br>
Furthermore, the picture coding apparatus as shown in the above-mentioned embodiment can code picture signals for recording on a storage medium. As a concrete example, there is a recorder ex420 such as a DVD recorder for recording picture signals on a DVD disk ex421 and a disk recorder for recording them on a hard disk. They can be recorded on a SD card ex422. If the recorder ex420 includes the picture decoding apparatus as shown in the above-mentioned embodiment, the picture signals recorded<br><br>
on the DVD disk ex421 or the SD card ex422 can be reproduced for display on the monitor ex408.<br>
As the structure of the car navigation system ex413, the structure without the camera unit ex203, the camera interface unit ex303 and the picture coding unit ex312, out of the components shown in Fig. 55, is conceivable. The same goes for the computer exlll, the television (receiver) ex401 and others.<br>
In addition, three types of implementations can be conceived for a terminal such as the above-mentioned cell phone exll4; a sending/receiving terminal implemented with both an encoder and a decoder, a sending terminal implemented with an encoder only, and a receiving terminal implemented with a decoder only.<br>
As described above, it is possible to use the moving picture coding method or the moving picture decoding method in the above-mentioned embodiments in any of the above-mentioned device and system, and using this method, the effects described in the above embodiments can be obtained.<br>
From the Invention thus described, it will be obvious that the embodiments of the invention may be varied In many ways. Such variations are not to be regarded as a departure from the spirit and scope of the invention, and all such modifications as would be obvious to one skilled in the art are intended for inclusion within the scope of the following claims.<br>
Industrial Applicability<br>
The picture coding apparatus according to the present invention is useful as a picture coding apparatus embedded in a personal computer with communication facility, a PDA, a broadcast station for digital broadcasting and a cell phone or the like.<br>
The picture decoding apparatus according to the present invention is useful as a picture decoding apparatus equipped for a<br><br><br><br><br>
CLAIMS<br>
1.	A motion vector calculation method for inter picture<br>
prediction with reference to a plurality of pictures, the motion<br>
vector calculation method comprising:<br>
a referring step for referring to a plurality of pictures preceding in display order or a plurality of pictures following in display order or a plurality of pictures both preceding and following in display order; and<br>
a motion compensating step for calculating a motion vector of a inter picture predictive block using at least one motion vector, which satisfies a predetermined condition, among motion vectors already calculated for a co-located block of which motion vector is referred to, when performing motion compensation of the inter picture predictive block with reference to a motion vector of the co-located block in a picture other than a picture to which the inter picture predictive block belongs.<br>
2.	The motion vector calculation method according to Claim 1,<br>
wherein in the reference step, each one of pictures selected<br>
from a first picture order and a second picture order can be referred to, the first picture order being the order in which identifying numbers are assigned to pictures in ascending sequence giving priority to a picture precedent in display order, and the second picture order being the order in which identifying numbers are assigned to pictures in ascending sequence giving priority to a picture following In display order,<br>
in the motion compensating step, a motion vector, which refers to a picture in the first picture order, of the block of which motion vector is referred to is used.<br>
3.	The motion vector calculation method according to Claim 2,<br>
wherein in the motion compensating steno. the other picture<br><br>
is a picture having the smallest identifying number of the pictures in the second picture order, and a motion vector of the inter picture predictive block is calculated using the motion vector of the co-located block.<br>
4.	The motion vector calculation method according to Claim 2,<br>
wherein in the motion compensating step, when the block of<br>
which motion vector is referred to contains a plurality of motion vectors referring to a picture stored in a long term picture buffer, a motion vector referring to a picture in the first picture order is used as a motion vector of the inter picture predictive block among motion vectors referring to the picture stored in the long term picture buffer.<br>
5.	The motion vector calculation method according to Claim 1,<br>
wherein   in  the  motion  compensating   step,  the  motion<br>
vector of the inter picture predictive block is calculated using at least one of motion vectors referring to the picture preceding in display order.<br>
6.	The motion vector calculation method according to Claim 1,<br>
wherein in the motion compensating step, when the block of<br>
which motion vector is referred to contains one or more motion vectors, the motion vector of the inter picture predictive block is calculated using a motion vector coded or decoded previously, or a motion vector previously described in a bit stream.<br>
7.	The motion vector calculation method according to Claim 1,<br>
wherein in the motion compensating step, when the block of<br>
which motion vector is referred to contains a plurality of motion vectors referring to one of the pictures preceding or following in display order, a motion vector of the inter picture predictive block<br><br>
is calculated using at least one of the plurality of motion vectors.<br>
8.	The motion vector calculation method according to Claim 1,<br>
wherein in the motion compensating step, when the block of<br>
Which motion vector is referred to contains a plurality of motion vectors referring to one of the pictures preceding and following in display order, a motion vector for performing motion compensation is calculated using one motion vector referring to a picture close to an inter picture predictive picture in display order or one motion vector referring to a picture far in display order among the plurality of motion vectors.<br>
9.	The motion vector calculation method according to one of<br>
Claim 1 ~ Claim 8,<br>
wherein in the motion compensating step, when the block of which motion vector is referred to contains one motion vector stored in the long term picture buffer, as the motion vector of the inter picture predictive block, the motion vector stored in the long term picture buffer is assigned.<br>
10.	The motion vector calculation method according to one of<br>
Claim 1 ~ Claim 8,<br>
wherein in the motion compensating step, when the block of which motion vector is referred to contains at least one motion vector referring to a picture stored in the long term picture buffer, and when the motion vector referring to the picture stored in the long term picture buffer is a motion vector which refers to a picture preceding a picture containing the block of which motion vector is referred to in display order, the motion vector is determined as the motion vector of the inter picture predictive block.<br>
11.	The motion vector calculation method according to one of<br><br><br>
wherein in the motion compensating step, an operation rounding to a predetermined precision of a motion vector is further performed in process of calculating the motion vector of the inter picture predictive block or for the last result.<br>
12.	A motion vector calculation method for the case that inter<br>
picture prediction is performed using a plurality of pictures, the<br>
motion vector calculation method comprising:<br>
an assigning step for assigning one of a first reference index or a second reference index to the coded picture, the first reference index and the second reference index being used for selecting at least one of a first reference picture or a second reference picture which are referred to when obtaining a block in a target picture to be coded by motion compensation from a plurality of coded pictures stored in a storing unit;<br>
a first selecting step, when performing motion compensation of a block in the target picture to be coded, there are a plurality of motion vectors containing the first reference indices among motion vectors of blocks in the neighbor of the target picture to be coded, for selecting a motion vector indicating a median value of the motion vectors; and<br>
a detecting step for detecting a motion vector referring to a picture preceding the target picture to be coded in display order or a picture following the target picture to be coded in display order or pictures preceding and following the target picture to be coded in display order using the motion vector selected in the first selecting step.<br>
13.	The motion vector calculation method according to Claim<br>
12,<br>
wherein   in   the   first   selecting   step,   a   motion   vector<br><br>
indicating a median value of the smallest first reference indices is further selected from motion vectors containing the first reference indices.<br>
14.	The motion vector calculation method according to Claim<br>
13,<br>
wherein the first selecting step further comprises a second selecting step, when in the motion vectors of the blocks In the neighbor of the target picture to be coded there are a plurality of motion vectors containing the second reference indices, for selecting a motion vector indicating a median value of the motion vectors.<br>
15.	The motion vector calculation method according to Claim<br>
14,<br>
wherein in the second selecting step, a motion vector indicating a median value of the smallest second reference indices is further selected from the motion vectors containing the second reference indices.<br>
16.	The motion vector calculation method according to Claims,<br>
wherein in the detecting step, a motion vector selected in<br>
the first selecting step is assumed to be a motion vector of the case that the block in the target picture to be coded refers to a picture preceding the target picture to be coded in display order, and a motion vector selected in the second selecting step Is assumed to be a motion vector of the case that the block in the target picture to be coded refers to a picture following the target picture to be coded in display order.<br>
17.	The motion vector calculation method according to Claim 15,<br>
wherein in the detecting step, a motion vector selected in<br><br>
the first selecting step is assumed to be a motion vector of the case that the block in the target picture to be coded refers to the first reference picture, and a motion vector selected in the second selecting step is assumed to be a motion vector of the case that the block in the target picture to be coded refers to the second reference picture.<br>
18. The motion vector calculation method according to Claim 12, wherein when the neighbouring block is a block in the direct mode which performs coding using a motion vector of other block, a motion vector used virtually for coding or decoding the other block is assumed to be a motion vector of the block in the direct mode.<br>
19- The motion vector calculation method according to Claim 12 comprising instead of the first selecting step:<br>
a judging step, when motion compensation of the block in the target picture to be coded is performed, for determining a motion vector calculation method in concordance with the number of motion vectors containing the smallest first reference indices of motion vectors of the blocks in the neighbor of the blocks in the target picture to be coded,<br>
wherein In the detecting step, instead of the selected motion vector, a motion vector referring to a picture preceding the target picture to be coded in display order or a picture following the target picture to be coded In display order or pictures preceding and following the target picture to be coded in display order is derived by using a determined motion vector detecting method.<br><br>
Motion vector calculation methods for inter picture prediction substantially as herein above described with reference to the accompanying drawings.</td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1DSEVOUC0yMDAzICAgIENPUlJFU1BPTkRFTkNFIE9USEVSUyAgIDMxLTA1LTIwMTEucGRm" target="_blank" style="word-wrap:break-word;">2017-CHENP-2003    CORRESPONDENCE OTHERS   31-05-2011.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1DSEVOUC0yMDAzICAgQU1FTkRFRCAgUEFHRVMgT0YgU1BFQ0lGSUNBVElPTiAgMjEtMDktMjAxMS5wZGY=" target="_blank" style="word-wrap:break-word;">2017-CHENP-2003   AMENDED  PAGES OF SPECIFICATION  21-09-2011.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1DSEVOUC0yMDAzICAgQU1FTkRFRCBDTEFJTVMgIDIxLTA5LTIwMTEucGRm" target="_blank" style="word-wrap:break-word;">2017-CHENP-2003   AMENDED CLAIMS  21-09-2011.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1DSEVOUC0yMDAzICAgRk9STS0xICAgMjEtMDktMjAxMS5wZGY=" target="_blank" style="word-wrap:break-word;">2017-CHENP-2003   FORM-1   21-09-2011.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1DSEVOUC0yMDAzICAgRk9STS0xMyAgMTQtMDMtMjAwNy5wZGY=" target="_blank" style="word-wrap:break-word;">2017-CHENP-2003   FORM-13  14-03-2007.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1jaGVucC0yMDAzICAgZm9ybS0xMyAgMzAtMDQtMjAwOS5wZGY=" target="_blank" style="word-wrap:break-word;">2017-chenp-2003   form-13  30-04-2009.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1jaGVucC0yMDAzICAgZm9ybS0xOCAgMTQtMDMtMjAwNy5wZGY=" target="_blank" style="word-wrap:break-word;">2017-chenp-2003   form-18  14-03-2007.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1DSEVOUC0yMDAzICAgRk9STS0zICAgMjEtMDktMjAxMS5wZGY=" target="_blank" style="word-wrap:break-word;">2017-CHENP-2003   FORM-3   21-09-2011.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1DSEVOUC0yMDAzICAgT1RIRVIgUEFURU5UIERPQ1VNRU5UICAgMjEtMDktMjAxMS5wZGY=" target="_blank" style="word-wrap:break-word;">2017-CHENP-2003   OTHER PATENT DOCUMENT   21-09-2011.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1DSEVOUC0yMDAzICAgUE9XRVIgT0YgQVRUT1JORVkgIDIxLTA5LTIwMTEucGRm" target="_blank" style="word-wrap:break-word;">2017-CHENP-2003   POWER OF ATTORNEY  21-09-2011.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1DSEVOUC0yMDAzICBBTUVOREVEIENMQUlNUyAgMTctMDQtMjAxMi5wZGY=" target="_blank" style="word-wrap:break-word;">2017-CHENP-2003  AMENDED CLAIMS  17-04-2012.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1DSEVOUC0yMDAzICBBTUVOREVEIFBBR0VTIE9GIFNQRUNJRklDQVRJT04gIDE3LTA0LTIwMTIucGRm" target="_blank" style="word-wrap:break-word;">2017-CHENP-2003  AMENDED PAGES OF SPECIFICATION  17-04-2012.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1DSEVOUC0yMDAzICBDT1JSRVNQT05ERU5DRSBPVEhFUlMgIDE3LTA0LTIwMTIucGRm" target="_blank" style="word-wrap:break-word;">2017-CHENP-2003  CORRESPONDENCE OTHERS  17-04-2012.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1DSEVOUC0yMDAzICBFWEFNSU5BVElPTiBSRVBPUlQgUkVQTFkgUkVDRUlWRUQgICAyMS0wOS0yMDExLnBkZg==" target="_blank" style="word-wrap:break-word;">2017-CHENP-2003  EXAMINATION REPORT REPLY RECEIVED   21-09-2011.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1DSEVOUC0yMDAzICBGT1JNLTEzIDE3LTA0LTIwMTIucGRm" target="_blank" style="word-wrap:break-word;">2017-CHENP-2003  FORM-13 17-04-2012.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1DSEVOUC0yMDAzICBGT1JNLTMgMTctMDQtMjAxMi5wZGY=" target="_blank" style="word-wrap:break-word;">2017-CHENP-2003  FORM-3 17-04-2012.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1jaGVucC0yMDAzLWFic3RyYWN0LnBkZg==" target="_blank" style="word-wrap:break-word;">2017-chenp-2003-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1jaGVucC0yMDAzLWNsYWltcy5wZGY=" target="_blank" style="word-wrap:break-word;">2017-chenp-2003-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1jaGVucC0yMDAzLWNvcnJlc3BvbmRuZWNlLW90aGVycy5wZGY=" target="_blank" style="word-wrap:break-word;">2017-chenp-2003-correspondnece-others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1jaGVucC0yMDAzLWNvcnJlc3BvbmRuZWNlLXBvLnBkZg==" target="_blank" style="word-wrap:break-word;">2017-chenp-2003-correspondnece-po.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1jaGVucC0yMDAzLWRlc2NyaXB0aW9uKGNvbXBsZXRlKS5wZGY=" target="_blank" style="word-wrap:break-word;">2017-chenp-2003-description(complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1jaGVucC0yMDAzLWRyYXdpbmdzLnBkZg==" target="_blank" style="word-wrap:break-word;">2017-chenp-2003-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1jaGVucC0yMDAzLWZvcm0gMS5wZGY=" target="_blank" style="word-wrap:break-word;">2017-chenp-2003-form 1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1jaGVucC0yMDAzLWZvcm0gMjYucGRm" target="_blank" style="word-wrap:break-word;">2017-chenp-2003-form 26.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1jaGVucC0yMDAzLWZvcm0gMy5wZGY=" target="_blank" style="word-wrap:break-word;">2017-chenp-2003-form 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1jaGVucC0yMDAzLWZvcm0gNS5wZGY=" target="_blank" style="word-wrap:break-word;">2017-chenp-2003-form 5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAxNy1jaGVucC0yMDAzLXBjdC5wZGY=" target="_blank" style="word-wrap:break-word;">2017-chenp-2003-pct.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="252036-a-method-for-the-synthesis-of-severely-sterically-hindered-secondary-aminoether-alcohols.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="252038-immunostimulatory-oligonucleotide-sequence-and-uses-thereof.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>252037</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>2017/CHENP/2003</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>17/2012</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>27-Apr-2012</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>23-Apr-2012</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>17-Dec-2003</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>PANASONIC CORPORATION</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>1006, OAZA KADOMA KADOMA-SHI, OSAKA, OSAKA 571-8501.</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>KONDO SATOSHI</td>
											<td>OTOKOYAMASHIGETSU YAWATA-SHI KYOTO 614-8361.</td>
										</tr>
										<tr>
											<td>2</td>
											<td>KADONO SHINYA</td>
											<td>Room 204 7-25 Koshienguchi 1-chome Nishinomiya-shi Hyogo 663-8113.</td>
										</tr>
										<tr>
											<td>3</td>
											<td>HAGAI MAKOTO</td>
											<td>22-402, Oedaminami-machi Moriguchi-shi Osaka 570-0051.</td>
										</tr>
										<tr>
											<td>4</td>
											<td>ABE KIYOFUMI</td>
											<td>16-1-213 Miyamae-cho Kadoma-shi Osaka 571-0074.</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04N7/32</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/JP03/04805</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2003-04-16</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>2002-118598</td>
									<td>2002-04-19</td>
								    <td>Japan</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/252037-motion-vector-calculation-method by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 13:35:25 GMT -->
</html>
