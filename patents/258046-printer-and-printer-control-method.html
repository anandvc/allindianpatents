<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/258046-printer-and-printer-control-method by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 06:44:48 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 258046:PRINTER AND PRINTER CONTROL METHOD</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">PRINTER AND PRINTER CONTROL METHOD</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>Described are a -printer and a method of controlling it, in which discarding received data and clearing data from a receive buffer is started when an off-line error occurs and the printer goes offline. When the printer returns on-line, a control unit causes a data receiving unit to stop discarding said received data and causes sending a clear response as an on-line status report telling the host computer that the printer is returning on-line.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td> <br><br>
PRINTER AND PRINTER CONTROL METHOD<br>
BACKGROUND OF THE INVENTION<br>
1.	Field of technology<br>
The present invention relates generally to a printer and a printer control method, and relates more particularly to the internal process of a printer when returning^from an off-line status to an-on-Iine status.<br>
2.	Description of Related Art<br>
A printer system having a printer typically has the printer connected to enable communication with a host computer which generates the print data to be printed and controls printer operations. During printing, for example, the printer executes print control commands received from the host computer to print on slips or roll paper and then output the result.<br>
When the paper runs out or a paper jam occurs inside the printer, the internal status of the printer generally goes from an on-line status, which is the printer state enabling printing, to an off-line status in which the printer does not print, ff a receipt was being printed on roll paper, for example, printing the receipt is interrupted when the printer goes off-line. The printer then returns on-line when the cause of the printer going off-line is removed after the printer has gone off-line.<br>
If the supply of roll paper inside the printer is depleted, for example, the printer is able to return online after a new roll of paper is loaded into the printer. If the roll paper jams inside the printer and the printer thus cannot advance the paper, correctly reloading the paper and then asserting a reset command enables the printer to return on-line.<br>
However, if the roll paper supply runs out, a new roll is loaded into the printer, and the printer returns on-line and then resumes printing, the remaining print data, that is, the print data that was not printed before the printer went off-line, is printed to the roll paper after the printer returns on-line. This results in the receipt content that should normally be printed to a single continuous receipt being printed on two separate pieces of paper. A problem with this is that in some circumstances a receipt that is printed on two separate pieces of paper is meaningless as a receipt. As a result, the same receipt content must be sent from the host computer to the printer again for reprinting, and this wastes paper. This also drastically reduces printing efficiency considering the time and trouble involved with reprinting a receipt, and thus lowers productivity.<br><br>
When the roll paper is reloaded correctly because the roll paper jammed and could not be fed, and the reset command is then asserted to return the printer on-line and resume printing, a portion of the printed paper is often skewed, creased, or badly wrinkled. As a result, the receipt content must be sent from the host computer to the printer again for reprinting. This also wastes paper, drastically reduces printing efficiency, and thus lowers productivity.<br>
Furthermore, new print data received while the printer is off-line is stored in the receive buffer, but the storage capacity of the receive buffer is limited. This means that when a large amount of data such as for a bitmapped image is received, the receive buffer could become full, thus preventing receiving any more data.<br>
JP-A-H11-268384 teaches a printer which receives from the host computer a command instructing - -the printer what process<to execute when the printer returns-froman off-line to an on-line state and thus runs a process determined by cause of status goes back on-line. this can be prevented from printing remaining portion receipt that will most likely unusable.></to>
JP-A-2001-180052 teaches a printer which can select whether to store or to automatically discard new print data received while the printer is off-line, When the received data is automatically destroyed with this printer, additional data is not stored in the receive buffer while the printer is offline, and the receive buffer will thus not become full.<br>
The printer system taught in JP-A-H11-268384 makes no specific mention of the type of command that is communicated between the host computer and printer when the printer returns on-line and controls whether printing is resumed for a receipt for which printing was interrupted.<br>
The printer taught in JP-A-2001 -180052 resends print data from the host after the printer goes online again, but depending upon the print data transmission timing and the timing at which the printer returns on-line, data that should be abandoned may still remain in the receive buffer. Receipt data that should not be printed may thus be printed, and paper thus wasted.<br>
It is an object of the present invention to provide a printer and a printer control method that allow smoothly resuming an interrupted printing operation with no wasted printing when the printer returns on-line from an off-line status.<br>
SUMMARY OF THE INVENTION<br>
A printer according to a first aspect of at least one embodiment of the present invention has a data receiving unit for receiving data sent from a host computer; a data transmission unit for sending data to the host computer; a receive buffer for temporarily storing data received by the data receiving unit; an interpreting unit for interpreting data temporarily stored in the receive buffer; a print buffer for storing a print image when the buffered data is print data; a print mechanism for printing the print<br><br>
image stored in the print buffer; and a control unit for controlling the data receiving unit, the data transmission unit, the receive buffer, the interpreting unit, the print buffer, and the print mechanism. The control unit causes the data receiving unit to start discarding received data and clears the data in the receive buffer when an off-line error occurs. When returning on-line, the control unit causes the data receiving unit to stop discarding the received data and causes the data transmission unit to send an on-line status report to the host computer. After then receiving a clear buffer command from the host computer, the control unit clears the receive buffer again.<br>
Preferably, the control unit clears the print buffer when returning to the on-line state, and then clears the print buffer again according to the clear buffer command.<br>
Yet further preferably, the control unit sends a buffer clearing completion report to the host computer after receiving the clear buffercommand, and then prints based on.print data received-from the host- ,-computer after sending the buffer clearing completion report.<br>
Another aspect of at least one embodiment of the present invention is a printer control method having steps of starting discarding received data and clearing a receive buffer when an off-line error occurs; stopping discarding the received data and sending an on-line status report to a host computer when returning on-line; and clearing the receive buffer again according to a clear buffer command received from the host computer.<br>
Preferably, this printer control method also has a step of clearing a print buffer when returning to the on-line state and then clearing the print buffer again according to the clear buffer command.<br>
Yet further preferably, this printer control method also has steps of sending a buffer clearing completion report to the host computer after receiving the clear buffer command; and printing based on print data received after sending the buffer clearing completion report.<br>
If an error causing the printer to go off-line occurs while printing is in progress and printing is thus interrupted, the receive buffer and the print buffer are both cleared twice regardless of whether the print data for the receipt for which printing was interrupted was not received by the printer, was being received, or is received after the interrupt. As a result, no data to be printed remains in the printer when the printer is again able to print. As a result, the remaining portion of the receipt that was being printed before the error causing the off-line state (referred to herein as an "off-line error") occurred is not printed when the printer returns on-line, and roll paper is thus not wasted.<br>
The host computer then resends to the printer the print data for which printing was interrupted, thus enabling the printer to reprint the receipt in a single continuous printing operation. A drop in efficiency caused by the printer going off-line while printing is in progress can thus be minimized while also enabling printing to continue without interruption.<br>
A further advantage of the present invention in a printer requiring ink or toner for printing is that the useful service life of the ink cartridge or toner cartridge can be extended because the consumption of<br><br>
ink or toner is thus also reduced in addition to reducing paper consumption.<br>
Other objects and attainments together with a fuller understanding of the invention will become apparent and appreciated by referring to the following description of preferred embodiments taken in conjunction with the accompanying drawings.<br>
.  BRIEF DESCRIPTION OF THE DRAWINGS<br>
Pig. 1        is an perspective view showing a printer system according to a preferred embodiment of the present invention;<br>
* - Fig. 2       is a schematic function block diagram showing the control'Configuration- of the printer ■ system shown in Fig. 1;<br>
Fig. 3        is a flow chart of a printer control process;<br>
Fig. 4        is a flow chart of a printer control process;<br>
Fig. 5        is a flow chart of a host computer control process;<br>
Fig, 6        is a timing chart showing commands sent between the host computer and printer; and<br>
Figs, 7(a) and 7(b) describe the need for a clear buffer command,<br>
DESCRIPTION OF THE PREFERRED EMBODIMENTS<br>
Preferred embodiments of a printer and printer control method according to the present invention are described below with reference to the accompanying figures.<br>
As shown in Fig. 1T a printer system 1 according to a preferred embodiment of the invention includes a printer 10 and a host computer 30 controlling the printer 10. The printer 10 is a hybrid device capable of printing both sides of a slip S, scanning the slip S, reading magnetic ink characters on the slip S, and printing a receipt on roll paper P.<br>
The printer 10 has a front cover 13 attached openably and closably to the main unit 11 so as to cover the front top part of the main unit 11, and a back cover 12 attached openably and closably so as to cover the top rear portion of the front cover 13.<br>
A roll paper compartment is formed between the back cover 12 and the main unit 11 of the printer 10. Roll paper P is held in this roll paper compartment The roll paper P is printed by a print head not shown while being advanced through a roll paper transportation path rendered inside the main unit<br><br>
11. The printed roll paper P is then discharged from a roll paper exit 12a formed in the top of the back cover 12. The leading end of the roll paper P i$ shown discharged from the roll paper exit 12a in Fig. 1. This roll paper P is cut either automatically or manually according to the length of the print data and then issued as a single receipt.<br>
A check insertion slot 15 for inserting a slip S is formed below the front cover 13 of the printer 10. A slip S inserted from the check insertion slot 15 is conveyed through the check transportation path 16 formed in the main unit 11, and is discharged from a check exit 17 formed between the front cover 13 and back cover 12. The slip S can be printed and scanned, and magnetic ink characters printed on the slip S can be read, while the slip S is conveyed through the check transportation path 16.<br>
A printer 10 according to this embodiment of the Invention also has a CPU and internal memory. The - CPU-reads and runs firmware stored to nonvolatile memory-such-as flash -ROM, for- example, to control printer operations, including printing. Control of this printer 10 is described more specifically below.<br>
The host computer 30 is described first next.<br>
The host computer 30 is connected by a serial cable, USB cable, or other communication cable. Although not shown, the printer and the host computer could alternatively be connected to communicate wirelessly. The host computer 30 in this embodiment of the invention has input devices such as a touch panel 31 and card reader 32, generates print data based on input from the touch panel 31 and card reader 32, and sends the resulting print data to the printer 10 over the communication cable. The printer 10 then prints on roll paper or a slip based on this print data.<br>
A host computer having a touch panel 31 and card reader 32 is used by way of example in the present embodiment of the invention. Any device capable of controlling the printer 10 can be used instead, and the host computer could be based on a common personal computer, for example.<br>
Internal processes of the printer 10 are described next.<br>
As shown in Fig. 2, the printer 10 has an internal data receiving unit 41, receive buffer 42, command interpreter 43, control unit 44, print buffer 45, print mechanism 46, error detection unit 47, cover detection unit 48, paper detection unit 49, off-line detection unit 50, regular status data generating unit 51, status data comparison unit 52, status data storage unit 53, and data transmission unit 54.<br>
The data receiving unit 41 is a data communication unit for receiving print data and commands sent from the host computer 30, and includes a communication interface. The data receiving unit 41 sequentially stores the received data in the receive buffer.<br>
The receive buffer 42 is a data storage unit of a line buffer or ring buffer type, and stores the data received by the data receiving unit 41 in the order received.<br><br>
The command interpreter 43 reads the data stored in the receive buffer 42 in a first-in, first-out (FIFO) sequence and interprets the content. If the received data is print data, the print data is converted to a bitmap image in the print buffer 45 with reference to a font ROM, for example. If the received data is a control command for the printer 10, the control unit 44 controls the other function units according to the command content and thus provides overall control of the printer 10.<br>
The print mechanism 46 is a printing unit for driving transportation rollers not shown to advance the paper while driving a print head to print. The print mechanism 46 renders paper transportation control and print head control based on the print image written to print buffer 45, and thus prints on a slip S or roll paper P.<br>
The error detection unit 47 is a detection unit for sensing if a paper jam error or other error occurs —during, printing, paper-transportation, or when cutting the paper-The error detection-unit 47-outputsa -■■■ detection signal to the off-line detection unit 50 when an error occurs.<br>
The cover detection unit 48 is a detection unit for sensing if the front cover 13 or back cover 12 is open or closed. The cover detection unit 48 outputs a detection signal to the off-line detection unit 50 when the front cover 13 or back cover 12 is open.<br>
The paper detection unit 49 is a detection unit for sensing if roll paper P is present If the roll paper supply is depleted and there is no roll paper P in the printer 10, the paper detection unit 49 outputs a detection signal to the off-line detection unit 50 .<br>
The off-line detection unit 50 is a detection unit for sensing whether to set the internal status of the printer 10 to the off-line mode or on-line mode. The off-line detection unit 50 tells the control unit 44 to take the printer 10 off-line or on-line according to the detection signals from the error detection unit 47, cover detection unit 48, and paper detection unit 49. The control unit 44 thus switches the internal off-line/on-line status of the printer 10 as instructed by the off-line detection unit 50.<br>
The condition for switching to the off-line status is when any one of the detection units 47 to 49 outputs an error signal (denoting a paper jam, open cover, or no paper). When the cause of the error is then removed and a detection signal denoting an error is not output from any of the detection units 47 to 49, normal printer operation is possible again and the off-line detection unit 50 instructs the control unit 44 to go on-line again.<br>
The regular status data generating unit 51 monitors the status of the error detection unit 47, cover detection unit 48, paper detection unit 49, and off-line detection unit 50, and regularly collects and generates printer status data based on outputs from these other units. The regular status data generating unit 51 outputs the resulting status data to the status data comparison unit 52 as the status data is generated.<br>
The status data comparison unit 52 is a comparator for comparing the current status data generated by the regular status data generating unit 51 and the previous status data stored in the status data<br><br>
storage unit 53. Note that the status data stored in the status data storage unit S3 is the previous status data produced by the regular status data generating unit 51. ThusA comparing this status data enables knowing if the internal status of the printer 10, which is denoted by the current status data detected when the status data was most recently monitored, has changed from the internal status of the printer 10 as denoted by the status data detected the previous time the status data was monitored.<br>
If the status data produced by the regular status data generating unit 51 is the same as the status data previously stored in the status data storage unit 53, the internal status of the printer 10 has not changed and the comparison process ends. If the previous and current status data are different, there has been a change in the internal status of the printer 10. The status data comparison unit 52 therefore updates the status data stored in the status data storage unit 53 to the new (current) status data, and sends the current status data as a status signal through the.data transmission unit 54.to the host computer 30. This process is known as an Automatic Status Back (ASB) function, and this ASB function enables the host computer 30 to always know the current internal status of the printer 10.<br>
The processes run in this embodiment of the invention when the printer goes off-line because there is no roll paper P is described in detail below.<br>
A printer 10 according to this embodiment of the invention can select the operation for returning from the off-line state to the on-line state as a result of receiving a reset operation setup command (1) as shown below from the host computer 30:<br>
GS(J2m	(1)<br>
where m * 0 or 1. "GS (J2" denotes the reset operation setup command relating to the process for recovering from an interruption of printing on roll paper P because the roll ended. When argument m = 0, the control unit 44 runs the normal operating process. When argument m - 1, the control unit 44 runs a process for preventing wasting printing and paper when returning on-line. More specifically, the printer 10 runs the internal processes described below depending upon whether m = 0 or m = 1. The following processes are executed automatically when returning from the off-line state to the online state.<br>
When m * 0: normal operation<br>
(1)	Do not clear the receive buffer and the print buffer;<br>
(2)	If a command was being processed when the error causing the printer to go off-line (off-line error) occurred, the corresponding command process continues.<br>
When m = 1: paper-saving mode<br>
(1)	Clear the receive buffer and the print buffer;<br>
(2)	If a command was being processed when the off-line error occurred, abort the corresponding command process;<br><br>
(3)	Discard and do not store in the receive buffer any data received from when the off-line error occurred until the off-line state is cancelled and the printer returns on-line (this process is not part of the process returning the printer on-line);<br>
(4)	Send a clear response to the host computer 30.<br>
This process is described further below with reference to Fig. 3, When this process starts, the printer 10 is initially set to m = 0, and the printer 10 changes the operating mode when the command shown in statement (1) above is received. More specifically, the printer 10 is set to the normal operating mode based on the initial m = 0 setting (step S1), and waits to receive the reset operation setup command in step S2.<br>
When the reset operation setup command is then received, the printer 10 reads the value of argument m (step S3). If m = 0, the.normal operating mode is reset in step S4.- If m = 1, the paper saving mode is set in step S5, The reset operation setup command can be set by the host computer 30 according to the type of printing as specified by the user.<br>
The paper-saving mode which is executed when m = 1 is described in detail next<br>
Fig. 4 is a flow chart showing the process run by the printer 10 in the paper-saving mode when m = 1, Fig. 5 is a flow chart showing the process run by the host computer 30 in the paper-saving mode when m = 1. Fig. 6 is a timing chart showing the commands communicated between the host computer and printer. The processes executed by the printer 10 and host computer 30 are described in chronological order with reference to Fig. 4r Fig. 5, and Fig. 6 below.<br>
When the printer 10 is on-line and the host computer 30 sends print data for one receipt to the printer 10 as shown in Fig. 5 (step S21), the printer 10 receives the print data and starts printing to the roll paper P by means of the print mechanism 46 as shown in Fig. 4 (step S11).<br>
The printer 10 then continues printing while monitoring whether an error causing the printer 10 to go off-line has occurred (step S12). When the off-line detection unit 50 determines that the roll paper has run out and an off-line error has thus occurred as in this example, printing to the roll paper P is interrupted (step S13), and the control unit 44 of the printer 10 executes the following three processes (step S14):<br>
(a)	Start discarding received data<br>
(b)	Clear receive buffer<br>
(c)	Report off-line status to host computer<br>
In process (a) the data receiving unit discards all print data and commands sent from the host computer 30 after the off-line error occurred, and this data is thus not stored in the receive buffer 42. This prevents the receive buffer 42 from becoming full while the printer 10 is off-line.<br>
Process (b) discards the data that was received from the host computer 30 before the off-line error<br><br>
occurred and is stored in the receive buffer 42. The data stored in the receive buffer 42 may include imprinted data that should be printed on the receipt that Was being printed when printing was interrupted, and this unprinted data is also deleted from printer 10 memory. This prevents the continuation of printing of the unprinted data when the printer 10 returns on-line and thus prevents issuing a partial receipt containing only the remaining unprinted portion of the interrupted receipt.<br>
Process (c) tells the host computer 30 that the printer 10 went off-line. The off-line error causes the status data output by the regular status data generating unit 51 to change from the data stored in the status data storage unit S3, and the status signal is thus automatically sent through the data transmission unit 54 to the host computer 30 in this process (c).<br>
The off-line detection unit 50 of the printer 10 then monitors if the cause of the off-line state has .... been removed, and the printer-10 waits-until the problem i$-tesolved-(step S15).<br>
Meanwhile, as shown In Fig. 5, when the host computer 3Q receives the status signal in step S22 and thus knows that the printer 10 went off-line, the host computer 30 immediately interrupts sending print data to the printer 10 (step S23), The host computer 30 receives a print termination command from the printer 10 each time printing one line of print data ends, and stores all of the print data that is sent or is to be sent to the printer 10 for one receipt until a print termination command indicating that the last line of the receipt being printed has been printed is received from the printer 10. As shown in Fig. 4 and Fig. 5, if the printer 10 goes off-line while printing is in progress and the last line of the receipt is not printed, the print data for that receipt is saved for retransmission after the printer 10 goes back on-line.<br>
If the error is corrected and the printer 10 returns on-line in step S1S (Fig. 4), the control unit 44 of the printer 10 executes the-following four processes in step $16:<br>
(e)	Stop discarding received data<br>
(f)	Report resumption of on-line status to host computer 30 (send clear response 1)<br>
(g)	Clear print buffer<br>
(h) Reinitialize command interpretation Process (e) stops discarding the received data, an operation that was started by process (a) in step $14, and resumes buffering the received data in the receive buffer 42 as usual.<br>
Process (f) sends clear response 1, which reports to the host computer 30 that the printer 10 has returned on-line. Sending this clear response 1 enables the host computer 30 to begin resending the print data to the printer 10.<br>
Process (g) clears the print image data stored in the print buffer 45. If the printer goes off-line while printing is in progress, unprinted print image data is likely to be left in the print buffer 45 when the printer 10 goes off-line. This remaining data is therefore cleared from memory to prevent unnecessary printing.<br><br>
Process (h) reinitializes the command interpreting process of the command interpreter 43, ignores the print data that was being processed, and starts interpreting commands for the data received next.<br>
After executing processes (e) through (h), the printer 10 waits until a new command, particularly a clear buffer command, is received from the host computer 30 (step S17), This clear buffer command is described further in detail below.<br>
The host computer 30 returns a clear buffer command to the printer 10 when clear response 1 is received from the printer 10. This clear buffer command is a command causing the printer 10 to clear the receive buffer and the print buffer again.<br>
Clearing the buffers a second time may be considered unnecessary because the printer 10 has already cleared the^receive buffer and the print buffer in step*S14 and S16, but clearing the buffers may be necessary for the reasons described below.<br>
No problem is likely to occur if all data already sent from the host computer 30 has been cleared when process (e) runs and buffering in the receive buffer 42 resumes. However, if for some reason the on-line state is restored and buffering in the receive buffer 42 resumes before the host computer 30 executes step S23, print data that should be cleared may still be buffered in the receive buffer 42.<br>
This is described more specifically with reference to Fig. 7. As shown in Fig. 7(a), if the printer 10 starts discarding the received data in step S14, the host computer 30 then interrupts sending print data in step S23, and the printer 10 then resumes buffering the received data in the receive buffer 42 in step S16, data does not accumulate in the receive buffer 42 after step S14 executes until the host computer 30 starts resending the print data.<br>
As shown in Fig. 7(b), however, if the printer 10 starts discarding the received data in step 314 and the printer 10 then executes step S16 and resumes buffering data in the receive buffer 42 before the host computer 30 executes step S23 and aborts sending print data, the remaining data for the interrupted receipt, which is to be thrown away, will be stored in the receive buffer 42 after the printer 10 executes step S16 until the host computer 30 interrupts sending the print data.<br>
Considering the situation described in Fig. 7(b), therefore, the receive buffer 42 is preferably cleared again after step S16 executes. The clear buffer command sent in step S25 is the command for thus clearing the buffers.<br>
When the printer 10 receives the clear buffer command, the control unit 44 executes the following four processes in step S18:<br>
(i) Clear receive buffer<br>
Q) Report cleared receive buffer (clear response 2)<br>
(k) Clear print buffer<br>
(I) Reinitialize command interpreting<br><br>
Considering the situation described in Fig. 7(b), step S18 thus repeats the buffer clearing and initialization operations of the processes executed in step S14 and step 316. Step 318 then also sends a clear response 2 to the host computer 30 and the host computer 30 thus knows that the buffer has been cleared.<br>
The host computer 30 watts in step S26 to receive the clear response 2, and in step S27 resends the print data for the receipt for which printing was interrupted when the clear response 2 is received.<br>
The printer 10 thus resumes receiving the receipt print data from the host computer 30, and reprints the entire receipt from the beginning based on the received print data.<br>
Processing by the foregoing-printer 10-according to.this embodiment of the invention is-described • above.<br>
As described above a printer 10 according to this embodiment of the invention has a data receiving unit 41 for receiving data sent from a host computer 30, a data transmission unit 54 for sending data to the host computer 30, a receive buffer 42 for temporarily storing data received by the data receiving unit 41, a command interpreter 43 for interpreting data temporarily stored in the receive buffer 42, a print buffer 45 for storing print image data when the data interpreted by the command interpreter 43 is print data, a print mechanism 46 for printing based on the print image written to the print buffer 45, and a control unit 44 for controlling the data receiving unit 41, receive buffer 42, command interpreter 43, print buffer 45, and print mechanism 46, When an off-line error occurs the control unit 44 starts discarding the data received by the data receiving unit 41 and clears the data stored in the receive buffer 42. When the printer returns on-line, the control unit 44 stops discarding the data received by the data receiving unit 41 and the data transmission unit 54 sends clear response 1 telling the host computer 30 that the printer 10 is returning on-line. The control unit 44 then clears the receive buffer 42 again according to a clear buffer command received from the host computer 30.<br>
More specifically, the control unit 44 clears the print buffer 45 when returning on-line, and again clears the print buffer 45 in response to a clear buffer command from the host computer 30,<br>
Therefore, when an off-line error occurs while printing is in progress and printing is thus interrupted, print data relating to the receipt for which printing was interrupted is not sent to the printer 10, and even if this receipt print data was already received or is later received, no data to be printed remains in the printer 10 when the printer 10 is again able to print because the receive buffer 42 and the print buffer 45 are both cleared twice. The remaining unprinted portion of the receipt that was being printed when the off-line error occurred will thus not be printed when the printer returns on-line, and roll paper will thus not be wasted.<br>
Furthermoret a single continuous receipt can be smoothly printed because the host computer 30 resends all print data for the interrupted receipt to the printer 10 after the printer 10 returns on-line.<br><br>
The drop in efficiency can thus be minimized and continuous printing can be resumed even if an offline error occurs during printing.<br>
The present invention has been described using by way of example a printer as shown in Fig. 1. The invention is not limited, however, to this particular printer and can be applied to various kinds of printers, including inkjet printers, laser printers, dot impact printers, and thermal printers. When applied in a printer that requires ink or toner to print, the present invention reduces ink and toner consumption in addition to reducing paper consumption, and thus also contributes to extending the useful service life of ink cartridges and toner cartridges.<br>
Although the present invention has been described in connection with the preferred embodiments thereof with reference to the accompanying drawings, it is to be noted that various changes and • modifications will be apparent to those skilled in the art Such changes and ^modifications are to be understood as included within the scope of the present invention as defined by the appended claims, unless they depart therefrom.<br>
CLAIMS<br>
1.	A printer comprising:<br>
a data receiving unit for receiving data sent from a host computer;<br>
a data transmission unit for sending data to said host computer;<br>
a receive buffer for temporarily storing data received by said data receiving unit:<br>
an interpreting unit for interpreting data stored in said receive buffer;<br>
a print buffer for storing a print image generated in response to print data among said data stored in said receive buffer;<br>
a print mechanism for printing said print image stored in said print buffer; and<br>
a control unit for-controlling said data receiving unit, said-data transmission-unit, said-receive buffer, said interpreting unit, said print buffer, and said print mechanism;<br>
wherein said control unit is adapted<br>
-	to cause said data receiving unit to start discarding received data and to clear said data said receive buffer when an off-line error occurs,<br>
-	to cause said data receiving unit to stop discarding said received data and to cause said data transmission unit to send an on-line status report to said host computer when said printer returns to an on-line state, and<br>
-	to clear said receive buffer again in response to a clear buffer command received from said host computer.<br><br>
2.	The printer as described in claim 1, wherein sard control unit is adapted to clear said print buffer when the printer returns to an on-line state, and then to clear said print buffer again in response to said clear buffer command.<br>
3.	The printer as described in claim 1, wherein said control unit is adapted to send a buffer clearing completion report to said host computer after receiving said clear buffer command, and to print based on print data received from said host computer after sending said buffer clearing completion report,<br>
4.	A method of controlling a printer communicatively connected to a host computer and<br>
having a receive buffer for temporarily storing data received from the host computer, and a print<br>
buffer for storing a print image generated in response to print data among the data stored in said<br>
receive buffer, the method comprising steps of:<br>
starting discarding received data and clearing the receive buffer when an off-fine error occurs;<br>
stopping discarding said received data and sending an on-line status report to said host computer when returning to an on-line state; and<br>
clearing said receive buffer again according to a clear buffer command received from said host computer.<br><br>
5.	The method as described in claim 4, further comprising a step of:<br>
clearing said print buffer when returning to an on-line state and then clearing said print buffer again according to said clear buffer command.<br>
6.	The method as described in claim 4, further comprising steps of:<br>
sending a buffer clearing completion report to said host computer after receiving said clear buffer command; and<br>
printing based on print data received after sending said buffer clearing completion report.<br>
7.	The printer as described in claim 2 t wherein said control unit is adapted to send a buffer<br>
clearing completion report to said host computer after receiving said clear buffer command, and to<br>
print based on print data received from said host computer after sending said buffer clearing<br>
-- completion-report.<br>
8.	The printer control method as described in claim 5, further comprising steps of:<br>
sending a buffer clearing completion report to said host computer after receiving said clear<br>
buffer command; and<br>
printing based on print data received after sending said buffer clearing completion report.<br>
9.	A control method for a printer that switches from an on-line to an off-Sine state based on<br>
a prescribed cause, wherein after the printer returns from the off-line to the on-line state, the method<br>
executes the following steps:<br>
(a)	clearing a receive buffer and/or a print buffer;<br>
(b)	sending resumption of the on-line to a host;<br>
(c)	receiving a clear buffer command from the host;<br>
(d)	clearing the receive buffer and/or the printer buffer;<br>
(e)	reporting completion of clearing the receive buffer to the host; and<br>
(f)	resuming reception of print data from the host.<br><br></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTIwNS1DSEUtMjAwNSAgIEFNRU5ERUQgQ0xBSU1TICAyMS0wNi0yMDEzLnBkZg==" target="_blank" style="word-wrap:break-word;">1205-CHE-2005   AMENDED CLAIMS  21-06-2013.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTIwNS1DSEUtMjAwNSAgIEFNRU5ERUQgUEFHRVMgT0YgU1BFQ0lGSUNBVElPTiAgMjEtMDYtMjAxMy5wZGY=" target="_blank" style="word-wrap:break-word;">1205-CHE-2005   AMENDED PAGES OF SPECIFICATION  21-06-2013.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTIwNS1DSEUtMjAwNSAgIENPUlJFU1BPTkRFTkNFIE9USEVSUyAgIDIzLTA0LTIwMTMucGRm" target="_blank" style="word-wrap:break-word;">1205-CHE-2005   CORRESPONDENCE OTHERS   23-04-2013.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTIwNS1DSEUtMjAwNSAgIEVOR0xJU0ggVFJBTlNMQVRJT04gIDIxLTA2LTIwMTMucGRm" target="_blank" style="word-wrap:break-word;">1205-CHE-2005   ENGLISH TRANSLATION  21-06-2013.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTIwNS1DSEUtMjAwNSAgIEVYQU1JTkFUSU9OIFJFUE9SVCBSRVBMWSBSRUNFSVZFRCAgMjEtMDYtMjAxMy5wZGY=" target="_blank" style="word-wrap:break-word;">1205-CHE-2005   EXAMINATION REPORT REPLY RECEIVED  21-06-2013.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTIwNS1DSEUtMjAwNSAgIEZPUk0tMyAgIDIxLTA2LTIwMTMucGRm" target="_blank" style="word-wrap:break-word;">1205-CHE-2005   FORM-3   21-06-2013.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTIwNS1DSEUtMjAwNSAgIE9USEVSIFBBVEVOVCBET0NVTUVOVCAgIDIxLTA2LTIwMTMucGRm" target="_blank" style="word-wrap:break-word;">1205-CHE-2005   OTHER PATENT DOCUMENT   21-06-2013.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTIwNS1DSEUtMjAwNSAgUE9XRVIgT0YgQVRUT1JORVkgIDIxLTA2LTIwMTMucGRm" target="_blank" style="word-wrap:break-word;">1205-CHE-2005  POWER OF ATTORNEY  21-06-2013.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTIwNS1jaGUtMjAwNS1hYnN0cmFjdC5wZGY=" target="_blank" style="word-wrap:break-word;">1205-che-2005-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTIwNS1jaGUtMjAwNS1jbGFpbXMucGRm" target="_blank" style="word-wrap:break-word;">1205-che-2005-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTIwNS1jaGUtMjAwNS1jb3JyZXNwb25kbmVjZS1vdGhlcnMucGRm" target="_blank" style="word-wrap:break-word;">1205-che-2005-correspondnece-others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTIwNS1jaGUtMjAwNS1kZXNjcmlwdGlvbihjb21wbGV0ZSkucGRm" target="_blank" style="word-wrap:break-word;">1205-che-2005-description(complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTIwNS1jaGUtMjAwNS1kcmF3aW5ncy5wZGY=" target="_blank" style="word-wrap:break-word;">1205-che-2005-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTIwNS1jaGUtMjAwNS1mb3JtIDEucGRm" target="_blank" style="word-wrap:break-word;">1205-che-2005-form 1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTIwNS1jaGUtMjAwNS1mb3JtIDMucGRm" target="_blank" style="word-wrap:break-word;">1205-che-2005-form 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTIwNS1jaGUtMjAwNS1mb3JtIDUucGRm" target="_blank" style="word-wrap:break-word;">1205-che-2005-form 5.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="258045-a-lubrication-system-for-an-internal-combustion-engine.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="258047-nanoporous-support-medium-with-nanoscale-gold-physically-vapor-deposited-thereon.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>258046</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>1205/CHE/2005</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>48/2013</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>29-Nov-2013</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>28-Nov-2013</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>29-Aug-2005</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>SEIKO EPSON CORPORATION</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>4-1, NISHI SHINJUKU 2 CHOME, SHINJU-KU, TOKYO 163-0811</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>TAKASHI SAIKAWA</td>
											<td>C/O SEIKO EPSON CORPORATION, 3-5 OWA 3 CHOME, SUWA-- SHI, NAGANO 392-8502</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>N/A</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>N/A</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td></td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>2004-249241</td>
									<td>2004-08-27</td>
								    <td>Japan</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/258046-printer-and-printer-control-method by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 06:44:49 GMT -->
</html>
