<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/228980-apparatus-and-method-for-performing-kasumi-ciphering by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 09:37:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 228980:APPARATUS AND METHOD FOR PERFORMING KASUMI CIPHERING</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">APPARATUS AND METHOD FOR PERFORMING KASUMI CIPHERING</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>Techniques for efficient KASUMI ciphering are disclosed. In one aspect, one KASUMI round for generating a fractional portion of the KASUMI cipher is deployed ; with appropriate feedback such that eight sequential rounds produce the KASUMI output. In another aspect, one third of the FO function is deployed with appropriate , feedback such that three successive cycles produce the FO output. In yet another J,5 aspect, the FI function is deployed with appropriate feedback such that two r subsequent cycles produce the FI output. In yet another aspect, a sub-key generator comp.rising two shift registers produces sub-keys for each round and sub-stage thereof in an efficient manner. These aspects, collectively, yield the advanced benefits of low area and low cost implementations of KASUMI with a simple user interface. Various I -other aspects of the invention are also presented.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td> <br><br>
Apparatus &amp; Method for Performing KASUMI Ciphering<br>
BACKGROUND<br>
Field<br>
[1001 ]      The   present   invention   relates   generally  to   communications,   and   more<br>
specifically to a novel and improved method and apparatus for performing KASUMI<br>
ciphering.<br>
Background<br>
[1002] Wireless communication systems are widely deployed to provide various types of communication such as voice, data, and so on. These systems may be based on code division multiple access (CDMA), time division multiple access (TDMA). or some other modulation techniques. A CDMA system provides certain advantages over other types of systems, including increased system capacity.<br>
[1003] A CDMA system may be designed to support one or more CDMA standards such as (1) the "TIA/EIA-SS-B Mobile Station-Base Station Compatibility Standard for Dual-Mode Wideband Spread Spectrum Cellular System" (the IS-95 standard). (2) the "TIA/EIA-98-C Recommended Minimum Standard for Dual-Mode Wideband Spread Spectrum Cellular Mobile Station" (the IS-98 standard). (3) the standard offered by a consortium named "Srd Generation Partnership Project" (3GPP) and embodied in a set of documents including Document Nos. 3G TS 25.211. 3G TS 25.212. 3G TS 25.213. and 3G TS 25.214 (the W-CDMA standard), (4) the standard offered by a consortium named "3rd Generation Partnership Project 2" (3GPP2) and embodied in a set of documents including "TR-45.5 Physical Layer Standard for cdma2000 Spread Spectrum Systems," the "C.S0005-A Upper Layer (Layer 3) Signaling Standard for cdma2000 Spread Spectrum Systems." and the "C.S0024 cdma2000 High Rate Packet Data Air Interface Specification" (the cdma2000 standard), and (5) some other standards. A system that implements the High Rate Packet Data specification of the cdma2000 standard is referred to herein as a high data rate (HDR) system. The HDR system is documented  in TIA/EIA-IS-856. "CDMA2000 High  Rate Packet Data Air  Interface<br><br>
specification". Proposed wireless systems also provide a combination of HDR and low data rate services (such as voice and fax services) using a single air interface. [1004] Encryption techniques are commonly used to provide security for transmitted data, and to provide authentication for users attempting to access data. Encryption is used in a variety of fields, and is particularly useful for digital wireless communication systems.<br>
[1005] One encryption algorithm, specified for use in the W-CDMA standard, is KASUMI. KASUMI is detailed in "Document 2: KASUMI Specification", of the ETSI/SAGE Specification "Specification of the 3GPP Confidentiality and Integrity Algorithms", version 1.0. dated December 23. 1999 (hereinafter the KASUMI specification). Various uses of KASUMI are detailed in the same ETSI/SAGE specification, in "Document 1: f8 and f9 Specification",   KASUMI is a block cipher that<br>
.        ■*■*      _ ^	■;■■■ .J-<br>
produces a 64-bit output from a 64-bit input utilizing a 128-bit key. The output of KASUMI can be used as a keystream to encrypt data, commonly by taking the exclusive-or (XOR) of bits of the keystream with bits of the data to be encrypted. [1006] It is common in the art for communication systems to employ ASICs or other hardware solutions to implement various sub-functions thereof. In ASIC design, smaller utilized area translates to lower costs, higher yields, and often lower power. Low cost and power is beneficial in both fixed and mobile applications, but low power is particularly important in mobile devices which utilize batteries. At the same time, processing must be completed within certain time limits. Wireless data systems, such as W-CDMA systems, will need to incorporate KASUMI implementations into their subscriber and base stations, and designers will need to work within various constraints including those just described. As such, there is a need in the art for an apparatus or method that performs KASUMI ciphering in an efficient manner.<br>
SUMMARY<br>
[1007] Embodiments disclosed herein address the need for efficient apparatus or method for efficient KASUMI ciphering. In one aspect, one KASUMI round for generating a fractional portion of the KASUMI cipher is deployed with appropriate feedback such that eight sequential rounds produce the KASUMI output. In another aspect, one third of the FO function is deployed with appropriate feedback such that<br><br>
three successive cycles produce the FO output. In yet another aspect, the Fl function is deployed with appropriate feedback such that two subsequent cycles produce the Fl output. In yet another aspect, a sub-key generator comprising two shift registers produces sub-keys for each round and sub-stage thereof in an efficient manner. These aspects, collectively, yield the advanced benefits of low area and low cost implementations of KASUMI with a simple user interface. Various other aspects of tne invention are also presented.<br>
[1008] The invention provides methods and system elements that implement various aspects, embodiments, and features of the invention, as described in further detail below.<br>
BRIEF DESCRIPTION OF THE DRAWINGS<br>
[1009]     The features, nature, and advantages of the present invention will become<br>
more apparent from the detailed description set forth below when taken in conjunction<br>
with the drawings in which like reference characters identify correspondingly throughout<br>
and wherein:<br>
[1010]      FIG.  1  is a general block diagram of a wireless communication system<br>
capable of supporting a number of users;<br>
[1011]      FIGS- 2A - 2D depicts the calculations required to perform KASUMI;<br>
[1012]      FIG. 3 is a general block diagram of an embodiment for performing KASUMI;<br>
[1013]     FIG. 4 is a block diagram of an embodiment of a KASUMI round;<br>
[1014]      FIG. 5 is a block diagram of an embodiment of the FL function;<br>
[1015]     FIG. 6 is a block diagram of an embodiment of the FO function;<br>
[1016]      FIG. 7 is a block diagram of an embodiment of the Fl function;<br>
[1017]     FIG. 8 is a block diagram of a sub-key generator;<br>
[1018]     FIG. 9 is a flowchart of one embodiment of KASUMI;<br>
[1019]     FIG. 10 is a flowchart of one embodiment of function FO;<br>
[1020]      FIG. 11 is a flowchart of one embodiment of function Fl;<br>
[1021]     FIG. 12 is a flowchart of one embodiment of a sub-key generator; and<br>
[1022]      FIG. 13 diagrams the control flow for an alternative embodiment of KASUMI.<br><br>
DETAILED DESCRIPTION<br>
[1023] FIG. 1 is a diagram of a wireless communication system 100 that supports a number of users, and which can implement various aspects of the invention. System 100 may be designed to support one or more CDMA standards and/or designs (e.g.. the IS-95 standard, the cdma2000 standard, the HDR specification, the W-CDMA standard). For simplicity, system 100 is shown to include three access points 104 (which may also be referred to as base stations) in communication with two access terminals 106 (which may also be referred to as remote terminals or mobile stations). The access point and its coverage area are often collectively referred to as a "cell". The KASUMI algorithm may be deployed in either one or more access points, one or more access terminals, or both.<br>
[1024] Depending on the CDMA system being implemented, each access terminal 106 may communicate with one (or possibly more) access points 104 on the forward link at any given moment, and may communicate with one or more access points on the reverse link depending on whether or not the access terminal is in soft handcff. The fonward link (i.e., downlink) refers to transmission from the access point to the access terminal, and the reverse link (i.e., uplink) refers to transmission from the access terminal to the access point.<br>
[1025] FIGS. 2A - 2D depict the KASUMI algorithm as defined in the KASUMI specification. FIG. 2A shows the top level diagram of KASUMI 200. FIG. 2B shows the FO function. FIG. 2C shows the Fl function. FIG. 2D shows the FL function. [1026] As shown in FIG, 2A, KASUMI consists of eight rounds. Each round is made up of one FL function, one FO function, and a 32-bit XOR function. The FL functions are denoted as FLi, where i signifies which round is represented and ranges from 1 to 8. Similarly, the FO functions are denoted as FOi. Each round utilizes various sub-keys, denoted as KLi, KOi, and K\\. KL* Is a 32-bit sub-key consisting of two 16-bit sub-keys denoted as KU.i and KU.a. KOi. and Kli are 48-bit sub-keys, each consisting of three 16-bit sub-keys denoted as KOj.i, KOi.2 and KOi.3, Kl^.i, Kli.2 and Kli,3, respectively. The use of the 16-bit sub-keys will be described in further detail with respect to FIGS. 2B - 2D. below.<br>
[1027] Round 1 comprises FLI 202, FOI 204. and 32-bit, bitwise XOR 206. The 64 bit input is divided into two 32 bit segments, which will be described as a left segment<br><br>
and a right segment. The right segment is XORed in XOR 206 with the output of F01 204 to produce a round 1 right output. The right output of each round serves as the left input to the subsequent round. Thus, the round 1 right output will be delivered as the left input to round 2. The left input segment is delivered to FL1 202. where it, utilizing sub-key KLi, is processed according to the FL function, described below. The output of FL1 202 is delivered to FOl 204 for processing with KOi and Kli according to the FO function, also described below. As just mentioned, the output of FOl 204 is delivered to XOR 206 for bit-wise XORing with the right segment of the input. The left input segment will also be delivered as the right input to round 2. In general, the left input of each round will be used for various processing in that round, and will serve as the right input to the subsequent round.<br>
[1028] Round 2 comprises FL2 208, F02 210, and XOR 212, Round 2 is similar to round 1 except that the order of functions FO and FL is reversed. In general, the odd numbered rounds will have the FL function feeding the FO function, and the even numbered rounds will have the FO function feeding the FL function. The right input to round 2 is XORed in XOR 212 with the output of FL2 210 to produce a round 2 right output. As before, the round 2 right output will be delivered as the left input to round 3. The left input segment is delivered to F02 208 for processing with KO2 and KI2 according to the FO function. The output of F02 208 is delivered to FL2 210 for processing with KL2 according to the FL function. The left input segment will also be delivered as the right input to round 3.<br>
[1029] Rounds 3. 5. and 7 are configured similar to round 1, except, of course, that the inputs to each round come from the outputs of the previous round, rather than the KASUMI input. Rounds 4. 6, and 8 are configured similar to round 2. [1030] In round 3, the output of XOR 212 is delivered to FL3 214 for processing with KL3 according to the FL function. The output of FL3 214 is delivered to F03 216 for processing with KO3 and KI3 according to the FO function. The output of F03 216 is delivered to XOR 218 for bitwise XORing with the output of XOR 206. [1031] In round 4. the output of XOR 218 is delivered to F04 220 for processing with KO4. and KI4 according to the FO function. The output of F04 220 is delivered to FL4 222 for processing with KU according to the FL function. The output of FL4 222 is delivered to XOR 224 for bitwise XORing with the output of XOR 212.<br><br>
[1032]      In round 5, the output of XOR 224 is delivered to FL5 226 for processing w^th<br>
KLs according to the FL function.   The output of FL5 226 is delivered to F05 228 for<br>
processing with KO5 and KI5 according to the FO function.   The output of F05 228 is<br>
delivered to XOR 230 for bitwise XORing with the output of XOR 218.<br>
[1033]      In round 6. the output of XOR 230 is delivered to F06 232 for processing with<br>
KOe, and Kle according to the FO function.  The output of F06 232 is delivered to FL6<br>
234 for processing with KU according to the FL function.   The output of FL6 234 is<br>
delivered to XOR 236 for bitwise XORing with the output of XOR 224.<br>
[1034]     In round 7, the output of XOR 236 is delivered to FL7 238 for processing with<br>
KL7 according to the FL function.   The output of FL7 238 is delivered to F07 240 for<br>
processing with KO7 and KI7 according to the FO function.   The output of F07 240 is<br>
delivered to XOR 242 for bitwise XORing with the output of XOR 230.<br>
[1035]      In round 8. the output of XOR 242 is delivered to F08 244 for processing with<br>
KOs, and KU according to the FO function.  The output of F08 244 is delivered to FL8<br>
246 for processing with KLa according to the FL function.   The output of FL8 246 is<br>
delivered to XOR 248 for bitwise XORing with the output of XOR 236.<br>
[1036]     The output of XOR 248 and the output of XOR 242 are concatenated to<br>
produce the 64-bit KASUf^l output. labeled C in FIG. 2A.<br>
[1037]     FIG. 2B depicts the calculation steps to perform the FO function described<br>
above. The FO function takes a 32-bit input and separates it into two 16-bit segments,<br>
the left input and right input, respectively.   Note that the FO function contains three<br>
stages, each containing two 16-bit bitwise XORs and an instance of the function Fli,<br>
denoted Flil, Fli2, and Fli3, respectively, described in detail below.  In this description i<br>
corresponds to the round number, since there is one FO function in each round<br>
described above with respect to FIG. 2A.<br>
[1038]     In the first stage of function FO. the left 16-bit input is bitwise XORed in XOR<br>
250 with the 16 bit sub-key KO  KOi.i, as described above, is a 16-bit sub-key of the<br>
48-bit sub-key KOi. KOi.2 and K0i,3, are also 16-bit sub-keys of KOi. The output of XOR<br>
250 is delivered to Flil 252 for processing with Kli.i. according to the Fl function<br>
described below. Kli.i, as described above, is a 16-bit sub-key of the 48-bit sub-key Klj.<br>
Kli.2 and Klj.3, are also 16-bit sub-keys of Kl,. The output of Flil 252 is delivered to XOR<br>
254 for 16-bit bitwise XORing with the right input.<br><br>
[1039] In the second stage of function FO, the right input is delivered to XOR 256 for 16-bit bitwise XORing with sub-key KOi.2. The result is delivered to Fli2 258 for processing with Kli,2. according to the Fl function. The output of Fli2 258 is delivered to XOR 260 for 16-bit bitwise XORing with the output of XOR 254.<br>
[1040] In the third stage of function FO, the output of XOR 254 is delivered to XOR 262 for 16-bit bitwise XORing with sub-key K0,.3. The result is delivered to Fli3 264 for processing with Kli,3, according to the Fl function. The output of FIi3 264 is delivered to XOR 266 for 16-bit bitwise XORing with the output of XOR 260. The output of XOR 260 is concatenated with the output of XOR 266 to produce the output of the function, labeled FO in FIG. 2B.<br>
[1041] FIG. 20 depicts the calculation steps to perform the Fl function described above. The Fl function takes a 16-bit input and separates it into a 9-bit segment and a 7-bit segment. The Fl function contains two stages with identical processing, with an XOR step between the two stages, identified as XORs 276 and 286. Note that the darker lines in FIG. 20 are used to identify 9-bit paths, and the lighter lines identify 7-bit paths.<br>
[1042] In the first stage, the 9-bit input segment is delivered to function S9 268 for processing, described in further detail below. The 7-bit input segment is zero extended and XORed in XOR 270 with the output of S9 268. The 7-bit input segment is also delivered to function S7 272 for processing, described in further detail below. The 9-bit output of XOR 270 is truncated to seven bits and XORed with the output of S7 272 in XOR 274.<br>
[1043] In XOR 276. the output of XOR 274 is bitwise XORed with sub-key Klij.i. Klij,, is a 7-bit sub-key of Kl,.j, where i indicates the round number, j indicates the FO stage number from which the Fl function is called, and 1 indicates that it is the first sub-key of Klij. In XOR 286. the output of XOR 270 is bitwise XORed with 9-bit sub-key Kli.j.2. Kli,j.2 is the second sub-key of Kl,.j.<br>
[1044] The outputs of XORs 276 and 286 sen/e as the inputs to the second stage of function Fl. The 9-bit output of XOR 286 is delivered to function S9 278 for processing. The 7-bit output of XOR 276 is zero extended and XORed in XOR 280 with the output of S9 278. The output of XOR 276 is also delivered to function S7 282. The 9-bit output of XOR 280 is truncated to seven bits and XORed with the output of S7 282 in XOR 284.<br><br>
The 7-bit output of XOR 284 is concatenated with the 9-bit output of XOR 280 to form the 16-bit output, labeled Fl.<br>
[1045] Function S7 is defined in the KASUMI specification. It takes a 7-bit input and returns a 7-bit output. Equations 1 - 7 below define each output bit, yO through y6, as a function of the seven input bits, xO through x6. The concatenation of two operands, such as x1x3, indicates the logical AND of the operands (i.e. x1 AND x3). The symbol © denotes the exclusive OR function.<br>
yO=    x1x3©x4exOx1x4 0x5©x2x5©x3x4x5©x6® x0x6©x1x6	(1)<br>
© x3x6 © x2x4x6 © x1x5x6 © x4x5x6<br>
y1 =    xOxl © x0x4 © x2x4 © x5 © x1 x2x5 © x0x3x5 ® x6 © x0x2x6 © x3x6    (2) © x4x5x6 © 1<br>
y2 =    xO © x0x3 © x2x3 © x1 x2x4 © x0x3x4 © x1 x5 © x0x2x5 © x0x6	(3)<br>
© xOxl x6 © x2x6 © x4x6 © 1<br>
y3 =    x1 ©x0x1x2©x1x4 6x3x4 ©x0x5©x0x1x5@ X2x3x5©x1x4x5	(4)<br>
© x2x6 © x1 x3x6<br>
y4=    X0x2@x3@x1x3©x1x4©x0x1x4@x2x3x4® x0x5©x1x3x5	(5)<br>
© xOx4x5 © x1x6 © x3x6 © x0x3x6 © x5x6 © 1<br>
y5 =    x2 © x0x2 © x0x3 © x1 x2x3 © x0x2x4 © x0x5 © x2x5 © x4x5	(6)<br>
© x1x6 © x1x2x6 @ x0x3x6 © x3x4x6 © x2x5x6 © 1<br>
y6 =    x1x2 ® x0x1x3 @ x0x4 ® x1x5 ® x3x5 ® x6 ® x0x1x6 ® x2x3x6	(7)<br>
©Xlx4x6©x0x5x6<br>
[1046] Function S9 is defined in the KASUMI specification. It takes a 9-bit input and returns a 9-bit output. Equations 8-16 below define each output bit. yO through y8, as a function of the nine input bits. xO through x8.   The concatenation of two operands.<br><br>
such as xOx2, indicates the logical AND of the operands (i.e. xO AND x2). The symbol ® denotes the exclusive OR function.<br>
yO =    x0x2 ® x3 © x2x5 © x5x6 © xOx7 © x1 x7 © x2x7 © x4x8 © x5x8	(8)<br>
© x7x8 © 1<br>
y1 =    x1 ©xOxl 8x2x3 ©xOx4®x1x4© X0x5®x3x5®x6©x1x7	(9)<br>
© x2x7 © x5xB ® 1<br>
y2 =    x1 © x0x3 © x3x4 © x0x5 © x2x6 ® x3x6 ® x5x6 © x4x7® x5x7	(10)<br>
© x6x7 © x8 © x0x8 © 1<br>
y3 =    xO ® x1 x2 © x0x3 © x2x4 © x5 © x0x6 ® x1 x6 ® x4x7 ® x0x8	(11)<br>
©Xlx8©x7x8<br>
y4 =    xOx1 ©xlx3©x4 @x0x5©x3x6© X0x7©x5x7©x1x8©x2x8	(12)<br>
©x3x8<br>
y5=    x2©x1x4@x4x5@xOxS@x1x6© X3x7©x4x7©x6x7® x5x8	(13)<br>
© x6x8 © x7x8 ® 1<br>
y6=    X0©x2x3©x1x5©x2x5©x4x5©x3x6©x4x6® x5x6® x7	(14)<br>
© x1 x8 © x3x8 © x5x8 © x7x8<br>
y7 =    xOx1 © x0x2 © x1 x2 © x3 © x0x3 © x2x3 © x4x5 ® x2x6 @ x3x6	(15)<br>
© x2x7 © x5x7 ® x8 © 1<br>
y8=   xOx1 © x2©x1x2® x3x4©x1x5® x2x5® x1x6® x4x6®x7	(16)<br>
© x2x8 ® x3x8<br>
[1047]     FIG. 2D depicts the FL function described above with respect to FIG. 2A. The 32-bit input is divided into two 16-bit segments, a left segment and a right segment. The<br><br>
left input segment is bitwise ANDed with KLi,t in AND gate 288, denoted by the ^ symbol. The output of AND gate 288 is rotated left by one bit in rotator 290. denoted by the ((( symbol. The output of rotator 290 is bitwise XORed with the right input segment in XOR 292. The output of XOR 292 is bitwise ORed in OR gate 298, denoted by the u symbol. The output of OR gate 298 is rotated left by one bit in rotator 296. The output of rotator 296 is bitwise XORed with the left input segment in XOR 294. The 32-bit output, denoted FL. is formed by concatenating the output of XOR 294 with the output of XOR 292.<br>
[1048] The KASUMI algorithm requires eight rounds of calculation to produce the desired result, as just described. In one embodiment, hardware for a single round is deployed and reused with the appropriate feedback to produce the eight-round KASUMI output. FIG. 3 depicts such an exemplary embodiment. The word "exemplary" is used exclusively herein" to mean "serving as an example, instance, or illustration." Any embodiment described herein as "exemplary" is not necessarily to be construed as preferred or advantageous over other embodiments.<br>
[1049] FIG- 3 depicts KASUMI 300, which comprises sub-key generator 310. KASUMI round 330. and KASUMI calculation controller 320. KASUMI round 330 receives sub-keys from sub-key generator 310. KLi.i and KL,,2 are connected directly, and KO,., and Kl^ are delivered through muxes 340 and 350, respectively. Mux 340 receives KO,.-:, KO,.2. and K0,.3 from sub-key generator 310. Mux 350 receives Kli,i. Kl,.2. and Kl,,3 from sub-key generator 310. The set of subkeys, KO,., and Kli.i. to be delivered to KASUMI round 330 from muxes 340 and 350. respectively, is determined via the control signal, subkey_select, from KASUMI calculation controller 320. All of the sub-keys are generated in sub-key generator 310 from a key input, labeled K, which is 128 bits in length. Sub-key generator 310 also receives a load signal and a rotate signal from KASUMI calculation controller 320. Sub-key generation will be detailed more fully below.<br>
[1050] KASUMI calculation controller 320 receives as inputs a reset signal and a start signal. It produces a done signal to indicate that the KASUMI output has been generated. Such a signal to indicate completion is optional. Alternative embodiments may eliminate such a signal if the completion time is known based on characteristics of the system. The start signal in the exemplary embodiment is synchronized such that key, K, and the 64-bit input are valid when the start signal is strobed.  Various signals<br><br>
are shown in FIG. 3 for controlling the operation of KASUMI round 330. Kasumi_data_flow. kasumi Jnput_select. and kasumi_output_reg_en are used to control the round-level functioning within KASUMI round 330. FoJnput_select and fo_output_reg_en are used to control the FO function within KASUMI round 330. Fi_input_select and fi_output_reg_en are used to control the Fl function within KASUMI round 330. In the exemplary embodinnent, these last two signals are identical so only a single control signal is needed to control the Fl function. Subsets of these signals may be needed depending on how various embodiments are deployed. Various signaling schemes for controlling memory and feedback circuits are known in the art and are within the scope of the present invention. Detailed description of the control required is provided below.<br>
[1051] KASUMI ROUND 330 receives, in addition to the control signals and sub-keys just mentioned, a 64-bit input upon which a 64-bit output is generated (the calculation of which was detailed in reference to FIGS. 2A-2D).<br>
[1052] FIG. 4 depicts KASUMI round 400, which is an exemplary embodiment of KASUMI round 330. just described. In KASUMI round 400, the 64-bit input, in. is divided into two 32-bit segments, the upper half (63:32) and the lower half (31:0). The upper half is connected to an input of mux 405. The lower half is connected to an input of mux 410. Two registers 445 and 450 latch results computed in KASUMI round 400 when kasumi_output_reg_en is asserted, and the outputs of the registers 445 and 450 are concatenated to produce the 64-bit output, out. In addition, the output of register 445 is fed back as an input to mux 410 and the output of register 450 is fed back as an input to mux 405. The muxes 405 and 410 are controlled by kasumijnput_select, which causes in to be selected when not asserted and the feedback results to be selected when asserted. Muxes 405 and 410 operate together as a selector for selecting between the input and the contents of the memory formed by registers 445 and 450. In this manner, the KASUMI round 400 can be utilized to perform the first round of KASUMI, when in is selected, and subsequent rounds of KASUMI when the previous round's results are fed back.<br>
[1053] The heart of the processing of a KASUMI round, as described in relation to FIGS. 2A - 2D above, is carried out in the FL function 425, the FO function 430. and the XOR 440. However, as described above, while the functions are each used in every round, the processing order differs from round to round.   Three muxes, 415, 420. and<br><br>
435. provide the switching needed to reuse the components in each subsequent round of KASUMI. The FL function 425. the FO function 430, the XOR 440, and the muxes 415, 420. and 435 together form one embodiment of a partial round calculator. The output of the partial round calculator, which is comprised of the input to mux 415 delivered from the output of mux 405, concatenated with the output of XOR 440, is stored in the memory formed by registers 445 and 450. The input to the partial round calculator comes from the output of the selector formed by muxes 405 and 410. Numerous circuit implementations of a selector, partial round calculator, and memory, as just described, will be readily apparent to those skilled in the art. Each of these embodiments is within the scope of the present invention.<br>
[1054] The three muxes, 415, 420, and 435. make up a data flow selector for configuring the KASUMI round for even and odd round calculations. They are all controlled by the selector signal kasumi^datajlow. Mux 415 selects the output of mux 405 when kasumi_data_flow is asserted, and selects the fed back output of function FO 430 when kasumi_data_flow is deasserted. Mux 420 selects the output of register 445 when kasumi_data_flow is deasserted, and selects the fed back output of function FL 425 when kasumi_data.flow is asserted. The output of mux 415 is delivered to function FL 425, the output of which is delivered to mux 435. The output of mux 420 is delivered to function FO 430, the output of which is also delivered to mux 435. Mux 435 selects the output of function FL 425 when kasumi_dataJlow is deasserted. and selects the output of function FO 430 when kasumi_dataJlow is asserted. The output of mux 435 is delivered as in input to bitwise XOR 440. The other input of bitwise XOR 440 is the output of mux 410. The input to register 450, described above, is the output of XOR 440. The input to register 445. described above, is the output of mux 405, Those skilled in the art will recognize that the configuration depicted in FIG. 4, coupled with the appropriate manipulations of control signals kasumijnput_select, kasumi_data_flow, and kasumi_output_reg_en. can be used to implement the required KASUMI calculations described with respect to FIG, 2A above. The control signaling for this embodiment will be described in further detail below.<br>
[1055] FIG. 5 depicts an embodiment of the FL function 500. suitable for use as function FL 425 described in FIG. 4 above. FL function 500 receives a 32-bit input, in, and produces a 32-'bit output, out. The upper half {bits 31 through 16) of in are bitwise ANDed with sub-key KLj.i in AND gate 510. The output of AND gate 510 is rotated one<br><br>
bit left in rotator 520. The output of rotator 520 is bitwise XORed with the lower half (bits 15 through 0) of the input in XOR 530. The results of XOR 530 are bitwise ORed with sub-key KLi,2 in OR gate 540. The output of OR gate 540 is rotated left one bit in rotator 550. The output of rotator 550 is bitwise XORed with the upper half of the input in XOR 560. The output of XOR 560 is concatenated with the output of XOR 530 to produce the 32-bit output, out.<br>
[1056] FIG. 6 depicts an embodiment of the FO function 600, suitable for use as function FO 430 described in FIG. 4 above. FO function 600 receives a 32-bit input, in. and produces a 32-bit output, out. In this embodiment, components for one of the three FO stages, described above, are deployed. Registers and appropriate feedback allow the single stage to be used sequentially three times to produce the FO output. [1057] The two registers 660 and 670 are used to store the intermediate calculations, when fo_output_reg_en is asserted. The output of register 660 is delivered as an input to mux 620. The output of register 670 is delivered as an input to mux 610. The upper half of input, in. serves as the other input to mux 6^0. The lower half of input, in, serves as the other input to mux 620. Signal fo_input_select directs muxes 610 and 620 to select between the input, in. and the fed back values from the registers 660 and 670, respectively. The output of mux 610 is bitwise XORed with sub-key KO,., in XOR 630. The output of XOR 630 is delivered to function Fl 640, to be processed with sub-key KI^j, as described in further detail below. The output of function Fl 640 is bitwise XORed with the output of mux 620 in XOR 650. The output of XOR 650 is delivered as the input to register 650. described above. The output of mux 620 is delivered as the input to register 670, described above. The output of mux 620 is concatenated with the output of XOR 650 to form the 32-bit output, out,<br>
[1058] Registers 660 and 670 form a memory. Muxes 610 and 620 form a selector. XOR 630. Fl function 640, and XOR 650 form a partial FO calculator. The selector selects between the input and the memory results for delivering the input to the partial FO calculator. The output of the partial FO calculator is stored in the memory. Numerous circuit implementations of a selector, partial FO calculator, and memory, as just described, will be readily apparent to those skilled in the art. Each of these embodiments is within the scope of the present invention.<br>
[1059] FIG. 7 depicts an embodiment of the Fl function 700. suitable for use as function Fl 640 described in FIG. 6 above.   Fl function 700 receives a 16-bit input, in.<br><br>
and produces a 16-bit output, out. In this embodiment, components for one of the two Fl stages, described above, are deployed. Registers and appropriate feedback allow the single stage to be used sequentially twice to produce the Fl output. [1060] The two registers 745 and 750 are used to store the intermediate calculations, when fi_output„reg_en is asserted. The output of 9-bit register 745 is delivered as an input to mux 705. The output of 7-bit register 750 is delivered as an input to mux 710. The upper nine bits of the input, in, serves as the other input to mux 705. The lower seven bits of input, in, serves as the other input to mux 710. Signal fijnput_select directs muxes 705 and 710 to select between the input, in, and the fed back values from the registers 745 and 750, respectively. The output of mux 705 is delivered for processing in function S9 715. described above. The output of function S9 715 is bitwise XORed with the zero-extended output of mux 710 in XOR 720. The output of mux 710 is also delivered for processing in function S7 725. The output of function S7 725 is bitwise XORed with the truncated output of XOR 720 in XOR 730. The output of XOR 720 is bitwise XORed with sub-key Kl,i,2 in XOR 735. The output of XOR 730 is bitwise XORed with sub-key Kli.j.i in XOR 740. The output of XOR 735 is delivered as the input to register 745. described above. The output of XOR 740 is delivered as the input to register 750. described above. The output of XOR 730 is concatenated with the output of XOR 720 to produce the 16-bit output, out.<br>
[1061] Note that in this embodiment, the signals fi_input_select and fi_output_reg_en are identical, so a common signal can be shared between mux 705, mux 710, register 745. and register 750. In alternate embodiments, when each Fl processing cycle corresponds to one cycle of the clock controlling registers 745 and 750. then an enable signal is not needed on those registers. The registers simply delay the results of XORs 735 and 740 by one cycle in which they are used to calculate the second half of Fl. Various techniques such as these can be employed and are well known in the art. [1062] Registers 745 and 750 form a memory. Muxes 705 and 710 form a selector. Function S9 715. XOR 720. function S7 725, and XORs 730, 735. and 740 form a partial Fl calculator. The selector selects between the input and the memory results for delivering the input to the partial Fl calculator. The output of the partial Fl calculator, an intermediate value, is stored in the memory. In addition, the output of XORs 720 and 730 also serve as the Fl output.  Numerous circuit implementations of a selector, partial<br><br>
Fl calculator, and memory, as just described, will be readily apparent to those skilled in the art. Each of these embodiments is within the scope of the present invention. [1063] FIG. 8 depicts sub-key generator 800. Sub-key generator 800 receives a 128-bit key, K, and produces the various sub-keys described above in conjunction with the load and rotate signals. Sub-key generator 800 contains two 128-bit shift registers 810 and 820. Each of these is parallel-loadable when the load signal is asserted, and each performs an 8-bit left rotation when the rotate signal is asserted. The load signal is asserted once at the beginning of a KASUMI calculation. The rotate signal is enabled after each round is completed to create new sub-keys for the next round. A more detailed description of these control signals in relation to the other control signals is given below.<br>
[1064] Note that numerous ways to implement these rotatable shift registers will be readily apparent to those skilled in the art. For example, a shift register can be made into a rotating shift register by feeding back the shifted out bit as the input to the first stage. Such a rotating shift register can be shifted eight times to produce the 8-bit left rotation. Alternatively, the shift register can be wired such that each shift rotates each bit by eight positions (or byte-wise left rotation). This alternative is equivalent to implementing eight interleaved 16 bit shift registers, configured with their outputs fed back to their respective inputs.<br>
[1065] Shift register 820 consists of 8 16-bit sections labeled K1 through K8-K(127:112) serves as the load input for K1. K(111:96) serves as the load input for K2. K(95:80) serves as the load input for K3. K(79:64) serves as the load input for K4. K(63:48) sen/es as the load input for K5. K(47:32) serves as the load input for K6. K(31:16) sen/es as the load input for K7. K(15:0) serves as the load input for K8. [1066] Shift register 810 consists of 8 16-bit sections labeled KV through K8\ The load inputs for shift register 810 are formed by bitwise XORing various segments of K with constants CI through C8, which are defined in the KASUMI specification. Table 1 provides the values of these constants.<br><br><br>
[1067] The load input to KV is generated by bitwise XORing K(127:112) with CI in XOR 801. The load input to K2' is generated by bitwise XORing K(111:96) with C2 in XOR 802. The load input to K3' is generated by bitwise XORing K(95;80) with 03 in XOR 803- The load input to K4' is generated by bitwise XORing K(79:64) with 04 in XOR 804. The load input to K5' is generated by bitwise XORing K(63:48) with 05 in XOR 805. The load input to K6* is generated by bitwise XORing K(47:32) with 06 in XOR 806. The load input to KT is generated by bitwise XORing K(31:16) with 07 in XOR 807. The load input to K8' is generated by bitwise XORing K(15:0) with 08 in XOR 808. Of course, since each XOR 801-808 has a constant as one of the operands, each of the 128 XORs can be replaced by a wire when the corresponding constant is a "0" and an inverter when the corresponding constant is a "1".<br>
[1068] Some of the sub-keys are tapped directly from shift register 810. KIH,2 is tapped from K3\ Kli.2 is tapped from K4'. Kl»,t is tapped from K5\ Kii,3 is tapped from K8\ Other sub-keys are generated by rotating various segments of shift-register 820. KLi.i is generated by rotating K1 left by one bit in rotator 830. KOjj is generated by rotating K2 left by five bits in rotator 840. KOi.2 is generated by rotating K6 left by eight bits in rotator 850. K0j,3 is generated by rotating K7 left by thirteen bits in rotator 860. Note that since each of these rotators rotates by a constant value, each rotation can be accomplished through simple wire-mapping. Those skilled in the art will recognize how such wire-mapping is to be implemented, and will recognize various other techniques for rotation as well.<br><br>
[1069] FIG. 9 is a flowchart detailing steps performed in one embodiment of KASUMI. In addition, these steps can be utilized by KASUMI calculation controller 320 if an embodiment such as that described with respect to FIG. 3 is deployed. These steps can also be applied to an embodiment such as KASUMI round 400 described with respect to FIG. 4.<br>
[1070] The process begins at start 902, which proceeds to block 904. In block 904, i is set to 1, where i signifies the round number. The input to the KASUMI round is selected for computing the round, since this is round one. This corresponds to setting kasumijnput_select to zero, as shown in FIG. 4. Proceed to block decision block 906, where a test is performed to determine if the current round, denoted by i. is even or odd. If i is odd, i.e. 1, 3. 5, or 7, then proceed to block 908. If i is even. i.e. 2. 4. 6. or 8. then proceed to block 910.<br>
[1071] In block 908. the data flow of the KASUMI round is configured to flow from the input (in round one) or the feedback (in rounds three, five and seven) to the FL function to the FO function to the XOR gate. This corresponds to setting kasumi__dataJlow to one in FIG. 4.<br>
[1072] In block 910, the data flow of the KASUMI round is configured to flow from the feedback to the FO function to the FL function to the XOR gate. This corresponds to setting kasumi_data JIow to zero in FIG. 4.<br>
[1073] From either block 908 or 910, proceed to block 912 to compute the KASUMI round. One embodiment for computing a KASUMI round is detailed in FIG. 4. but any method for computing a KASUMI round is within the scope of the flowchart of FIG. 9. Once the KASUMI round is computed, the results are stored in the latch results block 914. This corresponds to asserting the kasumi_reg_en signal shown in FIG. 4. Proceed to decision block 916.<br>
[1074] In decision block 916, if i equals eight, then the eighth and final round has been performed, and the process is completed in KASUMI done block 922. In an embodiment employing a done signal, such as that shown in FIG. 3, that signal can be asserted at this point. When i is less than eight, there are additional rounds to be performed, so i is incremented by one in block 918. Proceed to block 920 where the feedback, from the latched results of block 914, is selected for computing the next round. This corresponds to setting kasumijnput_select to one in FIG. 4.  Loop back to<br><br>
decision block 906, to perform the next round. Repeat the steps until KASUMl done biock 922 is reached.<br>
[1075] FIG, 10 is a flowchart detailing the steps performed in one embodiment of the FO function. In addition, these steps can be utilized by KASUMl calculation controller 320 if an embodiment such as that described with respect to FIG. 3 is deployed. These steps can also be applied to an embodiment such as FO function 600 described with respect to FIG. 6.<br>
[1076] The process begins at start 1002, which proceeds to block 1004. In block 1004, j is set to 1, where j signifies the stage number. The input to the FO function is selected for computing, since this is stage one. This corresponds to setting foJnput_se\ect to one, as shown \n FIG. 6. Furthermore, the stage number, j, correlates with the signal subkey_select shown in FIG. 3. (In some embodiments, subkey„select values of 0, 1, and 2 correspond to j values of 1,2. and 3, Alternatively, a three input mux can be deployed which selects based on subkey^select values of 1,2, and 3, identical to the j value.)<br>
[1077] Proceed to block 1006, where one third of the FO function is computed- One embodiment capable of computing one third of an FO function is depicted in FIG. 6, but others are also within the scope of the flowchart of FIG. 10. The results of the one-third calculation are stored in latch results block 1008, This corresponds to asserting fo_output_en in FIG. 6. Then proceed to decision block 1010 to test if j is equal to 3, If it is, then proceed to FO complete block 1016, the FO function has been completed. If j is less than three, then more stages are yet to be completed. Proceed to block 1012 to increment j by one. Than proceed to block 1014, where feedback, the results latched in block 1008. is selected as the input to the FO function. This corresponds to setting fojnput^select to zero in FIG. 6. Loop back to block 1006 to calculate the next stage, and repeat the process until all the stages are completed.<br>
[1078] FIG. M is a flowchart detailing the steps performed in one embodiment of the Fl function. In addition, these steps can be utilized by KASUI\/I1 calculation controller 320 if an embodiment such as that described with respect to FIG. 3 is deployed. These steps can also be applied to an embodiment such as Fl function 700 described with respect to FIG. 7.<br>
[1079] The process begins at start 1102, which proceeds to block 1104. In block 1104, the input is selected for computing, which corresponds to setting fijnput_select to<br><br>
one in FIG. 7. Proceed to block 1106 where one half of the Fl function is computed. Proceed to block 1108 to latch the results of the first half of Fl. calculated in block 1106. Proceed to block 1110, where feedback is selected for computing, which corresponds to setting fijnput^select to zero in FIG. 7. Proceed to block 1112 where the second half of F! is computed. Proceed to block 1114, Fl computing is complete. [1080J FIG. 12 is a flowchart detailing steps performed for controlling an embodiment of a sub-key generator, such as the one described above with respect to FIG. 8. In addition, these steps can be utilized by KASUMI calculation controller 320 if an embodiment such as that described with respect to FIG. 3 is deployed, [1081] The process begins at start 1202. which proceeds to block 1204. In block 1204, i is set to 1, where i signifies the round number. The sub-key shift registers are loaded. For example, the load signal in FIG. 3 may connect to a sub-key generator 800, shown in FIG. 8, that, when asserted, loads the two shift registers 810 and 820. Proceed to block 1206 and wait for the current set of sub-keys to be used, which will commonly be the time required for one KASUMI round to transpire. During this time, one set of sub-keys, corresponding to round one will be in effect. Proceed to decision block 1208.<br>
[1082] In decision block 1208, if i equals eight, then the eighth and final KASUMI round has been performed, and the process is completed in done block 1214. If another KASUMI computation is required, proceed back to start 1202. When i is less than eight, there are additional rounds needing new sets of sub-keys. Proceed to block 1210 to rotate the sub-key shift registers. This corresponds to asserting the rotate signal in FIG. 3, and causes 8-bit left rotations in shift registers 810 and 820, as described above in relation to FIG. 8. Proceed to block 1212 to increment i by one. Loop back to block 1206 to provide sub-keys for another KASUMI round. Repeat the steps until done block 1214 is reached.<br>
[1083] FIG. 13 is a flowchart depicting the steps to perform KASUMI incorporating the techniques described with respect to FIGS. 3-8 and the flowcharts in FIGS, 9-12 described above. An exemplary embodiment using the steps of FIG. 13 is KASUMI 300. described in FIG. 3 above. An exemplary KASUMI 300 may employ KASUMI calculation controller 320 which performs the control steps described in FIG. 13 in conjunction with sub-key generator 310 and KASUMI round 330. Sub-key generator 310 may be one such as sub-key generator 800. described in FIG. 8.  KASUMI round<br><br>
330 may be one such as KASUMI round 400, described in FIG. 8. KASUMI round 400 may employ FL function 500 and FO function 600, described in FIGS. 5 and 6, respectively. FO function 600 may employ Fl function 700, described in FIG. 7. The flowchart in FIG. 13 begins at start 1302 and proceeds to block 1304. [1084] In block 1304, i is set to 1. where i signifies the round number. The input to the KASUMI round is selected for computing the round, since this is round one. This corresponds to setting kasumi_input_select to zero, as shown in FIG. 4. The sub-key shift registers are loaded. For example, the load signal in FIG. 3 may connect to a sub-key generator 800, shown in FIG. 8, that, when asserted, loads the two shift registers 810 and 820.<br>
[1085] Proceed to decision block 1306. where a test is performed to determine if the current round, denoted by i. is even or odd. If i is odd. i.e. 1. 3, 5. or 7, then proceed to block 1308. If i is even. i.e. 2. 4. 6, or 8, then proceed to block 1310. In block 1308. the data flow of the KASUMI round is configured to flow from the input (in round one) or the feedback (in rounds three, five and seven) to the FL function to the FO function to the XOR gate. This corresponds to setting kasumi_dataJlow to one in FIG. 4. In block 1310, the data flow of the KASUf\/!l round is configured to flow from the feedback to the FO function to the FL function to the XOR gate. This corresponds to setting kasumi_data_flow to zero in FIG. 4.<br>
[10861 From either block 1308 or 1310, proceed to block 1312 to begin computing the KASUMI round. The sub-functions of the round are described first, such as the stages of FJ and FO. but as those skilled in the art will know, these method steps can be interchanged without departing from the scope of the invention.<br>
[1087] In block 1312, the FO function is initialized. J is set to 1, where j signifies the stage number. The input to the FO function is selected for computing the FO function, since this is FO stage one. This corresponds to setting foJnput_select to one, as shown in FIG. 6. Furthermore, the stage number, j, correlates with the signal subkey_select shown in FIG. 3. The correlation between subkey_select and j was described in detail above with respect to FIG. 10. Proceed to block 1314 to perform the Fl function.<br>
[1088] In block 1314, the input is selected for computing the Fl function, which corresponds to setting fijnput_select to one in FIG. 7. Proceed to block 1316 where one half of the Fl function is computed. One embodiment capable of computing one half<br><br>
of an Fl function is depicted in FIG. 7, but others are also within the scope of the flowchart of FIG. 13. Proceed to block 1318 to latch the results of the first half of Fi, calculated in block 1316. Proceed to block 1320. where Fl feedback is selected for computing the Fl function, which corresponds to setting fijnput_select to zero in FIG. 7. Proceed to block 1322 where the second half of Fl is computed. Proceed to block 1324 to continue with FO processing. Fl computing is complete.<br>
[1089] In block 1324. one third of the FO function is computed. One embodiment capable of computing one third of an FO function is depicted in FIG. 6, but others are also within the scope of the flowchart of FIG. 13. The results of the one-third calculation are stored in latch FO results block 1326. This corresponds to asserting fo_output_en in FIG. 6. Then proceed to decision block 1328 to test if j is equal to 3. If it is, then FO processing is complete. Proceed to block 1334 to continue KASUMI processing. If j is less than three, then more stages are yet to be completed. Proceed to block 1330 to increment j by one. Then proceed to block 1332, where feedback, the FO results latched in block 1326. is selected as the input to the FO function. This corresponds to setting fojnput^select to zero in FIG. 6. Loop back to block 1314 to calculate the next stage, and repeat the process until all the stages are completed.<br>
[1090] In block 1334, compute the KASUMI round. One embodiment for computing a KASUMI round is detailed in FIG. 4. but any method for computing a KASUMI round is within the scope of the flowchart of FIG. 13. Once the KASUMI round is computed in block 1334. the results are stored in the latch KASUMI results block 1336. This corresponds to asserting the kasumi_reg_en signal shown in FIG. 4. Proceed to decision block 1338.<br>
[1091] In decision block 1338, if i equals eight, then the eighth and final round has been performed, and the process is completed in KASUMI done block 1346. In an embodiment employing a done signal, such as that shown in FIG, 3, that signal can be asserted at this point. When i is less than eight, there are additional rounds to be performed, so i is incremented by one in block 1340. Proceed to block 1342 where the feedback, the latched results of block 1336, is selected for computing the next round. This corresponds to setting kasumijnput_select to one in FIG. 4. The next round will need a new set of sub-keys, so proceed to block 1344 to rotate the sub-key shift registers. This corresponds to asserting the rotate signal in FIG. 3. and causes 8-bit left rotations in shift registers 810 and 820, as described above in relation to FIG. 8.  Loop<br><br>
back to decision block 1306, to perform the next round. Repeat the steps until KASUMI done block 1346 is reached.<br>
[1092] It should be noted that in all the embodiments described above, method steps can be interchanged without departing from the scope of the invention. [1093] Those of skill in the art will understand that information and signals may be represented using any of a variety of different technologies and techniques. For example, data, instructions, commands, information, signals, bits, symbols, and chips that may be referenced throughout the above description may be represented by voltages, currents, electromagnetic waves, magnetic fields or particles, optical fields or particles, or any combination thereof.<br>
[1094] Those of skill will further appreciate that the various illustrative logical blocks, modules, circuits, and algorithm steps described in .connection with the embodiments disclosed herein may be implemented as electronic hardware, computer software, or combinations of both. To clearly illustrate this interchangeability of hardware and software, various illustrative components, blocks, modules, circuits, and steps have been described above generally in terms of their functionality. Whether such functionality is implemented as hardware or software depends upon the particular application and design constraints imposed on the overall system. Skilled artisans may implement the described functionality in varying ways for each particular application, but such implementation decisions should not be interpreted as causing a departure from the scope of the present invention.<br>
[1095] The various illustrative logical blocks, modules, and circuits described in connection with the embodiments disclosed herein may be implemented or performed with a general purpose processor, a digital signal processor (DSP), an application specific integrated circuit (ASIC), a field programmable gate array (FPGA) or other programmable logic device, discrete gate or transistor logic, discrete hardware components, or any combination thereof designed to perform the functions described herein. A general purpose processor may be a microprocessor, but in the alternative, the processor may be any conventional processor, controller, microcontroller, or state machine. A processor may also be implemented as a combination of computing devices, e.g.. a combination of a DSP and a microprocessor, a plurality of microprocessors, one or more microprocessors in conjunction with a DSP core, or any other such configuration.<br><br>
[1096] The steps of a method or algorithm described in connection with the embodiments disclosed herein may be embodied directly in hardware, in a software module executed by a processor, or in a combination of the two. A software module may reside in RAM memory, flash memory, ROM memory, EPROM memory, EEPROM memory, registers, hard disk, a removable disk, a CD-ROM, or any other form of storage medium known in the art. An exemplary storage medium is coupled to the processor such the processor can read information from, and write information to, the storage medium. In the alternative, the storage medium may be integral to the processor. The processor and the storage medium may reside in an ASIC. The ASIC may reside in a user terminal. In the alternative, the processor and the storage medium may reside as discrete components in a user terminal.<br>
[1097] The previous description of the disclosed embodiments is provided to enable any person skilled in the art to make or use the present invention. Various modifications to these embodiments will be readily apparent to those skilled in the art, and the generic principles defined herein may be applied to other embodiments without departing from the spirit or scope of the invention. Thus, the present invention is not intended to be limited to the embodiments shown herein but is to be accorded the widest scope consistent with the principles and novel features disclosed herein.<br>
[1098]      WHAT IS CLAIMED IS:<br><br><br><br>
CLAIMS<br>
1.	An apparatus having a KASUMI round for generating a fractional portion of the KASUMI cipher operably coupled to a calculation controller for sequencing eight rounds to produce a KASUMI output.<br>
2.	The apparatus of claim 1. further comprising a sub-key generator, connected to the calculation controller, for producing sub-keys each round for use by the KASUMI round.<br>
3.	An apparatus for performing KASUMI ciphering on a KASUMI input with a key to produce a KASUMI output, comprising:<br>
a KASUMI round for generating a fractional portion of the KASUMI cipher, configurable for calculation of even and odd rounds, eight rounds being calculated to produce the KASUMI output;<br>
memory for storing the output of the KASUMI round; and<br>
a selector for providing the input to the KASUMI round, the KASUMI input being selected during the first round and the contents of the memory being selected during subsequent rounds.<br>
4.	The apparatus of claim 3. further comprising a sub-key generator for generating sub-keys for each round based on the key.<br>
5.	The apparatus of claim 3, wherein the apparatus is adapted to be operable in an access point.<br>
6.	The apparatus of claim 3, wherein the apparatus is adapted to be operable in an access terminal.<br>
7.	The apparatus of claim 3, wherein the apparatus is adapted to be operable in a W-CDMA system.<br><br>
8.	A KASUMI round for receiving an input and producing an output, operable with a<br>
partial round calculator from which the output is produced, comprising:<br>
a memory for storing an intermediate value from the partial round calculator; and a selector for selecting between the input and the contents of the memory for delivery to the partial round calculator.<br>
9.	A KASUMI round for receiving a 64-bit input and producing a 64-bit output<br>
comprising:<br>
an FO function;<br>
an FL function;<br>
an XOR gate;<br>
a first register;<br>
a second register for receiving the output of the XOR gate, the output being concatenated with the output of the first register to produce the 64-bit output;<br>
a first input mux for selecting between the upper half of the 64-bit input and the output of the second register under control of an input select signal, the output being received at the first register;<br>
a second input mux for selecting between the lower half of the 64-bit input and the output of the first register under control of the input select signal, the output being delivered as the second operand to the XOR gate;<br>
a first datapath mux. the output of which is delivered to the FL function, for selecting between the output of the first input mux and the output of the FO function under control of a data flow signal;<br>
a second datapath mux, the output of which is delivered to the FO function, for selecting between the output of the FL function and the output of the first register under control of the data flow signal; and<br>
a third datapath mux. the output of which is delivered as the first operand to the XOR gate, for selecting between the output of the FL function and the FO function under control of the data flow signal.<br><br>
10.	An FO function for receiving an input and producing an output, operable with a<br>
partial FO calculator from which the output is produced, comprising:<br>
a memory for storing an intermediate value from the partial FO calculator; and a selector for selecting between the input and the contents of the memory for delivery to the partial FO calculator.<br>
11.	An FO function for receiving a 32-bit input and producing a 32-bit output,<br>
comprising:<br>
a first XOR gate for receiving a KO sub-key as a first operand;<br>
an Fl function for receiving the output of the first XOR gate;<br>
a second XOR gate for receiving the output of the Fl function as a first operand;<br>
a first register for receiving the output of the second XOR gate;<br>
a second register;<br>
a first input mux. the output of which is delivered as a second operand to the first XOR gate, for selecting between the upper half of the 32-bit input and the output of the second register under control of an input select signal; and<br>
a second input mux, the output of which is delivered as the second operand to the second XOR gate and the input to the second register, for selecting between the lower half of the 32-bit input and the output of the first register under control of the input select signal, the output being concatenated with the output of the second XOR gate to produce the 32-bit output.<br>
12.	An Fl function for receiving an input and producing an output, operable with a<br>
partial Fl calculator from which an intermediate value and the output is produced,<br>
comprising:<br>
a memory for storing the intermediate value from the partial Fl calculator; and a selector for selecting between the input and the contents of the memory for delivery to the partial Fl calculator.<br><br>
13.	An Fl function for receiving a 16-bit input and producing a 16-bit output,<br>
comprising:<br>
a first register;<br>
a second register;<br>
a first input mux for selecting between the output of the first register and the upper nine bits of the 16-bit input under control of an input select signal;<br>
a second input mux for selecting between the output of the second register and the lower seven bits of the 16-bit input under control of the input select signal;<br>
an S9 function for receiving the output of the first input mux;<br>
a first XOR for receiving as operands the output of the S9 function and the zero-extended output of the second input mux;<br>
an S7 function for receiving the output of the second input mux;<br>
a second XOR for receiving as operands the truncated output of the first XOR and the output of the S7 function, the output being concatenated with the output of the first XOR to produce the 16-bit output;<br>
a third XOR, the output of which is delivered to the first register, for receiving as operands a first Kl sub-key and the output of the first XOR; and<br>
a fourth XOR, the output of which is delivered to the second register, for receiving as operands a second K! sub-key and the output of the second XOR.<br>
14.	A sub-key generator for receiving a key and, for each round, producing eight sub-<br>
keys, comprising:<br>
a first shift register, loadable with the key. left rotatable by eight bits under control of a rotate signal, four of the eight sub-keys being derived from the output; and<br>
a second shift register, loadable with a masked version of the key, left rotatable by eight bits under control of the rotate signal, four of the eight sub-keys being derived from the output.<br>
15- A sub-key generator for receiving a 128-bit key and, for each round, producing eight 16-bit sub-keys, comprising:<br>
a first 128-bit shift register, loadable with the key;<br>
a second 128-bit shift register, loadable with a masked version of the key. the first sub-key being produced from the third highest 16 bits, the second sub-key being<br><br>
produced from the fourth highest 16 bits, the third sub-key being produced from the fifth highest 16 bits, the fourth sub-key being produced from the lowest 16 bits;<br>
a rotator for rotating left by one bit the contents of the first shift register located in highest 15 bits to produce the fifth sub-key;<br>
a rotator for rotating left by five bits the contents of the first shift register located in the second highest 16 bits to produce the sixth sub-key;<br>
a rotator for rotating left by eight bits the contents of the first shift register located in the third lowest 16 bits to produce the seventh sub-key; and<br>
a rotator for rotating left by 13 bits the contents of the first shift register located in the second lowest 16 bits to produce the eighth sub-key.<br>
16.      A method for performing KASUMI ciphering comprising: for each of eight rounds:<br>
selecting the input for use in the calculating step during the first round; selecting the stored result for use in the calculating step in subsequent<br>
rounds; calculating a partial result; and storing the partial result in a memory; and delivering the stored result as the output.<br><br>
17.	The method of claim 16, wherein the calculating step comprises:<br>
when the round is odd;<br>
performing the FL function on the upper half of the input or stored result,<br>
as selected in the selecting step; performing the FO function on the output of the FL function; and XORing the output of the FO function with the lower half of the input or stored result, as selected in the selecting step; when the round is even:<br>
performing the FO function on the upper half of the stored result; performing the FL function on the output of the FO function; and XORing the output of the FL function with the lower half of the stored result; delivering as the partial result the output of the XORing step concatenated with the upper half of the input or stored result, as selected in the selecting step.<br>
18.	The method of claim 16. further comprising generating sub-keys for each round.<br>
19.	A method for performing the FO function comprising: for each of three stages:<br>
selecting the input for use in the calculating step in the first stage; selecting the stored result for use in the calculating step in subsequent<br>
stages; calculating a partial result; storing the partial result in memory; and delivering the partial result as the output;<br><br>
20.	The method of claim 19. wherein the calculating step comprises:<br>
XORing the upper half of the input or stored result, as selected in the selecting step, with a sub-key;<br>
performing the FI function on the output of the XORing step;<br>
XORing the output of the FI function with the lower half of the input or stored result, as selected in the selecting step; and<br>
delivering as the partial result the upper half of the input or stored result, as selected in the selecting step, concatenated with the output of the second XORing step.<br>
21.	A method for performing the FI function comprising:<br>
calculating a partial result using the input;<br>
XORing the partial result with a sub-key;<br>
storing the partial result in memory;<br>
calculating a second partial result using the stored result; and<br>
delivering the second partial result as the output;<br>
22.	The method of claim 21. wherein the calculating step comprises:<br>
performing the S9 function on the upper nine bits of the input or stored result;<br>
zero extending the lower 7 bits of the input or stored result;<br>
XORing the zero-extended input or stored result with the output of the S9 function;<br>
perfoming the S7 function on the lower 7 bits of the input or stored result;<br>
truncating the output of the XORing step;<br>
XORing the truncated XOR output with the output of the S7 function;<br>
delivering as the partial result the output of the second XORing step concatenated with the output of the first XORing step.<br>
23.	A method for generating sub-keys comprising:<br>
loading two sub-key shift registers;<br>
for each of eight rounds:<br>
deriving the sub-keys from the sub-key shift registers; and rotating the two sub-key shift registers left by eight bits.<br><br>
24.	The method of claim 23. wherein the loading step comprises:<br>
loading a key into the first sub-key shift register;<br>
masking the key; and<br>
loading the masked key into the second sub-key shift register.<br>
25.	The method of claim 24, wherein the deriving step comprises:<br>
deriving the first sub-key from the third highest set of 16 bits of the second shift register;<br>
deriving the second sub-key from the fourth highest set of 16 bits of the second shift register;<br>
deriving the third sub-key from the fifth highest set of 16 bits of the second shift register;<br>
deriving the fourth sub-key from the lowest set of 16 bits of the second shift register;<br>
rotating the highest set of 16 bits of the first shift register by one bit to the left to produce the fifth sub-key;<br>
rotating the second highest set of 16 bits of the first shift register by five bits to the left to produce the sixth sub-key;<br>
rotating the third lowest set of 16 bits of the first shift register by eight bits to the left to produce the seventh sub-key; and<br>
rotating the second lowest set of 16 bits of the first shift register by thirteen bits to the left to produce the eighth sub-key.<br><br>
An apparatus having a KASUMI round substantially as herein above described with reference to the accompanying drawings. A method for performing KASUMI ciphering substantially as herein   above  described  with  reference   to   the   accompanying<br>
drawings.<br><br></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg2Ny1jaGVucC0yMDAzIGFic3RyYWN0IGR1cGxpY2F0ZS5wZGY=" target="_blank" style="word-wrap:break-word;">1867-chenp-2003 abstract duplicate.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg2Ny1jaGVucC0yMDAzIGNsYWltcyBkdXBsaWNhdGUucGRm" target="_blank" style="word-wrap:break-word;">1867-chenp-2003 claims duplicate.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg2Ny1jaGVucC0yMDAzIGRlc2NycHRpb24gKGNvbXBsZXRlKSBkdXBsaWNhdGUucGRm" target="_blank" style="word-wrap:break-word;">1867-chenp-2003 descrption (complete) duplicate.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg2Ny1jaGVucC0yMDAzIGRyYXdpbmdzIGR1cGxpY2F0ZS5wZGY=" target="_blank" style="word-wrap:break-word;">1867-chenp-2003 drawings duplicate.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg2Ny1jaGVucC0yMDAzLWNsYWltcy5wZGY=" target="_blank" style="word-wrap:break-word;">1867-chenp-2003-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg2Ny1jaGVucC0yMDAzLWNvcnJlc3BvbmRuZWNlLW90aGVycy5wZGY=" target="_blank" style="word-wrap:break-word;">1867-chenp-2003-correspondnece-others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg2Ny1jaGVucC0yMDAzLWNvcnJlc3BvbmRuZWNlLXBvLnBkZg==" target="_blank" style="word-wrap:break-word;">1867-chenp-2003-correspondnece-po.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg2Ny1jaGVucC0yMDAzLWRlc2NyaXB0aW9uKGNvbXBsZXRlKS5wZGY=" target="_blank" style="word-wrap:break-word;">1867-chenp-2003-description(complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg2Ny1jaGVucC0yMDAzLWRyYXdpbmdzLnBkZg==" target="_blank" style="word-wrap:break-word;">1867-chenp-2003-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg2Ny1jaGVucC0yMDAzLWZvcm0gMS5wZGY=" target="_blank" style="word-wrap:break-word;">1867-chenp-2003-form 1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg2Ny1jaGVucC0yMDAzLWZvcm0gMTgucGRm" target="_blank" style="word-wrap:break-word;">1867-chenp-2003-form 18.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg2Ny1jaGVucC0yMDAzLWZvcm0gMy5wZGY=" target="_blank" style="word-wrap:break-word;">1867-chenp-2003-form 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg2Ny1jaGVucC0yMDAzLWZvcm0gNS5wZGY=" target="_blank" style="word-wrap:break-word;">1867-chenp-2003-form 5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg2Ny1jaGVucC0yMDAzLXBjdC5wZGY=" target="_blank" style="word-wrap:break-word;">1867-chenp-2003-pct.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="228979-method-and-system-for-accessing-i-o-devices-in-an-embedded-control-environment.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="228981-method-and-device-of-cooling-a-pit-of-a-ring-furnace.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>228980</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>1867/CHENP/2003</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>12/2009</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>20-Mar-2009</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>13-Feb-2009</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>28-Nov-2003</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>QUALCOMM INCORPORATED</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>5775 MOREHOUSE DRIVE, SAN DIEGO, CALIFORNIA 92121-1714,</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>AVERBUJ, ROBERTO, FABIAN</td>
											<td>4110 VIA CANDIDIZ, #103, SAN DIEGO, CALIFORNIA 92130,</td>
										</tr>
										<tr>
											<td>2</td>
											<td>DHAWAN, RAJAT, RAJINDERKUMAR</td>
											<td>9928 KITA COURT, SAN DIEGO, CALIFORNIA 92129,</td>
										</tr>
										<tr>
											<td>3</td>
											<td>MISHRA, PRADEEP, KUMAR</td>
											<td>4420 CALLE MAR DE ARMONIA, SAN DIEGO, CALIFORNIA 92130,</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04L 9/06</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/US02/17042</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2002-05-31</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>09/920,784</td>
									<td>2001-08-01</td>
								    <td>U.S.A.</td>
								</tr>
								<tr>
									<td>2</td>
									<td>60/294,958</td>
									<td>2001-05-31</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/228980-apparatus-and-method-for-performing-kasumi-ciphering by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 09:37:35 GMT -->
</html>
