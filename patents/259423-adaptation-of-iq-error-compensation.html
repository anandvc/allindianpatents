<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/259423-adaptation-of-iq-error-compensation by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 02:02:56 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 259423:ADAPTATION OF IQ-ERROR COMPENSATION.</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">ADAPTATION OF IQ-ERROR COMPENSATION.</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>A radio transmitter with IQ-modulator error compensation includes a homodyne observation receiver (42) producing a first real baseband (S5) signal from a real radio frequency signal (S2). A real-value extracting element (44) and a down-sampler (46) convert a complex baseband signal (SI) into a second real baseband signal. An adapter (40) determines parameters controlling an IQ-error compensator (12) by minimizing the error between the two real baseband signals. In a preferred embodiment he transmitter also includes a phase shifter (56) providing three different phase shifts to compensate for the fact that the homodyne observation receiver produces a real and not a complex signal.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>ADAPTATION OF IQ-ERROR COMPENSATION TECHNICAL FIELD<br>
The present invention relates generally to error compensation in radio transmitters and radio receivers, and especially to IQ-modulator and IQ-demodulator error compensation (I=inphase, Q=quadrature phase).<br>
BACKGROUND<br>
The up-conversion from baseband to radio frequency (RF) in radio transmitters can be performed as a single step "direct conversion" using an analog IQ-modulator architecture or as a multiple step "digital intermediate, frequency" conversion using both digital and analog mixers. Generally the IQ-modulator architecture is preferable, since it gives better performance and is less complex. However, this also requires a simple and effective way of correcting for the so-called IQ-errors generated by the IQ-modulator.<br>
Conventionally the IQ-errors arc compensated in an IQ-error compensator, the parameters of which are determined by an adapter using the baseband signal and a signal from a so-called observation receiver. This observation receiver converts the radio frequency (RF) signal from the power amplifier to baseband in two steps. In the first step an analog mixer converts it to intermediate frequency, where it is digitized. The digitized intermediate frequency signal is then digitally converted to an IQ-signal at baseband by a digital mixer. A drawback of the known method, however, is that several analog local oscillators have to be used, one for the IQ-modulator and one for the observation receiver. In addition to the increased costs, this approach leads to a complicated cancellation of the phase noise of the transmitter and observation receiver local oscillators. There is also a risk for leakage from the observation receiver local oscillator.<br><br>
SUMMARY<br>
An object of the present invention is to reduce the number of local oscillators in a transmitter or receiver using an observation receiver for IQ-error compensation.<br>
This object is achieved in accordance with the attached claims.<br>
Briefly, the present invention is based on the insight that it is in fact possible to use the same analog local oscillator for both IQ-modulator and observation receiver, provided that the observation receiver is a real homodyne observation receiver and that further RF-signal processing is introduced to obtain enough information to determine the compensator parameters.<br>
BRIEF DESCRIPTION OF THE DRAWINGS<br>
The invention, together with further objects and advantages thereof, may best be understood by making reference to the following description taken together with the accompanying drawings, in which:<br>
Fig. 1 is a block diagram of a conventional IQ-modulator error compensated transmitter;<br>
Fig. 2 is a block diagram of a first embodiment of an IQ-modulator error compensated transmitter in accordance with the present invention;<br>
Fig. 3 illustrates the spectra of various signals of the IQ-modulator error compensated transmitter of Fig. 2;<br>
Fig. 4 is a block diagram of a second embodiment of an IQ-modulator error compensated transmitter in accordance with the present invention;<br>
Fig. 5 is a block diagram of a third embodiment of an IQ-modulator error compensated transmitter in accordance with the present invention;<br>
Fig. 6 is a block diagram of a fourth embodiment of an IQ-modulator error compensated transmitter in accordance with the present invention;<br><br>
Fig. 7 is a block diagram of a fifth embodiment of an IQ-modulator error compensated, transmitter in accordance with the present invention;<br>
Fig. 8 is a block diagram of a first embodiment of an IQ-demodulator. error compensated receiver in accordance with the present invention; and<br>
Fig. 9 is a block diagram of a second embodiment of an IQ-demodulator error compensated receiver in accordance with the present invention;<br>
DETAILED DESCRIPTION<br>
In the following description the same reference designations will be used for elements having the same or similar functions.<br>
In a radio transmitter the signal is often generated by digital signal processing at baseband and then transformed to an analog RF signal. In the "direct conversion" transmitter the real (I) and imaginary (Q) parts of the baseband signal are converted to analog by two separate digital-to- analog converters (DACs). The output signals from the DACs are transposed to RF by two separate RF mixers, and the two RF mixer outputs are summed together to form the final RF signal. The radio frequency local oscillator signals to the two mixers are to be in quadrature phase, and therefore this arrangement is also called an analog "IQ" ("in phase" and "quadrature phase") modulator.<br>
The analogue IQ-architecture has several important advantages over the digital IF architecture mentioned above. The filtering and local oscillator signal generation is normally simpler and the lower number of involved frequencies means lower risk for spurious signals. Above all, the IQ-modulator architecture gives (for the same type of DACs) the double bandwidth as compared to the digital IF architecture (Actually, due to the simpler filtering in the IQ architecture the bandwidth is often significantly more than doubled, due to the fact that less bandwidth has to be "wasted" as "guard bands".). The IQ-modulator, however, has the problem of IQ-modulator errors. The most important IQ-errors (or "non-idealities") are carrier leakage,<br><br>
that the gains for the two signal paths are not exactly equal and that the total phase difference is not exactly equal to a quarter of an RF cycle.<br>
The IQ-errors can be compensated in the digital domain by some additional digital signal processing. This is not difficult, provided that the IQ-errors are known, in sufficiently accurate quantitative detail. In other words, if the non-ideal IQ-modulator is described by a model, the problem consists of knowing the values of the model parameters. Then it is easy to implement the "inverse IQ-error" ("IQ-compensation") in the digital signal processing. Due to production spread, and drift due to temperature, ageing, moisture, etc., the IQ-modulator parameters are changing and never known a-priori. The standard solution is then to have an adaptive IQ-error compensation. The output signal is monitored by an "observation receiver" and the IQ-compensator parameters are adjusted for maximum output signal quality.<br>
The principle of adaptive correction for non-idealities in a radio transmitter is not limited to an IQ-modulator. In particular it is difficult to make the high-power RF-amplifier of a transmitter sufficiently linear by itself. Therefore, an adaptive correction for the RP power amplifier non-linearities is often done along the same principles as for the IQ-modulator (generally called "adaptive pre-distortion linearization"). In a radio transmitter it is generally preferred to have a single observation receiver for the transmitter from which one can adapt all the compensators (IQ-error compensator, RP power amplifier pre-distorter, and possibly more).<br>
Fig. 1 is a block diagram of a typical conventional IQ-modulator error compensation system. In this and the following figures analog real signals are represented by dashed lines, real digital signals are represented by solid lines and complex signals are represented by solid double lines. As indicated in the lower left part of Fig. 1, a complex digital baseband signal is forwarded to a power amplifier (PA) pre-distorter 10, which pre-distorts the signal to counteract distortion produced by a radio frequency PA 18. The complex digital output signal of pre-distorter 10 is forwarded to an IQ-error compensator 12,<br><br>
which compensates for errors generated by an IQ-modulator 14, which transforms the complex digital baseband signal into a real-valued analog RF-signal at carrier frequency fc, which is amplified by PA 18. The carrier signal is obtained from a local oscillator 16.<br>
A coupler 20 takes a small part of the real analog RF-signal from PA 18 to an observation receiver 22. The input signal to observation receiver 22 is forwarded to an analog mixer 26, in which it is multiplied by cos(2;r fDNi)<br>
from a local oscillator 24. The real analog output signal from mixer 26 is filtered in a low-pass filter 28, and the resulting real analog intermediate frequency signal is A/D converted in an A/D converter (ADC) 30 at a sampling rate Fs provided by a clock 32. The resulting real digital signal is down-converted to a complex digital baseband signal in a digital mixer 34 using a complex signal GX$(-i2nFDIPt) from an oscillator 36. Here it is assumed that<br>
FDIF - fc ~ foN • The resulting complex digital signal is filtered in a low-pass filter 38 to form a down-converted complex digital baseband signal. If all components of the system are ideal, then the original baseband signal and the down-converted signal should be identical (up to a proportionality factor and a time-delay of the loop). Since these signals typically are not equal, due to distortion produced in IQ-modulator 14 and power amplifier 18, the two signals are compared in an adapter 40, the purpose of which is to adjust the parameters of pre-distorter 10 and IQ-error compensator 12 to make the signals as equal as possible.<br>
A drawback of the conventional IQ-modulator error compensation system is that it requires two analog local oscillators 16, 24. operating at different frequencies fc and /DN, respectively. First of all this leads to high costs for oscillator components. Secondly, it is complicated to cancel the phase noise of the local oscillators of the transmitter and observation receiver. There is also a risk for leakage from the observation receiver oscillator.<br><br>
As noted in the previous paragraph the use of two analog local oscillators of the prior art system has several drawbacks. It would be desirable to eliminate these drawbacks by using a single analog oscillator for both up-conversion in the transmitter and down-conversion in the observation receiver. The obvious solution would be to use an analog IQ-demodulator driven by the same local oscillator as the IQ-modulator. This would work nicely if an ideal IQ-demodulator could be used. In practice, however, an IQ-demodulator has the same types of non-idealities as an IQ-modulator. Thus, it would in practice not be possible to determine the IQ-errors of the transmitter alone, but only the combined errors of the IQ-modulator of the transmitter and the IQ-demodulator of the observation receiver. In accordance with the present invention, instead of using an IQ-demodulator, it is suggested to use a homodyne observation receiver. The homodyne observation receiver transposes the analog real RF signal down to a real baseband signal in a single, down-conversion using the same local oscillator as the IQ-modulator. It is true that also such a homodyne observation receiver generates errors, but these can be determined separately from the IQ-modulator errors, as- will be shown below. A possible reason that such a solution has not been suggested before is that a general assumption of the prior art is that the observation receiver of a transmitter with'an adaptively pre-distorted RF PA and/or pre-compensated IQ-modulator has to have a digital bandwidth (e.g. Nyquist bandwidth) at least as large as the input signal bandwidth. However, as will be shown below this assumption is not correct. In fact the observation receiver may have an arbitrarily small digital bandwidth (arbitrarily small sampling rate) and an analog bandwidth (at baseband) down to half the (distorted) signal bandwidth.<br>
Fig. 2 is a block diagram of the basic structure of an IQ-modulator error compensation system in accordance with the present invention. The following description of this block diagram will frequently refer to the spectra of various signals in Fig. 3. As in the conventional system of Fig. 1 the complex input signal SI is pre-distorted, IQ-error compensated, up-converted and amplified into an RF-signal, a portion S2 of which is forwarded to a homodyne observa-<br><br>
tion receiver 42. In the present application a homodyne observation receiver is assumed to receive a real RF-signal and produce a real baseband signal in a single mixing step. Thus, signal S2 is mixed in a mixer 26 with the carrier signal from local oscillator 16, which also drives IQ-modulator 14, to produce an analog signal S3. The analog signal S4 is obtained after low-pass filtering in filter 28. Finally signal S4 is A/D-converted at sampling frequency Fs in ADC 30 to produce the real digital signal S5, which is forwarded to adapter 40. On the input signal side, instead of forwarding signal SI directly to adapter 40, as is done in the conventional system of Fig. 1, only the real (I) component is extracted by element 44. This real component is down-sampled in a down-sampler 46 to the same sample rate Fs as signal S5. The resulting signal S7 is forwarded to adapter 40 as a reference signal. If the sample rate Fs is the same as the sample from element 44, down-sampler 46 may be omitted.<br>
Studying Fig. 3 (it should be noted that the plots in Fig. 3 are only sketches of the power spectra, which are not to scale), it is noted that the spectrum of signal S4 in Fig. 3(c) is distorted with respect to the spectrum of the original input signal SI in Fig. 3(a) due to the homodyne down-conversion. However, it may also be noted in Fig. 3(c) that the spectrum of signal S6 (the real part of the input signal) is distorted in exactly the same way. The same conclusion is true for the digitized signal S5 and the down-sampled signal S7 in Fig, 3(d). Thus, although the spectra of signals S5 and S7 have been distorted, they can still be compared in adapter 40, since they have been subjected to the same distortion.<br>
In Fig. 3(d) the sampling rate has been chosen above the Nyquist frequency to avoid aliasing. Thus, there is no further distortion from Fig. 3(c) to Fig. 3(d). However, as illustrated in Fig. 3(e) the sampling rate can be chosen below the Nyquist frequency (actually arbitrarily low), since both signals will be subjected to the same aliasing. The signals can still be compared in adapter 40.<br><br>
Thus, the conclusion is that, contrary to the prevailing view, a homodyne observation receiver with an arbitrarily low sampling rate may in fact be used in an IQ-modulator error corrected transmitter, provided that the reference signal is modified into the real part of the input signal down-sampled to the same sampling rate.<br>
Although it has been shown that the output signal S5 of the homodyne observation receiver may actually be compared to the real reference signal S7 in adapter 4 since both signals have been subjected to the same distortion, it may be argued that the information content in these signals has been reduced to such an extent that it is no longer possible to use them for adaptation of IQ-modulator error compensator 12. After all, by taking the real part of the reference signal in element 44, half of the information is discarded. This issue will now be discussed in more detail.<br>
As noted above, an analog IQ-modulator has non-idealities (IQ-modulator errors). The two most important are a DC-shift of the input complex-valued base-band signal, and an unbalance and mixing of the real (I) and imaginary (Q) components of the input signal. The first non-ideality can equivalently be described as a carrier leakage. The latter non-ideality can equivalently be described in the frequency domain as an unbalance and mixing between corresponding upper and lower sideband frequency components. In a transmitter using the IQ-architecture, both the IQ-modulator errors and the non-linearities of the power amplifier can be compensated for in the digital complex baseband. For this to be possible, however, the output signal of the observation receiver has to contain un-ambiguous information about all the relevant non-idealities of both the IQ-modulator and the power amplifier.<br>
The homodyne observation receiver transposes the carrier leakage down to zero frequency. Because the output of the observation receiver is real-valued, this means "taking the real part" of the complex-valued DC-shift of the IQ-modulator. The output signal of the observation receiver is independent of the imaginary part of the IQ-rnodulator's DC-shift, so there does not seem to<br><br>
be enough information to compensate for the IQ-modulator DC-shift. Furthermore, also the observation receiver is generally not ideal and contributes its own DC-shift. Thus, it does not even seem possible to determine the real part of the IQ-modulator's DC-shift. Only the sum of the DC-shifts of the observation receiver and real part of the DC-shift of the IQ-modulator seems to be available. Similarly, when the observation receiver takes the real part of the signal, no independent information about the upper and lower sideband frequency components is obtained. Therefore there does not seem to be enough information available to adapt the compensation for the I/Q unbalance and mixing errors of the transmitter. Although the discussion above primarily was directed towards DC-shifts (since they are the more difficult to determine due to the extra DC-shift in the homodyne observation receiver), similar comments apply to the IQ-unbalance.<br>
In the discussion of the previous paragraph it is noted that the power amplifier non-linearity was ignored. It turns out that this is actually a hint towards a solution of the problem discussed there. If there is a non-linearity between the IQ-modulator and the observation receiver, then the carrier leakage signal of the IQ-modulator will mix with the information signal and form additional distortion components. Information concerning the two IQ-modulator DC-shift parameters will then reside not only in the carrier frequency signal component, but also in numerous distortion signal components. In most cases three or more independent signal components related to the DC-shifts will then remain even after "taking the real part", and the three DC-shift parameter values can be unambiguously determined.<br>
The feature described in the previous paragraph requires a sufficiently nonlinear power amplifier. If this should not be the case, it is possible to intentionally add additional non-linearity in the path between the IQ-modulator and the observation receiver. An example of such an embodiment is illustrated in Fig. 4. When a switch 54 is in the upper position only the PA non-linearity itself is used. Should the distortion by the PA alone turn out to be too small to adapt the IQ-modulator, an additional non-linearity 52 is<br><br>
switched in and the pre-distorter and IQ-error compensator are adapted. The 1Q-error compensator parameters are then frozen, and the extra non-linearity 52 is switched out to adapt the pre-distorter to its correct settings. The embodiment of Fig. 4 also includes an adder 48 that adds the determined DC-shift of the observation receiver 42 and a delay element 50 that synchronizes the input signals to adapter 40 by accounting for the delay caused by the feedback loop containing the observation receiver. As an alternative these elements my be considered as included in adapter 40. This is the view taken in the embodiment of Fig. 2, where they have not been explicitly shown.<br>
In the embodiment of Fig. 4 pre-distorter 10 is set to wrong settings during adaptation of the IQ-parameters. Various ways to avoid this feature da exist. One possibility is to instead place the extra non-linearity in front of the PA 18. The trade-off, however, is probably a more wide-band DAC and up-converter in order to achieve the linearization. Another possibility is to adapt the parameters of a model of the IQ-modulator and PA and possibly the extra non-linearity by making the model output signal as equal as possible to the observation receiver signal. The correct IQ-error compensator and pre-distorter parameter values can then be obtained indirectly from the model.<br>
Another way to resolve the three independent variables, real and imaginary DC-shifts of the IQ-modulator and DC-shift of the observation receiver is to let the observation receiver "take the real part of the PA output signal phase shifted by three different phase angles. In this way three different projections of the DC-shift, I/Q mix and balance error are obtained. An embodiment implementing this idea is illustrated in Fig. 5. In this embodiment a phase shifter 56 is controlled by adapter 40 to apply three different phase shifts from the local oscillator 56 to the mixer in the homodyne observation receiver. Preferably the phases are 2pi/3, 0 and -2pi/3, but other values are also possible, as long as they are sufficiently different to produce distinct I/Q mixes. As usual the adaptation works by the adapter 40 adjusting all the compensator parameters so that the two input signals to the adapter become<br><br>
as equal as possible. For this to work the reference input signal also has to be given the same phase-shift as the observation receiver signal, as indicated by phase shifter 58. Since the values of the observation receiver phase-shifts may be drifting in the same way as the transmitter non-idealities, the compensating phase-shift values also have to be up-dated by the adapter.<br>
The IQ-compensator compensates for all the carrier leakage into the transmitter before the final coupler 20 that takes the signal out to the observation receiver, not just the DC-shift of the IQ-modulator. This is an additional advantage of using the same local oscillator for the observation receiver as for the transmitter. This applies, however, only to leakages from before the phase-shifter 56. Leakage from after the phase-shifter has to be kept to low enough levels by hardware. Ideally the local oscillator input to the observation receiver mixer should not leak out from its RF-input. In practice' some leakage will occur. That is not a serious problem though. The leakage can, for example, be attenuated to low enough levels by an isolator in front of the mixer. This could be e.g. a circulator type of isolator or a buffer amplifier with low enough reverse gain. The potential leakage could also be attenuated by using a properly terminated directional coupler 20 in Fig. 3.<br>
By using the same local oscillator for the observation receiver and the transmitter, the detrimental effect of the phase noise of the oscillator on the estimated parameter values cancels out. For the phase noise cancellation to be effective, the time delay from the local oscillator to the local oscillator input of the observation receiver mixer should be adjusted to equal the time delay of the path from the local oscillator through the IQ-modulator and PA to the RF input of the observation receiver mixer. This delay should normally not be so sensitive to require adaptation, a delay fixed at design should normally do.<br>
The adaptation of the embodiments of the present invention described so far may in some applications be considered to be too slow. The reason for a possibly slow convergence of the correction parameters is that the adapter<br><br>
has no a priori knowledge of what direction an iteration should have in parameter space to reduce the error. Fig. 6 illustrates an embodiment that addresses this potential problem. In Fig. 6, instead of adapting PA pre-distorter 10 and IQ-error compensator 12 directly, models 62 and 64, respectively of these elements are adapted (in this example the models are operating at digital baseband and the reference signal is taken after pre-distorter 10 and compensator 12) in a model adapter 70. The compensation parameters are then obtained by inverting the adapted models in inverters 66 and 68. The advantage of this approach is that the models are known to the model adapter 70 (both the defining equations of the models and the values of the parameters and input signal). Thus, the model adapter can determine the gradient of the model output samples in parameter space (the partial derivatives of the model output signal with respect to the parameters). This informs the model adapter of what direction to take in parameter space in order to reduce the error, which makes the adaptation more efficient.<br>
The principles of the adaptation in accordance with the present invention are also illustrated in the APPENDIX, which includes commented MATLAB® code that simulates the behavior of a transmitter in accordance with the present invention. The main program "test" calls several sub-programs "IQmodulator", "mlphases3", "rhdtorl", "fpoll", which simulate the behavior of IQ-modulator 14, phase snifter 56, observation receiver 42 and power amplifier 18, respectively. By adding and removing comment start symbols (%), different power amplifier models (with different non-linear behavior) may be studied by running the program "test". Similarly the phase shifter may be included or excluded.<br>
As noted above, an advantage of the embodiment of Fig. 6 is that it gives a faster adaptation than the other described embodiments. A potential disadvantage, however, is that it may be sensitive to modeling errors (errors in the IQ-modulator model and PA-model, and also to possible errors in the inverters). The reason is that it is an "open loop" approach, i.e. the reference<br><br>
signal is not the actual input signal, but a signal obtained after pre-distorter 10 and compensator 12. On the other hand, the embodiment of Fig. 5 may have slow adaptation, but it is very robust, since it is a "closed loop" implementation (the reference signal is the actual input signal). If the extra complexity is acceptable, the two embodiments may be combined to give an embodiment that is both robust and has fast adaptation. Such an embodiment is illustrated in Fig. 7. In this embodiment the IQ-modulator model 62 and PA-model 64 are not connected directly to adapter 40. Instead they are connected to a model adapter 70, which adapts the models. The purpose of this adaptation of the models is to obtain gradient estimates to help adapter 40 in the closed loop adaptation of the actual IQ-error compensation parameters and the PA pre-distortion parameters. In order to avoid cluttering of the drawing, model adapter 70 is illustrated as being directly connected to PA-model 64. However, it is appreciated that actually a chain of elements 58, 44, 46, 58, 50 has to be included between PA-model 64 and model adapter 70. This has been implicitly indicated by the clock signal Fs to model adapter 70.<br>
In the description above it has been assumed that input signal to the observation receiver is taken after the power amplifier. Another possibility is to take it directly after the IQ-modulator. In such an embodiment only the IQ-modulator is compensated.<br>
Up to this point the present invention has primarily been described with reference to a radio transmitter. However, the same principles can also be used for adaptation of the IQ-error compensator of a radio receiver. This is illustrated by the embodiments of Fig. 8 and 9. In the embodiment of Fig. 8 an IQ-demodulator 80 and a real homodyne observation receiver 42 are both driven by the same local oscillator 16. As in the transmitter embodiment of Fig. 5, a phase shifter 56 controlled by adapter 40 is used to provide three different mixes of I/Q-components. In fact, by comparing Fig. 8 to Fig. 5 it is noted that the transmitter and receiver include essentially the same elements. The differences are that the power amplifier and its pre-distorter are<br><br>
not present in the receiver, that the IQ-modulator has been replaced by an IQ-demodulator and that the signal flow has been reversed. Thus, the same basic idea of the invention may be used in both a transmitter and a receiver in a very symmetrical way.<br>
Fig. 9 is another embodiment of a receiver in accordance with the present invention. This embodiment corresponds to the transmitter embodiment of Fig. 4. A non-linear element 52 provides the information enhancing distortion. A corresponding non-linear model 82 is provided before the chain 44, 46, 48, 50 in the baseband input path to adapter 40. The digital non-linear model 82 is preferably adjusted by adapter 40 to be a true complex baseband equivalent of the analog RF non-linearity 52. Since the RF non-linearity should provide only inter-modulation distortion and not rectification and harmonics, in order to be modeled at the complex baseband, a bandpass filter is preferably inserted between the non-linearity and the observation receiver 42.<br>
Receiver embodiments corresponding to the transmitter embodiments of Fig. 6 and 7 are also possible. However, these are not illustrated explicitly, since their implementation based on the information given with reference to Fig. 6 and 7 is straightforward for a person skilled in the art.<br>
It will be understood by those skilled in the art that various modifications and changes may be made to the present invention without departure from the scope thereof, which is defined by the appended claims.<br><br>
APPENDIX<br>
function test<br>
%	test of using "direct conversion" for both TX and TOR, the<br>
%	IQ-modulator having "IQ-imbalance" ("gain imbalance and<br>
%	phase error") and "DC-shift" (for I and .for Q) errors, the<br>
%	TOR is mixing to real baseband and having "DC-shift" error<br>
%<br>
%	(optionally) a "phaseshifter" is included, to improve the<br>
%	condition number for "low-non-linearity" PAa<br>
%<br>
%	the parameter values (of IQ-modulator and PA, and of<br>
%	optionally added) additional phase-shifter) are estimated by<br>
%	Newton's method<br>
% IQ-modulator parameters:<br>
zDC=0.03-i*0.02;   %(DC-shift of IQ-modulator (complex)) alpha=0.01;  % (phase error angle (radians) of IQ-modulato-r), betha=0.01/  %(amplitude un-balance angle (radians) of IQ-<br>
% modulator) iqparams= [alpha,-betha;real (zDC) ; imag (zDC) ];  % (place in vector)<br>
% TOR parameters:<br>
xDC=-0.02;   %(DC-shift of TOR (real))<br>
% switch:include/exclude phaseahifter by out-commenting one of % the two following lines and keep the other, % phaseshifts.are (zero and) the vector Vrv<br>
Vrv=(2*pi/3)* [-1/1];  % include phaseshifter %Vrv=[];  % exclude phaseshifter<br>
NVrv=length(Vrv)<br>
Nl=128;   %(length of sample sequence)<br>
Ainmax=l;  %(maximum _sampled_ amplitude (enough, because no % memory effect))<br>
% PA parameters:<br>
%(polynomial coefficients (for "PA"))<br>
%polcofs=[1;- 0.05+i*0.06;- 0.04];<br>
%polcofs~[l;-5e-2] ;<br>
polcofs=l; %(use "ideal PA")<br>
K2=length(polcofs);<br>
%(very simple signal generator)<br>
zin=(Ainmax/sqrt(2)}*((rand(Ml,1)-0.5)+i*(rand(Nl,1)-0.5)};<br>
DzinOO=repmat(NaN,Nl,0);<br><br>
% run "actual" TX<br>
zut=IQmodulator(zin,iqparams);	%("IQ-modulator")<br>
zut=fpoll (zut,DzinOO,polcofs) ;	% ("PA")<br>
if NVrv &gt; 0;<br>
zut=mlphases3 (zut,DzinOO, [0;Vrv]) ,-	% ("phaseshifter")<br>
end;<br>
xut=rhdtorl(zutfDzinOO,K2,xDC);	%("TOR")<br>
% initial deviation of "model" from "actual" ("error")<br>
if K2==3;<br>
polcofsl=polcofs+[0.001;0.001*i;-0.001] ; elseif K2==2;<br>
polcofsl-polcof3+[0.001;0.001*i] ; elseif K2==l;<br>
polcof sl-polcofs-f 0.001 ; el se ;<br>
error(' K2&gt;3   not yet implemented ') end;<br>
xDCl=xDC+le-5; iqparamsl=iqparams+[1;2;-1;1]*le-3;<br>
if NVrv &gt; 0;<br>
Vrvl=Vrv+le-3; else;<br>
Vrvl=[] ; end;<br>
maxERRORO=max([max(abs(polcofsi-polcofs)),  ... max(abs([iqparamsl-iqparams;xDCl-xDC])),  ... max(abs(Vrvl-Vrv))])<br>
for klll=l:3;  %(Newton iterations)<br>
disp(['***  iteration no. ',num2str(kill),' ***'])<br>
% run "model" TX<br>
[zl,Dzl]=IQmodulator(zin,iqparamsl); [zl,Dzl]=fpoll(zI,Dzl,polcofsi); if NVrv &gt; 0;<br>
[zl,Dzl]=mlphases3(zl,Dzl,[0;Vrvl]);<br>
Dzl=Dzl(:,2:end); end; [xutl,Dxut1]=rhdtorl(zl,Dzl, K2, xDCl);<br>
% compute corrections for "model" parameter values<br>
if 1—2;<br>
% use Dxutl directly, do not form normal matrix<br><br>
ConditionNumber-cond(Dxutl) ;<br>
disp ([' ConditionNutnber = ', num2str (ConditionNumber) ]) ;<br>
dcvl=Dxutl\(xut-xutl) ; else;<br>
% do not use Dxutl directly, form normal matrix<br>
NMl=Dxutl'*Dxutl;<br>
ConditionNumber=cond(NMl);<br>
disp(['ConditionNumber = ',num2str(ConditionNumber)]);<br>
dcvl=NMl\(Dxutl'* (xut-xutl) ) ; end;<br>
NDx=size(Dxutl,2);<br>
dpolcofsl=dcvl(NDX-2*K2+1:2:NDx-l) +i*dcvl(NDx-2*K2+2:2:NDx)/ diqparamsl=dcvl(NDx-2*K2-3:NDx-2*K2) ; dxdcl=dcvl(1);<br>
% up-date "model" parameter values (but let phaseshifter wait)<br>
polcofsl=polcofsl+dpolcofsi; xDCl=xDCl+dxdcl; iqparamsl=iqparamsl+diqparamsl;<br>
% up-date for "model" phaseshifter, if applicable<br>
if NVrv &gt; 0;<br>
dVrvl=»dcvl(2:3) ;<br>
Vrvl=Vrvl+dVrvl; end;<br>
% print maximal remaining "model" parameter value error<br>
maxERRpc=max(abs(polcofsl-polcofs)) ; maxERRiq=max(abs(iqparamsl-iqparams)); maxERRxdc=abs(xDCl-xDC); maxERRvrv=max(abs(Vrvl-Vrv)); maxERROR=max( [maxERRpCjinaxERRi disp(['maximal parameter value error 1,num2str(maxERROR)]);<br>
end; %(end Newton iterations)<br><br>
function  [out, Dout] =IQtnodulator (in, iqparama)<br>
%	out = the iQ-modulator output<br>
%	Dout = the derivatives of the IQ-modulator output with<br>
%        respect  to  the  IQ-modulator  parameters   in<br>
%        complex input signal column vector<br>
%	iqparams(l) = "alpha"   (phase error angle)<br>
%	iqparams(2) = "betha"   (amplitude un-balance angle)<br>
%	iqparams(3) = "xi"     (I carrier leakage ("DC-shift"))<br>
%	iqparams(4) = "etha"    (Q carrier leakage ("DC-shift"))<br>
I=real(in); Q=imag(in);<br>
sb=sqrt (2) *sin(iqparams (2) +pi/4) ; cb=sqrt(2)*cos(iqparams(2)+pi/4); sa=sin(iqparams(1) ) ; ca=cos(iqparams(1));<br>
out=sb* (ca*I+sa*Q) 4-iqparams (3) +i* (cb* (sa*I+ca*Q) +iqparams (4)) ;<br>
Dout=repmat(NaN,length(in),4);<br>
Dout (:, 1) =-sb*sa*I+sb*ca*QH-i* (cb*ca*I-cb*sa*Q) ;<br>
Dout (: ,2)=cb*ca*I-»-cb*sa*Q+i* (-sb*sa*I-sb*ca*Q) ;<br>
Dout(:,3)=ones(length(in),1);<br>
Dout(:,4)=repmat(i,length(in),1);<br><br>
function	[zut,Dzut]=mlphases3(zin,Dzin,Vrv,iv)<br>
%	memoryless phaseshifter<br>
%	zin	input signal<br>
%	Dzin	input partial derivatives of input signal<br>
%	Vrv	the phase-shifts<br>
%	iv	index vector for phase-shifts, optional input<br>
%	zut	output signal<br>
%_	Dzut	partial derivatives of output signal,<br>
%'	the derivative with respect to the phase-shift<br>
%	is placed in column no. 1-length(Vrv), and all<br>
%	the other derivatives shifted length(Vrv) coulumns up<br>
NVrv=length(Vrv); Nl=length(zin); NDl=size(Dzin,2);<br>
if nargin 
iv=repmat(NVrv,Nl,1); n2=0;<br>
for  kl=l:NVrv-l; nl=n2-fl;<br>
n2=floor(kl*Nl/NVrv) ,-iv (nl: n2) =kl ; end; end;<br>
phasevec=reshape(Vrv(iv),N1,1);<br>
zkp=exp (i*phasevec) zut=zkp.*zin;<br>
Dzut=zeros(Nl,NDl+NVrv);<br>
Dzut(:,NVrv+l:NDl+NVrv)=repmat(zkp,1,ND1).*Dzin;<br>
%Dzut(:,l)=i*zut;<br>
for kl=l:Nl;<br>
Dzut(kl,iv(kl))=i*zut(kl) end;<br><br>
function  [xut,Dxut]=rhdtorl(zin, Dzin,Kl,xDC)<br>
% real'homodyne transmitter observation receiver, % model 1 (memoryless model)<br>
xut=real(zin)+xDC;<br>
D2=size(Dzin,2); Nl=size(zin,l)/ if D2 &gt; 0;<br>
D1=D2-K1;<br>
DD1=D1+1;<br>
DD2=DD1+2*K1;<br>
Dxut=zeros(Nl,DD2)/<br>
% derivative with respect to xDC Dxut(:,l)=ones(Nl,l);<br>
% derivatives with respect to old real parameters Dxut(:, 2:DD1)=real(Dzin(:,1:D1)) ;<br>
% derivatives with respect to real part of % old complex parameters<br>
Dxut(:,DDl+l:2:DD2-l)=real(Dzin(:,D1+1:D2));<br>
% derivatives with respect to imaginary part of % old complex parameters<br>
Dxut(:,DDl+2:2:DD2)=-imag(Dzin(:,Dl+l:D2)); else;<br>
Dxut=ones(Nl,1); end;<br><br>
function  [zut,Dzut]=fpoll(zin,Dzin,polcofs)<br>
%	Memoryless non-linear polynomial transfer function.<br>
%	Both value, and derivative with respect to its own<br>
%	parameters (the polynomial coefficients) and the<br>
%	parameters of the inputted function.<br>
%	zin      input signal<br>
%	Dzin     partial derivatives of input signal<br>
%	polcofs  parameter values (polynomial coefficients)<br>
%	zut      output signal<br>
%	Dzout    partial derivatives of output signal,<br>
%	the derivatives with respect to the same real<br>
%	parameters as for derivatives in Dzin in the first<br>
%	columns, and the derivatives with respect to the<br>
%	complex parameters polcofs in the last columns<br>
Nl=length(zin); Kl=length(polcofs); Dl=size(Dzin,2); D2=D1+K1;<br>
zinas=abs(zin). A2;<br>
zut=repmat(polcofs(Kl),N1,1); for kl=Kl-l:-l:l;<br>
zut=zut.*zinas+repmat(polcofs(kl),N1,1); end; %(zut is by now "g", the large-signal gain)<br>
DgDzin=2*(Kl-l)*repmat(polcofs(Kl),N1,1); for  kl=Kl-l:-l:2;<br>
DgDzin=DgDzin.*zinas+2*(kl-1)*repmat(polcofs(kl),N1,1); end; DgDzin=DgDzin.*abs(zin); %( DgDzin = "d g / d |zin|")<br>
% derivatives of the output signal Dzut=zeros(N1,D2);<br>
% derivatives with respect to parameters of input signal % Dzut(:,l:Dl)=  . . .<br>
argzin=zeros(Nl,1);<br>
ii=find(abs(zin)&gt;0);<br>
argzin(ii)=zin(ii)./abs(zin(ii));<br>
Dzut(l:Nl,l:Dl)=repmat(DgDzin.*argzin,l,Dl).*<br>
real(repmat(conj(zin),1,D1).*Dzin)+  ...<br>
repmat(zut,l,Dl).*Dzin;<br><br>
% derivatives with respect to the polynomial coefficients % Dzut(:,D1+1:D2)=  ...<br>
Dzut(:,Dl+l)=ones(Nl,l); for  kl=2:Kl;<br>
Dzut(:,Dl+kl)=Dzut(:,Dl+kl-l).*zinas;<br>
Dzut(:,Dl+kl-l)-Dzut(:,Dl+kl-l).*zin; end; Dzut(:,D1+K1)=Dzut(:,D1+K1).*zin;<br>
zut=zut.*zin; %(now finally zut is "zut" (not "g"))<br><br>
Claims<br>
1.	A radio transmitter with IQ-modulator error compensation, characterized by<br>
a homodyne observation receiver (42) producing a first real baseband (S5) signal from a real radio frequency signal (S2);<br>
means (44, 46) for converting a complex baseband signal (SI) into a second real baseband signal;<br>
an adapter (40, 70) for determining parameters controlling an IQ-error compensator (12) by minimizing the error between said first and second real baseband signals; and<br>
means (18, 52, 56) for analog signal processing of said real radio frequency signal to compensate for the fact that said homodyne observation receiver produces a real and not a complex signal.<br>
2.	The transmitter of claim 1, characterized by said analog signal processing<br>
means being implemented by a non-linear power amplifier (12).<br>
3.	The transmitter of claim 2, characterized by a non-linear element (52) for<br>
enhancing the non-linearity of said power amplifier.<br>
4.	The transmitter of claim 1, characterized by a phase shifter (56) for shifting<br>
an analog local oscillator signal to said observation receiver (42) into three<br>
different phases.<br><br>
5.	The transmitter of any of the preceding claims, characterized by said<br>
adapter (70) determining parameters of an IQ-modulator model (62), the<br>
inverse model (66) of which controls said IQ-error compensator (12).<br>
6.	The transmitter of any of the claims 1-4, characterized by a model adapter<br>
(70) determining parameters of an IQ-modulator model (62) to determine a<br>
parameter gradient used by the first mentioned adapter (40) to speed up<br>
adaptation.<br><br>
7.	A radio receiver with IQ-demodulator error compensation, characterized by<br>
a homodyne observation receiver (42) producing a first real baseband signal from a real radio frequency signal;<br>
means (44, 46) for converting a complex baseband signal from an IQ-demodulator into a second real baseband signal;<br>
an adapter (40, 70) for determining parameters controlling an IQ-error compensator (12) by minimizing the error between said first and second real baseband signals; and<br>
means (52, 56) for analog signal processing of said real radio frequency signal to compensate for the fact that said homodyne observation receiver produces a real and not a complex signal.<br>
8.	The receiver of claim 7, characterized by said analog signal processing<br>
means being implemented by a non-linear element (52).<br>
9.	The receiver of claim 7, characterized by a phase shifter (56) for shifting an<br>
analog local oscillator signal to said observation receiver (42) into three<br>
different phases.<br><br>
10.	The receiver of any of the claims 7-9, characterized by said adapter (70)<br>
determining parameters of an IQ-demodulator model (62), the inverse model<br>
(66) of which controls said IQ-error compensator (12).<br>
11.	The receiver of any of the claims 7-9, characterized by a model adapter<br>
(70) determining parameters of an IQ-demodulator model (62) to determine a<br>
parameter gradient used by the first mentioned adapter (40) to speed up<br>
adaptation.<br></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
		<br>
		<div class="pull-left">
			<a href="259422-process-for-the-preparation-of-a-2-ethylaminopyridine-derivative.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="259424-process-for-making-polysiloxane-polyimide-copolymer-blends.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>259423</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>7083/DELNP/2006</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>11/2014</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>14-Mar-2014</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>12-Mar-2014</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>24-Nov-2006</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>TELEFONAKTIEBOLAGET LM ERICSSON (PUBL)</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>SE-164 83 STOCKHOLM, (SE)</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>FONDEN, TONY</td>
											<td>STORBYPLAN 5, S-163 71 SPANGA (SE)</td>
										</tr>
										<tr>
											<td>2</td>
											<td>KLINGBERG, MATS</td>
											<td>GOTAFORSVATAN 23, S-122 66 ENSKEDE (SE)</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H03F 1/32</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/SE2005/000717</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2005-05-17</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>PCT/SE2004/000789</td>
									<td>2004-05-19</td>
								    <td>Sweden</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/259423-adaptation-of-iq-error-compensation by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 02:02:57 GMT -->
</html>
