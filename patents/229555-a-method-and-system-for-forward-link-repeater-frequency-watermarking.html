<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/229555-a-method-and-system-for-forward-link-repeater-frequency-watermarking by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 10:15:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 229555:A METHOD AND SYSTEM FOR FORWARD LINK REPEATER FREQUENCY WATERMARKING</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">A METHOD AND SYSTEM FOR FORWARD LINK REPEATER FREQUENCY WATERMARKING</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>A forward link repeater frequency watermarking (FLRFWM) system and method that enable accurate position location of mobile stations in areas where repeaters are present by watermarking repeated signals with repeater information. A repeater watermarks a forward link signal with a (unique or non-unique) fast frequency modulation waveform watermark every time a signal passes through the repeater. A mobile station detects and/or identifies the fast frequency watermark on the forward link signal to determine repeater information that aids the network position determination entity or mobile station position location system in determining position location using AFLT and/or A&lt;GPS systems. A forward link fast frequency watermarking system described herein achieves minimal impact on FL, AFLT, and GPS performance, good detection, identification and false alarm probabilities, short time-to-detect/identify, and good detection/identification sensitivity.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td> <br><br>
FORWARD LINK REPEATER FREQUENCY WATERMARKING SYSTEM<br>
BACKGROUND OF THE INVENTION<br>
Cross-Reference to Related Application<br>
[001] Priority is hereby claimed to U.S. Provisional Application No. 60/449,774, filed February 24, 2003, entitled FORWARD LINK REPEATER FREQUENCY WATERMARKING SCHEME, which is incorporated by reference herein in its entirety.<br>
Field of the Invention<br>
[002]       This invention relates to position location systems that utilize wireless<br>
signals to determine the location of an electronic mobile device.<br>
Description of Related Art<br>
[003]       Existing position location technologies based on GPS use a network of<br>
satellites in earth orbit that transmit signals at a known time. A GPS receiver on the<br>
ground measures the time-of-arrival of the signals from each satellite in the sky that it<br>
* can "see". The time-of-arrival of the signal along with the exact location of the satellites<br>
and the exact time the signal was transmitted from each satellite is used to triangulate<br>
the position of the GPS receiver.   A GPS receiver requires four satellites to make a<br>
triangulation and the performance of the resulting position location increases as the<br>
number of satellites that can be detected increases.<br>
[004]       One problem with GPS-based position location determination arises if only<br>
three (or less) satellites can be found, and in such an instance (and in the absence of<br>
other ancillary information) it is not possible to accurately locate the GPS receiver. For<br>
example, if the GPS receiver's view of the sky is obstructed (e.g., deep inside a concrete<br><br>
building) it may not be possible to obtain enough GPS measurements to determine receiver location.<br>
[005] For a wireless communication receiver (i.e. mobile station), the existing wireless network of base stations can be used for position location purposes in a similar manner as the network of GPS satellites for GPS receiver. Theoretically-speaking, the exact location of each base station, the exact time at which the base station is transmitting, and the time-of-arrival of the base station's signal at a mobile station (e.g. cell phone) can be used to trilaterate the position of the mobile station. This technique is referred to as Advanced Forward Link Trilateration (AFLT). [006] The AFLT method may be used by itself for position location purposes; alternatively, in order to enhance perfonnance of a GPS system, the existing network of wireless communication base stations can be treated as a secondary network of "satellites" for position location purposes in a GPS-capable mobile station (i.e., a device that includes both GPS and wireless communication receivers). The AFLT technique, combined with GPS algorithms, is referred to as hybrid, or Assisted-GPS (A-GPS). [007] AFLT is a method for determining the position of a mobile station using a plurality of wireless communication network base stations each emitting a unique pilot signal. The AFLT method includes taking a plurality of data measurements of the pilot signals from each of the plurality of base stations, including taking measurements on the pilot signals present in the mobile station's active, candidate, and neighbor pilot sets, in the current embodiment. Each of the data measurements includes an earliest time-of-arrival estimate for each pilot signal. In some embodiments, the data measurements further include an RMSE estimate, time of measurement for each time-of-arrival, and an energy measurement (e.g., Ec/Io) for all resolvable paths of the pilot signal.<br><br>
[008] The data measurements obtained by the AFLT algorithm may be used alone to determine mobile station position; alternatively one or more of the representative AFLT measurements may be used together with representative GPS measurements to determine the position of the mobile station. In some embodiments the mobile station comprises a cell phone and the method further comprises wirelessly connecting the cell phone to one of the cellular base stations prior to taking data; the base station provides a cell search list to the cell phone of all cellular base stations in the area from which data measurements may be taken. In embodiments that include a GPS system, a base station can also provide a GPS search list, which can be used to reduce the time necessary for the mobile station to perform the'GPS search and thus to reduce time-to-fix. [009] In practice, AFLT (including A-GPS) has proven to be of only limited success for position location purposes, in part because repeaters employed in wireless networks cause an ambiguity as to the point of transmission of the pilot signal. In other words, a mobile station cannot currently distinguish whether received signal was transmitted from the donor Base Transceiver Station (BTS) or the repeater. Because the point of transmission of the pilot signal is unknown (e.g., whether directly from a donor BTS or through a repeater), the AFLT measurement cannot be used to accurately determine position. In addition, the repeater will also have internal delays, typically in a range from hundreds of nanoseconds up to tens of microseconds, potentially resulting in a position location error in the range of about 24.4 meters (for 100 nanoseconds) to about 2.44 kilometers (for 10 microseconds).<br>
[010] In one conventional embodiment, a solution to the repeater problem is to exclude all AFLT measurements in the areas where repeaters are present. However, this solution completely precludes AFLT position location and any AFLT portion of A-GPS<br><br>
from being utilized in many locations, thus reducing position location availability and yield, and increasing GPS search windows, resulting in longer times-to-fix. [011] It has been suggested to introduce a signature on the reverse link, as described in US Patent No. 6,501,955 in order to help position determination. Unfortunately, the RL signature is expected to be of only limited assistance in mitigating the effects of repeaters on position location, because the mobile station uses AFLT measurements from the forward link for position location. As there is no guarantee that the forward link back to the mobile station will follow the same path as the reverse link from the mobile station (i.e., through the same repeater), the reverse link signature is expected to be suboptimal for identifying repeater information for position location purposes. Introducing a signature onto the FL signal has also been suggested, such as described in U.S. Patent No. 6,501,955, however no practical solution has yet been developed.<br>
SUMMARY Off THE INVENTION<br>
[012] A forward link repeater frequency watermarking (FLRFWM) system and method are disclosed that enable position location determination in areas where repeaters are present by watermarking repeated signals with repeater information. The FLRFWM system includes a repeater that watermarks a forward link signal with a fast frequency modulation waveform as it passes through the repeater and a mobile station that detects and identifies the fast frequency modulation waveform. The fast frequency watermark includes repeater infonnation that may be used to determine the position of the mobile station in an area where repeaters are present, using AFLT and/or A-GPS position location systems. The repeater infonnation may simply indicate that the signal<br><br>
is repeated, or may uniquely identify the repeater through which the FL signal passed. The watermark is introduced on the forward link such that each AFLT measurement can be repeater-screened and thereby used for position location. Forward link fast frequency watermarking achieves minimal impact on FL, AFLT, and GPS performance, good detection, identification and false alarm probabilities, short time-to-detect/identify, and good detection/identification sensitivity.<br>
[013] A repeater is disclosed that includes an amplifier for amplifying the forward link signal from a base station to a mobile station and a fast frequency modulator that frequency modulates the forward link signal with an identifying fast frequency watermark as it passes through the repeater. The fast frequency watermark has a frequency such that the frequency tracking loop at the mobile station substantially does not detect the watermark in order to minimize the adverse impact on AFLT and GPS performance. Furthermore, the fast frequency watermark has an amplitude designed to minimize the adverse effect on FL performance.<br>
[014] In some embodiments, the watermark is defined by a modulation waveform that that is substantially periodic with a period of 2T. The half period T of the waveform is substantially less than the time constant of the mobile station frequency tracking loop, e.g., less than about 1/60 of the time constant of the frequency tracking loop, such that the frequency tracking loop at the mobile station substantially does not detect the watermark. In some embodiments, the periodic waveform may be a square waveform with an amplitude less than or equal to about 50 Hz. In some embodiments, the periodic waveform uniquely identifies a repeater by having a unique value of T, thus allowing for identification of the repeater at the mobile. In other embodiments, all repeaters will have a periodic waveform with the same value of T, thus allowing only repeater detection at mobile.<br><br>
[015] In some embodiments, the watermark is defined by a modulation waveform that is non-periodic, e.g., a BPSK-, QPSK-, or OQPSK-encoded waveform with a bit duration of 2T. The half bit duration T of the waveform in these embodiments is substantially less than the time constant of the mobile station frequency tracking loop, such that the frequency tracking loop at the mobile station substantially does not detect the watermark. In some embodiments, the non-periodic waveform has an amplitude less than or equal to about 50 Hz. In some embodiments, the non-periodic waveform uniquely identifies a repeater by having a unique sequence of bits, thus allowing for identification of repeater at mobile. In other embodiments, all repeaters will have the same non-periodic waveform with the same sequence of bits, thus allowing only repeater detection at mobile.<br>
[016] A mobile station is disclosed that receives a plurality of forward link pilot signals and identifies the presence of a fast frequency watermark waveform to determine whether any of the forward link signals are repeated. The mobile station^ includes a receiver for receiving forward link signals, a frequency tracking loop for enabling accurate demodulation of the FL signals, and an AFLT searcher. The AFLT searcher detects pilots and performs pilot phase measurements, including measuring the times-of-arrival of the plurality of forward link pilot signals. The mobile station also includes a repeater identification Systran configured to detect and/or identify the watermark on a FL signal, if any. The repeater identification system detects the repeater on a FL signal by searching the forward link signal for the presence of the watermark waveform. The repeater identification system identifies a repeater on a forward link signal by searching the forward link signal for the presence of the watermark waveform, retrieving the watermark waveform if present, and looking for a property of the<br><br>
watermark waveform that uniquely identifies the repeater. The frequency tracking loop substantially does not detect the watermark waveform because of its fast frequency. [017] A method for determining position location information of a mobile station is also disclosed. The method includes determining position location information from the forward link of a plurality of pilot signals in an area where repeaters may be present. The method begins by performing an AFLT search in the mobile station to detect pilots and measure an earliest time-of-arrival of the plurality of pilot signals. The mobile station then selects a first pilot signal located during the AFLT search and repeater screens the first pilot signal by performing a repeater AFLT search on the first pilot signal, including searching for a fast frequency watermark waveform that identifies a repeated signal. The frequency of the watermark waveform is such that a frequency tracking loop in the mobile station substantially does not detect the watermark at the mobile station. The method continues by repeating the steps of selecting and repeater screening for a plurality of other selected pilot signals until a sufficient number of repeater-screened pilot signals to determine a position location of the mobile station is obtained. Finally, the pilot phase measurements and repeater information for the pilot signals obtained in the AFLT search is provided to either a mobile station position detenmning system or a network position determination entity to determine the position of the mobile station.<br>
[018] Repeater information obtained during the repeater search should at minimum contain the information as to whether the pilot signal was successfully repeater-screened or not, and if it has, whether the pilot signal was repeated or not. In one embodiment, the repeater information contains only an indication of whether or not the pilot signal was successfully repeater-screened, and if yes, whether or not the signal is repeated, such that the mobile station position determining system or network position<br><br>
determination entity may determine the position of the mobile station by excluding measurements from repeated pilot signals and from any pilots that have not been successfully repeater-screened.<br>
[019] In another embodiment, the repeater AFLT search identifies a repeater ID from the watermark waveform, if one present. In this embodiment, the repeater information obtained during repeater search and provided to the mobile station position determining system or a network position determination entity also includes the repeater ID for each pilot signal identified as repeated, which allows the use of the repeated signal measurements in calculating position.<br>
[020] In some embodiments, where A-GPS is used to determine position location, a GPS search is performed prior to performing the repeater AFLT search. If sufficient GPS measurements for position location determination are obtained, the repeater AFLT search maybe skipped in the interest of reducing time-to-fix.<br>
BRIEF DESCRIPTION OF THE DRAWINGS<br>
[021]       For a more complete understanding of this invention, reference is now made<br>
to the following detailed description of the embodiments as illustrated in the<br>
accompanying drawing, wherein:<br>
[022]       Fig. 1 is a perspective view of a plurality of wireless communications<br>
network base stations, a building having a repeater located thereon, GPS satellites, and a<br>
user holding a mobile station;<br>
[023]       Fig. 2 is an illustration of an exemplary cellular base station coverage area<br>
structure;<br><br>
[024]       Fig. 3 is a block diagram of a forward link repeater frequency watermarking<br>
(FLRPWM) system including a base transceiver station (BTS), a repeater, and a mobile<br>
station (MS);<br>
[025]       Fig. 4 is a graph that shows one example of a modulation waveform F(t)<br>
applied by the frequency modulator (Fig. 3) to watermark the FL signal;<br>
[026]       Fig. 5 is a graph that shows another example of a modulation waveform F(t),<br>
which comprises a BPSK waveform;<br>
[027]       Fig. 6 is a block diagram of one embodiment of a mobile station<br>
incorporating wireless communication and position location capabilities, and including a<br>
repeater identification system;<br>
[028]       Fig. 7 is a flow chart that illustrates a repeater identification search<br>
performed on one pilot;<br>
[029]       Fig. 8 is a block diagram that illustrates the repeater identification search<br>
used to determine the repeater ID from a FL pilot signal in one embodiment;<br>
[030]       Fig 9 is a flow chart that illustrates a repeater AFLT search performed on<br>
multiple FL pilot signals in one embodiment;<br>
[031]       Fig. 10 is a flow chart that illustrates a repeater AFLT search performed on<br>
multiple FL pilot signals in another embodiment, optimized for minimal time-to-<br>
identify; and<br>
[032]       Fig. 11 is a flowchart of one example method of determining the position of<br>
the mobile station using an AFLT or A-GPS system in cellular coverage areas where<br>
repeaters are present.<br><br>
DETAILED DESCRIPTION<br>
[033]       This invention is described in the following description with reference to the Figures, in which like numbers represent the same or similar elements.<br>
Glossary of Terms and Acronyms<br>
[034]       The following terms and acronyms are used throughout the detailed<br>
description:<br>
[035]       AFLT	Advanced Forward Link Trilateration.   A location technique<br>
that utilizes the mobile station's measured time-of-airival of radio signals from base stations (and optionally other terrestrial measurements).<br>
[036]       AFLT Searcher      A part of the mobile station that conducts searches for the pilot<br>
signals from each base station that may be in view.<br>
[037]       A-GPS	Assisted Global Positioning System.   A location technology<br>
based on GPS pseudo-range measurements, but utilizing AFLT or similar BTS based position location technology to assist in determining position.<br>
[038]       Base Station	A unit that communicates with a mobile station, for example a<br>
base station may include Base Transceiver Station (BTS), Mobile Switching Center (MSC), Mobile Positioning Center (MPC), Position Determination Entity (PDE) and any Interworking Function (TWF) required for network connection.<br><br>
[039] [040]<br><br>
BPSK BTS<br><br>
Binary Phase Shift Keying.<br>
Base   Transceiver   Station.      A   fixed   station   used   for<br><br>
communicating with mobile stations that includes antennas for transmitting and receiving wireless communication signals.<br>
[041]       C/A codes	Coarse/Acquisition codes. Periodic sequences transmitted by<br>
GPS satellites, used to identify the transmitting GPS satellite<br>
and measure pseudo-range from the observed GPS satellite to a<br>
GPS receiver.<br>
[042]       CDMA	Code Division Multiple Access.    A high-capacity digital<br>
wireless technology.<br>
[043]       CSM	Cell   Site  Modem.      Chipsets  for  wireless  base-station<br>
equipment.<br>
FL	Forward Link. The transmission from a base station (BTS) to<br>
a mobile station (MS).<br>
[045]       FTL	Frequency Tracking Loop.     The FTL tracks the carrier<br>
frequency of a received communication signal to enable<br>
accurate demodulation.<br>
[046]       GPS	Global Positioning System.   A technique utilizing distance<br>
measurements to GPS satellites to determine three-dimensional<br>
location.<br>
[047]       GSM	Global System for Mobile Communications.<br>
[048]       MS	Mobile Station.   The term used to describe a subscriber's<br>
handset or wireless terminal.<br>
[049]       MSM	Mobile Station Modem.<br>
PCS	Personal  Communications  Services.     All  digital  cellular<br><br>
transmission that operates in the 1.8 - 2.0 GHz range.<br>
[051 ]       PDE	Position Determining Entity. The network entity that manages<br>
the position determination of a mobile station [052]       Pilot Set (active)    Pilot  signals   associated  with Forward  Traffic   Channels<br>
currently assigned to the mobile station.    These are the<br>
strongest pilot signals received by a mobile station from local<br>
base stations and are typically multipaths of the same pilot<br>
signal.<br>
[053]       Pilot	Set   All pilot signals that can be seen by a mobile station whose<br>
(candidate)	strength as measured by the mobile station exceeds an<br>
"over-the-air" given threshold.<br>
[054]       Pilot	Set   All pilot signals transmitted by base stations in the vicinity of<br>
(neighbor)	the base station currently transmitting to a mobile station, such<br>
that they may be received by the mobile station.<br>
[055]       Pilot Signals	Radio signals received from local base stations that identify the<br>
base station.<br>
[056]       PN codes	Pseudo-random Noise codes. Certain sequences transmitted by<br>
BTS's used as identifiers for a cell (or a cell sector), for<br>
spreading, and to scramble voice and data transmissions. PN<br>
codes are also used to determine pseudo-range from the<br>
observed BTS to mobile station.<br>
[057]       PPM	Pilot Phase Measurement.    Measurements of pilot signals<br>
obtained from an AFLT search, including a measurement of<br>
PN code shift.<br><br>
[058]       PRM	Pseudo-range Measurement   Measurements of GPS satellite<br>
signals from a GPS satellite search, including a measurement of a C/A code shift.<br>
[059]       QPSK	Quadrature Phase Shift Keying.<br>
[060]       Repeater	A device that receives, amplifies, and retransmits a radio signal<br>
to and from a BTS.<br>
[061]       RL	Reverse Link. The transmission from a mobile station (MS) to<br>
a base station (BTS).<br>
[062]       RMSE	Root  Mean   Squared  Error.      RMSE   estimate  provides<br>
uncertainty of measurement based on the strength of the path used to report pilot phase.<br>
[063]       SMR	Signal-to-Noise Ratio.<br>
[064] TRKJLO_ADJ A signal that controls a voltage-controlled, temperature-compensated crystal oscillator (VCTCXO) in the mobile station. Typically, all clocks and frequency references in the mobile station are generated from this oscillator.<br>
[065]       Table of Variables<br>
[066]       The following variables are used Hiroughout the detailed description:<br>
[067]       f	The frequency of the modulation waveform in Hz.<br>
[068]       fA	The amplitude (magnitude) of the modulation waveform in Hz.<br>
[069]       fc	CDMA chip frequency (= 1.2288 MHz)<br>
[070]       n	Total number of bits used for encoding the repeater ID.<br>
[071]       N	Total number of possible repeater IDs that may be obtained using a<br>
particular watermark scheme.<br><br>
[072]       NPOST	The number of times coherent accumulation is performed on the<br>
output of complex rotation in frequency correlation.<br>
[073]       NPRE	The number of pilot signal samples from the AFLT searcher to be<br>
coherently accumulated.<br>
[074]       T	Half period of the modulation waveform in CDMA chips.<br>
[075]       Tc	CDMA chip period (= l/fc).<br>
[076]       TCPD	The cross product update rate in CDMA chips.<br>
[077]       TFC	Time to perform a frequency correlation algorithm as a background<br>
task in firmware.<br>
[078]       TMAX	Longest modulation waveform half-period in CDMA chips.<br>
[079]       TMIN	Shortest modulation waveform half-period in CDMA chips.<br>
[080]       Environment<br>
[081] Fig. 1 is a perspective view of a plurality of base transceiver stations (BTS's) 10, a building 14 having a repeater 16 located thereon, GPS satellites 18, and a user 20 holding a mobile station 22.<br>
[082] The BTS!s 10 comprise any collection of base stations utilized as part of a wireless communication network for connection with a mobile station. The BTS's typically provide communication services that allow a mobile station such as wireless phone to connect to another phone over a wireless communication network 12; however, BTS's could also be utilized with other devices and/or for other wireless communication purposes such as an Internet connection with a handheld personal digital assistant (PDA).<br>
[083] In one embodiment, the BTS's 10 are part of a CDMA wireless communication network; however in other embodiments other types of wireless communication networks, such as GSM networks, may be used. la this embodiment,<br><br>
each of the BTS!s periodically emits a pseudo-random sequence that uniquely identifies the BTS. The pseudo-random sequence is a series of bits that are useful for the receiver to lock upon. In CDMA terminology this pseudo-random sequence is termed a "pilot signal"; as used herein, the term pilot signal can apply to any wireless communication system as well as to CDMA systems.<br>
[084] A repeater 16 in its basic form comprises an amplifier, and receives and retransmits amplified pilot signals between a BTS and a mobile station. Repeaters may be situated strategically throughout the cellular network where gaps, interference, and weak service are otherwise found, to enhance signal to noise ratios by amplifying pilot signals from the BTS!s to additional coverage areas.<br>
[085] The GPS satellites 18 comprise any group of satellites used for position location determination of a GPS receiver. The satellites continuously send out radio signals that the GPS receiver can detect, and the GPS receiver measures the amount of time it takes for the radio signal to travel from the satellite to the receiver, by correlating the local replica of GPS satellite C/A code and shifting it in time until it achieves correlation with the received satellite C/A code. Since the speed at which the radio signals travel is known, and the satellites are synchronized to periodically emit their signal every millisecond coincident with "GPS time", it is possible to determine how far the signals have traveled by determining how long it took for them to arrive. To a user situated in open space, the GPS receiver typically has an unobstructed view of the satellites; thus, when the user is in open space, measuring the time-of-arrival of the GPS signal is straightforward because it is typically a straight "line of sight" from the satellite to the receiver. However, in the wireless communication context, a user may be situated in a city with buildings or other obstacles that may make GPS positioning more difficult.<br><br>
[086] Fig. 2 illustrates an exemplary cellular BTS coverage area structure. In such an exemplary structure, a plurality of hexagonal BTS coverage areas 24 abut one another in a symmetrically tiled arrangement The BTS's 10 are located respectively within each of the BTS coverage areas 24 and provide coverage within the area in which they are located. Particularly, for purposes of description herein, a BTS 10a provides coverage within a coverage area 24a, a BTS 10b provides coverage within a coverage area 24b, and so forth.<br>
[087] In an ideal cellular communication network, coverage areas 24 are configured adjacent to each other to provide continuous cellular coverage to a mobile station as it travels through the various coverage areas. However, most cellular networks have gaps, interference, and other obstacles that cause problems with cellular coverage. For example, environments like tunnels, garages, and sports arenas create problems for cellular services. As other examples, extended highway and rural coverage can be very expensive to maintain with BTS's. Thus, one or more repeaters 16 may be placed within a coverage area in order to enhance or extend the coverage of a BTS at a much lower cost than installing another BTS.<br>
[088] la one embodiment, repeaters 16 comprise antennas and transceivers that send and receive signals to and from mobile stations and BTS's, such as will be described in more detail with reference to Fig. 3. In one simple example, a repeater amplifies the received signals and retransmits them on the same frequency. [089] In Fig. 2, the user 20 holding the mobile station 22 is located within the first coverage area 24a. The mobile station 22 may be unable to receive a sufficiently strong pilot signal from a first BTS 10a due to interference from an obstacle such as a large building (not shown). Additionally, the mobile station 22 may be unable to receive a sufficiently strong pilot signal directly from the second BTS 10b due to the relatively far<br><br>
distance. However, a repeater 16b is placed appropriately within coverage area 24b, such that the location of the mobile station 22, which would otherwise experience a gap in service, may be sufficiently covered. In other words, when a pilot signal is transmitted from the second BTS 10b, it will be amplified through the repeater 16b and received at the mobile station 22.<br>
[090] The mobile station 22 has position location capabilities such as described above, including AFLT, and therefore can utilize not only the pilot signals currently assigned to the mobile station (i.e., active set), but can also utilize pilots signals beyond the active set for purposes of determining the position of the mobile station. For example, in one embodiment, the mobile station searches for pilot signals present in a neighbor list 29, which is a list of pilot signals that might be receivable by the mobile station. The neighbor list may be supplied from a base station, for example. [091] It may be noted that certain pilots in the neighbor list may be selected for the candidate set 28 (i.e., pilot signals that can be seen by a mobile station whose strength as measured by the mobile station exceeds an "over-the-air" given threshold) or the active set 27 (i.e., pilot signals associated with Forward Traffic Channels currently assigned to the mobile station, which are the strongest pilot signals received by a mobile station from local base stations and are typically multipaths of the same pilot signal) according to current CDMA standards.<br>
[092] In order to use AFLT measurements in position location determination of the mobile station 22, the pilot signals (whether in the active, candidate or neighbor set) must be successfully screened for repeaters, and if repeated, the mobile station must determine from which repeater the signal came; additionally, the location and internal delays of the repeaters must also be known and available in order to use repeated AFLT measurements in the position location calculation.<br><br>
[093] As previously described herein, conventional AFLT and A-GPS positioning systems within the mobile station do not detect and/or identify a repeated signal, which makes the pilot phase measurements for determining position substantially useless in an area having repeater coverage. To address this problem, a repeater that is able to uniquely watermark a forward link signal, and a mobile station that is able to detect and identify a watermarked repeated signal are disclosed herein. Because the mobile station is able to detect and identify whether or not a signal is repeated, and if repeated, from which repeater the signal came, accurate position information may be determined using any of the active, candidate, and neighbor pilot signals received by the mobile station. In addition, a repeater that is able to (uniquely or non-uniquely) watermark a forward link signal, and a mobile station that is able only to detect watermarked repeated signals, are disclosed herein. In this embodiment, because the mobile station is able to only detect whether or not a signal is repeated, all the repeated pilot signals (and the pilot signals that were not successfully repeater-screened) must be excluded from the position location determination. [094]       Description<br>
[095] Forward Link Repeater Frequency Watermarking (FLRFWM) System [096] Fig. 3 is a block diagram of a communication system that implements an FLRFWM system. The communication system includes a base transceiver station (BTS) 10, a repeater 16, and a mobile station (MS) 22. The BTS 10 has an antenna 30 for transmitting a forward link pilot signal 31 therefrom. The repeater 16 has a first antenna 32 for receiving the forward link signal 31 from the BTS 10, an amplifier 33 for amplifying the signal, a fast frequency modulator 34 for watermarking the FL signal, and a second antenna 36 for transmitting the watermarked forward link signal 37 to the MS 22. The MS has an antenna 38 for receiving the watermarked forward link signal 37<br><br>
from the repeater, and a frequency tracking loop 39 to enable accurate demodulation of the FL signal 37.<br>
[097]. The BTS 10 may comprise any appropriate base station used for wireless communication. In one embodiment, the BTS is configured for a CDMA network; however, in other embodiments, the BTS may be implemented for other wireless communication networks, such as TDMA and GSM. Although only one antenna 30 for transmitting signals is shown, it should be understood that the BTS has a typical configuration of a BTS, including one or more transceivers and antennas for transmitting and receiving signals.<br>
[098] The repeater 16 comprises any appropriate repeater that has an amplifier 33 for amplifying telecommunication signals; that is, the repeater 16 comprises any suitable configuration that receives, amplifies, and retransmits telecommunication signals to and from the BTS 10 and the MS 22. Additionally, the repeater comprises a frequency modulator 34 that watermarks the forward link signal 31 with a fast frequency modulation as will be discussed in more detail with reference to Fig. 4 or Fig. 5, for example.<br>
[099] In one embodiment, the repeater 16 comprises first and second antennas 32, 36. The first antenna 32 is used to receive the forward link signal 31 and the second antenna 36 is used to retransmit the forward link signal 37 out of the repeater. It may be noted that although the repeater in Fig. 3 shows only an amplifier and a frequency modulator, it should be understood that the repeater 16 has any suitable configuration; for example, the repeater may also comprise transceivers (transmitters/receivers) that function to receive and retransmit signals into and out of the repeater 16 via the antennas 32,36.<br><br>
[0100] It may be noted that the repeater may comprise alternative configurations; for example, the repeater may be connected to the BTS via a wired connection. One such example includes an optical repeater that receives an optical signal (e.g., fiber optic), amplifies it (and/or reshapes, retimes, frequency shifts, and otherwise reconstructs it), and retransmits it wirelessly (on the same or different frequency). [0101] The repeater 16 includes the fast frequency modulator 34 that frequency modulates the forward link signal 31 with a fast frequency watermark, such as described in more detail with reference to Fig. 4 or Fig. 5, for example. The fast frequency watermark identifies the forward link signal as a repeated signal and may identify a unique repeater ID that indicates through which repeater the signal passed. By watermarking the repeated forward link signal, it can be determined which of the pilots are repeated, and by uniquely watermarking the repeated forward signal in addition it can be determined for those repeated pilots, which particular repeater repeated the pilot signal. Using this information, accurate position location information.may be obtained using AFLT or other similar position location technology.<br>
[0102] Still referring to Fig. 3, the mobile station 22 has an antenna 38 for receiving telecommunication signals from the BTS's and repeaters, including the watermarked forward link signal 37 from the repeater 16. As will be described in more detail with reference to Fig. 7 and Fig. 8, the MS 22 can detect the fast frequency watermark on a FL signal, if any, distinguish whether the signal came from a repeater, and in some embodiments identify which particular repeater transmitted the signal, thus enabling accurate AFLT measurements to be achieved and enabling them to be used in position location calculation as will be described elsewhere herein. It should also be noted that the frequency tracking loop 39 should not be able to detect the fast frequency watermark, such as will be described in more detail with reference to Figs. 4 and 6.<br><br>
[0103] Repeater Frequency Watermarking Modulation Scheme [0104] Reference is now made to Figs. 4 and 5, which illustrate two example fast frequency modulation waveforms that may be used to watermark the FL signal. Fig. 4 illustrates a periodic square wave waveform used to frequency modulate the FL signal, wherein the repeater ID unique for each repeater is identified by the frequency (i.e., the choice of the half period T) of the modulation wavefonn, such as will be described herein. Fig, 5 illustrates a non-periodic wavefonn used to frequency modulate the FL signal wherein the repeater ID unique for each repeater is encoded within the modulation wavefonn using binary phase shift keying (BPSK). It should be noted that a variety of different modulation waveforms may be frequency modulated onto the FL signal in order to watermark the FL signal. For example, periodic waveforms such as sine and triangle type waveforms, and non-periodic waveforms such as QPSK and OQPSKmay be used<br>
[0105] In some embodiments where detection only of a repeated signal is required, the mobile station may simply detect whether the signal is repeated or not, without identifying the repeater through which the signal passed. In this case, since the presence of the modulation waveform simply indicates that the pilot signal is repeated, and no additional information is necessary, all the repeaters could be assigned the same ID and thus apply the same modulation waveform to all repeated FL signal. However in other embodiments where both detection and identification of a repeated signal are required, the modulation waveform includes a repeater ID unique to each repeater such that the mobile station may be able to not only detect the presence of the modulation waveform but also identify the repeater through which the pilot signal passed from the modulation waveform.<br><br>
[0106] Fig. 4 shows one example of a modulation waveform 40 that may be modulated onto the FL signal as it goes through the repeater to wateimark the signal in one embodiment. In this embodiment, the frequency of the modulation waveform is the unique ID of the repeater that repeated the FL signal; that is, the half period T of the waveform represents repeater ID of the repeater through which the FL signal passed. In this embodiment, the modulation waveform comprises a periodic square wave 40 with amplitude of fA and a period 44 of 2T. Variables fA (amplitude of the frequency modulation waveform) and T (half period of the waveform) 42 should be chosen to minimize the adverse effect on FL, AFLT, and GPS performance while maximizing repeater detection and identification probabilities, as will be described elsewhere in more detail.<br>
[0107] In order to watermark n-bits (where n represents the number of bits used for the repeater ID) onto the pilot signal, N=2n waveforms may be defined, each with a period of 2[TMiN-iflc:TMAx]Tc seconds, where 2TMIN is the shortest, and 2TMAX is the longest modulation waveform period in CDMA chips, N is the number of distinct repeater ID's that may be modulated in this example embodiment, and inc is chosen to create a uniform frequency spacing between N watermarks.<br>
[0108] Additionally, the half period T 42 should be chosen such that the slowest watermark (i.e. watermark with a maximum T (TMAX)) is sufficiently fast to substantially avoid detection by the frequency tracking loop (FTL) (shown in Fig. 3 at 39), at the MS. Otherwise, if the FTL were able to detect the frequency watermark at the MS, it would cause TRK_LO_ADJ (a signal that controls voltage-controlled, temperature-compensated crystal oscillator VCTCXO in the mobile station from which all the mobile clocks and frequency references may be generated) to be off by the current amplitude of the frequency watermark (fA or -fA). hi a CDMA network system,<br><br>
this would result in undesired CDMA code Doppler that would adversely impact accuracy of AFLT measurements because there is conventionally no time tracking implemented in AFLT searching; similar problems may result when implemented in other wireless communication systems as well. Furthermore, in A-GPS systems, the frequency tracking loops are disabled during GPS processing since the mobile is always in an acquisition mode and TRK_LO_ADJ is frozen at its last CDMA value, which would be the opposite of the watermark amphtude at the moment of freezing. This error translates into GPS Doppler error in GPS pseudo-range measurements, potentially reducing the measurement yield of GPS pseudo-range measurements and the accuracy of the resulting position location.<br>
[0109] In some implementations, it may be advantageous to choose a waveform with a magnitude fA of up to about 50Hz in order to minimize degradation of FL performance (e.g. less than 0.2dB on average), maximize repeater detection and identification probabilities, and minimize time-to-identify. In one example implementation of the waveform of Fig. 4 wherein fast frequency modulation is implemented in a CDMA network system, good results are found when fA is about 50Hz and T is in about [10*64:inc: 11*64] CDMA chip range, where CDMA chip duration or Tcis 1/I.2288e6 seconds, and inc is chosen to achieve uniform spacing in frequency for easier detection. The resulting value is then truncated to the nearest chipx8 clock. For example, the resulting frequencies of the watermark waveform would be in the [872.72:960] Hz range with uniform (about 2.815Hz) separation. These results will be described in more detail in the Example section, which discusses how variables (e.g., fA and T) can be optimized to provide minimal impact on FL CDMA, AFLT and GPS performance, maximum repeater detection and identification probability, and minimal time-to-identify.<br><br>
[0110] The fast frequency modulation in the embodiment of Fig. 4 is advantageous in part because it does not require symbol time synchronization. In other words, because Ihe repeater is uniquely identified by the frequency of the periodic modulation waveform (i.e., by the half period T), rather than by a particular (n-bit) symbol code, there is no need to provide synchronization at the repeater that would otherwise be' required to accurately synchronize the start (and end) of a non-periodic modulation waveform (e.g., encoded n-bit symbol code). Additionally, because of the inherent characteristics of the periodic modulation waveform in this embodiment, specifically the repeater ID being encoded in the modulation waveform frequency, this watermark is highly immune to fading as compared to other frequency modulation based watermark schemes.<br>
[0111] Reference is now made to Fig. 5, which illustrates another example modulation waveform 50 used to watermark the FL. Particularly, Fig. 5 illustrates using Binary Phase Shift Keying (BPSK) to fast frequency modulate an n-bit repeater ID on a FL signal. In this embodiment, each bit duration 54 is defined by two half periods T. A zero ('0?) 56 is generated by modulating the pilot signal for a half period T with fA, followed by modulating the signal with -fA for a half period T. A one (T) 58 is generated by modulating the FL signal first with -fA and then with fA for two consecutive time T durations. This watermarking modulation will require (n-bit) symbol time synchronization, and therefore the repeater must have a system to accomplish the necessary synchronization. Even though symbol time synchronization can add complexity and cost to the implementation of the fast frequency modulation at the repeater, in some embodiments, the benefits may outweigh the costs, and the modulation scheme can achieve good results.<br><br>
[0112]     It may be noted that while some examples of implementation in a CDMA system are given here, fast frequency modulation may be implemented in a variety wireless communication systems, such as TDMA and GSM. [0113]     Mobile Station<br>
[0114] Fig. 6 is a block diagram of one embodiment of the mobile station 22 incorporating AFLT and GPS-based position location capabilities, and including a repeater identification system capable of detecting a watermark on a FL signal (i.e. if the signal is repeated). If detected, it can extract repeater information from the watermarked repeated FL signal. This embodiment utilizes both GPS and/or AFLT to determine position; however in alternative embodiments AFLT maybe used alone. [0115] hi Fig. 6, a wireless communication system 60 is connected to one or more antennas 59. The wireless communication system 60 comprises suitable devices, hardware, and software for communicating with and/or detecting signals from wireless BTS's, including a receiver 61 for receiving FL signals, and a frequency tracking loop (FTL) 62 that enables accurate demodulation of the FL signals. [0116] In one embodiment, the wireless communication system 60 comprises a CDMA commumcation system suitable for communicating with a CDMA network of wireless BTS's; however in other embodiments, the wireless communication system may comprise another type of network such as TDMA or GSM. [0117] A mobile station control system 63 is connected to the wireless communication system 60, and typically includes a microprocessor that provides standard process functions, as well as other calculation and control systems. An AFLT searcher 64 is connected to the wireless communication system 60 and mobile station control system 63. The AFLT searcher detects pilots and performs pilot phase measurements on the mobile station's found pilot signals (e.g., from the active,<br><br>
candidate, and neighbor pilot sets), and supplies those measurements to pilot phase measurement (PPM) database 65.<br>
[0118] The pilot phase measurement (PPM) database 65, which is connected to the control system 63, is provided to store information regarding observed data measurements from the AFLT searcher, for example time-of-arrival, RMSE, and Ec/Io. A pilot ID uniquely identifies each pilot signal in the database. [0119] A position determination system 66, which may be optionally provided within the mobile station, is connected to the mobile station control system 63 and the PPM database 65; the position determination system 66 requests information and operations as appropriate from the other systems (e.g. GPS communication system, PPM database, and repeater identification system), and performs the calculations necessary to determine the mobile station's position using measurements obtained by any suitable AFLT algorithm, GPS algorithm, or a combination of AFLT and GPS algorithms (A-GPS). To that end, the position determination system 66 may also comprise a database (not shown) of locations and internal delays of all BTS's and repeaters whose pilot signals are listed in the active, candidate, and neighbor list. [0120] It should be noted that the position determination system 66 may function alone, without the network position determining entity (PDE); that is, the MS may determine its own position without assistance from a resource outside the MS (standalone mode). Alternatively, the position determination system 66 may function together with the external PDE residing elsewhere in the network; that is, the PDE may assist the MS in generating a GPS search list (e.g., by providing a GPS almanac and ephemeris to the MS), while the MS may perform position calculation (MS-based mode). However, in some alternative embodiments, the mobile station control system 63 may receive GPS acquisition assistance (e.g., a GPS search list with search windows<br><br>
both in code and frequency) from an external PDE and communicate some or all of the position measurement information (e.g., AFLT and GPS measurements, repeater information, and so forth) to a PDE outside the MS, which calculates the position of the MS and possibly sends the position back to the MS through the wireless communication network. The PDE may reside on one or more external processing systems that are networked to communicate with the mobile station. It may be noted that the PDE aiding could be modified to include sending any repeater aiding information to the MS that is available to the serving base station, such as all of the possible repeaters on a particular PN, their repeater IDs, and their internal delays (and potentially their locations, if position location is to be performed at the MS). This may aid in reduction of repeater time-to-identify and thus time-to-fix.<br>
[0121] A user interface 67 includes any suitable interface systems, such as a microphone/speaker 68, keypad 69, and display 70 that allow user interaction with the MS. The microphone/speaker 68 provides for voice communication services using the wireless communication system. The keypad 69 comprises any suitable buttons for user input. The display 70 comprises any suitable display, such as a backlit LCD display. [0122] A GPS communication system 74 is also connected to the mobile station control system 63 and to the one or more antennas 61, and comprises any suitable hardware and software for receiving and processing GPS signals. [0123] The mobile station 22 further comprises a repeater AFLT searcher 73, repeater identification system 72, and optional repeater ID database 71, which together enable accurate PPMs for position location determination even in wireless communication coverage areas where repeaters are present. Upon request, the repeater AFLT searcher 73 runs a repeater AFLT search on some or all active, candidate, and neighbor pilots found by the regular AFLT searcher 64. The results are then sent to the<br><br>
repeater identification system 72, which comprises any suitable hardware, firmware and/or software that runs a repeater identification search. The repeater identification search is able to detect a repeated signal, if any, and to decode a watermark on the signal in order to determine from which repeater the FL signal came. Typically the repeater identification search is implemented digitally, such as will be discussed with reference to Fig. 8; however, other implementations could use other search methods. [0124] In some embodiments, a repeater ID database 71, connected to the repeater identification system 72, may be optionally provided and may hold information about repeated signals within the vicinity of the mobile station currently capable of transmitting to the mobile station to aid in detection and position location. The repeater ID database may be useful to assist in identifying a repeater; for example, the information in the repeater ID database may be sent to the position determination system internal in the mobile station or to the network position determining entity, external to the MS, for using the repeated pilot signals in determining the position of the MS. It may be noted that the information stored in the repeater database may optionally be housed external to the MS in the PDE, such as described with reference to the position determination system 66.<br>
[0125] Repeater Frequency Watermarking Detection and Identification Scheme<br>
[0126] Reference is now made to Fig. 7, which is a flow chart of a repeater identification search, illustrating how the repeater identification search detects and identifies a watermark on a single FL signal in one embodiment As will be described with reference to Figs. 9 and 10, multiple repeater AFLT searches will typically run on multiple  pilot   signals   in   order  to   obtain   sufficient  repeater-screened   AFLT<br><br>
measurements for position location; however Figs. 7 and 8 will focus on a repeater search as applied to a single FL pilot signal.<br>
[0127] At 76, a plurality of pilot signal samples are accumulated (e.g., by a pilot searcher) for a single pilot signal in order to provide required processing gain for the signal and to increase the SNR, thereby enabling reliable repeater detection and identification for pilot signal strengths of interest.<br>
[0128] At 77, the repeater identification search detects the fast frequency watermark waveform on the FL signal, if any, and in some embodiments, determines repeater ID from the watermark. One example is described with reference to Fig. 8 at 88, which uses frequency correlation to determine the frequency of the watermark, which determines the repeater ID.<br>
[0129] It should be understood that many different methods for detecting and identifying repeater ID from a watermark are possible, for example if the watermark comprises a repeater ID encoded by BPSK fast frequency modulation (Fig. 5), the repeater identification search may no longer use frequency correlation but rather a matched-filter based method and would require symbol time synchronization in the repeater. In one example wherein detection only (not identification) of a repeater is desired, the watermark encoding, and thus the detection thereof, may be simplified. [0130] At 78, the repeater information gathered by the repeater search is sent to the mobile station control system or PDE for appropriate processing. It may be noted in some embodiments where detection only of a repeated signal is provided on the watermark (i.e., non-unique repeater ID), then the repeater identification search will result in repeater information indicating whether or not the signal was successfully repeater-screened (e.g. if the repeater search was not even attempted, or if the repeater search has been attempted but failed, or if the repeater search has been successfully<br><br>
performed), and if so, whether or not the signal is repeated. However, if the repeater ID is provided by the waveform, the repeater information will also include the repeater ID extracted from the watermark waveform for the pilot signals found to be repeated. [0131] As will be described elsewhere with reference to Figs. 9 and 10, the repeater AFLT searcher may run multiple pilots in series or in parallel in order to obtain sufficient repeater-screened pilot phase measurements (PPMs) to determine the position of the mobile station.<br>
[0132] Reference is now made to Fig. 8, which is a block diagram that illustrates one example embodiment of the repeater identification system, showing how the repeater identification search is configured to examine the forward link signal, and retrieve the watermark frequency that corresponds to the repeater ID using a frequency correlation with all possible repeater IDs. In this example, the repeater ID is contained within the watermark period (2T) and N represents the distinct number of watermarks (repeater ID's) that may be modulated in one example modulation scheme. [0133] At 80, the repeater AFLT searcher receives in-phase (I-phase) and quadrature-phase (Q-phase) pilot signal samples at fc (chip frequency) and performs coherent accumulation of NPRE/2 pilot signal samples to achieve higher processing gain. The output of the coherent accumulation (at 80) includes NPRE/2 pilot signal samples now at a slower rate , which have higher SNR. The results, in the form of I- and Q-pilot signal samples, are sent to the repeater identification system, which will be described with reference to reference numerals 82,84,86, and 88. [0134] At 82, the repeater identification system receives the NPRE/2 CDMA chip pilot signal sample sums from the repeater AFLT searcher 80, and coherently accumulates them two more times. This additional coherent accumulation further increases the SNR and thus the processing gain of the pilot samples.<br><br>
[0135] It may be noted that two sets of coherent accumulation are shown at 82 on over two consecutive on-time, and two consecutive NPRE/2-CDMA-chips-delayed NPRE/2 chips pilot sample coherent sums (where z"1 represents the NPRE/2 CDMA chip delay applied to the NPRE/2 chip pilot sample sums). This is one example embodiment that may be implemented in order to remove repeater ID detector sampling phase dependency without reducing NPRE from its'maximum possible value of TMW2 (such as described below). In other words, it may be necessary to coherently accumulate these two sets two times (one delayed and one non-delayed), in order to obtain 2 coherent sums over NPRE chips pilot samples that are offset from each other by NPRE/2 chips. [0136] At 84, two NPRE chip pilot signal samples coherent sums from 82 are taken (offset by NPRE/2 chips), and the same processing is performed on them. Thus, to describe this processing, we can focus only on the processing of the upper on-time NPRE chip sum of pilot samples in 84. Here, z'1 illustrates a delay of NPRE CDMA chips applied to delay one the NPRE pilot sample sum output from 82. As will be discussed with reference to 86, one NPRE chips delayed and one non-delayed version of the NPRE pilot signal chip sample sums will provide signals with which to calculate a cross product.<br>
[0137] At 86, the repeater identification system receives the NPRE chip delayed and non-delayed NPRE pilot signal sample sums from 84 (for both on-time and NPRE/2 chip delayed sums). The watermark is then retrieved by calculating the cross product of the delayed and non-delayed coherent sums of NPRE CDMA chip pilot signal samples from 84 (for both on-time and NPRE/2 chip delayed sums). NPRE is limited to no more than TMIN/2 (which is twice the Nyquist rate), where TMIN is the minimum value of T, due to cross-product practical pull-in range of (fc /4TCPD), where TCPD is the cross-product update rate in CDMA chips (and is equal to NPRE CDMA chips).<br><br>
[0138] It may be noted that Fig. 8 at 86, two sets of cross-products are shown in parallel on NPRE coherent sums that are offset by NPRE/2 chips, which follows the two sets of coherent accumulation for the reasons described above. The output of these two cross products would then be time multiplexed, or aligned, by a switch at fs=2^/NpRE to retrieve the combined frequency watermark (e.g., sampled at 2 fc/NpRE, where fc is CDMA chip frequency and is equal to 1.2288 MHz).<br>
[0139] At 88, the repeater identification system receives the fast frequency watermark, if any, from 86 and performs frequency correlation with all possible repeater IDs to extract the repeater ID therefrom. The frequency correlator in essence, obtains the frequency content of the frequency watermark waveform, if any, which in turn identifies the repeater ID in one embodiment.<br>
[0140] As shown in at 88, the frequency correlator runs N complex rotations with N possible watermark waveform frequencies, together with coherent accumulation over NPOST consecutive complex rotation outputs followed by M non-coherent accumulations to achieve forward link repeater frequency watermark (FLRFWM) detection and identification. In other words, of the N resulting energies, the highest energy that is also stronger than a set threshold is selected as the winning peak, and the frequency used to run complex rotation for this winning peak defines the repeater watermark waveform frequency (1/(2T)). Therefore its number (1 to N) defines the repeater ID. If no energy of the N resulting energies satisfies the winning peak criteria (e.g. the energies are all below the set threshold), then no watermark waveform is present on the FL signal, thus the FL signal is not repeated.<br>
In one example embodiment, frequency correlation comprises an N-point FFT (fast Fourier transform) algorithm. It should be noted that performing an N-point FFT algorithm (e.g., 32-point FFT in this embodiment) is advantageous over performing the<br><br>
full NPOST FFT (e.g., 2*1364 points here) since it reduces the time needed to perform EFT and thus the time-to-identify. N-point FFT is sufficient because the watermark can only have N distinct frequencies, thus occupying only a small portion of whole frequency space. It may be noted that this is only one example algorithm that may be used to extract repeater ID in one embodiment where the repeater ID is contained in the watermark waveform period (2T) and a total number N of possible unique repeater ID's may be provided per pilot signal (e.g., the waveform of Fig. 4). However, it should be understood that alternative embodiments may utilize other algorithms to extract repeater information from this example watermark waveform or other watermark waveforms. [0141]     Repeater AFLT Search Methods<br>
[0142] Figs. 9 and 10 are flowcharts that illustrate two alternative example methods for performing repeater searches on multiple pilots to obtain sufficient repeater-screened pilot phase measurements (PPM) for determining the position of the mobile station. It may be noted that there are many possible repeater search methods; however only two methods are illustrated herein. For example, in an A-GPS system, it may be determined that only one or two additional PPMs may be necessary to determine position location (in combination with PRM measurements from GPS); therefore the repeater search may require a much simpler methodology that examines only the one or two best pilot signals.<br>
[0143] It may be noted that while Figs. 7 and 8 illustrate how a mobile station extracts repeater information from a single pilot signal, Figs. 9 and 10 illustrate repeater AFLT search and identification methods, which include selecting pilot signals, running a repeater identification on each pilot signal and repeating the process until sufficient measurements have been obtained for a pre-fix and/or for determining the final position of the mobile station.<br><br>
[0144]     Reference is now made to Fig. 9, which is a flow chart of a method of<br>
performing a repeater search, illustrating how the repeater identification system within<br>
the mobile station performs a repeater search.<br>
[0145]     At 90, a regular AFLT search is run on all pilot signals (e.g., from the active,<br>
candidate, and neighbor sets).<br>
[0146]     At 92, in order to begin operations efficiently, the "best" detected pilot from<br>
the regular AFLT search is determined.   The selection of tfibest" pilot signal may be<br>
made based on any suitable criteria on the results of the regular AFLT search, such as<br>
pilot strength (Ec/Io), RMSE, and so forth, where the "best" pilot would be the one with<br>
the highest Ec/Io, lowest RMSE, and so forth, depending upon a variety of practical<br>
factors and design criteria.<br>
[0147]     At 94, a repeater identification search is run on the selected pilot, such as<br>
described with reference to Figs. 7 and 8 above.<br>
[0148]     At 96, the mobile station determines whether sufficient repeater-screened<br>
PPMs have been obtained from the repeater search (i.e. sufficient repeater-screened<br>
PPMs for the purposes of the pre-fix or for determining the final position of the MS).<br>
[0149]     At 97, if sufficient repeater-screened PPMs have not been obtained,<br>
additional pilot(s) need to be selected for repeater screening.<br>
[0150]     At 98, the next "best" pilot is selected such as described with reference<br>
numeral 92 above. This process continues in a loop, repeating steps 94 and 96 with the<br>
next best pilot signal, and so on, until sufficient pilot measurements have been searched<br>
for repeater ID presence, to accurately determine the MS position for the pre-fix or<br>
final-fix.<br>
[0151]     At 99, once a sufficient number of PPMs have been screened for repeater<br>
information, the repeater AFLT search is done and the results are sent to the appropriate<br><br>
system for processing the position of the mobile station, such as the MS position determination system described elsewhere herein (Fig. 6 at 66) or a PDE. As described in more detail with reference to reference numerals 78 and 119, the.repeater information may comprise an indication of whether or not the signal is successfully repeater-screened (e.g. the repeater search was not even attempted, or the repeaters search has been attempted but failed, or repeater search has been successfully performed), whether or not the signal is detected as repeated, and in some embodiments, the unique repeater ID associated with the repeated signal.<br>
[0152] Reference is now made to Fig. 10, which illustrates an alternative method for performing a repeater search for multiple pilots, which may advantageously reduce the time to complete the repeater identification process. This method takes advantage of the fact that for stronger pilots with higher Ec/Io, the repeater identification process does not have to take as long as for the weaker pilots with lower Ec/Io, and still maintain the same identification performance (e.g., the same target probabilities of false alarm and identification). Thus, the repeater identification search sensitivity can be modified to enhance time-to-identify, and the shallow and deep searches can be decoupled, in order to provide quicker response for high Ec/Io scenarios.<br>
[0153] In this embodiment, the repeater identification system still performs repeater identification on only as many ccbest" pilots detected from the regular AFLT search as necessary for accurate pre-fix or final-fix position location determination, but the repeater identification process itself is now allowed to be shorter based on the pilot signals strength (Ec/Io).<br>
[0154] At 100, a regular AFLT search has been run on all pilot signals from the active, candidate, and neighbor sets, and the L best results of the regular AFLT search are sent to the repeater identification system to perform the repeater AFLT search<br><br>
thereon. The selection of fiCbest" pilot signal may be made based on any suitable criteria on the results of the regular AFLT search, such as pilot strength (Ec/Io), RMSE, and so forth, where the "best" pilot would be the one with the highest Ec/Io, lowest RSME, and so forth, depending upon a variety of practical factors and design criteria. [0155] At 101, the repeater identification system selects a first pilot in the set of L best pilots.<br>
[0156] At 102, each pilot is grouped based on its Ec/Io strength into 4 pilot strength groups Si;yf4, to be searched with 4 repeater identification searches of varying Ec/Io depths and thus varying search times. Grouping may be accomplished as follows: thresholds Thi,2,3,4 are set (with Thi being the strongest and TI14 being the weakest Ec/Io threshold), the Ec/Io measurement for a first pilot is compared with the first threshold (Thi) and placed in group Si if found above that threshold, if not, the pilot is then compared with Thfc and placed in group S2 if found above that threshold, and so forth. [0157] At 103, if more pilots remain in the L best results from the regular AFLT search, the loop continues until all L best pilots have been grouped. [0158] At 104, a shortest and shallowest repeater identification search Si is performed first on all pilots in the Si strongest group in parallel. It may be noted that each of the four pilot strength groups Si,2,3,4 have varying Ec/Io depths and thus varying search times. Thus, if all L "best9' pilots detected in a regular AFLT search that need to be screened for repeaters have high Ec/Io (e.g. &gt; Thl), the repeater identification will complete without having to perform any of the deep searches (e.g., all pilots will be searched for repeater IDs with the shallowest and thus shortest search Si), thus minimizing the time necessary to complete repeater identification process.<br><br>
[0159]     At 105, if sufficient repeater-screened pilot phase measurements (i.e.,<br>
repeater-screened PPMs) are obtained to determine the position of the MS, no more<br>
repeater searching is necessary.<br>
[0160]     At 106, the repeater search (i.e. step 104) is repeated on any remaining pilots<br>
in the search group until all pilots have been screened for repeater information, or until<br>
sufficient repeater measurements have been obtained for pre-fix and/or final positioning<br>
the MS.<br>
[0161]     At 107, steps 104 to 106 are repeated on the remaining groups (82,3,4) until<br>
there are no more search groups (e.g., i==4 in this example).<br>
[0162]     At 108, after sufficient repeater measurements have been obtained or no<br>
more search groups remain, processing is complete and appropriate measurements may<br>
be sent for pre-fix or final-fix (position determination) of the MS.<br>
[0163]     In some embodiments, a concept of preferred response quality may be<br>
incorporated, where different preferred response quality values are consistent with<br>
desired repeater search sensitivity, target probabilities, scope/yield and maximum<br>
allowable time-to-identify.   In this manner, we can have different preferred response<br>
quality values for initial coarse position (i.e., pre-fix) and final position determination<br>
(i.e., final fix) repeater search, to allow for different maximum time-to-identify<br>
requirements between the two. Furthermore, we may have different preferred response<br>
quality values for final fix as well, to allow for possible differing requirements of<br>
various types of the application on the repeater detection process.<br>
[0164]      Preferred response quality value would set target detection process error<br>
probabilities, that will dictate S1,2,3,4earch Ec/Io sensitivities, as well as choice of<br>
various other repeater search parameters, such as maximum and minimum number of<br>
pilots for which repeater search is to be performed, as well as maximum total time-to-<br><br>
identify. Search detection thresholds Th12,3,4 could then be dynamically adjusted per repeater search, based on the obtained results from the regular AFLT search and the desired preferred response quality parameters, to further minimize total time-to-identify. For example, even though preferred response quality may be set for maximum allowable time-to-identify, if all the AFLT measurements that need to be screened for repeaters have high Ec/Io, then the thresholds Thi,2,3,4 fo the AFLT repeater search session should be dynamically adjusted such that no deep searches are performed, thus minimizing the actual time-to-identify.<br>
[0165] As will be described in more detail in the next section, repeater searches (and thus repeater identification) may only be performed when necessary, i.e. only for pre-fix or only when the GPS search (if A-GPS is being performed) does not return enough GPS measurements to determine position location, in order to save processing time (MIPS) and shorten time-to-fix. One position location method will be described with reference to Fig. 11.<br>
[0166] Example method of determining position using FLRFWM [0167] Fig. 11 is a flowchart of one example method of determining position location of the mobile station using an AFLT or A-GPS in cellular coverage areas where repeaters are present. It should be apparent that many different methods of determining position may be implemented using the repeater identification system disclosed herein. [0168] At 110, a search list of cellular BTS neighbors is obtained. The cell search list will be used to search for pilot signals from the cellular stations on the list, and it may also include information useful in finding the pilot signals of the stations on the list. [0169] The cell search list may be obtained in a variety of ways; in one simple embodiment, the cell search list includes all possible pilot signals in a cellular system; however, searching all the possible pilot signals may consume an undesirable amount of<br><br>
time. In order to save time in one embodiment, a local cellular base station communicating with the mobile station can provide the cell search list for the mobile station, including the search windows over which to search for each pilot signal. Note that the cell search list could be modified to also include any repeater aiding information that is available to the serving base station, if any, such as all the possible repeaters on PNs in the list, their IDs, and their internal delays (and potentially their locations, if position location is to be performed at MS). This may aid in reduction of repeater time-to-identify and thus time-to-fix.<br>
[0170] At 112, AFLT measurements are taken of the pilot signals from each cellular BTS on the cell search list. It may be noted that, even if the strength of a pilot signal is insufficient to establish communication, the pilot signal may still have enough strength to be detected and to be able to measure the time-of-arrival and other qualities. [0171] In one embodiment, the AFLT measurements include an earliest time-of-arrival (TOA) estimate, an RMSE estimate of the path providing the earliest TOA, and an Ec/Io estimate for all resolvable paths of the pilot signal, which will be used to update the Ec/Io for the pilot signal. The measurements may be stored in a PPM database such as shown in Fig. 6 in which each pilot signal is associated with a plurality of related measurements.<br>
[0172] At 114, a GPS satellite search list may be obtained. This is an optional operation, which advantageously provides a search list that can be used by the GPS system to look for satellites thereby reducing the time necessary to locate sufficient satellites to get a position fix. Alternatively, the GPS system can simply search the entire sky; however such a full sky search typically consumes a much longer time. [0173] At 116, GPS measurements are obtained in accordance with suitable GPS procedures.   In one embodiment, the GPS communication system first looks for the<br><br>
satellites specified in the viewable satellite list over the search windows specified in the list, which can significantly reduce the time required to obtain sufficient GPS signals. [0174] At 117, the MS determines if sufficient GPS measurements have been obtained to determine position location. If sufficient measurements have been obtained, there is no reason to incur further processing in the MS, the processing goes to 119 in the flow diagram to provide appropriate pseudo-range measurements (as well as possibly PPMs from regular AFLT search and the repeater information indicating that the repeater search was not performed) to either the position determination system housed within the MS, or at a PDE located in the network external to the MS, but in cellular communication therewith. The position determination system or PDE processes the GPS measurements and returns the position location of the MS. If sufficient measurements have not been obtained, a repeater AFLT search 118 is run as described with reference to Figs. 9 or 10, and as described with reference to 118 below. [0175] At 118, a repeater AFLT search is performed on pilot signals obtained during the regular AFLT search, as described in more detail with reference to Fig. 9 or Fig. 10. Since the repeater search is performed on pilots already found in regular AFLT search, the searching is performed over small search windows, and the searcher is able to do them simultaneously. Based on current search technology, approximately 1 to 8 pilots can be researched for repeaters in parallel, depending on the target mobile station modem (MSM).<br>
[0176] At 119, pseudo-range measurements (PRM) from the GPS search, pilot phase measurements (PPM) from the regular AFLT search, and repeater information from the repeater (AFLT) search may be provided to the position determination system housed within the MS or at the PDE at a location external to the MS, but in wireless<br><br>
communication therewith. The MS position determination system or PDE processes all these measurements to obtain MS position location.<br>
[0177] It may be noted that in some embodiments where the detection only capability of a repeated signal is provided within the watermark (i.e., no unique repeater ID), then the repeater information gathered by the repeater search will indicate whether or not the signal is successfully repeater-screened (e.g. the repeater search was not even attempted, or the repeaters search has been attempted but failed, or repeater search has been successfully performed), and if so, whether or not the signal is repeated. In these embodiments, the MS position determination system or PDE may then choose to determine the position of the MS by excluding the PPM measurements for repeated signals and for the signals that were not successfully repeater-screened. [0178] It may also be noted that in some embodiments, if the repeater ID is provided within the watermark waveform, the repeater information gathered by the repeater search will also include the repeater ID extracted from the watermark waveform, if any signals are repeated. In these embodiments, the MS position determination system or PDE may then utilize information about the identified repeaters (e.g., their location and internal delays) to calculate the position of the mobile with the PPMs of repeated signals included,<br>
[0179] It may be noted that for call flows that involve calculations of the initial coarse position (i.e., pre-fix) based on the AFLT measurements for the purposes of creating more accurate GPS aiding information (smaller GPS windows), a "repeater" AFLT search should be performed prior to using the regular AFLT search measurements in the pre-fix calculation in order to provide more accurate GPS search windows.<br><br>
Example Implementation of FLRFWM<br>
[0180] In one example embodiment, the FLRFWM is applied to a CDMA system to optimize position location performance. The results of the example implementation, for reasonable target error event probabilities, such as false alarm probability (PFA), probability of missed detection (PMISSDET), and probability of missed identification (PMISSID) of about 10", include identification of a FL frequency watermark for pilots down to about -16.9dB in about 358 microseconds (ms), -19.2dB in about 712 ms, -21.2dB in about 1.423 sec, and -23.1dB in about 2.844 sec.<br>
[0181] In this example implementation, the modulation waveform applied to the forward link signal by the FM modulator is a periodic square wave of magnitude +/-fA and period of 2T, where fA in this example implementation is 50Hz, and T is in [10*64: inc: 11*64] chip range. It should be noted that the increment inc is chosen to achieve uniform spacing of watermarks in frequency for easier detection, and the value is then truncated to nearest chipx8 clock. In this example, the resulting frequencies of the watermark waveform are in the range of about 872.72HZ to 960Hz with a uniform separation of about 2.815Hz; minimal degradation in FL CDMA performance due to the frequency watermark is achieved.<br>
[0182] It may be noted that a limitation is that this example can be done only for limited number (e.g., 32) of repeater IDs, requiring some provisioning algorithm to be implemented elsewhere in the system. FLRFWM-based schemes may therefore be more suitable for carrier deployed sector repeaters, where the carrier could run a provisioning algorithm as part of the repeater deployment, than for personal repeaters where provisioning schemes may be hard to implement or where number of repeaters could grow beyond what forward link fast frequency watermark-based schemes can support.<br><br>
[0183] It may also be noted that, as desired, frequency tracking loops are not tracking out the frequency watermark waveform, because the slowest repeater watermark has maximum T (TMAX) of about l/60th of the time constant of frequency tracking loops. The resulting ac ripple is about +/-3.0Hz at PCS frequency (which is equivalent to about 2.5Hz at GPS frequency), while an average estimated frequency error of 0Hz is achieved; therefore, the watermark does not significantly impact either GPS or AFLT performance.<br>
[0184] The example implementation uses the repeater ID detector described with reference to Fig. 8. It should be noted that two sets of cross-products are done in parallel on NpRE-chip coherent sums that are offset by NPRE/2-chips, rather than reducing NPRE from its maximum possible value, in order to reduce repeater ID detector SNR sampling phase dependency without having to pay a resulting penalty in detector SNR. NPRE is set to the maximum possible value of TMIN/2 (e.g., 5*64 CDMA chips in the example implementation) in order to maximize the processing gain necessary for a target false alarm, detection and identification probabilities over range of pilot Ec/Io strengths of interest. The design limitation on max NPRE is due to the cross-product practical pull-in range of fc /(4TCPD) constraint, where TCPD is the cross product update rate in CDMA chips, as discussed elsewhere herein. A frequency correlator is run on 32 repeater ID frequencies to identify the FL frequency watermark. Coherent accumulation length after complex rotation of 2*1364 is chosen for NPOST such that frequency bin size is small enough to be able to resolve repeater signature separation in frequency (here 2.815Hz). Increasing NPOST beyond this value would increase processing gain somewhat (significantly less than increase in NPRE, as will be discussed below), however possibly increasing the time-to-fix.<br><br>
[0185] Finally, for a sensitivity of Ec/Io = -16.9dB, only one non-coherent accumulation is necessary (i.e., M = 1), for Ec/Io - -19.2dB, M=2, for Ec/Io = -21.2dB, M=4, and for sensitivity of Ec/Io = 23.1dB, M = 8.<br>
[0186] Assuming we are searching over small search windows, since we are researching pilots already found in regular AFLT search, and considering the time to do a cross-product and a frequency correlation on 32 repeater ID frequencies as a background task defined by TFC, the time-to-identify would be approximately (NPRENPOSTM + Tpc) chips per pilot Thus, if we estimate Tpc to be about 2ms, then time-to-detect becomes about 358ms per pilot, for search Si with Ec/Io sensitivity of-16.9dB. [0187] It should be noted that in order to save time-to-identify and processing time (MIPS), a repeater search can be performed only when necessary, that is, whenever AFLT-based pre-fix is desired, and for final-fix only when the GPS search does not return sufficient measurements to determine the position of the mobile station. [0188] It should also be noted that the number of non-coherent sums can be different for pre-fix and final-fix (i.e., initial and final AFLT searches), and can also be dynamically adjusted, if desired, based on the results of the regular AFLT search and desired preferred response quality, as already discussed. A shorter, less sensitive repeater AFLT search could be performed for pre-fix, and either shorter or longer/more sensitive repeater AFLT search could be performed for final fix, as needed, based on the results of the regular AFLT search and the desired preferred response quality. The repeater identification search may follow the method illustrated in Fig. 10. [0189] The choice of the modulation waveform for the watermark and its characteristics are designed to satisfy four contradicting conditions: minimal adverse impact on FL performance, as well as AFLT and GPS performance, maximum detection and identification probability, and minimal time-to-identify.<br><br>
[0190] In order to minimize impact on FL performance, the watermark may be designed to result in the minimal degradation in FL CDMA SNR, that is, an average loss not to exceed 0.2 dB, by minimizing phase deviation through minimizing TMAX and fA. Additionally, minimal adverse impact on GPS and AFLT performance may be achieved by ensuring that frequency tracking loops are not tracking out the frequency watermark waveform, by selecting a small enough value of TMAX for the modulation waveform such that the watermark is not detectable by the FTL, such as described elsewhere herein; that is, no contribution to mean and minimal contribution to variance should be seen in the FTL and maximum increase in peak-to-peak ripple should be no more than about several Hz.<br>
[0191] The choice of the maximum value of T (TMAX) and the amplitude of the frequency (fA) are designed to balance the two contradictory requirements; that is, minimizing degradation on FL CDMA, AFLT and GPS performance, which minimizes fA and TMAX? while maximizing fA and TMAX for best detection and identification probability. For example, to minimize adverse effect of the watermark waveform on FL performance, TMAX was chosen to be 11*64 chips and fA at most +/-50Hz; these maximum allowable values were chosen for these parameters in order to maximize repeater detection and identification probability. This TMAX is about l/60th of the fastest time constant of FLT (where the fastest time constant is defined for tracking a PCS pilot of -3.0dB), such that the worst case resulting variation for the slowest changing watermark waveform with period of 2TMAX at GPS frequency is +/-2.5Hz, and the worst case CDMA code Doppler is about +/-3.0Hz, which results in minimal adverse impact on GPS and AFLT performance.<br>
[0192] It can be shown that the repeater ID search output SNR at the input of the non-coherent stage is approximately equal to<br><br>
where Tc is the CDMA chip period = 1/fc, Ec is the pilot energy over CDMA chip, Qn is noise standard deviation of pilot sample, Qis loss in cross-product output power from ideal in dB, and k is increase in noise variance due to correlation of adjacent cross-product noise samples. Also note that increasing the repeater ID detector output SNR will result in increase of the detection and identification probability. From this expression, it is evident that largest increase in repeater ID detector SNR (and thus detection and identification probabilities) can be achieved by increasing NPRE, followed by increasing f A.<br>
[0193] The upper design limit on the frequency of the watermark waveform (lower limit on TMIN) may be selected by balancing the detection probability and time-to-identify. For minimal time-to-identify, TMIN should be minimized, while for maximum repeater ID detection probability, TMIN should be maximized. Namely, TMIN will determine the detector SNR, through imposing a maximum possible NPRE. To ensure sampling the fastest watermark waveform at Nyquist rate, the maximum NPRE should be set at TMIN- Additionally, the cross-product discriminator's practical pull-in range of fc/(4TcpD), where TCPD is the cross-product update rate and is equal to NPRE CDMA chips, limits the maximum NPRE- Namely, the largest watermark frequency, fMAX= fc /(2TMIN)&gt; should not exceed the edge of cross-product practical pull-in range; as a result, the max value of NPRE is TMIN/2. NPRE, in turn, will have the largest impact on repeater ID detector SNR, as discussed above. In this example implementation, the above considerations are combined and the best overall TMIN is about 10*64 chips. [0194] It will be appreciated by those skilled in the art, in view of these teachings, that alternative embodiments may be implemented without deviating from the spirit or<br><br>
scope of the invention.  This invention is to be limited only by the following claims, which include all such embodiments and modifications when viewed in conjunction with the above specification and accompanying drawings. [0195]     WHAT IS CLAIMED IS:<br><br><br><br><br><br>
CLAIMS<br>
' 1. A repeater for amplifying a forward link signal from a base station to a mobile station, wherein the mobile station has a frequency tracking loop, the repeater comprising:<br>
an amplifier for amplifying the forward link signal from the base station to the mobile station; and<br>
a fast frequency modulator that frequency modulates the forward link signal with an identifying fast frequency watermark as it passes through the repeater, wherein said watermark has a frequency such that the frequency tracking loop substantially does not detect said watermark at said mobile station.<br>
2.	The repeater of claim 1 wherein said watermark comprises a waveform that is non-periodic.<br>
3.	The repeater of claim 2 wherein said non-periodic waveform comprises one of BPSK-, QPSK-, and OQPSK-encoded waveform having a bit duration of 2T, wherein T is substantially less than the time constant of the mobile station frequency tracking loop.<br>
4.	The repeater of claim 3, wherein said non-periodic waveform has an amplitude less than or equal to about 50 Hz.<br>
5.	The repeater of claim 3, wherein T is less than about 1/60 of the time constant of the frequency tracking loop.<br>
6.	The repeater of claim 3 where said non-periodic watermark waveform uniquely identifies the repeater by having a unique sequence of bits.<br><br>
7.	The repeater of claim 1 wherein said watermark is substantially periodic with a period of 2T wherein T is substantially less than the time constant of the mobile station frequency tracking loop.<br>
8.	The repeater of claim 7, wherein T is less than about 1/60 of the time constant of the frequency tracking loop.<br>
9.	The repeater of claim 7, wherein fast frequency watermark amplitude is less than or equal to about 50 Hz.<br>
10.	The repeater of claim 7, wherein said periodic waveform comprises a periodic square waveform.<br>
11.	The repeater of claim 10, wherein said periodic square waveform has an amplitude less than or equal to about 50 Hz.<br>
12.	The repeater of claim 11, wherein said amplitude is about 50 Hz.<br>
13.	The repeater of claim 7, wherein said watermark waveform identifies the repeater by having a unique value of T.<br>
14.	A mobile station for receiving a plurality of forward link pilot signals and identifying the presence of a fast frequency watermark waveform to determine whether any of said forward link signals are repeated, said mobile station comprising:<br>
a receiver for receiving forward link signals;<br>
a frequency tracking loop for enabling accurate demodulation of the forward link signals;<br><br>
an AFLT searcher for detecting pilots and performing pilot phase measurements including measuring the times of arrival of said plurality of forward link pilot signals; and<br>
a repeater identification system configured to detect and identify the watermark, if any, and thereby identify a repeated forward link signal, wherein said repeater identification system searches the forward link signal for the watermark to retrieve the watermark waveform that uniquely identifies the repeater, the watermark waveform having a frequency such that the frequency tracking loop substantially does not detect said watermark.<br>
15.	The mobile station of claim 14, wherein said repeater identification system<br>
comprises:<br>
means for accumulating a series of pilot signal samples;<br>
means for retrieving watermark waveforms from said pilot signal samples, if any, by calculating cross-products of consecutive sums of pilot signal samples; and<br>
means for performing frequency correlation on said watermark waveforms, if any, to determine its frequency that uniquely identifies the repeater.<br>
16.	The mobile station of claim 14 wherein said repeater identification system<br>
comprises means for demodulating a BPSK-modulated watermark waveform.<br>
17.	The mobile station of claim 14 wherein said demodulation means comprises a<br>
-   matched filter-based demodulator.<br><br>
18.	The mobile station of claim 14, further comprising a GPS receiver for receiving GPS signals.<br>
19.	The mobile station of claim 18, wherein said repeater identification system further comprises means for skipping the searching of the forward link signal for the watermark if said GPS receiver produces a sufficient number of measurements to accurately determine position location of the mobile station.<br>
20.	A method for determining position location information of a mobile station from the forward link of a plurality of pilot signals, the method comprising:<br>
performing an AFLT search in the mobile station to detect pilots and measure an earliest time-of-arrival of said plurality of pilot signals;<br>
selecting a first pilot signal located during said AFLT search;<br>
repeater-screening said first pilot signal by performing a repeater AFLT search on said first pilot signal, including searching for a fast frequency watermark waveform that identifies a repeated signal, wherein said watermark waveform has a frequency such that a frequency tracking loop in said mobile station substantially does not detect said watermark at said mobile station;<br>
repeating said steps of performing and repeater-screening for a plurality of other selected pilot signals until a sufficient number of repeater-screened pilot signals to determine a position location of the mobile station is obtained; and<br>
providing pilot phase measurements and repeater information for the pilot signals obtained in said AFLT search to one of a mobile station position determining system and a network position determination entity to determine the position of said mobile station.<br><br>
21.	The method of claim 20, wherein said repeater information identifies whether or not the signal is successfully repeater-screened, and if so, whether or not the signal is repeated, such that said one of a mobile station position determining system and a network position determination entity determines the position of the mobile station by excluding measurements from repeated pilot signals and from the pilot signals that were not successfully repeater-screened.<br>
22.	The method of claim 20 further comprising identifying a repeater ID from said watermark waveform.<br>
i<br>
23.	The method of claim 22, wherein the step of providing repeater information includes providing information on whether the pilot signal is successfully repeater-screened, and if so, whether or not the signal is repeated, and if so, also providing said repeater ID for pilot signals identified as repeated, such that said one of a mobile station position determining system and a network position determination entity may include measurements from repeated pilot signals in position calculation.<br>
24.	The method of claim 22, wherein said repeater AFLT search comprises:<br>
accumulating pilot signals samples from an AFLT searcher;<br>
retrieving the frequency watermark waveform by calculating cross-products of consecutive pilot signal samples sums; and<br>
performing frequency correlation to determine the watermark waveform frequency that corresponds to said repeater ID.<br><br>
25.	The method of claim 22, wherein said repeater AFLT search comprises matched filter-based demodulation to decode said repeater ID from a fast frequency watermark encoded by BPSK.<br>
26.	The method of claim 20, further comprising performing a GPS search prior to the step of performing a repeater AFLT search.<br>
27.	The method of claim 26, wherein if said GPS search produces a sufficient number of measurements to accurately determine position location of the mobile station, then the step of repeater-screening is skipped.<br>
28.	A method for retrieving repeater information from a pilot signal, if any, in a mobile station, the method comprising:<br>
performing a repeater identification search in the mobile station on a first pilot signal, including searching for a fast frequency watermark waveform that identifies a repeated signal on the forward link of said first pilot signal, wherein said watermark waveform has a frequency such that a frequency tracking loop in said mobile station substantially does not detect said watermark at said mobile station; and<br>
providing pilot phase measurements and repeater information for position location determination.<br>
29.	The method of claim 28, wherein said repeater information identifies whether or<br>
not the signal is successfully repeater-screened, and if so, whether or not the signal is<br>
repeated, such that said one of a mobile station position determining system and a<br>
network position determination entity determines the position of the mobile station by<br><br>
excluding measurements from repeated pilot signals and from the pilot signals that were not successfully repeater-screened.<br>
30.	The method of claim 28 further comprising identifying a repeater ID from said watermark waveform.<br>
31.	The method of claim 30, wherein the step of providing repeater information includes providing the information on whether the pilot signal is successfully repeater-screened, and if so, whether or not the signal is repeated, and if so, also providing said repeater ID for pilot signals identified as repeated, such that said one of a mobile station position determining system and a network position determination entity may include measurements from repeated pilot signals in position calculation.<br>
32.	The method of claim 30, wherein said repeater identification search comprises:<br>
accumulating pilot signals samples from a pilot searcher;<br>
retrieving frequency watermark waveform by calculating cross-products of consecutive pilot signal samples sums; and<br>
performing frequency correlation to determine the watermark waveform frequency that corresponds to said repeater ID.<br>
33.	The method of claim 30, wherein said repeater identification search comprises matched filter-based demodulation to decode a fast frequency watermark encoded by BPSK.<br>
34.	The method of claim 28, further comprising performing a GPS search prior to the step of performing a repeater identification search.<br><br>
35. The method of claim 39, wherein if said GPS search produces a sufficient number of measurements to accurately determine position location of the mobile station, then the step of performing a repeater identification search is skipped.<br><br></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAyMi1jaGVucC0yMDA1IGFic3RyYWN0LWR1cGxpY2F0ZS5qcGc=" target="_blank" style="word-wrap:break-word;">2022-chenp-2005 abstract-duplicate.jpg</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAyMi1jaGVucC0yMDA1IGFic3RyYWN0LWR1cGxpY2F0ZS5wZGY=" target="_blank" style="word-wrap:break-word;">2022-chenp-2005 abstract-duplicate.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAyMi1jaGVucC0yMDA1IGNsYWltcy1kdXBsaWNhdGUucGRm" target="_blank" style="word-wrap:break-word;">2022-chenp-2005 claims-duplicate.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAyMi1jaGVucC0yMDA1IGRlc2NyaXB0aW9uIChjb21wbGV0ZSktZHVwbGljYXRlLnBkZg==" target="_blank" style="word-wrap:break-word;">2022-chenp-2005 description (complete)-duplicate.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAyMi1jaGVucC0yMDA1IGRyYXdpbmdzLWR1cGxpY2F0ZS5wZGY=" target="_blank" style="word-wrap:break-word;">2022-chenp-2005 drawings-duplicate.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAyMi1jaGVucC0yMDA1LWFic3RyYWN0LnBkZg==" target="_blank" style="word-wrap:break-word;">2022-chenp-2005-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAyMi1jaGVucC0yMDA1LWNsYWltcy5wZGY=" target="_blank" style="word-wrap:break-word;">2022-chenp-2005-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAyMi1jaGVucC0yMDA1LWNvcnJlc3BvbmRuZWNlLW90aGVycy5wZGY=" target="_blank" style="word-wrap:break-word;">2022-chenp-2005-correspondnece-others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAyMi1jaGVucC0yMDA1LWNvcnJlc3BvbmRuZWNlLXBvLnBkZg==" target="_blank" style="word-wrap:break-word;">2022-chenp-2005-correspondnece-po.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAyMi1jaGVucC0yMDA1LWRlc2NyaXB0aW9uKGNvbXBsZXRlKS5wZGY=" target="_blank" style="word-wrap:break-word;">2022-chenp-2005-description(complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAyMi1jaGVucC0yMDA1LWRyYXdpbmdzLnBkZg==" target="_blank" style="word-wrap:break-word;">2022-chenp-2005-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAyMi1jaGVucC0yMDA1LWZvcm0gMS5wZGY=" target="_blank" style="word-wrap:break-word;">2022-chenp-2005-form 1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAyMi1jaGVucC0yMDA1LWZvcm0gMTgucGRm" target="_blank" style="word-wrap:break-word;">2022-chenp-2005-form 18.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAyMi1jaGVucC0yMDA1LWZvcm0gMy5wZGY=" target="_blank" style="word-wrap:break-word;">2022-chenp-2005-form 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAyMi1jaGVucC0yMDA1LWZvcm0gNS5wZGY=" target="_blank" style="word-wrap:break-word;">2022-chenp-2005-form 5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjAyMi1jaGVucC0yMDA1LXBjdC5wZGY=" target="_blank" style="word-wrap:break-word;">2022-chenp-2005-pct.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="229554-an-apparatus-and-a-method-for-providing-multi-channel-demodulation.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="229556-method-for-paging-in-a-wireless-communication-network.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>229555</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>2022/CHENP/2005</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>13/2009</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>27-Mar-2009</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>18-Feb-2009</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>24-Aug-2005</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>QUALCOMM INCORPORATED</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>5775 Morehouse Drive, San Diego, California 92121,</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>SIMIC, Emilija</td>
											<td>8435 Via Mallorca, La Jolla, California 92037,</td>
										</tr>
										<tr>
											<td>2</td>
											<td>PATRICK, Christopher</td>
											<td>14358 Dalhousie Road, San Diego, California 92129,</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04B7/26</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/US04/05557</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2004-02-23</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>10/392,442</td>
									<td>2003-03-17</td>
								    <td>U.S.A.</td>
								</tr>
								<tr>
									<td>2</td>
									<td>60/449,774</td>
									<td>2003-02-24</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/229555-a-method-and-system-for-forward-link-repeater-frequency-watermarking by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 10:15:30 GMT -->
</html>
