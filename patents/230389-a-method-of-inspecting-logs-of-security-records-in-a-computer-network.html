<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/230389-a-method-of-inspecting-logs-of-security-records-in-a-computer-network by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 11:09:59 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 230389:A METHOD OF INSPECTING LOGS OF SECURITY RECORDS IN A COMPUTER NETWORK</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">A METHOD OF INSPECTING LOGS OF SECURITY RECORDS IN A COMPUTER NETWORK</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>A Computer program products and methods of inspecting a log of security records in a computer network are provided. The method includes retrieving a log record, processing the log record including deriving a key to a table, determining a data value from information in the log record and adding the data value to a list of data values associated with the key if the data value is unique. One or more entries of the table are evaluated based on predetermined criteria to detect attempted security breaches.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td> <br><br>
ATTACK DATABASE STRUCTURE<br>
BACKGROUND<br>
The present invention relates to a method for controlling computer network "ecurity.<br>
Firewalls and intrusion detection systems are devices that are used to protect a computer network from unauthorized or disruptive users.   A firewall can be used to ;ecure a local area network from users outside the local area network. A firewall checks, outes, and frequently labels all messages sent to or from users outside the local area letwork. An intrusion detection system (IDS) can be used to recognize suspicious patterns of behavior in a communication system. Examples of an intrusion detection system include a network intrusion detection system (NIDS) and a host intrusion detection system (HIDS). A NIDS can be used to examine information being communicated within a network to recognize suspicious patterns of behavior. A HIDS can be used to examine information being communicated through a particular host computer within a network to recognize suspicious patterns of behavior. Information obtained by the intrusion detection system (IDS) can be used to block unauthorized or disruptive users from accessing the network.<br>
Either a firewall or an intrusion detection system can create log records that record incoming and outgoing events into or out of a network. Log records can include events such as security violations, bandwidth usage, email usage, and employee access to the Internet. Typically, these log records are reviewed by network security administrators in order to detect attempted security breaches or to find trends in traffic patterns. Since the number of log records is typically quite large, query languages are often used to analyze the log records to detect attempted security intrusions. Query languages can also be used to analyze the log records and generate reports summarizing these log records for the network administrator. These reports can be used by the network administrator to respond to a recognized network security intrusion. Query language instructions operating on log records can also be used to generate alerts for the network administrator. Since the number of log records can be quite large, the network security solutions utilizing query language instructions to analyze the log records can be slow. Query language based solutions can be slow when all the log records are analyzed every time a new query is received.<br><br>
SUMMARY OF THE INVENTION<br>
The present invention provides a method and apparatus, including computer-program products for detecting attempted network security breaches. In one aspect, the invention provides a method of inspecting a log of security records in a computer network and includes retrieving a log record, processing the log record including deriving a key to a table, determining a data value from information in the log record and adding the data value to a list of data values associated with the key if the data value is unique. The method includes evaluating one or more entries of the table based on predetermined criteria to detect attempted security breaches.<br>
Aspects of the invention can include one or more of the following features. The table can be a hash table. The list of data values can be implemented as a linked list. The list of data values can be implemented as a hash table. The list of data values can be implemented as a tree. Evaluating one or more entries of the table can include evaluating all of the entries of the table.<br>
In another aspect, the invention provides a method of inspecting a log of security records in a computer network and includes retrieving a log record, hashing one or more of the fields of the log record to generate a hash key, and evaluating a hash table using the hash key. If there is no matching hash table entry, the method includes adding a new entry to the hash table. If there is a matching hash table entry, the method includes retrieving a data list associated_with.the hash table entry and using one or more fields of the log record to compute a data value to be inserted into the data list, evaluating the data list to determine the uniqueness of the data value and inserting the data value in the data list if the data value is unique.<br>
In another aspect, the invention provides a method of detecting a port scan and includes retrieving a log record including a source address and a destination address, hashing the source address and the destination address to generate a hash key and evaluating a hash table using the hash key. If there is a matching hash table entry, the method includes retrieving a data list to determine if there are any matching entries, inserting the destination port with the entries in the data list if there are no matching entries and determining a port scan if the number of items in the data list exceeds a predetermined number.<br>
In another aspect, the invention includes the computer program products for causing a computer to execute instructions to cause data processing apparatus to retrieve a log record, process a log record including deriving a key to a table, determine a data value<br><br>
from information in the log record and add the data value to a list of data values associated with the key if the data value is unique. One or more entries of the table are evaluated based on predetermined criteria to detect attempted security breaches.<br>
Aspects of the invention may include one or more of the following advantages. The table may be a hash table. The list of data values may be implemented as a linked list. The list of data values may be implemented as a hash table. The list of data values may be implemented as a tree. Instructions to evaluate one or more entries of the table may include instructions to evaluate all the entries of the table.<br>
In another aspect, the invention includes the computer program products for causing a computer to execute instructions to cause data processing apparatus to retrieve a log record, hash one or more fields of the log record to generate a hash key, and evaluate a hash table using the hash key. If there is no matching hash table entry, the invention may allow the addition of a new entry to the hash table. If there is a matching hash table entry, the invention may allow retrieval of a data list associated with the hash table entry, use of one or more fields of the log record to compute a data value, comparison of the data value with entries in the data list to determine if there are any matching entries, inserting the data value into the data list if there are no matching entries, and evaluating the data list based on predetermined criteria to detect attempted security breaches.<br>
Aspects of the invention may include one or more of the following advantages. The invention may include instructions for adding a new entry to the hash table causing the data processing apparatus to generate an empty data list associated with the new entry to the hash table, instructions for inserting a new entry in the data list cause the data processing apparatus to trigger the evaluation of the data list, instructions for issuing a check table operation causing the data processing apparatus to trigger the evaluation of the data list, instructions for evaluating the data list based on predetermined criteria causing the data processing apparatus to block a packet associated with the log record, instructions for evaluating the data list based on predetermined criteria causing the data processing apparatus to block all future packets from a same source as a packet associated with a given log record and instructions for evaluating the data list based on predetermined criteria causing the data processing apparatus to report an attempted security breach.<br>
The data list may be a linked list. The data list may be a hash table. The data list may be a tree. The invention may include instructions for evaluating the data list causing the data processing apparatus to evaluate the data list after a plurality of log records have<br><br>
been added to the data list. The invention may include instructions for evaluating the data list causing the data processing apparatus to evaluate the data list after each log record is added to the data list. The invention may include instructions for evaluating the hash table using the hash key causing the data processing apparatus to process a second hash table. The invention may include instructions for processing a second hash table causing the data processing apparatus to use the matching hash table entry to retrieve a second hash table, and using the hash key to evaluate the second hash table. If there is no matching second hash table entry, the invention may allow the addition of a new entry to the second hash table. If there is a matching second hash table entry, the invention may allow retrieval of a second data list associated with the second hash table entry, comparing the data value with entries in the second data list to determine if there are any matching entries, inserting the data value in the second data list if there are no matching entries and evaluating the second data list based on predetermined criteria to detect attempted security breaches.<br>
In another aspect, the invention, embodied in an information carrier for inspecting a log of security records in a computer network includes a computer program product for causing the computer to execute instructions to cause the data processing apparatus to retrieve a log record, hash one or more fields of the log record to generate a hash key and evaluate a hash table using the hash key. If there is no matching hash table entry, the .invention- allows adding a new entry to the hashtable; If there is a matching hash-table entry, the invention allows retrieving a data list associated with the hash table entry, using one or more fields of the log record to compute a data value to be inserted into the data list, evaluating the data list to determine the uniqueness of the data value and inserting the data value in the data list if the data value is unique.<br>
In another aspect, the invention, embodied in an information carrier for detecting a port scan, includes a computer program product for causing a computer to execute instructions to cause the data processing apparatus to retrieve a log record including a source address and a destination address, hash the source address and the destination address to generate a hash key, and evaluate a hash table using the hash key. If there is a matching hash table entry, the invention allows retrieving a data list associated with the hash table entry, comparing the destination port with the entries in the data list to determine if there are any matching entries, inserting the destination port into the data list if there are no matching entries and determining a port scan if the number of items in the data list exceeds a predetermined number.<br><br>
Advantages of the invention may include one or more of the following features. Each log record needs to be processed only once when it is first received. The analysis of log records can be fast because a hash table is used to store and retrieve the log records. Storing the processed log records instead of the log record itself can require less memory capacity.<br>
BRIEF DESCRIPTION OF THE DRAWINGS<br>
FIG. 1A shows a network topology including a NIDS operating in inline mode.<br>
FIG. IB shows a network topology including a NIDS operating in non-inline mode.<br>
FIG. 2 is a flowchart describing the operation of a record processing unit.<br>
FIG. 3 is a flowchart for building a table in static mode.<br>
FIG. 4 is a flowchart for building a table in dynamic mode.<br>
FIG. 5 describes a table data structure.<br>
FIG. 6 is a flowchart for creating a table data structure.<br>
FIG. 7 is a flowchart for evaluating the table data structure.<br>
FIG. 8 illustrates the use of multiple hash tables.<br>
FIG. 9 illustrates the use of cascaded hash tables.<br>
FIG. 10 shows a method for detecting a port scan attack.<br>
Like reference numbers and designations in the various drawings indicate like elements.<br>
DETAILED DESCRIPTION FIG. 1A shows a network topology including a local area network (LAN) 100, including a server 102, several workstations (W/S) 104, a firewall 106, and NIDS 108. The NIDS 108 operates in inline mode and analyzes information as it is being communicated in the network . The LAN 100 is connected to an external network, e.g., the Internet 114, through the firewall 106. The LAN 100 is also connected to a second LAN 116 through a router 118, and satellite 120. Second LAN 116 includes a web server 110, an email server 112, a server 102, several workstations 104, a firewall 106 and NIDS 108. The computers, servers and other devices in the LAN are interconnected using a number of data transmission media such as wire, fiber optics, and radio waves. Each LAN uses intrusion detection systems to analyze messages being communicated within the network and recognize suspicious patterns of behavior. Each LAN 100 and<br><br>
116 includes a record processing unit 122 connected to firewall 106 and NIDS 108. The record processing unit (RPU) 122 receives log records from one of firewall 106 and NIDS 108 and analyzes the log records to detect attempted network security intrusions. Alternatively, the NIDS can be configured outside the transmission path, in a passive (non-inline) mode. In the non-inline mode, the NIDS device monitors and inspects traffic received by the network, but only reports (i.e., does'not drop packets) that are determined to match specified attack signatures. FIG. IB shows a network topology including NIDS 124 operating in non-inline mode. The NIDS 124 receives information being communicated in the network, determines attacks and can report or otherwise passively act to block future communications from unauthorized or disruptive users.<br>
FIG. 2 is a block diagram of the RPU 122. The RPU 122 includes an interface 202 for communicating (e.g. to firewalls, and intrusion detection systems) with one or more security devices on the network.   Interface 202 is used to receive security logs. The RPU 122 uses a processing engine 204 to process security logs received from the security devices on the network. The processed log records are stored in a database 208. An evaluation engine 206 uses the processed log records stored in the database 208 to detect attempted network security breaches. Any attempted network security breaches detected by RPU 122 can be communicated to a respective security device using interface 202.<br>
RPU 122 can be operated in at least two different modes. In the first mode, a plurality of log records are received andprocessed.- The first-mode is referred to-as the off-line mode. In the second mode, the RPU receives and processes individual log records as they are generated. The second mode is referred to as the on-line mode.<br>
FIG. 3 is a flow diagram describing the off-line mode of operation. In the off-line mode, a log of records is communicated to the RPU 122. The log can be produced by security devices on the network based on incoming or outgoing communications. The RPU 122 receives the log records (step 300) and retrieves individual records (step 302) for processing. The log record is used to build and update a table data structure (step 304). If there are additional log records that need to be processed (step 306) control passes to step 302 at which time the process repeats and the next log record is processed. In one implementation, the table data structure is evaluated (step 308) after all the log entries have been processed and RPU 122 responds if any attempted security intrusion is detected (step 310).   In response to an attempted security intrusion, the RPU 122 can communicate the attempted security intrusion to the security device (e.g. firewall, IDS) or other devices on the network. In one implementation, RPU 122 can block all future<br><br>
packets from the source responsible for the attempted intrusion (e.g., by communicating a rule to the firewall to block all packets from the responsible source). RPU 122 can also report the attempted security intrusion to the administrator for an appropriate response.<br>
FIG. 4 is a flow diagram describing the on-line mode of operation. In the on-line mode, individual log records are received by RPU 122 for processing (step 400). In the on-line mode, RPU 122 processes individual log records as they are received. The processed log records are used to update the table data structure (402) and the resulting table data structure is evaluated (404) after each log record is processed. Thereafter, RPU 122 responds to any attempted intrusion (406) before RPU 122 starts processing the next log record.<br>
FIG. 5 describes one example of a table data structure used by RPU 122. Referring now to Figs. 2 and 5, a hash key 512 generated by the processing engine 204 from the fields of the log record, is used to generate an address for an entry in the hash table 500 using a table address generator 508.   The address generated by the table address generator 508 is used to look up the selected entry in hash table 500. Each hash table entry can either be a data value 502, a list of data values 504, a pointer to a data value or a data list 506. Entries that consist of a data value or a set of data values (502 or 506) can be stored directly in the hash table 500 in database 208. For data lists, the hash table entry can be a pointer to the data list 506 in database 208. The data list 510 contains a list of data values and can be implemented using a linked list or any other suitable data structure.<br>
The data entries in hash table 500 and the data list 510 can be tagged to expire after a predetermined duration of time. A timer 509 can be used by the processing engine to measure a specific duration time for a given data entry stored in the hash table or data list. The data entry can be deleted when the time duration has expired. One simple timer implementation includes the tagging of each entry with a time stamp. At evaluation time, the current time can be compared to the stamped time. Entries that are too old can be removed prior to the evaluation step.<br>
FIG. 6 is a flow diagram depicting the creation of the table data structure. RPU 122 (FIG. la) receives one or more logs (step 600) from one or more security devices on the network. Individual log records are retrieved (step 602) and the fields of the log record are used to generate a hash key (step 604). The generated hash key is used to evaluate a hash table (step 606). If a matching entry is found in the hash table (step 608) a data list associated with the selected hash table entry (step 610) is retrieved. A data<br><br>
value generated using one or more fields of the log record (step 624), is compared with the data values in the data list (step 612). Only unique data values are inserted into the data list.   If a matching entry is found in the data list (step 614), the data value derived from the log record is not inserted into the data list (step 616). If no matching entry is found in the data list, the data value is inserted into the data list (step 618) and control passes to step 602 at which time the process repeats and the next log record is processed. If no matching entry is found in the hash table during step 608, a new hash table entry and a new data list are created (step 620). The new data list is associated (step 622) with the hash table entry indicated by the generated hash key and the data value generated using the fields of the log record (step 624) is inserted into the data list (step 618). Following the completion of step 618 control passes to step 602 at which time the process repeats for each log record received.<br>
FIG. 7 is a flow diagram describing a process of evaluating a hash table to detect attempted security breaches. The table data structure can be evaluated whenever a new entry is added to a hash table or to a data list that is part of the table data structure. In addition, a "Check Table" operation, initiated by a user, can also trigger an evaluation of the table data structure. In one implementation, the table data structure is evaluated by retrieving each hash table entry (step 700). If the entry is a pointer to a data list (step 702) the data list is retrieved (step 704). If the table entry contains a data value or a set of data values these values are retrieved (step 706). The data values retrieved in step 704 or step 706 are compared against predetermined criteria to determine if there has been an attempted security breach (step 708). If an attempted intrusion is detected, RPU 122 can take one of a plurality of actions based on the nature of the attempted breach (step 710). RPU 122 can communicate with the NIDS or firewall to drop the current packet associated with the log record. RPU 122 can also block all future packets originating from the same source in response to an attempted security breach. In addition, RPU 122 can report any attempted security breach to the administrator for appropriate response. This process is repeated for all the entries in the hash table.<br>
In an alternative implementation of the hash table evaluation process, only table entries that have been modified after the previous table evaluation are considered during the evaluation process. This can be accomplished by including tag fields in the hash table entry to indicate any entries that are modified as a result of inserting a new data value in the table data structure. The tag field is used to locate modified data values during the table evaluation process. The tag fields can be reset after the modified data has been used<br><br>
to evaluate the table. In another implementation of the hash table evaluation process, the hash table is evaluated immediately after inserting a new data value in the table data structure (i.e., right after step 618 above in FIG. 6).<br>
RPU 122 can employ more than one hash table. FIG. 8 illustrates an example using more than one hash table to detect an attempted security intrusion. In the example, a log record is obtained by RPU 122 during either the on-line or off-line mode of operation (step 800). An evaluation strategy is determined using the log record, a hash key generated from the log record, or a combination of the log record and a hash key derived from the log record (step 805). The evaluation strategy can be used to identify the number of tests and the type of tests that should be performed for the given record. The evaluation strategy can be based on a number of criteria including, known attack signatures and prior log records originating from the same source. A number of hash keys are generated, based on the evaluation strategy, for the different type of tests that must be performed (step 815). The generated hash keys are used to update the hash tables associated with the tests to be performed (step 820). The hash tables associated with the tests are evaluated to determine if there has been an attempted security intrusion (step 825). In this example, all the hash keys and all the hash tables may not be distinct. It is possible to use the same hash key to update and evaluate two different hash tables. It is also possible to use two different hash keys to evaluate the same hash table as part of two different tests.^-- - ^ .; ■   ..-.-. ,„-;,j.   ,.,,.,,— .^;v* .. -;^, ..   ■*.■■ .  ^v. .:.,-•-.■: ^.;^.-..-,.. ...&gt;-<br>
FIG. 9 illustrates an example using cascaded hash tables to detect an attempted security intrusion. In this example, as part of the table evaluation process, a first hash table entry is retrieved from a first hash table. The first hash table entry is checked by comparing the first hash table entry against a predetermined criteria (step 900). The evaluation process for detecting a particular security intrusion may require the evaluation of a second hash table. A second hash key for the second hash table can be generated using the first hash key, the first hash table entry selected by the first hash key, or a combination of the first hash key and the first hash table entry selected by the first hash key (step 905). The second hash table is updated using the second hash key (step 910) and the second hash table is evaluated to determine if there has been an attempted security intrusion (step 915). The evaluation of the individual hash tables is as described above with respect to FIG. 6.<br>
FIG. 10 shows an exemplary method for detecting a port scanning attack. Port scanning, a frequently used approach for attacking computer security, gives a hacker an<br><br>
idea where to look for weaknesses. A port scan comprises a series of messages sent by the hacker attempting to probe a computer to learn which computer network services, each associated with a "well-known" port number, the computer provides. Essentially, the port scan consists of sending a message to each port, e.g., one at a time. The kind of response received indicates whether the port is used and accessible and can therefore be probed for weaknesses. In the present example, a log of records that include port queries is evaluated. The log can be generated by a router, firewall or other security device. RPU 122 extracts the source and destination IP addresses from the log records received (step 1000). The source and destination IP addresses as reported by the log record are used to generate a hash key (step 1005). The generated hash key is used by a table address generator 1010 to evaluate a first hash table 1015. RPU 122 adds any unique port numbers accessed by the application to the data list 1025 indicated by the hash table entry 1020 selected by the generated hash key. During a typical port scan attack, the data list 1025 accumulates a large number of entries as the hacker attempts to access a large number of ports within a short time interval. Each port number added to the data list 1025 can be tagged to expire after a predetermined duration of time, for example, using the timer 509 (FIG. 5). Once the data list 1025 accumulates a predetermined number of entries, a port scan is detected.   The source and destination IP addresses included in the hash key can be used to determine the source of the scan and the computer that is being scanned;-^ -■*..:■ .:.■:--~ ~       -^ -.~ ^~\ -■-^^   ■ --■■        ..-.-^...-..^^j:. ..^ =-■:-*£&amp;, ,—w,.. .,^ In another example, the techniques disclosed can be used to detect a mail server attack. A typical mail server attack can proceed in three phases. During the first phase of the attack, a hacker can attempt to connect to a mail server running on a well-known port number (e.g., most SMTP mail servers run on port 25) A first entry can be stored in the database (e.g., hash table) associated with this first phase of the attack. More particularly, a hash key derived from the source address associated with the potential hacker can be used to point to a record in the hash table. At the time of the first attack, the record can be populated with a first entry indicating that a potential hacker from the identified source address has contacted the mail server. During the second phase of the attack, a NIDS or a HIDS detects a exploitation attempt, e.g., a buffer overflow. The exploitation attempt is associated with a particular source, and accordingly, a check can be made in the hash table for a record associated with the source. More specifically, the source address is used to generate a key, which then is used to scan the hash table for a matching entry. If matching record is located in the database, then a second element can be added to the<br><br>
located record to indicate that the source attempted a detected exploitation of the system. During the third phase of the attack, the mail server can initiate a connection to the network, as the hacker controls the mail server and successfully uses the mail server to send the hacker protected information (e.g., a password file). If an attempt to gain control of the mail server is detected, once again, the hash table can be updated. More specifically, a key is derived from the address of the hacker that has been detected as attempting to take over the mail server. The key is used to locate the appropriate record in the hash table associated with the hacker. The third phase can result in the population of a third element in the record associated with the hacker, indicative of the attempted take over of the mail server. At a time for evaluation, the sequence of attack events (port scan, exploitation, and mail server take over) can be recognized as a mail server attack and an appropriate response generated.<br>
The invention can be implemented in digital electronic circuitry, or in computer hardware, firmware, software, or in combinations of them. The invention can be implemented as a computer program product, i.e., a computer program tangibly embodied in an information carrier, e.g., in a machine-readable storage device or in a propagated signal, for execution by, or to control the operation of, data processing apparatus, e.g., a programmable processor, a computer, or multiple computers. A computer program can be written in any form of programming language, including compiled or interpreted _•: languages, and it can be deployed in any form, including as a stand-alone program or as a module, component, subroutine, or other unit suitable for use in a computing environment. A computer program can be deployed to be executed on one computer or on multiple computers at one site or distributed across multiple sites and interconnected by a communication network.<br>
Method steps of the invention can be performed by one or more programmable processors executing a computer program to perform functions of the invention by operating on input data and generating output. Method steps can also be performed by, and apparatus of the invention can be implemented as, special purpose logic circuitry, e.g., an FPGA (field programmable gate array) or an ASIC (application-specific integrated circuit).<br>
Processors suitable for the execution of a computer program include, by way of example, both general and special purpose microprocessors, and any one or more processors of any kind of digital computer. Generally, a processor will receive instructions and data from a read-only memory or a random access memory or both. The<br><br>
essentia] elements of a computer are a processor for executing instructions and one or more memory devices for storing instructions and data. Generally, a computer will also include, or be operatively coupled to receive data from or transfer data to, or both, one or more mass storage devices for storing data, e.g., magnetic, magneto-optical disks, or optical disks. Information carriers suitable for embodying computer program instructions and data include all forms of non-volatile memory, including by way of example semiconductor memory devices, e.g., EPROM, EEPROM, and flash memory devices; magnetic disks, e.g., internal hard disks or removable disks; magneto-optical disks; and CD-ROM and DVD-ROM disks. The processor and the memory can be supplemented by, or incorporated in special purpose logic circuitry.<br>
The invention can be implemented in a computing system that includes a back-end component, e.g., as a data server, or that includes a middleware component, e.g., an application server, or that includes a front-end component, e.g., a client computer having a graphical user interface or a Web browser through which a user can interact with an implementation of the invention, or any combination of such back-end, middleware, or front-end components. The components of the system can be interconnected by any form or medium of digital data communication, e.g., a communication network. Examples of communication networks include a local area network ("LAN") and a wide area network ("WAN"), e.g., the Internet.<br>
jt'—-;— The computing system can include clients and servers. A client and server are generally remote from each other and typically interact through a communication network. The relationship of client and server arises by virtue of computer programs running on the respective computers and having a client-server relationship to each other.<br>
This invention has been described in terms of particular embodiments. Nevertheless, it will be understood that various modifications may be made without departing from the spirit and scope of the invention.   For instance, the steps of the invention can be performed in a different order and still achieve desirable results. Instead of using hash tables, other equivalent data structures can be used. The hash tables can be stored using an SQL database. Accordingly, other embodiments are within the scope of the following claims.<br>
What is claimed is:<br><br><br><br><br>
CLAIMS<br>
1.	A method of inspecting a log of security records in a computer network,<br>
comprising the steps of:<br>
retrieving a log record;<br>
processing the log record including deriving a key to a table;<br>
determining a data value from information in the log record and adding the data value to a list of data values associated with the key if the data value is unique; and<br>
evaluating one or more entries of the table based on predetermined criteria to detect attempted security breaches.<br>
2.	The method of claim 1, wherein the table is a hash table.<br>
3.	The method of claim 1, wherein the list of data values is implemented as a linked list.<br>
4.	The method of claim 1, wherein the list of data values is implemented as a hash table.<br>
5.	The method of claim 1, wherein the list of data values is implemented as a tree.<br>
6.	The method of claim 1, wherein evaluating one or more entries of the table includes evaluating all the entries of the table.<br>
7.	A method of inspecting a log of security records in a computer network, comprising the steps of:<br>
retrieving a log record;<br>
hashing one or more fields of the log record to generate a hash key;<br>
evaluating a hash table using the hash key;<br>
if there is no matching hash table entry, adding a new entry to the hash table;<br>
if there is a matching hash table entry, retrieving a data list associated with the hash table entry;<br><br>
using one or more fields of the log record to compute a data value;<br>
comparing the data value with entries in the data list to determine if there are any matching entries;<br>
inserting the data value into the data list if there are no matching entries; and<br>
evaluating the data list based on predetermined criteria to detect attempted security breaches.<br>
8.	The method of claim 7, wherein adding a new entry to the hash table<br>
includes generating an empty data list associated with the new entry to the hash table.<br>
9	The method of claim 7, wherein inserting a new entry in the data list<br>
includes triggering an evaluation of the data list.<br>
10.	The method of claim 7, including receiving a check table operation to<br>
trigger the evaluation of the data list.<br>
11.	The method of claim 7, wherein evaluating the data list based on predetermined criteria includes blocking a packet associated with the log record.<br>
12.	The method of claim 7, wherein evaluating the data list based on predetermined criteria includes blocking all future packets from a same source as a packet associated with a given log record.<br>
13.	The method of claim 7, wherein evaluating the data list based on predetermined criteria includes reporting an attempted security breach.<br><br>
14.	The method of claim 7, wherein the data list is a linked list.<br>
15.	The method of claim 7, wherein the data list is a hash table.<br>
16.	The method of claim 7, wherein the data list is a tree.<br><br>
17.	The method of claim 7, including evaluating the data list after a plurality of log records have been added to the data list.<br>
18.	The method of claim 7, including evaluating the data list after each log record is added to the data list.<br>
19.	The method of claim 7, wherein evaluating the hash table using the hash key includes processing a second hash table.<br>
20.	The method of claim 19, wherein processing a second hash table includes:<br>
using the matching hash table entry to retrieve a second hash table;<br>
using the hash key to evaluate the second hash table;<br>
if there is no matching second hash table entry, adding a new entry to the second hash table;<br>
if there is a matching second hash table entry, retrieving a second data list associated with the second hash table entry;<br>
comparing the data value with entries in the second data list to determine if there are any matching entries;<br>
inserting the data value in the second data list if there are no matching entries; and<br>
evaluating the second data list based on predetermined criteria to detect attempted security breaches.<br>
21.	A method of inspecting a log of security records in a computer network,<br>
comprising the steps of:<br>
retrieving a log record;<br>
hashing one or more fields of the log record to generate a hash key;<br>
evaluating a hash table using the hash key;<br>
if there is no matching hash table entry, adding a new entry to the hash table;<br>
if there is a matching hash table entry, retrieving a data list associated with the hash table entry;<br><br>
using one or more fields of the log record to compute a data value to be inserted into the data list;<br>
evaluating the data list to determine the uniqueness of the data value; and inserting the data value in the data list if the data value is unique.<br>
22.	A method of detecting a port scan comprising:<br>
retrieving a log record including a source address and a destination address;<br>
hashing the source address and the destination address to generate a hash key;<br>
evaluating a hash table using the hash key;<br>
if there is a matching hash table entry, retrieving a data list associated with the hash table entry;<br>
comparing the destination port with the entries in the data list to determine if there are any matching entries;<br>
inserting the destination port into the data list if there are no matching entries; and<br>
determining a port scan if the number of items in the data list exceeds a predetermined number.<br>
23.	A computer program product, tangibly embodied in an information carrier,<br>
the computer program product comprising instructions operable to cause data processing<br>
apparatus to:<br>
retrieve a log record;<br>
process a log record including deriving a key to a table;<br>
determine a data value from information in the log record and adding the data value to a list of data values associated with the key if the data value is unique; and<br>
evaluate one or more entries of the table based on predetermined criteria to detect attempted security breaches.<br>
24.	The computer program product of claim 23, wherein the table is a hash<br>
table.<br><br>
25.	The computer program product of claim 23, wherein the list of data values is implemented as a linked list<br>
26.	The computer program product of claim 23, wherein the list of data values is implemented as a hash table.<br>
27.	The computer program product of claim 23, wherein the list of data values is implemented as a tree.<br>
28.	The computer program product of claim 23, wherein instructions to evaluate one or more entries of the table include instructions to evaluate all the entries of the table.<br>
29.	A computer program product, tangibly embodied in an information carrier, the computer program product comprising instructions operable to cause data processing apparatus to:<br>
retrieve a log record;<br>
hash one or more fields of the log record to generate a hash key;<br>
evaluate a hash table using the hash key;<br>
if there is no matching hash table entry, add a new entry to the hash table;<br>
if there is a matching hash table entry, retrieve a data list associated with the hash table entry;<br>
use one or more fields of the log record to compute a data value;<br>
compare the data value with entries in the data list to determine if there are any matching entries;<br>
insert the data value into the data list if there are no matching entries; and<br>
evaluate the data list based on predetermined criteria to detect attempted security breaches.<br>
30.	The computer program product of claim 29, wherein instructions for<br>
adding a new entry to the hash table cause the data processing apparatus to generate an<br>
empty data list associated with the new entry to the hash table.<br><br>
31.	The computer program product of claim 29, wherein instructions for inserting a new entry in the data list cause the data processing apparatus to trigger the evaluation of the data list<br>
32.	The computer program product of claim 29, wherein instructions for issuing a check table operation cause the data processing apparatus to trigger the evaluation of the data list.<br>
33.	The computer program product of claim 29, wherein instructions for evaluating the data list based on predetermined criteria cause the data processing apparatus to block a packet associated with the log record.<br>
34.	The computer program product of claim 29, wherein instructions for evaluating the data list based on predetermined criteria cause the data processing apparatus to block all future packets from a same source as a packet associated with a given log record.<br>
35.	The computer program product of claim 29, wherein instructions for evaluating the data list based on predetermined criteria cause the data processing apparatus to report an attempted security breach.<br>
36.	The computer program product of claim 29, wherein the data list is a linked list.<br>
37.	The computer program product of claim 29, wherein the data list is a hash table.<br>
38.	The computer program product of claim 29, wherein the data list is a tree<br>
39.	The computer program product of claim 29, wherein instructions for evaluating the data list cause the data processing apparatus to evaluate the data list after a plurality of log records have been added to the data list.<br><br>
40.	The computer program product of claim 29, wherein instructions for evaluating the data list cause the data processing apparatus to evaluate the data list after each log record is added to the data list<br>
41.	The computer program product of claim 29, wherein instructions for evaluating the hash table using the hash key cause the data processing apparatus to process a second hash table.<br>
42.	The computer program product of claim 41, wherein instructions for processing a second hash table cause the data processing apparatus to:<br>
use the matching hash table entry to retrieve a second hash table;<br>
use the hash key to evaluate the second hash table;<br>
if there is no matching second hash table entry, add a new entry to the second hash table;<br>
if there is a matching second hash table entry, retrieve a second data list associated with the second hash table entry;<br>
compare the data value with entries in the second data list to determine if there are any matching entries;<br>
insert the data value in the second data list if there are no matching entries; and<br>
evaluate the second data list based on predetermined criteria to detect attempted security breaches.<br>
43.	A computer program product, tangibly embodied in an information carrier,<br>
for inspecting a log of security records in a computer network, the computer program<br>
product comprising instructions operable to cause data processing apparatus to:<br>
retrieve a log record;<br>
hash one or more fields of the log record to generate a hash key; evaluate a hash table using the hash key;<br>
if there is no matching hash table entry, add a new entry to the hash table; if there is a matching hash table entry, retrieve a data list associated with the hash table entry;<br><br>
use one or more fields of the log record to compute a data value to be inserted into the data list;<br>
evaluate the data list to determine the uniqueness of the data value; and insert the data value in the data list if the data value is unique.<br>
44. A computer program product, tangibly embodied in an information carrier, for detecting a port scan, the computer program product comprising instructions operable to cause data processing apparatus to:<br>
retrieve a log record including a source address and a destination address;<br>
hash the source address and the destination address to generate a hash key;<br>
evaluate a hash table using the hash key;<br>
if there is a matching hash table entry, retrieve a data list associated with the hash table entry;<br>
compare the destination port with the entries in the data list to determine if there are any matching entries;<br>
insert the destination port into the data list if there are no matching entries; and<br>
determine a port scan if the number of items in the data list exceeds a predetermined number.<br><br><br></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjg2Mi1jaGVucC0yMDA1IGFic3RyYWN0LWR1cGxpY2F0ZS5wZGY=" target="_blank" style="word-wrap:break-word;">2862-chenp-2005 abstract-duplicate.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjg2Mi1jaGVucC0yMDA1IGNsYWltcy1kdXBsaWNhdGUucGRm" target="_blank" style="word-wrap:break-word;">2862-chenp-2005 claims-duplicate.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjg2Mi1jaGVucC0yMDA1IGRlc2NyaXB0aW9uKGNvbXBsZXRlKS1kdXBsaWNhdGUucGRm" target="_blank" style="word-wrap:break-word;">2862-chenp-2005 description(complete)-duplicate.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjg2Mi1jaGVucC0yMDA1LWFic3RyYWN0LnBkZg==" target="_blank" style="word-wrap:break-word;">2862-chenp-2005-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjg2Mi1jaGVucC0yMDA1LWFzc2lnbmVtZW50LnBkZg==" target="_blank" style="word-wrap:break-word;">2862-chenp-2005-assignement.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjg2Mi1jaGVucC0yMDA1LWNsYWltcy5wZGY=" target="_blank" style="word-wrap:break-word;">2862-chenp-2005-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjg2Mi1jaGVucC0yMDA1LWNvcnJlc3BvbmRuZWNlLW90aGVycy5wZGY=" target="_blank" style="word-wrap:break-word;">2862-chenp-2005-correspondnece-others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjg2Mi1jaGVucC0yMDA1LWNvcnJlc3BvbmRuZWNlLXBvLnBkZg==" target="_blank" style="word-wrap:break-word;">2862-chenp-2005-correspondnece-po.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjg2Mi1jaGVucC0yMDA1LWRlc2NyaXB0aW9uKGNvbXBsZXRlKS5wZGY=" target="_blank" style="word-wrap:break-word;">2862-chenp-2005-description(complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjg2Mi1jaGVucC0yMDA1LWRyYXdpbmdzLnBkZg==" target="_blank" style="word-wrap:break-word;">2862-chenp-2005-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjg2Mi1jaGVucC0yMDA1LWZvcm0gMS5wZGY=" target="_blank" style="word-wrap:break-word;">2862-chenp-2005-form 1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjg2Mi1jaGVucC0yMDA1LWZvcm0gMy5wZGY=" target="_blank" style="word-wrap:break-word;">2862-chenp-2005-form 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjg2Mi1jaGVucC0yMDA1LWZvcm0gNS5wZGY=" target="_blank" style="word-wrap:break-word;">2862-chenp-2005-form 5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjg2Mi1jaGVucC0yMDA1LW90aGVycy5wZGY=" target="_blank" style="word-wrap:break-word;">2862-chenp-2005-others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjg2Mi1jaGVucC0yMDA1LXBjdC5wZGY=" target="_blank" style="word-wrap:break-word;">2862-chenp-2005-pct.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="230388-a-ring-mechanism-for-retaining-loose-leaf-pages.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="230390-a-computer-system-for-the-manipulation-of-images.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>230389</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>2862/CHENP/2005</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>13/2009</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>27-Mar-2009</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>26-Feb-2009</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>03-Nov-2005</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>JUNIPER NETWORKS, INC.</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>1194 NORTH MATHILDA AVENUE, SUNNYVALE, CALIFORNIA 94089-1206,</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>ZUK, NIR</td>
											<td>334 POE STREET, PALO ALTO, CALIFORNIA 94301,</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04L29/06</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/US04/10389</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2004-04-02</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>10/407,823</td>
									<td>2003-04-04</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/230389-a-method-of-inspecting-logs-of-security-records-in-a-computer-network by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 11:10:00 GMT -->
</html>
