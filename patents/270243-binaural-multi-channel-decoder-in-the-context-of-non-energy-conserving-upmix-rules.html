<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/270243-binaural-multi-channel-decoder-in-the-context-of-non-energy-conserving-upmix-rules by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 05:06:02 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 270243:BINAURAL MULTI-CHANNEL DECODER IN THE CONTEXT OF NON-ENERGY-CONSERVING UPMIX RULES</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">BINAURAL MULTI-CHANNEL DECODER IN THE CONTEXT OF NON-ENERGY-CONSERVING UPMIX RULES</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>A multi-channel decoder for generating a binaural signal from a downmix signal using upmix rule information on an energy-error introducing upmix rule for calculating a gain factor (180) based on the upmix rule information and characteristics of head related transfer function based filters corresponding to upmix channels. The one or more gain factors are used by a filter processor (182) for filtering the downmix signal so that an energy corrected binaural signal having a left binaural channel and a right binaural channel is obtained.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>Field of the Invention<br>
The present invention relates to binaural decoding of<br>
multi-channel audio signals based on available .downmixed<br>
signals and additional control data, by means of HRTF<br>
filtering.<br>
Background of the Invention and Prior Art<br>
Recent development in audio coding has made methods<br>
available to recreate a multi-channel representation of an<br>
audio signal based on a stereo (or mono) signal and<br>
corresponding control data. These methods differ<br>
substantially from older matrix based solution such as<br>
Dolby Prologic, since additional control data is<br>
transmitted to control the re-creation, also referred to<br>
as up-mix, of the surround channels based on the<br>
transmitted mono or stereo channels.<br>
Hence, such a parametric multi-channel audio decoder, e.g.<br>
MPEG Surround reconstructs Nchannels based on M<br>
transmitted channels, where N&gt;M, and the additional<br>
control data. The additional control data represents a<br>
significantly lower data rate than that required for<br>
transmission of all N channels, making the coding very<br>
efficient while at the same time ensuring compatibility<br>
with both M channel devices and N channel devices. [J.<br>
Breebaart et al. "MPEG spatial audio coding / MPEG<br>
Surround: overview and current status", Proc. 119th AES<br>
convention, New York, USA, October 2005, Preprint 6447].<br>
These parametric surround coding methods usually comprise<br>
a parameterization of the surround signal based on Channel<br><br>
Level Difference (CLD) and Inter-channel coherence/cross-<br>
correlation (ICC). These parameters describe power ratios<br>
and correlation between channel pairs in the up-mix<br>
process. Further Channel Prediction Coefficients (CPC) are<br>
also used in prior art to predict intermediate or output<br>
channels during the up-mix procedure.<br>
Other developments in audio coding have provided means to<br>
obtain a multi-channel signal impression over stereo<br>
headphones. This is commonly done by downmixing a multi-<br>
channel signal to stereo using the original multi-channel<br>
signal and HRTF (Head Related Transfer Functions) filters.<br>
Alternatively, it would, of course, be useful for<br>
computational efficiency reasons and also for audio quality<br>
reasons to short-cut the generation of the binaural signal<br>
having the left binaural channel and the right binaural<br>
channel.<br>
However, the question is how the original HRTF filters can<br>
be combined. Further a problem arises in a context of an<br>
energy-loss-affected upmixing rule, i.e., when the multi-<br>
channel decoder input signal includes a downmix signal<br>
having, for example, a first downmix channel and a second<br>
downmix channel, and further having spatial parameters,<br>
which are used for upmixing in a non-energy-conserving way.<br>
Such parameters are also known as prediction parameters or<br>
CPC parameters. These parameters have, in contrast to<br>
channel level difference parameters the property that they<br>
are not calculated to reflect the energy distribution<br>
between two channels, but they are calculated for<br>
performing a best-as-possible waveform matching which<br>
automatically results in an energy error (e.g. loss),<br>
since, when the prediction parameters are generated, one<br>
does not care about energy-conserving properties of an<br>
upmix, but one does care about having a good as possible<br>
time or subband domain waveform matching of the<br>
reconstructed signal compared to the original signal.<br><br>
When one would simply linearly combine HRTF filters based<br>
on such transmitted spatial prediction parameters, one will<br>
receive artifacts which are especially serious, when the<br>
prediction of the channels performs poorly. In that<br>
situation, even subtle linear dependencies lead to<br>
undesired spectral coloring of the binaural output. It has<br>
been found out that this artifact occurs most frequently<br>
when the original channels carry signals that are pairwise<br>
uncorrelated and have comparable magnitudes.<br>
Summary of the Invention<br>
It is the object of the present invention to provide an<br>
efficient and qualitatively acceptable concept for multi-<br>
channel decoding to obtain a binaural signal which can be<br>
used, for example, for headphone reproduction of a multi-<br>
channel signal.<br>
In accordance with the first aspect of the present<br>
invention, this object is achieved by a multi-channel<br>
decoder for generating a binaural signal from a downmix<br>
signal derived from an original multi-channel signal using<br>
parameters including an upmix rule information useable for<br>
upmixing the downmix signal with an upmix rule, the upmix<br>
rule resulting in an energy-error, comprising: a gain<br>
factor calculator for calculating at least one gain factor<br>
for reducing or eliminating the energy-error, based on the<br>
upmix rule information and filter characteristics of a head<br>
related transfer function based filters corresponding to<br>
upmix channels, and a filter processor for filtering the<br>
downmix signal using the at least one gain factor, the<br>
filter characteristics and the upmix rule information to<br>
obtain an energy-corrected binaural signal.<br>
In accordance with a second aspect of this invention, this<br>
object is achieved by a method of multi-channel decoding<br><br>
for generating a binaural signal from a downmix signal<br>
derived from an original multi-channel signal using<br>
parameters including an upmix rule information useable for<br>
upmixing the downmix signal with an upmix rule, the upmix<br>
rule resulting in an energy-error, comprising: calculating<br>
at least one gain factor for deducing or eliminating the<br>
energy-error, based on the upmix rule information and<br>
filter characteristics of a head related transfer function<br>
based filters corresponding to upmix channels; and<br>
filtering the downmix signal using the at least one gain<br>
factor, the filter characteristics and the upmix rule<br>
information to obtain an energy-corrected binaural signal.<br>
Further aspects of this invention relate to a computer<br>
program having a computer-readable code which implements,<br>
when running on a computer, the method of multi-channel<br>
decoding.<br>
The present invention is based on the finding that one can<br>
even advantageously use up-mix rule information on an upmix<br>
resulting in an energy error for filtering a downmix signal<br>
to obtain a binaural signal without having to fully render<br>
the multichannel signal and to subsequently apply a huge<br>
number of HRTF filters. Instead, in accordance with the<br>
present invention, the upmix rule information relating to<br>
an energy-error-affected upmix rule can advantageously be<br>
used for short-cutting binaural rendering of a downmix<br>
signal, when, in accordance with the present invention, a<br>
gain factor is calculated and used when filtering the<br>
downmix signal, wherein this gain factor is calculated such<br>
that the energy error is reduced or completely eliminated.<br>
Particularly, the gain factor not only depends on the<br>
information on the upmix rule such as the prediction<br>
parameters, but, importantly, also depends on head related<br>
transfer function based filters corresponding to upmix<br>
channels, for which the upmix rule is given. Particularly,<br>
these upmix channels never exist in the preferred<br><br>
embodiment of the present invention, since the binaural<br>
channels are calculated without firstly rendering, for<br>
example, three intermediate channels. However, one can<br>
derive or provide HRTF based filters corresponding to the<br>
upmix channels although the upmix channels themselves never<br>
exist in the preferred embodiment. It has been found out<br>
that the energy error introduced by such an energy-loss-<br>
affected upmix rule not only corresponds to the upmix rule<br>
information which is transmitted from the encoder to the<br>
decoder, but also depends on the HRTF based filters so<br>
that, when generating the gain factor, the HRTF based<br>
filters also influence the calculation of the gain factor.<br>
In view of that, the present invention accounts for the<br>
interdependence between upmix rule information such as<br>
prediction parameters and the specific appearance of the<br>
HRTF based filters for the channels which would be the<br>
result of upmixing using the upmix rule.<br>
Thus, the present invention provides a solution to the<br>
problem of spectral coloring arising from the usage of a<br>
predictive upmix in combination with binaural decoding of<br>
parametric multi-channel audio.<br>
Preferred embodiments of the present invention comprise the<br>
following features: an audio decoder for generating a<br>
binaural audio signal from M decoded signals and spatial<br>
parameters pertinent to the creation of N&gt;M channels,<br>
the decoder comprising a gain calculator for estimating, in<br>
a multitude of subbands, two compensation gains from P<br>
pairs of binaural subband filters and a subset of the<br>
spatial parameters pertinent to the creation of P<br>
intermediate channels, and a gain adjuster for modifying,<br>
in a multitude of subbands, M pairs of binaural subband<br>
filters obtained by linear combination of the P pairs of<br>
binaural subband filters, the modification consisting of<br>
multiplying each of the M pairs with the two gains<br>
computed by the gain calculator.<br><br>
Brief Description of the Drawings<br>
The present invention	will now be described by way of<br>
illustrative examples,	not limiting the scope or spirit of<br>
the invention, with	reference to the accompanying<br>
drawings, in which:<br>
Fig. 1 illustrates binaural synthesis of parametric<br>
multichannel signals using HRTF related filters;<br>
Fig. 2 illustrates binaural synthesis of parametric<br>
multichannel signals using combined filtering;<br>
Fig. 3 illustrates the components of the inventive<br>
parameter/filter combiner;<br>
Fig. 4 illustrates the structure of MPEG Surround<br>
spatial decoding;<br>
Fig. 5 illustrates the spectrum of a decoded binaural<br>
signal without the inventive gain compensation;<br>
Fig. 6 illustrates the spectrum of the inventive<br>
decoding of a binaural signal.<br>
Fig. 7 illustrates a conventional binaural synthesis<br>
using HRTFs;<br>
Fig. 8 illustrates a MPEG surround encoder;<br>
Fig. 9 illustrates cascade of MPEG surround decoder and<br>
binaural synthesizer;<br>
Fig. 10 illustrates a conceptual 3D binaural decoder for<br>
certain configurations;<br><br>
Fig. 11 illustrates a spatial encoder for certain<br>
configurations;<br>
Fig. 12 illustrates a spatial (MPEG Surround) decoder;<br>
Fig. 13 illustrates filtering of two downmix channels<br>
using four filters to obtain binaural signals<br>
without gain factor correction;<br>
Fig. 14 illustrates a spatial setup for explaining<br>
different HRTF filters 1-10 in a five channels<br>
setup;<br>
Fig. 15 illustrates a situation of Fig. 14, when the<br>
channels for L, Ls and R, Rs have been combined;<br>
Fig. 16a illustrates the setup from Fig. 14 or Fig. 15,<br>
when a maximum combination of HRTF filters has<br>
been performed and only the four filters of Fig.<br>
13 remain;<br>
Fig. 16b illustrates an upmix rule as determined by the<br>
Fig. 20 encoder having upmix coefficients<br>
resulting in a non-energy-conserving upmix;<br>
Fig. 17 illustrates how HRTF filters are combined to<br>
finally obtain four HRTF-based filters;<br>
Fig. 18 illustrates a preferred embodiment of an<br>
inventive multi-channel decoder;<br>
Fig. 19a illustrates a first embodiment	of the inventive<br>
multi-channel decoder having	a scaling stage<br>
after HRTF-based filtering	without gain<br>
correction;<br><br>
Fig. 19b illustrates an inventive device having adjusted<br>
HRTF-based filters which result in a gain-<br>
adjusted filter output signal; and<br>
Fig. 20 shows an example for an encoder generating the<br>
information for a non-energy-conserving upmix<br>
rule.<br>
Detailed description of preferred embodiments<br>
Before discussing the inventive gain adjusting aspect in<br>
detail, a combination of HRTF filters and usage of HRTF-<br>
based filters will be discussed in connection with Figs. 7<br>
to 11.<br>
In order to better outline the features and advantages of<br>
the present invention a more elaborate description is<br>
given first. A binaural synthesis algorithm is outlined in<br>
Fig. 7. A set of input channels is filtered by a set of<br>
HRTFs. Each input signal is split in two signals (a left<br>
'L' , and a right 'R' component); each of these signals is<br>
subsequently filtered by an HRTF corresponding to the<br>
desired sound source position. All left-ear signals are<br>
subsequently summed to generate the left binaural output<br>
signal, and the right-ear signals are summed to generate<br>
the right binaural output signal.<br>
The HRTF convolution can be performed in the time domain,<br>
but it is often preferred to perform the filtering in the<br>
frequency domain due to computational efficiency. In that<br>
case, the summation as shown in Fig. 7 is also performed in<br>
the frequency domain.<br>
In principle, the binaural synthesis method as outlined in<br>
Fig. 7 could be directly used in combination with an MPEG<br>
surround encoder/decoder. The MPEG surround encoder is<br>
schematically shown in Fig. 8. A multi-channel input signal<br><br>
is analyzed by a spatial encoder, resulting in a mono or<br>
stereo down mix signal, combined with spatial parameters.<br>
The down mix can be encoded with any conventional mono or<br>
stereo audio codec. The resulting down-mix bit stream is<br>
combined with the spatial parameters by a multiplexer,<br>
resulting in the total output bit stream.<br>
A binaural synthesis scheme in combination with an MPEG<br>
surround decoder is shown in Fig. 9. The input bit stream<br>
is de-multiplexed resulting in spatial parameters and a<br>
down-mix bit stream. The latter bit stream is decoded using<br>
a conventional mono or stereo decoder. The decoded down mix<br>
is decoded by a spatial decoder, which generates a multi-<br>
channel output based on the transmitted spatial parameters.<br>
Finally, the multi-channel output is processed by a<br>
binaural synthesis stage as depicted in Fig. 7, resulting<br>
in a binaural output signal.<br>
There are however at least three disadvantages of such a<br>
cascade of an MPEG surround decoder and a binaural<br>
synthesis module:<br>
•	A multi-channel signal representation is computed as<br>
an intermediate step, followed by HRTF convolution and<br>
downmixing in the binaural synthesis step. Although<br>
HRTF convolution should be performed on a per channel<br>
basis, given the fact that each audio channel can have<br>
a different spatial position, this is an undesirable<br>
situation from a complexity point of view.<br>
•	The spatial decoder operates in a filterbank (QMF)<br>
domain. HRTF convolution, on the other hand, is<br>
typically applied in the FFT domain. Therefore, a<br>
cascade of a multi-channel QMF synthesis filterbank, a<br>
multi-channel DFT transform, and a stereo inverse DFT<br>
transform is necessary, resulting in a system with<br>
high computational demands.<br><br>
• Coding artifacts created by the spatial decoder to<br>
create a multi-channel reconstruction will be audible,<br>
and possibly enhanced in the (stereo) binaural output.<br>
The spatial encoder is shown in Fig. 11. A multi-channel<br>
input signal consisting of Lf, Ls, C, Rf and Rs signals,<br>
for the left-front, left-surround, center, right-front and<br>
right-surround channels is processed by two 'OTI" units,<br>
which both generate a mono down mix and parameters for two<br>
input signals. The resulting down-mix signals, combined<br>
with the center channel are further processed by a *TTT'<br>
(Two-To-Three) encoder, generating a stereo down mix and<br>
additional spatial parameters.<br>
The parameters resulting from the 'TTT' encoder typically<br>
consist of a pair of prediction coefficients for each<br>
parameter band, or a pair of level differences to describe<br>
the energy ratios of the three input signals. The<br>
parameters of the 'OTT' encoders consist of level<br>
differences and coherence or cross-correlation values<br>
between the input signals for each frequency band.<br>
In Fig. 12 a MPEG Surround decoder is depicted. The downmix<br>
signals 10 and rO are input into a Two-To-Three module,<br>
that recreates a center channel, a right side channel and a<br>
left side channel. These three channels are further<br>
processed by several OTT modules (One-To-Two) yielding the<br>
six output channels.<br>
The corresponding binaural decoder as seen from a<br>
conceptual point of view is shown in Fig. 10. Within the<br>
filterbank domain, the stereo input signal {L0, Ro) is<br>
processed by a TTT decoder, resulting in three signals L, R<br>
and C. These three signals are subject to HRTF parameter<br>
processing. The resulting 6 channels are summed to generate<br>
the stereo binaural output pair {Lb, Rb) .<br><br>
The TTT decoder can be described as the following matrix<br>
operation:<br><br>
with matrix entries mxy dependent on the spatial<br>
parameters. The relation of spatial parameters and matrix<br>
entries is identical to those relations as in the 5.1-<br>
multichannel MPEG surround decoder. Each of the three<br>
resulting signals L, R, and C are split in two and<br>
processed with HRTF parameters corresponding to the desired<br>
(perceived) position of these sound sources. For the center<br>
channel (C) , the spatial parameters of the sound source<br>
position can be applied directly, resulting in two output<br>
signals for center, LB(C) and RB(C):<br><br>
For the left (L) channel, the HRTF parameters from the<br>
left-front and left-surround channels are combined into a<br>
single HRTF parameter set, using the weights wlf and wrf .<br>
The resulting 'composite' HRTF parameters simulate the<br>
effect of both the front and surround channels in a<br>
statistical sense. The following equations are used to<br>
generate the binaural output pair (LB, RB) for the left<br>
channel:<br><br>
In a similar fashion, the binaural output for the right<br>
channel is obtained according to:<br><br><br>
Given the above definitions of LB(C), RB(C), LB{L), RB(L),<br>
LB(R) and RB(R), the complete LB and RB signals can be<br>
derived from a single 2 by 2 matrix given the stereo input<br>
signal:<br><br>
with<br><br>
The Hx(Y) filters can be expressed as parametric weighted<br>
combinations of parametric versions of the original HRTF<br>
filters. In order for this to work, the original HRTF<br>
filters are expressed as a<br>
•	An (average) level per frequency band for the left-ear<br>
impulse response;<br>
•	An (average) level per frequency band for the right-<br>
ear impulse response;<br>
•	An (average) arrival time or phase difference between<br>
the left-ear and right-ear impulse response.<br>
Hence, the HRTF filters for the left and right ear given<br>
the center channel input signal is expressed as:<br><br><br>
where P,(C) is the average level for a given frequency band<br>
for the left ear, and Ø(c)is the phase difference.<br>
Hence, the HRTF parameter processing simply consists of a<br>
multiplication of the signal with P1and Pr corresponding<br>
to the sound source position of the center channel, while<br>
the phase difference is distributed symmetrically. This<br>
process is performed independently for each QMF band, using<br>
the mapping from HRTF parameters to QMF filterbank on the<br>
one hand, and mapping from spatial parameters to QMF band<br>
on the other hand.<br>
Similarly the HRTF filters for the left and right ear given<br>
the left channel and right channel are given by:<br><br>
Clearly, the HRTFs are weighted combinations of the levels<br>
and phase differences for the parameterized HRTF filters<br>
for the six original channels.<br>
The weights Wif and Wjs depend on the CLD parameter of the<br>
'OTT' box for Lf and Ls:<br><br><br>
And the weights wrf and Wrs depend on the CLD parameter of<br>
the 'OTT" box for Rf and Rs:<br><br>
The above approach works well for short HRTF filters that<br>
sufficiently accurate can be expressed as an average level<br>
per frequency band, and an average phase difference per<br>
frequency band. However, for long echoic HRTFs this is not<br>
the case.<br>
The present invention teaches how to extend the approach of<br>
a 2 by 2 matrix binaural decoder to handle arbitrary length<br>
HRTF filters. In order to achieve this, the present<br>
invention comprises the following steps:<br>
•	Transform the HRTF filter responses to a filterbank<br>
domain;<br>
•	Overall delay difference or phase difference<br>
extraction from HRTF filter pairs;<br>
•• Morph the responses of the HRTF filter pair as a<br>
function of the CLD parameters<br>
•	Gain adjustment<br>
This is achieved by replacing the six complex gainsHY(X)<br>
for Y = L0, R0and X = L,R,C with six filters. These filters<br>
are derived from the ten filters HY(X) for Y = L0,R0 and<br>
X=Lf,Ls,Rf,Rs,C , which describe the given HRTF filter<br>
responses in the QMF domain. These QMF representations can<br>
be achieved according to the method described below.<br>
The morphing of the front and surround channel filters is<br>
performed with a complex linear combination according to<br><br><br>
The phase parameter Øxy can be defined from the main delay<br>
time difference rxybetween the front and back HRTF filters<br>
and the subband index n of the QMF bank via<br><br>
The role of this phase parameter in the morphing of<br>
filters is twofold. First, it realizes a delay<br>
compensation of the two filters prior to superposition<br>
which leads to a combined response which models a main<br>
delay time corresponding to a source position between the<br>
front and the back speakers. Second, it makes the<br>
necessary gain compensation factor gmuch more stable and<br>
slowly varying over frequency than in the case of simple<br>
superposition with Øxy=0.<br>
The gain factor g is determined by the same incoherent<br>
addition power rule as for the parametric HRTF case,<br><br>
andPxy is the real value of the normalized complex cross<br>
correlation between the filters<br><br>
In the case of simple superposition withØxy=0, the value<br>
of Pxy varies in an erratic and oscillatory manner as a<br>
function of frequency, which leads to the need for<br>
extensive gain adjustment. In practical implementation it<br><br>
is necessary to limit the value of the gaingand a<br>
remaining spectral colorization of the signal cannot be<br>
avoided.<br>
In contrast, the use of morphing with a delay based phase<br>
compensation as taught by the present invention leads to a<br>
smooth behavior of pxy as a function of frequency. This<br>
value is often even close to one for natural HRTF derived<br>
filter pairs since they differ mainly in a delay and<br>
amplitude, and the purpose of the phase parameter is to<br>
take the delay difference into account in the QMF<br>
filterbank domain.<br>
An alternative beneficial choice of phase parameter Øxy is<br>
given by computing the phase angle of the normalized<br>
complex cross correlation between the filters<br>
Hy(Xf) and HY(Xs)f<br>
and unwrapping the phase values with standard unwrapping<br>
techniques as a function of the subband index n of the QMF<br>
bank. This choice has the consequence that Pxy is never<br>
negative and hence the compensation gain ^satisfies<br>
  for all subbands. Moreover this choice of phase<br>
parameter enables the morphing of the front and surround<br>
channel filters in situations where a main delay time<br>
difference txy is not available.<br>
All signals considered below are subband samples from a<br>
modulated filter bank or windowed FFT analysis of discrete<br><br>
time signals or discrete	time signals. It is understood<br>
that these subbands have	to be transformed back to the<br>
discrete time domain by	corresponding synthesis filter<br>
bank operations.<br>
Fig. 1 illustrates a procedure for binaural synthesis of<br>
parametric multichannel signals using HRTF related filters.<br>
A multichannel signal comprising N channels is produced by<br>
spatial decoding 101 based on M<n transmitted channels></n>
and transmitted spatial parameters. These TV channels are in<br>
turn converted into two output channels intended for<br>
binaural listening by means of HRTF filtering. This HRTF<br>
filtering 102 superimposes the results of filtering each<br>
input channel with one HRTF filter for the left ear and one<br>
HRTF filter for the right ear. All in all, this requires<br>
2N filters. Whereas the parametric multichannel signal<br>
achieves a high quality listener experience when listened<br>
to through N loudspeakers, subtle interdependencies of the<br>
N signals will lead to artifacts for the binaural<br>
listening. These artifacts are dominated by deviation in<br>
spectral content from the reference binaural signal as<br>
defined by HRTF filtering of the original N channels prior<br>
to coding. A further disadvantage of this concatenation is<br>
that the total computational cost for binaural synthesis is<br>
the addition of the cost required for each of the<br>
components 101 and 102.<br>
Fig. 2 illustrates binaural synthesis of parametric<br>
multichannel signals by using the combined filtering taught<br>
by the present invention. The transmitted spatial<br>
parameters are split by 201 into two sets, Set 1 and Set 2.<br>
Here, Set 2 comprises parameters pertinent to the creation<br>
of P intermediate channels from the M transmitted channels<br>
and Set 1 comprises parameters pertinent to the creation of<br>
N channels from the P intermediate channels. The prior art<br>
precombiner 202 combines selected pairs of the 2N HRTF<br>
related subband filters with weights that depend the<br>
parameter Set 1 and the selected pairs of filters. The<br><br>
result of this precombination is 2P binaural subband<br>
filters which represent a binaural filter pair for each of<br>
the P intermediate channels. The inventive combiner 203<br>
combines the 2P binaural subband filters into a set of<br>
2Mbinaural subband filters by applying weights that depend<br>
both on the parameter Set 2 and the 2P binaural subband<br>
filters. In comparison, a prior art linear combiner would<br>
apply weights that depend only on the parameter Set 2. The<br>
resulting set of 2M filters consists of a binaural filter<br>
pair for each of the Mtransmitted channels. The combined<br>
filtering unit 204 obtains a pair of contributions to the<br>
two channel output for each of the Mtransmitted channels<br>
by filtering with the corresponding filter pair.<br>
Subsequently, all the Mcontributions are added up to form<br>
a two channel output in the subband domain.<br>
Fig. 3 illustrates the components of the inventive<br>
combiner 203 for combination of spatial parameters and<br>
binaural filters. The linear combiner 301 combines the 2P<br>
binaural subband filters into 2M binaural filters by<br>
applying weights that are derived from the given spatial<br>
parameters, where these spatial parameters are pertinent<br>
to the creation of P intermediate channels from the<br>
Mtransmitted channels. Specifically, this linear<br>
combination simulates the concatenation of an upmix from<br>
Mtransmitted channels to P intermediate channels<br>
followed by a binaural filtering from P sources. The gain<br>
adjuster 303 modifies the 2M binaural filters output from<br>
the linear combiner 301 by applying a common left gain to<br>
each of the filters that correspond to the left ear output<br>
and by applying a common right gain to each of the filters<br>
that correspond to the right ear output. Those gains are<br>
obtained from gain calculator 302 which derives the gains<br>
from the spatial parameters and the 2P binaural filters.<br>
The purpose of the gain adjustment of the inventive<br>
components 302 and 303 is to compensate for the situation<br>
where theP intermediate channels of the spatial decoding<br>
carry linear dependencies that lead to unwanted spectral<br><br>
coloring due to the linear combiner 301. The gain<br>
calculator 302 taught by the present invention includes<br>
means for estimating an energy distribution of the P<br>
intermediate channels as a function of the spatial<br>
parameters.<br>
Fig. 4 illustrates the structure of MPEG Surround spatial<br>
decoding in the case of a stereo transmitted signal. The<br>
analysis subbands of the M = 2transmitted signals are fed<br>
into the 2—&gt;3 box 401 which outputs P = 3 intermediate<br>
signals, a combined left, a combined right, and a combined<br>
center. This upmix depends on a subset of the transmitted<br>
spatial parameters which corresponds to Set 2 on Fig. 2.<br>
The three intermediate signals are subsequently fed into<br>
three l-&gt;2 boxes 402-404 which generate a totality ofN=6<br>
signals 405: lf (left front), ls (left surround), rf (right<br>
front) , rs (right surround) , c (center) , and Ife (low<br>
frequency extension). This upmix depends on a subset of<br>
the transmitted spatial parameters which corresponds to<br>
Set 1 on Fig. 2. The final multichannel digital audio<br>
output is created by passing the six subband signals into<br>
six synthesis filter banks.<br>
Fig. 5 illustrates the problem to be solved by the<br>
inventive gain compensation. The spectrum of a reference<br>
HRTF filtered binaural output for the left ear is depicted<br>
as a solid graph. The dashed graph depicts the spectrum of<br>
the corresponding decoded signal as generated by the<br>
method of Fig. 2, in the case where the combiner 203<br>
consists of the linear combiner 301 only. As it can be<br>
seen, there is a substantial spectral energy loss relative<br>
to the desired reference spectrum in the frequency<br>
intervals 3-4 kHz and 11-13 kHz. There is also a smaller<br>
spectral boost around 1 kHz and 10 kHz.<br>
Fig. 6 illustrates the benefit of using the inventive gain<br>
compensation. The solid graph is the same reference<br>
spectrum as in Fig. 5, but now the dashed graph depicts<br><br>
the spectrum of the decoded signal as generated by the<br>
method of Fig. 2, in the case where the combiner 203<br>
consists of all the components of Fig. 3. As it can be<br>
seen, there is a significantly improved spectral match<br>
between the two curves compared to that of the two curves<br>
of Fig. 5.<br>
In the text which follows, the mathematical description of<br>
the inventive gain compensation will be outlined. For<br>
discrete complex signals x,y, the complex inner product<br>
and squared norm (energy) is defined by<br><br>
where y(k) denotes the complex conjugate signal of y(k).<br>
The original multichannel signal consists of TV channels,<br>
and each channel has a binaural HRTF related filter pair<br>
associated to it. It will however be assumed here that the<br>
parametric multichannel signal is created with an<br>
intermediate step of predictive upmix from the<br>
Mtransmitted channels to P predicted channels. This<br>
structure is used in MPEG Surround as described by Fig. 4.<br>
It will be assumed that the original set of IN HRTF<br>
related filters have been reduced by the prior art<br>
precombiner 202 to a filter pair for each of the P<br>
predicted channels where M<p the p predicted></p>
channel signals xp, p = l,2,K ,P, aim at approximating theP<br>
signals xp, p = l,2,K ,P, which are derived from the original<br>
N channels via partial downmix. In MPEG Surround, these<br>
signals are a combined left, a combined right and a<br>
combined and scaled center/Ife channel. It is assumed that<br>
the HRTF filter pair corresponding to the signal xp is<br><br>
described by a subband filter blp for the left ear and a<br>
subband filter b2pfor the right ear. The reference binaural<br>
output signal is thus given by the linear superposition of<br>
filtered signals for n = l,2,<br><br>
where the star denotes convolution in the time direction.<br>
The subband filters can be given in form of finite impulse<br>
response (FIR) filters, infinite impulse response (IIR) or<br>
derived from a parameterized family of filters.<br>
In the encoder, the downmix is formed by the application<br>
of a MxP downmix matrix D to a column vector of signals<br>
formed by x p = 1,2,K ,Pand the prediction in the decoder is<br>
performed by the application of a PxM prediction matrix<br>
C to the column vector of signals formed by the M<br>
transmitted downmixed channels zm m = l,K ,M,<br><br>
Both matrices are known at the decoder, and ignoring the<br>
effects of coding the downmixed channels, the combined<br>
effect of prediction can be modeled by<br><br>
where a are the entries of the matrix product A = CD.<br>
A straightforward method for producing a binaural output<br>
at the decoder is to simply insert the predicted signals<br>
xp in (2) resulting in<br><br><br>
In terms of computations, the binaural filtering is<br>
combined with the predictive upmix beforehand such that<br>
(5) can be written as<br><br>
with the combined filters defined by<br><br>
This formula describes the action of the linear combiner<br>
301 which combines the coefficients c„m derived from<br>
p,tn<br>
spatial parameters with the binaural subband domain<br>
filters bnp . When the originalP signals^ have a<br>
numerical rank essentially bounded by M, the prediction<br>
can be designed to perform very well and the approximation<br>
jc «JC is valid. This happens for instance if only M of the<br>
P channels are active, or if important signal components<br>
originate from amplitude panning. In that case the decoded<br>
binaural signal (5) is a very good match to the reference<br>
(2). On the other hand, in the general case and<br>
especially in case the original P signals xp are<br>
uncorrelated, there will be a substantial prediction loss<br>
and the output from (5) can have an energy that deviates<br>
considerably from the energy of (2). As the deviation will<br>
be different in different frequency bands, the final audio<br>
output suffers from spectral coloring artifacts as<br>
described by Fig. 5. The present invention teaches how to<br>
circumvent this problem by gain compensating the output<br>
according to<br><br><br>
In terms of computations, the gain compensation is<br>
advantageously performed by altering the combined filters<br>
according to the gain adjuster 303 , ^(0m(k) = gnhn^(k) . The<br>
modified combined filtering then becomes<br><br>
The optimal values of the compensating gains in (8) are<br><br>
The purpose of the gain calculator 302 is to estimate<br>
these gains from the information available in the decoder.<br>
Several tools for this end will now be outlined. The<br>
available information is represented here by the matrix<br>
entries apq and the HRTF related subband filters bnp.<br>
First, the following approximation will be assumed for the<br>
inner product between signals jc^that have been filtered<br>
by HRTF related subband filters b,d,<br><br>
This approximation relies on the fact that often most<br>
energy of the filters is concentrated in a dominant single<br>
tap, which in turn presupposes that the time step of the<br>
applied time frequency transform is sufficiently large in<br>
comparison to the main delay differences of HRTF filters.<br>
Applying the approximation (11) in combination with (2)<br>
leads to<br><br><br>
The next approximation consists of assuming that the<br>
original signals are uncorrelated, that is (x ,x\ = 0 for<br>
p*q. Then (12) reduces to<br><br>
For the decoded energy the result corresponding to (12) is<br><br>
Inserting the predicted signals (4) in (14) and applying<br>
the assumption that the original signals are uncorrelated<br>
gives<br><br>
What remains in order to be able to calculate the<br>
compensation gain given by the quotient (10) is to<br>
estimate the energy distribution pi , p = l,2,K ,Pof the<br>
original channels up to an arbitrary factor. The present<br>
invention teaches to do this by computing, as a function<br>
of the energy distribution, the prediction matrix Cmodel<br>
corresponding to the assumption that these channels are<br>
uncorrelated and that the encoder aims at minimizing the<br>
prediction error. The energy distribution is then<br>
estimated by solving the nonlinear system of<br>
equations Cmodel =C if possible. For prediction parameters<br>
that lead to a system of equations without solutions, the<br>
gain compensation factors are set to gn=1. This inventive<br><br>
procedure will be detailed in the following section in the<br>
most important special case.<br>
The computation load imposed by (15) can be reduced in the<br>
case where P = M + l by applying the expansion (see for<br>
instance PCT/EP2005/011586),<br><br>
where vis a unit vector with components vp such that<br>
Dv = 0, and AE is the prediction loss energy,<br><br>
The computation of (15) is then advantageously replaced by<br>
the application of (16) in (14), leading to<br><br>
Subsequently, a preferred specialization to prediction of<br>
three channels from two channels will be discussed. The<br>
case where M = 2and P = 3 is used in MPEG Surround. The<br>
signals are a combined left x1=/, a combined right x2=rand<br>
a (scaled) combined center/lfe channel x3=c. The downmix<br>
matrix is<br><br>
and the prediction matrix is constructed from two<br>
transmitted real parameters c1,c2, according to<br><br><br>
Under the assumption that the original channels are<br>
uncorrelated the prediction matrix realizing the minimal<br>
prediction error is given by<br><br>
Equating Cmodel=C leads to the (unnormalized) energy<br>
distribution taught by the present invention<br><br>
where or = (l-c,)/3, /? = (l-c2)/3, a = a + jd, and p = afi. This<br>
holds in the viable range defined by<br><br>
in which case the prediction error can be found in the<br>
same scaling from<br><br>
Since P = 3 = 2 + l = M + l, the method outlined by (16)-(18) is<br>
applicable. The unit vector is [v,,v2,v3] = [l,l,-l]/v3 and with<br>
the definitions<br><br><br>
the compensation gain for each ear « = 1,2 as computed in a<br>
preferred embodiment of the gain calculator 302 can be<br>
expressed by<br><br>
Here e&gt;0 is a small number whose purpose is to stabilize<br>
the formula near the edge of the viable parameter range<br>
and gmax is an upper limit on the applied compensation<br>
gain. The gains of (27) are different for the left and<br>
right ears, « = 1,2. A variant of the method is to use a<br>
common gain go=gl=g, where<br><br>
The inventive correction gain factor can be brought into<br>
coexistence with a straight-forward multichannel gain<br>
compensation available without any HRTF related issues.<br><br>
In MPEG Surround, compensation for the prediction loss is<br>
already applied in the decoder by multiplying the upmix<br>
matrix C by a factor 1/p where 0<p is a part of the></p>
transmitted spatial parameters. In that case the gains of<br>
(27) and (28) have to be replaced by the products pgn and<br>
pgrespectively. Such compensation is applied for the<br>
binaural decoding studied in Figs. 5 and 6. It is the<br>
reason why the prior art decoding of Fig. 5 has boosted<br>
parts of the spectrum in comparison to the reference. For<br>
the subbands corresponding to those frequency regions, the<br>
inventive gain compensation effectively replaces the<br>
transmitted parameter gain factor l//?with a smaller value<br>
derived from formula (28).<br>
In addition, since the case where p = \ corresponds to a<br>
successful prediction, a more conservative variant of the<br>
gain compensation taught by the present invention will<br>
disable the binaural gain compensation forp=l.<br>
Furthermore, the present invention is used together with a<br>
residual signal. In MPEG Surround, an additional prediction<br>
residual signal z3 can be transmitted which makes it<br>
possible to reproduce the original P=3 signals xpmore<br>
faithfully. In this case the gain compensation is to be<br>
replaced by a binaural residual signal addition which will<br>
now be outlined. The predictive upmix enhanced by a<br>
residual is formed according to<br><br>
where [w„w2,vc3] = [l,l,-l]/3. Substituting #£ for xp in (5)<br>
yields the corresponding combined filtering,<br><br><br>
where the combined filters hn,mare defined by (7) for<br>
/w = l,2, and the combined filters for the residual addition<br>
are defined by<br><br>
The overall structure of this mode of decoding is<br>
therefore also described by Fig. 2 by setting P = M = 3, and<br>
by modifying the combiner 203 to perform only the linear<br>
combination defined by (7) and (31).<br>
Fig. 13 illustrates in a modified representation the result<br>
of the linear combiner 301 in Fig. 3. The result of the<br>
combiner are four HRTF-based filters hn, hi2, h2i and h22.<br>
As will be clearer from the description of Fig. 16a and<br>
Fig. 17, these filters correspond to filters indicated by<br>
15,	16, 17 ,18 in Fig. 16a.<br>
Fig. 16a shows a head of a listener having a left ear or a<br>
left binaural point and having a right ear or a right<br>
binaural point. When Fig. 16a would only correspond to a<br>
stereo scenario, then filters 15, 16, 17, 18 would be<br>
typical head related transfer functions which can be<br>
individually measured or obtained via the Internet or in<br>
corresponding textbooks for different positions between a<br>
listener and the left channel speaker and the right channel<br>
speaker.<br>
However, since the present invention is directed to a<br>
multi-channel binaural decoder, filters illustrated by 15,<br>
16,	17, 18 are not pure HRTF filters, but are HRTF-based<br>
filters, which not only reflect HRTF properties but which<br>
also depend on the spatial parameters and, particularly, as<br>
discussed in connection with Fig. 2, depend on the spatial<br>
parameter set 1 and the spatial parameter set 2.<br><br>
Fig. 14 shows the basis for the HRTF-based filters used in<br>
Fig. 16a. Particularly, a situation is illustrated where a<br>
listener is positioned in a sweet spot between five<br>
speakers in a five channel speaker setup which can be<br>
found, for example, in typical surround home or cinema<br>
entertainment systems. For each channel, there exist two<br>
HRTFs which can be converted to channel impulse responses<br>
of a filter having the HRTF as the transfer function.<br>
Particularly as it is known in the art, an HRTF-based<br>
filter accounts for the sound propagation within the head<br>
of a person so that, for example, HRTF1 in Fig. 14 accounts<br>
for the situation that a sound emitted from speaker Ls<br>
meets the right ear after having passed around the head of<br>
the listener. Contrary thereto, the sound emitted from the<br>
left surround speaker Ls meets the left ear almost directly<br>
and is only partly affected by the position of the ear at<br>
the head and also the shape of the ear etc. Thus, it<br>
becomes clear that the HRTFs 1 and 2 are different from<br>
each other.<br>
The same is true for the HRTFs 3 and 4 for the left<br>
channel, since the relations of both ears to the left<br>
channel L are different. This also applies for all other<br>
HRTFs, although as becomes clear from Fig. 14, the HRTFs 5<br>
and 6 for the center channel will be almost identical or<br>
even completely identical to each other, unless the<br>
individual listeners asymmetry is accommodated by the HRTF<br>
data.<br>
As stated above, these HRTFs have been determined for model<br>
heads and can be downloaded for any specific "average<br>
head", and loudspeaker setup.<br>
Now, as becomes clear at 171 and 172 in Fig. 17, a<br>
combination takes place to combine the left channel and the<br>
left surround channel to obtain two HRTF-based filters for<br>
the left side indicated by L' in Fig. 15. The same<br><br>
procedure is performed for the right side as illustrated by<br>
R' in Fig. 15 which results in HRTF 13 and HRTF 14. To this<br>
end, reference is also made to item 173 and item 174 in<br>
Fig. 17. However, it is to be noted here that, for<br>
combining respective HRTFs in items 171, 172, 173 and 174,<br>
inter channel level difference parameters reflecting the<br>
energy distribution between the L channel and the Ls<br>
channel of the original setup or between the R channel and<br>
the Rs channel of the original multi-channel setup are<br>
accounted for. Particularly, these parameters define a<br>
weighting factor when HRTFs are linearly combined.<br>
As outlined before, a phase factor can also be applied when<br>
combining HRTFs, which phase factor is defined by time<br>
delays or unwrapped phase differences between the to be<br>
combined HRTFs. However, this phase factor does not depend<br>
on the transmitted parameters.<br>
Thus, HRTFs 11, 12, 13 and 14 are not true HRTFs filters<br>
but are HRTF-based filters, since these filters not only<br>
depend from the HRTFs, which are independent from the<br>
transmitted signal. Instead, HRTFs 11, 12, 13 and 14 are<br>
also dependent on the transmitted signal due to the fact<br>
that the channel level difference parameters cldi and cldr<br>
are used for calculating these HRTFs 11, 12, 13 and 14.<br>
Now, the Fig. 15 situation is obtained, which still has<br>
three channels rather than two transmitted channels as<br>
included in a preferred down-mix signal. Therefore, a<br>
combination of the six HRTFs 11, 12, 5, 6, 13, 14 into four<br>
HRTFs 15, 16, 17, 18 as illustrated in Fig. 16a has to be<br>
done.<br>
To this end, HRTFs 11, 5, 13 are combined using a left<br>
upmix rule, which becomes clear from the upmix matrix in<br>
Fig. 16b. Particularly the left upmix rule as shown in Fig<br>
16b and as indicated in block 175 includes parameters nin,<br>
m21 and m31. This left upmix rule is in the matrix equation<br><br>
of Fig. 16 only for being multiplied by the left channel.<br>
Therefore, these three parameters are called the left upmix<br>
rule.<br>
As outlined in block 176, the same HRTFs 11, 5, 13 are<br>
combined, but now using the right upmix rule, i.e., in the<br>
Fig. 16b embodiment, the parameters m12, m22 and m32, which<br>
all are used for being multiplied by the right channel Ro<br>
in Fig. 16b.<br>
Thus, HRTF 15 and HRTF 17 are generated. Analogously HRTF<br>
12, HRTF 6 and HRTF 14 of Fig. 15 are combined using the<br>
upmix left parameters m11, m21 and m31 to obtain HRTF 16. A<br>
corresponding combination is performed using HRTF 12, HRTF,<br>
6 HRTF 14, but now with the upmix right parameters or right<br>
upmix rule indicated by m12, m22 and m32 to obtain HRTF 18 of<br>
Fig. 16a.<br>
Again, it is emphasized that, while original HRTFs in Fig.<br>
14 did not at all depend on the transmitted signal, the new<br>
HRTF-based filters 15, 16, 17, 18 now depend on the<br>
transmitted signal, since the spatial parameters included<br>
in the multi-channel signal were used for calculating these<br>
filters 15, 16, 17 and 18.<br>
To finally obtain a binaural left channel LB and a binaural<br>
right channel RB, the outputs of filters 15 and 17 have to<br>
be combined in an adder 130a. Analogously, the output of<br>
the filters 16 and 18 have to be combined in an adder 130b.<br>
These adders 130a, 130b reflect the superposition of two<br>
signals within the human ear.<br>
Subsequently, Fig. 18 will be discussed. Fig. 18 shows a<br>
preferred embodiment of an inventive multi-channel decoder<br>
for generating a binaural signal using a downmix signal<br>
derived from an original multi-channel signal. The downmix<br>
signal is illustrated at z1 and Z2 or is also indicated by<br>
"L" and "R". Furthermore, the downmix signal has parameters<br><br>
associated therewith, which parameters are at least a<br>
channel level difference for left and left surround or a<br>
channel level difference for right and right surround and<br>
information on the upmixing rule.<br>
Naturally, when the original multi-channel signal was only<br>
a three-channel signal, cld1 or cldr are not transmitted<br>
and the only parametric side information will be<br>
information on the upmix rule which, as outlined before, is<br>
such an upmix rule which results in an energy-error in the<br>
upmixed signal. Thus, although the waveforms of the upmixed<br>
signals when a non-binaural rendering is performed, match<br>
as close as possible the original waveforms, the energy of<br>
the upmixed channels is different from the energy of the<br>
corresponding original channels.<br>
In the preferred embodiment of Fig. 18, the upmix rule<br>
information is reflected by two upmix parameters cpci,<br>
cpc2. However, any other upmix rule information could be<br>
applied and signaled via a certain number of bits.<br>
Particularly, one could signal certain upmix scenarios and<br>
upmix parameters using a predetermined table at the decoder<br>
so that only the table indices have to be transmitted from<br>
an encoder to the decoder. Alternatively, one could also<br>
use different upmixing scenarios such as an upmix from two<br>
to more than three channels. Alternatively, one could also<br>
transmit more than two predictive upmix parameters which<br>
would then require a corresponding different downmix rule<br>
which has to fit to the upmix rule as will be discussed in<br>
more detail with respect to Fig. 20.<br>
Irrespective of such a preferred embodiment for the upmix<br>
rule information, any upmix rule information is sufficient<br>
as long as an upmix to generate an energy-loss affected set<br>
of upmixed channels is possible, which is waveform-matched<br>
to the corresponding set of original signals.<br><br>
The inventive multi-channel decoder includes a gain factor<br>
calculator 180 for calculating at least one gain factor gi,<br>
gr or g, for reducing or eliminating the energy-error. The<br>
gain factor calculator calculates the gain factor based on<br>
the upmix rule information and filter characteristics of<br>
HRTF-based filters corresponding to upmix channels which<br>
would be obtained, when the upmix rule would be applied.<br>
However, as outlined before, in the binaural rendering,<br>
this upmix does not take place. Nevertheless, as discussed<br>
in connection with Fig. 15 and blocks 175, 176, 177, 178 of<br>
Fig. 17, HRTF-based filters corresponding to these upmix<br>
channels are nevertheless used.<br>
As discussed before, the gain factor calculator 180 can<br>
calculate different gain factors gi and gr as outlined in<br>
equation (27), when, instead of n, 1 or r is inserted.<br>
Alternatively, the gain factor calculator could generate a<br>
single gain factor for both channels as indicated by<br>
equation (28) .<br>
Importantly, the inventive gain factor calculator 180<br>
calculates the gain factor based not only on the upmix<br>
rule, but also based on the filter characteristics of the<br>
HRTF-based filters corresponding to upmix channels. This<br>
reflects the situation that the filters themselves also<br>
depend on the transmitted signals and are also affected by<br>
an energy-error. Thus, the energy-error is not only caused<br>
by the upmix rule information such as the prediction<br>
parameters CPCi, CPC2, but is also influenced by the<br>
filters themselves.<br>
Therefore, for obtaining a well-adapted gain correction,<br>
the inventive gain factor not only depends on the<br>
prediction parameter but also depends on the filters<br>
corresponding to the upmix channels as well.<br>
The gain factor and the downmix parameters as well as the<br>
HRTF-based filters are used in the filter processor 182 for<br><br>
filtering the downmix signal to obtain an energy-corrected<br>
binaural signal having a left binaural channel LB and<br>
having a right binaural channel RB.<br>
In a preferred embodiment, the gain factor depends on a<br>
relation between the total energy included in the channel<br>
impulse responses of the filters corresponding to upmix<br>
channels to a difference between this total energy and an<br>
estimated upmix energy error AE. AE can preferably be<br>
calculated by combining the channel impulse responses of<br>
the filters corresponding to upmix channels and to then<br>
calculating the energy of the combined channel impulse<br>
response. Since all numbers in the relations for GL and GR<br>
in Fig. 18 are positive numbers, which becomes clear from<br>
the definitions for AE and E, it is clear that both gain<br>
factors are larger than 1. This reflects the experience<br>
illustrated in Fig. 5 that, in most times, the energy of<br>
the binaural signal is lower than the energy of the<br>
original multi-channel signal. It is also to note, that<br>
even when the multi-channel gain compensation is applied,<br>
i.e., when the factor p is used in most signals,<br>
nevertheless an energy-loss is caused.<br>
Fig. 19a illustrates a preferred embodiment of the filter<br>
processor 182 of Fig. 18. Particularly, Fig. 19a<br>
illustrates the situation, when in block 182a the combined<br>
filters 15, 16, 17, and 18 of Fig. 16a without gain<br>
compensation are used and the filter output signals are<br>
added as outlined in Fig. 13. Then, the output of box 182a<br>
is input into a scaler box 182b for scaling the output<br>
using the gain factor calculated by box 180.<br>
Alternatively, the filter processor can be constructed as<br>
shown in Fig. 19b. Here, HRTFs 15 to 18 are calculated as<br>
illustrated in box 182c. Thus, the calculator 182c performs<br>
the HRTF combination without any gain adjustment. Then, a<br>
filter adjuster 182d is provided, which uses the<br>
inventively calculated gain factor. The filter adjuster<br><br>
results in adjusted filters as shown in block 180e, where<br>
block 180e performs the filtering using the adjusted filter<br>
and performs the subsequent adding of the corresponding<br>
filter output as shown in Fig. 13. Thus, no post-scaling as<br>
in Fig 19a is necessary to obtain gain-corrected binaural<br>
channels LB and RB.<br>
Generally, as has been outlined in connection with equation<br>
16, equation 17 and equation 18, the gain calculation takes<br>
place using the estimated upmix error AE. This<br>
approximation is especially useful for the case where the<br>
number of upmix channels is equal to the number of downmix<br>
channels +1. Thus, in case of two downmix channels, this<br>
approximation works well for three upmix channels.<br>
Alternatively, when one would have three downmix channels,<br>
this approximation would also work well in a scenario in<br>
which there are four upmix channels.<br>
However, it is to be noted that the calculation of the gain<br>
factor based on an estimation of the upmix error can also<br>
be performed for scenarios in which for example, five<br>
channels are predicted using three downmix channels.<br>
Alternatively, one could also use a prediction-based upmix<br>
from two downmix channels to four upmix channels. Regarding<br>
the estimated upmix energy-error AE, one can not only<br>
directly calculate this estimated error as indicated in<br>
equation (25) for the preferred case, but one could also<br>
transmit some information on the actually occurred upmix<br>
error in a bit stream. Nevertheless, even in other cases<br>
than the special case as illustrated in connection with<br>
equations (25) to (28), one could then calculate the value<br>
EnB based on the HRTF-based filters for the upmix channels<br>
using prediction parameters. When equation (26) is<br>
considered, it becomes clear that this equation can also<br>
easily be applied to a 2/4 prediction upmix scheme, when<br>
the weighting factors for the energies of the HRTF-based<br>
filter impulse responses are correspondingly adapted.<br><br>
In view of that, it becomes clear that the general<br>
structure of equation (27), i.e., calculating the gain<br>
factor based on relation of EB/(EB - AEB) also applies for<br>
other scenarios.<br>
Subsequently, Fig. 20 will be discussed to show a schematic<br>
implementation of a prediction-based encoder which could be<br>
used for generating the downmix signal L, R and the upmix<br>
rule information transmitted to a decoder so that the<br>
decoder can perform the gain compensation in the context of<br>
the binaural filter processor.<br>
A downmixer 191 receives five original channels or,<br>
alternatively, three original channels as illustrated by<br>
(Ls and Rs) . The downmixer 191 can work based on a pre-<br>
determined downmix rule. In that case, the downmix rule<br>
indication as illustrated by line 192 is not required.<br>
Naturally, the error- minimizer 193 could vary the downmix<br>
rule as well in order to minimize the error between<br>
reconstructed channels at the output of an upmixer 194 with<br>
respect to the corresponding original input channels.<br>
Thus, the error-minimizer 193 can vary the downmix rule 192<br>
or the upmixer rule 196 so that the reconstructed channels<br>
have a minimum prediction loss AE. This optimization<br>
problem is solved by any of the well-known algorithms<br>
within the error-minimizer 193, which preferably operates<br>
in a subband-wise way to minimize the difference between<br>
the reconstruction channels and the input channels.<br>
As stated before, the input channels can be original<br>
channels L, Ls, R, Rs, C. Alternatively the input channels<br>
can only be three channels L, R, C, wherein, in this<br>
context, the input channels L, R, can be derived by<br>
corresponding OTT boxes illustrated in Fig. 11.<br>
Alternatively, when the original signal only has channels<br>
L, R, C, then these channels can also be termed as<br>
"original channels".<br><br>
Fig. 20 furthermore illustrates that any upmix rule<br>
information can be used besides the transmission of two<br>
prediction parameters as long as a decoder is in the<br>
position to perform an upmix using this upmix rule<br>
information. Thus, the upmix rule information can also be<br>
an entry into a lookup table or any other upmix related<br>
information.<br>
The present invention therefore, provides an efficient way<br>
of performing binaural decoding of multi-channel audio<br>
signals based on available downmixed signals and additional<br>
control data by means of HRTF filtering. The present<br>
invention provides a solution to the problem of spectral<br>
coloring arising from the combination of predictive upmix<br>
with binaural decoding.<br>
Depending on certain implementation requirements of the<br>
inventive methods, the inventive methods can be<br>
implemented in hardware or in software. The implementation<br>
can be performed using a digital storage medium, in<br>
particular a disk, DVD or a CD having electronically<br>
readable control signals stored thereon, which cooperate<br>
with a programmable computer system such that the<br>
inventive methods are performed. Generally, the present<br>
invention is, therefore, a computer program product with a<br>
program code stored on a machine readable carrier, the<br>
program code being operative for performing the inventive<br>
methods when the computer program product runs on a<br>
computer. In other words, the . inventive methods are,<br>
therefore, a computer program having a program code for<br>
performing at least one of the inventive methods when the<br>
computer program runs on a computer.<br>
While the foregoing has been particularly shown and<br>
described with reference to particular embodiments thereof,<br>
it will be understood by those skilled in the art that<br>
various other changes in the form and details may be made<br><br>
without departing from the spirit and scope thereof. It is<br>
to be understood that various changes may be made in<br>
adapting to different embodiments without departing from<br>
the broader concepts disclosed herein and comprehended by<br>
the claims that follow.<br><br>
Claims<br>
1.	Multi-channel decoder for generating a binaural signal<br>
from a downmix signal derived from an original multi-<br>
channel signal using parameters including an upmix<br>
rule information useable for upmixing the downmix<br>
signal with an upmix rule, the upmix rule resulting in<br>
an energy-error, comprising:<br>
a gain factor calculator for calculating at least one<br>
gain factor for reducing or eliminating the energy-<br>
error, based on the upmix rule information and filter<br>
characteristics of a head related transfer function<br>
based filters corresponding to upmix channels; and<br>
a filter processor for filtering the downmix signal<br>
using the at least one gain factor, the filter<br>
characteristics and the upmix rule information to<br>
obtain an energy-corrected binaural signal.<br>
2.	Multi-channel decoder of claim 1, in which the filter<br>
processor is operative to calculate filter<br>
coefficients for two gain adjusted filters for each<br>
channel of the downmix signal and to filter the<br>
downmix channel using each of the two gain adjusted<br>
filters.<br>
3.	Multi-channel decoder of claim 1, in which the filter<br>
processor is operative to calculate filter<br>
coefficients for two filters for each channel of the<br>
downmix channel without using the gain factor and to<br>
filter the downmix channels and to gain adjust<br>
subsequent to filtering the downmix channel.<br>
4.	Multi-channel decoder of claim 1, in which the gain<br>
factor calculator is operative to calculate the gain<br>
factor based on an energy of a combined impulse<br>
response of the filter characteristics, the combined<br><br>
impulse response being calculated by adding or<br>
subtracting individual filter impulse responses.<br>
5.	Multi-channel decoder of claim 1, in which the gain<br>
factor calculator is operative to calculate the gain<br>
factor based on a combination of powers of individual<br>
filter impulse responses.<br>
6.	Multi-channel decoder of claim 5, in which the gain<br>
factor calculator is operative to calculate the gain<br>
factor based on a weighted addition of powers of<br>
individual filter impulse responses, wherein weighting<br>
coefficients used in the weighted addition depend on<br>
the upmix rule information.<br>
7.	Multi-channel decoder of claim 1, in which the gain<br>
factor calculator is operative to calculate the gain<br>
factor based on an expression having a numerator and a<br>
denominator, the numerator having a combination of<br>
powers of individual filter impulse filter responses,<br>
and the denominator having a weighted addition of<br>
powers of individual filter impulse responses, wherein<br>
weighting coefficients used in the weighted addition<br>
depend on the upmix rule information.<br>
8.	Multi-channel decoder of claim 1, in which the gain<br>
factor calculator is operative to calculate the gain<br>
factor based on the following equation:<br><br>
wherein gn is the gain factor for the first channel,<br>
when n is set to 1, wherein g2 is the gain factor of a<br>
second channel, when n is set to 2, wherein EnB is a<br>
weighted addition energy calculated by weighting<br><br>
energies of channel impulse responses using weighting<br>
parameters, and wherein AEn is an estimate for the<br>
energy error introduced by the upmix rule, wherein a,<br>
(3 and y are upmix rule dependent parameters, and<br>
wherein s is a number greater than or equal to zero.<br>
9.	Multi-channel decoder of claim 8, in which the gain<br>
factor calculator is operative to calculate En and AEn<br>
based on the following equation:<br><br>
in which bn, 1 is an HRTF-based filter corresponding to<br>
first upmix channel and a nth binaural channel,<br>
wherein bn,2 is a HRTF-based filter impulse response<br>
corresponding to a second upmix channel and a nth<br>
binaural channel, wherein bn,3 is a HRTF-based filter<br>
impulse response corresponding to a third upmix<br>
channel for a nth binaural channel,<br>
wherein the following definitions are valid<br><br>
wherein c1 is a first prediction parameter, C2 is a<br>
second prediction parameter, and wherein the first<br>
prediction parameter and the second prediction<br>
parameter constitute the upmix rule information.<br>
10.	Multi-channel decoder of claim 1, in which the gain<br>
factor calculator is operative to calculate a common<br>
gain factor for a left binaural channel and a right<br>
binaural channel.<br><br>
11.	Multi-channel decoder of claim 1, in which the filter<br>
processor is operative to use, as the filter<br>
characteristics, the head related transfer function<br>
based filters for the left binaural channel and the<br>
right binaural channel for virtual center, left and<br>
right positions or to use filter characteristics<br>
derived by combining HRTF filters for a virtual left<br>
front position and a virtual left surround position or<br>
by combining HRTF filters for a virtual right front<br>
position and a virtual right surround position.<br>
12.	Multi-channel decoder of claim 11, in which parameters<br>
relating to original left and left surround channels<br>
or original right and right surround channels are<br>
included in a decoder input signal, and<br>
wherein the filter processor is operative to use the<br>
parameters for combining the head related transfer<br>
function filters.<br>
13.	Multi-channel decoder of claim 1, in which the gain<br>
factor calculator is operative to calculate the gain<br>
factor for a binaural channel based on a ratio of a<br>
weighted linear combination of energies of channel<br>
impulse responses of the HRTF-based filters for the<br>
binaural channel and a value obtained by subtracting<br>
an estimated energy-error from the weighted linear<br>
combination.<br>
14.	Multi-channel decoder of claim 13, in which the gain<br>
factor calculator is operative to use information on<br>
the upmix rule for determining the weighting factor.<br>
15.	Multi-channel decoder of claim 14, in which the upmix<br>
rule information includes at least two prediction<br>
parameters usable for constructing an upmix matrix<br>
resulting in output channels having the energy-error<br>
with respect to corresponding three input channels.<br><br>
16.	Multi-channel decoder of claim 1, in which the filter<br>
processor is operative to have, as filter<br>
characteristics,<br>
a first filter for filtering a left downmix channel<br>
for obtaining a first left binaural output,<br>
a second filter for filtering a right downmix channel<br>
for obtaining a second left binaural output,<br>
a third filter for filtering a left downmix channel<br>
for obtaining a first right binaural output,<br>
a fourth filter for filtering a right downmix channel<br>
for obtaining a second right binaural output,<br>
an adder for adding the first left binaural output and<br>
the second left binaural output to obtain a left<br>
binaural channel and for adding the first right<br>
binaural output and the second right binaural output<br>
to obtain a right binaural channel,<br>
wherein the filter processor is operative to apply a<br>
gain factor for the left binaural channel to the first<br>
and the second filters or to the left binaural output<br>
before or after adding and to apply the gain factor<br>
for the right binaural channel to the third filter and<br>
to the fourth filter or to the right binaural output<br>
before or after adding.<br>
17.	Multi-channel decoder of claim 1, in which the upmix<br>
rule information includes upmix parameters usable for<br>
constructing an upmix matrix resulting in an upmix<br>
from two to three channels.<br>
18.	Multi-channel decoder of claim 17, in which the upmix<br>
rule is defined as follows:<br><br><br>
wherein L is a first upmix channel, R is a second<br>
upmix channel, and C is a third upmix channel, L0 is a<br>
first downmix channel, R0 is a second downmix channel,<br>
and mij are upmix rule information parameters.<br>
19.	Multi-channel decoder of claim 1, in which a<br>
prediction loss parameter is included in a multi-<br>
channel decoder input signal, and<br>
in which a filter processor is operative to scale the<br>
gain factor using the prediction loss parameter.<br>
20.	Multi-channel decoder of claim 1, in which the gain<br>
calculator is operative to calculate the gain factor<br>
subband-wise, and<br>
in which the filter processor is operative to apply<br>
the gain factor subband-wise-<br>
21.	Multi-channel decoder of claim 11, in which the filter<br>
processor is operative to combine HRTF filters<br>
associated with two channels by adding weighted or<br>
phase shifted versions of channel impulse responses of<br>
the HRTF filters, wherein weighting factors for<br>
weighting the channel impulse responses is of the HRTF<br>
filters depend on a level difference between the<br>
channels, and an applied phase shift depends on a time<br>
delay between the channel impulse responses of the<br>
HRTF filters.<br>
22.	Multi-channel decoder of claim 1, in which filter<br>
characteristics of HRTF-based filters or HRTF filters<br><br>
are complex subband filters obtained by filtering a<br>
real-valued filter impulse response of an HRTF filter<br>
using a complex-exponential modulated filterbank. .<br>
23.	Method of multi-channel decoding for generating a<br>
binaural signal from a downmix signal derived from an<br>
original multi-channel signal using parameters<br>
including an upmix rule information useable for<br>
upmixing the downmix signal with an upmix rule, the<br>
upmix rule resulting in an energy-error, comprising:<br>
calculating at least one gain factor for reducing or<br>
eliminating the energy-error, based on the upmix rule<br>
information and filter characteristics of a head<br>
related transfer function based filters corresponding<br>
to upmix channels; and<br>
filtering the downmix signal using the at least one<br>
gain factor, the filter characteristics and the upmix<br>
rule information to obtain an energy-corrected<br>
binaural signal.<br>
24.	Computer program having a program code for performing<br>
the method in accordance with claim 23, when the<br>
computer program runs on a computer.<br><br>
A multi-channel decoder for generating a binaural signal<br>
from a downmix signal using upmix rule information on an<br>
energy-error introducing upmix rule for calculating a gain<br>
factor (180) based on the upmix rule information and<br>
characteristics of head related transfer function based<br>
filters corresponding to upmix channels. The one or more<br>
gain factors are used by a filter processor (182) for<br>
filtering the downmix signal so that an energy corrected<br>
binaural signal having a left binaural channel and a right<br>
binaural channel is obtained.</td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/viewdoc.aspx?id=cCbcMOpToteogdpjafNBSQ==&amp;amp;loc=wDBSZCsAt7zoiVrqcFJsRw==" target="_blank" style="word-wrap:break-word;">http://ipindiaonline.gov.in/patentsearch/GrantedSearch/viewdoc.aspx?id=cCbcMOpToteogdpjafNBSQ==&amp;amp;loc=wDBSZCsAt7zoiVrqcFJsRw==</a></p>
		<br>
		<div class="pull-left">
			<a href="270242-automatic-quality-of-service-class-management.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="270244-a-lubricating-oil-for-internal-combustion-engine.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>270243</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>4739/KOLNP/2008</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>49/2015</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>04-Dec-2015</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>04-Dec-2015</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>21-Nov-2008</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>DOLBY INTERNATIONAL AB</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>APOLLO BUILDING, 3E HERIKERBERGWEG 1-35, 1101 CN AMSTERDAM ZUID-OOST, NETHERLANDS</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>VILLEMOES, LARS</td>
											<td>MANDOLINVAGEN 22 175 56 JARFALLA</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>G10L 19/00,H04S 7/00</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/EP2006/008613</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2006-09-04</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>60/803,819</td>
									<td>2006-06-02</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/270243-binaural-multi-channel-decoder-in-the-context-of-non-energy-conserving-upmix-rules by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 05:06:03 GMT -->
</html>
