<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/278818-system-and-method-to-account-for-heterogeneities-for-pencil-beam-based-dose-calculations by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 04 Apr 2024 23:34:51 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 278818:SYSTEM AND METHOD TO ACCOUNT FOR HETEROGENEITIES FOR PENCIL BEAM-BASED DOSE CALCULATIONS</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">SYSTEM AND METHOD TO ACCOUNT FOR HETEROGENEITIES FOR PENCIL BEAM-BASED DOSE CALCULATIONS</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>A system (30) to provide enhanced computational effeciency in determining dose in a media of varying density from a high-energy radiation-beam for radiation treatment, program product (37), and related methods are provided. The system (30) can include a radiation treatment planning computer (31) and radiation treatment planning program product (37) stored in the memory (33) of the radiation treatment planning computer (31) and adapted to enhance optimization of a radiation treatment plan for delivering radiation to a complex medium defining a patient volume. The radiation treatment planning program product (37) provides functions including those for predetermining a delivery machine-dependent representation of radiation dose for a plurality of different electron densities selected over a preselected representative range, predetermining a depth-dependent representation of central axis properties of a pencil beam passing through a complex medium for each of a plurality of pencil beams, and determining with constant lime computational complexity radiation dose for each of :i plurality of points of interest in a heterogeneous medium having a complex spatial distribution of heterogeneous electron densities by applying I he predetermined machine-dependent and depth-dependent representations.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>SYSTEM AND METHOD TO ACCOUNT FOR HETEROGENEITIES FOR PENCTL<br>
BEAM-BASED DOSE CALCULATIONS<br>
BACKGROUND OF THE INVENTION<br>
1.	Related Applications<br>
This non-provisional application claims priority to and the benefit of U.S. Patent<br>
Application No. 60/833,653 filed on July 26, 7.006, titled "System for Enhancing Intensity<br>
Modulated Radiation Therapy, Program Product, and Related Methods," incorporated herein<br>
by reference in its entirety.<br>
2.	Field of The Invention<br>
[0001] The present invention relates generally to radiation therapy. More specifically,<br>
the present invention relates to a system, program product, and related methods for<br>
determining radiation dose to be delivered according to a radiation treatment plan.<br>
3.	Description of the Related Art<br>
(0002] Radiation therapy can be effective in treating certain types of cancerous tumors,<br>
lesions, or other "targets." A vast majority of such targets can be eradicated completely if a<br>
sufficient radiation dose is delivered to the tumor or lesion volume. High-energy radiation is<br>
absorbed and scattered by matter. Cancer cells forming the tumors are often more sensitive<br>
to radiation than normal cells, so radiation treatment is often used to fight cancerous tumors.<br>
Those tumors are usually deep inside the body, and when radiation coming from an external<br>
source is applied, it is inevitable that normal surrounding tissue will receive radiation. The<br>
objective is thus to give the rumor a lethal amount of radiation while keeping under<br>
acceptable levels the amount of radiation that healthy tissue will receive. For most of the<br>
cases high energy photons and electrons are employed for treatment, but protons, neutrons,<br>
heavy charged particles, etc, are also used. Complications, however, may result from use of<br>
the necessary effective radiation dose due to damage to healthy tissue which surrounds the<br>
target or to other healthy body organs located close to the target. The goal of the various<br>
radiation procedures, such as conformal radiation therapy treatment, nevertheless, is to<br>
confine the delivered radiation dose to only the target volume defined by the outer surfaces of<br>
the target, while minimizing the dose of radiation to surrounding healthy tissue or adjacent<br>
 <br>
healthy organs. If the effective radiation dose is not delivered to the proper location within<br>
the patient, serious complications may result.<br>
[0003] Radiation treatment therapy delivery typically uses a radiation delivery apparatus,<br>
such as, for example, a linear accelerator or other radiation producing source, to treat the<br>
target. The conventional linear accelerator includes a rotating gantry which generally rotates<br>
about a horizontal axis and which has a radiation beam source positionable about the patient<br>
which can direct a radiation beam toward the target to be treated. -The linear accelerator can<br>
also include a rotating treatment table which generally rotates about a vertical axis and which<br>
can position the target within a rotational plane of the rotating gantry. Various types of<br>
devices or apparatus can set the field size to further conform the shape of the radiation<br>
treatment beam during rotation of the radiation beam source to follow the spatial contouT of<br>
the target, as viewed with respect to the radiation treatment beam, as it passes through the<br>
patient's body into the target. The modern radiation sources, such as the linear accelerator,<br>
have primary collimators (jaws) that set the field size. Often they are also equipped with<br>
special collimators, e.g., multi-leaf collimators (MLC), which have multiple leaf or finger<br>
projections that can be programmed to move individually into and out of the path of the<br>
radiation beam to shape the radiation beam to dynamically shape the field of irradiation in<br>
order to deliver dose in the desired way.<br>
(0004] Typically, the patient has the radiation therapy treatment plan prepared based upon<br>
a diagnostic study utilizing computerized tomographic ("CT") scanning, magnetic resonance<br>
("MR") imaging, or conventional simulation films which are plain x-rays generated with the<br>
patient. This radiation therapy treatment plan is developed such that the patient's tumor or<br>
lesion is in the position that will be used during the radiation therapy treatment. Various<br>
types of radiation treatment planning systems can be used to create the radiation treatment<br>
plan which, when implemented, will deliver a specified dose of radiation shaped to conform<br>
to the target volume, while limiting the radiation dose delivered to sensitive surrounding<br>
healthy tissue or adjacent healthy organs or structures. Various forms of radiation treatment<br>
planning include forward planning and inverse planning. In forward planning the physicist<br>
directly controls the machine settings of the beams by manually setting the shape and<br>
radiation dose of each field utilizing knowledge of a past treatments in order to achieve<br>
expectations of the physician. With inverse planning the physician directly prescribes the<br>
desired target dose and tolerances for sensitive structures, and the optimization software<br>
 <br>
determines machine settings that will most closely deliver the prescribed radiation<br>
distribution. In the case of both forward planning and inverse planning, a procedure is<br>
required to calculate the radiation dose associated with the machine settings of the beam. In<br>
inverse planning, the optimization software explores a multitude of possibilities for the beam<br>
settings so that computational complexity (calculation time) is critical. To this end, the<br>
radiation beam field can be partitioned into many small rectangular or square shaped fields<br>
which are gencrically called finite-size pencil beams (FSPB) or pencil beams, for short. That<br>
is, a large radiation beam field can be composed of many pencil beams. The FSPBs allow for<br>
optimal partitioning of the radiation field and they are computationally efficient for<br>
calculating dose distributions of complex modulated fields. In the intensity modulated<br>
radiation therapy (IMRT), once the parameters for the pencil beams are computed, their<br>
intensities are modulated until the optimal dose distribution is achieved. From a<br>
computational point of view, FSPB dose values can be stored in tables and a table lookup<br>
method can be used.<br>
[0005] Most current methods used to calculate the dose delivered to the target volume and<br>
surrounding structure are based on dose measurements made in a water box. Heterogeneities<br>
such as bone and airways are treated in an approximate way or otherwise ignored altogether.<br>
Next to direct measurements, the most accurate way of calculating dose in a heterogeneous<br>
medium is employing the Monte Carlo (MC) method. Superposition/convolution is a close<br>
alternative. Hundreds or even thousands of pencil beams need to be pre-computed for a<br>
regular treatment plan. Traditional Monte Carlo and superposition/convolution algorithms<br>
require computing the dose distribution for entire volume in order to determine dose a single<br>
point of interest. Thus, both algorithms are computationally very expensive. Monte Carlo<br>
requires simulating tens of millions of particles through the whole volume to calculate<br>
radiation dose at the point of interest. Superposition/convolution requires completion of a 3D<br>
convolution to calculate radiation dose at a point of interest. Due to the enormous amount of<br>
point dose calculations required to optimize a plan, use of the Monte Carlo method, without<br>
modification, will remain impractical for inverse planning.<br>
[0006] A. Van Esch, et al, in an article titled "Testing Of The Analytical Anisotropic<br>
Algorithm For Photon Dose Calculation," Med. Phys. 33, 4130 (2006), describes an<br>
algorithm known as the Varian AAA inhomogeneity algorithm, which calculates "photon<br>
dose...as a three-dimensional convolution of Monte-Carlo precalculated scatter kernels,...."<br>
 <br>
Cormen et al. in, e.g., "Introduction to Algorithms", The MIT Press, Cambridge<br>
Massachusetts (1997), however, indicates that a convolution, most efficiently implemented<br>
through the Fast Fourier transform, is known to have computational complexity O(n Ig n),<br>
where "n" is the size of the vector being convolved and 'Ig' represents a logarithm with<br>
undisclosed base. An alternative method of computing primary central axis dose is based<br>
upon convolution with a forward and backward spread function rather than a finite difference<br>
equation, described, e.g., in a publication titled "A Method Of Calculating High-Energy<br>
Photon Primary Absorbed Dose In Water Using Forward And Backward Spread Dose-<br>
Distribution Functions," Med. Phys. 12, 731 (1985), again, is a non-constant time operation.<br>
[0G07J Monte-Carlo codes such as PEREGRINE®, described, e.g., in C. Hartmann, et al,<br>
"Description and Dosimetric Verification of the PEREGRINE® Monte Carlo Dose<br>
Calculation System for Photon Beams Incident on a Water Phantom," Med. Phys. 28, 1322<br>
(2001), require a full simulation to determine dose at a single point, and thus, cannot<br>
determine dose to a single point in constant time. Likewise, even a fast variant of<br>
superposition convolution, such as, for example, the Collapsed Cone method, described, e.g.,<br>
by A. Ahnesjo, in a publication titled "Collapsed Cone Convolution of Radiant Energy for<br>
Photon Dose Calculation in Heterogeneous Media," Med. Phys. 16, 577 (1989), require a full<br>
simulation to determine dose at a single point. Similarly, direct application of a Clarkson<br>
Integration for inhomogeneous media, sector integration is required for each point of interest;<br>
integration also being a non-constant time operation.<br>
[0008] Accordingly, neither the Monte Carlo nor superposition/convolution methods can<br>
compute dose to a point with constant time computational complexity. Rather, computing<br>
dose to a single point requires simulation of the energy transport through the entire spatial<br>
distribution of electron densities. As a result, computing dose to a small subset of points in a<br>
volume essentially requires calculating dose to the whole volume. IMRT optimization<br>
requires rapid exploration of a multitude of candidate treatment plan solutions to some points<br>
of interest. Full simulation cannot be employed for each of the multitude of candidates.<br>
Interactive manipulation of radiation dose distributions as in US Patent Application<br>
20050111621 requires rapid calculation of a few high-resolution dose images which are<br>
beyond the capabilities of the transport simulating algorithms.<br>
(0009] The traditional pencil-beam method was developed to provide dose computations<br>
to a point with constant time computational complexity. This method, however, has<br>
 <br>
significant inaccuracies in regions of lateral disequilibrium such as for a narrow beam passing<br>
through the lung or other region of electron density below that of water as in Nizin,<br>
"Electronic Equilibrium and Primary Dose in Collimated Photon Beams," Med. Phys. 20, p.<br>
258 (1982). Lateral disequilibrium is an effect of electron scattering: when the beam is small<br>
or energy is high in low-density media, such as lung material, the traditional model will<br>
systematically overestimate the central axis dose and underestimate the width of the beam.<br>
This method also has significant inaccuracies in media having lateral heterogeneities whereby<br>
the beam experiences a variation in electron density across the beam front at a given depth.<br>
These inaccuracies typically separately result in an overestimate of central axis dose in the<br>
lower electron density portion. Further, this method has significant inaccuracies in media<br>
having a complex electron density distribution such as the human body because it does not<br>
adequately account for multiple build-up and build-down regions characteristic of media<br>
having a complex electron density distribution. Rather, this method employs a single dose<br>
build-up restriction provided to model initial dose entry into the media. For complex media,<br>
such restriction typically results in an overestimate of central axis dose in points or regions<br>
having an electron density other than that of water, particularly with respect to narrow or<br>
high-energy beam fields.<br>
[00010] There have been efforts to improve the results for when the traditional pencil-beam<br>
method is used in heterogeneous media. Many such efforts, however, assumed the beam was<br>
passing through a slab geometry phantom where the electron densities did not vary in a fully<br>
three-dimensional manner. For example, one traditional method of accounting for<br>
heterogeneities called the effective path length method (EPL) amounts to substituting the<br>
integral of electron densities along a path for the depth. Such attempts to improve the<br>
traditional pencil beam method, however, only account for part of the effect of the<br>
heterogeneous media through an effective path length by adding up the electron densities at<br>
all the points between the skin and the depth of interest. Specifically, these attempts to<br>
improve the traditional pencil-beam method do not address the important effects of penumbra<br>
widening in the lung or other low density structure and the effects of lateral heterogeneities as<br>
the radiation beam passes through the complex electron density distribution of the human<br>
body. Nor do they address the effects of the complex electron distribution resulting in<br>
continuous density changes, and thus, continuous build-up/build-down.<br>
 <br>
[00011) A few research avenues are noted regarding Monte Carlo inverse planning which<br>
relate to the use of pencil beam algorithms. First, Monte Carlo can be employed in<br>
conjunction with a pencil-beam algorithm. In such case, Monte Carlo calculations are<br>
preformed on a few iterations using pencil-beam calculations in intermediate iterations as<br>
described in Siebers, et al, in "Performance of a hybrid MC dose algorithm for IMRT<br>
optimization dose evaluation," Med. Phys. 34, 2853 (2007). Recognized by the Applicants is<br>
that numerous calculations would still be required to obtain dose at a single point of interest,<br>
and that improvements to the pencil-beam accuracy would be desirable. Second, Monte<br>
Carlo generated pencil-beams can be applied as described in Bergman et al., in "Direct<br>
Aperture Optimization for IMRT Using Monte Carlo Generated Beamlets," Med. Phys. 33,<br>
3666 (2006). Recognized by the Applicants is that the points of interest used for optimization<br>
must be pre-selected rather than arbitrarily placed, that calculating dose at a point of interest<br>
that was not preselected would require a complete Monte Carlo simulation, and that this<br>
avenue does not provide a system or a method of updating an arbitrary 2d image profiles in<br>
real-time. Accordingly, recognized by the Applicants is the need for a system and method<br>
which can generalize the Monte Carlo generated central axis data to off-axis profiles<br>
calculation, for example, to enable interactive 2d dose image calculations.<br>
[00012] Regardless of which methodology is used at the time of a diagnostic study to<br>
develop the radiation therapy treatment plan, in the delivery of either conformal radiation<br>
therapy treatments or static radiation therapy treatments, an accurate and repeatable<br>
determination of radiation dose to the delivered is very important. Successful radiation<br>
therapy depends on accurately placing the proper amount of radiation upon the target without<br>
unnecessarily damaging surrounding tissue. Thus, it is necessary to relate the radiation dose<br>
determined to be delivered to the target at the time of the diagnostic study to the radiation<br>
dose actually delivered at the time of the radiation therapy treatment. If the actual dose is not<br>
correct, the result can be under-treating the target tumor or lesion and/or damaging healthy<br>
surrounding tissue and organs.<br>
[00013] Recognized, therefore, by the Applicants is the need for a system, program<br>
product, and methods for determining and determining dose to be delivered to a patient that<br>
provides enhanced accuracy for real-time dose optimization, provides values at three-<br>
dimensional point without needing to determine values for the entire volume or subset<br>
thereof, that accounts for reduced actual dose and wider penumbra resulting from lateral<br>
 <br>
electronic disequilibrium, that accounts for the complex electron density distribution of the<br>
human body, and that accounts for variations in electron density across the beam front or<br>
lateral heterogeneities, to thereby provide enhanced accuracy for determining dose in low-<br>
density, e.g., lung, material particularly when using narrow or high beam energy.<br>
SUMMARY OF THE INVENTION<br>
[00014] In view of the foregoing, embodiments of the present invention provide a solution<br>
which is both cost efficient and time efficient and which includes a system, program product,<br>
and method for determining dose to be delivered to a patient that provides enhanced accuracy<br>
for real-time dose optimization, provides values at three-dimensional point without needing<br>
to determine values for the entire volume or subset thereof, that accounts for reduced central<br>
axis dose and wider penumbra resulting from lateral electronic disequilibrium, that accounts<br>
for dose build-up and build-down due to the complex electron density distribution of the<br>
human body, and that accounts for variations in electron density across the beam front or<br>
lateral heterogeneities, to thereby provide enhanced accuracy for determining dose delivered<br>
to a patient<br>
[00015] Embodiments of the present invention provide electron density-dependent<br>
parameterization of a new finite size pencil beam (FSPB) model. Embodiments of the<br>
present invention also provide a process for determining field and medium dependent<br>
normalization factors for primary dose which include electron disequilibrium, a process for<br>
determining central axis (CAX) primary dose for each FSPB and storage for future table<br>
look-up during dose calculation, a process for determining and storing primary profiles for<br>
homogeneous media, for several electron densities, using density-dependent lateral build-up<br>
coefficient and kernel integration, a process for determining and storing scatter profiles for<br>
homogeneous media several densities using Clarkson integration with density-rescaled field<br>
sizes, a process for determining profiles by looking up profiles corresponding to the local<br>
electron density, and a process for determining profiles near interfaces by making a linear<br>
combination of the current and previous profiles. Embodiments of the present invention also<br>
provide a combination of all the above processes in order to produce a finite-size pencil beam<br>
for dose calculation in forward and inverse planning.<br>
 <br>
[00016] More specifically, embodiments of the present invention include a system for<br>
determining dose in heterogeneous media of varying electron density from, for example, a<br>
therapeutic high-energy radiation-beam for radiation treatment The system can include an<br>
image gathering device, e.g., CT scanner, accessible to a communication network to provide<br>
an at least two-dimensional image slice of a tumor target volume and an adjacent structure<br>
volume in a patient, a radiation beam source to deliver radiation to the tumor target according<br>
to a radiation treatment plan, and a radiation treatment planning computer in communication<br>
with the image gathering device and having memory, a processor coupled to the memory.<br>
Note, the radiation treatment planning computer can function as a stand-alone computer or as<br>
a networked device, as described above.<br>
|00017] The system can include radiation treatment planning program product stored, for<br>
example, in the memory of the radiation treatment planning computer and adapted to produce<br>
an optimized radiation treatment plan for delivering radiation to the tumor target volume<br>
simulated dose calculation program product. The radiation treatment planning program<br>
product can include instructions that, when executed by the radiation treatment planning<br>
computer, can perform the operations of receiving a set of photon beam data for a water<br>
medium, e.g., water tank, to thereby parameterize a dose model for unit electron density, and<br>
parameterizing a machine-dependent dose model for unit electron density responsive to the<br>
set of photon beam data. The parameterization process can include dividing a dose model<br>
into primary and scatter dose.<br>
[00018] The operations can also include determining a machine-dependent primary dose<br>
profile for each of a first set of a plurality of electron densities distributed through a<br>
preselected range of electron densities responsive to the dose model for unit electron density,<br>
and determining a machine-dependent scatter dose profile for each of a second set of a<br>
plurality of electron densities distributed through a preselected range of electron densities<br>
responsive to the dose model for unit electron density. This data can be saved in look-up<br>
tables for ready reference and determining density dependent values.<br>
[00019] The operations can also include determining patient specific primary dose profile<br>
parameters for each of the plurality of pencil beams to be utilized during radiation treatment<br>
responsive to the primary dose profiles, and determining patient specific scatter dose profile<br>
parameters for each of the plurality of pencil beam to be utilized during radiation treatment.<br>
These parameters allow for patient specific modeling of each FSPB to be used for a radiation<br>
 <br>
treatment plan to allow for running multiple beam-intensity scenarios to determine optimum<br>
beam intensity for each individual FSPB.<br>
[00020] The operations can also include retrieving the patient specific primary and scatter<br>
dose profile parameters separately for each of a plurality of points of interest in a patient<br>
volume to compute dose with constant time computational complexity to each point of<br>
interest responsive to a local electron density value for the respective point of interest to<br>
thereby determine total dose at each of the plurality of points of interest, and producing a map<br>
of radiation dose delivered to the patient volume to allow a user to iteratively evaluate the<br>
total dose of the patient volume. The local electron density value can be a single value of<br>
electron density associated with the respective point of interest or an electron density<br>
distribution associated the respective point of interest.<br>
[00021] Embodiments the present invention also include methods of determining dose in a<br>
media of varying electron density from a high-energy radiation-beam for radiation treatment.<br>
For example, an embodiment of a method can include the steps of predetermining a delivery<br>
machine-dependent representation of radiation dose for a plurality of different electron<br>
densities selected over a preselected representative range, predetermining a depth-dependent<br>
representation of central axis properties of a pencil beam passing through a complex medium<br>
having a complex spatial distribution of heterogeneous electron densities for each of a<br>
plurality of pencil beams, and determining with constant time computational complexity<br>
radiation dose for each of a plurality of points of interest in the complex medium by applying<br>
the predetermined machine-dependent and depth-dependent representations.<br>
[00022] The step of predetermining a delivery machine-dependent representation of<br>
radiation dose can include the steps of receiving data parameters for a medium having<br>
properties, for example, substantially similar to that of water, forming a primary dose profile<br>
table for each of the plurality of electron densities responsive to the data parameters, and<br>
forming a scatter dose profile table for at least a representative portion of the plurality of<br>
electron densities. The step of predetermining a depth dependent representation of central<br>
axis properties of a pencil beam passing through a complex medium for each of a plurality of<br>
pencil beams can include the steps of receiving electron density parameters for a patient<br>
volume developed from a patient-specific image generating device, determining current and<br>
previous electron density values for each of a plurality of depths along each separate one of a<br>
plurality of pencil beams, determining a separate depth dependent weight for each of the<br>
 <br>
plurality of depths, and determining a depth-dependent effective electron density for each of<br>
the plurality of depths to thereby form at least one table of off-axis dose parameters including<br>
representations of a plurality of regions of dose build-up and dose build-down. The step of<br>
determining with constant time computational complexity radiation dose for each of a<br>
plurality of points of interest in the complex medium can include the steps of determining for<br>
each of a plurality of points of interest a local density value, and retrieving the stored off-axis<br>
dose parameters responsive to the local electron density value for each of the plurality of<br>
points of interest.<br>
[00023] Embodiments the present invention also include methods of determining central<br>
axis dose in a media of varying electron density from a high-energy radiation-beam for<br>
radiation treatment. For example, the method can include the step of modeling a dose profile<br>
by performing the step of determining a difference between a current central axis dose and a<br>
central axis dose at previous depth traveling into a complex medium along a central axis of a<br>
pencil beam in proportion to a product of a difference between the central axis dose at<br>
previous depth and an equilibrium dose to a homogeneous medium having an electron<br>
density at a point of interest, and an electron density dependent proportionality constant that<br>
depends on the electron density at the point of interest, and determining the sum of the central<br>
axis dose at previous depth and the difference between the current central axis dose and the<br>
central axis dose at previous depth, to thereby form representations of a plurality of regions of<br>
dose build-up and dose build-down. The electron density-dependent proportionality constant<br>
can depend, e.g., linearly, on a ratio of electron density of the medium and an associated<br>
proportionality constant applied to a medium having properties substantially similar to that of<br>
water.<br>
[00024] Embodiments the present invention also include methods of determining an off-<br>
axis dose profile in heterogeneous media of varying electron density from a therapeutic high-<br>
energy radiation beam for radiation treatment. For example, the method can include the steps<br>
of receiving a central axis primary dose, receiving homogeneous medium off-axis primary<br>
dose profiles for a plurality of electron densities, and determining an off-axis primary dose<br>
profile for a region of a complex medium having an electron density varying with depth<br>
along a central axis of a pencil beam by forming a combination of homogeneous medium off-<br>
axis primary dose profiles equal the central axis primary dose, e.g., by forming a combination<br>
of homogeneous medium off-axis primary dose profiles weighted by values applied so that<br>
 <br>
penumbra implies central axis dose in agreement with that computed via a differential<br>
equation substantially centered about the central axis. The method can also include receiving<br>
a central axis scatter dose, receiving homogeneous medium off-axis scatter dose profiles for a<br>
plurality of densities, and determining an off-axis scatter dose profile for a region of a<br>
complex medium having an electron density varying with depth along a central axis of a<br>
pencil beam from off-axis properties of a homogeneous medium corresponding to an<br>
effective electron density selected so that central axis scatter dose of the determined<br>
homogeneous medium off-axis profile matches the received central axis scatter dose of the<br>
complex medium.<br>
[00025] Embodiments the present invention also include methods of determining dose in<br>
heterogeneous media of varying density from a therapeutic high-energy radiation-beam for<br>
radiation treatment. For example, the method can include the step of determining an off-axis<br>
dose profile for a pencil beam to a point of interest of a complex medium having an electron<br>
density distribution varying laterally at a depth of interest associated with the point of interest<br>
by using an off-axis dose profile of the pencil beam at a depth and an off-axis position of<br>
interest corresponding to the electron density distribution substantially equal to that of a local<br>
electron density distribution near the point of interest.<br>
[00026] According to another embodiment of the method, the method can include the step<br>
of determining for a preselected size pencil beam, a central axis primary dose in a<br>
homogeneous medium of arbitrary electron density from a central axis primary dose model<br>
for water equivalent medium of an equivalent effective field size by rescaling a dose<br>
normalization factor and a linear attenuation and longitudinal buildup coefficients as a<br>
function of the arbitrary electron density. The method can also or alternatively include<br>
receiving a central axis scatter dose model representing central axis scatter dose as a function<br>
of field size and depth for water equivalent medium, determining a central axis scatter dose<br>
model representing central axis scatter dose as a function of field size and depth for a<br>
homogeneous medium of arbitrary electron density using an equivalent effective field size<br>
responsive to the received scatter dose model, and determining at least one scatter volume for<br>
a homogeneous medium of arbitrary electron density by performing a modified Clarkson<br>
integration utilizing the determined central axis scatter dose model of the homogeneous<br>
medium of arbitrary electron density in the integration to derive the scatter volume..<br>
 <br>
[00027] Embodiments the present invention also include a computer readable medium<br>
including instructions mat when executed by a computer such as, for example, the radiation<br>
treatment planning computer, can perform the necessary steps to develop a model for<br>
determining dose in a media of varying electron density from a high-energy radiation-beam<br>
for radiation treatment. For example, an embodiment of a computer readable medium can<br>
include instructions to perform the operations of predetermining a delivery machine-<br>
dependent representation of radiation dose for a plurality of different electron densities<br>
selected over a preselected representative range, predetermining for each of a plurality of<br>
pencil beams a depth-dependent representation of central axis properties of a pencil beam<br>
passing through a complex medium having a complex spatial distribution of heterogeneous<br>
election densities, and determining with constant time computational complexity radiation<br>
dose for each of a plurality of points of interest in the complex medium by applying the<br>
predetermined machine-dependent and depth-dependent representations.<br>
[00028] The operation of predetermining a delivery machine-dependent representation of<br>
radiation dose can include the operations of determining an at least two-dimensional primary<br>
dose profile for each of the plurality of different electron densities and an at least two-<br>
dimensional scatter dose profile for at least a representative portion of the plurality of<br>
different electron densities.<br>
(00029) The operation of predetermining a depth dependent representation of central axis<br>
properties of a pencil beam passing through a complex medium for each of a plurality of<br>
pencil beams can include the operation of determining a depth-dependent weighted value to<br>
form a weight for a primary dose profile for a point at a current electron density at a current<br>
depth and a weight for at least one dose profile for a corresponding at least one point at a<br>
previous electron density at a previous depth so that when the weighted values are applied to<br>
a linear combination of the dose profiles a resulting dose profile provides a value<br>
substantially equal to a convoluted value of central axis primary dose at the current depth<br>
when a point of interest applied to the linear combination at the current depth is on the central<br>
axis. It can also include the operation of determining an effective election density to apply to<br>
a scatter dose profile that when applied provides a value substantially equal to a convoluted<br>
value of central axis scatter dose at the current depth when a point of interest applied to the<br>
scatter dose profile at the current electron density at the current depth is on the central axis.<br>
 <br>
(00030] The operation of determining with constant time computational complexity<br>
radiation dose for each of a plurality of points of interest in a complex medium can include<br>
the operations of determining for each of a plurality of points of interest a local electron<br>
density value, and accessing or retrieving predetermined off-axis properties corresponding to<br>
a homogeneous density having a value derived from the respective local electron density<br>
value associated with each point of interest responsive to the respective local electron density<br>
value for each respective one of the plurality of points of interest and a pencil beam intensity<br>
for each associated pencil beam directed through each respective one of the plurality of points<br>
of interest to thereby determine radiation dose for each of the plurality of points of interest.<br>
[00031] An embodiment of the computer readable medium can include instructions to<br>
perform the operation of modeling a dose profile by performing the step of determining a<br>
differential change to central axis dose traveling into a complex medium along a central axis<br>
of a pencil beam in proportion to a product of a difference between a current central axis dose<br>
and a dose to homogeneous medium having an electron density at a point of interest and an<br>
electron density dependent proportionality constant that depends on the electron density at the<br>
point of interest to thereby form representations of a plurality of regions of dose build-up and<br>
dose build-down.<br>
[00032] An embodiment of the computer readable medium can include instructions to<br>
perform the operations of receiving a central axis primary dose, receiving homogeneous<br>
medium off-axis primary dose profiles for a plurality of electron densities, and determining<br>
an off-axis primary dose profile for a region of a complex medium having an electron density<br>
varying with depth along a central axis of a pencil beam by forming a linear combination of<br>
the homogeneous medium dose profiles weighted by values applied so that penumbra implies<br>
a central axis dose agreeing with central axis dose computed via a differential equation, e.g.,<br>
the center of the determined off-axis primary dose profile has primary dose substantially<br>
equal to the perceived central axis primary dose. The operations can also or alternatively<br>
include the steps of receiving a central axis scatter dose, receiving homogeneous medium off-<br>
axis scatter dose profiles for a plurality of densities, determining an off-axis scatter dose<br>
profile for a region of a complex medium having an electron density varying with depth<br>
along a central axis of a pencil beam from off axis properties of a homogeneous medium<br>
having an effective electron density selected so that central axis scatter dose in the<br>
 <br>
determined homogeneous medium off-axis profile substantially matches the received central<br>
axis scatter dose of the complex medium.<br>
[00033] An embodiment of the computer readable medium can include instructions to<br>
perform the operation of determining an off-axis dose profile for a pencil beam to a point of<br>
interest of a complex medium having an electron density distribution varying laterally at a<br>
depth of interest associated with the point of interest by using an off-axis dose profile of the<br>
pencil beam at the depth of interest corresponding to the electron density distribution<br>
substantially equal to that of a local electron density distribution near the point of interest.<br>
{00034] An embodiment of the computer readable medium can include instructions to<br>
perform the operations of determining for a preselected size pencil beam, acentral axis<br>
primary dose in a homogeneous medium of arbitrary electron density from a central axis<br>
primary dose model for water equivalent medium of an equivalent effective field size by<br>
rescaling a dose normalization factor and a linear attenuation and longitudinal buildup<br>
coefficients as a function of the arbitrary electron density; and determining for a preselected<br>
size pencil beam, a central axis scatter dose in a homogeneous medium from a central axis<br>
scatter dose model for water equivalent medium of an equivalent effective field size by using<br>
density-scaled scatter dose values.<br>
[00035] Advantageously, embodiments of the present invention preserve the pencil beam<br>
model due to its computational efficiency, but at the same time, generalize it in such a way<br>
that it can effectively deal with electronic disequilibrium in circumstances where the electron<br>
density varies from voxel to voxel, from point to point, in a grid of step of a few millimeters,<br>
e.g., typically 1-5 mm. To minimize the number of additional computations necessary to<br>
account for electronic disequilibrium, embodiments of the present invention provide for<br>
storing a plurality of arrays corresponding to the CAX primary dose of each FSPB and<br>
various profiles, which can be retrieved and employed to determine primary and/or total dose<br>
at each point of interest for evaluating dose.<br>
[00036] Advantageously, according to an embodiment of the present invention, to utilize<br>
the enhanced FSPB model, a set of photon beam data in water can be acquired in order to<br>
parameterize die model for unit density. Separation of scatter and primary dose in water can<br>
be performed similar to that done in the traditional model. For the central axis primary and<br>
scatter dose, a set of equations can be solved and the results stored for each pencil beam<br>
 <br>
involved in the radiation treatment plan. Profiles can be calculated and stored for a set of<br>
electron densities and then retrieved depending on the local electron density of the point of<br>
interest or a nearby point or distribution of points. Each FSPB can then be composed and<br>
superimposed with other FSPBs in order to evaluate the dose at the point of interest. Further,<br>
due to physical and mathematical similarities, the method and model can also be<br>
advantageously applied to the calculation of neutron dose in heterogeneous media along with<br>
otiier forms of energy.<br>
BRIEF DESCRIPTION OF THE DRAWINGS<br>
[000371 So that the manner in which the features and advantages of the invention, as well<br>
as others which will become apparent, may be understood in more detail, a more particular<br>
description of the invention briefly summarized above may be had by reference to the<br>
embodiments thereof which are illustrated in the appended drawings, which form a part of<br>
this specification. It is to be noted, however, that the drawings illustrate only various<br>
embodiments of the invention and are therefore not to be considered limiting of the<br>
invention's scope as it may include other effective embodiments as well.<br>
[00038] FIG. 1 is a schematic diagram of a system to determine dose in heterogeneous<br>
media of varying density from a therapeutic high-energy radiation-beam for radiation<br>
treatment according to an embodiment of the present invention;<br>
[00039] FIG. 2 is a schematic diagram illustrating the qualitative behavior of CAX primary<br>
dose in homogenous material without any interface, primary dose profile, scatter dose and<br>
primary fluence;<br>
[00040] FIG. 3 is a schematic diagram illustrating modeling of a square pencil beam of<br>
width a using an equivalent radius (r);<br>
[00041] FIG. 4 is a schematic diagram illustrating the calculation of scatter dose for a point<br>
outside a radiation beamlet;<br>
[000421 FIGS. 5 and 6 are graph diagrams illustrating a comparison between calculated<br>
dose using the traditional pencil beam model and a calculated dose provided by a Monte<br>
Carlo simulation for a 3x3 cm filed in a phantom having alternating 2cm layers of water and<br>
lung;<br>
 <br>
[00043] FIG. 7 is a graph diagram illustrating a comparison between calculated dose using<br>
the traditional pencil beam model and a calculated dose provided by a Monte Carlo<br>
simulation for a 10x15 mm field in real lung as derived from a patient's CT scan;<br>
[00044] FIGS. 8 and 9 are graph diagrams illustrating a comparison between calculated<br>
dose using the enhanced pencil beam model and a calculated dose provided by a Monte Carlo<br>
simulation for the 3x3 cm filed in a phantom having alternating layers of water and lung,<br>
according to an embodiment of the present invention;<br>
[00045] FIG. 10 is a graph diagram illustrating comparison between calculated dose using<br>
the enhanced pencil beam model and a calculated dose provided by a Monte Carlo simulation<br>
for a 10x15 mm field in lung, according to an embodiment of the present invention;<br>
[00046] FIG. 11 is a graph diagram illustrating the behavior of the central axis (CAX)<br>
equilibrium primary dose (also referred to as equilibrium dose to a homogeneous medium<br>
having the same density) for a narrow 6 MV photon beam which is incident on a layered<br>
medium composed of water-like, lung-like and again water-like materials, each 10 cm thick.<br>
[00047] FIG. 12 is a graph diagram illustrating the linear attenuation coefficient as a<br>
function of the density as derived from a Monte Carlo simulation with the Electron Gamma<br>
Shower Monte Carlo simulation package by the National Research Council in Canada<br>
(EGSNRC) and PEREGRINE®;<br>
[00048] FIG. 13 is graph diagram illustrating the lateral buildup coefficient as a function of<br>
the density as derived from a Monte Carlo simulation with EGSNRC and PEREGRINE®;<br>
[00049] FIG. 14 is a graph diagram illustrating the results of a modeling of primary dose<br>
for an alternating water-lung slab phantom with thickness 4 cm for a 6 MV x-rays beam of<br>
radius 0.25 cm according to an embodiment of the present invention where MC indicates<br>
Monte Carlo simulation with EGSNRC;<br>
[00050] FIG. 15 is a graph diagram illustrating the results of a modeling of primary dose<br>
for an alternating slab geometry, but with thickness 2 cm, for a 6 MV x-rays beam of radius<br>
0.25 cm according to an embodiment of the present invention where MC indicates Monte<br>
Carlo simulation with EGSNRC;<br>
[00051] FIG. 16 is a graph diagram illustrating a comparison of primary dose calculated<br>
using PEREGRINE® Monte Carlo (MC), effective path-length (EPL), and the enhanced<br>
 <br>
pencil beam model for a 0.5 cm by 0.5 cm 6 MV x-ray FSPB traversing a patient according to<br>
an embodiment of the present invention;<br>
[00052] FIG. 17 is a graph diagram illustrating a semi-slab phantom composed of water<br>
and lung with a 7 cm by 7 cm 6 MV x-ray beam incident from the left according to an<br>
embodiment of the present invention;<br>
[00053] FIG. 18 is a graph diagram illustrating a comparison between total dose calculated<br>
using Monte Carlo, effective path-length, and the new FSPB model for the two density semi-<br>
slab phantom shown in FIG. 17;<br>
[00054] FIG. 19 is a schematic diagram illustrating a workflow to determine dose in media<br>
of varying density from a high-energy radiation-beam for radiation treatment according to an<br>
embodiment of the present invention;<br>
[00055] FIGS. 20A-24 are schematic and graphic illustrations illustrating the agreement<br>
between the new model and Monte Carlo; and<br>
100056] FIG. 25 is a graph illustration of a comparison of central dose volume histograms<br>
from intensity modulated radiation therapy optimization using the traditional model and the<br>
new model according to an embodiment of the present invention.<br>
DETAILED DESCRIPTION<br>
[00057] The present invention will now be described more fully hereinafter with reference<br>
to the accompanying drawings, which illustrate embodiments of the invention. The present<br>
invention may, however, be embodied in many different forms and should not be construed<br>
as limited to the illustrated embodiments set forth herein. Rather, these embodiments are<br>
provided so that this disclosure will be thorough and complete, and will fully convey the<br>
scope of the invention to those skilled in the art. Like numbers refer to like elements<br>
throughout. Prime notation, if used, indicates similar elements, in alternative embodiments.<br>
[000581 As shown in FIGS. 1-25, embodiments of the present invention include systems<br>
and methods for determining dose in heterogeneous media of varying density from a<br>
therapeutic high-energy radiation-beam for radiation treatment For example, as shown in<br>
FIG. 1, a system 30 can include a radiation treatment planning computer 31 having memory<br>
33, a processor 35 in communication with the memory 33, and radiation treatment planning<br>
program product 37 stored at least partially in the memory 33 and adapted to produce an<br>
<br>
 <br>
optimized radiation treatment plan for delivering radiation to the tumor target volume. The<br>
system also includes an image gathering device 41, e.g., computed tomography (CT) scanner<br>
or other imaging device known to those skilled in the art, accessible to a communication<br>
network 43 to provide stacks of two-dimensional image slices or a three-dimensional image<br>
of a tumor target volume and an adjacent structure volume in a patient or phantom used to<br>
develop the treatment plan. The system 30 further includes a radiation beam source 45, e.g.,<br>
linear accelerator or other delivery device known to those skilled in the art, to deliver<br>
radiation to the tumor target according to the radiation treatment plan. The radiation can be<br>
in the form of photons, neutrons, electrons, protons, or other particles. According to the<br>
exemplary embodiment of the present invention, the following description will concentrate<br>
mostly on high-energy photon beams, which can originate in man-made sources such as the<br>
linear accelerator as x-rays or can be generated in the nucleus of certain elements such as<br>
Cobalt-60 as gamma rays.<br>
[00059] According to an embodiment of the system 30, the memory 33 can include volatile<br>
and nonvolatile memory known to those skilled in the art including, for example, RAM,<br>
ROM, and magnetic or optical disks, just to name a few. The radiation treatment planning<br>
program product 37 can be a stand-alone product or an add-on module or other software or<br>
program product element forming a portion of a larger treatment planning system such as, for<br>
example, the Corvus treatment planning system available through Nomos Corporation,<br>
Cranberry Township, PA, assignee of the present invention, or others known to those skilled<br>
in the art The program product 37 can be in the form of microcode, programs, routines, and<br>
symbolic languages that provide a specific set or sets of ordered operations that control the<br>
functioning of the hardware and direct its operation, as known and understood by those<br>
skilled in the art. Similarly, the radiation treatment planning computer 31, image gathering<br>
device 41, and radiation beam source 45, or combination thereof, can be embodied in a single<br>
apparatus within the same housing or in separate housings.<br>
[00060] Embodiments of the present invention also include methods employed by the<br>
system 30 which includes pre-, during-, and post-radiation treatment planning steps for<br>
operations that implement the use of fields partitioned into many small, normally rectangular<br>
or square shaped fields, which are generically referred to as finite-size pencil beams (FSPB)<br>
or pencil beams, for short, which can be readily modeled in the form of cylinders having a<br>
given radius. FSPBs can allow for optimal partitioning of the radiation field and they are<br>
 <br>
computationally efficient for calculating dose distributions of complex modulated fields.<br>
FSPBs have some significant fundamental advantages. For example, FSPBs can be used to<br>
calculate dose to any single point (as specified a posteriori) much more rapidly than an entire<br>
patient volume (not true for Monte Carlo or superposition/convolution). This can be critical<br>
for intensity modulated radiation therapy (1MRT), as they can enable real-time dose<br>
manipulation, where thousands of pencil beams may need to be pre-computed for a regular<br>
treatment plan. That is, once the parameters for the pencil beams are computed, their<br>
intensities can be iteratively modulated, determining each point of interest at a constant time<br>
computational complexity, until the optimal dose distribution is achieved. See glossary, table<br>
1	at para. [00103] for various terminology used herein. See also reference publications, table<br>
2	at para. [00104] each incorporated by reference in its entirety.<br>
[00061 ] An advantage of constant time complexity per point of interest is that if the dose at<br>
any spot or point is desired after changing a pencil-beam intensity in the optimization loop,<br>
the "answer" in compute time can be obtained on the order of a table lookup (CXI))- By<br>
contrast, if a full 3d convolution is required, each time a pencil-beam intensity changes, one<br>
would need to wait a much more significant amount of time to obtain an entire 3D volume to<br>
derive that one result. In computer science, 'big O1 notation referring to the asymptotic upper<br>
bound, is frequently used to compare the performance of various algorithms without regard to<br>
specific implementation (Cortnen et al., p. 26). Convolution, as most efficiently implemented<br>
using the fast fourier transform, has computational complexity O(n Ig n) where "n" is the size<br>
of the vectors being convolved and Mg' represents a logarithm with undisclosed base. Full 3d<br>
convolution, as applied to calculate dose for a Cartesian grid with N element on each side<br>
(having a total of N3 elements) for a single divergent beam of radiation, has computational<br>
complexity O( N3 Ig N ) (Ahnesjo "Collapsed Cone", p. 587). Various methods are known to<br>
improve this bound for the purpose of computing the entire 3D dose volume. The method<br>
according to an embodiment of the present invention, however, is significantly differentiated<br>
over that of the prior methodologies by beneficially providing dose to a single point from a<br>
single pencil-beam in O(l) time (without a priori knowledge regarding the location of the<br>
single point). Importantly, this can be employed to quickly update dose in the optimization<br>
loop and also to quickly compute dose to specific 2d planes of calculation without requiring<br>
an entire 3d calculation.<br>
 <br>
[00062] From a computational point of view, the FSPB value calculation parameters and/or<br>
dose values for each pencil beam can be stored in one or more tables and a table lookup<br>
method can be used to enhance computational efficiency. Pencil beams also have other<br>
advantages including the implementation of dose shaping and histogram manipulation<br>
techniques that allow for quick and user controlled interactive changes in treatment plans that<br>
may further improve their quality.<br>
[00063] The FSPB data table can include central axis (CAX) equilibrium primary dose,<br>
primary dose profile, scatter dose, and the primary fluence profile. Primary dose is the<br>
amount of energy per unit mass deposited in matter as a result of the frrst interaction of a<br>
photon, scatter dose is the amount of dose deposited due to scattered photons, and primary<br>
fluence is the number of photons per unit area incident in the material. FIG- 2 illustrates the<br>
qualitative behavior of CAX primary dose, primary dose profile, scatter dose and primary<br>
fluence.<br>
[00064] Dose at a point of interest i in an FSPB for water-like medium can be determined<br>
using various methodologies known to those skilled in the art. According to one particular<br>
methodology, for example, the dose at point / in an FSPB of equivalent radius r is calculated<br>
using the following expression:<br>
D,{R,d) = ISC ■ F{R) • [Px(d) ■ £(r) • N(R,d) + S(R,d)],<br>
where ISC is the inverse square correction factor that accounts for beam divergence. The<br>
depth of i in the FSPB (d) and off-axis distance (R) are used to retrieve the CAX primary<br>
dose, primary profile, scatter and primary fluence as in Nizin "Phenomenological Dose<br>
Model for Therapeutic Photon Beams: Basic Concepts and Definitions," Med. Phys. 26, p.<br>
1893 (1999). The term P,(d) in this example represents equilibrium primary dose which<br>
includes dose build-up only at the interface between air and the patient skin (or the phantom)<br>
and a corresponding exponential decay of photon fluence, and can be determined using the<br>
following expression:<br>
P,(d) = J» [1 - exp(-/3tl)]exp(-fjd),<br>
where Po is a normalization factor, ft is the linear attenuation coefficient, and fi is the<br>
longitudinal build-up coefficient for water. The equilibrium factor E(r), describing<br>
radiological penumbra, is field-size dependent due to electronic transport and should reflect<br>
 <br>
electronic disequilibrium. According to this example, it is modeled using the following<br>
expression: <br>
where y is the lateral build-up coefficient and T is the effective radius of the beam.<br>
[00065] In this example, the equivalent radius is r=0.561a where a is the side width of a<br>
square pencil beam. As perhaps best shown in FIG. 3, an equivalent radius r can be used to<br>
model a square or rectangular pencil beam.<br>
[00066] An objective of the optimization procedure can include obtaining a set of<br>
transmission factors to form a transmission map that optimizes the dose distribution giving a<br>
set of constraints. The total dose in a generic boam can be calculated as a superposition of<br>
pencil beams weighted by the intensity (transmission) factors Ti as:<br>
 <br>
{00067] The properties of the radiation beam depend on the photon energy, characteristics<br>
of the machine, and the medium where radiation is absorbed. Regularly, measurements are<br>
performed in water for each machine, since some of the parameters of the model will be<br>
machine dependent. Absorbed dose in the central axis can be measured for a series of beam<br>
sizes and a primary-scatter dose separation can be performed using, for example, the<br>
z~rd/(r+d) function whereby d is depth and r is the beam radius as in BjSrngard, et al, in<br>
"Description of the Scatter Component in Photon-Beams," Med. Phys. 33, 21 (1988). Further<br>
profile measurements can be taken and from there, FSPB parameters can be determined.<br>
According to one model ("Corvus 6.3, Beam Utilities User's Manual", p. A1-A38), dose can<br>
be separated as: <br>
where r represents the radius of a circular field having equivalent central axis properties as in<br>
Bjamgard, et al, in "A Note on Equivalent Circles, Squares, and Rectangles," Med. Phys. 9,<br>
258(1982).<br>
[00068] According to another model form, dose can be separated as:<br>
[00069] Regardless of the modeling form, from the primary dose, the linear attenuation<br>
coefficient p and the longitudinal build-up coefficient p can be extracted. Similarly, the<br>
<br>
 <br>
value of the lateral build-up coefficient pcan be calculated using an analytical relationship<br>
between ft and y. The scatter data can be stored in the form of, for example, three-<br>
dimensional tables.<br>
[00070] Due to radiation transport and source and collimator design, profiles are not<br>
perfectly sharp, i.e., they are not step-like, but there is a penumbra. Primary radiation<br>
penumbra is usually separated into geometric penumbra and radiological penumbra.<br>
Geometric penumbra is caused by the finite size of the photon source and the presence and<br>
characteristics of the collimators. Radiological penumbra is caused by radiation transport.<br>
Geometric penumbra can be modeled using Gaussian functions, while radiological penumbra<br>
can be described by the function exp(—y • r)l r.<br>
[00071] The total primary dose profile is the convolution of geometric and radiological<br>
penumbra, and the physical aperture of the beamlet (Rect), and can be modeled using the<br>
following expression:<br>
e<br>
l<br>
e<br>
 a<br>
[00072] Scatter profiles can be calculated using, for example, Clarkson (sector) integration<br>
as described for water in "Corvus 6.3, User's Manual", p A1-A38. FIG. 4 illustrates the<br>
calculation of scatter dose for a point outside the beamlet (Rb) illustrated as a 2a by 2b<br>
rectangle, using the equation:<br>
 <br>
 <br>
[00074] The model described above is generally adequate for homogeneous water-like<br>
systems, but complex media such as, for example, the human body is made of muscle; fat<br>
which are more or less water equivalent; bone which is about two times more dense than<br>
water; lung which is of a variable density, approximately four times less than that of water,<br>
and other tissue, etc. Thus, in order to obtain an accurate dose calculation, heterogeneity<br>
corrections need to be included. Traditional FSPB models, however, include only radiological<br>
path-length corrections, which amount to calculating an effective depth that includes<br>
variations of the density. The effective depth (or effective path length (EPL)) can be<br>
described by the following equation:<br>
 <br>
where pt is the electron density having unit value for water and where d represents the depth<br>
of interest.<br>
[00075] Once calculated, the effective depth dt£ can be used to evaluate central axis dose at<br>
the effective depth by substituting d with deg-. According to this model, total dose can be<br>
described by the following equation:<br>
 <br>
 <br>
(l-exp(-/3/))exp(-//rf). which models in a single build-up/build-down,<br>
and<br>
N(x,y) = Rect(x/w.y/h)++Radiological(r)++ Geometric(r), which models the<br>
penumbra, where Radiological(r)=(-/2v)»exp(-y)/r, and where both Radiological(r) and<br>
Geometric(r) integrate to unity.<br>
[00076] It has been documented that these corrections are insufficient, particularly for low<br>
density regions such as the lung. The reason is that this correction neglects a phenomenon<br>
called electronic disequilibrium which arises when more radiation is scattered away from the<br>
region of interest than the one incoming from adjacent regions. Discrepancies between<br>
measured and calculated dose values using radiological path-length corrections can be quite<br>
large, especially for small fields/higher energies. To account for the electronic<br>
disequilibrium, embodiments of the present invention preserve the pencil beam model due to<br>
its computational efficiency, but at the same time, generalize it in such a way that it can<br>
effectively deal with electronic disequilibrium in circumstances where the density varies from<br>
voxel to voxel, from point to point, in a grid of step of a few millimeters, e.g., typically 1-5<br>
mm. Particularly, embodiments of the system 30 and methods account for reduced actual<br>
dose and wider penumbra resulting from lateral electronic disequilibrium, account for dose<br>
build-up and dose build-down due to the complex electron density distribution of the human<br>
body, and lateral heterogeneities or account for variations in electron density across the beam<br>
front, to thereby provide enhanced accuracy for determining dose delivered to a patient.<br>
[00077] Lateral disequilibrium, most prominent for small beam fields, low electron density<br>
media, and high delivery energy, results when there are an unequal number of charged<br>
particles entering and exiting a region on the central axis of the pencil beam. FIGS. 5 and 6<br>
illustrate a comparison between calculated dose (dose plot 71) using the traditional pencil<br>
beam model, described above, and a calculated dose (dose plot 73) provided by a Monte<br>
Carlo simulation for a 3x3 cm field in a phantom having alternating layers of water and lung.<br>
FIG. 7 illustrates a comparison between calculated dose (dose plot 75) using the traditional<br>
pencil beam model and a calculated dose (dose plot 77) provided by a Monte Carlo<br>
simulation for a 10x15 mm field in lung. Embodiments of the system 30 and methods<br>
include determining central axis primary dose for each pencil beam having a field size r in a<br>
medium having an electron density p from a central axis primary dose model for water<br>
equivalent medium of an equivalent effective field size p.r, i.e., r'~p.r. According to an<br>
 <br>
embodiment of the system 30 and method, this can include determining central axis primary<br>
dose by modifying a two-dimensional radiological kernel representing electron transport so<br>
that a central axis dose implied by the kernel is substantially equivalent to a central axis dose<br>
in water of an equivalent pencil beam field size substantially equal to a desired field size<br>
multiplied by a ratio of electron density of the homogeneous medium to electron density of<br>
water such that:<br>
 <br>
where NB(x,y) is referred to interchangeably as a two-dimensional primary dose profile or<br>
penumbra, Radiological'p(r} represents a kernel ecuation, and ** refers to a two-dimensional<br>
convolution.<br>
(00078| Similarly, embodiments of the system 30 and methods include determining a<br>
central axis scatter dose for each pencil beam having a field size r in a medium having an<br>
electron density p from a central axis scatter dose model for water equivalent medium of an<br>
equivalent effective field size p.r. According to an embodiment of the system 30 and<br>
method, this can include performing a modified Clarkson integration whereby central axis<br>
dose in the medium is derived from the central axis dose of water for an equivalent field size<br>
p.r equal to the field size of the pencil beam multiplied by a ratio of an electron density of the<br>
medium to an electron density of water such that:<br>
 <br>
J00079] FIGS. 8 and 9 illustrate a comparison between calculated dose (dose plot 81) using<br>
the enhanced pencil beam model, described above, and a calculated dose (dose plot 73)<br>
provided by a Monte Carlo simulation for the 3x3 cm field in a phantom having alternating<br>
layers of water and lung. FIG. 10 illustrates a comparison between calculated dose (dose plot<br>
85) using the enhanced pencil beam model and a calculated dose (dose plot 77) provided by a<br>
Monte Carlo simulation for a 10x15 mm field in lung. A more detailed description follows of<br>
the modeling, particularly with respect to lateral disequilibrium. As will be described later,<br>
the Nffx,y) and S/Jx,y,d) profiles can be stored, for example, in three-dimensional primary<br>
and scatter tables, respectively, for each of a representative plurality of densities to formulate<br>
a machine-specific portion of the model.<br>
 <br>
[00080] In a more specific model, according to an embodiment of the present invention, the<br>
parameters the linear attenuation coefficient p, the longitudinal build-up coefficient /3, and<br>
the lateral build-up coefficient y are material and beam energy, i.e., beam quality, dependent<br>
Moving from one medium to another, the equilibrium factor E(r), described previously,<br>
varies depending on the beam radius and the next medium's lateral build-up coefficient y,<br>
which is inversely proportional to the electron range, which is the average distance traveled<br>
by an electron after interacting with a primary photon. FIG. 11 illustrates the behavior of the<br>
central axis (CAX) equilibrium primary dose for a narrow 6 MV photon beam which is<br>
incident on a layered medium composed of water-like, lung-like and again water-like<br>
materials, each 10 cm thick. This equilibrium factor is like primary dose, but does not<br>
smoothly build-up and build-down around interfac si-.. It instead takes the value that would be<br>
appropriate given no interface. The factor is useful in calculating primary dose. It can be<br>
seen that the density of the material effects dose. Thus, the parameters of the model should<br>
be rescaled based on the density of the medium.<br>
[00081] As described above, the beam radius r in the CAX primary dose equation is<br>
replaced with an effective radius equal to the beam radius times the density of the medium at<br>
a given point. The initial parameterization of the model can be performed foT a homogeneous<br>
medium, in particular, for water, so that all densities can be given relative to water. In<br>
particular, the linear attenuation coefficient M »the longitudinal build-up coefficient 0, and<br>
the lateral build-up coefficient y can be Tescaled in direct proportionality to the density. So<br>
for an arbitrary density p at depth d, the effective beam radius r can be replaced by pr such<br>
that:<br>
 <br>
where the subscript 0 corresponds to water, and water's density is taken as unity. The<br>
longitudinal build-up coefficient 0 has a substantial dependence on field size, especially for<br>
narrow beams. The scalability of the parameterization as a function of the density has been<br>
verified using Monte Carlo simulations, as illustrated in FIGS- 12 and 13. FIG. 12 illustrates<br>
the linear attenuation coefficient fi as a function of the density. FIG. 13 illustrates the lateral<br>
build-up coefficient y as a function of the density.<br>
 <br>
[00082] According to this particular methodology, the dose at point / can be calculated, for<br>
example, using the following expression:<br>
 <br>
[00083] Because of the linearity of ft and /? with the density, the behavior of central axis<br>
primary dose can be calculated using the equation:<br>
 <br>
where /Jo is the linear attenuation coefficient for primary radiation in water and dtjf is the<br>
radiological depth, described previously. The normalization factor P0(r,d) which performs<br>
the same function as Radiologicalp(r), described previously, can be modeled by the equation:<br>
 <br>
where P^ is a global normalization factor. This parameterization is as accurate for water as<br>
that provided by the traditional pencil beam model, but more accurate for low density regions<br>
such as in lung by accounting for reduced actual dose and wider penumbra resulting from<br>
lateral electronic disequilibrium.<br>
[00084] Similarly, central axis scatter dose for water-like media can be parameterized as:<br>
 <br>
where S^^f) is a scatter dose surface term, £[)(»*) is a normalization factor, and S{r) is a<br>
scatter build-up coefficient that are each field-size dependent. This approximation works<br>
well due to the slow variations on scatter with position.<br>
[00085] As noted previously, the traditional pencil beam model also does not account for<br>
multiple dose build-up and dose build-down due to the complex electron density<br>
distribution/continuous density changes of the human body. According to an embodiment of<br>
the system 30 and methods, the dose build-up and dose build-down regions in the depth-dose<br>
curve can be modeled via a central axis convoluting method by solving numerically the<br>
following differential equations:<br>
 <br>
 <br>
where Po(d)=Np(d)(O,O) is the equilibrium central axis primary dose for a point on the central<br>
axis at depth d\ and<br>
 <br>
where So(d)=SpW(0,0.d) is the equilibrium central axis scatter dose for a point on the central<br>
axis at depth d. The convoluted version of Pa(x) is /£(*) can be used to satisfy the<br>
differential equation dF£(x)/dx, and the convoluted version of SQ(x) is £%(x) can be used to<br>
satisfy the differential equation dS%(x)/dx.<br>
[00086] Where the beam field is being described with respect to a radius r, these equations<br>
can be modeled alternatively as:<br>
 <br>
respectively, that are due to the rapid variations in density with the medium dependent dose<br>
build-up and dose build-down processes. Here x denotes depth, Po(*,/■) and S0(x,r) are the<br>
convoluted values of the normalization factor for primary and scatter dose, respectively, and<br>
/3(x) and y(x) are the position dependent build-up coefficients. The convoluted version of<br>
^JW is IQ(X) can be used to satisfy the differential equation dP£(pc)/dx, and the convoluted<br>
version of S0(x) is S^(pc) can be used to satisfy the differential equation dS£(x)/dx. Both<br>
sets of differential equations provide a generalized solution for modeling dose due to the<br>
multiple dose build-up and dose build-downs.<br>
[00087] In practice, however, the values for the density, typically estimated from the<br>
patient CT scans, tend to vary rapidly from voxel to voxel. As such, a discrete solution to the<br>
differential equations is preferable. The simplest solution to the discrete version of the<br>
differential equation dF^{x)/dx is given by<br>
 <br>
 <br>
<br>
where the weight w(d) is selected or otherwise determined by consistency so that the resulting<br>
dose profile provides a value substantially equal to a convoluted value of the central axis dose<br>
at the current or local depth when a point of interest applied to the linear combination at the<br>
current or local depth is on the central axis, i.e., weight w(d) can be selected so that fo(d)<br>
equals N(O.O.p); and where N p(d)(x,y) and N(x,y,d,p) represent the local profile and<br>
Np^drfx.y) and N(x,y,d,ppm)), represent the profile taken at the density of a previous depth,<br>
i.e., depth closer to the surface.<br>
[00092] Similarly, scatter profiles can be obtained in a similar fashion as that of the primary<br>
or by employing an effective density p'(d) in the following equation model:<br>
 <br>
where the effective density p'(d) is selected or otherwise determined by consistency so that<br>
the resulting scatter dose profile provides a value substantially equal to a convoluted value of<br>
the central axis scatter dose at the current or local depth when the point of interest is on the<br>
central axis, i.e., can be selected so that ff(d) equals S(0,0,d, p'(d)).<br>
[00093] According to an embodiment of the system 30 and methods, central axis primary<br>
and scatter dose for each FSPB is stored in database 61. According to another embodiment,<br>
central axis primary and scatter dose profiles for a plurality of densities and the ppm, (d), w(d),<br>
and p'(d) for each beam field to be used in the tieatment plan is stored in the database 61 (as<br>
shown in FIG. 19). In a clinical situation, every beamlet going through the patient will see a<br>
different distribution of densities, thus, each dose profile solution will be different. These<br>
values can be quickly pre-computed and stored for future use in one of the dose calculation<br>
equations.<br>
[00094] FIGS. 14-16 illustrate the application of enhanced pencil beam model for<br>
heterogeneous media. FIG. 14 illustrate the results of a modeling of primary dose for an<br>
alternating water-lung slab phantom with thickness 4 cm for a 6 MV x-rays beam of radius<br>
0.2S cm, whereby the dimensions involved allow the beam to achieve longitudinal electron<br>
equilibrium. FIG. IS shows the results of a modeling of primary dose for an alternating slab<br>
geometry, but with thickness 2 cm, for a 6 MV x-rays beam of radius 0.2S cm so that<br>
electronic equilibrium is almost never achieved. Finally, FIG. 16 presents a comparison of<br>
 <br>
primary dose calculated using Monte Carlo (MC), effective path-length (EPL), and the<br>
enhanced pencil beam model (Model) for a 0.5 cm by 0.5cm 6 MV x-ray FSPB traversing a<br>
patient. Note, the broader dips in dose correspond to lung regions. The agreement between<br>
the new model and Monte Carlo results is remarkable, while the traditional radiological path-<br>
length method grossly overestimates dose in lung regions.<br>
[00095] As noted previously, the traditional pencil beam model also does not account for<br>
variations in electron density across the beam front or lateral heterogeneities. The FSPBs can<br>
experience various regions in a complex medium, e.g., human body, where the electron<br>
density distribution varies laterally along a plane perpendicular to a depth of interest<br>
associated with a point of interest. FIG. 17 illustrates a semi-slab phantom composed of<br>
water (in black) and lung (in grey) with a 7 en. by 7 cm 6 MV x-ray beam is incident from<br>
the left. The isodose lines shown were calculated using Monte Carlo. According to the<br>
exemplary embodiment, the new model provides the enhanced accuracy by determining an<br>
off-axis dose profile for a pencil beam to a point of interest of the complex medium by using<br>
an off-axis dose profile of the pencil beam at the depth of interest corresponding to the<br>
electron density distribution substantially equal to that of a local electron density distribution<br>
near the point of interest. That is, the model can assume that the density distribution inside<br>
the beam field equals that of the density at or near the point of interest, to thereby enhance the<br>
modeling of the dose. FIG. 18 shows a comparison between total dose 91 calculated using<br>
Monte Carlo, traditional effective path-length (EPL), and new FSPB model according to an<br>
embodiment of the present invention for the two density semi-slab phantom shown in FIG.<br>
17. The calculations for the traditional effective path-length (EPL) model and new model<br>
were performed by superimposing 0.S cm by 0.5 cm FSPBs. FIG. 18 again illustrates the<br>
agreement between Monte Carlo and the new model and the significant differences between<br>
Monte Carlo and the traditional effective path length model.<br>
[00096] As perhaps best shown in FIG. 19, the system 30 and methods include performing<br>
a workflow to determine dose in heterogeneous media of varying density from a therapeutic<br>
high-energy radiation-beam for radiation treatment. Beneficially, the workflow can be<br>
applied to determine dose according to various planning-analytical methodologies including<br>
inverse planning, forward plan dose calculation, interactive dose calculation, and others.<br>
Also beneficially, the modeling of the parameters developed during the workflow can be<br>
applied to not only photons, but also electrons and protons. Also, due to physical and<br>
 <br>
mathematical similarities, the methods can also be applied to the calculation of neutron dose<br>
in heterogeneous media.<br>
[00097] The workflow generally includes performing the steps or operations of<br>
predetermining a delivery machine-dependent representation of radiation dose for a plurality<br>
of different electron densities selected over a preselected representative range (block 101),<br>
predetermining a depth-dependent representation of central axis properties of a pencil beam<br>
passing through a complex medium having a complex spatial distribution of heterogeneous<br>
electron densities for each of a plurality of pencil beams (block 103), and determining with<br>
constant time computational complexity radiation dose for each of a plurality of points of<br>
interest in the complex medium by applying the predetermined machine-dependent and<br>
depth-dependent representations (block 105).<br>
[00098] The step or operation of predetermining a delivery machine-dependent<br>
representation of radiation dose can include the steps of receiving a set of photon beam data<br>
for a water medium to thereby parameterize a dose model for unit density, parameterizing a<br>
machine-dependent dose model for unit density responsive to the set of photon beam data;<br>
determining a machine-dependent primary dose profile for each of a first set of a plurality of<br>
electron densities distributed through a preselected range of densities responsive to the dose<br>
model for unit density to provide off-axis data for the range of densities; and determining a<br>
machine-dependent scatter dose profile for each of a second set of a plurality of electron<br>
densities distributed through a preselected range of densities responsive to the dose model for<br>
unit density.<br>
[00099] According to the exemplary embodiment, the primary and scatter dose profiles are<br>
each at least a two-dimensional primary dose profile, but preferably a three or four<br>
dimensional primary dose profile and cover a representative portion of potential electron<br>
densities for a plurality of media. For example, tht; primary dose profile can be computed for<br>
a first set, e.g., 50 or so densities above that of water and below that of the maximum<br>
expected, and 50 or so densities below that of water and above the minimum expected. Also<br>
for example, the scatter dose profile can be computed for a second set, e.g., S or so densities<br>
above that of water and below that of the maximum expected, and 5 or so densities below that<br>
of water and above the minimum expected. To reduce the number of computations, and<br>
because scatter dose is less affected by density variations man primary dose, a lower number<br>
 <br>
of scatter dose densities can be selected. Note, the 100/10 density/media selection is by way<br>
of example and should not be considered limiting.<br>
[000100] The step or operation of parameterizing a machine-dependent dose model for unit<br>
density can include separating primary and scatter dose from a total dose equation applied to<br>
a water like medium and solving a set of equations, described previously. The step or<br>
operation of determining a machine-dependent primary dose profile can include forming a<br>
primary dose prof le table for each of the electron densities in the first set of electron<br>
densities in response to received data parameters, and forming a scatter dose profile table for<br>
each of the electron densities in the second set of electron densities in response to received<br>
data parameters. According to the exemplary embodiment, the data can be retrieved from the<br>
tables using the local density of a particular poin; of interest or density distribution adjacent<br>
the point of interest<br>
[000101] The step or operation of predetermining a depth dependent representation of<br>
central axis properties of a pencil beam passing through a complex medium for each of a<br>
plurality of pencil beams can include determining for each pencil beam a depth dependent<br>
weight factor w(d) for each of a plurality of depths along a central axis of the respective<br>
pencil beam. Each of the plurality of depths for each pencil beam has a density p at each<br>
depth generally determined from, for example, the CT scan. Each depth dependent weight<br>
factor w(d) can be applied to at least one function within an least two-dimensional density<br>
dependent primary dose profile associated with the depth of the respective point. Its value<br>
can be selected or otherwise determined so that when a point of interest is selected along the<br>
central axis of the respective pencil beam at the respective depth, the associated at least two-<br>
dimensional density dependent primary dose profile provides a value substantially equal to a<br>
convoluted value of central axis primary dose of the current depth when a point of interest<br>
applied to the linear combination at the current depth is on the central axis. The step or<br>
operation can also include determining a depth-dependent effective density p'(d) for each of<br>
the plurality of depths to apply to a scatter dose profile that, when applied, provides a dose<br>
value substantially equal to a convoluted value of central axis scatter dose when a point of<br>
interest applied to the scatter dose profile at the current density at the current depth is on the<br>
central axis. The w(d), p'(d), along with ppm (d) can be stored in look-up tables associated<br>
with each of the of pencil beams.<br>
 <br>
[000102] The step or operation of determining with constant time computational complexity<br>
radiation dose for each of a plurality of points of interest in a heterogeneous medium having a<br>
complex spatial distribution of heterogeneous electron densities can include determining for<br>
each of a plurality of points of interest a local electron density value. The local electron<br>
density value can be a single value of electron density associated with the point of interest or<br>
an electron density distribution associated with the point of interest. The step or operation<br>
can also include retrieving from a look-up table or otherwise accessing predetermined off-<br>
axis properties corresponding to a homogeneous density having a value derived from the<br>
respective local electron density value associated with each point of interest in response to the<br>
respective local electron density value for each respective one of the plurality of points of<br>
interest to thereby determine radiation dose for each of the plurality of points of interest. For<br>
inverse planning, for example, where the intensity of the FSPB is being modulated, the tables<br>
can also be accessed through a combination of density and pencil beam intensity for each<br>
associated pencil beam directed through each respective one of the plurality of points of<br>
interest. The step or operation can further include displaying and at least two-dimensional<br>
but preferably a three or four dimensional map of radiation dose delivered to the patient<br>
volume to allow a user to iteratively evaluate the total dose delivered to the patient volume.<br>
[000103] FIGS. 20A-24 illustrate the benefits of solving the problems of lateral<br>
disequilibrium, multiple dose build-up and build-down zones, and laterals heterogeneities and<br>
the agreement between the new FSPB model and Monte Carlo and its application during<br>
inverse planning as well as providing a final calculation in attaining an improved treatment<br>
plan. The new model provides nearly the accuracy of Monte Carlo, particularly in media<br>
having electron densities that very continuously, but with a constant time computational<br>
complexity, allowing for its use in performing multiple iterations of dose determinations.<br>
Further, FIG. 25 illustrates a comparison of central dose volume histograms from intensity<br>
modulated radiation therapy optimization (inverse planning) in along material using the new<br>
model vs. the traditional model, with the final dose being calculated using Monte Carlo.<br>
Referring to the target PTV curve 111, 113, for the new model and the traditional model,<br>
respectively, it can be seen that the new model enhances the ability to provide the target a<br>
higher minimum dose (improved coverage) and a lower maximum dose (improved<br>
homogeneity).<br>
 <br>
[000104] It is important to note that while embodiments of the present invention have been<br>
described in the context of a fully functional system, those skilled in the art will appreciate<br>
that the mechanism of the present invention and/or aspects thereof are capable of being<br>
distributed in the form of a computer readable medium of instructions in a variety of forms<br>
for execution on a processor, processors, or the like, and that the present invention applies<br>
equally regardless of the particular type of signal bearing media used to actually carry out the<br>
distribution. Examples of computer readable media include but are not limited to:<br>
nonvolatile, hard-coded type media such as read only memories (ROMs), CD-ROMs, and<br>
DVD-ROMs, or erasable, electrically programmable read only memories (EEPROMs),<br>
recordable type media such as floppy disks, hard disk drives, CD-R/RWs, DVD-RAMs,<br>
DVD-R/RWs, DVD+R/RWs, flash drives, and other newer types of memories, and<br>
transmission type media such as digital and analog communication links.<br>
[000105] For example, such media can include the radiation treatment planning program<br>
product 37 and operating instructions related to the method steps, described above. For<br>
example, the computer readable medium can include instructions that when executed, for<br>
example, by the processor 35, allow the computer 31 to perform the operations of<br>
predetermining a delivery machine-dependent representation of radiation dose for a plurality<br>
of different electron densities selected over a preselected representative range, and<br>
predetermining for each of a plurality of pencil beams a depth-dependent representation of<br>
central axis properties of a pencil beam passing through a complex medium having a complex<br>
spatial distribution of heterogeneous electron densities. The instructions can also include<br>
those to perform the operations of determining with constant time computational complexity<br>
radiation dose for each of a plurality of points of interest in the complex medium by applying<br>
the predetermined machine-dependent and depth-dependent representations, and producing a<br>
map of radiation dose delivered to the patient volume to allow a user to iteratively evaluate<br>
the total dose of the patient volume, according to the method and operation steps described in<br>
detail above.<br>
[000106] Embodiments of the present invention also provide a computer memory element<br>
containing, stored in signal bearing media, a database 61. The database 61 can include data<br>
in computer readable format indicating, for example, various parameters and primary and<br>
scatter dose models, depending upon which set of parameters of the model are used. For<br>
example, the data can include Nrfjrfx.y) for a first set of density values, S//x,y,d) for a second set<br>
 <br>
 <br>
<br>
 <br>
<br>
 <br>
<br>
apparent, however, that various modifications and changes can be made within the spirit and<br>
scope of the invention as described in the foregoing specification and as defined in the<br>
attached claims.<br>
 <br>
WE CLAIM:<br>
1. A method of determining dose in a media of varying electron density from a high-energy<br>
radiation-beam for radiation treatment, the method being characterized by the steps of:<br>
predetermining a delivery machine-dependent representation of radiation dose for a<br>
plurality of different homogeneous media, each having an electron density selected over a<br>
preselected representative range;<br>
predetermining a depth-dependent representation of central axis properties of a pencil<br>
beam passing through a complex medium having a complex spatial distribution of heterogeneous<br>
electron densities for each of a plurality of pencil beams; and<br>
determining with constant time computational complexity, radiation dose for each of a<br>
plurality of points of interest in the complex medium, by applying the predetermined machine-<br>
dependent and depth-dependent representations.<br>
2.	A method as defined in Claim 1, wherein the step of predetermining a delivery machine-<br>
dependent representation of radiation dose includes the steps of determining an at least two-<br>
dimensional primary dose profile for each of the plurality of different electron densities and an at<br>
least two-dimensional scatter dose profile for at least a representative portion of the plurality of<br>
different electron densities.<br>
3.	A method as defined in either of Claims 1 or 2, wherein the step of predetermining a<br>
depth dependent representation of central axis properties of a pencil beam passing through a<br>
complex medium for each of a plurality of pencil beams includes the steps of:<br>
determining a depth-dependent weighted value to form a weight for a primary dose<br>
profile for a point at a current electron density at a current depth and a weight for at least one<br>
dose profile for a corresponding at least one point at a previous electron density at a previous<br>
depth so that when the weighted values are applied to a linear combination of the dose profiles a<br>
resulting dose profile provides a value substantially equal to a computed value of central axis<br>
primary dose at the current depth when a point of interest applied to the linear combination at the<br>
current depth is on the central axis; and<br>
determining an effective electron density to apply to a scatter dose profile that when<br>
applied provides a value substantially equal to i computed value of central axis scatter dose at<br>
 <br>
the current depth when a point of interest applied to the scatter dose profile at the current electron<br>
density at the current depth is on the central axis.<br>
4.	A method as defined in any of Claims 1-3, wherein the step of determining with constant<br>
time computational complexity, radiation dose for each of a plurality of points of interest in the<br>
complex medium includes the steps of:<br>
determining for each of the plurality of points of interest at least one of the following: a<br>
value of electron density associated with the point of interest and an electron density distribution<br>
associated with the point of interest defining a local electron density value; and<br>
accessing predetermined off-axis propenies corresponding to a homogeneous electron<br>
density having a value derived from the respective local electron density value associated with<br>
each point of interest responsive to the respective local electron density value for each respective<br>
one of the plurality of points of interest and a pencil beam intensity for each associated pencil<br>
beam directed through each respective one of the plurality of points of interest to thereby<br>
determine radiation dose for each of the plurality of points of interest.<br>
5.	A method as defined in Claim 1,<br>
wherein the step of predetermining a delivery machine-dependent representation of<br>
radiation dose includes the step of determining n radiation dose profile for a plurality of media<br>
each having a different electron density, the electron densities selected over a representative<br>
range; and<br>
wherein the step of predetermining a depth dependent representation of central axis<br>
properties of a pencil beam passing through a complex medium for each of a plurality of pencil<br>
beams includes the steps of:<br>
determining for each of the plurality of pencil beams a depth dependent weight<br>
factor for each of a plurality of depths along a central axis of the respective pencil beam,<br>
each of the plurality of depths for each of the plurality of pencil beams having a<br>
determined electron density, each depth dependent weight factor to be applied to at least<br>
one function within an least two-dimensional electron density dependent primary dose<br>
profile associated with the depth of the respective point and having a value determined so<br>
that when a point of interest is selected along the central axis of the respective pencil<br>
 <br>
beam at the respective depth, the associated at least two-dimensional electron density<br>
dependent primary dose profile provides a value substantially equal to a convoluted value<br>
of central axis primary dose of the current depth when a point of interest applied to the<br>
linear combination at the current depth is on the central axis, and<br>
determining an effective electron density to apply to a scatter dose profile that<br>
when applied provides a value substantially equal to a convoluted value of central axis<br>
scatter dose when a point of interest applied to the scatter dose profile at the current<br>
electron density at the current depth is on the central axis.<br>
6. A method as defined in Claim 1,<br>
wherein the step of predetermining a delivery machine-dependent representation of<br>
radiation dose includes the steps of:<br>
receiving data parameters for a medium having properties substantially similar to<br>
that of water,<br>
forming a primary dose profile table for each of the plurality of electron densities<br>
responsive to the data parameters, and<br>
forming a scatter dose profile table for at least a representative portion of the<br>
plurality of electron densities;<br>
wherein the step of predetermining a depth dependent representation of central axis<br>
properties of a pencil beam passing through a complex medium for each of a piuraiity of pencil<br>
beams includes the steps of:<br>
receiving electron density parameters for a patient volume developed from a<br>
patient-specific image generating device (41),<br>
determining current and previous electron density values for each of a plurality of<br>
depths along each separate one of a plurality of pencil beams,<br>
determining a separate depth dependent weight w(d) for each of the plurality of<br>
depths, and<br>
determining a depth-dependent effective electron density p'(d) for each of the<br>
plurality of depths, to thereby form at least one table of off-axis dose parameters<br>
including representations of a plurality of regions of dose build-up and dose build-down;<br>
and<br>
 <br>
wherein the step of determining with constant time computational complexity radiation<br>
dose for each of a plurality of points of interest in (he complex medium includes the steps of:<br>
determining for each of a plurality of points of interest at least one of the<br>
following: a value of electron density associated with the point of interest and an electron<br>
density distribution associated with the point of interest, defining a local electron density<br>
value, and<br>
retrieving the stored off-axis dose parameters responsive to the local electron<br>
density value for each of the plurality of points of interest.<br>
7.	A method as defined in Claim 1, wherein the step of predetermining a depth dependent<br>
representation of central axis properties of a beam passing through a complex medium for each<br>
of a plurality of pencil beams includes the step of modeling a three-dimensional primary dose<br>
profile by:<br>
linearly combining two profiles, the first profile at a current electron density and the<br>
second profile at a previous electron density to form a model of a three-dimensional primary dose<br>
profile; and<br>
setting weighted values of each profile so that the model provides a convoluting value of<br>
the central axis primary dose when a point applied to the model at the current depth is on the<br>
central axis.<br>
8.	A method as defined in any of Claims 1-7, wherein the method is applied to enable at<br>
least one of the following: inverse planning, forward plan dose calculation, and interactive dose<br>
calculation.<br>
9.	A method as defined in any of Claims 1-8, wherein the high-energy radiation-beam<br>
includes one of the following: photons, electrons, neutrons, and protons.<br>
10.	A method as defined in Claim 1, wherein the step of predetermining for each of a<br>
plurality of pencil beams, a depth dependent representation of central axis properties of a beam<br>
passing through a complex medium includes for each of the plurality of pencil beams the step of<br>
modeling a dose profile by determining a differential change to central axis dose traveling into<br>
 <br>
the complex medium along the central axis of the respective pencil beam in proportion to a<br>
product of a difference between a current central axis dose and a dose to a homogeneous medium<br>
having an electron density at a point of interest and an electron density dependent proportionality<br>
constant that depends on the electron density at the point of interest to thereby form<br>
representations of a plurality of regions of dose build-up and dose build-down.<br>
11.	A method as defined in Claim 10,<br>
wherein the step of determining a differential change to central axis dose is applied to at<br>
least one of the following: primary dose and scatter dose; and<br>
wherein the electron density-dependent proportionality constant depends on a ratio of<br>
electron density of the medium and an associated proportionality constant applied to a medium<br>
having properties substantially similar to that of water.<br>
12.	A computer readable medium that is readable by a computer (31), the computer (31)<br>
readable medium comprising a set of instructions that, when executed by the computer (31),<br>
cause the computer (31) to perform the following operations being characterized by:<br>
predetermining a delivery machine-dependent representation of radiation dose for a<br>
plurality of different electron densities selected over a preselected representative range;<br>
predetermining for each of a plurality of pencil beams, a depth-dependent representation<br>
of central axis properties of a pencil beam passing through a complex medium having a complex<br>
spatial distribution of heterogeneous electron densities; and<br>
determining with constant time computational complexity, radiation dose for each of a<br>
plurality of points of interest in the complex medium by applying the predetermined machine-<br>
dependent and depth-dependent representations.<br>
13.	A computer readable medium as defined in Claim 12, wherein the operation of<br>
predetermining a delivery machine-dependent representation of radiation dose includes the<br>
operations of determining an at least two-dimensional primary dose profile for each of the<br>
plurality of different electron densities and an at least two-dimensional scatter dose profile for at<br>
least a representative portion of the plurality of different electron densities.<br>
 <br>
14.	A computer readable medium as defined in either of Claims 12 or 13, wherein the<br>
operation of predetermining for each of a plurality of pencil beams, a depth dependent<br>
representation of central axis properties of a pencil beam passing through a complex medium<br>
includes the operations of:<br>
determining a depth-dependent weighted value to form a weight for a primary dose<br>
profile for a point at a current electron density at a current depth and a weight for at least one<br>
dose profile for a corresponding at least one point at a previous electron density at a previous<br>
depth so that when the weighted values are applied to a linear combination of the dose profiles a<br>
resulting dose profile provides a value substantially equal to a convoluted value of central axis<br>
primary dose at the current depth when a point of interest applied to the linear combination at the<br>
current depth is on the central axis; and<br>
determining an effective electron density to apply to a scatter dose profile that when<br>
applied provides a value substantially equal to a convoluted value of central axis scatter dose at<br>
the current depth when a point of interest applied to the scatter dose profile at the current electron<br>
density at the current depth is on the central axis.<br>
15.	A computer readable medium as defined in any of Claims 12-14, wherein the operation of<br>
determining with constant time computational complexity, radiation dose for each of a plurality<br>
of points of interest in the complex medium includes the operations of:<br>
determining for each of the plurality of points of interest at least one of the foiiowing: a<br>
value of electron density associated with the point of interest and an electron density distribution<br>
associated with the point of interest defining a local electron density value; and<br>
accessing predetermined off-axis properties corresponding to a homogeneous electron<br>
density having a value derived from the respect ive local electron density value associated with<br>
each point of interest responsive to the respective local electron density value for each respective<br>
one of the plurality of points of interest and a pencil beam intensity for each associated pencil<br>
beam directed through each respective one of the plurality of points of interest to thereby<br>
determine radiation dose for each of the plurality of points of interest.<br>
 <br>
16. A computer readable medium as defined in Claim 12,<br>
wherein the operation of predetermining a delivery machine-dependent representation of<br>
radiation dose includes the operation of determining a radiation dose profile for a plurality of<br>
media each having a different electron density, the electron densities selected over a<br>
representative range; and<br>
wherein the operation of predetermining for each of a plurality of pencil beams, a depth<br>
dependent representation of central axis properties of a pencil beam passing through a complex<br>
medium includes the operations of:<br>
determining for each of the plurality of pencil beams a depth dependent weight<br>
factor for each of a plurality of depths along a central axis of the respective pencil beam,<br>
each of the plurality of depths for cadi of the plurality of pencil beams having a<br>
determined electron density, each depth dependent weight factor to be applied to at least<br>
one function within an least two-dimensional electron density dependent primary dose<br>
profile associated with the depth of the respective point and having a value determined so<br>
that when a point of interest is selected along the central axis of the respective pencil<br>
beam at the respective depth, the associated at least two-dimensional electron density<br>
dependent primary dose profile provides a value substantially equal to a convoluted value<br>
of central axis primary dose of the current depth when a point of interest applied to the<br>
linear combination at the current depth is on the central axis, and<br>
determining an effective electron density to apply to a scatter dose profile that<br>
when applied provides a value substantially equal to a convoluted value of central axis<br>
scatter dose when a point of interest applied to the scatter dose profile at the current<br>
electron density at the current depth is on the central axis.<br>
17. A computer readable medium as defined in Claim 12,<br>
wherein the operation of predetermining a delivery machine-dependent representation of<br>
radiation dose includes the operations of:<br>
receiving data parameters for a medium having properties substantially similar to<br>
that of water,<br>
forming a primary dose profile table for each of the plurality of electron densities<br>
responsive to the data parameters, and<br>
 <br>
forming a scatter dose profile table for at least a representative portion of the<br>
plurality of electron densities;<br>
wherein the operation of predetermining for each of a plurality of pencil beams, a depth<br>
dependent representation of central axis properties of a pencil beam passing through a complex<br>
medium includes the operations of:<br>
receiving electron density parameters for a patient volume developed from a<br>
patient-specific image generating device (41),<br>
determining current and previous electron density values for each of a plurality of<br>
depths along each separate one of a plurality of pencil beams, determining a separate<br>
depth dependent weight w(d) for each of the plurality of depths, and<br>
determining a depth-dependent effective electron density p'(d) for each of the<br>
plurality of depths, to thereby form at least one table of off-axis dose parameters<br>
including representations of a plurality of regions of dose build-up and dose build-down;<br>
and<br>
wherein the operation of determining with constant time computational complexity,<br>
radiation dose for each of a plurality of points of interest in the complex medium includes the<br>
operations of:<br>
determining for each of a plurality of points of interest at least one of the<br>
following: a value of electron density associated with the point of interest and an electron<br>
density distribution associated with the point of interest, defining a iocal electron density<br>
value, and<br>
retrieving the stored off-axis dose parameters responsive to the local electron<br>
density value for each of the plurality of points of interest.<br>
18. A computer readable medium as defined in Claim 12, wherein the operation of<br>
predetermining for each of a plurality of pencil beams, a depth dependent representation of<br>
central axis properties of a beam passing through a complex medium includes the operation of<br>
modeling a three-dimensional primary dose profile by:<br>
linearly combining two dose profiles, the first dose profile at a current electron density<br>
and the second dose profile at a previous electron density to form a model of a three-dimensional<br>
primary dose profile; and<br>
 <br>
setting weighted values of each dose profile so that the model provides a convoiuting<br>
value of the central axis primary dose when a point applied to the model at the current depth is on<br>
the central axis.<br>
19. A computer readable medium as defined in Claim 12, wherein the operation of<br>
predetermining for each of a plurality of pencil beams a depth dependent representation of central<br>
axis properties of a beam passing through a complex medium includes for each of the plurality of<br>
pencil beams the operation of modeling a dose profile by determining a differential change to<br>
central axis dose traveling into the complex medium along the central axis of the respective<br>
pencil beam in proportion to a product of a difference between a current central axis dose and a<br>
dose to a homogeneous medium having an electron density at a point of interest and a electron<br>
density dependent proportionality constant that depends on the electron density at the point of<br>
interest to thereby form representations of a plurality of regions of dose build-up and dose build-<br>
down.<br>
20.	A computer readable medium as defined in Claim 19,<br>
wherein the operation of determining a differential change to central axis dose is applied<br>
to at least one of the following: primary dose and scatter dose; and<br>
wherein the electron density-dependent proportionality constant depends on a ratio of<br>
electron density of the medium and an associated proportionality constant applied to a medium<br>
having properties substantially similar to that of water.<br>
21.	A computer readable medium as defined in Claim 12, wherein the operation of<br>
predetermining for each of a plurality of pencil beams a depth dependent representation of central<br>
axis properties of a beam passing through a complex medium includes for each of the plurality of<br>
pencil beams the operations of:<br>
receiving a central axis primaiy dose;<br>
receiving homogeneous medium off-axis primary dose profiles for a plurality of electron<br>
densities; and<br>
determining an off-axis primary dose profile for a region of a complex medium having an<br>
electron density varying with depth along a central axis of a pencil beam by forming a linear<br>
 <br>
combination of the homogeneous medium off-axis primary dose profiles weighted by values<br>
applied so that the center of the determined off-axis primary dose profile has primary dose<br>
substantially equal to the received central axis primary dose.<br>
22.	A computer readable medium as defined in Claim 21, wherein the operation of<br>
determining an off-axis primary dose profile includes the operation of linearly combining a two-<br>
dimensional primary dose profile for a point of interest having a electron density value related to<br>
a current depth with a two-dimensional primary dose profile for the point of interest having a<br>
electron density value related to that of the previous depth to form an off-axis dose profile for the<br>
complex medium.<br>
23.	A computer readable medium as defined in Claim 12, wherein the operation of<br>
predetermining a depth dependent representation of central axis properties of a beam passing<br>
through a complex medium for each of a plurality of pencil beams includes for each of the<br>
plurality of pencil beams the operations of:<br>
receiving a central axis scatter dose;<br>
receiving homogeneous medium off-axis scatter dose profiles for a plurality of electron<br>
densities; and<br>
determining an off-axis scatter dose profile for a region of a complex medium having an<br>
electron density varying with depth along a centrai axis of a pencil beam from off axis properties<br>
of a homogeneous medium having an effecthe electron density selected so that central axis<br>
scatter dose of the determined homogeneous medium off-axis profile substantially matches the<br>
received central axis scatter dose of the complex medium.<br>
24. A computer readable medium as defined in Claim 23, wherein the operation of<br>
determining an off-axis scatter dose profile includes the operation of determining an effective<br>
electron density to apply to the off-axis scatter dose profile that when applied provides a value<br>
substantially equal to a convoluted value of the central axis scatter dose for a complex medium<br>
when a point of interest applied to the off-axis scatter dose profile at the current electron density<br>
at the current depth is on the central axis.<br>
 <br>
25. A system (30) for determining dose in a media of varying electron density from a high-<br>
energy radiation-beam for radiation treatment, comprising a radiation treatment planning<br>
computer (31) having memory (33) and a processor (35) in communication with the memory<br>
(33), the system (30) being characterized by:<br>
radiation treatment planning program product (37) stored in the memory (33) of the<br>
radiation treatment planning computer (31) and adapted to determine dose for a radiation<br>
treatment plan to deliver radiation to a complex medium defining a patient volume, the radiation<br>
treatment planning program product (37) including instructions that when executed by the<br>
processor (35) of the radiation treatment planning computer (31) causes the computer (31) to<br>
perform the operations of:<br>
determining a delivery machine-dependent representation of radiation dose for a<br>
plurality of different electron densities selected over a preselected representative range;<br>
determining for each of a plurality of pencil beams, a depth-dependent<br>
representation of central axis properties of a pencil beam passing through a complex<br>
medium having a complex spatial distribution of heterogeneous electron densities; and<br>
determining with constant time computational complexity, radiation dose for each<br>
of a plurality of points of interest in the complex medium by applying the predetermined<br>
machine-dependent and depth-dependent representations.<br>
26. A system (30) as defined in Claim 25,<br>
wherein the operation of determining a delivery machine-dependent representation of<br>
radiation dose includes:<br>
receiving measured dose data for unit relative electron density,<br>
determining machine-dependent primary dose profiles for each of a first set of a<br>
plurality of electron densities distributed through a preselected range of electron densities<br>
responsive to the measured dose data for unit relative electron density, and<br>
determining machine-dependent scatter dose profiles for each of a second set of a<br>
plurality of electron densities distributed through a preselected range of electron densities<br>
responsive to the measured dose data for unit relative electron density; and<br>
wherein the operation of determining radiation dose includes at least one of the<br>
following:<br>
 <br>
retrieving the patient specific primary and scatter dose profile parameters<br>
separately for each of the plurality of points of interest in the patient volume responsive to<br>
one of the following: a value of electron density associated with the respective point of<br>
interest and an electron density distribution associated with the respective point of<br>
interest, defining the local electron density value for the respective point of interest, to<br>
determine total dose at each of the plurality of points of interest, to thereby produce a<br>
three-dimensional map of radiation dose delivered to the patient volume, and computing<br>
the dose for the radiation treatment plan using the primary and scatter dose profiles<br>
responsive to the local electron density value for the respective point of interest, to<br>
thereby determine total dose at each of the plurality of points of interest; or<br>
retrieving the patient specific primary and scatter dose profile parameters<br>
separately for each of a plurality of points of interest in the patient volume to compute<br>
dose with constant time computational complexity for each pencil-beam to each point of<br>
interest as selected a posteriori to profile parameter determination responsive to the local<br>
electron density value for the respective point of interest, to thereby determine total dose<br>
at each of the plurality of points of interest, and producing a map of radiation dose<br>
delivered to the patient volume to allow a user to iteratively evaluate the total dose of the<br>
patient volume.<br>
27. A system (30) as defined in Claim 26,<br>
wherein the operations of determining machine-dependent primary dose profiles for each<br>
of the electron densities in the first set of electron densities includes one of the following<br>
operations:<br>
performing the operations of separating a total dose model into a central axis<br>
primary and scatter dose models, and performing a two-dimensional convolution of the<br>
associated geometric kernel and radiological kernel of the respective electron density with<br>
an aperture description of a characteristic pencil beam, or<br>
performing for each electron density in the first set of electron densities a two-<br>
dimensional radiological kernel integration convolved with geometric penumbra kernel<br>
whereby a central axis primary dose implied by the kernel is substantially equivalent to a<br>
central axis primary dose in water of a field size substantially equal to a desired field size<br>
 <br>
multiplied by a ratio of electron density of a homogeneous medium to electron density of<br>
water; and<br>
wherein the operation of determining a machine-dependent scatter dose profiles for a<br>
second set of electron densities distributed through a preselected range of electron densities<br>
includes one of the following operations:<br>
performing the operations of accessing the dose model for unit relative electron<br>
density to obtain profile data using a beam field size equal to a product of beam field size<br>
by each respective electron density, or<br>
performing for each electron density in the second set of electron densities a<br>
modified Clarkson integration whereby central axis dose in the homogeneous medium is<br>
derived from the central axis dose of wafer for a field size equal to the field size of the<br>
pencil beam multiplied by a ratio of an electron density of the homogeneous medium to<br>
an electron density of water.<br>
28. A system (30) as defined in either of Claims 26 or 27,<br>
wherein the operation of determining patient specific primary dose profile parameters for<br>
each pencil beam to be utilized during radiation treatment includes one of the following<br>
operations:<br>
modeling a plurality dose build-up and dose build-down regions, or<br>
combining linearly current and previous depth-dependent electron densities to<br>
determine the primary dose profile parameters around media boundaries using a electron<br>
density-dependent kernel; and<br>
wherein the operation of determining patient specific scatter dose profile parameters for<br>
each pencil beam to be utilized during radiation treatment includes one of the following<br>
operations:<br>
determining an effective electron density, or<br>
performing a modified Clarkson integration for a set of electron densities.<br>
29. A system (30) as defined in any of Claims 26-28,<br>
wherein the system (30) is further characterized by:<br>
a communication network (43),<br>
 <br>
an image gathering device (41) accessible to a communication network (43) to<br>
provide an at least two-dimensional image slice of a target volume and an adjacent<br>
structure volume in the patient defining the patient volume,<br>
a radiation beam source (45) to deliver radiation to the target volume according to<br>
a radiation treatment plan along the plurality of pencil beams, and<br>
the radiation treatment planning computer (31) in communication with the image<br>
gathering device (41) and having memory (33) and a processor (35) coupled to the<br>
memory (33); and<br>
wherein the radiation treatment planning program product (37) further includes<br>
instructions to perform the operations of:<br>
storing two-dimensional primary dose profiles in separate look-up tables for each<br>
electron density in the first set of electron densities;<br>
storing three-dimensional scatter dose profiles in separate look-up tables for each<br>
electron density in the second set of electron densities; and<br>
storing the primary and scatter dose profile parameters in separate look-up tables<br>
for each of the plurality of pencil beams.<br>
30.	A method of determining central axis dose in a media of varying electron density from a<br>
high-energy radiation-beam for radiation treatment, the method being characterized by the step of<br>
modeling a dose profile by performing the steps OT":<br>
determining a difference between a current central axis dose and a central axis dose at<br>
previous depth traveling into a complex medium along a central axis of a pencil beam in<br>
proportion to a product of a difference between the central axis dose at previous depth and an<br>
equilibrium dose to a homogeneous medium having an electron density at a point of interest, and<br>
an electron density dependent proportionality constant that depends on the electron density at the<br>
point of interest; and<br>
determining the sum of the central axis dose at previous depth and the difference between<br>
the current central axis dose and the central axis dose at previous depth, to thereby form<br>
representations of a plurality of regions of dose build-up and dose build-down.<br>
31.	A method as defined in Claim 30,<br>
 <br>
wherein the step of determining a differential change to central axis dose is applied to at<br>
least one of the following: primary dose and scatter dose; and<br>
wherein the electron density-dependent proportionality constant depends on a ratio of<br>
electron density of the medium and an associated proportionality constant applied to a medium<br>
having properties substantially similar to that of water.<br>
32.	A method of determining an off-axis dose profile in heterogeneous media of varying<br>
electron density from a therapeutic high-energy radiation-beam for radiation treatment, the<br>
method being characterized by the steps of:<br>
receiving a central axis primary dose;<br>
receiving homogeneous medium off-axis primary dose profiles for a plurality of electron<br>
densities; and<br>
determining an off-axis primary dose profile for a region of a complex medium having an<br>
electron density varying with depth along a central axis of a pencil beam by forming a<br>
combination of the homogeneous medium off-axis primary dose profiles weighted by values<br>
applied so that the center of the determined off-axis primary dose profile has primary dose equal<br>
the received central axis primary dose.<br>
33.	A method as defined in Claim 32. wherein the step of determining an off-axis primary<br>
dose profile includes the step of linearly combining a two-dimensional primary dose profile for a<br>
point having a electron density value related to a current depth with a two-dimensional primary<br>
dose profile for the point having a electron density value related to that of the previous depth to<br>
form an off-axis dose profile for the complex medium.<br>
34.	A method of determining an off-axis dose profile in heterogeneous media of varying<br>
electron density from a therapeutic high-energy radiation-beam for radiation treatment, the<br>
method being characterized by the steps of:<br>
receiving a central axis scatter dose;<br>
receiving homogeneous medium off-axis scatter dose profiles for a plurality of electron<br>
densities; and<br>
 <br>
determining an off-axis scatter dose profile for a region of a complex medium having an<br>
electron density varying with depth along a central axis of a pencil beam from off-axis properties<br>
of a homogeneous medium corresponding to an effective electron density selected so that central<br>
axis scatter dose of the determined homogeneous medium off-axis scatter dose profile matches<br>
the received central axis scatter dose of the complex medium.<br>
35.	A method as defined in Claim 34, wherein the step of determining an off-axis scatter dose<br>
profile includes the step of determining an effective electron density to apply to the off-axis<br>
scatter dose profile that when applied provides a value substantially equal to a convoluted value<br>
of the central axis scatter dose of the complex medium when a point of interest applied to the off-<br>
axis scatter dose profile at the current electron density at the current deplh is on the central axis.<br>
36.	A metfiod of determining dose for a pencil beam to a point of interest in a complex media<br>
having an electron density distribution varying laterally at a depth associated with the point of<br>
interest from a therapeutic high-energy radiation-beam for radiation treatment, the method being<br>
characterized by the steps of:<br>
receiving a central axis dose for the pencil beam;<br>
responsive to the received central axis dose, determining a homogeneous medium off-axis<br>
dose profile for each of a plurality of electron densities forming the electron distribution near the<br>
point of interest and at the depth associated with the point of inieresi, each homogeneous<br>
medium off-axis dose profile determined at a respective associated off-axis position of interest<br>
associated with a separate one of the plurality of electron densities forming the electron<br>
distribution; and<br>
combining each of the homogeneous medium off-axis dose profiles to determine the off-<br>
axis dose profile for the pencil beam to the point of interest of the complex medium having an<br>
electron density distribution varying laterally at the depth associated with the point of interest<br>
responsive to the homogeneous medium profiles.<br>
 <br>
37.	A method of determining dose for a pencil beam to a point of interest in a complex media<br>
having an electron density distribution varying laterally at a depth associated with the point of<br>
interest from a therapeutic high-energy radiation-beam for radiation treatment, the method being<br>
characterized by the steps of:<br>
receiving a central axis dose for the pencil beam;<br>
responsive to the received central axis dose, determining a homogeneous medium off-axis<br>
dose profile for each of a plurality of electron densities forming the electron distribution near the<br>
point of interest and at the depth associated with the point of interest, each homogeneous<br>
medium off-axis dose profile determined at a respective associated off-axis position of interest<br>
associated with a separate one of the plurality of electron densities forming the electron<br>
distribution; and<br>
selecting one of the plurality of homogeneous medium off-axis dose profiles for a single<br>
electron density value to determine the off-axis dose profile for the pencil beam to the point of<br>
interest of the complex medium having an electron density distribution varying laterally at the<br>
depth associated with the point of interest.<br>
38.	A method of determining dose in heterogeneous media of varying electron density from a<br>
therapeutic high-energy radiation-beam for radiation treatment, the method being characterized<br>
by the step of:<br>
determining for a preselected size pencil beam, a central axis primary dose in a<br>
homogeneous medium of arbitrary electron density from a central axis primary dose model for<br>
water equivalent medium of an equivalent effective field size by rescaling a dose normalization<br>
factor and a linear attenuation and longitudinal buildup coefficients as a function of the arbitrary<br>
electron density.<br>
39.	A method as defined in Claim 38, wherein the step of determining central axis primary<br>
dose includes the step of modifying a two-dimensional radiological kernel representing electron<br>
transport so that a central axis dose implied by the kernel is substantially equivalent to a central<br>
axis dose in water of a pencil beam field size substantially equal to a desired field size multiplied<br>
by a ratio of electron density of the homogeneous medium to electron density of water by<br>
employing a representation of a dose normalization factor expressed as a linear combination of<br>
 <br>
exponential functions that model lateral electron transport whose longitudinal buildup<br>
coefficients scale linearly with electron density.<br>
40.	A method of determining dose in heterogeneous media of varying electron density from a<br>
therapeutic high-energy radiation-beam for radiation treatment, the method being characterized<br>
by the steps of:<br>
receiving a central axis scatter dose model representing central axis scatter dose as a<br>
function of field size and depth for water equivalent medium;<br>
determining a central axis scatter dose model representing central axis scatter dose as a<br>
function of field size and depth for a homogeneous medium of arbitrary electron density using an<br>
equivalent effective field size responsive to the received scatter dose model; and<br>
determining at least one scatter volume for a homogeneous medium of arbitrary electron<br>
density by performing a modified Clarkson integration utilizing the determined central axis<br>
scatter dose model of the homogeneous medium of arbitrary electron density in the integration to<br>
derive the scatter volume.<br>
41.	A method as defined in Claim 40,<br>
wherein the equivalent field size is equal to the field size in the homogeneous medium of<br>
arbitrary electron density multiplied by a ratio of an electron density of the homogeneous<br>
medium to an electron density of water; and<br>
wherein the step of determining central axis scatter dose model for the water equivalent<br>
medium includes the step of applying a linear fit of a measured total central axis dose as a<br>
function of a distance variable, to separate the central axis scatter dose from a central axis<br>
primary dose.<br>
42.	A computer readable medium that is readable by a computer (31), the computer (31)<br>
readable medium comprising a set of instructions that, when executed by the computer (31),<br>
cause the computer (31) to perform the following operations being characterized by:<br>
receiving a central axis dose for a pencil beam at a depth associated with a point of<br>
interest of a complex medium having an electron distribution varying laterally;<br>
 <br>
receiving a homogeneous medium off-axis dose profile for each of a plurality of electron<br>
densities;<br>
receiving the electron density distribution near the point of interest; and<br>
responsive to the electron density distribution near the point of interest, combining each<br>
of the homogeneous medium off-axis dose profiles and the central axis dose to determine an off-<br>
axis dose profile for the pencil beam to the point of interest of the complex medium having an<br>
electron density distribution varying laterally at the depth of interest associated with the point of<br>
interest.<br>
43.	A computer readable medium that is readable by a computer, the computer readable<br>
medium comprising a set of instructions that, when executed by the computer, cause the<br>
computer to perform the operations of:<br>
receiving a central axis dose for a pencil beam at a depth associated with a point of<br>
interest of a complex medium having an electron distribution varying laterally;<br>
receiving a homogeneous medium off-axis dose profile for each of a plurality of electron<br>
densities;<br>
receiving an electron density at the point of interest; and<br>
responsive to the electron density at the point of interest, determining an off-axis dose<br>
profile for the pencil beam to the point of interest of the complex medium having an electron<br>
density distribution varying laterally at the depth associated with the point of interest, the<br>
operation of determining the off-axis dose profile including the operation of selecting one of the<br>
plurality of homogeneous medium off-axis dose profiles for a single electron density value.<br>
44.	A computer readable medium as defined in Claim 42, the operations being further<br>
characterized by: determining central axis primary dose for a pencil beam having a field size in a<br>
homogeneous medium from a central axis primary dose model for water equivalent medium of<br>
an equivalent effective field size.<br>
45.	A computer readable medium as defined in Claim 44, wherein the operation of<br>
determining central axis primary dose includes the operation of modifying a two-dimensional<br>
radiological kernel representing electron transport so that a central axis dose implied by the<br>
 <br>
kernel is substantially equivalent to a central axis dose in water of a pencil beam field size<br>
substantially equal to a desired field size multiplied by a ratio of electron density of the<br>
homogeneous medium to electron density of water.<br>
46.	A computer readable medium as defined in any of Claims 42-45, the operations being<br>
further characterized by: determining central axis scatter dose for a pencil beam having a field<br>
size in a homogeneous medium from a central axis scatter dose model for water equivalent<br>
medium of an equivalent effective field size.<br>
47.	A computer readable medium as defined in Claim 46, wherein the operation of<br>
determining central axis scatter dose includes the operation of performing a modified Clarkson<br>
integration whereby central axis dose in the homogeneous medium is derived from the central<br>
axis dose of water for a field size equal to the field size of the pencil beam multiplied by a ratio<br>
of an electron density of the homogeneous medium to an electron density of water.<br>
<br>
A system (30) to provide enhanced computational effeciency in determining dose in a media of varying density<br>
 from a high-energy radiation-beam for radiation treatment, program product (37), and related methods are provided. The system<br>
(30) can include a radiation treatment planning computer (31) and radiation treatment planning program product (37) stored in the<br>
memory (33) of the radiation treatment planning computer (31) and adapted to enhance optimization of a radiation treatment plan<br>
for delivering radiation to a complex medium defining a patient volume. The radiation treatment planning program product (37)<br>
provides functions including those for predetermining a delivery machine-dependent representation of radiation dose for a plurality<br>
of different electron densities selected over a preselected representative range, predetermining a depth-dependent representation of<br>
central axis properties of a pencil beam passing through a complex medium for each of a plurality of pencil beams, and determining<br>
with constant lime computational complexity radiation dose for each of :i plurality of points of interest in a heterogeneous medium<br>
having a complex spatial distribution of heterogeneous electron densities by applying I he predetermined machine-dependent and<br>
depth-dependent representations.</td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/viewdoc.aspx?id=AqNypXNKpOPjvYlQBFGUDg==&amp;amp;loc=wDBSZCsAt7zoiVrqcFJsRw==" target="_blank" style="word-wrap:break-word;">http://ipindiaonline.gov.in/patentsearch/GrantedSearch/viewdoc.aspx?id=AqNypXNKpOPjvYlQBFGUDg==&amp;amp;loc=wDBSZCsAt7zoiVrqcFJsRw==</a></p>
		<br>
		<div class="pull-left">
			<a href="278817-dna-vaccines-against-seasonal-influenza-a.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="278819-desulphurisation-materials.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>278818</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>466/KOLNP/2009</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>01/2017</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>06-Jan-2017</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>30-Dec-2016</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>03-Feb-2009</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>BEST MEDICAL INTERNATIONAL. INC.</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>7643 FULLERTON ROAD, SPRINGFIELD, VIRGINIA</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>ROMESBERG, III, MERLE E.</td>
											<td>5503 5TH AVENUE, PITTSBURGH, PENNSYLVANIA 15232</td>
										</tr>
										<tr>
											<td>2</td>
											<td>NIZIN, PAUL S.</td>
											<td>6515 ADOBE TRAILS DRIVE, SUGARLAND, TEXAS 77479</td>
										</tr>
										<tr>
											<td>3</td>
											<td>PINO, RAMIRO</td>
											<td>2604 COURTYARD LANE, PEARLAND, TEXAS 77584</td>
										</tr>
										<tr>
											<td>4</td>
											<td>NIZIN, PAUL S.</td>
											<td>6515 ADOBE TRAILS DRIVE, SUGARLAND, TEXAS 77479</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>A61N 5/10</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/US2007/016940</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2007-07-27</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>60/833,653</td>
									<td>2006-07-26</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/278818-system-and-method-to-account-for-heterogeneities-for-pencil-beam-based-dose-calculations by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 04 Apr 2024 23:34:52 GMT -->
</html>
