<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/197469-key-management-apparatus by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 07:57:14 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 197469:&quot;KEY MANAGEMENT APPARATUS&quot;</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">&quot;KEY MANAGEMENT APPARATUS&quot;</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>The invention concerns a Key Management apparatus (10) for generating, distributing and managing cryptographic keys used by a transaction evidencing device (36) that uses cryptographic operations to produce evidence of information integrity, the cryptographic keys having master keys used to generate temporal keys, the temporal keys utilized for generation and verification of indicia, the system comprising: a first master key generating device (20) and a second master key generating device (22); a plurality of computers (24, 30, 42, 46) communicatively coupled to each other to control operation of said key management apparatus; a plurality of domain storage devices (25, 45) communicatively coupled to said plurality of computers corresponding respectively to a plurality of separate logical security domains, each of said security domains providing domain processes for key generation, key installation, key verification and verification of the evidence of information integrity produced by said transaction evidencing device within said domain, said domain storage devices provided with recording key status records and master keys for each domain; an installation device (32) for installing said master keys in the transaction evidencing device; and a plurality of verification devices (21 , 40) for verifying said evidence of information integrity.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>FIELD OF THE INVENTION<br>
The present invention relates to a Key Management apparatus for generating, distributing and managing cryptographic keys used by a transaction 'evidencing device that uses cryptographic operations to produce evidence of information integrity, the cryptographic keys having master keys used to generate temporal keys, the temporal keys utilized for generation and verification of indicia.<br>
RELATED APPLICATIONS<br>
The present application is related to U.S. Applications<br>
Serial Nos. 08/415, 824 and 08/414, 896 both filed March 31,<br>
1995 (corresponding respectively to Indian Patent Applications<br>
Nos. 699/DEL/965 and 701/del/96  and 08/551, 934 filed October<br>
      23,  1999  and  assigned  to  the  assignees  of  the present<br>
      invention.<br>
	Background of the Invention<br>
	Digital printing technology has enabled mailers to<br>
implement digital, i.e. bit map addressable, printing in a.convenient manner. 'it has been found to be desirable to use such techniques for .the purpose of evidencing payment of postage. Technological advances in digital printing technology has made it possible to print postage indicia that is unique for each mailpiece. A. computer driven printer can print, for example, a postal indicia in a desired location on the face of a mailpiece. The indicia is unique because it includes information relating directly to the mailpiece, for example, . postage value, date, piece count and/or origin postal code.<br>
From a Post Office's perspective, it will be appreciated, that the digital printing and scanning technology make it fairly easy to counterfeit a postal value bearing indicia since any suitable computer and printer may be used to generate multiple copies of an image.<br>
In order to validate a mailpiece, that is to ensure that accounting for the ' postage amount printed on a<br><br>
mailpiece has been properly done, it is known that one may include as part of the franking an encrypted number such that, for instance/ the value of the franking may be determined from the encryption to learn whether the value<br>
as printed on the mailpiece is correct.	 See  for,<br>
example, sT Patent _Nos_._ 4,757753^) and (4_,775,246 to Edelmann et al., as well as U.S. Patent No.4,649,266 to<br>
Eckert.   It is also known to authenticate a mailpiece by<br>
including the address as a further part of the encryption as described in U.S. Pateat No. 4,725,718 to Sansone et<br>
	'<br>
al,   and U.S.   Patent No.   4,743,747 to  Fougeres et al.<br>
U.S. Patent No. 5,170, 044 to Pastor describes a method and apparatus for the representation of binary data in the form of an indicia comprising a binary array of pixels. The actual arrays of pixels are scanned in order to identify the provider of the mailpiece and to<br>
recover other encrypted plain text information.  U.S.<br>
Patent No. 5,142,577 to Pastor descaribes various alternatives to the DES encoding for encrypting a message and for comparing the decrypted postal information to the plain text information on the mailpiece.<br>
U.S. Patent No. 5,390,25l to Pastor et al. describes a system for controling the validity of printing of indicia on mailpieces from a potentially large number of users of postage meters including apparatus disposed in each meter for generating a code and for printing the code on each mailpiece. The code is an encrypted code representative of the apparatus printing the indicia and other information uniquely determinative of the legitimacy of postage on the mailpieces.<br>
A digital meter provides evidence of the payment of postage by signing the postal information on the envelope with two "digital tokens." One digital token provides evidence to the postal service, and the second digital token provides evidence to the vendor, such as the assignee of the present invention. A digital token is a truncation of the result of encrypting indicia<br>
-3-<br><br>
information including, for example, postage value, piece count, date of submission, and originating post office.<br>
A new class of digital meters is boing developed that employ cryptographic means to produce evidence of postage payment. The encryption is performed using a cryptographic key. In each digital meter, independent keys are used for generating the digital tokens. For security reasons, the keys in different meters are also independent. Information about the meter and mail piece are combined and encrypted with vendor and postal master keys or keys derived therefrom. Portions of the resulting information are printed on the mail piece as digital tokens. The information and tokens can be verified by a device that processes the information in the same manner and compares the resulting digital tokens with those printed on the mail piece.<br>
A key management system is needed to distribute cryptographic keys to digital meters in a secure and reliable manner. The key management system must include means for verifying indicia and digital tokens to detect the fraudulently generated of indicia and duplicated indicia.<br>
Summary of the Invention<br>
The present invention provides a Key Management System for generating, distributing and managing cryptographic keys used by an information transaction system that employs cryptographic means to produce evidence of information integrity. The system comprises a plurality of functionally distinct secure boxes operatively coupled to each other. Each of the secure boxes performs functions for key generation, key installation, key verification or validation of tokens. Computers, operatively coupled to the secure boxes, provide system control and facilitate communication among the secure boxes. A plurality of separate logical security domains provide domain processes for key generation, key installation, key verification and<br><br>
validation of tokens produced by the transaction evidencing device within the domain using the key management functions. A plurality of donain archives, corresponding respectively to each of the security domains, securely and reliably record key status records and master keys for each domain. The Key Management System installs the master keys in the transaction evidencing device and validates the tokens. The secure boxes include a key generation box for generating, encrypting and signing a master key; a key installation box for receiving, verifying and decrypting the signed master key and for installing the master key into the transaction evidencing device; a key verification box for verifying the installation of the master key in the transaction evidencing device, a token verification box for verifying the tokens, and at least one wanufacturing<br>
box for generating domain keys and distributing the domain keys among the secure boxes, for each of the domains.<br>
In accordance with the preferred embodiment of the present invention, a Key Management System generates and distributes cryptographic keys, such as Vendor keys, USPS keys/ and other country's postal keys, to digital meters for multiple domains. A domain is a logical separation of data and functions enforced by unique domain authentication and confidentiality keys. The Key Management System  prevents any translation of keys between domains, provides assurance in a domain that the keys were generated in the domain, and that they have been installed in only one meter by the system. The Key Management System securely distributes and maintains cryptographic keys for multiple domains. Further, the Key Management System is structured so that key management for all domains is identical,<br>
The Key Management System supports the following security requirements: (i) meter keys are always confidential; (ii) ability to verify indicia information continues for the life of the system; (iii) status of<br>
meter master keys must always be accurately maintained; (iv) separation of domains must be maintained in order to generate and verify indicia; and (v) a key is installed, or attempted to be installed only once.<br>
Some meters are manufactured without knowing the destination country. This creates a problem that suggests either the need to install keys in the field, or the need to translate keys between domains. Either alternative presents a significant security and key integrity threat. These problems have been avoided in the present system by the creation of a separate domain called the Earth domain.<br>
It has been found that the present invention provides a Key Management System that distributes cryptographic keys to digital meters for multiple 'domains, including Vendor keys and Postal keys for a plurality of countries. The key management system is configured to prevent translation of keys between domains, to provide assurance in a domain that the keys were generated in the domain, and that each key has been installed in only -one meter by the system. The key management for all domains is identical.<br>
Thus the present invention provides a Key Management apparatus for generating, distributing and managing cryptographic keys used by a transaction evidencing device that uses cryptographic operations to produce evidence of information integrity, the cryptographic keys having master keys used to generate temporal keys, the temporal keys utilized for generation and verification of indicia, the system comprising:<br>
a first master key generating device and a second master key generating device; a plurality of computers communicatively coupled to each other to control operation of said key management apparatus; a plurality of domain storage devices communicatively coupled to said plurality of computers corresponding respectively to a plurality of separate logical security domains, each of said security domains providing domain processes for key generation, key installation, key verification and verification of the evidence of information integrity produced by said transaction evidencing device within said domain, said domain storage devices provided with recording key status records and master keys for each domain; an installation device for installing said master keys in the transaction evidencing device; and a plurality of verification devices for verifying said evidence of information integrity.<br>
DESCRIPTION OF THE ACCOMPANYING DRAWINGS<br>
The above and other objects and advantages of the present invention will be apparent upon consideration of the following detailed description, taken in conjunction with accompanying drawings, in which like reference characters refer to like parts throughout, and in which:<br>
Fig. 1 is a block diagram of a cryptographic key management and validation system in accordance with the present invention;<br>
Fig. 2 is a block diagram showing the relationship of the security domains in the key management and validation system of Fig. 1;<br>
Fig. 3 is a block diagram of a vendor data center in the key management and validation system of Fig. 1;<br>
Fig. 4 is a block diagram of the vendor manufacturing facility in the key management and validation system of Fig. 1;<br>
Fig, 5 is a block diagram of a postal iata center in the key management and validation system of Fig. 1;<br>
Fig. 6 is a block diagram showing the administrative domain of a manufacturing box in the key management and validation system of Fig. 1;<br>
Fig. 7 is a flow diagram of a key management process;<br>
Fig. 8 is a flow chart for key identification;<br>
Fig. 9 is a block diagram of the key material for the manufacturing box;<br>
Fig. 10 is a block diagram of the key material for the oak box;<br>
Fig. 11 is a block diagram of the key material for the steel box;<br>
Fig. 12 is a block diagram of the key material for the brass box;<br>
Fig. 13 is a flow diagram of an Earth domain digital meter process;<br>
Fig. 14 is a flow diagram of valid master key status transitions;<br>
Fig. 15 is a block diagram of valid master key status transitions;<br>
Fig. 16 is a message from oak box to brass box;<br>
Fig. 17 is a message from oak box to steel box;<br>
Fig. 18 is logic diagram for key freshness detection;<br>
Fig. 19 is a message from steel box to brass box;<br>
Fig. 20 is a message from a meter to brass box;<br>
Fig. 21 is a block diagram of error handling;<br>
Fig. 22 i* a. flow diagram of an initialization of s&gt;<br>
first manufacturing box;<br>
Fig. 23 is a flow diagram of an initialization of a generic box;<br>
Fig. 24 is a flow diagram of the processing of a key request;<br>
Fig, 25 is a flow diagram of the processing of a key<br>
installation;<br>
Fig. 26 is a flow diagram of the processing of a key<br>
registration;<br>
Fig. 27 is a flow diagram of the processing of an<br>
obsolete key/Fig.  28  is  a  flow  diagram  of  verification<br>
processing.<br>
Fig. 29 is a block diagram showing the flow of key<br>
installation messages;<br>
Fig. 30 is a table of the key installation messages<br>
of Fig. 29;<br>
Fig. 31 is a table of key registration messages; and Fig. 32 is a block diagram showing the relationship<br>
of domains and sub-domains.<br>
Detailed Description of the Present; Invention<br>
In describing the present invention, reference is made to the drawings, wherein there is seen various aspects of a Key Management and Validation System, also referred to herein as the Key Management System.<br>
SYSTEM OVERVIEW<br>
Referring now to Fig. 1, a block diagram of a Key Management System provides an overview of the location and information flow of the Key Management System components. The Key Management System, generally designated 1U, encompasses vendor taciiiti-es 12 ana 14 and postal facilities 16 and 18. The vendor is the entity that manages the Key Management System. Key Management System 10 includes a plurality of functionally dedicated secure boxes, computers and communications lines. In accordance with the present invention/ Key Management System 10 provides manufacturing and operational support for a new generation of digital meter products. Reference herein to digital meters and digital meter products will be of such new generation of digital meter products. It is noted that the present invention<br>
is suitable for managing the generation, distribution of cryptographic keys and the verification of cryptographic data for other applications as well.<br>
In accordance with the present invention, vendor and postal master keys are generated, archived and installed in meters by components of Key Management System 10. Postal token keys are derived, distributed and used for remote verification by components of Key Management System 10. Vendor and postal tokens are verified by components of Key Management System 10.<br>
Key Management System 10 supports th
/<br>
Management System computers 24 and 42. fray Archives 25 and 45 securely and reliably record key status messages and keys.<br>
Security Domains<br>
Referring now to Fig. 2, Key Management System 10 includes separate logical security domains; one vendor domain 50 and one or more domains 52 for postal authorities. Each domain provides a fu.M set of key generation, key distribution, key installation and token verification services. Each domain may encompass several facilities, such as vendor and postal facilities. Multiple logical security domains may exi:5t within each<br>
secure box. Separation of such multiple domains is achieved by encryption of the domain messages in the Master Key Database. The Database encryption keys are different for each domain. Within a secure box, the separation of domains is by the limited processes enabled in the box. However, the security domains overlap in only one place, inside a digital meter. The digital meter calculates two proof of payment tok€:ns, one using; the vendor master key and the other using the postal master key. Failure in the verification of either digital token is sufficient proof of fraud.<br>
Referring now to Fig. 3, vendor dc.ta center 12 provides physical and information access control for Key Management System components, . Vendor data center 12 houses at least one Oak Box 20 that functions as a Vendor Master Key Generation Box, at least one Brass Box 21 that functions as a Vendor Token Verification Box and a Manufacturing Box 23, For security, each box has a unique ID. For added security, the generation, verification and manufacturing functions are physically separated from each other, i.e., Oak Box, Brass Box and Steel Box are separate boxes. It is noted that more than one functional box can be housed in a physical box if so desired.<br>
Vendor KMS Computer 24 manages the secure Oak, Brass and Manufacturing boxes and the messages between them. It supports secure box communications, vendor key archive services, postal key archive services and communications with the vendor manufacturing facility 14 and Postal Data Center 16.<br>
Referring now to Fig. 4, Vendor manufacturing facility 14 provides physical and information access control for Key Management System components. A vendor manufacturing facility 14 houses a vendor Key Distribution computer 30 and at least one secure Steel Box 32, which functions as a Master Key Installation Box, and a corresponding PSR computer 34. Vendor Key Distribution and PSR Computers 30 and 34 support<br>
communications with Key Management System computer 24, other secure boxes and on-line digital meters 36. PSR Computers 30 manage corresponding Steel Boxes 32 and the initialization of digital meters 36.<br>
Referring now to Fig. 5, Postal Data Center 16 may provide physical and information access control for Key Management System 10 components, Postal Data Center 16 may house a Postal Oak Box 22 which functions as a postal master key generation box and a Postal Brass Box 40 which functions as a postal token verification box. A Postal Key Management System Computer 42 may support secure box communications/ postal key archive services and communications with Mail Facilities 18 ar.d Vendor Data Center 12.<br>
Referring now to Fig. 6, an additional logical security domain is required to support the installation and maintenance of all other security domains in Key Management System Components. This is called the Key Management System Administration Domain 60 which is responsible for the generation of security domains and the installation of security domains in Key Management System Components.<br>
Installation of country specific sub-domains in an Earth Security Domain are the responsibility of the Earth Security Domain. Installation of Product Code parameters within Security Domains are the responsibility of the affected Security Domains. This will be explained in<br>
more detail below. FUNCTIONAL CHARACTERISTICS<br>
The following paragraphs provide an overview of all operations and messages in Key Management System 10.<br>
Key Management System 10 provides several necessary functions to support the manufacture and operation of digital meter products. It is responsible for the generation, distribution and long term storage for all encryption keys used in digital meter products, It is also responsible for the verification of digital tokens<br>
generated by digital meter products that employ such encryption keys.<br>
Two or more security domains are implemented by Key Management System 10. Vendor Security Domain 50 includes key generation/ distribution, archival and verification services. Postal security domains 52 implement similar services. These domains overlap in or.e point, the digital meter that contains both vendor and postal master keys, as shown in Fig. 2, i.e., only in the meter are<br>
Vcmelor   and   Postal   Master   Koye   »ir» i 1 *&gt;*i1 «s»   si r*m1 t"anf on.=sl y -KEY  CHARACTERISTICS<br>
Key Generation<br>
Referring now to Fig. 7, a flow diagram of the Key Management Process is shown. A digital meter 36 receives the vendor master key and postal master key while physically located in the vendor manufacturing facility 14 before distribution.<br>
The Key Management System secure box manufacturing process and the domain master key generation process provides encryption keys for Key Management System 10 and digital meters 36. Domain master keys for digital meters 36 are generated by a Domain Oak Process 7C. Domain keys that are used to encrypt domain master keys as they are generated, archived and installed, are generated by Manufacturing Box 23. To provide secure and nondeterirtinisitic' keys, two random number generator processes are employed. Each Oak Box and Manufacturing Box includes a hardware random number generator. A software pseudo-random number generator is also included. The output of these two processes are individually tested to verify that the hardware and software are operating within acceptable limits. The outputs of the two generators are combined through an exclusive-or operation. Thus, if the hardware random number generator fails, the pseudo-random number generator provides •acceptable keying material until the hardware generator can be fixed.<br>
Other KMS secure boxes have limited requirements to generate keying material. Specifically, startup confidentiality keys are generated by Brass and Steel Boxes 21 and 32 during the initialization process. Because of the limited requirements and the presence of trusted authorities during the initialization process, only software pseudo-random number generators are employed.<br>
Master Key Identification<br>
Key Management System 10 must enforce the security requirement that a master key can only b&amp; attempted or installed in any digital meter 36 once. For example, Key Management System 10 must ensure that a domain master key is not installed twice when two or more JJteel Boxes 32 are used in the system. This requirement; is satisfied through the use of domain master key identification numbers/ which are composed of domain specific monotonic sequence counters. Domain Oak Processes and Domain Steel Processes track the last domain master key identification number received for a specific domain ID. When a new Generate Key or Install Key message is received, the domain oak processes or domain steel processes verify that the domain master key identification number is greater than that contained in the previous message.<br>
When Key Management System 10 receives a Request Key command, a Steel ID is required. The Steel ID's are included in the Distribute Master Key record and must be checked by the Domain Steel Process 76. If the Steel ID in the message does not match the Steel ID for the Steel Boxy the message is rejected. The Steel ID may not be<br>
modified     in     the     message     wit-hr-nit"     hreaVrirvj     fhp     TTiPssagp<br>
signature. The combination of Domain Master Key Identification Number, Steel ID and mesisage signature satisfies a one time installation requirement.<br>
Referring now to Fig. 8, Key Distribution Computer 30 requests a key at 80. At 82, Key Management System computer 24 generates a new monotomically increasing key ID from a domain archive 74. At 84, domain oak process<br>
70 determines whether the Oak Box key ID is new against a last seen value. If it is not new, then an Oak Box error condition is initiated at 86. If the key ID is new, then at 88 Oak Box 20 generates and encrypts a key, attaches the key ID, and then signs and sends the message to Steel Box 32. At 90 domain steel process 76 determines whether the Steel ID is correct. At 92 domain stuel process 76 determines if the key ID is new against a last seen value. A steel box error occurs if the message signature test fails/ the steel ID is not correct or the key ID is not new. If no error occurs Steel Box 3<l installs the key into a meter. at></l>
Manufacturing Box and Domain keys<br>
Referring now to Figs. 9-12, secure Boxes within Key Management System 10 must be initialized with domain configuration information and keying material. This is achieved through the use of Manufacturing Box 23 which is responsible for the creation of domains Eind the domain keys 110. When a domain is created/ a unique domain ID is required, After a domain has been established in Manufacturing Box 23, other secure boxes may be initialized with the domain information.<br>
All domain keys 110 are generated by Manufacturing Box 23, Domain keys 110 consist of confidentiality, authentication and operation keys that ar<i encrypted by domain key set keys are shared among the different secure boxes. each box has specific requirements for keying material.></i>
Each. Manufacturing Box 23 requires an Operation Combination 101 that is broken into three Shamir secret Shares 102. Individual shares are written onto removable media and distributed to authorized personnel. Each Manufacturing Box 23 requires a Domain Key Set 103 that consists of an RSA key pair, for confidentiality and an RSA key pair for authentication. The confidentiality and authentication keys are broken into three Shamir secret shares 104. Individual shares are written onto removable media and distributed to authorized personnel. RSA key<br><br>
pairs are described in "A Method For Obtaining Digital Signatures And Public-Key Cryptosystems," by R. L. Rivest, A. Shamir and L. Adleman in Communinations of the ACM, Vol. 21, No. 2, February 1978, pp. 120-127, Shamir eooret shares are deseriboH in "How To Share A Secret." by A. Shamir in Communications of the ACM, Vol. 22 , No. 11, Nov. 1979, pp. 612-613.<br>
In the preferred embodiment, each Oak Box 20 requires an Operation Combination 105 that is broken into two Shamir secret shares 106 (Fig. 10) ., individual shares 106 are written onto removable media and distributed to authorized personnel. All shares 106 must be entered into Oak Box 20 before it can operate. The last entered share 106 must remain in the Cak Box to keep it enabled. When the last entered share 106 is removed, Oak Box 20 is disabled.<br>
Each Domain Oak Process 70 requires a:a RSA key pair for authentication. The private authentication key (P'OA) is only known by the Domain Oak Process 70 and Manufacturing Box 23. The public authentication key (PO») •&gt; * Vnnwn hy fhp rnrrftspondincr Domain Steel Process 76 and Domain Brass process 72, The Domain Oak Process 70 does not require a private confidentiality key.<br>
In the preferred embodiment, each Steel Box 32 in<br>
the vendor Manufacturing Facility requires an Operation<br>
Combination 119 that is broken into two Shamir secret<br>
shares 120 (Fig.-11).  Individual shares 120 are written<br>
onto  removable  media  and  distributed  to  authorized<br>
personnel, for example to a supervisor and operator.  The<br>
set of Supervisor and Operator shares 120 must be entered<br>
irs.tc St-eel Bex 32 before it car. operate.   The last<br>
Process 72. Each Domain Steel Process 76 requires an RSA key pair for confidentiality. The private confidentiality (P'sc) key is only known by the Domain Steel Process 76. The public confidentiality (Psc) key is known by the Domain Oak Process 70,<br>
In the preferred embodiment of the present invention, each Brass Box 21 requires an Operation Combination 121 that is broken into two Shamir secret shares 122 (Fig. 12). Individual shares 122 are written onto removable media and distributed ':o authorized personnel. All shares 122 must be entered, into a Brass Box 21 before it can operate. The last entered share 122 must remain in Brass Box 21 to keep it enabled, when the last entered share 122 is removed, Brar.s Box 21 is disabled.<br>
Each Domain Brass Process 72 requires an RSA key pair for authentication. The private and public authentication keys (P'BA and PBA) are only known by the Domain Brass Process. Each Domain Brass Process requires an RSA key pair for confidentiality. The private confidentiality key (P'sc) is only known by Domain Brass Process 72. The public confidentiality (PBc) key is known by the Domain Oak Process 70. Each Domain Brass Process 72 requires a DBS key set for confidentiality that is only known by the Domain Brass Process 72. Each Domain Brass Process 72 requires a DES key set for authentication that is only known by the Domain Brass Process 72.<br>
It will be understood by those skilled in the art that the number of shares selected as being necessary to operate the secure boxes is based on the security strategy implemented for the Key Management System.<br>
Digital Meter Requirements<br>
A manufacturing sequence number/ in conjunction with a product Code number, uniquely defines digital meter 36 within the vendor manufacturing process. The preferred method for the manufacturing sequence number allocation is as follows. A supply of identification labels, each<br>
containing a unique product code number and manufacturing sequence number pair, is stocked on the manufacturing line. One identification label is applied to each digital meter 36, These numbers are entered into the PSfc Computer 34 and downloaded into digital met-sr 36 prior to the Key Installation process.<br>
The meter is securely configured so that once keys are installed during manufacture/ they can never be, removed or determined outside the manufacturing environment without leaving physical evidence of tampering.<br>
The Domain Oak Process 70 employs a set of test information during the Master Key Generation process. A<br>
Test   PatLeiiJ   la    u»ed   Lu   yeueteiLt;   st    »*sU   wf    t«»t   tokens    to<br>
check the Master Key Installation process in Manufacturing. The Test Pattern consists of two Preformatted 64 bit binary values. These are encrypted with the target Domain Master Key and the specified position and number of tokens from -he resulting cyphertext is generated.<br>
The Test Pattern is included in the Domain Oak and Domain Brass Processes operating software. All digital meters employ the same test information curing the key installation check procedure, The test pattern is a set of information shared between Key Management System 10 and the target digital meter. The test pattern may be stored in ROM for a specific digital meter.<br>
Earth Domain Digital Maters<br>
Earth Domain digital meters do not have country specific information when they leave the Manufacturing Facility. This is done to allow digital meters to be stocked on a regional basis and be made country specific at the last moment. The product code number for an Earth Domain digital meter is a two letter product code prefix followed by a predetermined number. Prior to country personalization, an Indicia Serial Number will be a null string. Both Product Code Number and "ndicia Serial<br>
Number values must be defined at Key Registration time to make the Domain Master Key active.<br>
Referring now to Fig. 13, a process flow diagram for an earth domain digital meter is provided. Earth Domain master keys for Earth Domain digital meters are generated by the Earth Domain Oak Process 170. Copies of Earth Domain master keys are stored in the Earth Domain Archive 174. Earth Domain master keys are installed into Earthj Domain digital meters 136 and checked by the Earth Domain Steel Process 176. Installation of Earth Domain master keys is verified by the Earth Domain Brass* Process 172. The Earth Domain Master Key record is updated to install status by the Earth Domain Brass Process 172. The Earth Domain Brass Process 172 does not participate in Key Registration.<br>
Authorized personnel assigns the Earth Domain digital meter"136 to a country specific security domain by setting the digital meter product code number and indicia serial number. Once the digital meter 236 has been assigned to a country specific security domain, it cannot return to the Earth Domain. A digitally signed Key Registration record is generated by the digital meter containing the Product Code Number, Indicia Serial Number and Manufacturing Sequence Number. The digitally signed Key Registration record is returned to Key Management System Computer 24.<br>
Key Management'System Computer 24 will retrieve the Earth Domain Master Key record from the Earth Domain Archive 176. The Earth Domain Master Key record and the Key Registration record is sent to the country specific Domain Brass Process 272.  The records are verified.  If no problems are found, the Domain Master Key is encrypted with the country specific secret key. The Domain Master<br>
Key record is signed for integrity and authontiaation by<br>
the country specific Security Domain private key. The Domain Master Key record will be sent to thu country specific Domain Archive 274.<br>
SYSTEM REQUIREMENTS<br>
Domain Archive<br>
Domain Archives 74 support the long term storage and retrieval of Domain master keys. This i:s accomplished with several transactions between the Oak ftox 20, Domain Archive 74 and Brass Box 21. As the digital meter passes through manufacturing/ distribution and customer sites, the Domain Master Key Status is updated. Every status change is logged to the Domain Archive records, providing a complete history of key activity for the life of the Domain Master Key.<br>
Referring now to Figs. 14 and 15, a process flow diagram that shows valid master key status transitions is provided. After Oak Box 20 completes the key generation process, an encrypted copy of the Domain Master Key and information is forwarded to the Domain Archive 74. The status of the Domain Master Key will be set to New at 180. The Domain Archive -74 will allocate database storage and write the information.<br>
After Steel Box 32 and Brass Box 21 complete the key installation process, the Domain Master Key record is updated. The status of the Domain Master Key may—be set to Installed at 182 , if the process was successful. The status of the Domain Master Key may be set to Bad at 184, if ar.y failures occur during the key distribution or installation process. Such failures could include a lost message, message error, error writing the Domain Master Key to the digital meter memory, error in checking the test tokens or others.<br>
When the digital meter is assigned an Indicia Serial Number for a specific postal domain, tie Vendor and Postal Domain Master Key Records are updated. The Master Key status is set to Active at 186 and verification services are allowed for that digital meter. When the digital meter is taken out of service, the Vendor and Postal Domain Master Key record are updated.  The Master Key status is set to Obsolete at 188.<br>
Key Management System Addresses<br>
Key Management System 10 is composed of a set of physical secure boxes and logical security domains. Messages flowing between these components must contain sufficient information to allow processes and auditors to identify the message participants.<br>
Logical security domains are dete'rmined by an address object called Domain ID. This address uniquely defines an instance of a particular domain within Key Management System 10. Examples of valid Domain IDs may be VE for a vendor Security Domain, USPS for the instance of a United Stated Postal Service Security Domain and UKRM for the instance of a United Kingdom Royal Mail Security Domain. Security domains span several secure boxes and may span several archives. Multiple security domains may coexist within the physical boundaries of one secure box. Only one domain is active within a secure box at any given time. No data is transferable between domains.<br>
Logical secure box objects are determined by an address object called Secure Box Type. This address uniquely defines the secure box function participating in a message transaction. The Oak Box 20 is the Master Key Generator. The Steel Box 32 is th&gt;s Master Key Installation Box. The Brass Box 21 is the Token Verification Box. The Tin Box 44 is the Remote Token Verification Box.<br>
Identification of physical secure boxes is determined by an address object called Secure Box ID. This address uniquely defines an instance of that box within Key Management System 10. It is composed of a Secure Box Type and numeric identifier.<br>
KMS Configuration Data<br>
Each component of Key Management System 10 maintains several configuration tables that allow the operating<br>
software to determine the validity and processinq requirements for Key Management System service messages. Command tables are used to identify what Key Management System service messages and commands are expected by components of the system. A KMS system command table defines all commands that are accepted on a system level. Subsets of the system level table are stored by components of the system, including the Oak Boxes 20, Brass Boxes 21, Steel Boxes 32, Manufacturing Boxes 23, KMS Computer 24, Key Distribution Computer 30 and PSR Computers 34. Received messages that are not included in the local command table are rejected.<br>
Configuration tables are used to identify what Key Management System Domain IDs are recognized by components of the system. A KMS system configuration table defines all Domain IDs that are accepted on a system level. Subsets of the system level table a:re stored by components of the system, including the Oak Boxes 20, Brass Boxes 21, Steel Boxes 32, Manufacturing Boxes 23, KMS Computer 24, Key Distribution Computer 30 and PSR Computers 34. Received messages for Domain IDs that are not included in the .local configuration table are rejected.<br>
Record tables are used to identify what Key Management System Records are recognized by components of the system. A KMS system record table defines all information records that are recognized on a system level. Subsets of the system level table are stored by components of the system, including the Oak Boxes 20, Brass Boxes 21, Steel Boxes 32, Manufacturing Boxes 23, KMS Computer 24, Key Distribution Computer 30 and PSR Computers 34. Received messages containing information records that are not included in the local record table are rejected,<br>
Information Flow<br>
The Domain Oak Process 70 delivers the; Domain Master Key to the Domain Archive 74. Referring now to Fig. 16, the Domain Master Key (KDM) is encrypted with the Domain<br>
Brass Process public key (PBc) before it is stored in the Domain Archive 74. Thus, the Domain Oak Process 70 may not decrypt the Domain Master Key (KDM) from the Domain Archive 74. The Domain Oak Process 70 signs the Domain Master Key record with the Domain Oak Process private key (Pa*) before it is stored in the Domain Archive 74. Thus, the Domain Brass Process 72 can trust that the Domain Master Key record was created by the Doma:.n Oak Process! 70.<br>
The Domain Oak Process 70 delivers the Domain Master Key (KPM) to the Domain Steel Process 76. Referring now to Fig. 17, the Domain Master Key (KDM) is encrypted with the Domain Steel Process public key P(sc) before it is sent to the Domain Steel Process 76. Thus, the Domain Oak Process 70 may not decrypt the Domain Master Key (KDM) from a Distribute Master Key record, The Domain Oak Process 70 signs the Distribute Master K€;y record with the Domain Oak Process private key P' (OA) before it is sent to the Domain Steel Process 76. Thus, the Domain Steel Process 76 can trust that the Distribute Master Key record was created by the Domain Oak Process; 70.<br>
P-cTei. i. invj    ja^w     Lw    Fivj.     10,     'tl'io    ji«roc;«ii3i:i     flovr    £01:    k<iy></iy>
freshness detection is shown. To support the previously noted security requirements, a key is installed or attempted to be installed only once to assure Domain Master Key freshness. The Domain Archive assigns monotonically sequenced Key IDs (KID) to all Domain master keys. Separate Key ID indexes are maintained for each Domain ID. The Domain Oak Processes 70 and Domain Steel Processes 76 track the Key ID values and compare them to Key ID values received in the Generate Key message and Distribute Master Key record.. Thus/ the Domain Oak Processes 70 and Domain Steel Processes 76 can detect when a Generate Key message or Distribute Master Key record is replayed.<br>
Referring now to Fig. 19, the Domain steel Process 76 signs the Master Key Install record with Domain Steel Process private key P(SA) before it is sent to the KMS<br>
Computer 24. By doing so, the Domain Br^ss Process 72 can trust that the Master Key Install record was created by the Domain Steel Process 76,<br>
At time of Key Registration, the digital meter signs the Key Registration record with both the vendor Master Key K(VM) and the postal Master Key K(PM) . Thus, the Postal and Vendor Domain Brass Processes 72 can trust that the Key Registration record values originated ait digital meter 36. Each Domain Brass Process 72 then encrypts the Domain Master Key in the Domain Archive record with a Domain Brass Process secret DES key. As a result, Domain Brass Processes 72 can trust that other Domain Brass Processes may not read the keying material. The Domain Brass Process 72 signs the Domain Master Key record with the Domain Brass Process socret DES key before sending it to the Domain Archive 74. Thus, the Domain Brass Process 72 can trust that the Domain Master Key record was only modified by the Domain Brass Process 72. An example of a meter to Brass Process message is shown in Fig. 20.<br>
Audit Trail<br>
Key Management System 10 maintains an audit trail of time events in the life of a Domain Master Key, These events indicate when actions are taken by Key Management System 10. The time events listed must be increasing for successful Domain Master Key use. System messages with time events preceding previous events will be rejected. Verification requests received with dates preceding the Key Management System Key Registration time will be rejected.<br>
In the preferred embodiment of the present invention, the KMS Computer 24 records the KMS Request Time which is when a Request Key command is received from the Key Distribution Computer 30. The PSR Computer 34 records the PSR Install Time which is when an install Key command is delivered to a Steel Box 32. The KMS Computer 24 records the KMS Install Time which is when an Install Key Verification command is received Prom the Key<br>
Distribution Computer 30. The digital meter 36 records the Meter Registration Date which is whon a Register Indicia command is received from the communications port or user interface. The KMS Computer 24 records the KMS Key Registration Time which is when a Register Indicia Verification command is received from the digital meter.<br>
In an alternate embodiment, the Oak Box 20 records a<br>
local time when the Generate Key command is received from<br>
I<br>
the KMS computer 24, The Steel Box 32 records a local time when the Install Key command is received. The Brass Box 21 records a local time when a Key Verification request is received from Key Management System computer 24.<br>
Error Handling<br>
Key Management System 10 provides a set of error detection and reporting mechanisms for Key Management System service messages. Problems may occur when messages are prepared, sent over communications lines, received or processed by the receiving party. When errors are detected in the system, the command source will be notified and an entry will be made in the system Error Log.<br>
Referring now to Fig. 21, a block diagram showing an overview of error handling is provided. Errors in the system are detected in three different levels. The first level of error handling is implemented within the PB232<br>
/•<br>
protocol. This protocol provides for message framing through the use of STX and ETX control characters. Message identification is provided through the use of predefined Class Codes. Message integrity is provided through the use of error detection codes. If the received message complies with these mechanisms, the receiver will send a positive Acknowledgment control character. If not, the receiver will send a Non-Acknowledgment control character. The sending component may attempt to retry transmission of the message or take Other corrective action. PB232 error handling mechanisms are of a conventional type.<br>
The second level of error handling is implemented by Key Management System 10 command handler processes. These compare the received command with a set of expected commands as defined in a Command Table. The command field is verified. The number of expected parameters is checked. The syntax of individual parameters is checked. If any errors are found in the command/ a Command Error message will be returned to the command source.<br>
The third level of error handling is implemented by Key Management System 10 command handler processes. These compare the parameters in the command against a set of expected parameters as defined in a Configuration Table. Individual parameters are checked against the Configuration Table. The association of different parameters is checked against the Configuration Table. The availability of hardware resources and database records is cnecKea. signatures ot message components and the validity of encrypted message components are checked. If any errors are found in the command or during command processing, a Command Response message will be returned with a Response Code. If any errors are found in the Response, a Command Response Error message will be returned with a Response Code.<br>
Initialization Process<br>
The following paragraphs provide an overview of Key Management System 10 Secure Box Initialization Process, as shown in Figs, 22 and 23. As previously described, in the preferred embodiment of the present invention there I are four Key Management System Secure Box types. IManufacturing Box 23 is responsible for Key Management System and Secure Box initialization. O.ik Box 20 'is responsible for Domain Master Key Generation. Steel Box 32 is responsible for Domain Master Key installation. Brass Box 21 is responsible for Domain Master Key Registration and Token Verification. In an alternate embodiment, Tin Box is a Remote Token Verification Box.<br>
Referring now to Fig. 22, the First Manufacturing Box 23 must be initialized.   The Manufacturing Box<br>
operating software is loaded and tested. The Secure Box ID is initialized to MOOOOOOOO. When Manufacturing Box 23 is turned on, the Secure Box ID is queried. If it is set to MOOOOOOOO, Manufacturing BOX 2'd waits tor a set First Secure Box ID message from the KMS Computer 24. KMS Computer 24 then commands the First Manufacturing Box 23 to set the Secure Box ID to M00000001. First Manufacturing Box 23 then receives and checks the message. If no errors are found, First Manufacturing Box 23 generates an Operation Combination 101 and set of Operation Share keys 102. The Operation Share keys 102 are written to removable media.<br>
Next, First Manufacturing Box 23 generates two RSA key pairs, one for Domain Key Set Confidentiality and the other for Domain Key Set Authentication. These keys are broken into Domain Shares and written onto removable media. The keys are used to encrypt and sign Domain Key sets before they are sent to the KMS Computer 24 and written to the Archive or to removable media. First Manufacturing Box 23 generates a set of Secure Box Authentication keys. An RSA key pair is generated for each box type, i.e., Manufacturing, Oak, Steel and Brass. The public key for each box type is written to removable media. The keys must then be written irito Secure Box Operating Software by Software Engineering. After all the Operation Shares and authentication keys have been successfully written, the Secure Box ID will be set to M00000001.<br>
KMS Computer 24 requests Manufacturing Box 23 to create a Domain. Manufacturing Box 23 establishes the Domain ID in internal memory and generates the required Domain Keys 110 which are encrypted with the Domain Key Set 103 Confidentiality key and signed with the Domain Key Set 103 Authentication Key. The encrypted and signed Domain Keys are written to the Archive and/or to removable media.<br>
Additional Manufacturing Boxes 23 ate initialized by a Source Manufacturing Box, which is any manufacturing<br>
box that has been initialized. The Manufacturing Box operating software is loaded and tested in each additional Manufacturing Box 23. The Secure Box ID is set to MOOOOOOOO. When Manufacturing Box 23 is first turned on, it queries the Secure Box ID. If it is MQQQOQOQO, Manufacturing Box 23 waits for a Set Secure Box ID message from the Source Manufacturing Box. KMS Computer 24 commands the Source Manufacturing Box to initialize each additional Manufacturing Box 23. The Source Manufacturing Box allocates the next Manufacturing Secure Box ID, signs the message with the Manufacturing Box Private Startup Authentication Key and sends it to Manufacturing Box 23. Manufacturing Box 23 stores the Secure Box ID and generates a .Manufacturing Box Startup Confidentiality Key. The Secure Box ID and Public Startup Confidentiality Key are sent back to the Source Manufacturing Box and signed with the Manufacturing Box Private Startup Authentication Key. KMS Computer 24 commands the Source Manufacturing Box to make a Domain Manufacturing Process for the Manufacturing Box. The required Domain Key components are delivered to Manufacturing Box 23 using the Startup Confidentiality Key. This process is repeated for all required Domains.<br>
Any time domains are added to a Manufacturing Box 23, other initialized Manufacturing Boxes must be updated to reflect such additional domains. In the preferred embodiment, all ' initialized Manufacturing Boxes are configured with identical key data.<br>
For Oak Box initialization, the Oak Box operating software is loaded and tested. The Secure Box ID is set to 000000000, When Oak Box 20 is first turned on, it queries the Secure Box ID. If it is 000000000, Oak Box 20 waits for a Set Secure Box ID message from Manufacturing Box 23. KMS Computer 24 commands Manufacturing Box 23 to initialize Oak Box 20, Manufacturing Box 23 allocates the next Oak Secure Box •ID/ signs the message with the Private Oak Box Startup Authentication Key and sends it to Oak Box 20, which<br>
stores the Secure Box ID and generates an Oak Box Startup Confidentiality Key. The Secure Box 3D and Public Startup Confidentiality Key are sent back to the / Manufacturing Box, signed with the Oak Box Public Startup Authentication Key. KMS Computer 24 commands Manufacturing Box 23 to make a Domain Oak Process for Oak Box 20. The required Domain Key components are delivered to Oak Box 20 using the Startup Confidentiality Key. This process enables Oak Box 20 to implement the Domain oak Process /u tor one domain. This proce.ss is repeated for all domains required for a particular 0«ik Box.<br>
For Steel Box initialization/ the Steel Box operating software is loaded and tested. The Secure Box ID is set to SOOOOOOOO. When Steel Box 32 is first turned on, it queries the Secure Box ID, If it is SOOOOOOOO, Steel Box 32 waits for a Set Secure Box ID message from Manufacturing Box 23. KMS Computer 24 commands Manufacturing Box 23 to initialize Steel Box 32. Manufacturing Box 23 allocates the next St
&gt;. -<br>
Startup Authentication Key. KMS Computer 24 commands Manufacturing Box 23 to make a Domain Steel Process 76 for Steel Box 32. The required Domain Key components are delivered to Steel Box 32 using the Startup Confidentiality Key. This process enables Steel Box 32 to implement the Domain Steel Process 76 for one domain. This process is repeated for all domains required for a particular Steel Box.<br>
For Brass Box initialization, tho Brass Box operating software is loaded and tested. '['he Secure Box ID is set to BOOOOOOOO. When Brass Box 21 is first turned on, it queries the Secure Box IE. If it is BOOOOOOOO, Brass Box 21 waits for a Set Secure Box ID<br>
message from Manufacturing Box 23. KMS Computer 24 commands Manufacturing Box 23 .to initialize Brass Box 21. Manufacturing Box 23 allocatestthe next Brass Secure Box ID, signs the message with the Brass Box Private Startup Authentication Key and sends it to Brass Box 21. Brass Box 21 stores the Secure Box ID and generate a Brass Box Startup Confidentiality Key. The Secure Box ID and Public Startup Confidentiality Key are sent back to Manufacturing Box 23, signed with the Bra.ss Box Public Startup Authentication Key. KMS Computer 24 commands Manufacturing Box 23 to make a Domain Bratss Process for Brass Box 21. The required Domain Key components are delivered to Brass Box 21 using the Startup Confidentiality Key. This process enables Brass Box 21 to implement the Domain Brass Process for one domain. This process is repeated for all domains required for a particular Brass Box,<br>
Generation, Installation and Registration Process<br>
Referring now to Figs. 24-27, an overview of Key Management System 10 Domain Master Key Installation Process, is shown. • No distinctions exis-; between the vendor and any postal Domain, Each operates in a similar independent manner. To successfully install a full set of Domain master keys to the digital meter 36, the set of operations are run for the vendor Domain and another set of operations are run for the selected posted Domain.<br>
Referring now to Figs. 24, 29 and 30, Domain Master Key Requests come from the Key Distribution Computer 30<br>
during the manufacturing procoee manufacturing1.  At 300,<br>
the requests are sent with an identification number of Steel Box 32 from Key Distribution Computer 30 to KMS Computer 24 in message MIO. KMS Computer 24 requests Key ID at 302 from Domain Archive 74 which th«n generates a unique Key ID for the Domain. At 304 Domain Archive 74 sends a Key ID Response to KMS Computer 24 in message MIO' , , KMS Computer 24 records a local tim
to determine the validity of the Domain, the validity of the Steel Box ID for the Domain and if the Key ID is higher than the last one processed for this Domain. If any of the checks prove false, Oak Box 20 returns a fail message to KMS Computer 24. If the checks are true/ Oak Box 24 generates a Domain Master Key and set of Test' tokens. At 308, Oak Box 20 delivers a Domain Master Key Record to KMS Computer 24 in message MI2, At 310 KMS Computer 24 forwards the Domain Master Key Record to Domain Archive 74 in message MI3, Domain Archive 74 stores the Domain Master Key Record in the database and a response is sent to KMS Computer 24 at 312,, At 314, KMS Computer 24 forwards the response to Oak Box 20 which sends a Generate Response message to KMS Computer 24 at 316. At 318. KMS Computer .24 sp.nris t.YiA Tnat-al 1 K*»y Record to Key Distribution Computer 30 in a Request Response message MI4.<br>
Referring now to Fig. 25, when a digital meter 36 is presented on the Manufacturing Line, the P15R computer 34 requests an install domain key record from the key distribution computer 30 at 330. At 330, Key Distribution Computer 30 sends an install domain key record to the PSR Computer in message MI4' which is further sent to Steel Box 32 at 334. Steel Box 32 queries the digital meter 36 for information, then at 336 sends the Domain Master Key in message MIS to digital meter 36. The digital meter installs and checks the key and return status to Steel Box 32 which queries the digital meter for a set of Meter Test tokens. At 338, the Meter Test tokens are returned in messaige MI6 to the Steel Box 32, which checks the Meter Test tokens against those received from Oak Box 20. Thus, Steel Box 32 checks that the Domain Master Key generated by Oak Box 24 is the same as the key installed in the digital meter 36. At 340, Steel box 32 forwards the installation status and information in message MI7 to the Key Management Computer 24 through the PSR computer and Key Distribution Computer 30. Key Management Computer 24 retrieves a domain master<br>
key record from the domain archive/ takes a local time<br>
otomp    <and. foirwaifdo information to b: bo in></and.>
message MIS. Brass Box 21 generates test tokens from the Domain Master Key record from the Domain Archive 74. These are compared with the Meter Test tokens. This checks that the Domain Master Key in the Domain Archive is the same as the key installed, in the digital meter. If they check out/ the Domain Master Key record is updated and forwarded in message MI9 to the Key Management Computer 24 at 344. The Key Management Computer 24 forwards in message MI9 the'Domain Master Key Record to Domain Archive 74 and if successful returns a response to the Brass Box 21 at 346, Brass Box 21 checks response and returns a success or failure verification to KMS Computer 24 at 348 and to Key Distribution Computer 30 in message MHO,<br>
Key registration consists of associating the country of registration, and the indicia number with the product code number and the key. The key is then stored in the country sub-domain of the install domain using a secret key that is specific to the country sub-domain. . The essential feature is that the brass process that is specific to that country sub-domain relies on the install domain to install keys securely and with integrity. Keys never transfer from one install domain to another.<br>
Referring now to Figs. 26 and 31/ when the digital meter is prepared for a specific Security Domain, the Indicia Serial Number and/or Product Code Number is entered into the digital meter in message MR1. The PSR computer 34 requests registration tokens from digital meter 36 at 360. The digital meter generates two digital tokens and returns them the PSR computer at 362, The PSR computer combines the tokens with other meter information and forwards the resulting record to the Key Management Computer 24 through the Key Distribution Computer 30 at 364. At 366 Key Management System Computer 24 retrieves a domain master key record from the domain archive, takes a local time stamp and forwards<br>
information to Brass Box 21 in message MR2. Brass Box 21 generates registration tokens from the Domain Master Key record from the Domain Archive 74. Theses are compared with the Meter Registration tokens. This checks that the Indicia Serial Number/ Product Code Number and Manufacturing Sequence Number were correctly reported by the Digital Meter, If they check out/ the Domain Master Key record is updated and forwarded to the KMS Computer 24 at 363. Key Management System Computer 24 forwards the domain master key record to Domain Archive 74 in message MR3 and if successful returns a response to the Brass Box. 21 at 370, Brass Box 21 checks; response and returns a success or failure verification in message MR4 to Key Management System Computer 24 at 372..<br>
Every domain has at least one sub-domain that is responsible for registering keys to indicia numbers and performing indicia verification within that sub-domain. The Earth domain in particular has several, country sub-domains. It is possible for one country *:o have meters in a sub-domain of the Earth domain and meters in the unique sub-domain of its own postal domain. In the example shown in Fig. 32/ Country 3 has both- a unique postal domain and a postal sub-domain of the earth domain. However/ Country A has only meters that have keys which are installed within that country's unique postal domain*<br>
Referring now to Fig. 27, if a digital meter is taken out of service, the information is recorded and sent to the KMS Computer 24. Key Management Computer 24 retrieves a domain master key record from the domain archive/ takes a local time stamp an forwards information to Brass box 21 at 380. The Domain Master Key record is updated and forwarded to the Key Management Computer 24 at 38"2\ The key management computer forwards the domain master key record to the domain archive and if successful returns a response to the Brass Box 21 at 384. Brass Box 21 checks response and returns a succests or failure verification to Key Management Computer 24 at 386.<br>
Generation of Tokens<br>
Each meter uses the Domain Master Key to generate a temporal key, also referred to herein as a token key, for , each domain, which is used to generate a token from mailpiece data. The Key Management System may distribute postal temporal keys to authorized postal, verification sites having a Distributor Token Verification Box 44 (Fiy. 1) / also leTe-irea tu Ueielu as T4.U Bo*.<br>
temporal keys are used by Tin Box 
Verification Process<br>
The following paragraphs provide an overview of Key Management System 10 Verification Process. There are no distinctions between the vendor and any postal Domain. Each operates in a similar manner, independently. To successfully verify both tokens/ the set of operations are run for the • vendor Domain and another set of operations are run for the selected postal Domain.<br>
Token Verification Requests come from a data capture system 19 located at Mail Facility 18. The request contains an ASCII text representation of information printed on a physical mail piece. Referring now to Fig. 28, at 400 the request is sent to a Key Management System Computer 24 located in the vendor or postal Data Centers. The Key Management System Computer 24 inspects the Mail Piece Data check digits and makes corrections if necessary. Key Management Computer 24 retrieves a domain master key record from the domain archive and forwards information to Brass box 21 at 402. Brass Box 21 checks the request and verifies that the Domain Master Key is Active. Brass Box 21 recalculates the selected domain's token using the Domain Master Key from the Domain Archive and the mail piece information. The calculated token is compared with the mail piece token to see if they match.<br>
A good/bad comparison result is sent to th-a KMS Computer 24 at 404. A second example is shown i.n Fig. 28 to highlight that an additional verification is required to verify the other domain token.<br>
The foregoing description of the present invention is the preferred embodiment wherein t;he Post has authorized a Vendor to generate Postal Master Keys and install them into digital meters. The keys are then sent to Postal Data Center 16 to be used for postal token validation. The Key Management System includes the capability for different distribution of functionality, secure boxes and databases. For example, in one alternate embodiment, a Post authorizes the Vendor or another party to maintain and' operate the Postal Data Center 16, including the functions o:f postal key generation, _ maintenance, token validation and communicating keys to vendors, In this embodiment/ the Postal Brass Box 40 and the Postal Key Archive 42 are physically located at the site of the V€;ndor or other party. In another embodiment, the Post manages its Data Center and the Postal Oak Box 22 is physically located at the Postal Data Center 16.<br>
In another alternate embodiment (not shown) any combination of the Key Management System functionality, i.e. domain oak process, domain steel process or domain brass process, could be integrated into any of the secure boxes.<br>
Thus, it will be understood that the Key Management '• System has an inherent flexibility that allows different domains, i.e., Posts, to implement different physical implementations of the same logical Key Management System. The Key Management System provides such flexibility while maintaining a high level of system integrity and security. It will be further understood that the present invention allows multiple vendors to support multiple posts.<br>
The present invention has been described for a preferred embodiment relating to digital postage meter<br>
evidencing. It will be understood by these skilled in the art that the present invention is also suitable for use as a Key Management System for transaction evidencing in general/ such as for monetary transactions, item transactions and information transactions.<br>
As used herein/ the term "digital postage meter7' refers to conventional types of digital postage meters that are coupled to secured printing roe*ns and other-types of digital postage meters that are coupled to unsecured printing means or have other configuration differences from such • conventional digital postage meters.<br>
While the present invention, has been disclosed and described with reference to a single embodiment thereof/ it will be apparent/ as noted above that variations and modifications may be made therein. It is/ thus/ intended in the fol Towing claims to cover each variation and modification that falls within the true spirit and scope of the present invention.<br><br><br><br><br>
We claim:<br>
1.	A Key Management apparatus (10) for generating, distributing<br>
and   managing   cryptographic   keys   used   by   a   transaction<br>
evidencing device  (36) that uses cryptographic operations to<br>
produce evidence  of information integrity,  the cryptographic<br>
keys having master keys used to generate temporal keys, the<br>
temporal keys utilized for generation and verification of indicia,<br>
the system comprising:<br>
a first master key generating device (20) and a second master key generating device (22);<br>
a plurality of computers (24, 30, 42, 46) communicatively coupled to each other to control operation of said key management apparatus;<br>
a plurality of domain storage devices (25, 45) communicatively coupled to said plurality of computers corresponding respectively to a plurality of separate logical security domains, each of said security domains providing domain processes for key generation, key installation, key verification and verification of the evidence of information integrity produced by said transaction evidencing device within said domain, said domain storage devices provided with recording key status records and master keys for each domain;<br>
an installation device (32) for installing said master keys in the transaction evidencing device; and<br>
a plurality of verification devices (21, 40) for verifying said evidence of information integrity.<br>
2.	The Key Management apparatus as claimed in claim 1, wherein<br>
said plurality of computers (24, 30, 42, 46) consists of a first<br>
key management computer (24)  communicatively coupled to<br>
said first and second master key generating devices (20, 22),<br>
said plurality of verification devices (20, 22), and said domain<br>
storage   devices   (25,   45),   a  key  distribution  computer   (30)<br>
communicatively   coupled    to    said    first   key   management<br>
computer (24), said key distribution computer (30) controlling<br><br>
distribution of said master key for installation into said transaction evidencing device (36), and a second key management computer (42) communicatively coupled to said first key management computer (24) and said key distribution computer (30) for monitoring the Key Management apparatus (10).<br>
3.	The Key Management apparatus as claimed in claim fi, wherein<br>
said plurality of computers (24, 30,  42,  46) comprises of a<br>
distributed key management computer (46)  communicatively<br>
coupled to said second key management computer (42) and<br>
located at a verification site, said distributed key management<br>
computer    (46)    controlling    verification    by    a    distributed<br>
verification device (44) of the evidence of information integrity<br>
produced by said transaction evidencing device (36).<br>
4.	The Key Management apparatus s claimed in claim 1, wherein<br>
said evidence of information integrity is a digital token.<br>
5.	The Key Management apparatus as claimed in claim  1  and<br>
claim 4 wherein the transaction evidencing device  (36) is a<br>
digital postage meter and the evidence of information integrity<br>
has evidence of postage payment.<br>
6.	A Key Management apparatus for generating, distributing and<br>
managing cryptographic keys used by a transaction evidencing<br>
device   that  uses   cryptographic   operations   substantially  as<br>
hereinbefore described with reference to and as illustrated in<br>
the accompanying drawings.<br></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAwLWRlbC0xOTk2LWFic3RyYWN0LnBkZg==" target="_blank" style="word-wrap:break-word;">700-del-1996-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAwLWRlbC0xOTk2LWFzc2lnbm1lbnQucGRm" target="_blank" style="word-wrap:break-word;">700-del-1996-assignment.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAwLWRlbC0xOTk2LWNsYWltcy5wZGY=" target="_blank" style="word-wrap:break-word;">700-del-1996-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAwLWRlbC0xOTk2LWNvbXBsZXRlIHNwZWNpZmljYXRpb24gKGdyYW50ZWQpLnBkZg==" target="_blank" style="word-wrap:break-word;">700-del-1996-complete specification (granted).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAwLURFTC0xOTk2LUNvcnJlc3BvbmRlbmNlLU90aGVycy5wZGY=" target="_blank" style="word-wrap:break-word;">700-DEL-1996-Correspondence-Others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAwLWRlbC0xOTk2LWNvcnJlc3BvbmRlbmNlLXBvLnBkZg==" target="_blank" style="word-wrap:break-word;">700-del-1996-correspondence-po.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAwLWRlbC0xOTk2LWRlc2NyaXB0aW9uIChjb21wbGV0ZSkucGRm" target="_blank" style="word-wrap:break-word;">700-del-1996-description (complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAwLWRlbC0xOTk2LWRyYXdpbmdzLnBkZg==" target="_blank" style="word-wrap:break-word;">700-del-1996-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAwLWRlbC0xOTk2LWZvcm0tMS5wZGY=" target="_blank" style="word-wrap:break-word;">700-del-1996-form-1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAwLWRlbC0xOTk2LWZvcm0tMTMucGRm" target="_blank" style="word-wrap:break-word;">700-del-1996-form-13.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAwLWRlbC0xOTk2LWZvcm0tMi5wZGY=" target="_blank" style="word-wrap:break-word;">700-del-1996-form-2.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAwLURFTC0xOTk2LUZvcm0tMy5wZGY=" target="_blank" style="word-wrap:break-word;">700-DEL-1996-Form-3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAwLURFTC0xOTk2LUZvcm0tNC5wZGY=" target="_blank" style="word-wrap:break-word;">700-DEL-1996-Form-4.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAwLWRlbC0xOTk2LWZvcm0tNi5wZGY=" target="_blank" style="word-wrap:break-word;">700-del-1996-form-6.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAwLURFTC0xOTk2LUdQQS5wZGY=" target="_blank" style="word-wrap:break-word;">700-DEL-1996-GPA.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAwLWRlbC0xOTk2LXBldGl0aW9uLTEzNy5wZGY=" target="_blank" style="word-wrap:break-word;">700-del-1996-petition-137.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=YWJzdHJhY3QuanBn" target="_blank" style="word-wrap:break-word;">abstract.jpg</a></p>
		<br>
		<div class="pull-left">
			<a href="197466-apparatus-and-method-for-integrating-phone-communications-and-data-transmissions-on-lans.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="197472-a-device-for-use-in-percutaneous-dilational-ostomy.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>197469</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>700/DEL/1996</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>40/2007</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>05-Oct-2007</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>09-Mar-2007</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>29-Mar-1996</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>PITNEY BOWES INC</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>WORLD HEADQUARTERS, ONE ELMCROFT, STAMFORD, CONNECTICUT 06926-0700, U.S.A.</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>WALTER JOHN BAKER</td>
											<td>378 NORTH ABRAM STREET, STRATFORD, CT 06497, U.S.A.</td>
										</tr>
										<tr>
											<td>2</td>
											<td>FELIKS BATOR</td>
											<td>89 BURROUGHTS ROAD, EASTON, CT 06612, U.S.A.</td>
										</tr>
										<tr>
											<td>3</td>
											<td>ROBERT ARTHUR CORDERY</td>
											<td>11 1/2 JEANETTE STREET, DANBURY, CT 06811, U.S.A.</td>
										</tr>
										<tr>
											<td>4</td>
											<td>LOUIS JOHN LOGLISCI</td>
											<td>555 HOPE STREET, STREET, STAMFORD, CT 06907, U.S.A.</td>
										</tr>
										<tr>
											<td>5</td>
											<td>KEVIN D. HUNTER</td>
											<td>1 FRANCINE LANE, E. SETANKET, NY 11733, U.S.A.</td>
										</tr>
										<tr>
											<td>6</td>
											<td>KATHRYN V. LAWTON</td>
											<td>42 ROCK PASTURE ROAD, BRANFORD, CT 06045, U.S.A.</td>
										</tr>
										<tr>
											<td>7</td>
											<td>STEVEN JAMES PAULY</td>
											<td>10 SURREY LANE, NEW MILFORD, CT 06776, U.S.A.</td>
										</tr>
										<tr>
											<td>8</td>
											<td>LEON ARON PINTSOV</td>
											<td>365 MOUNTAIN ROAD, WEST HARTFORD, CT 06107, U.S.A.</td>
										</tr>
										<tr>
											<td>9</td>
											<td>FREDERIC WALTER RYAN, JR.,</td>
											<td>4 NAPLES LANE, OXFORD, CT 06478, U.S.A.</td>
										</tr>
										<tr>
											<td>10</td>
											<td>MANROE ALDEN WEIANT, JR.</td>
											<td>249 PUTTING GREEN ROAD, TRUMBULL, CT 06611, U.S.A.</td>
										</tr>
										<tr>
											<td>11</td>
											<td>GARY M. HIDEN</td>
											<td>14 WOODSEND AVENUE, SHELTON, CT 06484, U.S.A.</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04L 9/08</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>N/A</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td></td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>08/414,563</td>
									<td>1995-03-31</td>
								    <td>U.S.A.</td>
								</tr>
								<tr>
									<td>2</td>
									<td>08/553,812</td>
									<td>1995-10-23</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/197469-key-management-apparatus by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 07:57:15 GMT -->
</html>
