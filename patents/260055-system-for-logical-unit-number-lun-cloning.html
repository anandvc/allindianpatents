<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/260055-system-for-logical-unit-number-lun-cloning by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 04 Apr 2024 22:57:08 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 260055:SYSTEM FOR LOGICAL UNIT NUMBER ( LUN) CLONING</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">SYSTEM FOR LOGICAL UNIT NUMBER ( LUN) CLONING</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>A storage system with a writable virtual disk (vdisk) and a backing store, the storage system, comprising: a backdoor message handler [626] adapted to load blocks of the writable vdisk [1000] and backing store [1050] from disk [430] into a memory [424] of the storage system . [400]; a writable vdisk indirect block (1030) in the memory [424] having a plurality of fields, (1031-1036) each field (1031-1036) storing a valid pointer to a data block (1090) or an invalid pointer representing a hole; a backing store indirect block (1080) in the memory [424] having a plurality of fields (1081-1086), each backing store indirect block field (1081-1086) corresponding to a field (1031-1036) of the writable vdisk indirect block (1030), each backing store indirect block field (1081-1086)having a pointer to a data block; a special loading function [1040] for searching each field (1031-1036) of the writable vdisk indirect block (1030) for one or more fields (1035) representing a hole; and a write allocator [628] for replacing each field (1035) representing a hole in the writable vdisk indirect block (1030) with a new pointer to the data referenced by the corresponding backing store indirect block field (1085).</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>The present invention relates to system for logical unit number separating.<br>
BACKGROUND OF THE INVENTION<br>
Field of the Invention<br>
The present invention relates to storage systems and, more specifically, to a technique that conserves storage resources of a storage system.<br>
Background Information<br>
A storage system is a computer that provides storage service relating to the or-ganization of information on writable persistent storage devices, such as memories, tapes or disks. The storage system is commonly deployed within a network attached storage (NAS) or storage area network (SAN) environment A SAN is a high-speed network that enables establishment of direct connections between a storage system, such as an application server, and its storage devices. The SAN may thus be viewed as an extension to a storage bus and, as such, an operating system of the storage system enables access to stored information using block-based access protocols over the "ex-tended bus".. In this context, the extended bus is typically embodied as Fibre Channel (FC) or Ethernet media (i.e., network) adapted to operate with block access protocols, such as Small Computer Systems Interface (SCSI) protocol encapsulation over FC or Transmission Control Protocol/Internet Protocol (TCP/IP)/Ethemet<br>
SCSI is a peripheral input/output (I/O) interface with a standard, device independent protocol that allows different peripheral storage devices, such as disks, to at-tach to the storage system. In SCSI terminology, clients operating in a SAN environment are initiators that initiate requests and commands for data. The storage system is a target configured to respond to the requests issued by the initiators in accordance with a request/response protocol. The SAN clients typically identify and address the stored information in terms of blocks situated within target disks, or logical units thereof (also referred to within the industry as logical unit numbers or luns).<br>
When used within a NAS environment, the storage system may be embodied as<br>
a file server including an operating system that implements a file system to logically<br>
organize the information as a hierarchical structure of directories and files on, e.g., the<br>
disks. Each "on-disk" file may be implemented as a set of data structures, e.g., disk<br>
blocks, configured to store information, such as the actual data for the file. The data<br>
blocks are typically organized within a volume block number (vbn) space that is maintained<br>
by the file system. The file system may also assign each data block in the file a<br>
corresponding "file offset" or file block number (fbn). The file system typically assigns<br>
sequences of fbns on aper-file basis, whereas vbns are assigned over a larger volume<br>
address space. The file system organizes the data blocks within the vbn space as a<br>
"logical volume"; each logical volume may be, although is not necessarily, associated<br>
with its own file system. A directory, on the other hand, may be implemented as a specially<br>
formatted file in which information about other files and directories are stored.<br>
The file server, or filer, of a NAS system may be further configured to operate<br>
according to a client/server model of information delivery to thereby allow many client<br>
systems (clients) to access shared resources, such as files, stored on the filer. In the client/<br>
server model, the client may comprise an application executing on a computer that<br>
"connects" to the filer over a computer network, such as a point-to-point link, shared<br>
local area network, wide area network or virtual private network implemented over a<br>
public network, such as the Internet. The clients typically communicate with the filer<br>
by exchanging discrete frames or packets of data according to pre-defined protocols,<br>
such as the TCP/IP. NAS systems generally utilize file-based access protocols; therefore,<br>
each client may request the services of the filer by issuing file system protocol<br>
messages (in the form of packets) to the file system over the network.<br>
A common type of file system is a "write in-place" file system, an example of<br>
which is the conventional Berkeley fast file system. In a write in-place file system, the<br>
locations of the data structures, such as index nodes (inodes) and data blocks, on disk<br>
are typically fixed. An inode is a data structure used to store information, such as<br>
metadata, about a file, whereas the data blocks are structures used to store the actual<br>
data for the file. The information contained in an mode may include, e.g., ownership of<br>
the file, access permission for the file, size of the file, file type and references to loca-<br>
tions on disk of the data blocks for the file. The references to the locations of the file<br>
data are provided by pointers, which may further reference indirect blocks that, in turn,<br>
reference the data blocks, depending upon the quantity of data in the file. Changes to<br>
the inodes and data blocks are made "in-place" in accordance with the write in-place<br>
file system. If an update to a file extends the quantity of data for the file, an additional<br>
data block is allocated and the appropriate inode is updated to reference that data block.<br>
Another type of file system is a write-anywhere file system that does not overwrite<br>
data on disks. If a data block on disk is retrieved (read) from disk into memory<br>
and "dirtied" with new data, the data block is stored (written) to a new location on disk<br>
to thereby optimize write performance. An example of a write-anywhere file system<br>
that is configured to operate on a filer is the Write Anywhere File Layout (WAFL™)<br>
file system available from Network Appliance, Inc. of Sunnyvale, California. The<br>
WAFL file system is implemented within a microkernel as part of the overall protocol<br>
stack of the filer and associated disk storage. This microkernel is supplied as part of<br>
Network Appliance's Data ONTAP™ storage operating system residing on the filer.<br>
The WAFL file system has the capability to generate a snapshot of its active file<br>
system. An "active file system" is a file system to which data can be both written and<br>
read, or, more generally, an active store that responds to both read and write I/O operations.<br>
Further, it should be noted that "snapshot" is a trademark of Network Appliance,<br>
Inc. and is used for purposes of this patent to designate a persistent consistency point<br>
(CP) image. A persistent consistency point image (PCPI) is a space conservative,<br>
point-in-time read-only image of data accessible by name that provides a consistent image<br>
of that data at some previous time. More particularly, a PCPI is a point-in-time<br>
representation of a storage element, such as an active file system, file or database,<br>
stored on a storage device (e.g., on disk) or other persistent memory and having a name<br>
or other identifier that distinguishes it from other PCPIs taken at other points hi time.<br>
A PCPI can also include other information (metadata) about the storage element at the<br>
particular point in time for which the image is taken. The terms "PCPI" and "snapshot"<br>
may be used interchangeably through out this patent without derogation of Network<br>
Appliance's trademark rights.<br>
A file system, such as the WAFL file system, supports multiple snapshots that<br>
are generally created on a regular schedule. Each snapshot is a restorable version of the<br>
storage element (e.g., the active file system) created at a predetermined point in time<br>
and, as noted, is "read-only" accessible and "space-conservative". Space conservative<br>
denotes that common parts of the storage element in multiple snaphots share the same<br>
file system blocks. Only the differences among these various snapshots require extra<br>
storage blocks. The multiple snapshots of a storage element are not independent copies,<br>
each consuming disk space; therefore, creation of a snapshot on the WAFL file system<br>
is instantaneous, since no entity data needs to be copied. Read-only accessibility<br>
denotes that a snapshot cannot be modified because it is closely coupled to a single writable<br>
image in the active file system. The closely coupled association between a file in<br>
the active file system and the same file in a snapshot obviates the use of multiple<br>
"same" files. In the example of a WAFL based file system, snapshots are described in<br>
TR3002 File System Design for a NFS File Server Appliance by David Hitz et al., published<br>
by Network Appliance, Inc. and in U.S. Patent No. 5,819,292 entitled Method for<br>
Maintaining Consistent States of a File System and.For Creating User-Accessible<br>
Read-Only Copies of a File System, by David Hitz et al., each of which is hereby incorporated<br>
by reference as though full set forth herein.<br>
Broadly stated, a snapshot is stored on-disk along with the active file system,<br>
and is called into a memory of a filer as requested by an operating system. The on-disk<br>
organization of the snapshot and the active file system'can be understood from the following<br>
description of an exemplary file system inode structure 100 shown in Fig. 1.<br>
The inode for an inode file 105 contains information describing the mode file associated<br>
with the active file system. In mis exemplary file system inode structure, the inode<br>
for the inode file 105 contains a pointer that references (points to) an inode file indirect<br>
block 110. The inode file indirect block 110 contains a set of pointers that reference<br>
inodes 117 which, in turn, contain pointers to indirect blocks 119. The indirect blocks<br>
119 include pointers to file data blocks 120A, 120B and 120C. Each of the file data<br>
blocks 120(A-C) is capable of storing, e.g., 4 kilobytes (kB) of data. When the file system<br>
generates a snapshot of its active file system, a snapshot inode is generated as<br>
shown in Fig. 2. The snapshot inode 205 is, in essence, a duplicate copy of the inode<br>
for the inode file 105 of the file system 100 that shares common parts, such as inodes<br>
and blocks, with the active file system. For example, the exemplary file system structure<br>
200 includes the inode file indirect blocks 110, inodes 117, indirect blocks 119 and<br>
file data blocks 120A-C as in Fig. 1<br>
When a user modifies a file data block, the file system writes the new data block<br>
to disk and changes the active file system to point to the newly created block. Fig. 3<br>
shows an exemplary inode file system structure 300 after a file data block has been<br>
modified. In this example, file data block 120C is modified to file data block 120C'.<br>
As a result, the contents of the modified file data block are written to a new location on<br>
disk as a function of the exemplary file system. Because of this new location, the indirect<br>
block 319 must be rewritten. Due to this changed indirect block 319, the inode 317<br>
must be rewritten. Similarly, the inode file indirect block 310 and the inode for the<br>
mode file 305 must be rewritten.<br>
Thus, after a file data block has been modified the snapshot inode 205 contains<br>
a pointer to the original inode file indirect block 110 which, hi turn, contains pointers<br>
through the mode 117 and indirect block 119 to the original file data blocks 120A,<br>
120B and 120C. The newly written indirect block 319 also includes pointers to unmodified<br>
file data blocks 120A and 120B. That is, the unmodified data blocks hi the<br>
file of the active file system are shared with corresponding data blocks in the snapshot<br>
file, with only those blocks that have been modified in the active file system being different<br>
than those of the snapshot file.<br>
However, the indirect block 319 further contains a pointer to the modified file<br>
data block 120C' representing the new arrangement of the active file system. Anew<br>
inode for the inode file 305 is established representing the new structure 300. Note that<br>
metadata (not shown) stored in any of the snapshotted blocks (e.g., 205,110, and 120C)<br>
protects these blocks from being recycled or overwritten until they are released from all<br>
snapshots. Thus, while the active file system inode for the mode file 305 points to new<br>
blocks 310,317,319,120A, 120B and 120C', the old blocks 205,110 and 120C are<br>
retained until the snapshot is fully released.<br>
Snapshots provide a versatile feature that is essential for data recovery operations,<br>
such as backup and recovery of storage elements. However, since snapshots are<br>
read-only accessible and their contents cannot be modified, their use may be somewhat<br>
limited, particularly for operating systems and applications that do not have a notion of<br>
a read-only data store (a read-only file system) and that expect to write metadata at any<br>
time that the file system is accessible. This limitation may be overcome by using writable<br>
read-only snapshot technique as described in U.S. Patent Application Serial No.<br>
10/412,478 entitled Writable Read Only Snapshots, by Vijayan Rajan. A writable,<br>
read-only snapshot comprises a read-only "image" (file) residing in a snapshot and a<br>
writable virtual disk (vdisk) residing in the active file system. The writable vdisk is a<br>
"shadow" image of the snapshot file and, as such, includes an attribute that specifies the<br>
snapshot file to be used as a backing store. According to the technique, a write operation<br>
directed to the writable read-only snapshot is "trapped" such that the data associated<br>
with the operation is stored on the shadow, vdisk image in the active file system.<br>
In other words rather than directly accessing the read-only snapshot image of a lun, a<br>
client accesses the writable vdisk image, which provides a translucent view of the underlying<br>
read-only snapshot image. The writable vdisk is a sparse file containing only<br>
that data written by the client (e.g., an initiator in a SAN) to the read-only snapshot image<br>
subsequent to a snapshot operation to a volume underlying the lun (vdisk).<br>
To the client, the data retrieved from the writable, read-only snapshot is always<br>
the latest data written. The client "sees" the writable vdisk data first (if it exists) and is<br>
served that data, the underlying read-only snapshot image being inaccessible for the<br>
range of valid data in the writable vdisk. Read-only data from the underlying snapshot<br>
unage is delivered to the client when no valid data overlying the range exists in the writable<br>
vdisk. The underlying snapshot image is accessible and recoverable via a nontranslucent<br>
path of directly accessing the snapshot image. By this technique, data integrity<br>
of a snapshotted lun or vdisk (as an inviolate backup) is preserved.<br>
The writable read only snapshot technique allows many writable vdisks to be<br>
"tied" to a single backing store snapshot file. This backing store file may be quite large<br>
consuming substantial storage (disk) space. After a period of time, it may be desirable<br>
to delete the backing store and free the disk space it consumes. Yet the backing store<br>
may not be deleted as long as it is referenced by at least one writable vdisk, even if that<br>
vdisk has totally diverged from the backing store. That is, if the backing store is refer-<br>
enced by a writable vdisk, it cannot be deleted even if every data block in the vdisk has<br>
been modified from its original state in the backing store.<br>
Previous solutions to this problem have required taking the writable vdisk offline<br>
while the backing store is being released. This is undesirable since it creates downtune<br>
visible to client applications served by the filer or storage system and substantially<br>
decreases system performance. Other proposed solutions have involved restoring the<br>
backing store to the active file system using a technique such as single file snap restore<br>
(SFSR) described in US Patent Application Serial No. 10/100,948 entitled-System and<br>
Method for Restoring a Single File from a Snapshot. Yet this is not a desirable solution<br>
because the restored snapshot does not contain the contents of modified data blocks,<br>
such as modified data block 120C', and rather reflects an older version of the of data<br>
blocks, such as old version 120C. Further any technique involving SFSR would generally<br>
render the snapshot inaccessible for the duration of the restore operation.<br>
What is needed is a "zero-downtime" technique to delete a snapshot and free its<br>
consumed disk space.<br>
SUMMARY OF THE INVENTION<br>
The present invention overcomes the disadvantages of the prior art by providing<br>
a novel logical unit number (LUN) cloning technique that "separates" data blocks referenced<br>
by a writable virtual disk (vdisk) from data blocks referenced only by a backing<br>
store. LUN cloning, in this context, denotes separating the data blocks to create an<br>
independent vdisk from the writable vdisk. This, in turn, allows the backing store data<br>
blocks to be deallocated, to thereby conserve storage resources of a storage system,<br>
such as a multi-protocol storage appliance. Notably, separation of the writable vdisk<br>
data blocks from the backing store occurs without interrupting service of data access<br>
requests and preferably occurs during periods of reduced processing activity.<br>
In the illustrative embodiment, a file system invokes a "backdoor" message handler<br>
that loads blocks of the writable vdisk, and its backing store file, from disk into a<br>
buffer cache of the storage appliance. The loaded blocks are represented as vdisk and<br>
backing store buffer trees that include, among other structures, indirect blocks. A special<br>
vdisk loading function of the file system "walks through" all the indirect blocks of<br>
the writable vdisk, searching for invalid values of volume block number (VBN) pointers.<br>
While a valid VBN pointer (e.g., a non-zero value) directly references a data<br>
block, an invalid VBN pointer represents a "hole." A hole instructs the file system to<br>
examine the value of the VBN pointer in a corresponding indirect block of the backing<br>
store.<br>
If the VBN pointer of the backing store has a non-zero value, the backdoor message<br>
handler loads the "old" data block referenced by the VBN pointer into the buffer<br>
cache and marks that block as "dirty," without changing its data contents. A write allocator<br>
of the file system thereafter "write allocates" the dirty block by, e.g., choosing a<br>
new VBN for a newly allocated block, setting appropriate bits hi block allocation structures,<br>
placing the chosen VBN into the appropriate indirect block of the writable vdisk,<br>
and deleting (freeing) the old data block prior to storing (writing) the new block to disk.<br>
This process is repeated for all instances of holes discovered in the indirect blocks of<br>
the writable vdisk.<br>
The file system then "releases" an association of the writable vdisk to the backing<br>
store by, e.g., deleting a backing store file handle reference from an attributes mode<br>
of the writable vdisk. In addition, the file system updates an appropriate entry of a<br>
vdisk table of contents (VTOC) structure to remove the backing store file handle reference<br>
Advantageously, the inventive technique uses backdoor messaging to separate<br>
the writable vdisk data blocks from the backing store, thereby obviating the need to<br>
take the writable vdisk data blocks offline. Thus the LUN ckming technique results in<br>
zero-downtime for the multi-protocol storage appliance and is transparent to client applications<br>
served by the storage appliance.<br>
BRIEF DESCRIPTION OF THE DRAWINGS<br>
The above and further advantages of the invention may be better understood by<br>
referring to the following description in conjunction with the accompanying drawings<br>
hi which like reference numerals indicate identical or functionally similar elements:<br>
Fig. 1 is a schematic block diagram of an exemplary file system inode structure;<br>
Fig. 2 is a schematic block diagram of the exemplary file system inode structure<br>
of Fig. 1 including a snapshot inode;<br>
Fig. 3 is a schematic block diagram of an exemplary file system inode structure<br>
of Fig. 2 after a data block has been rewritten;<br>
Fig. 4 is a schematic block diagram of a multi-protocol storage appliance that<br>
may be advantageously used with the present invention;<br>
Fig. 5 is a schematic block diagram of a storage operating system of the multiprotocol<br>
storage appliance that may be advantageously used with the present invention;<br>
Fig. 6 is a schematic block diagram of a virtualization system that is implemented<br>
by a file system interacting with virrualization modules of the storage operating<br>
system;<br>
Fig. 7 is a schematic block diagram of an on-disk inode data structure that may<br>
be advantageously used with the present invention;<br>
Fig. 8 is a schematic block diagram illustrating an on-disk representation of virtual<br>
disk (vdisk) inode data structures, including logical unit number (LUN) and attributes<br>
inodes, that may be advantageously used with the present invention;<br>
Fig. 9 is a schematic block diagram illustrating writable read-only snapshots,<br>
each comprising a writable virtual disk (vdisk) and a backing store, that may be advantageously<br>
used with the present invention;<br>
Fig. 10A is a schematic block diagram illustrating writable vdisk and backing<br>
store buffer trees that may be advantageously used with the present invention;<br>
Fig. 1 OB is a schematic block diagram illustrating level 1 buffers for the writable<br>
vdisk and backing store that may be advantageously used with the present invention;<br>
and<br>
Fig. 11 is a flowchart illustrating a sequence of steps pertaining to a logical unit<br>
number (LUN) cloning technique of the present invention.<br>
DETAILED DESCRIPTION OF AN ILLUSTRATIVE<br>
EMBODIMENT<br>
Fig. 4 is a schematic block diagram of a multi-protocol storage appliance 400<br>
that may be advantageously used with the present invention. The multi-protocol stor-<br>
age appliance is configured to provide storage service for both file and block protocol<br>
access to information stored on storage devices in an integrated manner. In this context,<br>
the integrated multi-protocol appliance denotes a computer having features such as<br>
simplicity of storage service management and ease of storage reconfiguration, including<br>
reusable storage space, for users (system administrators) and clients of network attached<br>
storage (NAS) and storage area network (SAN) deployments.<br>
The multi-protocol storage appliance 400 is illustratively embodied as a storage<br>
system comprising a processor 422, a memory 424, a plurality of network adapters 425,<br>
426 and a storage adapter 428 interconnected by a system bus 423. The multi-protocol<br>
storage appliance 400 also includes a storage operating system 500 that provides a virtualization<br>
system (and, in particular, a file system) to logically organize the information<br>
as a hierarchical structure of named directory, file and virtual disk (vdisk) storage<br>
objects on the disks 430. An example of a multi-protocol storage appliance that may be<br>
advantageously used with the present invention is described in co-pending and commonly<br>
assigned U.S. Patent Application Serial No. 10/215,917 titled A Multi-Protocol<br>
Storage Appliance that Provides Integrated Support for File and Block Access Protocols,<br>
by Brian Pawlowski, et al.<br>
Whereas clients of aNAS-based network environment have a storage viewpoint<br>
of files within volumes, the clients of a SAN-based network environment have a storage<br>
viewpoint of blocks within disks. To that end, the multi-protocol storage appliance<br>
400 presents (exports) disks to SAN clients through the creation of logical unit numbers<br>
(luns) or vdisk objects. A vdisk object (hereinafter "vdisk") is a special file type that is<br>
implemented by the virtualization system and translated into an emulated disk as<br>
viewed by the SAN clients. The multi-protocol storage appliance thereafter makes<br>
these emulated disks accessible to the SAN clients through controlled exports.<br>
In the illustrative embodiment, the memory 424 comprises storage locations that<br>
are addressable by the processor and adapters for storing software program code. A<br>
portion of the memory may be further organized as a "buffer cache" 427 for storing<br>
data structures associated with the present invention. The processor and adapters may,<br>
in turn, comprise processing elements and/or logic circuitry configured to execute the<br>
software code and manipulate the data structures. The storage operating system 500,<br>
portions of which are typically resident hi memory and executed by the processing<br>
elements, functionally organizes the storage appliance by, inter alia, invoking storage<br>
operations in support of the storage service implemented by the appliance. It will be<br>
apparent to those skilled in the art that other processing and memory means, including<br>
various computer readable media, may be used for storing and executing program instructions<br>
pertaining to the invention described herein.<br>
The network adapter 425 couples the storage appliance to a plurality of clients<br>
460a,b over point-to-point links, wide area networks, virtual private networks implemented<br>
over a public network (Internet) or a shared local area network, hereinafter referred<br>
to as an illustrative Ethernet network 465. For this NAS-based network environment,<br>
the clients are configured to access information stored on the multi-protocol<br>
appliance as files. Therefore, the network adapter 425 may comprise a network interface<br>
card (NIC) having the mechanical, electrical and signaling circuitry needed to<br>
connect the appliance to a network switch, such as a conventional Ethernet switch 470.<br>
The clients 460 communicate with the storage appliance over network 465 by exchanging<br>
discrete frames or packets of data according to pre-defined protocols, such as the<br>
Transmission Control Protocol/Internet Protocol (TCP/IP).<br>
The clients 460 may be general-purpose computers configured to execute applications<br>
over a variety of operating systems, including the UNIX® and Microsoft®<br>
Windows™ operating systems. Client systems generally utilize file-based access protocols<br>
when accessing information (hi the form of files and directories) over a NASbased<br>
network. Therefore, each client 460 may request the services of the storage appliance<br>
400 by issuing file access protocol messages (in the form of packets) to the appliance<br>
over the network 465. For example, a client 460a running the Windows operating<br>
system may communicate with the storage appliance 400 using the Common Internet<br>
File System (CIFS) protocol over TCP/IP. On the other hand, a client 460b running<br>
the UNIX operating system may communicate with the multi-protocol appliance using<br>
either the Network File System (NFS) protocol over TCP/IP or the Direct Access File<br>
System (DAFS) protocol over a virtual interface (VI) transport in accordance with a •<br>
remote DMA (RDMA) protocol over TCP/IP. It will be apparent to those skilled hi the<br>
art that other clients running other types of operating systems may also communicate<br>
with the integrated multi-protocol storage appliance using other file access protocols.<br>
The storage network "target" adapter 426 also couples the multi-protocol storage<br>
appliance 400 to clients 460 that may be further configured to access the stored information<br>
as blocks or disks. For this SAN-based network environment, the storage<br>
appliance is coupled to an illustrative Fibre Channel (FC) network 485. FC is a networking<br>
standard describing a suite of protocols and media that is primarily found in<br>
SAN deployments. The network target adapter 426 may comprise a FC host bus<br>
adapter (HBA) having the mechanical, electrical and signaling circuitry needed to connect<br>
the appliance 400 to a SAN network switch, such as a conventional FC switch 480.<br>
In addition to providing FC access, the FC HBA may offload fiber channel network<br>
processing operations for the storage appliance.<br>
The clients 460 generally utilize block-based access protocols, such as the Small<br>
Computer Systems Interface (SCSI) protocol, when accessing information (in the form<br>
of blocks, disks or vdisks) over a SAN-based network. SCSI is a peripheral input/<br>
output (I/O) interface with a standard, device independent protocol that allows different<br>
peripheral devices, such as disks 430, to attach to the storage appliance 400. In<br>
SCSI terminology, clients 460 operating in a SAN environment are initiators that initiate<br>
requests and commands for data. The multi-protocol storage appliance is thus a<br>
target configured to respond to the requests issued by the initiators in accordance with a<br>
request/response protocol. The initiators and targets have endpoint addresses that, in<br>
accordance with the FC protocol, comprise worldwide names (WWN). A WWN is a<br>
unique identifier, e.g., a node name or a port name, consisting of an 8-byte number.<br>
The multi-protocol storage appliance 400 supports various SCSI-based protocols<br>
used in SAN deployments, including SCSI encapsulated over TCP (iSCSI) and<br>
SCSI encapsulated over FC (FCP). The initiators (hereinafter clients 460) may thus<br>
request the services of the target (hereinafter storage appliance 400) by issuing iSCSI<br>
and FCP messages over the network 485 to access information stored on the disks. It<br>
will be apparent to those skilled in the art that the clients may also request the services<br>
of the integrated multi-protocol storage appliance using other block access protocols.<br>
By supporting a plurality of block access protocols, the multi-protocol storage appli-<br>
ance provides a unified and coherent access solution to vdisks/luns hi a heterogeneous<br>
SAN environment.<br>
The storage adapter 428 cooperates with the storage operating system 500 executing<br>
on the storage appliance to access information requested by the clients. The information<br>
may be stored on the disks 430 or other similar media adapted to store information.<br>
The storage adapter includes I/O interface circuitry that couples to the disks<br>
over an I/O interconnect arrangement, such as a conventional high-performance, FC<br>
serial link topology. The information is retrieved by the storage adapter and, if necessary,<br>
processed by the processor 422 (or the adapter 428 itself) prior to being forwarded<br>
over the system bus 423 to the network adapters 425, 426, where the information is<br>
formatted into packets or messages and returned to the clients.<br>
Storage of information on the appliance 400 is preferably implemented as one<br>
or more storage volumes (e.g., VOL1-2 450) that comprise a cluster of physical storage<br>
disks 430, defining an overall logical arrangement of disk space. Each volume may be<br>
associated with its own file system and, for purposes herein, volume and file system<br>
may be used synonymously. The disks within a volume are typically organized as one<br>
or more groups of Redundant Array of Independent (or Inexpensive) Disks (RAID).<br>
RAID implementations enhance the reliability/integrity of data storage through the<br>
writing of data "stripes" across a given number of physical disks in the RAID group,<br>
and the appropriate storing of redundant information with respect to the striped data.<br>
The redundant information enables recovery of data lost when a storage device fails.<br>
Specifically, each volume 450 is constructed from an array of physical disks<br>
430 that are organized as RAID groups 440,442, and 444. The physical disks of each<br>
RAID group include those disks configured to store striped data (D) and those configured<br>
to store parity (P) for the data, in accordance with an illustrative RAID 4 level<br>
configuration. However, other RAID level configurations (e.g. RAID 5) are also contemplated.<br>
In the illustrative embodiment, a minimum of one parity disk and one data<br>
disk may be employed. Yet, a typical implementation may include three data and one<br>
parity disk per RAID group and at least one RAID group per volume.<br>
To facilitate access to the disks 430, the storage operating system 500 implements<br>
a write-anywhere file system that cooperates with virtualization modules to pro-<br>
vide a function that "virtualizes" the storage space provided by disks 430. The file system<br>
logically organizes the information as a hierarchical structure of named directory<br>
and file objects (hereinafter "directories" and "files") on the disks. Each "on-disk" file<br>
may be implemented as set of disk blocks configured to store information, such as data,<br>
whereas the directory may be implemented as a specially formatted file in which names<br>
and links to other files and directories are stored. The virtualization modules allow the<br>
file system to further logically organize information as a hierarchical structure of<br>
named vdisks on the disks, thereby providing an integrated NAS and SAN appliance<br>
approach to storage by enabling file-based (NAS) access to the files and directories,<br>
while further enabling block-based (SAN) access to the vdisks on a file-based storage<br>
platform.<br>
In the illustrative embodiment, the storage operating system is preferably the<br>
NetApp® Data ONTAP™ operating system available from Network Appliance, Inc.,<br>
Sunnyvale, California that implements a Write Anywhere File Layout (WAFL™) file<br>
system. However, it is expressly contemplated that any appropriate storage operating<br>
system, including a write in-place file system, may be enhanced for use in accordance<br>
with the inventive principles described herein. As such, where the term "WAFL" is<br>
employed, it should be taken broadly to refer to any storage operating system that is<br>
otherwise adaptable to the teachings of this invention.<br>
As used herein, the term "storage operating system" generally refers to the computer-<br>
executable code operable on a computer that manages data access and may, in the<br>
case of a multi-protocol storage appliance, implement data access semantics, such as<br>
the Data ONTAP storage operating system, which is implemented as a microkernel.<br>
The storage operating system can also be implemented as an application program operating<br>
over a general-purpose operating system, such as UNIX® or Windows NT®, or<br>
as a general-purpose operating system with configurable functionality, which is configured<br>
for storage applications as described herein.<br>
In addition, it will be understood to those skilled in the art that the inventive<br>
technique described herein may apply to any type of special-purpose (e.g., storage serving<br>
appliance) or general-purpose computer, including a standalone computer or portion<br>
thereof, embodied as or including a storage system. Moreover, the teachings of<br>
this invention can be adapted to a variety of storage system architectures including, but<br>
not limited to, a network-attached storage environment, a storage area network and disk<br>
assembly directly-attached to a client or host computer. The term "storage system"<br>
should therefore be taken broadly to include such arrangements in addition to any subsystems<br>
configured to perform a storage function and associated with other equipment<br>
or systems.<br>
Fig. 5 is a schematic block diagram of the storage operating system 500 that<br>
may be advantageously used with the present invention. The storage operating system<br>
comprises a series of software layers organized to form an integrated network protocol<br>
stack or, more generally, a multi-protocol engine that provides data paths for clients to<br>
access information stored on the multi-protocol storage appliance using block and file<br>
access protocols. The protocol stack includes a media access layer 510 of network<br>
drivers (e.g., gigabit Ethernet drivers) that interfaces to network protocol layers, such as<br>
the IP layer 512 and its supporting transport mechanisms, the TCP layer 514 and the<br>
User Datagram Protocol (UDP) layer 516. A file system protocol layer provides multiprotocol<br>
file access and, to that end, includes support for the DAFS protocol 518, the<br>
NFS protocol 520, the CIFS protocol 522 and the Hypertext Transfer Protocol (HTTP)<br>
protocol 524. A VI layer 526 implements the VI architecture to provide direct access<br>
transport (DAT) capabilities, such as RDMA, as required by the DAFS protocol 518.<br>
An iSCSI driver layer 528 provides block protocol access over the TCP/IP network<br>
protocol layers, while a FC driver layer 530 operates with the FC HBA 426 to<br>
receive and transmit block access requests and responses to and from the integrated<br>
storage appliance. The FC and iSCSI drivers provide FC-specific and iSCSI-specific<br>
access control to the luns (vdisks) and, thus, manage exports of vdisks to either iSCSI<br>
or FCP or, alternatively, to both iSCSI and FCP when accessing a single vdisk on the<br>
multi-protocol storage appliance. In addition, the storage operating system includes a<br>
disk storage layer 540 that implements a disk storage protocol, such as a RAID protocol,<br>
and a disk driver layer 550 that implements a disk access protocol such as, e.g., a<br>
SCSI protocol.<br>
Bridging the disk software layers with the integrated network protocol stack<br>
layers is a virtualization system 600. Fig. 6 is a schematic block diagram of the virtual-<br>
ization system 600 that is implemented by a file system 620 interacting with virtualization<br>
modules illustratively embodied as, e.g., vdisk module 630 and SCSI target module<br>
610. It should be noted that the vdisk module 630, the file system 620 and SCSI target<br>
module 610 can be implemented in software, hardware, firmware, or a combination<br>
thereof. The vdisk module 630 is layered on the file system 620 to enable access by<br>
administrative interfaces, such as a streamlined user interface (UI 650), in response to a<br>
system administrator issuing commands to the multi-protocol storage appliance 400. In<br>
essence, the vdisk module 630 manages SAN deployments by, among other things, implementing<br>
a comprehensive set of vdisk (lun) commands (cmds) 652 issued through<br>
the UI 650 by a system administrator. These vdisk commands are converted to primitive<br>
file system operations ("primitives 632") that interact with the file system 620 and<br>
the SCSI target module 610 to implement the vdisks.<br>
The SCSI target module 610, in turn, initiates emulation of a disk or lun by providing<br>
a mapping procedure that translates a lun identifier to a vdisk-type file. The<br>
SCSI target module is illustratively disposed between the FC and iSCSI drivers 528,<br>
530 and the file system 620 to thereby provide a translation layer of the virtualization<br>
system 600 between the SAN block (lun) space and the file system space, where luns<br>
are represented as vdisks 622. To that end, the SCSI target module has a set of application<br>
programming interfaces (APIs 660) that are based on the SCSI protocol and that<br>
enable a consistent interface to both the iSCSI and FCP drivers 528, 530. By "disposing"<br>
SAN virtualization over the file system 620, the multi-protocol storage appliance<br>
reverses the approach taken by prior systems to thereby provide a single unified storage<br>
platform for essentially all storage access protocols.<br>
The file system 620 is illustratively a message-based system; as such, the SCSI<br>
target module 610 transposes a SCSI request into a message representing an operation<br>
directed to the file system. For example, the message generated by the SCSI target<br>
module may include a type of operation (e.g., read, write) along with a pathname (e.g.,<br>
a path descriptor) and a filename (e.g., a special filename) of the vdisk object represented<br>
in the file system. Alternatively, the generated message may include an operation<br>
type and file handle containing volume/inode information. The SCSI target mod-<br>
ule 610 passes the message into the file system layer 620 as, e.g., a function call 665,<br>
where the operation is performed.<br>
The file system provides volume management capabilities for use in blockbased<br>
access to the information stored on the storage devices, such as disks. That is, in<br>
addition to providing file system semantics, such as naming of storage objects, the file<br>
system 620 provides functions normally associated with a volume manager. These<br>
functions include (i) aggregation of the disks, (ii) aggregation of storage bandwidth of<br>
the disks, and (iii) reliability guarantees, such as mirroring and/or parity (RAID), to<br>
thereby present one or more storage objects layered on the file system. A feature of the<br>
multi-protocol storage appliance is the simplicity of use associated with these volume<br>
management capabilities, particularly when used in SAN deployments.<br>
The file system 620 illustratively implements the WAFL file system having an<br>
on-disk format representation that is block-based using, e.g., 4 kilobyte (kB) blocks and<br>
using inodes to describe the files 624. The file system uses files to store metadata describing<br>
the layout of its file system; these metadata files include, among others, an<br>
inode file. A file handle, i.e., an identifier that includes an inode number, is used to retrieve<br>
an inode from disk. As noted, the WAFL file system also supports multiple<br>
snapshots that are generally created on a regular schedule. A description of the structure<br>
of the file system, including on-disk inodes, the inode file and snapshots, is provided<br>
in U.S. Patent No. 5,819,292. Notably, snapshots are created on the multiprotocol<br>
storage appliance without the need for prior configuration of the underlying<br>
storage. This feature of the appliance simplifies the creation and management of data<br>
recovery techniques for business continuance compared to previous block-based recovery<br>
methods and mechanisms.<br>
Fig. 7 is a schematic block diagram illustrating an on-disk inode 700, which includes<br>
a metadata section 710 and a data section 750. The information stored in the<br>
metadata section 710 of each inode 700 describes the file and, as such, includes the<br>
type (e.g., regular, directory) 712 of file, the size 714 of the file, time stamps (e.g., access<br>
and/or modification) 716 for the file and ownership, i.e., user identifier (UID 718)<br>
and group ID (GID 720), of the file. The metadata section 710 further includes a xinode<br>
field 730 containing a pointer that references another on-disk inode structure con-<br>
taining, e.g., access control list (ACL) information associated with the file or directory.<br>
The contents of the data section 750 of each, inode., however, may be interpreted differently<br>
depending upon the type of file (inode) defined within the type field 712. For example,<br>
the data section 750 of a dkectory inode contains metadata controlled by the file<br>
system, whereas the data section of a regular inode contains user-defined data. In this<br>
latter case, the data section 750 includes a representation of the data associated with the<br>
file.<br>
Specifically, the data section 750 of a regular on-disk inode may include user<br>
data or pointers, the latter referencing 4kB data blocks on disk used to store the user<br>
data. Each pointer is preferably a logical volume block number (VBN) to thereby facilitate<br>
efficiency among the file system and the disk storage (RAID) layer 540 when<br>
accessing the data on disks. Given the restricted size (128 bytes) of the inode, user data<br>
having a size that is less than or equal to 64 "bytes is represented, hi its entirety, within<br>
the data section of that inode. However, if the user data is greater than 64 bytes but less<br>
than or equal to 64 kB, then the data section of the mode comprises up to 16 pointers,<br>
each of which references a 4kB block of data on the disk. Moreover, if the size of the<br>
data is greater than 64 kilobytes but less than or equal to 64 megabytes (MB), then each<br>
pointer in the data section 750 of the inode references an indirect block that contains<br>
1024 pointers, each of which references a 4kB data block on disk. Each data block is<br>
loaded from disk 430 into memory 424 in order to access the data. As noted, the size<br>
field 714 of the metadata section 710 of the inode refers to the size of the file.<br>
Broadly stated, all inodes of the file system are organized into the inode file. A<br>
file system (FS) info block specifies the layout of information in the file system and<br>
includes an inode of a file that includes all other inodes of the file system. Each volume<br>
has an FS info block that is preferably stored at a fixed location within, e.g., a<br>
RAID group of the file system. The inode of the root FS info block may directly reference<br>
(point to) blocks of the inode file or may reference indirect blocks of the inode file<br>
that, in turn, reference direct blocks of the inode file. Within each direct block of the<br>
inode file are embedded inodes, each of which may reference indirect blocks that, in<br>
turn, reference data blocks of a file or vdisk.<br>
As noted, a vdisk is a special file type in a volume that derives from a plain<br>
(regular) file, but that has associated export controls and operation restrictions that support<br>
emulation of a disk. Unlike a file that can be created by a client using, e.g., the<br>
NFS or CIFS protocol, a vdisk is created on the multi-protocol storage appliance via,<br>
e.g. a user interface (UI) as a special typed file (object). Illustratively, the vdisk is a<br>
multi-inode object comprising a special file inode that holds data and at least one associated<br>
stream inode that holds attributes. The special file inode functions as a main<br>
container for storing data, such as application data, associated with the emulated disk.<br>
The stream inode stores attributes that, among others, allow luns and exports to persist<br>
over, e.g., reboot operations, while also enabling management of the vdisk as a single<br>
disk object in relation to SAN clients.<br>
Fig. 8 is a schematic block diagram illustrating an on-disk representation of<br>
vdisk inode data structures 800, including a lun inode 810 and an attributes inode 840.<br>
The lun inode 810 is the special file inode that functions as a main container for storing<br>
data associated with the vdisk 622. That is, the lun inode comprises a data section 818<br>
that may store the actual (user or application) data or pointers referencing 4kB data<br>
blocks on disk used to store the data, as described in Fig. 7. The data stored in this "default"<br>
container can be retrieved (read) and stored (written) by a client using conventional<br>
block access protocols, such as the SCSI protocol. When appropriately configured,<br>
a vdisk may also be accessed using conventional file-level access protocols, such<br>
as the NFS protocol. In this configuration, a vdisk "appears" to be a regular file for<br>
such accesses. The lun inode 810 also comprises a metadata section 812 containing<br>
metadata such as the type 813 (i.e., a special vdisk type) and size 816 of the vdisk that,<br>
upon creation of the inode, is zero. A.flag_stream flag 814 identifies the lun mode 810<br>
as having not only a default data container section 818 but also one or more stream<br>
"sections", as provided by stream_dir inode 820.<br>
In order to access the stream_dir inode 820, the pointer of xinode field 815 in<br>
lun mode 810 is modified to reference the inode 820. The stream_dir inode 820 comprises<br>
a metadata section 822 that includes a type (stream_dir) field 824 and an xinode<br>
field 825 that references another on-disk inode structure containing, e.g., access control<br>
(such as CIFS permission) information associated with the vdisk. The inode 820 also<br>
includes a data section 826 containing a pointer 828 that references a stream directory<br>
data block associated with the vdisk, such as stream directory block 830. The stream<br>
directory block 830 comprises a data section 832 that includes a plurality of entries,<br>
each containing an external representation of a stream inode along with mapping information<br>
(i.e., the inode number) for that inode. One of those entries, entry 834, contains<br>
mapping information (e.g., a pointer) that references an attributes (stream) inode<br>
840.<br>
The attributes inode 840 comprises a metadata section 842 that includes a type<br>
(stream) field 844 and a data section 845 that functions as a persistent store for holding<br>
various named attributes associated with the vdisk 622. Attributes are an implementation<br>
mechanism that is internal to the file system and not managed by users. An example<br>
of an attribute is a snapshot file handle 846 or file handle of a "backing store" file<br>
(i.e., the snapshot file). The backing store file handle 846 includes a snapshot identifier<br>
(ID), which is an identifier (pointer) to a snapshot containing the snapshot file, and a<br>
file ID, which is an identifier (pointer) to the snapshot file. As described herein, the<br>
snapshot file functions as a backing store for the vdisk when the vdisk is used as a writable,<br>
read-only snapshot. The vdisk and its associated inodes are further described in<br>
U.S. Patent Application Serial No. 10/216,453 titled Storage Virtualization by Layering<br>
Vdisks on a File System, by Vijayan Rajan, et al..<br>
While vdisks are self-contained objects containing all data necessary for proper<br>
operation and authorization, a vdisk table of contents (VTOC 670 in Fig. 6) is provided<br>
as a performance enhancement to finding and loading vdisks. The VTOC is not necessary<br>
for correct operation and can be reconstructed dynamically by a scan of the vdisks.<br>
The VTOC 670 is a per-volume data structure that is stored in a metadata file and that<br>
is used to optimize location determination (i.e. finding) and initialization of persistent<br>
vdisks 622 in a volume 450. In addition, the VTOC 670 facilitates resolution of the<br>
location of a file within a particular snapshot, i.e., allows efficient resolution of a snapshot<br>
file location.<br>
The VTOC 670 comprises one or more records 672, wherein each record includes<br>
flags 678 and file entries that can be dynamically recreated from information<br>
stored in the encapsulated vdisk storage objects. The file entries include a vdisk file-<br>
handle 674 pertaining to a vdisk in the active file system and a backing store file handle<br>
676 pertaining to a backing store (snapshot file). If the vdisk is used as a writable,<br>
read-only snapshot then the backing store file handle contains a file handle, including<br>
snapshot ID of the backing store file; otherwise, for a normal vdisk the backing store<br>
file handle contains a zero. The file entries of each record 672 may also contain directory<br>
information comprising a file block number in a parent directory (qtree root) containing<br>
an entry for the vdisk, along with an index of directory entries in a parent directory<br>
block. The directory entry enables determination of the last component of a path<br>
to the snapshot file.<br>
The present invention involves writable, read-only snapshots, each of which<br>
comprises a read-only "image" (file) residing in a snapshot and a writable vdisk residing<br>
in the active file system. The writable vdisk is a "shadow" image of the snapshot<br>
file image and, as noted, includes an attribute that specifies the snapshot file as a backing<br>
store. It should be noted that while there are any vdisks in existence in the active<br>
file system specifying a file in a snapshot, the snapshot file is "locked" and cannot be<br>
deleted.<br>
In the illustrative embodiment, a write operation directed to the writable readonly<br>
snapshot is "trapped" (directed) to the vdisk in the active file system such that the<br>
data associated with the operation is stored on that shadow, vdisk image. In other<br>
words rather than directly accessing the read-only snapshot image of a lun, a client accesses<br>
the writable vdisk image, which provides a translucent view of the underlying<br>
read-only snapshot image. The writable vdisk is a "sparse" file containing only that<br>
data written by the client (e.g., an initiator in a SAN) to the read-only snapshot image<br>
subsequent to a snapshot operation to a volume underlying the lun (vdisk).<br>
Briefly, the sparse vdisk in the active file system is "translucent", i.e., initially<br>
the vdisk has a size equal to the size of the snapshot file because there is no data other<br>
than the snapshot file data. Since there is no data in the initial instance of the vdisk, the<br>
vdisk is completely filled with "holes." On read operations issued by a client to the<br>
writable read-only snapshot, the file system searches for the requested block in the<br>
vdisk of the active file system. If the block is not found, the corresponding block from<br>
the backing snapshot file is accessed and returned. It should be noted that having wri-<br>
table vdisks backed by a snapshot file does not prevent direct access to the snapshot file<br>
(for backup or other reasons).<br>
Write operations are only carried out on the sparse vdisk in the active file system,<br>
i.e., the vdisk in the active file system stores changes (write data) to the read-only<br>
snapshot file. For subsequent read operations directed to the writable read-only snapshot,<br>
any modified/changed ("written") data blocks are returned. Otherwise, the holes<br>
in the vdisk result in copies of the read-only data blocks being returned from the associated<br>
snapshot file, thereby providing a "space conservative" storage entity.<br>
For example, assume that a vdisk exists in its original state in the active file system<br>
and a snapshot is subsequently taken of the volume underlying that vdisk. Write<br>
operations can then be directed to that snapshotted vdisk. To that end, the writable<br>
read-only snapshot storage entity may be thought of as comprising two storage space<br>
layers: (i) an underlying snapshot layer that is "frozen in time" and that does not change<br>
as long as the snapshot file exists, and (ii) an overlaying vdisk layer of the active file<br>
system that does change in time as data is written to that layer.<br>
Fig. 9 is schematic block diagram illustrating writable read-only snapshots 900,<br>
each comprising a writable vdisk and a backing store, that may be advantageously used<br>
with the present invention. An upper, overlaying vdisk layer 920 includes one or more<br>
writable vdisk storage objects 922 in the active file system. Each writable vdisk is<br>
backed by a snapshot file (backing store 934) in an underlying snapshot layer 930.<br>
Any modifications (data write operations) are directed to the vdisk layer 920 with new<br>
disk blocks being allocated to accommodate those modifications. Unmodified blocks<br>
of the vdisk layer are shared between the writable vdisk and underlying snapshot layer.<br>
For example, all data blocks with horizontal lines are shared between an instance of the<br>
special (vdisk) file in the active file system and an instance of the same file in the snapshot.<br>
Here, the VBNs point to, ie., reference, the same data blocks when they are<br>
shared between the instances of the active file and the snapshot file. In contrast, those<br>
data blocks in the active file system with hash marks indicate blocks that have been<br>
modified since the snapshot was taken. Consequently, those blocks are not shared with<br>
the instance of the vdisk file in the snapshot and are allocated VBNs that point to new<br>
blocks. In sum, each of the modified data blocks in each of the writable vdisks repre-<br>
sents a newly allocated data block, whereas the unmodified data blocks of those •vdisks<br>
are shared with corresponding data blocks of the snapshot file (backing store 934).<br>
The present invention is directed to a LUN cloning technique that "separates"<br>
data blocks referenced by a writable vdisk in the active file system from data blocks<br>
referenced only by a backing store, thereby removing dependency of the writable vdisk<br>
upon the backing store. By separating the data blocks referenced by the writable vdisk,<br>
a user may then delete the backing store and free the disk space consumed by the backing<br>
store on the storage appliance.<br>
Broadly stated, a backdoor message handler 626 of file system 620 loads blocks<br>
of the writable vdisk 922 and its backing store 934 from disk 130 into memory 4-24<br>
(buffer cache 427) in a manner that does not interfere with storage service provided by<br>
the multi-protocol storage appliance. Notably, separation of the writable vdisk data<br>
blocks from the backing store occurs during periods of reduced processing activity in<br>
the file system, e.g., as part of background task processing on the appliance, so that the<br>
present technique may be implemented without any downtime visible to a client application<br>
served by the appliance. The loaded blocks are represented as writable vdisk and<br>
backing store buffer trees in the "buffer cache 427 of the storage appliance.<br>
Fig. 10A is a schematic block diagram depicting the writable vdisk and backing<br>
store buffer tree data structures that may be advantageously used with the novel<br>
LUN cloning technique. The buffer trees 1000,1050 are internal representations of the<br>
(data) blocks constituting the writable vdisk and the backing store and, to that end,<br>
function to organize their loaded blocks. The buffer trees are organized in a hierarchical<br>
structure with top level inodes 1002 and 1052 containing pointers to indirect blocks<br>
(level 1 blocks) 1010,1012,1060, 1062. The pointers are illustratively VBNs of a<br>
VBN space maintained by the file system. The indirect blocks contain VBN pointers to<br>
file data blocks (level 0 blocks), such as data blocks 1020,1022,1024,1026, 1070,<br>
1072,1074,1076. Each indirect block may be embodied as a level 1 buffer that stores<br>
the VBN's of the data blocks referenced by the indirect block. Moreover, each level 1<br>
buffer has 1024 fields for storing the VBN pointers. Fig. 10B is a schematic block diagram<br>
illustrating level 1 buffers 1030, 1080 for the writable vdisk 922 and the backing<br>
store 934 respectively.<br>
In the illustrative embodiment, a special vdisk loading function 1040 of the file<br>
system "walks through" the level 1 buffers (indirect blocks) of the writable vdisk,<br>
searching for invalid VBN pointers. Note that a valid VBN pointer has a non-zero<br>
value that directly references a data block, whereas an invalid VBN pointer has a zero<br>
value that represents a hole. Such a hole instructs the file system to examine the value<br>
of the VBN pointer in the corresponding level 1 buffer of the backing store.<br>
For example, the vdisk loading function 1040 examines each field 1031-1035 of<br>
the writable vdisk level 1 buffer 1030 and, upon recognizing a hole at field 1035, examines<br>
field 1085 of the corresponding backing store level 1 buffer 1080. Note that the<br>
corresponding backing store level 1 buffer 1080 (e.g., indirect block 1060 of buffer tree<br>
1050) has the same file block number (FBN) as the writable vdisk level 1 buffer 1030<br>
(e.g., indirect block 1010 of buffer tree 1000). If the VBN pointer in field 1085 of the<br>
backing store level 1 buffer 1080 has a non-zero value, the loading function 1040 informs<br>
the backdoor message handler 626 to mark an "old" level 0 data block 1090 referenced<br>
by the non-zero VBN as "dirty", a designation normally indicating that the<br>
contents have been changed. In this case though the old data block is marked "dirty"<br>
without altering the content of the block.<br>
Thereafter, a write allocator 628 of file system 620 "write allocates" the "dirty"<br>
block by, e.g., choosing a new VBN for a newly allocated block containing the unaltered<br>
data content, setting appropriate bits in block allocation structures and placing the<br>
chosen VBN into the writable vdisk indirect level 1 buffer, effectively filling the hole<br>
in the writable vdisk. Note that the block allocation structures include mapping data<br>
structures, such as an active map, a space map and a summary map, that are maiatained<br>
by the file system and used by the write allocator as existing infrastructure for the volume.<br>
Block allocation data structures are described in U.S. Patent Application Publication<br>
No. US2002/0083037 Al, titled Instant Snapshot, by Blake Lewis et al. and published<br>
on June 27,2002, which application is hereby incorporated by reference.<br>
The write allocator then deletes the old data block and stores the new block to<br>
disk. This process is repeated for all instances of holes discovered in the indirect<br>
blocks of the writable vdisk. Thereafter, the file system "releases" an associatioa of the<br>
writable vdisk to the backing store by, e.g., deleting the backing store file handle 846<br>
from the attributes inode 840 of the writable vdisk. In addition, the file system updates<br>
an appropriate entry of record 672 in the VTOC 670 to remove the backing store file<br>
handle reference.<br>
Fig. 11 is a flowchart illustrating a sequence of steps used to separate writable<br>
vdisk data blocks from their backing store in accordance with the present invention.<br>
The sequence of steps may be repeated for each level 1 buffer of the writable vdisk until<br>
all the data blocks of the vdisk have been separated. The sequence starts at 1100<br>
and proceeds to Step 1102 where the message handler loads blocks of the writable<br>
vdisk 922 and its backing store 934 from disk 130 into buffer cache 427. Next, at Step<br>
1104, the special vdisk loading function 1040 of the file system is invoked. The special<br>
vdisk loading function 1040 "walks through" the level 1 buffers of the writable vdisk,<br>
searching for invalid VBN pointers. At step 1106, the loading function examines a<br>
first field of the writable vdisk level 1 buffer and, in Step 1108, determines whether the<br>
field contains a valid (non-zero) VBN pointer. If a valid VBN pointer is found, the sequence<br>
advances to Step 1118 where the field to be examined of the writable vdisk<br>
level 1 buffer is incremented. Otherwise, if a non-valid value is present in the field of<br>
the writable vdisk level 1 buffer, indicating a hole, the sequence advances to Step 1110,<br>
where the loading function examines the corresponding field of the level 1 buffer of the<br>
backing store to determine if there is any backing data in the backing store (e.g. the<br>
backing store level 1 buffer field actually points to a data block). Specifically, at Step<br>
1112 the loading function determines whether the corresponding field contains a valid<br>
VBN pointer. If not, the sequence jumps to step 1118 where the field to be examined<br>
of the writable vdisk level 1 buffer is incremented. Otherwise, the sequence advances<br>
to Step 1114 where the special loading function 1040 informs the backdoor message<br>
handler 626 to mark the level 0 data block (e.g. data block 1090) referenced by the<br>
backing store level 1 buffer as dirty. Thereafter, at Step 1116, the write allocator 628<br>
of file system 620 "write allocates" the dirty block by, e.g., choosing a new VBN for<br>
the newly allocated block, setting appropriate bits hi the block allocation structures and<br>
placing the chosen VBN into the writable vdisk indirect level 1 buffer, effectively filling<br>
the hole in the writable vdisk. At Step 1118 the field of the writable vdisk level 1<br>
buffer to be examined is incremented and at Step 1120 a determination is made whether<br>
further fields of the writable vdisk level 1 buffer remain to be examined. If so the se-<br>
quence returns to Step 1106; otherwise, at Step 1122 the file system "releases" the association<br>
of the writable vdisk to the backing store by, e.g., deleting the backing store<br>
file handle 846 from the attributes inode 840 of the writable vdisk. In addition, the file<br>
system updates an appropriate entry of record 672 in the VTOC 670 to remove the<br>
backing store file handle reference. The sequence then ends at Step 1124 where the<br>
backing store is deleted and the disk space consumed by the backing store is thereby<br>
effectively freed.<br>
Advantageously, the inventive technique uses backdoor messaging (i.e., the exchange<br>
of messages during periods of reduced processing activity hi the file system) to<br>
separate the writable vdisk data blocks from the backing store, thereby obviating the<br>
need to take the writable vdisk data blocks offline. The LUN cloning technique preferably<br>
takes place entirely in the background through the use of such backdoor messaging.<br>
Thus the LUN cloning technique results in zero-downtime of the multi-protocol<br>
storage appliance and is transparent to client applications served by the storage appliance.<br>
Indeed, in some cases, if a client application attempts to write new data to the<br>
writable vdisk while lun cloning is running in the background, the write operation will<br>
speed up the lun cloning process. New data written to the writable vdisk decreases the<br>
number of holes and thereby decreases the number of VBN "lookups" that must be<br>
made to the backing store. Therefore, write activity may decrease the time it takes to<br>
"clone" the lun. Note that a further benefit of the novel cloning technique is that it enhances<br>
data read performance in certain situations. By separating the data blocks from<br>
the backing store to the writable vdisk, those data blocks may accessed without reference<br>
to the backing store. Elimination of this access operation enhances storage service<br>
performance.<br>
The aforementioned novel LUN cloning technique may be initiated via user interface<br>
with a "lun clone" command. The "lun clone" command provides a human<br>
readable form for a user (system administrator) to specify a particular lun (vdisk) to be<br>
cloned, and provides status information to the user. The system administrator may issue<br>
the "lun clone" command through the UT 650 of the multi-protocol storage appliance<br>
400, where it is converted to primitives 632 that are executed by the file system<br>
620. To initiate the LUN cloning technique, a "start" option is used. An example of a<br>
"lun clone" command including a start option is:<br>
Inn clone start vol/volO/test<br>
In addition to the start option, the "lun clone" command includes a path descriptor<br>
(/V0//W0) to a vdisk test in the active file system that is to be cloned from a snapshot.<br>
During the cloning process, the system administrator or user may access status<br>
information to determine the progress of the cloning operation by issuing the "lun<br>
clone" command with a "status" option. For example,<br>
lun clone status vol/volO/test<br>
returns completion information in the form of percentage of completion for the vdisk<br>
test.<br>
The user may also access status information for all cloning operations by issuing<br>
the "lun clone" command with a "show" option. For example,<br>
lun clone show vol/volO/<br>
returns status information for all clones currently being processed for vdisks in the<br>
vo//vo/0/path.<br>
Finally, to terminate a LUN cloning operation while cloning is underway, the<br>
user may issue the "lun clone" command with a "stop" option. For example,<br>
lun clone stop vol/volO/test<br>
terminates cloning of the vdisk test.<br>
The foregoing description has been directed to specific embodiments of this invention.<br>
It will be apparent, however, that other variations and modifications may be<br>
made to the described embodiments, with the attainment of some or all of their advantages.<br>
For instance, it is expressly contemplated that the teachings of this invention can<br>
be implemented as software, including a computer-readable medium having program<br>
instructions executing on a computer, hardware, firmware, or a combination thereof.<br>
Accordingly this description is to be taken only by way of example and not to otherwise<br>
limit the scope of the invention. Therefore, it is the object of the appended claims<br>
to cover all such variations and modifications as come within the true spirit and scope<br>
of the invention.<br><br><br><br><br><br>
We claim:<br>
1.	A storage system with a writable virtual disk (vdisk) and a backing store, thestorage<br>
system, comprising:<br>
a backdoor message handler [626] adapted to load blocks of the writable vdisk [1000] and backing store [1050] from disk [430] into a memory [424] of the storage system [400];<br>
a writable vdisk indirect block (1030) in the memory [424] having a plurality of fields, (1031-1036) each field (1031-1036) storing a valid pointer to a data block (1090) or an invalid pointer representing a hole;<br>
a backing store indirect block (1080) in the memory [424] having a plurality of fields (1081-1086), each backing store indirect block field (1081-1086) corresponding to a field (1031-1036) of the writable vdisk indirect block (1030), each backing store indirect block field (1081-1086)having a pointer to a data block;<br>
a special loading function [1040] for searching each field (1031-1036) of the writable vdisk indirect block (1030) for one or more fields (1035) representing a hole; and a write allocator [628] for replacing each field (1035) representing a hole in the writable vdisk indirect block (1030) with a new pointer to the data referenced by the corresponding backing store indirect block field (1085).<br>
2.	The storage system as claimed in claim 1 wherein the write allocator [628] is further<br>
adapted to:<br>
choose a new pointer for a newly allocated data block containing an unaltered data content, set bits in block allocation structures for the newly allocated data block, and place the new pointer to the newly allocated data block into the field (1035) of the writable vdisk indirect block (1030) to replace the hole.<br><br><br>
3.	The storage system as claimed in claim 1 wherein the backdoor message handler loads [626] the blocks of the writable vdisk [1000] and the blocks of the backing store [1050] during periods of reduced processing activity.<br>
4.	The storage system as claimed in claim 1 wherein the pointers contained in the writable vdisk indirect block fields (1031-1036) and the backing store indirect block fields (1081-1086) comprise logical volume block numbers (VBNs).<br>
5.	The storage system as claimed in claim 1 wherein the invalid pointers contained in the writable vdisk indirect block fields (1031-1036) comprise a zero logical volume block number (VBN).<br></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LUFic3RyYWN0LSgwNS0wNC0yMDExKS5wZGY=" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-Abstract-(05-04-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1ERUxOUC0yMDA2LUFic3RyYWN0LSgxOC0wOS0yMDA5KS5wZGY=" target="_blank" style="word-wrap:break-word;">4572-DELNP-2006-Abstract-(18-09-2009).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LWFic3RyYWN0LnBkZg==" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LWFzc2lnbm1lbnQucGRm" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-assignment.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1ERUxOUC0yMDA2LUNsYWltcy0oMTgtMDktMjAwOSkucGRm" target="_blank" style="word-wrap:break-word;">4572-DELNP-2006-Claims-(18-09-2009).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LWNsYWltcy5wZGY=" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LUNvcnJlc3BvbmRlbmNlIE90aGVycy0oMDUtMDQtMjAxMSkucGRm" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-Correspondence Others-(05-04-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1ERUxOUC0yMDA2LUNvcnJlc3BvbmRlbmNlLU90aGVycy0oMTgtMDktMjAwOSkucGRm" target="_blank" style="word-wrap:break-word;">4572-DELNP-2006-Correspondence-Others-(18-09-2009).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LWNvcnJlc3BvbmRlbmNlLW90aGVycy0oMjktMDgtMjAwNikucGRm" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-correspondence-others-(29-08-2006).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LWNvcnJlc3BvbmRlbmNlLW90aGVycy5wZGY=" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-correspondence-others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1ERUxOUC0yMDA2LURlc2NyaXB0aW9uIChDb21wbGV0ZSktKDE4LTA5LTIwMDkpLnBkZg==" target="_blank" style="word-wrap:break-word;">4572-DELNP-2006-Description (Complete)-(18-09-2009).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LWRlc2NyaXB0aW9uIChjb21wbGV0ZSkucGRm" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-description (complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LURlc2NyaXB0aW9uIENvbXBsZXRlLSgwNS0wNC0yMDExKS5wZGY=" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-Description Complete-(05-04-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1ERUxOUC0yMDA2LURyYXdpbmdzLSgxOC0wOS0yMDA5KS5wZGY=" target="_blank" style="word-wrap:break-word;">4572-DELNP-2006-Drawings-(18-09-2009).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LWRyYXdpbmdzLnBkZg==" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LUZvcm0tMS0oMDUtMDQtMjAxMSkucGRm" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-Form-1-(05-04-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1ERUxOUC0yMDA2LUZvcm0tMS0oMTgtMDktMjAwOSkucGRm" target="_blank" style="word-wrap:break-word;">4572-DELNP-2006-Form-1-(18-09-2009).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LWZvcm0tMS5wZGY=" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-form-1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LWZvcm0tMTgtKDI5LTA4LTIwMDYpLnBkZg==" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-form-18-(29-08-2006).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LUZvcm0tMi0oMDUtMDQtMjAxMSkucGRm" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-Form-2-(05-04-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LWZvcm0tMi5wZGY=" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-form-2.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1ERUxOUC0yMDA2LUZvcm0tMy0oMTgtMDktMjAwOSkucGRm" target="_blank" style="word-wrap:break-word;">4572-DELNP-2006-Form-3-(18-09-2009).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LWZvcm0tMy5wZGY=" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-form-3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LUZvcm0tNS0oMDUtMDQtMjAxMSkucGRm" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-Form-5-(05-04-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LWZvcm0tNS5wZGY=" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-form-5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1ERUxOUC0yMDA2LUdQQS0oMTgtMDktMjAwOSkucGRm" target="_blank" style="word-wrap:break-word;">4572-DELNP-2006-GPA-(18-09-2009).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LWdwYS5wZGY=" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-gpa.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LXBjdC0xMDEucGRm" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-pct-101.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LXBjdC0yMTAucGRm" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-pct-210.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LXBjdC0yMzcucGRm" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-pct-237.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LXBjdC0zMDEucGRm" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-pct-301.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1kZWxucC0yMDA2LXBjdC0zMDQucGRm" target="_blank" style="word-wrap:break-word;">4572-delnp-2006-pct-304.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1ERUxOUC0yMDA2LVBldGl0aW9uLTEzNy0oMTgtMDktMjAwOSkucGRm" target="_blank" style="word-wrap:break-word;">4572-DELNP-2006-Petition-137-(18-09-2009).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDU3Mi1ERUxOUC0yMDA2LVBldGl0aW9uLTEzOC0oMTgtMDktMjAwOSkucGRm" target="_blank" style="word-wrap:break-word;">4572-DELNP-2006-Petition-138-(18-09-2009).pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="260054-a-torque-converter-clutch-control-system-and-a-method-of-controlling-a-torque-converter.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="260056-cable-conector-for-printed-circuit-boards.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>260055</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>4572/DELNP/2006</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>14/2014</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>04-Apr-2014</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>31-Mar-2014</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>08-Aug-2006</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>NETWORK APPLIANCE INC.</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>495 EAST JAVA DRIVE, SUNNYVALE, CA 94089, USA</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>VINAY GUPTA</td>
											<td>495 EAST JAVA DRIVE, SUNNYVALE, CA 94089, USA</td>
										</tr>
										<tr>
											<td>2</td>
											<td>VIJAYAN RAJAN</td>
											<td>431 COSTA MESA TERRACE #A, SUNNYVALE, CA 94085-1612, USA</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>G06F 3/06</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/US2005/003217</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2005-02-03</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>10/772,822</td>
									<td>2004-02-05</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/260055-system-for-logical-unit-number-lun-cloning by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 04 Apr 2024 22:57:09 GMT -->
</html>
