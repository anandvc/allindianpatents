<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/233656-a-method-of-providing-secure-communication-of-digital-data-between-devices-and-apparatus-therefor by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 13:49:36 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 233656:A METHOD OF PROVIDING SECURE COMMUNICATION OF DIGITAL DATA BETWEEN DEVICES AND APPARATUS THEREFOR</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">A METHOD OF PROVIDING SECURE COMMUNICATION OF DIGITAL DATA BETWEEN DEVICES AND APPARATUS THEREFOR</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>A method of providing secure communication of digital data between devices, said method comprising the steps of communicating from one device among other devices, an identifier of said one device to an independent security module and performing device validation depending on the identity of the communicated identifier.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>A METHOD OF PROVIDING SECURE COMMUNICATION OF<br>
DIGITAL DATA BETWEEN DEVICES AND APPARATUS THEREFOR<br>
The present invention relates to a method of providing secure<br>
communication of digital data between devices and apparatus for providing<br>
secure communication of digital data between devices. More specifically, the<br>
present invention relates to preventing illegal copying and redistribution of<br>
digitally recorded data.<br>
The introduction of digital technology in the audiovisual field has brought considerable<br>
advantages to the consumer in comparison with analog technologies, notably in<br>
relation to the quality of reproduction of sound and image and the durability of the<br>
supporting medium. The compact disk has all but replaced traditional vinyl records<br>
and a similar trend is expected with the introduction of new digital products aimed at<br>
the multimedia and home entertainment markets generally, notably the DVD (digital<br>
video disk or digital versatile disk) players.<br>
A particular problem associated with digitally recorded data lies in its ease of<br>
reproduction and the possibilities for piracy that arise therefrom. A single digital<br>
recording may be used to make any number of perfect copies without any degradation<br>
in quality of the sound or image. This problem is a serious one, particularly with the<br>
advent of recordable digital products such as the minidisk or DAT, and the reluctance<br>
of entertainment companies to license copyright works whilst this problem remains has<br>
acted as a break on the introduction into the market of new media products.<br>
At present, the most practically available solution against unauthorised reproduction<br>
of copyright works has been a legal one, and a number of countries in Europe and<br>
elsewhere have introduced anti-piracy legislation to combat the increasing number of<br>
pirate films, CDs etc being brought onto the market. For obvious reasons, a legal<br>
solution is less than optimal from the point of view of preventative action.<br>
Technological solutions proposed to date to prevent the unauthorised copying and<br>
distribution of digitally recorded data have been extremely basic, relying for example<br><br>
on the idea of using some form of digital " handshake " between devices in the digital<br>
audiovisual system, for example, between the digital data, or DVD, player and the<br>
digital recorder, and between the DVD player and the digital television, so as to verify<br>
the origin of the device receiving the data from "the DVD piayer. Such protection is,<br>
however, effective against only the most low level of copying activity, since the<br>
handshake signal is typically not protected in any way and may be easily read and<br>
reproduced so as to convert, for example, an unauthorised recorder device into an<br>
apparently authorised recorder device.<br>
The aim of the present invention is to overcome the disadvantages associated with the<br>
prior art techniques and to provide a technological solution against the unauthorised<br>
copying and reproduction of digitally recorded copyright works.<br>
Accordingly, the present invention provides a method of providing secure<br>
communication of digital data between devices, said method comprising the<br>
steps of communicating from one device among other devices, an identifier of<br>
said one device to an independent security module and performing device<br>
validation depending on the identity of the communicated identifier.<br>
In such a method, a independent security module is used to validate a device in, for<br>
example, a digital audiovisual system. For example, in a system in which data is<br>
communicated from a DVD player to a digital recorder, the user of the system might<br>
possess an appropriate smartcard for validating the recorder and/or the player before<br>
any data is transferred. Thus, by using a security module to validate devices, an extra<br>
level of security can be added to the system.<br>
Indeed, the use of an independent security module can lead to a highly personalized<br>
digital audiovisual system. For instance, the security module may enable data to be<br>
transferred from a DVD player to a digital television only if both the player and<br>
television are validated by the security module, thus enabling the digital data to be<br>
viewed only on the user's personal television.<br><br>
The use of a security module to validate linked devices also provides an advantage in<br>
that device validation can become independent of the link between the devices. Thus,<br>
if the communication link is intercepted bv a third party, the identifiers of the devices<br>
cannot be obtained as they are not passed between the devices but from the individual<br>
devices to a security module.<br>
Such security modules can take any convenient form depending on the physical size<br>
and characteristics of the modules. For example, the security module may be<br>
detachable, for example removably insertable into a socket provided in the device or<br>
a separate module connected to the device. In some cases a smart card equivalent to<br>
a bank card may be used (as or as part of the security module), but other formats, such<br>
as PCMCIA type cards, are equally possible. Thus, the security module may be easily<br>
replaced in order to update the rights provided by the security module, for example<br>
to invalidate certain devices in the event of the system provider becoming aware of<br>
cloning of those devices.<br>
The device identifier may take any convenient form. For example, the identifier may<br>
be a public key associated with the device.<br>
The security module may perform device validation by comparing the communicated<br>
identifier with at least one stored identifier. The stored identifiers may be stored in<br>
a memory oFthe security module. The identifiers may be stored in the form of a list,<br>
the received identifier being compared with the identifiers in the list in order to<br>
validate the device. This can provide for fast and efficient validation of the deviee.<br>
Each stored identifier may be associated with a respective one of a valid device or an<br>
invalid device. Upon receipt of the identifier, the security module may compare the<br>
received identifier with stored identifiers associated with invalid devices, and/or with<br>
stored identifiers associated with valid devices.<br>
Thus, the security module may contain at least one of a "revocation list" for<br>
blacklisting non-compliant devices and an "authorization list" for restricting transfer<br><br>
of data to between pre-registered devices only. Device identifiers intentionally<br>
published by third parties, for example, on the Internet, can be added to the revocation<br>
list when periodically updating the security module in order to prevent data from being<br>
transferred to or from these devices.. However, the use of an authorization list can also<br>
prevent device identifiers intentionally published on the Internet from working since<br>
these identifiers will not be valid anywhere except in, for example, a home network.<br>
The authorization list is therefore likely to be much shorter than the revocation list,<br>
thus saving memory capacity, and is likely to require less-frequent updating. Thus,<br>
in a second aspect the present invention provides a method of providing secure<br>
communication of digital data between devices, said method comprising the steps of<br>
comparing an identifier communicated from one device with at least one stored<br>
identifier, each stored identifier being associated with a respective valid device, and"<br>
validating the device if the communicated identifier is identical to the or one of the<br>
stored identifiers.<br>
It is preferable that said at least one stored identifier is stored in an independent<br>
security module.<br>
The communicated identifier may be compared with identifiers associated with valid<br>
devices according to the setting of a flag. The flag may be stored within the security<br>
module or may be transmitted to the security module by the device.<br>
For example, the security module may compare the received identifier with stored<br>
identifiers associated with invalid devices when the flag has a first setting, and<br>
compare the received identifier with stored identifiers associated with valid devices<br>
when the flag has a second setting.<br>
The flag may be set according to rights provided to the user. For example, the flag<br>
may take the first setting for a shop wherein a number of different devices are used,<br>
the setting of the flag being such that the received identifier is compared with stored<br>
identifiers associated with invalid devices only. The flag may take the second setting<br><br>
for a home user wherein only a small number of devices are used, the setting of the<br>
flag being such that the received identifier is compared with stored identifiers<br>
associated with valid devices only.<br>
In one embodiment, the security module may compare the received identifier with<br>
stored identifiers associated with invalid devices when the flag has a setting "0". and<br>
compare the received identifier with both stored identifiers associated with invalid<br>
devices and stored identifiers associated with valid devices when the flag has a setting<br>
In a preferred embodiment of the invention, certificates are passed between the device<br>
and the security module to validate the device.<br>
The use of a certificate system to validate a device can provide for secure transmission<br>
of the identifier from the device to the security module. Thus, the identifier of the<br>
device may be communicated to the security module in an encrypted certificate, and<br>
so problems associated with the transmission of identifiers of devices "in the clear"<br>
can be avoided.<br>
The certificate may be signed, for example, using a private key, such as a private key<br>
of the manufacturer of the device, to enable the authenticity of the communicated<br>
certificate to be verified. Thus, if the security module determines that the data<br>
contained in the certificate and its signature do not correlate, the certificate can be<br>
rejected.<br>
An equivalent key to the private key may be communicated to the security module in<br>
a certificate encrypted by a system private key, a system public key being stored in<br>
both the security module and the device.<br>
The encrypted certificate is preferably further encrypted by the device using a security<br>
module public key and communicated to the security module. The encrypted<br>
certificate may be subsequently decrypted by the security module first using a security<br><br>
module private key and secondly using said equivalent key to enable the identifier of<br>
the device to be extracted from the decrypted certificate.<br>
The public key of the security module" may be communicated by the security module<br>
to the device in a certificate. The certificate including the public key of the security<br>
module may be encrypted using a private key, for example, of the manufacturer of the<br>
security module. This certificate may also be signed using the private key to enable<br>
the authenticity of the communicated certificate to be verified. An equivalent key to<br>
the private key may be communicated to the device in a certificate encrypted by the<br>
system private key, the system public key being stored in both the security module and<br>
the device.<br>
The certificate containing the device identifier may be randomised by the device prior<br>
to encryption, the randomisation being reversed by the security module following<br>
decryption of the certificate. This can increase the security of the passing of the<br>
device identifier from the device to the security module.<br>
In addition to verifying a device, the security module may transfer information to a<br>
device in order, for example, to enable the device to process digital data received from<br>
another device. Thus, it is preferable to create a secure communication channel<br>
between the device and the security module.<br>
In one preferred embodiment of the present invention, a random number is generated<br>
by the device, the random number and the certificate containing the device identifier<br>
being encrypted by the device using a public key of the security module and<br>
communicated to the security module. The encrypted random number and certificate<br>
may be decrypted by the security module using a private key of the security module<br>
to obtain the random number and to enable the identifier of the device to be extracted<br>
from the decrypted certificate.<br>
The extracted random number may subsequently be stored in the security module such<br>
that data communicated between the security module and the device may thereafter be<br><br>
encrypted and decrypted by the random number in the security module and the device,<br>
thereby providing a secure communication link between the device and the security<br>
module.<br>
Thus, in a third aspect the present invention provides a method of providing secure<br>
communication of digital data between a device and a security module, said method<br>
comprising the steps of transferring to the security module a random number and an<br>
identifier of the device encrypted by a public key of the security module, the security<br>
module decrypting the random number and device identifier using a private key of the<br>
security module, validating the device using the device identifier and, upon validation<br>
of the device, using the random number to encrypt and decrypt data communicated<br>
between the security module and the device.<br>
Preferably, the device identifier is included in a certificate, the certificate being<br>
encrypted using the public key of the security module.<br>
The random number may be randomised by the device prior to encryption, the<br>
randomisation being reversed by the security module following decryption of the<br>
random number.<br>
Alternatively, the random number and the certificate containing the device identifier<br>
may be randomised by the device prior to encryption, the randomisation being<br>
reversed by the security module following decryption of the random number and<br>
certificate.<br>
In order to increase the security of the communication link between the device and the<br>
security module, the security module may communicate to the device a random key<br>
generated in the security module and encrypted using the random number, the device<br>
decrypting the key using the random number and thereafter using the key to encrypt<br>
data sent to the security module.<br>
In addition to validating a device and for secure communication of data between the<br><br>
device and the security module, the security module may be adapted to provide access<br>
rights to data received by the device.<br>
For example, the device may communicate to the security module an encrypted<br>
Entitlement Control Message (ECM) containing a control word for descrambling data,<br>
the device further encrypting the encrypted ECM using the key. Thus, ECMs<br>
transmitted between a device and a security module are encrypted twice, one of the<br>
encryption keys being generated by the security module and therefore unique to the<br>
device and the security module. This can provide significant improvements in the<br>
prevention of illegal copying and redistribution of ECMs.<br>
The security module may decrypt the encrypted ECM, extract the control word from<br>
the ECM and communicate to the device the control word encrypted using the key"<br>
This can enable a device such as a digital television to descramble scrambled data<br>
received from a DVD player. Moreover, the control word may always be passed to<br>
the device in encrypted form, the encryption being conducted using a key previously<br>
transmitted to the device following validation of the device. Therefore, the storage of<br>
additional public/private keys for encrypting and decrypting the control words, or<br>
personalization of the device to the security module (or vice versa) is not required.<br>
Alternatively, the device may communicate to the security module an encrypted<br>
extended Entitlement Control Message (XECM) containing extended Control<br>
Management Information (XCMI), or access rights, to data, the device further<br>
encrypting the encrypted XECM using the key. The security module may decrypt the<br>
encrypted XECM, modify the access rights contained in the XECM, encrypt the<br>
modified XECM and communicate to the device the encrypted modified XECM<br>
further encrypted using the key.<br>
Thus, the security module may modify access rights afforded to the device by an<br>
XECM. For example, if the device is a digital recorder device, these rights may<br>
include the prohibition of any subsequent re-recording of the stored data, the number<br><br>
of times which the stored data may be replayed, the expiry date of replay, etc.<br>
In order to enable the devices to function more effectively it is desired to provide a<br>
securised or encrypted communication link between the devices'. The implementation<br>
of a secure link between the devices can be used to enable information needed to<br>
prepare or play a recording to be passed freely between the devices. Unfortunately,<br>
the independence of activities between a manufacturer of a DVD player and a<br>
manufacturer of recording equipment responsible for the recorder may lead to a<br>
number of problems regarding the provision of encryption keys for this purpose.<br>
For example, a player manufacturer may not place sufficient confidence in the<br>
integrity of security at the manufacturing site of a recorder to entrust the manufacturer<br>
with, for example, a secret symmetric algorithm key needed by the recorder to decrypt<br>
communications encrypted using the equivalent key held by the DVD player.<br>
Furthermore, the separation of activities may make it impractical to envisage a<br>
situation in which the recorder is sent to a broadcast system manager for<br>
personalisation with the appropriate keys. For this reason, it is necessary to envisage<br>
a solution which allows the greatest independence of operation for the player and<br>
recorder.<br>
In order to solve such problems, in a preferred embodiment of the present invention,<br>
data is communicated between first and second devices, and upon validation of each<br>
device by the security module, the security module communicates to the first device<br>
a random key generated in the security module and encrypted using the random<br>
number generated by the first device, the first device decrypting the kev using the<br>
random number generated thereby, and communicates to the second device the key<br>
encrypted using the random number generated by the se device, the second device<br>
decrypting the key using the random nurnber generated thereby, the key thereafter<br>
being used to encrypt data communicated to the security module by the devices and<br>
data communicated between the devices.<br><br>
Accordingly, in a fourth aspect the present invention provides a method of providing<br>
secure communication of digital data between devices, said method comprising the<br>
step of providing a security module, generating a random key (SK) in the security<br>
module and encrypting data communicated between the devices using the random key.<br>
By this method, the generation of an encryption key for securing communication<br>
between the devices is performed by a security module in communication with the<br>
devices, and so key generation is performed independently of the devices.<br>
Such a method can provide a secure, flexible and upgradeable device interface-<br>
independent system for providing secure communication of digital data between<br>
devices. The system can be based on a smartcard for generating the session key, and<br>
therefore can be cheap and enable fast action against piracy by the ease of providing<br>
updated smartcards, particularly as the responsibility of updating security can be the<br>
responsibility of a dedicated smartcard provider and not the device manufacturers.<br>
The security module may communicate to each device the key encrypted using a<br>
random number generated by that device, the device decrypting the key using the<br>
random number.<br>
Each device may communicate to the security module the respective random number<br>
encrypted using a public key of the security module. The encrypted random number<br>
may be subsequently decrypted by the security module using a private key of the<br>
security module to obtain the random number. Each random number may be<br>
randomised by the respective device prior to encryption, the randomisation being<br>
reversed by the security module following decryption of the random number.<br>
Preferably, the security module validates each device before transmitting the key to<br>
each device. To enable such validation to be performed, each device preferably<br>
communicates an identifier thereof to the security module for validation of the device<br>
by the security module.<br>
The key may be periodically changed by the security module. The key may be<br><br>
updated, for example, on an hourly basis, or after a predetermined number of data<br>
packets are passed between the devices. This can provide further security to the data<br>
communication. Alternatively, the key may be randomly changed by the security<br>
module, for example, upon switching "the device on, disc insertion, zapping of the<br>
device by the user, establishment of a connection with the security module etc.<br>
A preferred embodiment of the present invention is applied to a home network system,<br>
the devices corresponding to first and second consumer electronic devices adapted to<br>
transfer data therebetween via a communication link. The communication link<br>
between the two devices may take one of many forms, for example, a radio, telephone<br>
or infra-red link. However, preferably, the communication link is implemented by<br>
connection of the first and second devices on a bus, for example, a IEEE 1394 bus<br>
link.<br>
The first device may communicate to the second device scrambled audio and/or visual<br>
data and an encrypted Entitlement Control Message (ECM) containing a control word<br>
for descrambling the data, said data and said encrypted ECM being encrypted by the<br>
first device using the key.<br>
The second device may decrypt the data and the encrypted ECM using the key,<br>
separate the encrypted ECM from the data, and communicate to the security module<br>
the encrypted ECM re-encrypted using the key. The security module may decrypt the<br>
encrypted ECM, extract the control word from the ECM and communicate to the<br>
second device the control word encrypted using the key. In this embodiment, the first<br>
device may be a DVD player and the second device may be a digital television.<br>
Furthermore, the security module may modify the ECM and communicate to the<br>
second device the modified ECM encrypted using the key. In this embodiment, the<br>
first device may be a DVD player and the second device may be a digital recorder<br>
device.<br>
In a fifth aspect the present invention provides apparatus for providing secure<br><br>
communication of digital data between devices, said apparatus comprising a security<br>
module comprising means for receiving an identifier of a device and means for<br>
performing device validation depending on the identity of the received identifier.<br>
In a related aspect the present invention provides a security module for providing<br>
secure communication of digital data between devices and arranged to receive an<br>
identifier of a device and to perform device validation depending on the identity of the<br>
received identifier.<br>
In a sixth aspect the present invention provides apparatus for providing secure<br>
communication of digital data between devices, said apparatus comprising means for<br>
storing at least one identifier, each stored identifier being associated with a respective<br>
valid device, means for comparing an identifier of a device with said at least one<br>
stored identifier, and means for validating the device if the identifier of the device is<br>
identical to the or one of the stored identifiers.<br>
In a related aspect the present invention provides a security module for providing<br>
secure communication of digital data between devices and arranged to store at least<br>
one identifier, each stored identifier being associated with a respective valid device,<br>
to compare an identifier of a device with said at least one stored identifier, and to<br>
validate the device if the identifier of the device is identical to the or one of the stored<br>
identifiers.<br>
In a seventh aspect the present invention provides a system for providing secure<br>
communication of data between a device and a security module, said device<br>
comprising means for communicating to the security module a random number and<br>
an identifier of the device encrypted by a public key of the security module, the<br>
security module comprising means for decrypting the random number and device<br>
identifier using a private key of the security module, means for validating the device<br>
using the device identifier, and means for using the random number to encrypt and<br>
decrypt data communicated between the security module and the device.<br><br>
In a related aspect the present invention provides a security module arranged to receive<br>
a random number and an identifier of a device encrypted by a public key of the<br>
security module, decrypt the random number and device identifier using a private key<br>
of the security module; validate the device using the device identifier, and, upon<br>
validation of the device, use the random number to encrypt and decrypt data<br>
communicated between the security module and the device<br>
In an eighth aspect the present invention provides apparatus for providing secure<br>
communication of digital data between devices, said apparatus comprising the devices<br>
and a security module comprising means for generating a random key and means for<br>
communicating the random key to the devices, each device being arranged to encrypt<br>
data communicated between the devices using the random key.<br>
In a related aspect the present invention provides a security module for providing<br>
secure communication of digital data between devices and arranged to generate a<br>
random key (SK) for encrypting data communicated between the devices and to<br>
communicate the random key to the devices.<br>
Whilst the invention has been described with reference to a first and second device,<br>
it will be appreciated that the same principle may be used to set up a chain of<br>
communication between a series of such devices.<br>
Suitable algorithms for use in this invention for generating private/public keys may<br>
include RSA, Fiat-Shamir, or Diffie-Hellman, and suitable symmetric key algorithms<br>
may include DES type algorithms, for example. However, unless obligatory in view<br>
of the context or unless otherwise specified, no general distinction is made between<br>
keys associated with symmetric algorithms and those associated with public/private<br>
algorithms.<br>
The terms "scrambled" and "encrypted", and "control word" and "key" have been used<br>
at various parts in the text for the purpose of clarity of language. However, it will be<br>
understood that no fundamental distinction is to be made between "scrambled data"<br><br>
and "encrypted data" or between a "control word" and a "key".<br>
Additionally, the terms "encrypted" and "signed", and "decrypted" and "verified" have<br>
been used at various parts in the text for the purpose of clarity of language. However,<br>
it will be understood that no fundamental distinction is to be made between "encrypted<br>
data" and "signed data", and "decrypted data" and "verified data".<br>
Similarly, the term "equivalent key" is used to refer to a key adapted to decrypt data<br>
encrypted by a first mentioned key, or vice versa.<br>
Features described above relating to method aspects of the present invention can also<br>
be applied to apparatus aspects, and vice versa.<br>
Preferred features of the present invention will now be described, by way of example<br>
only, with reference to the accompanying drawings, in which:<br>
Figure 1 shows the elements of a digital audiovisual system;<br>
Figure 2 shows the distribution of certificates in a digital audiovisual system;<br>
Figure 3 shows the connection of a security module to a device;<br>
Figure 4 shows the connection of a security module to two devices;<br>
Figure 5 shows the steps associated with the validation of a device by the security<br>
module and subsequently providing secure communication between the device and the<br>
security module;<br>
Figure 6 shows the steps associated with the generation of a secure channel of<br>
communication between a device and a security module;<br>
Figure 7 illustrates the descrambling of data received by a device;<br><br>
Figure 8 shows the steps associated with the provision of secure communication<br>
between two devices;<br>
Figure 9 shows the transfer of data between two devices over a secure communication<br>
link;<br>
Figure 10 shows the steps associated with the setting up of a secure communication<br>
link between a DVD player and a digital television and the subsequent operations<br>
carried out to descramble data received from the DVD player by the digital television;<br>
and<br>
Figure 11 shows the steps associated with the setting up of a secure communication<br>
link between a DVD player and a digital recorder and the subsequent operations<br>
carried out to descramble data received from the DVD player by the digital recorder.<br>
Referring to Figure 1, elements of a digital audiovisual system 10 for recordal and<br>
replaying of digital data will first be described. Whilst the invention will be discussed<br>
in relation to the playing of audiovisual data on a DVD player, it may also<br>
conveniently be applied, for example, to the playing of exclusive audio information<br>
subsequently recorded on a DAT or minidisc recorder or even to the communication<br>
of software recorded on the hard disc of a computer.<br>
Typically the audiovisual system comprises a DVD player 12 for the playback of<br>
digital audiovisual data stored, for example, on disk or tape. The DVD player is<br>
linked to a digital display 14 for the display of the data played by the DVD player 12.<br>
The display 14 is preferably provided in the form of a digital television. The<br>
communication link 16 between the player 12 and display 14 may take many forms,<br>
for example, a radio, telephone or infra-red link. However, preferably, the<br>
cqrnmunication link is implemented by connection of the player and television on a<br>
bus, for example, a IEEE 1394 bus link.<br>
The system additionally includes a digital recorder 18, such as a DVHS or DVD<br><br>
recorder, adapted to communicate with the DVD player 12, for example, via an IEEE<br>
1394 bus 20. The recorder 18 receives a digital recording support (not shown) on<br>
which information is recorded. The recorder 18 includes a direct link 22 to the display<br>
14. However, digital audiovisual data may be passed from the player. 12 to the<br>
recorder 18 prior to display.<br>
Whilst the elements of player 12, display 14 and recorder 18 have been indicated<br>
separately, it is conceivable that some or all of these elements may be merged, for<br>
example, to provide a combined player/television set.<br>
In order to provide secure communication of data between devices in the digital<br>
audiovisual system, for example, to prevent the unauthorised copying and distribution<br>
of digitally recorded data, a validation system is used to validate one or more of the<br>
devices in the audiovisual system prior to any communication of data between the<br>
devices.<br>
A preferred device validation system is based on the transfer of certificates between<br>
a device and a security module. With reference to Figure 2, each device and security<br>
module is assigned a unique certificate for validation purposes.<br>
In a first stage of a certificate distribution system a certification authority (CA) 50<br>
delivers encrypted certificates to both consumer electronics (CE) manufacturers 52 and<br>
security providers (SP) 54.<br>
The CA 50 communicates to each CE manufacturer 52 a respective encrypted<br>
certificate CertCA (CEman_Kpub) shown at 56. This certificate contains, inter alia, a<br>
manufacturer public key CEman_Kpub and is encrypted by a system, or CA, private<br>
key CA_Kpri. To enable the contents of the certificate to be decrypted by the CE<br>
manufacturer 52, the CA 50 communicates to the CE manufacturer 52 the CA public<br>
key CA_Kpub. It should be mentioned that the private key CA_Kpri is unique to and<br>
held exclusively by the CA 50.<br><br>
In a similar manner, the CA 50 communicates to each security provider 54 a<br>
respective encrypted certificate CertCA(SP_Kpub) shown at 58. This certificate<br>
contains, inter alia, a security provider public key SP_Kpub and is encrypted by the<br>
CA private key CA_Kpri. To enable the contents of the certificate to be decrypted by<br>
the security provider 54, the CA 50 communicates to the security provider 54 the CA<br>
public key CA_Kpub.<br>
In a second stage of the certificate distribution system, each consumer electronics (CE)<br>
manufacturer 52 and security provider (SP) 54 assigns respective certificates to its own<br>
products.<br>
Each CE manufacturer 52 assigns to each of its CE devices 60 a respective encrypted<br>
certificate CertCE5m(Device Kpub) shown at 62. This certificate contains, inter alia,"<br>
a unique device public key Device_Kpub, together with an indication of the device<br>
capability (recorder, player, etc.). The certificate is encrypted by an equivalent key to<br>
the public key CEman_Kpub. To enable the contents of the certificate to be<br>
decrypted, the CE manufacturer 52 stores in the CE device the CA public key<br>
CA_Kpub and the encrypted certificate CertCA(CEman_Kpub) of the CE manufacturer<br>
52. Thus, the public key Device_Kpub of the CE device 60 can serve as an identifier<br>
of the device.<br>
Similarly, each security provider 54 assigns to each security module 64 a respective<br>
encrypted certificate CertSP(SM_Kpub) shown at 66. Such security modules 66 can<br>
take any convenient form depending on the physical size and characteristics of the<br>
modules. For example, the security module may be removably insertable into a socket<br>
provided in a CE device 60 or may be a separate module connected to the device 60.<br>
In some cases a smart card equivalent to a bank card may be used, but other formats<br>
such as PCMCIA type cards are equally possible.<br>
The encrypted certificate assigned to the security module 64 contains, inter alia, a<br>
unique security module public key SM_Kpub. The certificate is encrypted by an<br>
equivalent key to the public key SP_Kpub. To enable the contents of the certificate<br><br>
to be decrypted, the security provider 54 stores in the security module 64 the CA<br>
public key CA_Kpub and the encrypted certificate CertCA(SP_Kpub) of the security<br>
provider. Thus, the public key SM_Kpub of the security module 64 can serve as an<br>
identifier of the security module.<br>
A signature may be included in any of the above certificates to enable the contents of<br>
the certificate to be verified following decryption of the certificate. The contents of<br>
the certificate may be signed using the key used to encrypt the certificate.<br>
Validation of a device in the digital audiovisual system is carried out by the exchange<br>
of certificates between the device and a security module. As shown in Figure 3, in<br>
a first embodiment the security module 64 is connected to the device 60 via a<br>
communication link 70 to enable the security module to validate that device only.<br>
However, as shown in Figure 4, the security module may alternatively be connected<br>
to two or more connected devices 60a, 60b via respective communication links 70a,<br>
70b.<br>
Validation of a single device by a security module will now be described with<br>
reference to Figure 5.<br>
The validation procedure can be initiated at any time, for example, upon switching the<br>
device on, disc insertion, zapping of the device by the user, establishment of<br>
connection with the security module etc.<br>
The validation procedure is initiated by the security module. As shown at 100, the<br>
security module 64 communicates to the device 60 the encrypted certificate<br>
CertCA(SP_Kpub) of the security provider 54. At 102, the device decrypts the contents<br>
of the encrypted certificate CertCA(SP_Kpub) using the public key CA_Kpub of the CA<br>
50 to enable the public key SP_Kpub of the security provider 54 to be extracted from<br>
the certificate.<br>
Following communication of the encrypted certificate CertCA_(SP_Kpub) to the device<br><br>
60, at 104 the security module 64 communicates its own unique encrypted certificate<br>
CertSP(SM_Kpub) to the device 60. At 106 the device decrypts the contents of the<br>
encrypted certificate CertSP(SM_Kpub) using the public key SP_Kpub of the security<br>
provider previously extracted by the device 60 from the encrypted certificate<br>
CertCA(SP_Kpub) in order to enable the public key SM__Kpub of the security module<br>
64 to be extracted from the certificate.<br>
At 108, the device 60 communicates to the security module 64 the encrypted<br>
certificate CertCA(CEman_Kpub) of the CE manufacturer 52. At 110, the security<br>
module 64 decrypts the encrypted certificate CertCA(CEman_Kpub) using the public<br>
key CA_Kpub of the CA 50 to enable the public key CEman_Kpub of the CE<br>
manufacturer 52 to be extracted from the certificate.<br>
Following communication of the encrypted certificate CertCA(CEman_Kpub) to the<br>
security module 64, at 112 the device 60 generates a random number X. The random<br>
number X performs no function in the validation of the device by the security module.<br>
Instead, the random number X is used to generate a secure authenticated channel<br>
(SAC) between the device 60 and the security module 64. This is described in more<br>
detail below.<br>
At 114 the device 60 performs bit shuffling of random number X and the encrypted<br>
certificate CertCEmim(Device_Kpub) stored in the device 60 in order to scramble the<br>
random number X and encrypted certificate CertCEman_(Device_Kpub). The bit shuffled<br>
random number X and encrypted certificate CertCEman_(Device_Kpub) are subsequently<br>
encrypted at 116 using the public key SM_Kpub of the security module 64 previously<br>
communicated to the device 60 by the security module at step 104, and communicates<br>
the encrypted bit shuffled random number and encrypted certificate<br>
CertCEman_(Device_Kpub) to the security module 64 at step 118.<br>
At 120, the security module 64 decrypts the encrypted bit shuffled random number and<br>
encrypted certificate CertCEman_(Device_Kpub) using an equivalent key SM_Kpriv to the<br>
public key SM_Kpub. The bit shuffling of the shuffled random number and encrypted<br><br>
certificate CertCEman(Device_Kpub) is reversed at step 122.<br>
An algorithm used to bit shuffle the random number X and encrypted certificate<br>
CertCEmm(Device_Kpub) may be stored in the security module 64 to enable the bit<br>
shuffling to be reversed. Alternatively, the security module 64 may send to the device<br>
60 a random number, referred to as a random challenge, Z, following receipt of the<br>
encrypted certificate CertCA(CEman_Kpub). The random challenge Z is bit shuffled<br>
by the device 60, encrypted using the security module public key SM_Kpub and<br>
transmitted to the security module, preferably at the same time as the bit shuffled<br>
random number X and encrypted certificate CertCEman(Device_Kpub). The security<br>
module 64 decrypts the encrypted shuffled random challenge Z and compares the bit<br>
shuffled random challenge with the unshuffled random challenge stored therein in<br>
order to determine how the random challenge Z has been shuffled by the device 60.<br>
The security module 64 uses the result of this challenge to reverse the bit shuffling<br>
applied to the random number X and encrypted certificate CertCA(CEman_Kpub) by<br>
the device.<br>
Returning to Figure 5, the random number is extracted and stored by the security<br>
module 64 at step 124. At 126, the security module 64 decrypts the encrypted<br>
certificate CertCEman(Device_Kpub) using the public key CEman_Kpub of the CE<br>
manufacturer 52 previously transmitted to the security module 64 by the device 60 in<br>
order to enable the public key Device_Kpub of the device 60 to be extracted from the<br>
certificate.<br>
Validation of the device 60 is carried out by the security module 64 using the public<br>
key Device_Kpub of the device 60 at step 128. The security module compares the<br>
received device public key Device_Kpub with a list of device public keys previously<br>
stored in the security module. The list of device public keys may be generated by the<br>
CA 50 and stored, for example, in memory, such as non-volatile memory, in the<br>
security module 64 by the security provider 54.<br>
The security module 64 supports two types of list. A "revocation list" contains device<br><br>
public keys associated with invalid devices and is used to blacklist non-compliant<br>
devices. An "authorization list" contains device public keys associated with valid<br>
devices and is used to restrict transfer of data to between pre-registered devices only.<br>
Device identifiers intentionally published by third parties, for example, on the Internet,<br>
can be added to the revocation list by the CA 50 when periodically updating the<br>
security module 64 in order to prevent data from being transferred to or from these<br>
devices or clones of these devices. However, the use of an authorization list can also<br>
prevent device identifiers intentionally published on the Internet from working since<br>
these identifiers will not be valid anywhere except in, for example, a home network.<br>
A flag embedded within the encrypted device certificate or the encrypted security<br>
module certificate determines the list with which the received device public key is<br>
compared. For example, the security module may compare the received device public<br>
key with stored public keys associated with invalid devices when the flag has a setting<br>
"0", and compare the received device public key with both stored public keys<br>
associated with invalid devices and stored public keys associated with valid devices<br>
when the flag has a setting "1".<br>
If the device 60 is determined to be an invalid device, the security module 64<br>
terminates communication with the device 60. If, as shown in Figure 4, the security<br>
module is in communication with other devices, communication with those devices is<br>
â€¢ also terminated.<br>
If the device is determined to be a valid device, the security module 64 generates a<br>
secure authenticated channel (SAC) of communication between the device 60 and the<br>
security module 64. Figure 6 shows the steps associated with the generation of a<br>
secure authenticated channel of communication between a device and a security<br>
module.<br>
In step 200 the security module 64 generates a random session key SK. The random<br>
session key SK is TDES encrypted at step 202 by the security module 64 using the<br><br>
random number X transmitted to the security module 64 by the device 60. The<br>
encrypted session key TDESX(SK) is transmitted to the device 60 at step 204.<br>
At step 206, the-device -60 decryets the encrypted session key TDESX(SK) using the<br>
random number X and stores the session key SK in memory at step 208. The session<br>
key SK is thereafter used to encrypt data transferred between the device 60 and the<br>
security module 64.<br>
Thus, following validation of the device, key distribution is undertaken by the security<br>
module in order to create a secure channel of communication between the device and<br>
the security module. Updating of the session key (SK) can also be initiated at any<br>
time, for example, upon switching the device on, disc insertion, zapping of the device<br>
by the user, establishment of connection with the security module etc.<br>
With reference to Figure 1, the DVD player 12 typically transmits scrambled data to<br>
the display 14 and recorder 18. The steps associated with the descrambling of data<br>
received by a device will now be described with reference to Figure 7,<br>
A DVD disk typically stores encrypted Entitlement Control Messages (ECMs) together<br>
with the scrambled audio and/or visual data. An ECM is a message related to the<br>
scrambled audio and/or visual data. The message contains a control word (which<br>
allows for the descrambling of the data) and the access criteria of the data. The access<br>
criteria and control word are transmitted by the DVD player 12 to, for example,<br>
display 14 via the communication link 16.<br>
The data stored on the disk typically comprises a number of distinct components; for<br>
example a television programme includes a video component, an audio component, a<br>
sub-title component and so on. Each of these components is individually scrambled<br>
and encrypted. In respect of each scrambled component of the data, a separate ECM<br>
is required. Alternatively, a single ECM may be required for all of the scrambled<br>
components of a service<br><br>
The control word typically changes every few seconds, and so ECMs are also<br>
periodically inserted in the data to enable the changing control word to be<br>
descrambled. For redundancy purposes, each ECM typically includes two control<br>
words; the present control word and the next control word.<br>
Upon receipt of scrambled data and an encrypted ECM from the DVD player 12, the<br>
display 14 extracts the ECM from the scrambled data and passes the extracted ECM<br>
to descrambling circuitry for decrypting the ECM and extracting the control word from<br>
the decrypted ECM.<br>
The descrambling circuitry may be implemented in a detachable conditional access<br>
module 40 or CAM, commonly embodied in the form of a PCMCIA, or PC, card<br>
insertable in a socket in the recipient device. Alternatively, the CAM 40 may be<br>
physically separate from the recipient device, the CAM 40 and display 14 being<br>
communicably linked by any suitable communication link 42, for example via a serial<br>
or parallel interface.<br>
The CAM 40 may itself further include a slot to receive a smart card. In such<br>
systems, the smartcard controls whether the end user has the right to decrypt the ECM<br>
and to access the programme. If the end user does have the rights, the ECM is<br>
decrypted by a processor 41 within the smart card and the control word extracted.<br>
The processor 41 of the CAM 40 may then descramble the scrambled data to supply<br>
the recipient device with a clear data stream for, for example, decompression and<br>
subsequent display. Alternatively, the descrambling of the data may be carried out<br>
within the display 14 using the control word information communicated to the display<br>
14 from the CAM 40.<br>
In the case where scrambled data is communicated from the DVD player 12 to the<br>
digital recorder 18 for subsequent viewing, the manufacturer of the DVD disk may<br>
wish to restrict access to the recorded data. For example, the disk manufacturer may<br>
wish to prohibit any further copying of the recorded data. In such situations, the<br>
access rights, or extended Control Management Information (XCMI), are contained<br><br>
is an extended Entitlement Control Message (XECM) which includes any access rights<br>
as determined by the disk manufacturer. Upon receipt of the XECM, the processor<br>
41 of the CAM 40 decrypts the XECM, modifies the XECM, for example to prohibit<br>
any copying of the recorded data, re-encrypts the ECM and passes the. modified, re-<br>
encrypted ECM back to the recorder device.<br>
In this type of system, sensitive data (control words, modified XECMs or descrambled<br>
data) may be passed between the CAM and the display 14 or recorder 18 and<br>
problems of security may arise at this interface. To overcome such problems, prior<br>
to communication of any data, for example, an ECM from the display 14 to the<br>
smartcard, a secure authenticated channel (SAC) 42 is created, as described above with<br>
reference to Figures 5 and 6, between the display 14 and the CAM 40. In order to<br>
create the SAC 42 between the display 14 and the CAM 40, the CAM 40 must store,<br>
for example in the smartcard, the list of device public keys in order to validate the<br>
display 14.<br>
As shown in Figure 4, the security module may be connected to two or more<br>
connected devices 60a, 60b via respective communication links 70a, 70b. As well as<br>
validating both of these devices, each device being validated as described in Figure 5,<br>
the security module can create a secure communication channel between the devices.<br>
Figure 8 shows the steps associated with the provision of secure communication<br>
between two devices.<br>
The provision of secure communication between device A 60a and device B 60b is<br>
carried out after both of the devices 60a, 60b have been validated by the security<br>
module. With reference to Figure 8, at step 300 the security module 64 generates a<br>
random session key SK. The random session key SK is encrypted at step 302 by the<br>
security module 64 using the random number X transmitted to the security module 64<br>
by the device A 60a during validation of the device. The encryption is preferably<br>
conducted using a symmetric algorithm, such as Triple DES (TDES).<br>
The encrypted session key TDESX(SK) is transmitted to the device A 60a at step 304.<br><br>
At step 306, the device A 60a decrypts the encrypted session key TDES:c(SK) using<br>
the random number X and stores the session key SK in memory.<br>
At step 308, the random session key SK is additionally TDES encrypted by the<br>
security module 64 using random number Y transmitted to the security module 64 by<br>
the device B 60b during validation of the device. The encrypted session key<br>
TDESY(SK) is transmitted to the device B 60b at step 310. At step 312, the device<br>
B 60b decrypts the encrypted session key TDESX(SK) using the random number Y and<br>
stores the session key SK in memory.<br>
Thus, the session key SK is transmitted to each device over a respective SAC. The<br>
session key SK can then be used by, for example, device A 60a to encrypt data<br>
transmitted to device B 60b via communication link 75.<br>
With reference to Figure 9, at step 400, device 60a encrypts data D using the session<br>
key SK. The encryption algorithm used in a symmetric algorithm, such as Triple DES<br>
(TDES) algorithm or such like.<br>
The encrypted data TDESSK(D) is transmitted to device 60b via communication link<br>
75 at step 402. At step 404, device B 60b decrypts the encrypted data TDESSK(D)<br>
using the session key SK to obtain the data D.<br>
As discussed above, there is no generation of session keys by any of the devices;<br>
session keys are generated only by the security module. Therefore, the above method<br>
provides a very simple but yet secure method of providing secure communication<br>
between devices, as the data transmitted by one device can only be decrypted by a<br>
device which has established a secure authenticated channel with the same security<br>
module as that one device.<br>
As discussed with reference to Figure 7, in addition to carrying out validation of<br>
devices and the creation of SACs, the security module may transmit control words,<br>
access rights and/or scrambled data to a device. Figures 10 and 11 illustrate examples<br><br>
in which a security module sets up a secure communication link between two devices<br>
and subsequently transmits data associated with scrambled data to a device.<br>
Figure 10 shows, in a first example, the steps associated with the setting up of a<br>
secure communication link between a DVD player and a digital television and the<br>
subsequent operations carried out to descramble data received from the DVD player<br>
by the digital television.<br>
In step 500, the security module 64 determines the validity of each of the DVD player<br>
12 and the digital TV 14, using steps as described above with reference to Figure 5.<br>
If the two devices are determined to be valid, the security module 64 establishes<br>
secure authenticated channels (SACs) with the DVD player 12 and the digital TV,<br>
using the steps as described above with reference to Figure 6. As a result of<br>
establishing the SACs, a session key SK is stored in each of the devices and in the<br>
security module.<br>
In step 502, data comprising Control System Scrambled (CSS) data and proprietary<br>
encrypted ECMs containing control words for descrambling the data are encrypted by<br>
the DVD player 12 using the session key SK and transmitted to the digital TV via the<br>
communication link 16.<br>
The encrypted data is received by the digital TV 14 in step 504 and decrypted using<br>
the session key SK. The scrambled data is passed to a demultiplexer 90 which, in step<br>
506, separates the CSS data from the encrypted ECMs. The encrypted ECMs are<br>
passed over the SAC by the digital TV 14 to the security module 64 in step 508. For<br>
transfer to the security module 64 over the SAC, the encrypted ECMs are further<br>
encrypted by the digital TV 14 using the session key SK generated by the security<br>
module 64.<br>
As shown in Figure 10, the security module is notionally divided into a standardized<br>
security part 66 and a proprietary security part 68. The twice-encrypted ECMs are<br>
received at the standardized security part 66 in step 510 and decrypted once using the<br><br>
session key SK. In step 512, the proprietary encrypted ECMs are passed to the<br>
proprietary security part 68 which, in step 514, decrypts and validates the encrypted<br>
ECMs using an equivalent key to the proprietor's key used to encrypt the ECMs, and<br>
processes the ECM, if authorised, to extract the control words, or CSS keys, from the<br>
ECM.<br>
In step 516, the CSS keys are passed to the standardized security part 66 which<br>
encrypts the CSS keys using the session key SK and passes the encrypted CSS keys<br>
to the digital TV 14 over the SAC. The received encrypted CSS keys are decrypted<br>
by the digital TV 14 using the session key at step 518 and subsequently passed to a<br>
descrambler 92 for use in descrambling the CSS data. At 520, the descrambled data<br>
is transmitted to display 94 for display.<br>
As will be readily understood from the above, control words are always encrypted<br>
using the session key SK before being transmitted between any of the devices and the<br>
security module.<br>
In the above example, the control words are contained in ECMs. However, the ECMs<br>
may be contained in XECMs together with XCMI, or access rights, which are<br>
processed by the proprietary security part 68, for example, to determine whether the<br>
user's rights to view the data have expired.<br>
Figure 11 shows, in the second example, the steps associated with the setting up of a<br>
secure communication link between a DVD player and a digital recorder and the<br>
subsequent operations carried out to descramble data received from the DVD player<br>
by the digital recorder.<br>
In step 600, the security module 64 determines the validity of each of the DVD player<br>
12 and the digital recorder 18, using steps as described above with reference to Figure<br>
5. If the two devices are determined to be valid, the security module 64 establishes<br>
secure authenticated channels (SACs) with the DVD player 12 and the digital recorder<br>
18, using the steps as described above with reference to Figure 6. As a result of<br><br>
establishing the SACs, a session key SK is stored in each of the devices and in the<br>
security module.<br>
In step 602, data comprising Contro System Scrambled (CSS) data and proprietary<br>
encrypted XECMs containing control words for descrambling the data and XCMI are<br>
encrypted by the DVD player 12 using the session key SK and transmitted to the<br>
recorder via the communication link 20.<br>
The encrypted data is received by the recorder 18 in step 604 and decrypted using the<br>
session key SK. The scrambled data is passed to a demultiplexer 90 which, in step<br>
606, separates the CSS data from the encrypted XECMs. The encrypted XECMs are<br>
passed over the SAC by the recorder 18 to the security module 64 in step 608. For<br>
transfer to the security module 64 over the SAC , the encrypted XECMs are further<br>
encrypted by the recorder 18 using the session key SK generated by the security<br>
module 64.<br>
As shown in Figure 11, the security module is notionally divided into a standardized<br>
security part 66 and a proprietary security part 68. The twice-encrypted XECMs are<br>
received at the standardized security part 66 in step 610 and decrypted once using the<br>
session key SK. In step 512, the proprietary encrypted XECMs are passed to the<br>
proprietary security part 68 which, in step 614, decrypts and validates the encrypted<br>
XECMs using an equivalent key to the proprietor's key used to encrypt the XECMs,<br>
and processes the XECMs, if authorised, to update the XCMI, for example, to limit<br>
the number of times which the user may replay the data, to prohibit any farther re-<br>
recording of the data etc.<br>
In step 616, the modified XECMs are encrypted using a proprietary algorithm PA and<br>
a user key 96 stored in the security module 68. This adds security to the data<br>
recorded by the recorder 18; the control words for descrambling the CSS data can only<br>
be extracted from the modified XECM if the user has access to the user key. Thus,<br>
playback and viewing of the recorded data is restricted to the holder of the security<br>
module.<br><br>
In step 618, the encrypted XECMs are passed to the standardized security part 66<br>
which further encrypts the encrypted XECMs using the session key SK and passes the<br>
encrypted XECMs to the recorder over the SAC. The received encrypted XECMs are<br>
decrypted once by the recorder using the session key at step 620 and subsequently<br>
passed to a recording medium 98, such as DAT tape, for storing the CSS data and the<br>
encrypted XECMs.<br>
It will be understood that the present invention has been described above purely by<br>
way of example, and modifications of detail can be made within the scope of the<br>
invention.<br>
For example, whilst the above examples have described the provision of a<br>
communication link between devices using an IEEE 1394 digital interface,<br>
unidirectional links such as 8-VSB and 16-VSB may also be used.<br>
It is not essential for a device to pass certificates directly to a security module. For<br>
example, where a first device is unable to receive data from a security module, the<br>
first device may pass its certificates to a second device in two-way communication<br>
with the security module for validation of the first device.<br>
In the described examples, only one security module is provided. However, different<br>
security modules may coexist within a network comprised of a number of devices<br>
connected via various interfaces.<br>
Each feature disclosed in the description, and (where appropriate) the claims and<br>
drawings may be provided independently or in any appropriate combination.<br><br>
WE CLAIM :<br>
1.	A method of providing secure communication of digital data between devices,<br>
said, method comprising the steps of communicating from one device among other<br>
devices, an identifier of said one device to an independent security module and<br>
performing device validation depending on the identity of the communicated identifier.<br><br>
2.	A method as claimed in claim 1, wherein the security module performs device<br>
validation by comparing the communicated identifier with at least one stored identifier.<br>
3.	A method as claimed in claim 2, wherein each stored identifier is associated<br>
with a respective one of a valid device or an invalid device.<br><br>
4.	A method as claimed in claim 3, wherein the communicated identifier is<br>
compared with stored identifiers associated with invalid devices.<br>
5.	A method as claimed in claim 3 or 4, wherein the communicated identifier is<br>
compared with stored identifiers associated with valid devices.<br>
6.	A method of providing secure communication of digital data between devices,<br>
said method comprising the steps of comparing in an independent security module an<br>
identifier communicated from one device with at least one stored identifier, each<br>
stored identifier being associated with a respective valid device, and validating the<br>
device if the communicated identifier is identical to the or one of the stored identifiers.<br>
7.	A method as claimed in claim 6, wherein said at least one stored identifier is<br>
stored in an independent security module.<br>
8.	A method as claimed in claim 5 or 7, wherein the communicated identifier is<br>
compared with stored identifiers associated with valid devices according to the setting<br>
of a flag.<br>
9.	A method as claimed in any one of claims 1 to 6 and 8, wherein certificates are<br>
passed between the device and the security module to validate the device.<br><br>
10.	A method as claimed in claim 9, wherein the identifier of the device is<br>
communicated to the security module in an encrypted certificate.<br>
11.	A method as claimed in claim 10, wherein the certificate is signed to enable the<br>
authenticity of the communicated certificate to be verified.<br>
12.	A method as claimed in claim 10 or 11, wherein the certificate is encrypted<br>
using a private key.<br>
13.	A method as claimed in claim 12, wherein an equivalent key to the private key<br>
is communicated to the security module in a certificate encrypted by a system private<br>
key, a system public key being stored in both the security module and the device.<br>
14.	A method as claimed in claim 13, wherein the encrypted certificate is<br>
encrypted by the device using a security module public key and communicated to the<br>
security module.<br>
15.	A method as claimed in claim 14, wherein the encrypted certificate is decrypted<br>
by the security module first using a security module private key and secondly using<br>
said equivalent key to enable the identifier of the device to be extracted from the<br>
decrypted certificate.<br>
16.	A method as claimed in claim 15, wherein the certificate containing the device<br>
identifier is randomised by the device prior to encryption, the randomisation being<br>
reversed by the security module following decryption of the certificate.<br>
17.	A method as claimed in claim 12 or 13, wherein a random number (X) is<br>
generated by the device, the random number (X) and the encrypted certificate<br>
containing the identifier of the device being encrypted by the device using a security<br>
module public key and communicated to the security module.<br><br>
18.	A method as claimed in claim 17, wherein the encrypted random number (X)<br>
and encrypted certificate are decrypted by the security module first using a security<br>
module private key to obtain the random number (X), and secondly using said public<br>
key to enable the identifier to the device to be extracted by the security module.<br>
19.	A method as claimed in claim 18, wherein the extracted random number (X) is<br>
stored to the security module such that data communicated between the security<br>
noddel to the device may thereafter be encrypted and decrypted by the random<br>
number in the security module and the device.<br>
20.	A method of providing secure communication of digital data between a device<br>
and a security module, said method comprising the steps of transferring to the security<br>
module a random number and an identifier of the device encrypted by a public key of<br>
the security module, the security module decrypting the random number and device<br>
identifier using a private key of the security module, validating the device using the<br>
device identifier and, upon validation of the device, using the random number to<br>
encrypt and decrypt data communicated between the security module and the device.<br>
21.	A method as claimed in claim 20, wherein the identifier of the device is<br>
contained in a certificate generated by the device, the certificate being encrypted using<br>
the public key of the security module.<br>
22.	A method as claimed in claim 20 or 21, wherein the random number is<br>
randomised by the device prior to encryption, the randomisation being reversed by<br>
the security module following decryption of the random number.<br>
23.	A method as claimed in any one of claims 17 to 19 or 21, wherein the random<br>
number and the certificate containing the identifier of the device are randomised by<br>
the device prior to encryption, the randomisation being reversed by the security<br>
module following decryption of the random number and certificate.<br><br>
24.	A method as claimed in any one of claims 19 to 23, wherein the security<br>
module communicates to the device a random key (SK) generated in the security<br>
module and encrypted using the random number (X), the device decrypting said key<br>
(SK) using the random number (X) and thereafter using said key (SK) to encrypt data<br>
sent to the security module.<br>
25.	A method as claimed in claim 24, wherein the device communicates to the<br>
security module an encrypted Entitlement Control Message (ECM) containing a control<br>
word for descrambling data, the device encrypting the encrypted ECM using said key<br>
(SK).<br>
26.	A method as claimed in claim 25, wherein the security module decrypts the<br>
encrypted ECM, extracts the control word from the ECM and communicates to the<br>
device the control word encrypted using said key (SK).<br>
27.	A method as claimed in claim 24, wherein the device communicates to the<br>
security module an encrypted Extended Entitlement Control Message (XECM)<br>
containing access rights to data, the device encrypting the encrypted XECM using said<br>
key (SK).<br>
25 A method as claimed in claim 27, wherein the security module decrypts the<br>
encrypted XECM, modifies the access rights contained in the XECM, encrypts the<br>
modified XECM and communicates to the device the encrypted modified XECM<br>
encrypted using said key (SK).<br>
29. A method as claimed in any one of claims 19 to 28, wherein data is<br>
communicated between first and second devices, and upon validation of each device<br>
by the security module, the security module communicates to the first device a random<br>
key (SK) generated in the security module and encrypted using the random number<br>
(X) generated by the first device, the first device decrypting said key (SK) using the<br>
random number (X) generated by the first device, and communicates to the second<br>
device said key (SK) encrypted using the random number (Y) generated by the second<br><br>
device, the second device decrypting said key (SK) using the random number (Y)<br>
generated by the second device, said key (SK) thereafter being used to encrypt data<br>
communicated between the security module and the devices and data communicated<br>
between the devices.<br>
30.	A method as claimed in any one of claims 1 to 29. Said method comprising the<br>
step of generating a random key (SK) in the security module and encrypting data<br>
communicated between the devices using the random key.<br>
31.	A method as claimed in claim 30, wherein the security module communicates<br>
to each device the random key (SK) encrypted using a random number (X) generated<br>
by that device, the device decrypting the random key (SK) using the random number<br>
(X).<br>
32.	A method as claimed in claim 31, wherein each device communicates to the<br>
security module the respective random number (X) encrypted using a public key<br>
(SM_Kpub) of the security module.<br>
33.	A method as claimed in claim 32, wherein the encrypted random number (X) is<br>
decrypted by the security module using a private key (SM_Kpriv) of the security<br>
module to obtain the random number (X).<br><br>
34.	A method as claimed in claim 33, wherein each random number (X) is<br>
randomised by the respective device prior to encryption, the randomisation being<br>
reversed by the security module following decryption of the random number (X).<br>
35.	A method as claimed in any one of claims 30 to 34, wherein the security<br>
module validates each device before communicating said key (SK) to each device.<br>
36.	A method as claimed in claim 35, each device communicates an identifier -<br>
thereof to the security module for validation of the device by the security module.<br><br>
37.	A method as claimed in any one of claims 28 to 36, wherein said key (SK) is<br>
periodically changed by the security module.<br>
38.	A method as claimed in any one of claims 29 to 37 as applied to a home<br>
network system, the devices corresponding to first and second consumer electronic<br>
devices adapted to transfer data therebetween via a communication link.<br>
39. Apparatus for providing secure communication of digital data between devices,<br>
said apparatus comprising a security module comprising means for receiving an<br>
identifier of a device and means for performing device validation depending on the<br>
identity of the received identifier.<br>
40. A security module for providing secure communication of digital data between<br>
devices and arranged to receive an identifier of a device and to perform device<br>
validation depending on the identity of the received identifier.<br>
41.	Apparatus for providing secure communication of digital data between devices,<br>
said apparatus comprising a security module comprising means for storing at least<br>
one identifier, each stored identifier being associated with a respective valid device,<br>
means for comparing an identifier of a device with said at least one stored identifier,<br>
and means for validating the device if the identifier of the device is identical to the or<br>
one of the stored identifiers.<br>
42.	A security module for providing secure communication of digital data between<br>
devices and arranged to store at least one identifier, each stored identifier being<br>
associated with a respective valid device, to compare an identifier of a device with said<br>
at least one stored identifier, and to validate the device if the identifier of the device is<br>
identical to the or one of the stored identifiers.<br>
43. A system for providing secure communication of data between a device and a<br>
security module, said device comprising means for communicating to the security<br>
module a random number and an identifier of the device encrypted by a public key of<br><br>
A method of providing secure communication of digital data between devices,<br>
said method comprising the steps of communicating from one device among other<br>
devices, an identifier of said one device to an independent security module and<br>
performing device validation depending on the identity of the communicated identifier.</td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTAxOC1ncmFudGVkLWFic3RyYWN0LnBkZg==" target="_blank" style="word-wrap:break-word;">in-pct-2001-1018-granted-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTAxOC1ncmFudGVkLWNsYWltcy5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2001-1018-granted-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTAxOC1ncmFudGVkLWNvcnJlc3BvbmRlbmNlLnBkZg==" target="_blank" style="word-wrap:break-word;">in-pct-2001-1018-granted-correspondence.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTAxOC1ncmFudGVkLWRlc2NyaXB0aW9uIChjb21wbGV0ZSkucGRm" target="_blank" style="word-wrap:break-word;">in-pct-2001-1018-granted-description (complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTAxOC1ncmFudGVkLWRyYXdpbmdzLnBkZg==" target="_blank" style="word-wrap:break-word;">in-pct-2001-1018-granted-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTAxOC1ncmFudGVkLWV4YW1pbmF0aW9uIHJlcG9ydC5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2001-1018-granted-examination report.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTAxOC1ncmFudGVkLWZvcm0gMS5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2001-1018-granted-form 1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTAxOC1ncmFudGVkLWZvcm0gMTMucGRm" target="_blank" style="word-wrap:break-word;">in-pct-2001-1018-granted-form 13.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTAxOC1ncmFudGVkLWZvcm0gMTgucGRm" target="_blank" style="word-wrap:break-word;">in-pct-2001-1018-granted-form 18.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTAxOC1ncmFudGVkLWZvcm0gMy5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2001-1018-granted-form 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTAxOC1ncmFudGVkLWZvcm0gNS5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2001-1018-granted-form 5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTAxOC1ncmFudGVkLWdwYS5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2001-1018-granted-gpa.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTAxOC1ncmFudGVkLXJlcGx5IHRvIGV4YW1pbmF0aW9uIHJlcG9ydC5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2001-1018-granted-reply to examination report.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTAxOC1ncmFudGVkLXNwZWNpZmljYXRpb24ucGRm" target="_blank" style="word-wrap:break-word;">in-pct-2001-1018-granted-specification.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=SU4tUENULTIwMDEtMTAxOC1LT0wtKDIzLTA5LTIwMTEpLUFTU0lHTk1FTlQucGRm" target="_blank" style="word-wrap:break-word;">IN-PCT-2001-1018-KOL-(23-09-2011)-ASSIGNMENT.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=SU4tUENULTIwMDEtMTAxOC1LT0wtKDIzLTA5LTIwMTEpLUNFUlRJRklFRCBDT1BJRVMoT1RIRVIgQ09VTlRSSUVTKS5wZGY=" target="_blank" style="word-wrap:break-word;">IN-PCT-2001-1018-KOL-(23-09-2011)-CERTIFIED COPIES(OTHER COUNTRIES).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=SU4tUENULTIwMDEtMTAxOC1LT0wtKDIzLTA5LTIwMTEpLUNPUlJFU1BPTkRFTkNFLnBkZg==" target="_blank" style="word-wrap:break-word;">IN-PCT-2001-1018-KOL-(23-09-2011)-CORRESPONDENCE.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=SU4tUENULTIwMDEtMTAxOC1LT0wtKDIzLTA5LTIwMTEpLUZPUk0gMTYucGRm" target="_blank" style="word-wrap:break-word;">IN-PCT-2001-1018-KOL-(23-09-2011)-FORM 16.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=SU4tUENULTIwMDEtMTAxOC1LT0wtKDIzLTA5LTIwMTEpLVBBLnBkZg==" target="_blank" style="word-wrap:break-word;">IN-PCT-2001-1018-KOL-(23-09-2011)-PA.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=SU4tUENULTIwMDEtMTAxOC1LT0wtRk9STS0yNy5wZGY=" target="_blank" style="word-wrap:break-word;">IN-PCT-2001-1018-KOL-FORM-27.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="233655-an-enhanced-controller-to-control-and-monitor-the-operation-of-electrostatic-precipitator.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="233657-reinforcement-member-for-a-bushing-tip-plate-and-method-of-reinforcing-the-plate.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>233656</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>IN/PCT/2001/1018/KOL</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>14/2009</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>03-Apr-2009</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>01-Apr-2009</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>01-Oct-2001</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>CANAL + SOCIETE ANONYME</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>85/89, QUAI ANDRE CITROEN F-75711 PARIS, CEDEX 15</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>MAILLARD MICHEL</td>
											<td>13, AVENUE DU PARC F-78120 RAMBOUILLET</td>
										</tr>
										<tr>
											<td>2</td>
											<td>DAUVOIS JEAN-LUC</td>
											<td>19, RUE EUGENE MANUEL, F-75116, PARIS</td>
										</tr>
										<tr>
											<td>3</td>
											<td>DUBLANCHET FREDERIC</td>
											<td>CANAL + TECHNOLOGIES SOCIETE ANNOYME, 94, PLACE RAOUL DAUTRY, 75906 PARIS, CEDEX 15</td>
										</tr>
										<tr>
											<td>4</td>
											<td>LEPORINI DAVID</td>
											<td>CANAL + TECHNOLOGIES SOCIETE ANNOYME, 94, PLACE RAOUL DAUTRY, 75906 PARIS, CEDEX 15</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04N 005/913</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/IB2000/00432</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2000-03-31</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>99400901.7</td>
									<td>1999-04-13</td>
								    <td>EUROPEAN UNION</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/233656-a-method-of-providing-secure-communication-of-digital-data-between-devices-and-apparatus-therefor by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 13:49:37 GMT -->
</html>
