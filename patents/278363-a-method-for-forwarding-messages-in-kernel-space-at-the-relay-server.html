<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/278363-a-method-for-forwarding-messages-in-kernel-space-at-the-relay-server by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 04 Apr 2024 22:51:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 278363:A METHOD FOR FORWARDING MESSAGES IN KERNEL SPACE AT THE RELAY SERVER</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">A METHOD FOR FORWARDING MESSAGES IN KERNEL SPACE AT THE RELAY SERVER</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>The present invention discloses a relay method, a relay server and a kernel managing module. The relay method comprises: receiving by a relay server a message sent from a source end via a first data channel: judging by the relay server whether a mapping relation between the first and a second data channel has been established in the kernel space, wherein the second data channel is between the relay server and a target end; forwarding by the relay server the message in the kernel space via the second data channel if the mapping relation between the first and second data channel has been established. By adopting the present invention, it is applicable to forward messages in the kernel space, avoid copying messages from the kernel space to the user space in prior art, and execute such operation as switch between the user state and the kernel state, thereby increasing the relaying efficiency of the Relay server.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>Relay Method, Relay server and Kernel Managing Module<br>
Field of the Invention<br>
The present invention relates to Internet technology field, especially to a relay method, a relay server and a kernel managing module.<br>
Background of the Invention<br>
With the rapid development of Internet application, the problem of shortage of public Internet addresses based on Internet Protocol version 4 (IPV4) is becoming very protruding, and thus the Network Address Translators (NAT) technology comes into being, which makes multiple computers in a local area network access the Internet by sharing the same public IP (Internet Protocol) address. But an accompanying problem is that, NAT hides the information of real nodes in the local area network, which makes it unable to communicate between the real nodes inside the local area network and nodes outside the local area network and then heavily limits such network applications as Instant Messaging (IM), Point-to-Point (P2P) and interactive stream media.<br>
In order to solve the problem. Traversal Using Relay NAT (TURN) emerges as the times require. TURN technique make the nodes hided behind NAT communicate with a relay server that has a public IP, and then the relay server forwards the network data, thus NAT is successfully traversed.<br>
At present, TURN technique based on application layer forwarding is already pretty mature. Figure 1 is a flowchart illustrating the implementation of relay in prior art. In the example illustrated in figure 1, Transmission Control Protocol (TCP) is used, and node x (End Point x) having been proces.sed by NAT, which is shortened as EPx, is set as the source end, and application service y is set as the target end whose structure is shown in figure 2. As shown in figure 1, the procedure of relay in prior art comprises the following steps:<br>
At step 101, establish data channel x.<br>
The data channel x is the data channel corresponding to the TCP connection between the EPx and the relay server. In addition, while the data channel x is being<br>
 <br>
eslablished, relay server may perform necessary access authenlication upon EPx.<br>
When EPx needs to relay dala to the application service y, step 102 will be executed.<br>
Al step 102, EPx direclly send a message to (he relay seiver via the dala channel x.<br>
Al step 103, the relay server, after receiving (he message, analyzes the header of the message.<br>
The relay server analyzes the header of this message, and can got tlie IP address of the application service y and the information of the port through which the application service y receives this message.<br>
Al step 104, according to the IP address of the application service y and the information of the port through which the application service y receives this message, the relay server establishes the data channel y corresponding to the TCP connection between the relay server and the application service y.<br>
Further, the mapping relation between the data channel y and the data channel x needs to be established the after data channel y is established, and then step 105 is executed.<br>
At step 105, the relay server forwards the message via the data channel y.<br>
In addition, when the application service y needs to respond to the message, the application service y sends a response message via the data channel y. After the relay server receives the response message at application layer, according to the mapping relation between the data channel y and the data channel x, it directly forwards the response message via the data channel x.<br>
In addition, when EPx wants to terminate relaying messages, EPx will shut down data channel x directly, so the current data relay is ended.<br>
It can be seen from the above that, in prior art, the information interaction between EPx and application service y is implemented by the relay server through forwarding messages at application layer. However, as shown in figure 2, in prior art, while the relay server forwards the messages at application layer, it is unavoidable to copy the messages from the kernel space to the user space, and to perform the switch between the user state and the kernel state. In this way, computing resources will be greatly wasted, which decreases the relaying efficiency of the relay server.<br>
 <br>
Summary of the Invention<br>
The present invention discloses a relay method, a relay server and a kernel managing module to increase the relaying efficiency of the relay server.<br>
A relay method provided by an embodiment of the present invention comprises:<br>
receiving, by a relay server, a message sent from a source end via a first data channel;<br>
judging, by the relay server, whether a mapping relation between the first data channel and a second data channel has been established in the kernel space, wherein the second data channel is between the relay server and a target end;<br>
forwarding, by the relay server, the message in the kernel space via (he second data channel if the mapping relation between the first data channel and the second data channel has been established.<br>
Wherein the method further comprises:<br>
establishing, in the kernel space, the mapping relationship between the first data channel and the .second data channel in the kernel space if Judging that there is no mapping relationship between the first data channel and the second data channel.<br>
Wherein the relay server, through the kernel control primitive, instructs the kernel of the relay server to establish the mapping relationship between the first data channel and the second data channel.<br>
Wherein the forwarding the message in the kernel space via the second data channel comprises:<br>
taking IP address information of the relay server as source address information of the message in the kernel space;<br>
taking IP address information of the target end as target address information of the message in the kernel space;<br>
forwarding the message whose source and target address information are modified to the target end via the second data channel in the kernel space.<br>
Wherein the method further comprises:<br>
receiving, by the relay server, a response message sent from the target end via the<br>
 <br>
second data channel;<br>
judging, by the relay server, whether the mapping relation between the first data channel and the second data channel has been established in the kernel space;<br>
forwarding, by the relay server, the response message in the kernel space via the first data channel if the mapping relation between the first data channel and the second data channel has been established. .<br>
Wherein the forwarding the response message in the kernel space via the first data channel comprises:<br>
taking IP address information of the relay server as source address information of the response message in the kernel space;<br>
taking IP address information of the source end as target address information of the response message in the kernel space;<br>
forwarding the response message whose source and target address information are modified to the source end via the first data channel in the kernel space.<br>
Wherein the method further comprises when the source end needs to terminate forwarding messages:<br>
sending, by the source end, a session terminate request to the relay server;<br>
removing, by the relay server, the mapping relation between the first data channel and the second data channel in the kernel space upon receiving the session terminate request;<br>
closing, by the relay server, the first data channel and Ihc second data channel respectively.<br>
A relay server provided by an embodiment of the present invention comprises an application managing module and a kernel managing module; wherein:<br>
the application managing module is adapted to manage a first data channel between a source end and the relay server and a second data channel between the relay server and a target end, and to trigger the kernel managing module to establish a mapping relation between the first data channel and the second data channel;<br>
the kernel managing module is adapted to establish the mapping relation between the first data channel and the second data channel in the kernel space when triggered by the application managing module, and to judge whether the mapping relation between the<br>
 <br>
first data channel and the second data channel has been established when receiving a message, and if so, forward the message in the kernel space.<br>
Wherein the server further comprises:<br>
a request receiving module, adapted to receive a session terminate request sent by the source end which needs to terminate forwarding messages and send a termination notification to the kernel managing module;<br>
wherein the kernel managing module removes the mapping relation between the first data channel and the second data channel in the kernel space after receiving the termination notification and close the first data channel and second data channel respectively.<br>
A kernel managing module provided by an embodiment of the present invention comprises:<br>
a mapping establishing unit, adapted to establish a mapping relation between a first data channel and a second data channel in the kernel space, wherein the first data channel is the data channel between a source end and a relay server, and the second data channel is the data channel between the relay server and a target end;<br>
a judging unit, adapted to judge whether the mapping establishing unit has established the mapping relation between the first data channel and the second data channel in the kernel space upon receiving the message, and if so, send a forward notification;<br>
a sending unit, adapted to forward the message in the kernel space upon receiving the forward notification.<br>
Wherein the sending unit comprises:<br>
a modifying subunit, adapted to take IP address information of the relay server as source address information of the message in the kernel space and take IP address information of the target end as target address information of the message in the kernel space;<br>
a sending subunit, adapted to forward the message whose source and target address information are modified to the target end in the kernel space via the second data channel.<br>
Wherein the module further comprises:<br>
 <br>
a removing unit, adapted to remove the mapping relation helwcen (he first data channel and the second data channel in the kernel space when the source end wants to lerminale forwarding iriessages and close the first dala channel and the second data channel respectively.<br>
It can be seen from the above embodiments (hat, after the kernel managing module receives a message, if it is confirmed thai the mapping relation between the first data channel and the second data channel has been established, (he kernel managing module directly forward the message in the kernel space, so as lo avoid such operation as copying messages from the kernel space to the user space in prior art, as well as lo execute the switch operation between the user state and the kernel slate, so as to save a large amount of computing resources, and thus increase the relaying efficiency of the relay server.<br>
Brief description of the drawings<br>
Figure I is a flowchart illustrating the procedure for implementing relay in prior art.<br>
Figure 2 is a diagram illustrating the structure of implementing relay in prior art.<br>
Figure 3 is a flowchart illustrating the relay method in an embodiment of the present invention.<br>
Figure 4 is a diagram illustrating the structure of the relay server in an embodiment of the present invention.<br>
Figure 5 is a diagram illustrating the structure of the kernel managing module in an embodiment of the present invention.<br>
Detailed description of the invention<br>
In consideration of the prior art that the relay server forwarding messages at application layer will lead to the switch between the user state and the kernel state and then it is unavoidable to copy messages from the kernel space to the user space, an embodiment of the present invention provides a relay method that can solve various problems in prior art. The specific implementation comprises: while receiving the message, a kernel managing module in a relay server judges whether the mapping relation between a first data channel and a second data channel has been established, and if so, forwards the message in the kernel space. In this way, direct message forwarding in<br>
 <br>
kernel space is implemented, and thus the relaying efficiency of the relay server is increased.<br>
The first data channel is the data channel between the source end and the relay server: the second data channel is the data channel between the relay server and the target end.<br>
In addition, the kernel managing module forwards the message in the kernel space, so that it is guaranteed that relay server only controls and manages the data channels on the application layer, without the need to perform such actions on the application layer in prior art as copying the message from the kernel space to the user space as well as switching between the user state and the kernel state, so as to effectively release resources oi' the relay server on the application layer, and direct message forwarding in the kernel space is implemented, and thus increase the relaying efficiency of the relay server.<br>
The present invention will be further described in detail hereinafter with reference to the drawings and embodiments.<br>
Figure 3 is a flowchart illustrating the relay method in an embodiment of the present invention. In this embodiment, assuming that the source end and relay server are connected via a TCP connection while the target end and relay server are connected via a TCP connection, as shown in figure 3, when the kernel managing module receives the message, the procedure may comprise the following steps:<br>
At step 301, the kernel managing module Judges whether the mapping relation between the first data channel and the second data channel is already established, and if yes, step 302 will be executed; otherwise, step 303 will be executed.<br>
In this embodiment, before step 301 is executed, the following steps are usually comprised:<br>
At Al, establish the data channel corresponding to the TCP connection between the source end and the relay server.<br>
Here, the data channel conesponding to the TCP connection between the source end and the relay server is the first data channel. In addition, in this embodiment, while establishing the first data channel, the relay server may perform necessary access authentication upon the source end, and the specific access authentication method is similar to that of the prior art, and is not to be illustrated hereby.<br>
 <br>
At A2, establish the data channel corresponding to the TCP connection between the relay server and the target end.<br>
Here, the data channel conesponding to the TCP connection between the relay server and the target end is the second data channel.<br>
In addition, the mapping relation between the first data channel and the second data channel is established by the kernel managing module upon the trigger of the kernel control primitive sent by the relay server through the application layer. Preferably, while establishing the mapping relation between the first data channel and the second data channel, the kernel managing module maintains the information of IP addresses corresponding to the source end and target end respectively.<br>
In this embodiment, the source end may be a node having been processed by NAT, and accordingly, the target end is the application service end. Therefore, in practical application, before executing Al, the step of establishing a first signaling channel corresponding to the TCP connection between the source end and relay server may be established. In addition, while establishing the first signaling channel, the relay server in this embodiment can perform necessary access authentication upon the source end, and the specific access authentication method is similar to that in the prior art, and thus is not illustrated hereby. Then AI is executed. Preferably, after the first data channel is established, the first channel identifier X con'esponding to the first data channel, the IP address information oi' the target end to which the message is to be forwarded as well as the port through which the target end will receive the message are all sent to the relay server through the first signaling channel; and the relay server can establish the mapping relation between the first data channel and the second data channel according to the first channel identifier X, so that the first data channel can transfer the message according to the control signaling sent by the first signaling channel.<br>
In this way, in the step A2, the second data channel corresponding to the TCP connection between the relay server and the target end may be established according to the IP address information of the target end as well as Ihe port through which the target end receives the message.<br>
Besides, in this embodiment, both the source end and target end may be nodes having been processed by NAT. In such a case, before the first data channel is established<br>
 <br>
in step Al, the following steps are usually comprised;<br>
At step All, establish the first signaling channel corresponding to the TCP connection between the source end and the relay server.<br>
Here, before the first signaling channel is established, Ihe relay server in this embodiment can perform necessary access authentication upon the source end, and the specific access authentication method is similar in the prior art, thus is not to be illustrated hereby.<br>
At step A12, e,stablish the second signaling channel corresponding to the TCP connection between the relay server and the target end.<br>
Here, when the second signaling channel is established, the relay server in this embodiment can perform necessary access authentication upon the source end, and the specific access authentication method is similar to that in the prior art, thus is not to be illustrated hereby.<br>
After that, the step Al is executed and, after the first data channel is established, the first channel identifier X and the identity information of the target end are sent to the relay server through the first signaling channel, the relay server establishes the mapping relation between the first signaling channel and itself according to the first channel identifier X, finds out the second signaling channel corresponding to the target end according to the identity information of the target end, and notifies the target end of a communication request through the second signaling channel. In this way, in the above step A2, after the target end has received the communication request, the second data channel corresponding to the TCP connection between the target end and the relay server is established.<br>
In addition, in order to make the present invention applicable, after the step A2 in embodiment of the present invention, the second channel identifier Y corresponding to the second data channel is also fed back to the source end. After that, for the convenience of establishing the mapping relation between the second data channel and the second signaling channel, the target end further needs to send the .second channel identifier Y coiTesponding to the second data channel to the relay server, and according to the second channel identifier Y, the relay server establishes the mapping relation between the second data channel and the .second signaling channel so that the sub.scquent operations can be<br>
10<br>
 <br>
executed.<br>
Al step 302, the kernel managing module forwards Ihc message in the kernel space.<br>
In (his embodiment, when the message is sent by (lie source end through (he first data channel, the step 302 may comprise:<br>
Al step B 1, the kernel managing module lakes Ihc IP address information of the relay server as the source address information of the message.<br>
Since the message is .sent by ihe source end through the first data channel, the source address information of the message was obviously (he IP address information of the source end. after the step Bl is executed in this embodiment, Ihe target end can make sure the message is from the relay .server. Since the message is sent by the source end through the first data channel and needs lo be forwarded by the relay server, the target address information of the message was the IP address information of the relay server before the step B2 is executed.<br>
At step B2, the kernel managing module takes the IP address information of the target end as the target IP address information of the message.<br>
Here, the kernel managing module, according to the IP address information maintained by itself, directly takes the IP address information of the target end as the target IP address information of the message.<br>
At step B3, the kernel managing module forwards the modified message to the target end through the second data channel in the kernel space.<br>
It can be seen that, through the above-mentioned method, it is implemented to forward messages in kernel space, without the operation of copying the message in the u.ser space and the kernel space in prior art, thereby avoiding the switch between the user state and the kernel state, .saving computing resources and increasing the relaying efficiency of the relay server.<br>
At step 303, forward the message by the relay server.<br>
In addition, in this embodiment, when the target end responds to the message forwarded by the relay server, or when the target end sends the message to be forwarded, it is applicable to forward the message in the kernel space by a means similar to the forwarding operation mentioned above, which is not be illustrated hereby.<br>
 <br>
Moreover, in this embodiment, when the source end needs to terminate relaying messages, the step 304 will be executed.<br>
At step 304, the source end sends a session terminate request to the relay server through the first signaling channel.<br>
At step 305, after receiving the session terminate request, the relay server instructs the kernel managing module to remove the mapping relation between the first data channel and the second data channel; and closes the said first data channel and second data channel respectively.<br>
Specifically, after receiving the session terminate request, the relay server instructs the kernel managing module through the kernel control primitive to lemove the mapping relation between the first data channel and the second data channel. So far, the action of the source end terminating relaying message is finished.<br>
In an embodiment of the present invention provides a kind of relay server corresponding to the relay method mentioned above. Figure 4 is a diagram illustrating the structure of the relay server in an embodiment of the present invention. This diagram is merely an example, which should not unduly limit the scope of the claims. One of ordinary skill in the art would recognize many variations, alternatives, and modifications. As shown in figure 4, the relay .server comprises: the application managing module 401 and the kernel managing module 402.<br>
Here, the application managing module 401 is u.sed to manage the first data channel between the source end and the relay server as well as the second data channel between the relay server and the target end, and to trigger the kernel managing module 402 to establish the mapping relation between the first data channel and the second data channel.<br>
The kernel managing module 402 is used to establish the mapping relation between the first data channel and the second data channel upon the trigger of the application managing module 401, and to judge if the mapping relation between the first data channel and the second data channel is already established when receiving the message, and if so, forward the message in the kernel space.<br>
In addition, the relay .server may comprises: the request receiving module 403.<br>
Here, the request receiving module 403 is used to, when the source end needs to<br>
12<br>
 <br>
terminate forwarding messages, receive the session terminate request sent by the source end, and send a termination notification to the kernel managing module 402.<br>
The kernel managing module 402 is used to remove the mapping relation between the first data channel and the second data channel which have been established after receiving the termination notification, and to close the first data channel and second data channel respectively.<br>
In practical application, the kernel managing module may have more than one kind of structures, and figure 5 shows one structure of the kernel managing module. As shown in figure 5, the kernel managing module comprises: the mapping establishing unit 501, the judging unit 502 and the sending unit 503.<br>
Here, the mapping establishing unit 501 is used to establish the mapping relation between the first data channel and the second data channel. The first data channel is the data channel between the source end and the relay server, while the second data channel is the data channel between the relay server and the target end.<br>
The judging unit 502 is used to, when receiving the message, judge whether the mapping establishing unit 501 has established the mapping relation between the first data channel and the second data channel, and if so, send forward notification to the sending unit 503.<br>
The sending unit 503 is used to forward the message in the kernel space after receiving the forward notification,<br>
In addition, the .sending unit 503 may comprise the modifying subunit 5031 and the sending subunit 5032.<br>
Here, the modifying subunit 5031 is used to, when (he message is sent by the source end through the first data channel, take the IP address information of the relay server as the source address information of the message, and take the IP address information of the target end as the target IP address information of the message.<br>
The sending subunit 5032 is used to forward the modified message to the target end in the kernel space through the second data channel.<br>
Besides, the kernel managing module may also comprise the removing unit 504.<br>
Here, the removing unit 504 is used to, when the source end wants to terminate<br>
13<br>
 <br>
forwarding messages, remove the mapping relation between the i'irst data channel and the second data channel which has been established, and close the first data channel and the second data channel respectively.<br>
In the embodiment of the present invention, specific operations performed by units inside the kernel managing module can be the same as thai described by the method shown in figure 3. Each unit can be either a physical functional unit or a software functional unit, and each unit can be further divided or a plurality of units can be combined together. For specific implementation, those skilled in this field may refer to practical conditions, which is not to be illustrated here.<br>
As can be seen that, in the embodiment of the present invention, when the kernel managing module receives the message, if the kernel managing module confirms that the mapping relation between the first data channel and the second data channel has been established, it will forward the message in the kernel space, so that the message can be forwarded in the kernel space, which avoids to copy messages from the kernel space to the user space as made in prior art and also avoids switch between the user state and the kernel state. Therefore, a large amount of computing resources can be saved, and further the relaying efficiency of the relay server is increased.<br>
The previous description of the disclosed embodiments is provided to enable any person skilled in the art to make or use the present invention. Various modifications to these embodiments will be readily apparent to those skilled in the art, and the generic principles defined herein may be applied to other embodiments without departing from the spirit or scope of the invention. Thus, the present invention is not intended to be limited to the embodiments shown herein but is to be accorded the widest scope consistent with the principles and novel features di.sclosed herein.<br>
<br>
<br>
We claim:<br>
1.	A relay method, comprising:<br>
receiving, by a relay server, a message sent from a source end via a first data channel;<br>
judging, by the relay server, whether a mapping relation belween the first data channel and a second data channel has been established in (he kernel space, wherein the second data channel is belween the relay server and a target end;<br>
forwarding, by the relay server, the message in the kernel space via the second data channel if the mapping relation between the first dala channel and Ihe second data channel has been established.<br>
2.	The method of claim 1, further comprising:<br>
establishing, in the kernel space, the mapping relationship between the first data channel and the second data channel in the kernel space if judging that there is no mapping relationship between the first data channel and the second data channel,<br>
3.	The method of claim 2, wherein the relay server, through the kernel control primitive, instructs the kernel of the relay server to establish the mapping relationship between the first data channel and the second data channel.<br>
4.	The method of claim 1 or 2, wherein the forwarding the message in the kernel space via the second data channel comprises:<br>
taking IP address information of the relay server as source address information of the message in the kernel space;<br>
taking IP address information of the target end as target address information of the message in the kernel space;<br>
forwarding the message whose source and target address information are modified to the target end via the second data channel in the kernel space.<br>
5.	The method of claim 1, further comprising:<br>
receiving, by the relay server, a response message sent from the target end via the second data channel;<br>
judging, by the relay server, whether the mapping relation between the first data<br>
i(?<br>
 <br>
channel and the second data channel has been established in the kernel space;<br>
forwarding, by the relay server, the response message in the kernel space via the first data channel if the mapping relation between the first data channel and the second data channel has been established. .<br>
6.	The method of claim 4, wherein the forwarding the response message in the kernel<br>
space via the first data channel comprises:<br>
taking IP address information of the relay server as source address information of the response message in the kernel space;<br>
taking IP address information of the source end as target address information of the response message in the kernel space;<br>
forwarding the response message whose source and target address information are modified to the source end via the first data channel in the kernel space.<br>
7.	The method of claim 1, further comprising when the source end needs to tcrininate<br>
forwarding messages:<br>
sending, by the source end, a session terminate request lo the relay server;<br>
removing, by the relay server, the mapping relation between the first data channel and the second data channel in (he kernel space upon receiving the session terminate re(|uest;<br>
closing, by the relay server, the first data channel and the second data channel respectively.<br>
8.	A relay server, comprising an application managing module and a kernel managing<br>
module; wherein:<br>
the application managing module is adapted to manage a first data channel between a source end and the relay server and a second data channel between the relay server and a target end, and to trigger the kernel managing module to establish a mapping relation between the first data channel and the second data channel;<br>
the kernel managing module is adapted to establish the mapping relation between the first data channel and the second data channel in the kernel space when triggered by the application managing module, and to judge whether the mapping relation between the first data channel and the second data channel has been established when receiving a message, and if so, forward the message in the kernel space.<br>
16<br>
 <br>
r<br>
j<br>
9.	The server of claim 8, further comprising:<br>
a request receiving module, adapted to receive a session terminate request sent by the source end which needs to terminate forwarding messages and send a termination notification to the kernel managing module;<br>
wherein the kernel managing module removes the mapping relation between the first data channel and the second data channel in the kernel space after receiving the termination notification and close the first data channel and second data channel respectively.<br>
10.	A kernel managing module, comprising:<br>
a mapping establishing unit, adapted to establish a mapping relation between a first data channel and a second data channel in the kernel space, wherein the first data channel is the data channel between a source end and a relay server, and the second data channel is the data channel between the relay server and a target end;<br>
a judging unit, adapted to judge whether the mapping establishing unit has established the mapping relation between the first data channel and the second data channel in the kernel space upon receiving the message, and if so, send a forward notification;<br>
a sending unit, adapted to forward the message in the kernel space upon receiving the forward notification.<br>
11.	The module of claim 10, wherein the sending unit comprises:<br>
a modifying subunit, adapted to take IP address information of the relay server as source address information of the message in the kernel space and take IP address information of the target end as target address information of the message in the kernel space;<br>
a sending subunit, adapted to forward the message whose source and target address information are modified to the target end in the kernel space via tlie second data channel.<br>
12.	The module of claim 10, further comprising:<br>
a removing unit, adapted to remove the mapping relation between the first data channel and the second data channel in the kernel space when the source end wants to terminate forwarding messages and close the first data channel and the second data channel respectively.<br>
 <br>
</td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/viewdoc.aspx?id=noC3DZraRSZg+4nrYAZ89g==&amp;amp;loc=egcICQiyoj82NGgGrC5ChA==" target="_blank" style="word-wrap:break-word;">http://ipindiaonline.gov.in/patentsearch/GrantedSearch/viewdoc.aspx?id=noC3DZraRSZg+4nrYAZ89g==&amp;amp;loc=egcICQiyoj82NGgGrC5ChA==</a></p>
		<br>
		<div class="pull-left">
			<a href="278362-a-method-and-system-for-optimal-group-search-for-gated-pilot-acquisition-in-wireless-system.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="278364-recycling-of-waste-material.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>278363</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>825/CHE/2009</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>53/2016</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>23-Dec-2016</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>21-Dec-2016</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>08-Apr-2009</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>TENCENT TECHNOLOGY (SHENZHEN ) COMPANY LIMITED</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>4/F, EAST 2 BLOCK, SEG PARK, ZHENXING ROAD, FUTIAN DISTRICT, SHENZHEN, GUANGDONG 518044</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>FAN, HUAHENG,</td>
											<td>4/F, EAST 2 BLOCK, SEG PARK, ZHENXING ROAD, FUTIAN DISTRICT, SHENZHEN, GUANGDONG 518044</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04L 12/56</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>N/A</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td></td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>200810089936.0</td>
									<td>2008-04-09</td>
								    <td>China</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/278363-a-method-for-forwarding-messages-in-kernel-space-at-the-relay-server by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 04 Apr 2024 22:51:53 GMT -->
</html>
