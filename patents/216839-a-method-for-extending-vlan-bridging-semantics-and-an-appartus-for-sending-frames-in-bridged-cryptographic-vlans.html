<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/216839-a-method-for-extending-vlan-bridging-semantics-and-an-appartus-for-sending-frames-in-bridged-cryptographic-vlans by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 11:05:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 216839:&quot; A METHOD FOR EXTENDING VLAN BRIDGING SEMANTICS AND AN APPARTUS FOR SENDING FRAMES IN BRIDGED, CRYPTOGRAPHIC VLANS&quot;</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">&quot; A METHOD FOR EXTENDING VLAN BRIDGING SEMANTICS AND AN APPARTUS FOR SENDING FRAMES IN BRIDGED, CRYPTOGRAPHIC VLANS&quot;</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>The invention comprises there extention of the XXXX VLAN bridge moded. The first ectention is the cryXXX graphic separation of VLANs over XXX links. A LAN segment type reffered XXX as an encapXXX LAN segment is introduced. An. frames or sucha segment are encapsulated according to an encryption and XXX scheme. The second extention is the: division of a trunk port into inbound and outbound ports. The third extention is a protocol that automatically XXX for each outbound port in a bridge VLAN. a set of LAN segment types for the port that minimizes the number of transfer between encapsulated and unencapsulated segments required to transport a frame in the bridge VLAN.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>Bridged Cryptographic VLAN<br>
BACKGROUND OF THE INVENTION<br>
TECHNICAL FIELD<br>
5<br>
	The invention relates to VLANs, More particularly, the invention relates to a bridged<br>
	cryptographic VLAN.<br>
	DESCRIPTION OF THE PRIOR ART<br>
10	 Basic VLAN concepts<br>
	Figure 1 shows a simple port-based VLAN 10, comprised of two VLANs, i.e. VLAN A<br>
	13 and VLAN B 15. The VLAN to which an unteggsd frame rceived at a port<br>
	belongs is determined by the Port VLAN ID (PVID) assigned to the receiving port, or<br>
15	 by the VLAN ID (VID) associated with the link-layer protocol carried in the frame (see<br>
	IEEE Std 802.1v-2001, Virtual Bridged Local Area Networks Amendmert 2: VLAN<br>
	Classification by Protocol and Port). There must be a way lo convey VLAN<br>
	information between the bridges 12, 14 because they are connected by a trunk link<br>
	16 Ihat can carry frames from more than one VLAN, A VLAN tag is added to every<br>
20	 frame lor this purpose. Such frames are called VLAN-tagged frames<br>
	Trunk links<br>
	A trunk link is a LAW segment used for VLAN multiplexing between VLAN bridges<br>
	(see IEEE Std 802.1V-2001, Virtual Bridged Local Area Networks—Amendment 2:<br><br>
WO 2004/042984	 PCT/US2003/034855<br>
	VLAN Classification by Protocol and Port). Every device attached to a trunk link<br>
	must be VLAN-aware. This means that they understand VLAN rnembership and<br>
	VLAN frame formats. All frames, including end station frames, on a trunk link are<br>
	VLAN-tagged, meaning that they carry a non-null VID. There can be no VLAN-<br>
5	 unaware end stations on a trunk link.<br>
	The trunk link 16 in Figure 1 is a multiplexed LAN segment shared by two bridges<br>
	12, 14. in general, many VLAN-aware bridges may be attached to a trunk link.<br>
10 	The access links 11 are LAN segments that do not multiplex VLANs. Instead, each<br>
	access Jink carries untagged frames of VLAN-tagged frames belonging to a single<br>
	VLAN. If frames are tagged then all frames on the segment carry the same V|D and<br>
end stations on the LAN segment must be VLAN aware.<br>
15 	Various limitations are encountered with the current state of VLAN art. One problem<br>
	is that of cryptographic separation of VLANs over trunk finks. The Introduction of a<br>
	schema to solve such probiem Use If raises the issue of efficient frame transfer<br>
	between encrypted and unencrypted LAN segments which represent a stngle VLAN,<br>
20 	SUMMARY Of THE INVENTION<br>
	The invention comprises Tnree extensions of Ihe IEEE 8D2.1Q VLAN bridge model<br>
	(see IEEE Sto 802.1Q-1998, IEEE Standards for Local and Metropolitan Area<br>
	Networks; Virtual Bridged Local Area Networks) . The first extension is the<br>
2<br><br>
WO 2004/042984 PCT/US20O3/034855<br>
	Cryptographic separation of VLANs over trunk links, A new LAN segment typer<br>
	referred to herein as the encapsulated segment type, is introduced. Air frames on<br>
	such a segment ars encapsulated according lo an encryption and authentication-<br>
	code scheme. The second extension is the division of a trunk port into inbound and<br>
5	 outbound tranks ports. Thethird extension is a protocol, referred to herein as the<br>
	Transfer Point Protocol (TPP), that automatically infers for each outbound trunk port<br>
	in a bridged VLAN, a set of LAN segment types for the port that minimizes the<br>
	number of transfers between encapsulated and unencapsulated segments required<br>
	to transport a frame in the bridge VLAN,<br>
10<br>
	BRIEF DESCRlPTION OF THE DRAWINGS<br>
	Figure 1 is a block schematic diagram showing a port-basert VLAN;<br>
15<br>
	Figure 2 is a block schematic diagram showing a bridged cryptographta VLAN<br>
according to the invention;<br>
	Figure 3 is a flow diagram showing construction of a forwarding set according to the<br>
	invention;<br>
20	 Figure 4 is a block schematic diagram showing a bridged cryptographic VLAN wrth<br>
	two wireless trunk links according to the invention;<br>
	Figure 5 is a block schemattc diagram showing a symmetric labeling of outbound<br>
	ports in a bridged cryptographic VLAN according to the invention;<br>
3<br><br>
WO 2004/042984 	PCT/CA2003/034855<br>
	Figure 6 is a block schematic diagram showing an asymmetric labeling of outbound<br>
	ports in a bridged cryptographic VLAN according to the invention;<br>
	Figure 7 is a block schematic diagram showing a purely encapsulated trunk in a<br>
	bridged cryptograph VLAN according to the invention;<br>
5 	Figure 6 is a flow diagram showing JPP message exchange when Bridge 1 of Figure<br>
	7 initiates an announce frame for the VLAN according to the invention;<br>
	Figure 9 is a block schematic diagram showing a labeling of the outbound ports<br>
	according \o the invention, after swapping Bridges 1 and 2 in Figure 7; and<br>
	Figure lo is a biock schematic diagram showing a lebeling of the outbound ports,<br>
10	 according to the invention, in a bridged cryptographic VLAN containing a bridge with<br>
	three trunk ports.<br>
	DETAILED DESCRIPTION OF THE INVENTION<br>
15	 LAN segment types<br>
	Tnree types of LAN segments represent a VLAN: untagged, tagged, and<br>
	encapsulated segments. The IEEE 802 to standard addresses only tagged and<br>
	uritaggecf segment types (sea IEEE Std 802.1Q-1998, IEEE Standards for Local and<br>
20	 Metropolitan Area Networks: Virtual Bridged Local Area Networks). The standard<br>
	specifies bridging semantics only for the transfer of traffic between tagged and<br>
	untagged segments representing the same VLAN. The invention provides a<br>
	technique that extends the bridging semantics to include transferring traffic between<br>
4<br><br>
WO 2004/042984 	PCT/US2003/034555<br>
	an unencapsulated segment (tajgged or untagged ) and an encapsulated segment of<br>
	the same VLAN, In general, arty number of LAW segment types can be introduced,<br>
	There is one frame type for each type of segment representing a VLAN. There are<br>
5	 three kinds of frames tn a bridged, cryptographic VLAMi untamed, VLAN-tagged<br>
	also referred to as tagged), and encapsulated. Thefirst two frarne types are those<br>
	of the IEEE 802,1Q standard (see IEEE Sid 802,1 Q-1998, IEEE Standards tor Local<br>
	and Metropolitan Area Networks; Virtual Bridged Local Area Networks). An<br>
	encapsulated frame is cryptographioaily encapsulated. Every eneapsulated frame<br>
10	 also has a VLAN teg. The tag, however. is different from the tag used within tagged<br>
	frames belonging to the VLAN. Associated with every VLAN are two unique VLAN<br>
	tags, ViD-T (used within lagged frames of the VLAN) and VID-E (used within<br>
	encapsulated frams of the VLAN).<br>
15 	For each VLAN, there is a unique security association comprising a cryptographic<br>
	authentication code key for checking the integrity and authenticity of frames that are<br>
	tagged as belonging to the VLAN, and a cryptographic key for ensuring the privacy<br>
	of all frames belonging to the VLAM,<br>
20 	The preferred encapsulation scheme Is an "encrypt-then-MAC" scheme, In this<br>
	scheme, the data pay load ot a frame Is encrypted and then a message<br>
	authentication code is computed over the restating ciphertexl and the frame's<br>
	sequence number- This schema has two major advantages: It facilitates forward<br>
	error correction when used with certain block ciphers and modes Of operation and it<br>
25	 permits frame authentication without decryption,<br>
5<br><br>
WO 2004/042984 	PCT/CA2003/034855<br>
	A tagged sel, an untagged set. and an encapsulated set of parts is associated with<br>
	each VLAN, The security association for a VLAN may be used to verify the<br>
	authenticity and integrity of every trame tagged as belonging to the VLAN, and<br>
5	 received at a porr in the VLAN's encapsulated set. The ingress-filtering rule for the<br>
	port determines whether verification occurs. The association may also be used to<br>
	encapsutete lagged and untged frames belonging to the &amp; VLAN cryptographically<br>
	before sending them from a port in the VLAN's encapsulated set,<br>
10 	Trunk ports<br>
	Every trunk port has an Inbound and an outbound port. A trunk link between two<br>
	trunk ports P1 and P2 connects the inbound port of P1 to the outbound port of P2,<br>
	and the outbound port of P1 to the inbound port of P2. Therefore 'he sets of LAN<br>
15	 segment types to which an inbound port betongs are exactly those of the outbound<br>
	port lo which it is connected. So, if is sufficient to assign only outbound parts to sets<br>
	ot LAN segment types in order to completely assign alt trunk ports in a bridged VLAN<br>
	to sets of LAN segment types<br>
20 	The inbound an outbound ports of a trunk pon can belong to different sets of LAN<br>
	segment types. For instance, the outbound port of a trunk can belong to a VLAN's<br>
	tagged set, antf the inbound port to its encapsulated sei, tn which case, only<br>
	encapsulated frames of the VLAN are received on the inbound port, and onty tagged<br>
	frames are ever sent from the outbound port,<br>
6<br><br>
WO 2004/042984	 PCT/US2003/034855<br>
	Unlike an access port the inbound of outbound port of a trunk port can belong to<br>
	both the tagged and encapsulated sets of a VLAN simultaneously.<br>
	The division of a trunk port into inbound and outbound ports is absent in the 802- 1Q<br>
5	 standard (see IEEE Std 802.1 Q-1993, IEEE Standards for Local and Metropolitan<br>
	Area Networks: Virtual Bridged Local Area Networks) where, in effect, the inbound<br>
	and outbound ports are the same port. Inbound and outbound frame types are<br>
	therefore always the same for a given trunk port in 802.1Q.<br>
10 	Figure 2 illustrates a bridged cryptographic VLAN. Ports P1 (20) and P2 (21) are<br>
	access ports, one for VLAN A 26. ancf the other for VLAN B 29, VLANs A and B<br>
	having access links 30, 31. A trunk link 16 connects the two bridges 12a, 14a via<br>
	trunk ports P3 (22) and P4 (23). P3 has inbound port P3, and outbound port P3a P4<br>
	has inbound port P4, and outbound port P40 . P4, is connected to P3XXX and P40 is<br>
15	 connected to P31. Frames received at P4 arrive on inbound port P41 and those sent<br>
	out P4 leave via outbound port P4O. Frames received at P3 arrive on inbound port<br>
	P3i arrd those sent out P3 leave via outbound port P3<br>
	Ports P5 (24) and P6 (25) are attached to wireless access links 30. In the preferred<br>
20	 embodiment, they are actually virtual ports that share a single radio interface (access<br>
	point) through which frames are sent and received via RF. VLANs A 28 and B 29<br>
	can be represented by different encapsulated segments even though they share the<br>
	same RF medium. An end station in VLAN; for exampleT can receive but not<br>
	decipher any frame belonging to VLAN 8. Therefore, distinct access links 32, 33 are<br>
25	 shown for A and 6 even though their physical separation is only cryptographic.<br>
7<br><br>
WO 2004/042984	 PCT/US2003/034855<br>
	Suppose P1 receives only unissued frames, and P2 only tagged frames. Further,<br>
	suppose the trunk link carries tagged frames in both directions, and the wireless<br>
	access links only encapsulated frames, Then for VLAN A, the untagged set is {Pi},<br>
5	 the tagged set Is {P30 P30 P40 P4, } and the encapsulated set is {P5}: and for B the<br>
	sets are { } { P2, P30 P3r, P40, P4,}, and { P6 } reapectively.<br>
	In the ingress filtering rule at P5 specifies authenticity checking, then a frame<br>
	received at P5 is authenticated using the security association for VLAN A. If<br>
10	 successful, then the frame is determined to be a member Of the encapsutated<br>
	segment for A. Suppose the frame must be forwarded to P4, Then Bridge 2:<br>
	decapsulates the frame using the same security association. The bridge forwards<br>
	the decapsulated frame to P40 with its tag repraced by A-T, thereby transferring the<br>
	frame frorn A's encapsulated segment to its tagged segment. Conversely, frames<br>
15	 arriving at P4: and destined tor P5 are encapsulated using the security association<br>
	for A. Tag A-T is replaced by A-E, which transfer the frame from As tagged<br>
	segment to its encapsulated segment.<br>
	There are many variations of the example in Figure 2, For instance, it may be<br>
20	 desirable to protect traffic on VLAN B only. In this case, P5 does not belong to the<br>
	encapsulated set for A, Only frames received at P6, i.e. frames tagged with B-E, are<br>
	authenticated, and only B-tagged frames received at P4i and destined for P6 are<br>
	encapsulated.<br>
8<br><br>
WO 2004/042984	PCT/US2003/034855<br>
	Bridging semantics<br>
	Consider a VLAN bridge having multiple ports. Suppose a frame is received at port<br>
	P- It is assigned 1o a VLAN In one of several ways. If P is a trunk port, then the<br>
5	 franw must carry a VLAN tag of the form VID-T or VlD-E, each of which identities, a<br>
	VLAN, namely VID. Otherwiser the frame is diseased. If P is not a trunk port, then<br>
	either port or protocol-based VLAN classification can be used to assign the frame to<br>
	a VLAN (see IEEE Std 802.1v-2001, Virtual Bridged Local Area<br>
	Networks—Amendment 2: VLAN Classification by Protocol and Port).<br>
10 	Ingress filtering<br>
	If P is a trunk port and is not in the tagged or encapsulated sets for VID, then the<br>
	frame is discarded. The ingress-filter rule for a port may specify authentication and<br>
	integrity checking for certain VLANS. If P is a port whose ingress filter rule requires<br>
15	 authentication and integrity checking for the VLAN VlD, then the frame received at P<br>
	must have a VLAN tag VID-E. Otherwise, the frame is discarded. In 1he preferred<br>
	emboiment, an authentication code is computed over the received frame's<br>
	ciphertext and sequence number using the security association for VID. If it does not<br>
	match, the received authentication code In the frame, then the frarm Is discarded.<br>
20	 otherwise, tha frame is judged to belong to the encapsulated segment for VlD.<br>
	If P is not in the tagged set for VlD, but it is attached to a VLAN-iagged access link,<br>
	then the received frame is discarded.<br>
9<br><br>
WO 2004/042984	 PCT/US2003/034855<br>
	Forwarding process<br>
	The forwarding process begins by corisvutf ing the target port set O. This is the set<br>
	of ports to whicn a frame belonging to a particular VLAN rnust be forwarded.<br>
5	 Suppose a if farm received al port P belongs to the VLAN SAD. tf the fams must be<br>
	flooded then Q contains any ou(bound or access port that is a member of the tagged,<br>
	untagged or encapsulated sets for VID. The next step is to shrink Q if. and only if. P<br>
	is an inbound port of a trunk that belongs to both the tagged and encapsulated sats<br>
	of VID. In this case, every port in the encapsulated set of VID that does not belorig<br>
10	 to the tagged set of VID is ramovecf from a if the received frame is a tagged (name,<br>
	or every port in ttre tagged or untagged set of VID that does not be!ong to the<br>
	encapsulated set of VID is removed from Q if the received frame is encapsulated.<br>
	Bacause the inbound port belongs to both sets of LAN segmenrt types fO VlDr the<br>
	inbound port must receive a frame of each LAN segment type, and therefore<br>
15	 shriking the target port set is justified. The Transfer Point Protocol has the property<br>
	that it guarantees shrinking never results in an empty target port set. Shrinking to an<br>
	emptytarget set implies the bridge received a fram that it has no reason to receive.<br>
	The next step in the forwarding process is to construct a forwarding set for the<br>
20	 received frame. This is the set of frames to be forwarded as a result ot receiving the<br>
	frame belonging to VID at port P, These are tne frames necessary lo transfer traffic<br>
	from one LAN segment of the VLAN to another. Tne table shown in Figure 3 Is used<br>
	to construct forwarding sets. The frame received at P belongs to a Kind K of LAN<br>
	segment for VID (tagged, untagged, of encapsulated). Likewise, every pont in Q<br>
25	 belongs to a kind at LAN sggment, the kind of port set to which it belongs for VID.<br>
10<br><br>
WO 2004/042984	 PCT/US2003/034855<br>
	Trunk ports may have two KINDS OF sets: tagged and encapsulated, For every port q<br>
	in Q, add a frame to the forwarding set according to rule (K, K) in me table of Figure<br>
	3, where K' is a kind of port set to which q belongs for VID.<br>
5 	The rules for constructing the forwarding set for a received frame are as follows:<br>
	(1) Add received frame to forwording set.<br>
(2) Add VLAN tag VlD-T to received frame. add the result to forwarding set.<br>
10<br>
	(3) Received frame is cryptographteally encapsulated using the security<br>
	association for VlD resulting frame is VLAN tagged with VID-E and added<br>
	to forwording set<br>
15 	(4) Remove VID-T fromreceived frame; add urtagged frame to forwording<br>
	set<br>
	(5) Receded frame's ciphertext is decrypted using the securty association for<br>
	VID; resulting frame is untagged and added to forwarding set.<br>
20<br>
	(6) Received frame's ciphertext is decrypted using the security association for<br>
	VID; resulting frame is tagged wilh VID-T and added to forwarding set.<br>
11<br><br>
WO 2004/042984	 PCT/US2003/034855<br>
	In the presently preferred embodiment there can be at most three frames in any<br>
	forwarding set, corresponding to me three different kinds of LAN segment that can<br>
	represent a VLAN. The forwarding process forwards the frames of the forwarding<br>
	set as follows<br>
5<br>
	• The forwarding process queues for transmission at each port in Q that belongs to<br>
	the untagged set for VID, the untagged frame, if any, in the forwarding SET.<br>
	• The forwarding process queues for transmission at each port in Q lhaf belongs to<br>
10	 the tagged set for VID, the VLAN -tagged frame, if any, in the forwarding set<br>
	• The forwarding process queues tor transmission at each port in Q that belongs to<br>
	the encapsulated set for VID, the encapsulated frame, if any, in the forwarding<br>
	set<br>
15	Frame transfer<br>
	Within a bridged, cryptographic VLAN. steps are taken to eliminate redundant<br>
	transfers between LAN segments representing the same VLAN. For instance, it is<br>
	desirable to avoid transfeming an unencapsulated frame to a VLAN's encapsulated<br>
20	 segment more than once in a bridged VLAN because each transfer requires <br>
	encryption. Encapsulation should be done once and shared by all egress ports that<br>
	belong to the VLAN's encapsulated set across ad bridges. Similarly, it is desirable to<br>
	avoid repeated decapsulation across bridges because each calls for decryption<br>
12<br><br>
WO 2004/042984	 PCT/US2003/034855<br>
	For instance, consider the bridged LAN in Figure 4. Suppose the ports of Bridges 1<br>
	(41) and 2 (42) to which the wireless trunk links 43 are attached belong to the<br>
	encapsulated set for VLAN &amp; 44. if the trunk link 45 carries only VLAN-tagged<br>
5	 frames, then frames belonging to VLAN B that are received at Bridge 1 rnust be<br>
	encapsulated at Bridges 1 and 2. However, if the trunk link carries encapsulated<br>
	frames then encapsulation need only be done at Bridge 1 and shared with Bridge 2.<br>
	There are also situations where ancapsulaiion can be done too early in a bridged<br>
10	 LAN, forcing encapsulated frames to be sent over trunk links unnecessarily. There Is<br>
	a transfer point for encapsulation and (decapsulation for each VLAN that.minimizes<br>
	cryptographic operations. The Transfer Point Protocol (discussed below) infers this<br>
	transfer point between segments.<br>
	Transfer Point Protocol<br>
15<br>
	A minimum spanning tree algorithm can reduce any bridged LAN to a spanning tree<br>
	whose nodes are the bridges and whose edges are trunk links. A spanning tree<br>
	induces a partial order or bridges. For instance, we can taka as the partial order B1<br>
20	 the root of the spanning tree. The set of bridges together with the partial order<br>
	defines a complete, partially ordered set. Every nonempty subset of bridges has a<br>
	least upper bound.<br>
13<br><br>
WO 2004/042984	 PCT/US2003/034855<br>
	Consider frames received at the root of the spanning tree. The least upper bound of<br>
	all bridges requiring a received frame of a VLAN to belong to one of iha LAN<br>
	segments representing the VLAN is the transfer point for converting received frames<br>
	to frames for that LAN segment<br>
5<br>
	The Transfer Point Protocol (TPP) comprises two link-layer protocols, TPP-T for<br>
	adding outbound Trunk ports to thh tagged set of a VLAN, and TPP-E for adding<br>
	outbound trunk ports to the encapsulated set of a VLAN. The trunk ports are across<br>
	al lbridges that bridge the VLAN- For example, TPP-E determines that the outbound<br>
10	 trunk port connecting Bridge 1 to Bridge 2 in Figure 4 must be a member of the<br>
	ancapsulated set for VLAN B. That way the wireless trunk port at Bridge 2 can<br>
	share encapsulations pefformed by Bridge 1 for its outbound wireless trunk port.<br>
	TPP assumes that every access link port has been assigned to the tagged,<br>
15	 uataggad, or encapsulated set tor a VLAN prior to execution because it uses this<br>
	infortnation to infer the sets to which outboond trunk ports in the bridged VLAN<br>
	belong. TPP-E can assign an outbound trunk port to the encapsulated se oi a<br>
	VLAN, while TPF'-T can assign the same outbound port to the tagged set of the<br>
	VLAM.<br>
20<br>
	TPP has two frams types, the announce frame, and the reply frame. Each ct these<br>
	frames contains a VLAN ID and a source bridge routing path, where each entry in<br>
	the path is a unique pair containing a bridge MAC adress and three bits, one bit for<br>
	each LAN segment type, i.e. tagged, untagged, and encapsulated. The tagged bit is<br>
25 	high It and only if ihe bridge addressed in the pair has an access port in the tagged<br>
14<br><br>
WO 2004/042981 	PCT/US2003/034855<br>
	set of the VLAN named in the frame. Tire untagged and encapsulated bits ars set<br>
	likewise,<br>
	A bridge sends a TPP announce frame, e.g a GARP POU, to a TPP group address,<br>
5	 e.g, a GARP application address, through each of its outbound trunk ports for every<br>
	VLAN known to it. When a bridge receives an announce frame, it appends to the<br>
	right of the path the pair for itself regarding the named VLAN received, and forwards<br>
	the frame to each of its enabled, outbound trunk ports except the receiving trunk<br>
	port, if it has no other such ports, then il sends the final routing path and received<br>
10	 VID in a TPP reply frame to the MAC address thai precedes it jn ihe routing path.<br>
	The originating bridge of an announce frame creates a path consisting only of a pair<br>
	for itself. When a bridge receives a TPP reply frame on an inbound trunk port, it<br>
	forwards the reply frame to the bridge MAC address thai precedes it in the path. If<br>
	ihere is none, the frame is discarded.<br>
15 	TPP-E<br>
	When a bridge receives a TPP reply frame on a trunk port, it adds the trunk's<br>
	outbound port to the encapsulated set for the VID in the frame if, and only if, it is<br>
	followed by a bridge B in the routing path whose encapsulated bit is high, and either<br>
20 	a) the receiving bridge has a tagged or untagged access port for the VID and no<br>
	 bridge after it in the routing path, up to and including B, has a high tagged or<br>
	untagged bit; or<br>
	b) the receiving bridge has an encapsulated access port for the VID, or is<br>
	preceded by a bridge in the routing path with a high encapsulated bil.<br>
15<br><br>
WO 2004/042984	 PCT/US2003/034855<br>
	TPP-T<br>
	When a bridge receives a TPP reply frame on a trunk port, it adds the trunk's <br>
	outbound part lo the togged set tot the VlD in tine frame if, and only if it is fallowed<br>
5	 by a bridge B in the routing path whose tagged or urrtagged bit is high, and either<br>
	a) the receiving bridge has an encapsulated access port for the VlD and no<br>
	bridge after it in the routing path, up to and including B, has a high<br>
	encapsulated bit; or<br>
10<br>
	b) the receiving bridge has a tagged or untagged access port lor the VlD, or is<br>
	preceded by a bridge in the routing path with a high tagged or untagged bit<br>
Example<br>
15<br>
	Example 1<br>
	Consider bridging a single VLAN- Each access porttherefore is assumed to belong<br>
	to this VLAN, Thus, VLAN labeling of ports is omitted in the examples. Instead, the<br>
20	 outbound trunk ports are labeled with LAN segment types, i.e. T (tagged), U<br>
	(untagged). and E (encapsulated), U an outbound port is labeled with U, for<br>
	example, then the port belongs to the untagged set of ihe VLAN,<br>
16<br><br>
WO 2004/042984	 PCT/US2003/034855<br>
	initially, every access part, is labeled according to the kindof set to which the port<br>
	belongs for the VLAN. Trunk ports are initially unlabeled. jt is the job of TPP ro infer<br>
	labels for them. Figure 5 shows a bridging of a VLAN 50 where two bridges 51, 52<br>
	are connected by a trunk 53. Each bridge has two access ports. Because each<br>
5	 Bridge has both jntagged and encapsulated access ports, TPP infers that both<br>
	outbound ports of the trunk belong to the tagged and encapsulated sets of the VLAN.<br>
	Each inbound port also belongs to these sets.<br>
10 	Each outbound port is a member of the tagged set per rule TPP-T (b). Each bridge<br>
	infers this fact when it initiates a TPP announce frame. Therefore, both the<br>
	encryption and decryption done by each bridge is shared with the other.<br>
	Example 2<br>
15<br>
	In Figure 6, Bridge 1 (61) has an untagged access port and Bridge 2 (62) has an<br>
	encapsulated access port. Therefore, the outbound port 63 of Bridge 1 is a member<br>
	of the encapsulated set per rule TPP-E (a) whereas the outbound port 64 of Bridge 2<br>
	is a member of the tagged set per rule TPP-T (a),<br>
20<br>
	Example 3 <br>
	Figure 7 illustrates a purely encapsulated trunk link. All frames over the link are<br>
25	 encapsulated, however, no encryption is done at Bridges 2 or 3,<br>
17<br><br>
WO 2004/042984	 PCT/US2003/034855<br>
	Figure 8 shows the TPP message exchange between Bridges t (71), 2 (72), and 3<br>
	(73) when Bridge 1 (71) Of Figure 7 initiates an annouce frame for the VLAN, which <br>
	we assume for the example is named "B"<br>
5	Example 4<br>
	If Bridges 1 (71) and 2 (72) in figure 7 are interchanged, me result is the bridged<br>
	cryptographic VLAN of Figure 9.<br>
10 	Example 5<br>
Figure 10 shows a bridge 82 with three trunk ports, each connected to another<br>
	bridge 81, 83, 84. The outbound port of the trunk from Bridge 4 (84) belongs to the<br>
	tagged and encapsutated sets, whereas the outbound port of Bridge 2 (82) that is<br>
15	 connected to the inbound port of Bridge 4 is only a member of the encapsulated set<br>
TPP may run repeatedly to inter changes in transfer points, How frequently it runs<br>
	and the number of bridges it affects depends on the displacement of access links,<br>
	For example, it an end station is wireless, then movement of the station with respect<br>
20	 to the bridged LAN can result in its encapsulated access link being relocated. Unti|<br>
	TPP is rerun, there may be redundant transfers for a VLAN.<br>
A bridged VLAN may consist of bridges that do not participate in TPP. !n general, <br>
	there may be one or more cryptographic VLAN bridges with trunk ports connected to<br>
25	 legacy VLAN bridges. If each such itrunk port is viewed instead as a coflection of<br>
	virtual, tagged access ports, one port tor each VLAN tag that can be sent over the<br>
18<br><br><br>
WO 2004/042984	 PCT/US2003/034855<br>
	trunk, then TPP can still be run to infer transfer points among participating bridges.<br>
	However, there may be redundant transfers across the entire bridged LAN. For<br>
	exampler if a nonparticipating core switch were to separate two cryptographic VLAN<br>
	bridges, each having an access port in the encapsulated set ot the same VLAN, then<br>
5	 traffic between these encapsulated segments would be decrypted upon entry 16 the<br>
	core and then re-encrypted after exiting. Observe that no encryption or decryption is<br>
	needed if there are no access ports in the core that belong to the tagged or urnagged<br>
	sets of the VLAN. In this case, TPP can treat the virtual access port for each VLAN<br>
	Tag as an encapsulated access port rather than a tagged access port, Then all traffic<br>
10	 between the two encapsulated segments can traverse the core transparently as<br>
	encapsulated frames because every encapsulated frame is a VLAN-tagged frame.<br>
	Group security<br>
	A cryptographic VLAN v is defined by a group of m stations in at has a unique security<br>
15	 association The association consisists of the following:<br>
	a) an encryption Key Kv1<br>
	b) an authentication code key K' v1<br>
	c) a distribution key K"V1 and<br>
	d) m random values RTL R2.....RXXX<br>
20 	The encryption key is a symmetric key used by v-aware bridges and stations of v to<br>
	encrypt and decrypt frames belonging to v. All v-aware bridges, and stations of v,<br>
	compute and verify authentication codes over encrypted frames of v using K'v<br>
	There is one random value for each of the m stations. The /1h station of the group '<br>
	knows all m random values except RXXX. The m - 1 random values it knows are<br>
19<br><br>
WO 2004/042984	 PCT/US2003/034855<br>
	communicated to it by a v-aware bridge. Privacy ot me random values is ensured by<br>
	encryption using distribution key K"XXX while their authenticity is ensured by an<br>
	authentication code computed over the resulting ciphertext using authentication code<br>
	key K'v<br>
5 	Joining a cryptographic VLAN<br>
	Joining a cryptographic VLAN is done with a two-step protocol:<br>
		adding a new Station to tte group, and<br>
		enabling all other stations in the group to eliminate the new station later<br>
	A user's station joins a cryptographic VLAN v through a mutual authentication<br>
10	 protocol executed between the user, via the station, and an authenticates residing on<br>
	a v-aWare bridge. If mutuat authentication succeeds, A secure eprremeral channel is<br>
	created between the bridge and the new station to transfer Kv K'v and R1. R2 <br>
	Rm securely trom the bridge to the station. Then the second step of the Join protocol<br>
	executes, Otherwise, the protocol terminates immediately. In the second step, the<br>
15	 same v-aware bridge chooses a new random value Rm+1 for the new station. and<br>
	distributes it to all v-aware bridges, and station comprising v, in a broadcast frame<br>
	that is encrypted under K" v and carries an aulhentication code computed over the<br>
	ciphertext using K'v The bridge then creates a new distribution key for v and<br>
	distributes it to all v-aware bridges and to members of v, including the new station, in<br>
20	 a broadcast frame that is encrypted under K v and carries an authentication code<br>
	computed over the ciphertext uaing K'v<br>
	Although the new station can verify the authenticity of the broadcast containing its<br>
	own random value Rm+1 it is unabfe to decrypt it because ft does not hold key K"v<br>
20<br><br>
WO 2004/042984 	PCT/US22003/034855<br>
	Leaving a cryptographic VLAN<br>
	A. subgroup of stations can simultaneously leave a cryptographic VLAN v, perhaps<br>
	involuntary. Suppose stations 1....it of a group leave. When this happens, it is<br>
	detected by a v-awara bridge which then announces the departure of stations 1,..., k<br>
5	 via a single broadcast frame that includes an authentication code computed over the<br>
	frama using K'y The broadcast will notify every v-aware bridge and station in the<br>
	group that stations 1,,,., k have left. Each such bnd§a and station then attempts to<br>
	re key the encryption, authentication code, and distribution keys for vT each as a<br>
	fundion of the old key and the random values R,,.,., Rk'. Every v-aware bridge and<br>
10	 all remaininig stations in v will share a now eecwity aesoiciation as a result, indudiifiig<br>
	K fewer random vslues.<br>
	Every v-aware bridge always has the current distribution key for v' unlika a station.<br>
	So every such bridge always has the complete set of random values for any<br>
15	 subgroup that leaves v, thereby allowing it to always re key the keys for v. The<br>
	Situation Is different for stations however Rekeying is a function of the random<br>
	values for departing stations, values thai these stations do not have. Therefore, they<br>
	are unable to rekey. Furthermore, forward secrecy is guaranteed, A departed<br>
	station can never become a rnernber of v again as a result of subsequent rekey ings,<br>
20	 This is because rekeyiag is a function of ttis currerrt keys which means. that all Keys<br>
	arrived at thereafter will always be a function of a random value unknown to the<br>
	station. Only through rejoining vcan the station ever become a member of v again.<br>
	Although the invention is described herein with reference to the preferred<br>
25	 embodiment, one skilled in the art will readiiy appreciate that other applications may<br>
21<br><br>
WO 2004/042984	 PCT/US2003/034855<br>
	be substituted for those set forth here in without departing from Ihe split and scope of<br>
	the present invention. Accordingly, the invention should only be limited by the<br>
	Claims included below.<br><br>
AMENDED PAGE<br>
REPLACEMENT CLAIMS<br>
5 	1, A method for extending VLAM bridging semantics, comprising the steps of:<br>
		providing an untagged frame and a tagged Frame in accorttence with tho IEEE<br>
	302 1Q VLAN bridge model;<br>
		providing a cryptagraphlcally encapsulated frame, wherein every<br>
	encapsulated frame has a VLAN tag that is different from a teg used within tagged<br>
10	 frames belonging to said VLAN;<br>
	providing a. trunk port divided into inbound and! outbound trunk ports;<br>
	providing one of said untagged. tagged, and encapsulated frame lype for<br>
	each segment representing a bridged, cryptographic VLAN; and<br>
	transfenring traffic between an unerrcapsulated segment (tagged or untagged)<br>
15	 and an encapsulated segment of a same VLAN.<br>
	2. The method of Claim 1, further comprising the step of:<br>
		associating with every VLAN two unique VLAN tags, said two unique VLAN<br>
	tags comprising VlO-T, which is used within tagged frame of said VLAN, and VID-E.<br>
20	 which Is used within encapsulated ffames of said VLAN.<br>
	3. The method of Claim 1. wherein for each VLAM, there is a unique security<br>
	association comprising a comptographic authentication code key tor checking integrity<br>
	and authenticity of frames that are tagged as belonging to sard VLAN, and a<br>
25	 cryptographic key for ensuring privacy of all frames belonging to said VLAN.<br>
25<br><br>
AMENDED PAGE<br>
	4, The method of Claim 1, wherein said encapsulated frame is encapsulated in<br>
	accordance with an encrypt-then-MAC method, which com prises tho steps of:<br>
		encrypting a data paytoad of a frame; and<br>
		eorciputinig a message authentication code ovet a resulting dphedett. and said<br>
5	 frame's sequence number.<br>
	5. The method of Claim 1, wherein a tagged set, an untagged set, and an<br>
	encapsulated set of ports ts associated with each VLAN.<br>
10 	6, The method of Claim 1, further comprising the step of:<br>
	using a security association for a VLAN to verify authenticity aad integrity of<br>
	every frame tagged as betonging to said VLAN, and received at a port in said<br>
	VLAN's encapsutated set.<br>
15 	7. The method of Claim 6, further comprising the step of:<br>
		providing an ingress-filtertng rule for said port to determine whether<br>
	verification occurs.<br>
	8. The method of Claim 6, further comprising the step of,<br>
20 		using said association to encapsulate tagged and untagged frames bebng'ing<br>
	to paid VLAN cryptographfcally before sending them from a port In said VLAN's<br>
	eneapsulated set,<br>
	9. An apparatus for sending frames in bridged, crypto graphic VLANs, comprising:<br>
25 		at least two bridges<br>
24<br><br>
AMENDED PAGE<br>
		a plurality of trunklinks wherein every trunk link of said trunk links is<br>
	associated With the inbound trunk port of one bridge of said at least two bridges and<br>
	the outbound trunk port of another bridge of said at feast two bridges;<br>
		a plurality of access porte;<br>
5 		a plurality of access links wherein every access link of said access links is<br>
	associated with one access port of said access ports; and<br>
		means for nepreserting said VLANs by different encapsulated segments even<br>
	though thay share a same medium, wherein physical separation of said VLANs is<br>
	cryptographic<br>
10<br>
	10. The apparatus of Claim 9, further comprising:<br>
		an ingress-filtering rule associated with alt least one of said access ports for<br>
	specifying authenticity checking,, wherein a frame received at said one of sard access<br>
	ports is authenticated using a securty association for an associated VLAN;<br>
15 		wherein, if authentication successful, then said frame is determined to be a<br>
	member of an encapsulated segment for said associated VLAM.<br>
		11. The apparatus of Claim 10, wherein said ingress -filterr ule associated with at<br>
	least one of said access ports specifies authentication and Integrity checking for<br>
20	 certain of said VLANs.<br>
		12. The apparatus of Claim 11 r further comprising;<br>
		an authentication code that is computed over a received frame's ciphertext<br>
	end sequance number using said security association;<br>
25<br><br>
AMENDED PAGE<br>
		wherein, ifsaid authenticate code does not match a received authentication<br>
	code in said frame, then said frame is discarded; and<br>
		wherein said frame is otherwise determined to belong to an encapsulated<br>
	segment for an associated VLAN.<br>
5<br>
	13, The apparatus of Claim 9, further comprising:<br>
		one or more rules for constructing a target port set for a frame received at an<br>
	inbound pert that belongs to the tagged and encapsulated sets off a VLAN;<br>
		wherein , every port in the encapsulated set of said VLAN that is not a member<br>
10	 of trie tagged set of said VLAN is removed If satd frame is tagged; and<br>
		wherein, every port in either the tagged or untaggod sets of said VLAN that is<br>
	not a member of the encapsulated set of said VLAN is removed if said frame is<br>
	encapsulated.<br>
15 	j4.The apparatus of Claim 9, further comprising;<br>
		one or more rules for constructing a forwarding set for a received frame, which<br>
	rules may comprise any of Ihe following:<br>
		add a received frame to said forwarding set;<br>
		add a VLAN lag to a received frame; add the resuft to said forwarding set;<br>
20 		a received frame is cryptographically encapsulated using a security<br>
	association; a resulting frame is VLAN taggedand added to said forwarding set;<br>
		remove a VLAN tag from a received frame; add an untagged frame to said<br>
	Forwarding set;<br>
		a veceived frame's ciphertext is decrypted using 3 security assciation: a<br>
25	 resulting frame is untagged and added to said forwarding set; and<br>
26<br><br>
AMENDED PAGE<br>
		a received frame's ciphertext is decrypted using a security association; a<br>
	resulting frame is tagged and added to said forwording set.<br>
15, 	A method for forwarding frames of a forwardlag set that ia defined with respect to<br>
5	 the target port set far a received frame of a VLAN, comprising the steps of:<br>
		queuing an untagged frame, if any, in said forwarding set. for transmission at<br>
	every port in said target set that belongs to the untaggecf set for said VLAN;<br>
		queuing an VLAN-tagged frame, if any, in said forwarding set. for transmission at<br>
	every port in said target set that belongs to the tagged set for said VLAN; and<br>
10		 queuing an encapsulated frams, if any, in said forwarding set. for transmission at<br>
	every port in said target set that belongs lo the encapsulated set for sprd VLAN.<br>
	16, A method for eliminating redundant transfers between LAN segments in a<br>
	 bridged, cryptographic VLAN, comprising the STEPS of:<br>
 15 		avoiding transfer of an unencapsulated frame to a VLAN's encapsulated<br>
	 segment more than once in a bridged VLAN where each transfer requires<br>
	 ervcrypton;<br>
		perforrnirig encapsufatbn once, said encapsulation being shared by all egress<br>
	 ports that belong to said VLAN's encapsulated set across all bridges; and<br>
 20 		avoiding repeated decapsulation across bridges in said bridged VLAN where<br>
	 each requires decryption.<br>
 	17 	A method for determining optima transfer points between LAN segments<br>
	 representing a bridged, cryptographic VLAN, comprising the steps of:<br>
27<br><br>
AMENDED PAGE<br>
		reducing any bridged LAN to a spanning tree whose nodes are said bridges<br>
	and whose edges are trunk links 10 induce a partial order on sard bridges: wherein a<br>
	least bridge is the root of said spanning tree; wherein the set of bridges together with<br>
	a partial order define a complete, partsaily ordered set; and wherein every nonempty<br>
5	 subset of said bridges has a least upper bound;<br>
		wherein said least upper bound of aJI bridges requiring a received frame of a<br>
	VLAN to belong to one of said LAN segments representing said VLAN is an optimal<br>
	transfer point for converting received frames to frames for that LAN segment; and<br>
		deducing automatically, from an assignment of bridge access ports in said<br>
10	 bridged VLAN to said LAN segments, the smallest set of LAN segments that must be<br>
	associated with a given outbound trunk port in order to bridge said VLAN.<br>
	18. An apparatus for implementing a transfer point protocol (TPP) in a bridged,<br>
	cryptographic VLANT comprising:<br>
15 		at least two brid ges:<br>
		a plurality of trunk links wherein every trunk link of said trunk links is<br>
	associated with an inbound trunk port of one bridge of said at least two bridges and<br>
	an outbound trunk port of-another bridge of said at least two bridges;<br>
a plurality of access ports;<br>
20 		a plurality ol accesslinks wherein every access Iink of said access links is<br>
	associated with one access port of said access ports: and<br>
		means for representing said VLANs by different entapsutated sertjmentes even<br>
	though they share a same medium, wbere in physicaf separation of said VLANs is<br>
	cryptographic,<br>
28<br><br>
AMENDED PAGE<br>
		two Iink-layef protocols, a first link-layer protocol (TPP-T) for adding outbound<br>
	ports to the tagged set of a VLAN. and a second link-layer protocol (TPP-E) for<br>
	adding outbound ports to tfte encapsulated set of a VLAN; and<br>
		wherein every access port is assigned to a tagged, untagged, or encapsulated<br>
5	 set for a VLAM prior to sxecution.<br>
	19. The apparatus of Claim 18, said transfer point protocol (TPP) further comprising:<br>
		two frames types, one of said frame types comprising an announce frame.<br>
	and a second of said frame types comprising a reply frame wherein each of said<br>
10	 frames contains a VLAN ID and a source bridge routing palh, where each entry in<br>
	said path is a unique pair containig a bridge MAC address and three bits, one bit for<br>
	each LAN segment type. wherein said tagged bit is high if andt only if a bridge<br>
	addressed in, said pair has an access port in a tagged set of said VLAN named in<br>
	said frame, and wherein said untagged and encapsulated bits are set likewise.<br>
15<br>
20. 	A transfer point protocol (TPP) in a bridged, cryptographic VLAN, comprising the <br>
	steps of<br>
		a bridge sending a TPP announce frame to a TPP group address through<br>
	each of its trunk ports for every VLAN known to it<br>
20 		when a bridge receives an announce frame, said bridge appending to<br>
	reserved routing path an entry for itself regarding the received VLAN ID. nnd<br>
	forwarding said frame to each of its enabled, outbound Irunk ports except the<br>
	receiving trunk port: wherein it said bridge has no other such trunk ports, then said<br>
	bridge sending a final routing path and said received VLAN ID in a TPP reply frame<br>
25	 to the MAC address that precedes said bridge in said routing path:<br>
29<br><br>
AMENDED PAGE<br>
		an originating bridge of an announce frame creating a path consisting only of<br>
	an entry for itselt;<br>
		when a bridge receives a TPP reply frame, said bridge forwarding said reply<br>
	frame to the bridge MAC add ness that precedes said bridge ia said routing path; and<br>
5	 if there is none, discarding said frame.<br>
	21. The protocol of Claim 20, wherein when a bridge receives a TPP reply frame on<br>
	an inbound trunk port, said bridge acids the outbound port corresponding to said<br>
	inbound trunk port to line encapsulated set for the VLAN 10 to said frame if, and only<br>
10	 if, said bridge is followed by another bridge in said routing path with an encapsulated<br>
	access port, and either:<br>
		said bridge has a tagged or untagged access port for said VLAN ID and no<br>
	bridge after ft in said routing path, up lo an including said other bridge, has a tagged<br>
	or untegged access port; or<br>
15 said bridge has an encapsutated access port for said VLAN ID, or said bridge<br>
	is preceded by another bridge In said routing path with art encapsulated access port.<br>
	22. The protocol of Claim 20, wherein when a bridge receives a TPP reply frame on<br>
	an in bound trunK port, said bridge adds the outbound port corresponding to said<br>
	23 inbound trunk port to the tagged set for the VLAN ID in said frame if, and only if. said<br>
	bridge is followed by another bridge m said routing path with a tagged or untagged<br>
	access port, and either,<br>
		said bridge has an encapsulated access port for said VLAN ID and no bridge<br>
	after it in said routing path, up to an including, said oiher bridge, has an encapsulated<br>
25	 access port; or<br>
30<br><br>
AMENDED PAGE<br>
		said bridge has a lagged or untagged access port for said VLAN ID, or said<br>
	bridge is preceded by another bridge rn said routing path with a tagged or untagged<br>
	access port<br>
5 		23. The protocol of Claim 20, wherein the outbound port of a trunk port is treated as:<br>
	a set of virtual, tagged access ports with one said tagged access port for each<br>
	VLAN supported by said trunk port;<br>
		a set of virtual, encapsulated success ports with ane said encapsulated access<br>
	port for each VLAN supported by said trunk port; or<br>
10 		a set of virtual, encapsulated or virtual, tagged access ports with one said,<br>
	ragged or encapsulated access port for each VLAN supported dy said trunk port.<br>
	24. A protocol or access link displacement In a bridged, cryptographic VLAN,<br>
	comprising bridges that support encapsulated segments, said protocol comprising<br>
15	 the steps of:<br>
		rccoyriizing an access port of a bridge of said bridged VLAN with which a<br>
	displaced access link can be associated, wherein said access port may be, virtual<br>
	and created automatically;<br>
		automatically assigning said access port In a LAN segment type based an a<br>
30	 segment type of said displaced access link; and<br>
		executing a transfer port protocol (TPP) for said bridged VLAN with said<br>
	access port belonging to said assigned LJ\N segment type,<br>
	25. A method for establishing a group security association for a cryptographic VLAN<br>
25	 comprising m stations, comprising the steps.of:<br>
31<br><br>
AMENDED PAGE<br>
		providing an encryption key K v, wherein said encryption key is a symmetric<br>
	key useti by v-aware bridges and station of v to encrypt and decrypt frames<br>
	belonging to v1<br>
		providing an authentication code key K¢ v, wherein all unaware bridges, and<br>
5	 station of v, compile and verify authemication codes over encrypted frames of v<br>
	using K¢ v,<br>
		providing a distribution key K¢¢ v; and<br>
		providing m random values R1, R2,.... Rm, wherein there is one random<br>
	value for each of said fn stations, wherein an ith station of said group knows all m<br>
10	 random values except Ri, wherein said m - 1 random vafyea that said ith station<br>
	knows are communicated to it by a v-aware bridge;<br>
		wherein privacy of said random values is ensured by errayption using said<br>
	distribution Key K¢¢ v, while their authenticity is ensured by an authentication code<br>
	computed over a resulting clphertext using said authentication code key K¢ v.<br>
15<br>
		26. A method for joining an encapsulated segment of a cryptographic VLAN,<br>
	compnsing the steps of:<br>
		addivig a new statort to a group; and<br>
		enabling all other stations in said group to eliminate said new station later<br>
20<br>
	27, The method of Claim 26, said step of adding a new station to a group further<br>
	comprisingthe step of:<br>
		a user' s station joining a cryptographic VLAN v through a mutual<br>
	authemication protocol executed between said user, via said user's station, and an<br>
25	 authentication residing on a v-aware bridge;<br>
32<br><br>
AMENDED PAGE<br>
		wherein if mutual authentication succeeds, a SECURE ephemeral channel is<br>
	created between said v-aware bridge and said new station to transfer an encryption<br>
	key K v, an authentication code key K¢ v, and m random values R1, R2, ..., Rm<br>
	securely from said v-aware bridge to said new station, in which case sard enabling<br>
5	 step executes."'.<br>
		otherwise, said protocol terminates immediately.<br>
	23. The method of Claim 27, said sfep of enabling all other stations in said group to<br>
	elimanate said new station later further comprising the steps of;<br>
10 		said v-aware bridge choosing a new random value Rrn+1 for said new station<br>
	and distributing said new random value Rm+1 to all v-aware bridges, and stations<br>
	comprising v, jn a broadcast frame that is encrypted under a distribution key K¢¢ v<br>
	and that carries an airthentication code computed over ciphertext using K¢ v;<br>
		said bridge then greatinig a new distribution key for v and ditributing said new<br>
15	 distribution key to all v-aware bridges and to members of vr including said new<br>
	station, in a broadcast frama that is encrypted under K v and thai carries an<br>
	authentication code computed over said crphertext using K¢v.<br>
	29, The method of Claim 281 wherein said new station can verify authenticity of a<br>
20	 broadcast containing its own random value Rm+1, but is unable to decrypt said<br>
	broadcast because it does not hold key K¢¢v.<br>
30. A method for leaving a cryptographic VLAN, comprising the steps of:<br>
		detecting with a v-aware bridge a subgroup of stations 1...k simultaneously<br>
25	 leaving a cryptographic VLAN v XXX<br>
33<br><br>
AMENDED PAGE<br>
		said bridge v-aware announcing the departure of said stations 1,.,., k via a<br>
	single broadcast frame that comprises an authenlication code computed over said<br>
	frame using an authentication code key K¢ v, wherein said broadcast notifies every<br>
	v-aware bridge and station in group v that stations 1,..,k have left;<br>
5 		each such bridge and station then attempting to rakey encryption,<br>
	authentication code, and distribution keys for v, each as a function ot an old key and<br>
	random values R1...., Rk, and<br>
		every v-aware bridge and all remaining stations in group v sharing a new<br>
	security association as a result, comprising k fewer random values.<br>
10<br>
	31 The method of Claim 30, wherein every v-aware bridge atways has a current<br>
	distribution key for v, and<br>
		wherein every v-aware bridge always has a complete set cf random values for<br>
	any subgroup that leaves group v, thereby allowing it to always rekey the keys for<br>
15	 group v.<br>
	32. The method of Claim 30,wherein for station rekeying is a function of random<br>
	values for departing stations that these stations do not have wherein said stations<br>
	are unable to rekey,<br>
20<br>
	33. The method of Claim 30, wherein a departed station can never become a<br>
	member of group vagain as a rasult of subsequent rekeyings because rekeying is a<br>
	function of current keys, and all keys arrived at there after are always a function or a<br>
	random value unknown to said departed station.<br>
25<br>
34<br><br>
AMENDED PAGE<br>
	34. The method of Claim 30, wherein a departed station can only become a member<br>
	of v again by rejoining v,<br>
5<br>
35<br><br>
The invention comprises there extention of the XXXX VLAN bridge moded. The first ectention is the cryXXX<br>
graphic separation of VLANs over XXX links. A LAN segment type reffered XXX as an encapXXX LAN segment is introduced. An.<br>
frames or sucha segment are encapsulated according to an encryption and XXX scheme. The second  extention is the: <br>
division of a trunk port into inbound and outbound ports. The third extention is a protocol that automatically XXX for each outbound<br>
port in a bridge  VLAN. a set of  LAN segment types for the port that minimizes the number of  transfer between encapsulated and <br>
unencapsulated segments required to transport a frame in the  bridge VLAN.<br></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
		<br>
		<div class="pull-left">
			<a href="216838-zinc-based-coated-steel-sheet-and-method-of-manufacturing-the-same.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="216840-2s-2-amino-4-2-ethanimidoylamino-ethyl-thio-butanoic-acid-and-the-process-for-preparation-thereof.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>216839</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>00751/KOLNP/2005</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>12/2008</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>21-Mar-2008</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>19-Mar-2008</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>28-Apr-2005</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>CRANITE SYSTEMS, INC</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>6620 VIA DEL ORO, 2ND FLOOR, SAN JOSE, CA 95119, UNITED STATES OF AMERICA</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>VOLPANO, DENNIS. MICHAEL</td>
											<td>22310 DAVENRICH STRFFT, SALINAS, CA 03908 UNITED STATES OI AMERICA.</td>
										</tr>
										<tr>
											<td>2</td>
											<td>ZHAO, XINHUA. J</td>
											<td>787 CORTO STREET, MOUNTAIN VIEW, CA 94043, UNITED STATES OF AMERICA</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04L</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/US2003/034855</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2003-10-30</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>10/286, 634</td>
									<td>2002-11-01</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/216839-a-method-for-extending-vlan-bridging-semantics-and-an-appartus-for-sending-frames-in-bridged-cryptographic-vlans by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 11:05:33 GMT -->
</html>
