<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/213955-a-method-and-system-for-providing-cryptographic-capabilities-to-a-plurality-of-network-users-over-a-decentralized-public-network by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 07:03:38 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 213955:A METHOD AND SYSTEM FOR PROVIDING CRYPTOGRAPHIC CAPABILITIES TO A PLURALITY OF NETWORK USERS OVER A DECENTRALIZED PUBLIC NETWORK.</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">A METHOD AND SYSTEM FOR PROVIDING CRYPTOGRAPHIC CAPABILITIES TO A PLURALITY OF NETWORK USERS OVER A DECENTRALIZED PUBLIC NETWORK.</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>THE INVENTION RELATES TO A METHOD FOR PROVIDING CRYPTOGRAPHIC CAPABILITIES TO A PLURALITY OF NETWORK USERS OVER A DECENTRALIZED PUBLIC NETWORK, THE METHOD COMPRISING : RECEIVING A REQUEST FOR AN ACCESS PERMISSION SECURITY PROFILE ON BEHALF OF A NETWORK USER; AUTHENTICATING THE REQUEST; CSREATING THE ACCESS PERMISSION SECURITY PROFILE, TO BE USED IN FORMING A CRYPTOGRAPHIC KEY FOR ENABLING THE NETWORK USER TO DECRYPT SELECTED PORTIONS OF AN ENCRYPTED OBJECT AND TO ENCRYPT SELECTED PORTIONS OF A PLAINTEXT OBJECT ; AND SECURELY TRANSMITTING THE ACCESS PERMISSION SECURITY PROFILE TO THE NETWORK USER OVER THE NETWORK.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>CROSS-REFERENCE TO RELATED APPLICATIONS<br>
This application claims the benefit of U.S. Provisional Application No. 60/225,796,<br>
filed 15 August 2000, and U.S. Provisional Application No. 60/239,019, filed 4 October<br>
2000, and claims priority to U.S. Nonprovisional Application No. 09/930,029, filed 14<br>
August 2001.<br>
FIELD OF THE INVENTION<br>
The invention relates generally to cryptographic techniques for secured distribution of<br>
data and information over a decentralized public network, and more particularly to web-based<br>
administration, management, distribution, and use of access permission credentials or codes<br>
in web-based security key management systems.<br>
I. BACKGROUND<br>
A. Traditional Public Key Infrastructure Systems<br>
The digital electronic age utilizes five fundamental elements for electronic security:<br>
privacy (symmetric encryption), authentication, non-repudiation, data integrity (proof of<br>
tampering), and authorization (access management). Currently used techniques in Public<br>
Key Infrastructure ("PKI), which are well-known in cryptography (see, e.g., Bruce<br>
Schneier, Applied Cryptography, John Wiley &amp; Sons, 1996, and tutorials at www.rsa.com<br>
and www.rsasecurity.com/products/keon/white papers), allow for secured transmission of<br>
information from point A to point B, providing authentication, non-repudiation and data<br>
integrity. Current PKI techniques, however, cannot provide the critical fifth element for<br>
electronic security: authorization. This lack of access management presents a particularly<br>
important problem for one class of users: large organizations such as government agencies<br>
and corporations, where thousands of users need instant access to millions of pieces of<br>
information-but where each person should only have access to the information to which he<br>
or she is specifically entitled.<br>
More specifically, traditional PKI systems have three major limitations:<br>
(a) Coarse-Grained Access. Traditional PKI systems do not provide a good one-to-<br>
many solution to accessing parts of an information repository. In addition, if an individual<br>
has access rights to read a file, document or database view, he or she has the right to read all<br>
of it, and not just some of it. In contrast, an ideal access control technology would allow<br>
SUBSTITUTE SHEET (RULE 26)<br>
different people to view different parts of a single report, plan, database query, or financial<br>
spreadsheet, and deny them access to other parts, (b) Centralized Security Adjudication.<br>
Traditional PKI systems have a negative impact on computer system performance because of<br>
the computationally intense nature of public key exponentiation, coupled with the centralized<br>
nature of security checking. When security servers or permissions servers are used to<br>
authenticate and police user information access, as the number of users and pieces of<br>
information in the system grow, they invariably become performance and single-point-of-<br>
failure bottlenecks, (c) No Standardized Access Credentials. Although a traditional PKI<br>
system can authenticate a user"s identity, it cannot determine what information that person is<br>
entitled to either create or access, i.e., the "authorization problem" of PKI.<br>
B. The CKM Cryptographic Standard<br>
Constructive Key Management ("CKM") is a cryptographic method for distributed<br>
cryptographic key management CKM has been adopted by the American National Standards<br>
Institute ("ANSI") as Standard X9.69, and addresses the authorization problem posed by<br>
traditional PKI systems. The details of the CKM, X9.69 ANSI standard is fully disclosed in a<br>
document entitled American National Standard for Financial Services, X9.69-1998,<br>
Framework for Key Management Extensions, American Bankers Association, 1998, and is<br>
incorporated herein by reference. U.S. Patent Nos. 5,375,169 and 5,787,173 also disclose<br>
details of CKM. CKM is exportable with any cryptographic algorithm or key length. Further<br>
details of CKM are discussed throughout this specification, as these details relate to described<br>
embodiments of the present invention.<br>
A commercially available implementation of CKM, offered by TECSEC, Inc.<br>
("TECSEC"), uses the X9.69 ANSI standard in a role-based access system to<br>
cryptographically control access to documents created and archived within an organization"s<br>
isolated, internal database. This role-based system allows database administrators to<br>
selectively grant access permissions to network users, called "members," according to each<br>
member"s individually assigned organizational role, rather than the member"s personal<br>
identity. Thus, if a user"s organizational assignment changes, his or her access permissions<br>
are also changed to reflect this new organizational role.<br>
Figure 1 shows fundamentals of CKM technology as illustrated on the<br>
wwrw.tecsec.com web site. CKM provides an encryption process by which an organization<br>
can manage the distribution and access of information using fine-grained, role-based,<br>
differential access permissions, by embedding access permissions within the encrypted object<br>
itself. Included in CKM is an encryption key generation process based on two sets of key<br>
types: Working Keys and Credential Keys.<br>
The key used in the encryption (and decryption) of a data object containing the<br>
information of interest is called the Working Key. It may be used as a session key or a<br>
message-encrypting key that is required by a symmetric encryption algorithm, such as 3DES.<br>
The working key-constructed from several pieces of information (called Values)-is used to<br>
encrypt the data object using a symmetric key encryption algorithm, and is then discarded.<br>
The values used in constructing the working key for encryption are also used to reconstruct<br>
the working key for decryption. The function that combines the values to create a working<br>
key is called the CKM Combiner and is central to the CKM encrypting process.<br>
Authorization to information is provided in CKM by using a set of "credentials,"<br>
which broadly relate to an individual"s access permissions. Credentials are used to form a<br>
Credential Key, which itself is used to encrypt working key information that is embedded in<br>
the data object"s file header (i.e., attached to the encrypted object). Asymmetric values (a<br>
Diffie-Hellman-generated key pair) are associated with each credential set Read/write<br>
separation is cryptographically available: read access is equivalent to public key decryption<br>
rights (using the private key), and write access is equivalent to public key encryption rights<br>
(using the public key).<br>
Access permissions are distributed to company employees as a "member profile,"<br>
which contains an individual"s credentials and pre-specified "domain" and "maintenance"<br>
values. The domain and maintenance values reflect, respectively, the employee"s<br>
organizational unit within the company, and a finite time period during which the employee<br>
may have access to company documents. The member profile also contains a file header<br>
encrypting key, algorithm access permissions (symmetric algorithm choices), and domain-<br>
specific policies. The member profile is generally contained on a removable cryptographic<br>
token (e.g., a smart card). Once member profiles have been distributed, encryption and<br>
decryption is controlled by the individual"s member profile.<br>
To illustrate the general concept of CKM, assume that management desires to post a<br>
memorandum to all employees on its company network which contains general information<br>
for all employees, but also includes confidential information to be viewed by managers only.<br>
With CKM, the portion of the document intended for all employees would be encrypted with<br>
an access permission credential that every employee possesses, including the managers; the<br>
portion of the document pertaining to management, however, would be encrypted using a<br>
credential limited only to managers. When employees download and decrypt the document,<br>
all employees would be able to view the common information, but managers would also be<br>
able to view the restricted information. This decryption process is seamless: with CKM, it is<br>
possible to have each user view a document or other on-line data object and yet not know that<br>
bis or her access permission (and, therefore, the information he or she is allowed to view)<br>
differs from other users.<br>
The principal disadvantage of existing CKM systems, however, is that CKM is<br>
conceived and designed to use two single-threaded, stand-alone computer systems-one for a<br>
member and one for an administrator. Existing CKM systems use a network only for<br>
transmitting encrypted objects among members and/or administrators, but not for performing<br>
administrative tasks. Existing CKM systems are not designed to take advantage of public<br>
networks, such as the Internet, to provide substantially enhanced capabilities, including:<br>
(a) making member profiles available instantly to all members, anywhere in the<br>
world, as well as being able to modify or turn off member profiles on very short notice (e.g.,<br>
hours or days versus weeks or months for CKM);<br>
(b) making administrative creation and maintenance functionality available to<br>
administrators positioned anywhere in the world, with only the possession of an Internet<br>
connection and a browser;<br>
(c) providing a logically centralized administrative function that facilitates easy<br>
protection from data loss, natural disasters, inside or outside security attacks, as well as easy<br>
centralized accounting and management capability for extremely large groups of members;<br>
(d) providing a logically centralized-but physically distributed-administrative<br>
function that allows all participants (members and administrators) to perceive a single point<br>
of contact with the system, but which is actually modular and physically distributed over<br>
several computer systems (servers) (both within a single network operating center, as well as<br>
distributed across multiple network operating centers located in different parts of the world);<br>
this brings substantial scalability (from a few hundred to several tens of millions of members,<br>
and from one to hundreds of workgroup administrators), and also allows geographical<br>
dispersion of both members and server systems, but without the physical limitations of the<br>
stand-alone, single-threaded CKM design of existing technology; and<br>
(e) providing a system design which is substantially more compatible with a broad<br>
number of Internet-based applications in the corporate information protection, content<br>
vending, entertainment, and telecommunications (wireless systems) fields.<br>
What is needed, therefore is a decentralized, public network-based method or<br>
apparatus that would provide at least all of the above-listed enhanced capabilities not present<br>
in existing CKM systems. An embodiment of the method or apparatus would further provide<br>
in-band methods for creating, administering, requesting and distributing member profiles to<br>
individual users of the system, as well as improved methods of authenticating users, thereby<br>
avoiding fraudulent or unauthorized access to data and information that is to be secured.<br>
II. SUMMARY<br>
A. A Web-Based CKM System<br>
The present invention directs itself to a cryptographic key management security<br>
method and apparatus, hereinafter referred to as "PXa3" (Precise extensible Authentication,<br>
Authorization and Administration). PXa3 provides a method and apparatus for secured<br>
distribution of data and information over a decentralized public network, such as the World<br>
Wide Web of the Internet (the "web"). PXa3 creates and maintains a web server account for<br>
each user, such that its basic mode of operation works over the Internet-both in terms of the<br>
internal administration of its various applications, and in terms of accessing the data files or<br>
other objects (or entire systems) that a PXa3 system secures.<br>
According to one aspect of the present invention, PXa3 offers methods for distributing<br>
data and information over a decentralized, public network to selectively permit access to on-<br>
line documents and other forms of digital content. In accordance with another aspect of the<br>
invention, PXa3 offers a method for controlling access to any form of secured system<br>
generally- be it physical (such as a company warehouse) or logical (such as a company<br>
computer network).<br>
PXa3 uses a member Security Profile, which is unique to a network user and a domain<br>
he or she belongs to. In a PXa3 system, a web site server system holds all private keys and<br>
certificates, along with the user"s security profile, which includes (among other things) the<br>
user"s access permission credentials and optional biometric templates. The PXa3 server<br>
system thus maintains a security profile for each user, and administrators are able to transmit<br>
credential updates and other periodic maintenance updates to the users via PXa3 server-based<br>
database accounts. These administrators (Domain Administrators and Workgroup<br>
Administrators) also perform their administrative chores via connection to the PXa3 web site,<br>
rather than on their local workstations, as is required in existing CKM technology.<br>
In one embodiment of the present invention, a member"s security profile-containing<br>
(at least) domain and maintenance values, a file header encrypting key, the member"s access<br>
permissions credentials, and domain-specific policies-is available from a central PXa3<br>
server as a downloadable "soft token" over any Internet connection. The soft token is<br>
downloaded as a set of multi-encrypted objects to a member"s client system after the member<br>
logs in to the web site and authenticates him or herself. Once downloaded, the soft token<br>
may remain encrypted on the client system"s persistent memory device, and cannot be<br>
decrypted except by the proper introduction of a member"s password (or other authentication<br>
process)-and then only the necessary portions of a security profile are decrypted when they<br>
are required.<br>
B. Improved Authentication Methods<br>
A PXa3 system of the present invention provides an improved authentication process<br>
over existing CKM systems. Thus, in a PXa3 system, domain and workgroup administrators<br>
log in and authenticate themselves periodically to the web site and administer roles, security<br>
policies and credentials to thousands of other network users (i.e., members), keeping the<br>
critical administrative information in a well protected and properly backed up web storage<br>
system that is accessible from anywhere in the world. Authentication strength for<br>
administrators and members can be anything from 1-factor security (a PIN or password), to<br>
2-factor (password plus a token or a biometric), to 3-factor (password + token + biometric),<br>
depending upon the needs of the organization. Time and a user"s physical location may also<br>
be used as authentication parameters.<br>
Members log into the web site at the beginning of each cryptographic session and<br>
authenticate themselves with the appropriate technology chosen by the organization. Once a<br>
session is open (as defined by retrieving a member token from the PXa3 web site) members<br>
work through their day creating or consuming encrypted data objects using their role-based<br>
credentials as maintained in their security profiles. Those profiles can be provided to the user<br>
as either a hard token (such as a smart card that is synchronized daily via a master profile on<br>
the PXa3 web server) or as a downloadable soft token that resides in a temporally limited way<br>
on the member"s client system; alternatively, the security profile can permanently reside as a<br>
soft token on the web server system, yet be accessible to the member for on-demand<br>
cryptographic needs over the web.<br>
C. Integration With PKI<br>
The use of PKI (Public Key Infrastructure) in PXa3 is conventional, and involves<br>
public key pairs and certificates for digital signing of CKM objects. Any standard PKI<br>
system from Entrust, Baltimore, Verisign and-others will work with the PXa3 system.<br>
D. Various Aspects Of The Present Invention<br>
According to one aspect of the present invention, PXa3 provides a method for web-<br>
based security management in which the administration, management and distribution of<br>
CKM security profiles is handled entirely over the decentralized public network of the<br>
Internet. In this aspect of the invention, selected groups of network users who are to be<br>
provided with cryptographic capabilities are first identified. Member accounts are then<br>
created for each network user in each identified group, and these member accounts are<br>
maintained on a single database. In order to create a security profile for each member, one or<br>
more access codes are established for each group of users. The access codes may be, for<br>
example, CKM credentials for defining role-based access permissions, which are adapted to<br>
be combined with other components to form a cryptographic key according to the X9.69<br>
ANSI standard. At least one security profile containing at least one access code is created for<br>
each member, and the security profile is stored in the user"s member account. A variety of<br>
administrative tasks are also defined for maintaining the member accounts. Such<br>
administrative tasks might include, for example, reporting member activities, system events<br>
and billing activities, and adding, removing and updating member accounts. In addition, a<br>
member token, which enables the member with cryptographic capabilities, is created relating<br>
to each security profile. The security profiles and related member tokens are secured, for<br>
example, via hard tokens, soft tokens, biometric identification, and/or a password and user<br>
ID. The member tokens are distributed over the network to individual network users upon<br>
authenticated request and according to each individual user"s security profile.<br>
In related aspects of the present invention, the administrative functions and/or the<br>
activities relating to creating member security, profiles are accomplished remotely over the<br>
Internet. Creating and distributing the security profiles and member tokens may be<br>
accomplished either manually by the user, or automatically (i.e., transparent to the user).<br>
In another aspect of the present invention, PXa3 provides a centralized security<br>
management system for administering cryptographic capabilities, mch as CKM working keys<br>
and/or security profiles, over the decentralized public network of the Internet. This aspect of<br>
the invention includes a set of server systems and member domains, where each member<br>
domain is maintained on at least one of the servers. One or more system administrators<br>
perform system maintenance tasks. Network users who are members of a domain are<br>
associated with that domain via a member account. A set of member security profiles, where<br>
each security profile is uniquely associated with a member account, provides cryptographic<br>
capabilities to the network user who is associated with that member account. The system also<br>
includes a set of administrative tasks for maintaining the member accounts, and domain<br>
administrators are able to perform these administrative tasks remotely over the network. The<br>
administrative tasks may include, for example, reporting and accounting tasks relating to each<br>
member account; domain administrators may further be divided into hierarchically structured<br>
groups, according to different levels of the administrative tasks.<br>
In related aspects of the invention, each member account includes member<br>
identification and authentication, as does at least one server system.<br>
hi another aspect of the present invention, PXa3 provides a web-based, client-server<br>
architecture for distributing cryptographic capabilities, such as CKM working keys and/or<br>
security profiles, over the Internet In this aspect of the invention, member tokens provide<br>
cryptographic capabilities to authenticated Internet users, and a set of server systems manage<br>
the distribution of these member tokens to individual client systems via the Internet. The<br>
client-server system includes a module for requesting a member token from at least one<br>
server system. Each individual client system includes a module for receiving the requested<br>
member token, and a module for utilizing the cryptographic capabilities provided by the<br>
member token. The client-server system also includes a module for securely distributing a<br>
requested member token from a server system to a client system over the decentralized public<br>
network of the Internet.<br>
In a related aspect of this invention, an authentication module resides on the client<br>
and/or server systems. In addition, a session manager on each client system provides<br>
individual users with the ability to request new or updated tokens, where the member token<br>
retrieval process may include either manually or automatically, updating the token.<br>
A further aspect of the invention provides a related method for distributing<br>
cryptographic capabilities to a plurality of network users over a decentralized public network.<br>
In this aspect of the invention, a request for an access permission security profile is received<br>
on behalf of a network user (and may be initiated in-band by the network user). The request<br>
is then authenticated via, for example, biometric identification, a hardware or software token,<br>
user location, time of the request, and/or a personal identification number. The method<br>
includes a step wherein an access permission security profile is created (this step may occur<br>
at any point in the process). The access permission security profile is used in forming a<br>
cryptographic key for enabling the network user to decrypt selected portions of an encrypted<br>
object. The security profile is then either (a) securely transmitted to the network user over the<br>
network, or (b) used to generate a cryptographic working key, in conjunction with<br>
information associated with an encrypted object, in which case, the working key is then<br>
securely transmitted to the network user over the network.<br>
In accordance with another aspect of the present invention, PXa3 provides a method<br>
and apparatus for cryptographically securing the distribution of information and associated<br>
cryptographic capabilities over a decentralized public network - such as the Internet - to a<br>
broad group of network users, In this embodiment, the information to be distributed is<br>
contained within one or more computer representable data objects. The data object(s)"s<br>
creator encrypts each object using a working key created from a set of access permission<br>
credentials. Each access permission credential ensures that only authorized users (i.e., those<br>
users who are in possession of the same set of credentials) are able to decrypt the encrypted-<br>
data object(s). Once so encrypted, the object(s) may be broadly transmitted over the network,<br>
without having to specifically target individually identified network users. On the decryption<br>
side, upon receiving an initial request for an access permission security profile (including<br>
credentials) on behalf of a network user, the system authenticates the request via, for<br>
example, the same authentication techniques as mentioned above. Once the request is<br>
authenticated, the access permission security profile (with credentials) is securely transmitted<br>
to the authorized network user over the public network, using any one of a variety of known<br>
encryption methods. In one embodiment of the present invention, the security profile may be<br>
set to expire at some future time, according to an expiration procedure that is preset by an<br>
administrator. Until such expiration, subsequent data object encryption or decryption may be<br>
carried out by means of the same security profile (and its included access permission<br>
credentials). No additional transactions will be required of the PXa3 web site until the<br>
security profile expires.<br>
According to another aspect of the present invention, PXa3 provides a method and<br>
apparatus for generally controlling access to a secured system. In this embodiment, the<br>
system to be secured may be, for example, a physical system, or a logical system;<br>
additionally, it may be either static or dynamic. As with the other embodiments of the<br>
present invention, the PXa3 system allows for selected portions of the system to be secured.<br>
The system also utilizes one or more groups of system users, who are to be allowed access to<br>
which secured portions of the system. An access code must also be established for each<br>
group. The access codes are then systematically assigned to the various secured portions of<br>
the system; each access code is adapted to be combined with other components to create a<br>
key for controlling access to the selected portions of the system. The access codes<br>
themselves are secured within the system using biometric identification methods, a smart<br>
card and personal identification number, or any other method for authenticating the user. The<br>
system then distributes the secured access codes to users of the system according to each<br>
user"s defined group.<br>
E. Advantages Of The Present Invention Over Existing CKM Technology<br>
There are a number of unique advantages to a web-based PXa3 system when<br>
compared to the standalone, enterprise network implementations of existing CKM systems<br>
prior to PXa3. These advantages include:<br>
(a) Mobility. A user or an administrator can travel the web and log in from anywhere<br>
to the PXa3 system, and only needs the appropriate authentication (e.g., user ID and<br>
password, biometrics, or smart card, depending upon the authentication choices the domain<br>
policy specifies). Assuming that soft tokens are authorized in the domain, a member may<br>
carry his portable computer with him and thus may only have to log in briefly once a day or<br>
once every other day to renew the soft token.<br>
(b) Scalability. A standalone CKM system consists of many separate workgroups<br>
within a domain, with each workgroup administrator separately responsible for installing and<br>
maintaining his or her system, and for providing workstation database backup. The drawback<br>
of such a system is that it is not very scalable, and it is likely that issues of overall systems<br>
management and administration, growth, data backup, or system memory or performance<br>
constraints will become problematic. The PXa3 system of the present invention, on the other<br>
hand, is extremely scalable (as user or administrator volume grows, simply add servers), and<br>
avoids problems of system performance and storage constraints, providing the ability to ramp<br>
up to large numbers of members virtually overnight.<br>
Furthermore, with respect to traditional PKI systems generally, PKI-only systems are<br>
inherently not scalable for applications such as the one-to-many information access<br>
management needs of medium to large organizations. The key and access management<br>
mechanisms for large PKI-based populations goes non-linear very quickly as the system<br>
grows. A PXa3 system, on the other hand, is an extremely scalable system that can grow to<br>
millions of users, where key and access management algorithms are always a linear function<br>
of the number of users.<br>
(c) Standards-based. The preferred embodiments of the present invention are based<br>
upon a host of standards, including the PKCS and ANSI X9.69 encryption standards, as well<br>
as BEA WebLogic, Oracle, J2EE and HTTPS. Such standards are well-known by one of<br>
ordinary skill in the art. These documents are incorporated herein by reference.<br>
(d) Cost and Convenience. Costs associated with implementing a PXa3 system are<br>
substantially lower than the costs associated with existing, competing technologies. The big<br>
expense in deploying CKM is not in the cost per seat or the smart card and reader, but rather<br>
in the ongoing training, systems integration, and administrative work necessary for setting up<br>
and maintaining the infrastructure-especially for domain authorities and workgroup<br>
administrators. Aside from reducing costs,, the decentralized, web-based approach of the<br>
present invention can provide a lot of additional convenience, including:<br>
1) A professional and readily accessible training tool (simply access the PXa3 site for<br>
training programs);<br>
2) An easy way to download necessary member and administrative software<br>
modules, and to ensure that each and every member always has the latest version<br>
of the PXa3 system authorized at the time;<br>
3) An easy way to set up and maintain domain and workgroup administrative<br>
functions-from anywhere; once the administrator"s work is done, all of the<br>
critical data is safely stored away at the PXa3 web server;<br>
4) No smart card hardware to install or integrate into the member"s client system;<br>
5) Demonstrations, trials and pilot tests can be created virtually overnight, since all<br>
that is required is that an account be set up and a domain authority appointed and<br>
trained, enabling him or her to set the domain security policies and create the<br>
appropriate credentials;<br>
6) The bureaucratic hassle associated with justifying a new security access<br>
management system within a large company can be avoided, since the web-hosted<br>
PXa3 service is "self-contained," easy to acquire and use, and available on a<br>
monthly or other periodic "rental" fee basis and can thus be purchased by lower<br>
management budget authority.<br>
7) Customer branding is facilitated through the design of the PXa3 user interface, and<br>
customers are allowed to select their own load balancer and firewall products.<br>
(e) Better security. A PXa3 system of the present invention has substantially less<br>
potential for illegal surreptitious access to administrative systems during off-hours, better<br>
authentication of the administrator(s), and much-reduced requirements for physical security<br>
of the main database of administrative and member information than existing CKM systems.<br>
Furthermore, a PXa3 system has rapid response for maintaining users and foiling security<br>
attacks (administrators can change anyone"s status immediately and thus reduce the risk of<br>
rogue users, whereas a rogue user with a standalone smart card system can continue to<br>
operate until the card times out-perhaps a month or so).<br>
In addition, the PXa3 system of the present invention preferably uses HTTPS for key<br>
exchange. This key exchange mechanism forms the basis for a secure Internet key<br>
distribution system. Mobile phone usage is one of the applications that can benefit from such<br>
a system. The modular design of the PXa3 server systems also provides strong security<br>
through firewall and isolation techniques, which makes it very difficult for attackers to gain<br>
access to the system.<br>
One embodiment of the present invention may additionally use smart cards or other<br>
tokens (hardware or software) at a member"s client system, requiring each member to log in<br>
to a central PXa3 server periodically, so that his or her smart card (or other form of token) can<br>
be synchronized with centrally maintained security profiles. In one embodiment, for<br>
example, PXa3 members utilize a biometric authentication function along with a smart card<br>
and PIN, delivering 3-factor security. This combination of web server and smart card<br>
provides a number of benefits that a standalone CKM system cannot provide, including high<br>
scalability of the administrative functions, better centralized security and backup protection<br>
of database information for members and administrators, and more precise control<br>
(synchronization) of member smart cards on a daily (or other time metric) basis.<br>
(f) Key recovery. PXa3 system architecture makes it possible for domain authorities<br>
to provide access to encrypted files for which key values may have been lost by members.<br>
This feature has two benefits: (1) organizations can encrypt their critical information without<br>
fear of loss due to lost keys; and (2) PXa3 satisfies the emergency access needs of criminal<br>
investigation and national security authorities (a court order can compel a workgroup<br>
administrator to recreate the necessary keys), and is thus easily exportable around the world.<br>
(g) Versatility. PXa3 is extremely flexible, is compatible with traditional public key<br>
infrastructures, and can be implemented with smart cards to hold member security profiles, or<br>
with a PXa3 server and soft tokens, or both. With PXa3, a member can travel to any Internet-<br>
connected location in the world and still operate in complete security, needing only his<br>
authentication characteristics (e.g., password, time, location, biometrics and/or smart card<br>
token).<br>
(h) Performance. Public key cryptography has a debilitating effect on computer<br>
performance, and centralized security/permissions servers typically end up becoming<br>
resource intensive bottlenecks, as well as single points of failure. PXa3 uses public key<br>
cryptography very sparingly, and delegates most of the cryptographic processing out to<br>
thousands of individual client devices (desktops, laptops, mobile phones, etc.), and not to<br>
centralized security or permissions servers. This means that PXa3 cryptography is hundreds<br>
of times faster than traditional public key-based cryptographic systems, and performance<br>
bottlenecks are not likely to appear in the system, no matter how large it becomes.<br>
III. BRIEF DESCRIPTION OF THE ACCOMPANYNG DRAWINGS<br>
Figure 1 illustrates the fundamentals of CKM technology (Prior Art).<br>
Figure 2 is a system overview of one embodiment of the present invention.<br>
Figure 3 illustrates the CKM encryption process used by the preferred embodiments<br>
of the present invention.<br>
Figure 4 is a flowchart for a process that one embodiment of the present invention<br>
follows.<br>
Figure 5 illustrates the concept of credential categories.<br>
Figure 6 is a flowchart for a process that another embodiment of the present invention<br>
follows.<br>
Figure 7 is a flowchart for a process that a third embodiment of the present invention<br>
follows.<br>
Figure 8 shows a higher-level aspect of one embodiment of the present invention.<br>
This figure relates to an overall client-server architecture, but focuses on the server side of the<br>
system.<br>
Figure 9 shows further detail of the server side, administrative architecture of one<br>
embodiment of the present invention.<br>
Figure 10 shows a three-tier, Internet implementation architecture for one<br>
embodiment of a web-based application service model of the present invention.<br>
Figure 11 relates to Figure 8, and shows one embodiment of the member client side of<br>
the system.<br>
IV. DETAILED DESCRIPTION<br>
PXa3 (Precise extensible Authentication, Authorization and Administration) allows<br>
the distribution of encrypted data objects from a distributor to a broad audience over a<br>
decentralized public network, where the distributor knows neither the identity nor the related<br>
access permissions of each member of the audience. PXa3 provides a basis for the secure<br>
broadcast and storage of sensitive material over a public network, such as the Internet or a<br>
cellular phone network. New members to the audience are authorized according to their<br>
credentials, which are assigned to the members by an administrative authority and securely<br>
distributed over the public network as well. PXa3 uses features of existing CKM technology<br>
that can take multiple encrypted data objects and encrypt them within another encrypted data<br>
object. This "object-within-an-object" feature provides PXa3 with the ability to selectively<br>
decrypt objects according to access permissions previously given to members.<br>
The following detailed description discusses the generic, underlying features of a<br>
PXa system, and describes of a number of embodiments of the present invention.<br>
A. The Underlying CKM Architecture For PXa3<br>
Figure 2 illustrates a system overview of one embodiment of the present invention,<br>
PXa3, which implements a general, web-based application service model for security<br>
management.<br>
1. The CKM Domain<br>
The highest unit of organization in a PXa3 System is called a CKM Domain 100. A<br>
CKM domain, such as domain 100, is a unique, independent entity that includes all CKM<br>
resources needed to function on its own. CKM security policies, procedures, credentials, and<br>
roles are all determined at the domain level. Although the largest unit of organization<br>
supported within CKM, a domain is folly scalable to a wide variety of needs. A CKM<br>
domain, such as domain 100, may be as large as an entire enterprise or as small as a single<br>
department. Small businesses would likely establish a single domain for the company, and<br>
large enterprises would establish many domains for major divisions, different locations, or<br>
other organizational structures. Individual users of a PXa3 system are called Members 105,<br>
which refers generally to the user"s membership within a domain.<br>
While domains are freestanding and independent, they do not need to be isolated.<br>
CKM domains may share access rights and privileges with other domains in a trusted<br>
relationship. Additionally, risers of a PXa3 system may participate as members of multiple<br>
domains, even if a trust relationship between the domains has not been established. The<br>
CKM domain may have a direct relationship with a PKI Certificate Authority (CA) 110, and<br>
preferably uses PKI for signing each encrypted data object by whomever has created or<br>
originated the object (the object"s "creator").<br>
(a) Trusted Domain Relationships<br>
In one embodiment of the present invention, domain 100 may provide specified<br>
access privileges to members of another domain by establishing a trust relationship. The trust<br>
relationship is established when one domain provides a subset of CKM credentials 115<br>
(elaborated below) to another domain. Preferably, CKM credentials are shared only at the<br>
(first) domain level, and thus should not be sent directly to members of another (second)<br>
domain until a trusted relationship has been established. Once trust has been established,<br>
however, the second domain maintains and distributes Imported Credentials using its own<br>
methods and policies, and these imported credentials are stored in its members" Security<br>
Profiles 120 (elaborated below), as part of each of its members" credentials 115. Once<br>
distributed, members of the second domain may use the imported credentials to share<br>
information with members of the first domain, but all members continue to be bound by the<br>
policies and procedures of the domain in which they hold actual membership (i.e., their<br>
LogOn Domain). When a PKI CA (Certificate Authority) 110 is included in this key<br>
management architecture, a third-party authentication model is added to the overall trust<br>
relationship.<br>
(b) Untrusted Domain Relationships<br>
An individual may be a member of several CKM domains regardless of whether the<br>
domains have established a trust relationship. That is, two or more domains may grant<br>
membership independently to the same individual. In this case, a PXa3 system sees the single<br>
individual as several members-one for each domain. In this type of untrusted relationship,<br>
the member can logon to each domain independently, using separate security profiles for each<br>
domain, and possess separate credentials to access information within each domain.<br>
(c) The Domain Authority and Security Officer<br>
A Domain Authority 125 provides top-level management to a CKM domain 100.<br>
Although a person or persons may assume the responsibility of the domain authority, many of<br>
the domain authority functions may also be automated. A Security Officer 126 is a "super"<br>
domain authority, who initially creates the domain authority(ies) 125 and otherwise initializes<br>
parameters of a domain 100, such as domain policies, etc. In one embodiment of the present<br>
invention, one security officer 126 per domain 100 is sufficient<br>
A domain authority 125 (and, at a higher level, the security officer 126) is responsible<br>
for performing a certain subset administrative tasks 315. For example, in one embodiment of<br>
the present invention, the domain authority 125 (and/or security officer 126) sets up a domain<br>
100 by performing the following functions:<br>
(a) Names the domain and creates its unique Domain Value (used in<br>
cryptographic functions);<br>
(b) Establishes and updates a number of Maintenance Values (used for revocation<br>
of a member"s access permissions, and to control information access to specific time<br>
windows);<br>
(c) Sets policy defining the outer parameters of the PXa3 system"s usage,<br>
including whether security profiles are smart card (token)-resident, PXa3 server-resident, or<br>
soft token-resident. (One of ordinary skill in the art will recognize that a "soft token" is a<br>
special ephemeral file that is not allowed to exist on a hard disk in unencrypted form. When<br>
brought into RAM, the soft token"s various individual parts still remain encrypted, and are<br>
only decrypted long enough to perform necessary operations.) In one embodiment of PXa3, a<br>
soft token allows the critical cryptographic functions of calculating working keys, and<br>
creating and verifying signatures, to be temporarily distributed to the member"s client system<br>
via a web-based technique that does not employ hard tokens (e.g., smart cards), thereby<br>
minimizing performance problems at the server. Also, in a web-based environment, the soft<br>
token allows a member to continue to operate for a (domain-settable) short time period, even<br>
though the network connection to the Internet server may have been disconnected (e.g., while<br>
traveling on an airplane);<br>
(d) Establishes Credential Categories (elaborated below), and may optionally<br>
digitally sign role-based credentials 115 (also elaborated below) within the credential<br>
categories, which are used to cryptographically control a member"s access to information;<br>
(e) Selects and optionally renames the cryptographic algorithms available in the<br>
domain;<br>
(f) Selects and configures Identification and Authentication data objects<br>
(elaborated below) that are available in the domain;<br>
(g) Registers workgroups and their administrators, through which credentials are<br>
distributed;<br>
(h) Digitally allocates and may optionally sign individual membership keys and<br>
authorizations related to initiating a member into the PXa3 system;<br>
(i) Registers and may optionally digitally sign CKM-enabled applications;<br>
(j) Creates and distributes Workgroup Profiles (elaborated below), which define a<br>
subset of credentials, permitted algorithms and the rights and policies to be enforced by a<br>
specific workgroup; and<br>
(k) Determines trust relationships with other domains.<br>
(d) The Domain Profile<br>
A Domain Profile 130 refers to all credentials, policy settings, and algorithm<br>
permissions established by the domain authority 125 and available within the CKM domain<br>
100. The domain profile 130 also includes the domain"s name and value, the maintenance<br>
value(s) (elaborated below), and other information identifying the domain.<br>
2. The CKM Workgroups<br>
A CKM domain 100 includes at least one (and usually several) Workgroups 140. A<br>
workgroup clusters members (or smaller workgroups) based on common needs and rights to<br>
information. In one embodiment of a PXa3 system, workgroups 140 are established so as to<br>
parallel departments, locations, projects, or other intuitive organizational, topographical, or<br>
logical subdivisions.<br>
(a) The Workgroup Administrator<br>
A Workgroup Administrator 145 (WA) typically manages the workgroups 140. The<br>
responsibilities performed at this level may be by a person interacting with software, or they<br>
may be automated in part or in full. In one embodiment, these responsibilities will include<br>
the following:<br>
(a) Refining policy settings (as allowed by fee DA) to provide further restrictions than<br>
those originally granted to the workgroup by the domain authority;<br>
(b) Registering individuals who become members of the workgroup;<br>
(c) Assigning subsets of credentials and access permissions available in the workgroup<br>
profile (further defined below) to individual member security profiles (also defined<br>
below);<br>
(d) Assigning, distributing and updating member security profiles to members.<br>
A PXa3 system thus allows members to receive credentials, policy settings, and access<br>
permissions as set up by the domain authority and distributed by the workgroup<br>
administrator.<br>
(b) The Workgroup Profile<br>
The Workgroup Profile 150 contains all credentials and access permissions available<br>
for distribution to members 105 of a specific workgroup 140. It also includes the policies<br>
governing the workgroup"s use of the PXa3 system. Workgroup profiles may differ from<br>
other workgroup profiles of the same domain, thereby defining the unique rights and needs of<br>
each workgroup 140 within a domain 100. As mentioned above, in one embodiment, the<br>
domain authority 125 creates workgroup profiles 150.<br>
3. The Member Security Profile<br>
Still referring to Figure 2, a member"s Security Profile 120 includes algorithm access<br>
permissions, credentials 115, domain and maintenance values, a file header encrypting key,<br>
optional biometric templates, and domain-specific policies (the algorithm access permissions<br>
together with the credentials provide a member with a set of access permission rights). If a<br>
companion PKI system is used, a "public" CKM membership key for each member is<br>
retained by the workgroup administrator 145 and is not posted for public use. The security<br>
profile 120 may also include the "public" CKM membership keys of the domain authority<br>
and workgroup administrator. The specific informational content of the security profile may<br>
vary, depending upon the actual implementation of the present invention, and yet remain<br>
within the scope of the present invention. For example, the security profile 120 may also<br>
include one or more global and workgroup membership (individual) PKI private keys and<br>
digital certificates used for encryption or signing in PXa3 and other cryptographic systems,<br>
plus optional member biometric templates. (One of ordinary skill in the art will recognize<br>
that a biometric template is a "shorthand" version of a biometric data file recorded by a<br>
sensor. A template is much smaller than the originally recorded data file, yet is precise<br>
enough to accurately represent that person in order to make comparisons to a stored<br>
"enrollment" biometric template, in order to verify a person"s identity.)<br>
In one embodiment of the present invention, a member"s security profile 120 is<br>
contained within a Member Token 122, which may take many forms. For example, a security<br>
profile 120 may be stored as an encrypted member token in volatile or nonvolatile storage on<br>
a member"s local client system device (a "soft token"), on a network server such as PXa3<br>
server, or on a physical member token such as a smart card. The preferred embodiments of a<br>
PXa3 system use individual Member Accounts 300 stored on a PXa3 Web Site 305 (where the<br>
web site 305 is configured with multiple servers, described in detail below). On each<br>
member account 300 is maintained a member"s security profile 120 for authorizing access to<br>
encrypted data objects. The member accounts 300 may also store other system permissions<br>
and information.<br>
For example, in one embodiment of the present invention, a member 105 logs into the<br>
PXa3 web site 305 and authenticates him or herself, typically via a user ID and a password. If<br>
the authentication is successful, a PXa3 server system will download an encrypted ephemeral<br>
soft token to the member"s client system (desktop, laptop, mobile phone, wireless personal<br>
digital assistant, etc.) which, after enrollment, will contain PXa3 client software. Once the<br>
soft token is safely deposited into the member"s client system, the member may use the PXa3<br>
system to encrypt or decrypt objects as he or she goes about bis or her daily business.<br>
This soft token process gives a member the ability to operate for a period of time<br>
without an Internet connection, since the soft token can perform all of the functions normally<br>
performed by a smart card (a "hard token"). The length of this ephemeral time period is a<br>
settable parameter selected by the domain authority 125 or other administrator, as is whether<br>
or not a member is entitled to soft token usage. With this system, members can be authorized<br>
for longer-lived soft token use when they are expected to be traveling or otherwise out of<br>
touch with the Internet ("roaming"). Once the soft token times out, the system no longer will<br>
encrypt or decrypt objects, and the member must log back into the PXa3 web site 305 and<br>
authenticate him or herself at the next session in order to download another encrypted soft<br>
token. Thus, in one embodiment of the present invention, a token synchronization module<br>
160 requires each member to log in to the PXa3 web site 305 periodically, so that his or her<br>
smart card (or other form of token) can be synchronized with centrally maintained security<br>
profiles 120. As mentioned above, in one embodiment, the form of a member"s security<br>
profile 120 is configurable by the domain authority 125. One of the policies carried within<br>
the domain profile 130 determines where the member security profiles are allowed to reside.<br>
4. Maintenance Values<br>
One embodiment of the present invention makes use of an existing CKM technology<br>
concept called a Maintenance Value. Preferably, a maintenance value consists of two levels:<br>
a Forward Maintenance Level (FML) and a Backward Maintenance Level (BML). The<br>
Forward Maintenance Level is used to deny a domain member access to CKM encrypted<br>
information beyond a specific point in time, while the Backward Maintenance Level is used<br>
to deny a domain member access to information before a specific point in time. In a PXa<br>
system, maintenance values therefore provide the ability to lock a domain member into a<br>
specific window of time. This time-based access control method allows the domain authority<br>
to specify and limit exactly what information a domain member will be able currently to<br>
access, as well as what information that member may see in the future. From a security<br>
standpoint, maintenance values thus allow the system to be re-keyed periodically.<br>
(a) Domain Maintenance Values<br>
In one embodiment, each domain 100 has a maintenance value referred to as the<br>
Domain Maintenance Value. The domain maintenance value includes a forward maintenance<br>
level and a backward maintenance level. These levels, however, may be updated<br>
independently, although the setting for the backward maintenance level may not generally<br>
exceed the setting for the forward maintenance level. The forward maintenance level for the<br>
domain should be thought of as the horizon-nothing for that particular domain may exist in<br>
the system beyond that point in time.<br>
(b) Member Maintenance Values<br>
Each domain member 105 is also preferably assigned a Member Maintenance Value<br>
that corresponds to one or more domain values. New members are given the domain"s<br>
current FML. The FML and BML settings for an individual member may also be updated,<br>
although these settings may not generally be greater than the domain maintenance value<br>
settings.<br>
B. The CKM Encryption Process<br>
1. Basic Overview Of The Encryption Process<br>
In the preferred embodiments of the present invention, the underlying CKM<br>
technology used by PXa3 is a distributed cryptographic key management system adopted as<br>
ANSI standard X9.69. Using the X9.69 ANSI standard, the preferred embodiments of PXa3<br>
construct a symmetric key called the Working Key, used to encrypt a data object. The CKM<br>
encryption process, shown in Figure 3, employs three key values that are used to construct<br>
the working key 200: a Domain Value 205, a Maintenance Value 210, and a Pseudo-Random<br>
Value 215.<br>
The domain value 205 is used as a system key that gives system access to everyone in<br>
the domain 100 (Figure 2). As described above, in large organizations, domains can be<br>
linked together via trusted relationships. Thus, in one set of embodiments of the present<br>
invention, the domain value 205 is distributed to all members 105 (Figure 2) of a domain 100<br>
(Figure 2) via the member"s PXa3 member account 300 and security profile 120 maintained<br>
therein.<br>
The maintenance value 210 is used to control domain membership by periodically<br>
updating the domain value 205 that is distributed to all currently authorized members. A<br>
workgroup administrator 145 may also eliminate undesirable members from future access to<br>
the system simply by updating the maintenance value to currently authorized individuals: as<br>
described above, the maintenance value 210 allows precise time frame control over access to<br>
data for specific members, since members can be given maintenance values corresponding to<br>
a fixed time period(s), during which they are allowed access. Thus, as mentioned above for<br>
one set of embodiments of the present invention, a member"s security profile 120 (maintained<br>
within a PXa3 member account 300) includes the maintenance value 210.<br>
The third value used to create a working key 200 is the pseudo-random value 215. A<br>
pseudo-random value 215 is automatically generated anew each time a data object 220 is<br>
encrypted, making the working key 200 a one-use key that is unique to each encrypted data<br>
object 220. In one set of embodiments, the working key itself is not stored, but is created at<br>
the beginning of the encryption process and discarded after use. It is subsequently recreated<br>
when needed for decryption purposes, but only by members with appropriate credentials.<br>
To segregate access to encrypted data objects among different groups of authorized<br>
members, the pseudo-random value 215 is secured by encrypting it with another key, which<br>
is assembled from specifically selected member credentials 225, referred to as Access<br>
Permission Credentials. Using member credentials in such a manner defines the readership<br>
for each encrypted data object: only those individuals having the access permission<br>
credentials that were used to form a Credential Key 230 in the encryption process can decrypt<br>
the pseudo-random value 215, which is necessary to create the working key needed to<br>
decrypt the encrypted data object 220. (Furthermore, and as elaboated below, access<br>
permission credentials 225 may exist and can be distributed to individual members<br>
independently of any data object encryption).<br>
Figure 3 further illustrates one process by which a data object is encrypted using<br>
existing CKM technology. A member 105 (Figure 2) creates a data object 220 (e.g. a data<br>
file containing confidential information) that may optionally be divided up into several<br>
embedded objects (e.g., file sections), for example 220a, 220b, 220c and 220d. (An<br>
undivided data object is considered to consist of exactly one embedded object). The member<br>
105 (Figure 2) then associates specific access permission credentials 225 to the objects based<br>
upon a right to know security policy, using the CKM encryption and credentialing process<br>
described above (i.e., using a working key, etc.). The encrypted data object 220 is then<br>
transmitted and/or stored via a decentralized, public network 330, just the same as if it were<br>
unencrypted. Every network user can conceivably reach the encrypted data object 220 over<br>
the public network 330, but only those members having a proper set of credentials 115 (i.e.,<br>
belonging to a specific set of Credential Categories) are able to decrypt and view the<br>
informational content contained within the embedded objects of encrypted data object 220<br>
and secured by the specific access permission credentials 225.<br>
2. Further Details of the Encryption Process<br>
(a) The Working Key<br>
One embodiment of the present invention utilizes a specialized function to generate<br>
the working key (defined above) called the CKM Combiner 232. In this embodiment, the<br>
role of the CKM combiner 232 is to create a working key from the domain, maintenance, and<br>
pseudo-random values, as described above. The CKM combiner 232 can accomplish this<br>
task in a variety of ways. For example, six different methods are described in the public<br>
document, American National Standard for Financial Services, X9.69-1998, Framework for<br>
Key Management Extensions, American Bankers Association, 1998. In one embodiment of<br>
the present invention, the CKM combiner 232 is obtained as a stand-alone software package<br>
offered by TECSEC (CKM, Version 5.1). Thus, it is not necessary to know the specific<br>
details of how the combiner function works in order to implement the various embodiments<br>
of a PXa3 system.<br>
As described above, the working key 200 is used to encrypt the actual data object 220.<br>
In one set of embodiments of the present invention, the working key encryption process uses<br>
a standardized triple DES (3DES) algorithm, although other algorithms may be used-for<br>
example, Rejndael, the new Advanced Encryption Standard (AES), or IDEA, or BEST, or<br>
Skipjack, or any number of other symmetric encryption algorithms. Preferably, the working<br>
key 200 is destroyed immediately after an object is encrypted. In CKM, information about<br>
the specific data required to reconstruct and apply the values, credentials, and other functions<br>
are include an encrypted header file 235 (associated with the encrypted data object), which<br>
any member 105 of the domain 100 can open. In one embodiment, the header 235 is itself<br>
encrypted with a header-encrypting key that is preferably managed through the same<br>
distribution scheme as the maintenance value and member credentials (e.g., distributed via a<br>
security profile 120 by a workgroup administrator 145 to individual member accounts 300<br>
situated at the PXa3 web site 305).<br>
Read and write access to an encrypted data object 220, as well as protection (through<br>
encryption) of the pseudo-random value 215 are preferably accomplished through an adapted<br>
Diffie-Hellman (asymmetric) process that creates pseudo-random value encryption keys<br>
(credential keys). A Diffie-Hellman static key pair is thus associated with each credential,<br>
and all the credentials are then used to generate a credential key using the Diffie-Hellman<br>
standard key generation algorithm, for encrypting and decrypting the pseudo random values.<br>
A member with an appropriate set of Diffie-Hellman public key-based credentials may<br>
encrypt data objects, and a member with the corresponding set of Diffie-Hellman private key-<br>
based credentials can decrypt those data objects. A member with both sets has both read and<br>
write access. This process results in other parameters that are also included in the member"s<br>
security profile 120, and an additional level of assurance within the CKM combiner<br>
functionality.<br>
(b) The CKM Header<br>
Still referring to Figure 3, a header file, called the CKM Header 235 (Figure 3), is<br>
available to decrypt the encrypted data object 220 (and created during encryption). The CKM<br>
header contains, among other things, the encrypted pseudo-random value 215 used in<br>
constructing the working key 200. In one embodiment, the CKM header is itself encrypted<br>
with a header key known to all members of a specific domain, so that the header file 235 for<br>
every encrypted data object 220 may be read by all members of a workgroup belonging to<br>
that domain. Note that the pseudo-random value 215 is not available to those without the<br>
proper set of cryptographic read access permissions for all the credential categories originally<br>
used in encrypting the data object.<br>
(c) The Object-Within-An-Object Encryption Process<br>
As described herein, data objects that are encrypted with the method and apparatus<br>
present invention may be divided up into separate objects, enabling, for example, a portion of<br>
a data file or document to be encrypted within a main file, using a working key that is<br>
different from the working key used to encrypt the main file. Any method of portioning the<br>
data file may be used, for example, those described in U.S. Patent No. 5,680,452, and<br>
incorporated herein by reference. The methods of encrypting various selected portions<br>
("embedded data objects") of a data file which are described in the above mentioned patent<br>
are well-suited to the present invention, and hence are utilized in various embodiments of<br>
PXa3.<br>
Using the preferred embodiments of PXa3, an encrypted data object can be as small as<br>
a single word within a file or a data field within a database view, query, or report. This<br>
Object-Within-An-Object feature places no constraints on an organization"s ability to apply<br>
CKM technology to its natural information segmentation-either when the data is at rest in a<br>
network-connected information repository, or while it is being transported across the network<br>
by several transport mechanisms (each providing a secure "object wrapper" around the object<br>
being transported). This feature is significantly different from existing PKI security methods,<br>
in which encrypted data objects can typically be no smaller than an individual file or database<br>
view.<br>
The object-within-an-object feature is convenient for several reasons:<br>
(a) When different people need to be granted different access permissions to data<br>
objects within a document or database, each unique data group (e.g., sections within a<br>
business plan) can be designated as one data object, which is included within a higher-level<br>
data object (the business plan). In this case, lower level data objects may be arranged within<br>
a higher level data object in a parallel fashion;<br>
(b) When different transport mechanisms are used to move a data object, each<br>
transport mechanism may "wrap" the data object it receives with its own set of credentials<br>
(e.g., a local police department message, encrypted under that department"s domain, then<br>
wrapped by the FBI domain on the Internet, and traveling over a State Department network,<br>
which wraps it again with a State Department CKM credentialing and encrypting process);<br>
(c) Alternatively, data objects may be organized in both hierarchical and parallel<br>
subdivisions, each architecture tracking the way in which an organization performs its<br>
mission. The object hierarchy can easily be adapted to fit almost any organization.<br>
Thus, one embodiment of the present invention presents a method for<br>
cryptographically securing the distribution of information over a decentralized public<br>
network - such as the Internet - to a broad group of network users. In this embodiment,<br>
shown in the flowchart of Figure 4, the information to be distributed is contained within a<br>
data object having one or more embedded objects (a single embedded object may correspond<br>
to the entire data object, depending upon the specific application of the invention) (step 400).<br>
The object"s creator encrypts these embedded objects by creating a set of access permission<br>
credentials that are selectively assigned to various embedded objects of the data object (step<br>
405); for example, encryption may be achieved using the CKM X9.69 ANSI standard.<br>
Each access permission credential ensures that only authorized users (i.e., those users<br>
who are in possession of the specific set of credentials) are able to decrypt those selectively<br>
encrypted embedded objects of the data object, allowing the now encrypted data object to be<br>
transmitted over the network in a secure fashion. Here, a user may be authorized in one of<br>
two ways. Initially, the user must obtain a set of access permission credentials (Branch A).<br>
Upon receiving a request for an access permission credential set on behalf of a network user,<br>
the system authenticates the request (step 410), preferably using a password, biometric<br>
identification (further described below), hardware or software token. Other authentication<br>
methods could also include time and place (location). Once authenticated, a security profile<br>
containing access permission credentials is securely transmitted to the authorized network<br>
user over the public network, using any of a variety of known encryption methods (step 415).<br>
Alternatively, the user may already be in possession of a security profile in the form of a<br>
valid hardware or software token (Branch B). In this case, the user is automatically<br>
authorized to decrypt the encrypted data object upon request for access (step 420). According<br>
to this method, the encrypted data object may be transmitted over the public network without<br>
having to target individually identified users (step 425).<br>
(d) The Credentialing Process<br>
The CKM X9.69 standard is used as an underlying encryption process in one<br>
embodiment of the present invention. The CKM X9.69 encryption standard is superior to<br>
other currently existing cryptosystems because it facilitates differentiated role-based access to<br>
large collections of digital information. The encryption process may be initiated at the time<br>
the data is entered into the system. For example, in a large reporting document (file) with<br>
many sections, each section, chapter, paragraph (or word) can be credentialed and encrypted<br>
differently from the others, according to the roles selected for read or read/write access.<br>
As mentioned above, in one embodiment of the present invention, credential<br>
categories (and the credentials within them) are defined by the domain authority 125 (Figure<br>
2). Figure 5 shows an exemplary set of credential categories (501,502,503,504,505) and<br>
the credentials within. In one embodiment, within any given set of credential choices,<br>
multiple credentials selected within a category are "ORed" together, while all category<br>
choices across multiple categories are "ANDed" together, to derive the single combined<br>
credential key 230 that is used to encrypt the pseudo-random value 215 (Figure 3). The<br>
Boolean ANDing and ORing processes of this embodiment include a cryptographic<br>
combining algorithm that takes a number of credentials and creates a single value, which is<br>
then used to encrypt or decrypt the pseudo-random value 215 using a public key encryption<br>
process.<br>
As an illustration (and still referring to Figure 5), a credential key 230 may be formed<br>
by the following function: [Business Secret] AND [Engineering OR Marketing OR Sales]<br>
AND [Directors] AND [Project C], where "Business Secret", "Directors" and "Project C"<br>
define selected credential categories 501,503, and 505 respectively, and "Engineering",<br>
"Marketing", and "Sales" are specific alternative credentials within a single category, 502.<br>
The Boolean function is used to define the access permission credentials 225 necessary to<br>
form the credential key 230. All credential categories included at the encryption of the<br>
information must be represented in the security profile 120 (Figure 2) of anyone wishing to<br>
access that information (via decryption). If only one required credential category is not<br>
represented, the unencrypted (plaintext) object will be inaccessible.<br>
In one embodiment, a member"s credentials 115 (Figure 3) maybe kept at the PXa3<br>
web site 305 (Figure 2) and working keys 200 (Figure 3) may be generated at the web site<br>
305 and securely transmitted to the member"s client system (e.g., personal computer, cellular<br>
phone or wireless personal digital assistant), thereby reducing the size of the client<br>
"footprint" at the member"s device and providing enhanced security, since the credentials 115<br>
would never need to be transmitted to member systems.<br>
Thus, one embodiment of the present invention presents a method for providing<br>
decryption capabilities to a plurality of network users over a decentralized public network. In<br>
this embodiment, shown in Figure 6, the system: (a) receives a request for access permission<br>
credentials on behalf of a network user (step 600); (b) authenticates the request (step 605); (c)<br>
retrieves a security profile from a PXa3 member account (step 610); and either (d) securely<br>
transmits the security profile (which includes the access permission credentials) to the<br>
network user over the decentralized public network (step 615), or (e) generates a working key<br>
using information contained within the security profile, along with information contained<br>
within the encrypted data file (step 616), and then securely transmits the working key over<br>
the public network (step 620). One of ordinary skill in the art will recognize, in light of the<br>
extensive description above, that the ordering of steps may be interchanged and modified.<br>
The method may further include the use of biometric identification (described below),<br>
hardware or software tokens, or time or location-based authenticating information.<br>
C. The Access Management Features of PXa3<br>
The CKM encryption process described above provides only one component of the<br>
access control and management features of PXa3. Because CKM is conceived and designed to<br>
use single-threaded, stand-alone computer systems for members and administrators, existing<br>
cryptosystems using the CKM X9.69 standard are not designed to take advantage of the<br>
accessibility, scalability and versatility of public networks, such as the Internet, to enable the<br>
distribution, administration, maintenance and use of member profiles. PXa3 is therefore a<br>
vast improvement over existing CKM systems, providing secure methods for creating,<br>
administering, requesting and distributing member profiles by and for individual users of the<br>
system over a decentralized public network, so that users (both administrators and members)<br>
may access and use the system from just about anywhere in the world. Since PXa3 operates<br>
over a public network, its access management features provide improved methods of<br>
authenticating users, thereby avoiding fraudulent or unauthorized access to the data and<br>
information that is to be secured.<br>
Thus, the present invention additionally contemplates a broader key management<br>
strategy to include a configurable identification and authentication capability along with a<br>
third party PKI trust authentication capability. (One of ordinary skill in the art will recognize<br>
that the essential part of PKI is a certificate that includes a verifiable digital signature, which<br>
is itself a mathematical hash of information that is then encrypted through an asymmetric<br>
(public key) process.) In one embodiment of the present invention, as illustrated in Figure 2,<br>
PKI authentication support is managed through either a smart card or a downloadable soft<br>
token, using PKI certificates 109 issued by a centralized Certificate Authority (CA) server<br>
110.<br>
In addition, credentials 115 may be associated with an application that defines one or<br>
more identity elements for a member 105, such as a biometric function, a smart card identity,<br>
a PIN/Password, or time and/or location parameters. Identity elements, in the form of an<br>
Identification and Authentication (I&amp;A) data object, are then bound to a primary encrypted<br>
data object through the underlying encryption process described above. In one embodiment<br>
of PXa3, the I&amp;A data object includes a PKI function that can authenticate a member to other<br>
members. The I&amp;A data object may also include other functions that must be stored secretly<br>
and which are included in the member"s security profile 120.<br>
Identification is the process of identifying a member. Authentication is the process of<br>
validating that identity. Still referring back to Figure 2, in one set of embodiments of the<br>
present invention, member accounts 300 include a Member Authentication element 155, and<br>
security profiles 120 are protected with an identity process: a member 105 must provide proof<br>
of identity before he or she can access his or her security profile 120.<br>
In one set of embodiments (represented by Figure 2), basic member authentication<br>
155 is provided via a user password 156. Additional authentication modes are provided via<br>
time and/or location 157, a smart card token 158 and/or a biometric scan (template) 159. In<br>
the case of a smart card-based system, the user inserts a smart card token into a reader and<br>
enters a password (PIN) when prompted.<br>
Biometric authentication (further described below) depends upon the type of sensor<br>
employed. For example, with BioID™ from DCS, a video camera and microphone are used<br>
to measure static facial contours, voice recognition, and lip movement while speaking a<br>
passphrase. Other biometric technologies rely on live scanning of fingers for fingerprint<br>
verification. Authentication occurs when the biometric template 159 (Figure 2) (a<br>
"shorthand" summary of the scanned data) is presented to a PXa3 server for matching to the<br>
template that was recorded when the user initially registered (a.k.a., "enrolled") with the<br>
workgroup administrator.<br>
As described above, in one embodiment of the present invention, a workgroup<br>
administrator 145 creates each member"s security profile 120. Among the data included in<br>
each security profile 120 is the member"s identification (user ID). Preferably, a member 105<br>
may not change the user ID supplied by the workgroup administrator 145. In one set of<br>
embodiments, each time a data object 220 (Figure 3) is encrypted, the user ID of the member<br>
who encrypted the data object (the "creator") is placed in the data object"s header file 235<br>
(Figure 3), so that each member having access to the data object 220 may also verify the<br>
identity of the creator. Trust is assumed since only a workgroup administrator 145 may issue<br>
security profiles 120, and only a workgroup administrator may designate user IDs.<br>
1. Biometric Authentication<br>
Referring back to Figure 2, in one embodiment of the present invention, the security<br>
process for a PXa3 member 105 is to use his or her PXa3 member client system 850 to request<br>
a download of his or her member security profile 120 from the PXa3 web site 305.<br>
Preferably, each time a member logs on and opens a session, he or she will need to<br>
authenticate him or herself. Upon successful authentication, the member"s soft token-<br>
resident profile will be downloaded to the member"s client system for subsequent use in<br>
encrypting and decrypting data objects.<br>
There are a number of biometric authentication technologies available today. As<br>
mentioned above, a new technology called BioID™ is now available that recognizes people<br>
through face, voice, and lip movement using a PC-based camera and microphone. The<br>
details of using this technology and how to acquire it is described on the BioID™ web site at<br>
www.bioid.com. To authenticate themselves, users look at a camera and speak a pre-<br>
registered "pass-phrase" detected by a microphone. Three modes of biometric recognition<br>
are possible: a static picture of the person"s face is taken and processed to recognize facial<br>
characteristics, relative to a pre-registered template of the person"s face taken during<br>
enrollment. In like fashion, the person"s voice speaking the pass-phrase is also transformed<br>
into a template and compared to the enrollment template, as are the lip movements speaking<br>
the pass-phrase (which are as unique as a fingerprint).<br>
BioID™ technology thus provides three modes of recognition: Face, voice and lip<br>
movement. This technology allows customers to select combinations from three different<br>
modes of biometric authentication. One mode (e.g., voice recognition only) may be used for<br>
most applications, because almost every computer system possesses a microphone. Two<br>
modes may be used for higher assurance applications and for situations where one of the<br>
modes is not operating properly due to a change in facial or voice characteristics. However, a<br>
video camera peripheral is required. All three can be required for the highest assurance<br>
applications.<br>
In one aspect of the present invention, a PXa3 system may provide a simple form of<br>
"one factor" authentication/security using a user ID and a password, while in a more<br>
sophisticated aspect, "two-factor" authentication/security may use a password and an easy<br>
biometric authentication process, such as voice recognition, or a hardware (hard) token.<br>
2. Revocation of Member Access Permissions<br>
Any cryptosystem must have the means to revoke a member"s access permissions.<br>
Revocation refers to preventing access to material encrypted subsequent to revocation. It<br>
does not refer to preventing access to material that has been encrypted during a member"s<br>
period of legitimate access. Once the decision to revoke is made, new encryption access<br>
denial should be as complete and rapid as security risks warrant.<br>
A PXa3 system preferably provides multiple means to revoke a member"s access<br>
permissions. Three PXa3 revocation methods of the preferred embodiments are listed below:<br>
(a) Profile expiration limits provide a routine, periodic method of removing<br>
member access, just as a credit card might expire. As security profiles 120 expire, they may<br>
simply not be renewed.<br>
(b) Updated maintenance values eliminate access to those members not in<br>
possession of the updated value. New maintenance values can have backward utility, so that<br>
material mat has been encrypted with a previous maintenance value may be decrypted with a<br>
subsequently issued one. The domain authority 125 may choose to issue a new maintenance<br>
value to some members, and not give it to certain other members, thereby revoking their<br>
access to future information.<br>
(c) A member"s security profile 120 may be turned off or modified at the PXa3<br>
web site 305 by an administrator (125,125 and/or 145), such that the next time that member<br>
logs in, his or her ability to use the system may be constrained or terminated.<br>
Thus, in a PXa3 system, security profiles 120 can be cancelled or changed at any time<br>
with virtually immediate effect, depending upon the expiration time limits set into an<br>
individual member"s security profile. Furthermore, as members 105 connect to the PXa3 web<br>
site 305 to use their security profiles 120 to access old content or create new content, their<br>
credentials 115 can be changed from the last access. This facility is particularly useful in<br>
responding to-or in preventing-certain security attacks by outsiders and/or former<br>
members, since all a workgroup administrator 145 must do to forestall such attacks is cancei<br>
a rogue member"s security profile. This is a more difficult problem for smart card-based<br>
systems without PXa3, since a rogue member could conceivably continue accessing encrypted<br>
data up until the security profile on the card finally times out<br>
To embody the above-described capabilities of the present invention, one exemplary<br>
configuration of a PXa3 system is further detailed below in sectior E.<br>
D. PXa3 System Application Examples<br>
1. Content Vending<br>
As the Internet and the mobile phone technologies begin to morph together into the<br>
mobile Internet, a number of new applications are exploding into the market. Many of these<br>
requiring one-to-many distribution security have to do with vending content-music, video,<br>
and information on a wide spectrum of interests-to multiple communities of consumers.<br>
Although there are many different types of content and many different communities of<br>
consumers, one example should serve to illustrate the concept: music clubs.<br>
Consider a media giant in the entertainment business with the following opportunity:<br>
it wants to offer a number of digital information subscription services to millions of consumer<br>
customers in a modem version of a music club. A consumer would sign up to become a<br>
member 105 of, for example, the classical music section of the music club, and would pay a<br>
monthly fee for the, e.g., "Classical Gold Membership". This would entitle that consumer-<br>
member to stream a digital music track from an Internet-based gold classical library over a<br>
wireless web system any time he wants to play it for his listening pleasure. Referring back to<br>
Figure 2, this consumer-member 105 would have a PXa3 member account 300 and<br>
appropriate credentials 115 for his section of the club (domain 100), along with downloaded<br>
PXa3 member client application software 850 for his "player devices." The music would be<br>
encrypted with the appropriate credentials. Thus, he could listen to any of the club"s<br>
"classical gold" library anytime he wanted, but could record none of it.<br>
Another model would allow him to download any music track he wanted for storage<br>
in his personal computer and replay it as many times as he wants, but he would be charged a<br>
fee (e.g., $1.00) for each track. In this model, the downloading device (personal computer)<br>
preferably has a large memory and a serial bus connection (e.g, a Universal Serial Bus<br>
cable), for downloading tracks into portable devices (e.g., a portable digital player) to and<br>
from the personal computer.<br>
In the above examples, the content vendor distributes music (i.e, data files 220,<br>
Figure 3) to paid subscribers (i.e., members 105, Figure 2). There are many other types of<br>
content, however, that can be sold with this same type of PXa3 security service to wired and<br>
wireless web consumer groups. Another example is location-specific information, such as<br>
traffic, weather, and food and lodging information for a geographic area surrounding a user"s<br>
current geographical position. Or, as another example, user-customizable information could<br>
be sold which facilitates business or leisure pursuits, such as river conditions for fly fishing or<br>
streaming play-by-play radio coverage for the Oakland A"s baseball games. A list of general<br>
subscription categories, though not exhaustive by any means, might include:<br>
General News<br>
Special interest news (e.g., fly fishing)<br>
Sports (news and play-by-play coverage)<br>
Financial news &amp; services<br>
Location-specific traffic, weather, and traveler info<br>
Directory listings<br>
Mobile entertainment (music, video games, video, lotteries/gaming,)<br>
Mobile ticketing<br>
Mobile medical records<br>
Field force automation<br>
Mobile supply chain management<br>
The content vending application of PXa3 is different from customary PXa3 corporate<br>
information management applications, in that it is designed to be more restrictive in the<br>
manner in which the content is distributed. For example:<br>
(a) members 105 typically only decrypt content 220 they retrieve from a web site<br>
305 or are sent via email;<br>
(b) members 105 typically are unaware of the underlying PXa3 technology,<br>
perceiving only that when they download a piece of content, they need simply click on a<br>
command or a file icon and the file becomes available in the normal plaintext (unencrypted)<br>
manner;<br>
(c) such content vending systems typically would not use PKI, because digital<br>
signatures are not required.<br>
Thus, the present invention provides a method and apparatus for distributing digital<br>
content over a decentralized public network, such as the Internet, to individual network users<br>
who subscribe to a content vendor service.<br>
2. Controlling Access To A Secured System<br>
The basic structure of a PXa3 system is well suited towards applications, such as the<br>
content vending application described above, in which the object to be secured is a computer-<br>
representable data object. However, this need not always be the case. A further embodiment<br>
of the present invention provides a method and apparatus for access to any secured system-<br>
for example, a physical system (such as an office complex), or a logical system (such as a<br>
computer network); the system to be secured may also be either static or dynamic.<br>
Such an embodiment, shown in Figure 7, utilizes the same underlying encryption<br>
features of the previously described embodiments. Portions of the system to be secured are<br>
selected (step 700). The system also utilizes one or more categories of system users, thereby<br>
defining which users are to be allowed access to which secured portions of the system (step<br>
705). An access code must also be established for each category (step 710). The access<br>
codes are then systematically assigned to the various secured portions of the system (step<br>
715), where each access code is adapted to be combined with other components to create a<br>
key for controlling access to the selected portions of the system.<br>
The access codes themselves are secured within the system, preferably using<br>
biometric identification, but may additionally (or alternatively) be secured through a variety<br>
of soft-token and/or hard-token (e.g., smart card) means, with or without the use of a user<br>
password/PIN, time or user location. The system then distributes the secured access codes<br>
over a decentralized public network to users of the system who are to be allowed access to at<br>
least one of the selected portions of the system (step 720). Again, the order in which any of<br>
these steps occur is not important, and may be modified. For example, the access categories<br>
may be established and users therein defined prior to selecting portions of the system.<br>
E. PXa3 Architectural Considerations For Web-Based Security Management<br>
Applications<br>
Implementing the above-described embodiments of the present invention, a preferred<br>
PXa3 system design is based on a client-server architecture networked across the Internet<br>
using HTTPS to support both browser-connected administration (for the domain and<br>
workgroup administrators) and local client applications (for each member, as well as for the<br>
administrators).<br>
1. System Configuration and Higher Level Design<br>
Figure 8 shows the preferred model architecture for a PXa3 server system 800<br>
operating a PXa3 web site 305 (Figure 2) and adaptable to all of the above-described<br>
embodiments of the present invention. The server system 800 comprises at least one PXa3<br>
web server 801, an application server 805, at least one database server 810, and a token<br>
generator 815. The web server 801, application server 805, and token generator 815 may be,<br>
for example, MS Win2000 Servers, which may be implemented on a single server computer,<br>
but is optimally implemented over a collection of servers. The database server(s) 810 may<br>
be, for example, Win2000 Advanced Servers). The database server(s) 810 is (are) preferably<br>
configured in an MS Cluster Server environment. In the preferred embodiments, operating<br>
system functionality for all servers is reduced to a minimum; for example, all unnecessary<br>
components such as IIS (since WebLogic Port 443 for SSL is used), telnet, and ftp may be<br>
removed.<br>
Preferably, a PXa3 server system 800 utilizes a multi-tiered application server<br>
implementation (further elaborated below). In the preferred embodiments, this<br>
implementation is founded on Java technologies (BEA WebLogic™ 6.0 Server, J2EE-<br>
compliant) running under the MS Windows 2000 operating system. The server database 810<br>
is deployed, for example, on Oracle 8.7 and is preferably accessed through Java Database<br>
Connectivity. These operating systems and applications software are only examples, and are<br>
by no means required in order to implement the present invention.<br>
As shown in Figure 8, a server (system) administrator 830 preferably maintains the<br>
PXa3 system servers) 800 by performing a set of maintenance tasks 311 (Figure 2). In this<br>
embodiment, a PXa3 server system 800 includes a web server browser interface for allowing<br>
PXa3 domain administrators (i.e., security officer 126 (Figure 2), the domain authority 125<br>
(Figure 2) and workgroup administrators 145 (Figure 2)) to perform their functions via a<br>
commercial web browser 831. Via this web browser 831, PXa3 server system 800 allows<br>
user credentials 115 (Figure 2) to be created and stored as part of a security profile 120<br>
(Figure 2) and member token 122 by the domain authority 125 (Figure 2) and/or workgroup<br>
administrators 145 (Figure 2) via the decentralized public network of the Internet 330, from<br>
anywhere in the world. Server administrators 830 also perform their system maintenance<br>
tasks 311 (Figure 2) via a commercial web browser 832.<br>
Still referring to Figure 8, the PXa3 server system 800 further includes an Internet<br>
accessible token interface 825 for retrieval of member tokens 122 from the database 810. In<br>
the preferred embodiments, member tokens 122 are retrieved from the secure central storage<br>
of database 810 to users" local systems (either administrator or member) via a secure delivery<br>
channel using SSL/HTTPS protocol.<br>
The security profiles 120 (Figure 2) and related member tokens 122 are stored in a<br>
secure central server database 810 and are only accessible by users with proper member<br>
authentication. Once in the secure storage, the member tokens 122 are accessed under two<br>
exemplary conditions:<br>
(a) When the member associated with a particular security profile requests a member<br>
token. In this case, the member token is delivered to the member"s client system via a secure<br>
delivery channel. The member gains access to the member token only after he goes through<br>
an authentication procedure as mandated by the security policy set by the domain authority.<br>
(b) When a domain authority or workgroup administrator modifies a member"s<br>
security profile. In this case, an administrator will retrieve a security profile/member token<br>
from the secure storage 810, modify the security profile/member token as required (e.g.,<br>
pursuant to a change in credentials), and return the security profile/member token to the<br>
secure storage. Alternatively, a new security profile/member token may be created to replace<br>
the old one in the secure storage. In the preferred embodiments, although an administrator<br>
has access to member security profiles, he does not necessarily have access to all the<br>
information contained within the security profile, since some fields in the member token are<br>
encrypted and only accessible by the member associated with that member token.<br>
(a) PXa3 Application Server Modules<br>
In the preferred embodiments, the PXa3 application server 805 is partitioned into two<br>
types of modules: basic functional modules and the auxiliary functional modules. The basic<br>
functional modules are modules responsible for the automatic token generation and retrieval<br>
features described above; the auxiliary modules provide further functionality that is assistant<br>
to the basic functionality and/or configurable by the PXa3 security officer 126 (Figure 2)<br>
(e.g., setting security policy or billing requirements). The auxiliary modules are non-<br>
interactive and therefore transparent to the system users.<br>
As shown in Figure 9, the basic modules in the PXa3 application server 805 include:<br>
(a) a member access and token retrieval module 930; (b) a domain administration access<br>
module 935; and (c) a server administration module 940.<br>
All communications between the different modules, should they happen over a public<br>
network, must be secured, regardless of whether they take place over the Internet or inside an<br>
intranet. For example, domain access control information must be included in information<br>
passed over module boundaries, so that each module does not have to independently verify<br>
domain information. Hence, the preferred embodiments use SSL (TLS) for securing such<br>
intermodule communication purposes. If SSI/TLS is not possible for any reason, a<br>
customized encryption scheme must be developed. Other protocols may be used in the future<br>
if a better solution becomes available or presents a more optimal alternative.<br>
In addition, to ensure maximum security, domain separation needs to be implemented<br>
within modules, as well as for communications among modules. In the extreme case, it may<br>
be necessary to have different web applications for the access modules of individual domains<br>
(alternatively, it may be sufficient to implement domain access control using an Access<br>
Control List ("ACL").<br>
Among the three basic modules (930,935, and 940), the first two actively interact<br>
with a client system-a communication protocol is therefore needed for each of these two<br>
modules. The third module-the server administration module 940- is used for PXa3 server<br>
setup, configuration and troubleshooting purposes. This module 940 may include a web-<br>
accessible server administration interface, or alternatively, server administration tasks 311<br>
(Figure 2) can be executed on an administrator"s local client system using scripts.<br>
(1) The Basic Functional Modules<br>
(a) Member Access and Token Retrieval Module. This module 930 handles member<br>
access and token retrieval requests. Member access to the database 810 occurs through a<br>
specially designed client system architecture, further elaborated below. In the preferred<br>
embodiments, the underlying protocol for member token retrieval is HTTPS, which ensures a<br>
seamless penetration of firewalls and proxy servers on the PXa3 system"s client side (both<br>
administrators and members).<br>
In the preferred embodiments, the member access and token retrieval module 930<br>
performs the following functions:<br>
1) receives client login and token-retrieval requests;<br>
2) checks and verifies domain information, if multiple domains are supported;<br>
3) checks the authentication specification for individual users, and if more information is<br>
needed, asks the client to supplement;<br>
4) conveys client requests to the authentication module (further described below);<br>
5) verifies the return from the authentication module;<br>
6) if authentication is successful, retrieves the requested member token 122 (Figure 8)<br>
from the secure database storage 810, and returns the member token to the requesting<br>
client using a secure delivery channel, using, e.g., SSL/HTTPS;<br>
7) if authentication fails, returns a generic failure message to the requesting client (to<br>
minimize information a hacker might receive during a hacking mission, a non-<br>
differentiating failure message is preferred for all authentication failures regardless of<br>
the cause); and<br>
8) requests the monitoring/reporting/logging service module to log all meaningful events<br>
for billing, auditing, access control, and system monitoring use.<br>
It.should be emphasized that this list of functional requirements is not meant to be<br>
either mandatory or complete; the list is meant simply to exemplify the basic functional<br>
requirements of the member access and token retrieval module.<br>
Also in the preferred embodiments, member access and token retrieval is handled in a<br>
stateless manner. In other words, the PXa3 application server 805 does not keep any client<br>
states when a member 105 (Figure 2) requests a member token 122 (on the other hand, the<br>
PXa3 member client 850 [Figures 2 and 11] might decide to keep a state for its own.use, but<br>
that state need not be conveyed to the PXa3 server in any way).<br>
A stateless procedure for the member access and token retrieval module 930 has at<br>
least two benefits. First, a stateless procedure is more efficient and scalable. The entire<br>
session of an individual member"s access and token retrieval may require no more than two<br>
rounds of exchange between the PXa3 member client 850 (Figures 2 and 11) and the PXa3<br>
server system 800 (Figure S), including the initial authentication round, but there may be a<br>
significant number of concurrent member accesses to a single PXa3 server (this is in contrast<br>
to the case of administrator access, which requires a significant number of rounds of<br>
exchange between the administrator"s client system and the server system in a single session,<br>
but normally does not have a large number of concurrent administrator accesses, even when a<br>
single server serves multiple domains). By using a stateless procedure to the member access<br>
and token retrieval module, the PXa3 server system 800 (Figure 8) is relieved from the burden<br>
of keeping states for each PXa3 member client 850 (Figures 2 and 11). In particular, when<br>
using a J2EE architecture, stateless session beans have much better performance and<br>
scalability than their stateful counterparts, since all instances of a stateless session bean are<br>
identical and can be pooled.<br>
The second benefit of using a stateless approach for the member access and token<br>
retrieval module derives from the fact that the code logic for both the client side and server<br>
side is simpler. This is especially true for the server side code, since the stateless approach<br>
can follow a pure client-server model-the information that is contained in each client<br>
request is sufficient for the server to process that request and to make a response. On the<br>
client code side, the client-server communications will still follow the HTTPS protocol, but<br>
because no states are maintained, no session tracking mechanism need be implemented in the<br>
code.<br>
Error checking and exception handling are important aspects of this module.<br>
Preferably, a reasonable timeout mechanism is also included, so that if no response from a<br>
particular server is received (e.g., from database storage 810) within a fixed period of time,<br>
the requesting client system is notified with an appropriate message. The timeout mechanism<br>
is preferably a two-stage process: after the first few timeouts, the server retries to fulfill the<br>
client requests and sends a status message to the client; after a preset number of timeouts has<br>
been reached, an error message is sent.<br>
In the preferred embodiments, the member access and token retrieval module 930<br>
communicates with PXa3 member clients 850 (Figures 2 and 11) following a member access<br>
protocol based on HTTPS. As a result, the natural choice of implementation framework for<br>
the communication interface is either HTTP servlets or JSP pages. The member access and<br>
token retrieval module 930 works seamlessly with the PXa3 member client application<br>
(Figures 2 and 11) installed on the user"s client device (e.g. desktop, laptop, mobile phone,<br>
wireless personal digital assistant, etc.). The present invention can be easily supported and<br>
upgraded. In particular, should any upgrade of the PXa3 application server 805 take place,<br>
the new server is still able to communicate with the earlier versions of the PXa3 member<br>
clients. The client-server communication protocol therefore includes a version negotiation<br>
mechanism, such that backward compatibility can be maintained. When dramatic protocol<br>
changes occur and client/server compatibility is no longer possible, the application server<br>
notifies the client system of the status, and the client system then prompts the user with<br>
enough information to update his client. It is therefore important that the communication<br>
protocol be defined in such a way that it is extensible, so that if in the future more<br>
functionality is required of this module, the protocol can be extended without affecting<br>
backward compatibility.<br>
(b) The Domain Administration Access Module. This module 935 handles domain<br>
authority and workgroup administrator access and administration requests. In the preferred<br>
embodiments, the domain administration ("DA") access module 935 uses a web browser to<br>
provide communication between the administrators (125,126, and 140, Figure 2) and the<br>
PXa3 server system 800 (Figure 8) to perform various domain and workgroup administration<br>
tasks. In the preferred embodiments, both Microsoft Internet Explorer and Netscape<br>
Navigator are supported. Preferably, the DA access module performs the following<br>
functions:<br>
1) receives client login requests;<br>
2) checks and verifies domain information, if multiple domains are supported;<br>
3) checks authentication specification for individual domain authorities and, if more<br>
information is needed, asks the client system to supplement;<br>
4) conveys client requests to the authentication module;<br>
5) verifies the return from the authentication module;<br>
6) if authentication is successful, sets up a session and directs the user to a default page,<br>
where he can start administration tasks;<br>
7) for any subsequent requests, calls the authentication module to verify the authenticity<br>
of the requests (details of how the authentication check is accomplished for<br>
subsequent requests after a domain authority has logged in are further described<br>
below);<br>
8) checks the state of a request in relation to the previous state, thereby developing a<br>
state machine for the domain authority access session, providing enhanced security;<br>
9) if necessary, updates database (all administration functions are preferably transaction<br>
based using, for example, a technology called Java Transaction Service ("JTS"),<br>
which provides a transaction management service to J2EE applications);<br>
10) if necessary, sends a token creation request to the token generator 815 (Figure 8) or<br>
updates the token creation queue (described in further detail below);<br>
11) performs transaction management, both within an Entity Java Bean ("EJB")<br>
framework 936 (Figure 9)and in relation to session tracking and state management;<br>
12) if authentication fails, returns a generic failure message to the client system (to<br>
minimize information a hacker might receive during a hacking mission; a non-<br>
differentiating failure message is preferred for all authentication failures, regardless of<br>
the cause);<br>
13) requests the monitoring/reporting/logging service module to log all meaningful events<br>
for billing, access control, and system monitoring use;<br>
14) terminates the session upon request from a domain administrator, or if the session has<br>
timed-out; and<br>
15) if a domain administrator of the same domain is already logged on, and only if the<br>
authentication check succeeds, prompts the user with a message telling him that<br>
another domain administrator is presently logged on.<br>
As with the member access and token retrieval module 930, all client-server<br>
communications for this module are SSL (HTTPS) based to ensure security.<br>
In general, domain administrators" security officer, (domain authority, and workgroup<br>
administrator) duties are to maintain domain security policy, maintain member data<br>
(including member roles and access permission credentials) and to create member tokens.<br>
In the preferred embodiments, token creation is a batch process, which enhances the<br>
scalability of the PXa3 system. As shown in Figure 8, token generation is preferably<br>
accomplished by a token generator 815, separate and apart from the PXa3 application server<br>
805. The token generator 815 is itself partitioned into two modules: a token burner 816 and a<br>
CKM token provider 817. In the preferred embodiments, the token provider is included in a<br>
commercially available product called CKM Version 5.1, offered by TECSEC. As described<br>
in further detail below, using the TECSEC CKM product for the CKM token provider 817, a<br>
member token file-including member account information, which is specific to the<br>
particular implementation of the present invention and contains the member"s security<br>
profile-is encrypted, hashed and then stored and/or transmitted upon request by the user.<br>
By separating the DA access module 935 (Figure 9) from the token generator 815<br>
(Figure S), data access via the DA access module is transaction based, and multiple<br>
concurrent accesses to the DA access module are allowed. Alternatively, the DA access<br>
module 935 and token generator 815 can be combined into a single module. By making the<br>
data accesses transaction based, domain authorities and workgroup administrators may access<br>
the database 810 concurrently with member accesses.<br>
Unlike the member access and token retrieval module, one embodiment of the PXa<br>
server keeps a state for each domain administrator access session (i.e., implements a<br>
"stateful" procedure for each access session). One reason for this difference arises from the<br>
fact that (a) a domain administrator access session may require multiple rounds of client-<br>
server exchange; and (b) the number of concurrent accesses is relatively small, even in the<br>
case of a single server serving multiple domains. Here, a stateful approach has the following<br>
advantages:<br>
1. Because of the relatively small number of concurrent domain administrator<br>
access sessions, the relief of the PXa3 server (and the client, which in this case is a web<br>
browser) from authenticating the client at each round may actually out-weigh the penalty of<br>
maintaining states for domain authority/workgroup accesses. In other words, in contrast to<br>
the member access and token retrieval module, a stateful approach may actually enhance<br>
performance and scalability.<br>
2. Since a state is kept on the server for each domain authority/workgroup access<br>
session, once a client is authenticated, it no longer needs to be authenticated on each<br>
subsequent request. Since authentication is done only once per login session, it is feasible to<br>
make the authentication process a more complex and more secure one than a stateless<br>
procedure would allow.<br>
3. In addition, by keeping a state of each domain authorityAvoTkgroup<br>
administrator access session, it is possible to develop a mechanism of access control based on<br>
the access session states, therefore enhancing the security of the PXa3 server system. Since<br>
domain authorities have greater access privileges on the PXa3 server than do individual<br>
members, more security, even at a small expense of performance, is always desirable.<br>
The DA access module 935 should be linearly scalable and efficient By separating<br>
this module 935 from the token provider module 817 Figure 8; (further described below) and<br>
consequently making token creation requests asynchronous, an acceptable degree of<br>
scalability is achieved.<br>
For the PXa3 server system 800, the DA access module 935 poses a usability<br>
challenge compared to the member access and token retrieval module 930. As mentioned<br>
above, the DA access module provides a dynamic, web page-based interface for facilitating<br>
administrative tasks. All established web design guidelines should therefore be followed to<br>
enhance usability. Among other things, the user interface for the DA access module should<br>
provide a sense of user friendliness, security and professionalism.<br>
(c) Server Administration Module. This module 940 handles server administration<br>
requests. PXa3 server administration is not to be confused with domain administration. A<br>
server administrator 830 (Figure 8) is responsible for the configuration, maintenance, and<br>
policy settings of the entire PXa3 server system 800, which may host multiple CKM domains.<br>
A domain administrator 125,126 or 140 (Figure 2), on the other hand, is responsible for tasks<br>
such as policy settings and membership maintenance of the particular domain for which he is<br>
responsible. In the preferred embodiments, there is one PXa3 server administrator, regardless<br>
of the number of CKM domains on the server system.<br>
On the other hand, PXa3 server administration is not to be confused with UNIX<br>
administration or network administration, either. Instead, it is confined to the tasks that are<br>
specific to a PXa3 system. In a sense, PXa3 server administration is a type of application<br>
layer administration-its purpose is to configure the specially-developed PXa3 applications<br>
which run on the PXa3 web servers, application servers and so on. The server administration<br>
module 940 (Figure 9) thus provides the following functions:<br>
1) creates, deletes, disables, and re-enables CKM domains;<br>
2) provides inter-server-addressing configuration functions (when a PXa3 server [a web<br>
server, application server, a database server or token generation server] is brought up<br>
or taken down, it is likely that low-level administration is called for; however, it is<br>
also likely thai some kind of application-level configuration needs to be done. A<br>
server administrator 830 can use the server administration interface to make<br>
configuration changes at the application level. For example, a JDBC driver may need<br>
to be changed if the database server is changed);<br>
3) provides database maintenance functions (some of these functions may be related to<br>
billing and auditing, yet some others may be simple database configuration functions);<br>
4) provides server security policy setting functions (e.g., when a data center hosts<br>
multiple CKM domains, the relationship among these domains preferably should be<br>
set by the server administrator 830);<br>
5) provides a diagnostic interface, which the server administrator 830 can use to<br>
diagnose problems with the system, should something go wrong with any of the PXa3<br>
servers (this functional requirement is closely related to a reporting and monitoring<br>
service [further described below]; in a sense, reporting/monitoring service is the<br>
dynamic side of a problem, and server administration is the static side of the same<br>
problem);<br>
6) provides an interface for the server administrator 830 to check statistical data, such as<br>
server usage (this information falls into two categories: (1) current server usage<br>
information, such as number of active sessions; and (2) historic server usage<br>
information); and<br>
7) sets up static load balancing (with extremely high volume member accesses, load<br>
balancing may need to be implemented in a hierarchical manner: at the top level, a<br>
static load balancing may be performed [static load balancing typically involves a<br>
simple request-dispatching algorithm, and is closely related to the partition of<br>
databases]).<br>
The above list is exemplary, and is not intended to represent either a mandatory or<br>
complete list of functions for the server administration module. In one embodiment, the<br>
server administration module 940 is web-based, although there is no requirement of web<br>
accessibility for this module.<br>
As with the DA access module 935, the server administration module 940 is also<br>
designed, in one embodiment, to be stateful, for the same reasons as stated above.<br>
Whether server administration is allowed to occur remotely or is restricted to local or<br>
LAN access is mainly a policy issue. Still, there are design considerations that need to be<br>
made. One possibility is for the server administration module 940 to listen to a different<br>
firewall port than 80 and 443. This port should be configured accessible only from certain<br>
machines within the LAN or as permitted by site security policy.<br>
One of ordinary skill in the art will recognize that, depending on the operating<br>
systems, web servers, database servers, and application servers involved, the procedure of<br>
server administration tasks may be performed differently, yet still remains within the scope of<br>
the present invention. Since a server administrator has the privileges to change server<br>
configuration parameters and therefore has the potential to damage the system, reliability is a<br>
great concern. For this reason, special attention should be paid to the design and<br>
development of this module, In addition, it is recommended that this module be implemented<br>
in a transaction-based manner. An action requested by the server administrator is either<br>
successful or has failed. Should an action fail, the server configuration should stay the same<br>
as if the action was never requested. Furthermore, it is desirable that the system remembers<br>
the last "good" configuration, so that the system can be restored to a working configuration,<br>
should the server administrator inadvertently change crucial configuration parameters and<br>
render the system nonfunctional. Preferably, the user interface should be designed with<br>
accident prevention in mind. For most user actions, confirmation should be required. The<br>
layout of the user interface should also be intuitive, to reduce the risk of mistakes. User<br>
inputs should be format-checked and the user prompted if any format error is found.<br>
(2) The Auxiliary Modules<br>
Also shown in Figure 9, auxiliary modules for a PXa3 server system include: (a) an<br>
authentication module 945; (b) a monitoring/reporting/logging service module 950; and (c) a<br>
billing/auditing service module 955. As discussed above, these modules provide assistant<br>
functionality to the PXa3 application server 805. These three modules are exemplary, not<br>
mandatory. Each auxiliary module"s functional requirements depend upon the commercial<br>
requirements of each implementation of the present invention.<br>
(a) Authentication Module. In the preferred embodiments of the present invention,<br>
this module 945 checks and verifies the authenticity of the requests from clients, both domain<br>
authority/workgroup administrator clients and member clients. The authentication module<br>
945 provides the following functions:<br>
1) accept authentication requests from other modules with user information and<br>
authentication data;<br>
2) access the database server 810 for an authentication template stored therein, according<br>
to an authentication requirement that has been set up by a domain<br>
authority/workgroup administrator or server administrator;<br>
3) verify user authenticity and return a Boolean result to the calling module accordingly;<br>
4) if a biometric authentication service from third party is used (or a time or location-<br>
based or hard token-based authentication mechanism), convey the authentication<br>
requests to the appropriate authentication service, receive the result from the service,<br>
and return the result to the calling module;<br>
5) for a subsequent request in a stateful session, check session validity and user<br>
authenticity with a customized authentication mechanism, and return the result to the<br>
calling module accordingly; and<br>
6) process user logout requests in a stateful session.<br>
In one embodiment of the present invention, the above list describes features that are<br>
mandatory for the authentication module 945; a complete list of features, however, will<br>
depend upon the specific implementation of the present invention.<br>
Authenticity checks are involved in the following two exemplary cases. First, an<br>
authenticity check is conducted when a request for a member token contains authentication<br>
data for initial verification. This case can be further divided into two sub cases: the first is the<br>
stateless scenario, as in the case of member access, when every request contains<br>
authentication data; the second is the case of an initial login of stateful access, such as<br>
domain authority access. What information is included depends upon the specific<br>
implementation of the invention and the security policy in place for that implementation, In most cases, at least domain information, user ID and PIN are involved. The design of this<br>
module, however, should remain extensible, to accommodate expanded methods of<br>
authentication, such as biometric identification.<br>
The second case in which an authenticity check may be conducted occurs when a<br>
request for a member token comes as a subsequent request for a stateful session, such as<br>
domain authority access or server administration access. In this case, it is likely that no<br>
authentication data is conveyed in the request Consequently, the authenticity of the request is<br>
verified with session checking and a customized authentication mechanism, such as cookies,<br>
servlet sessions, etc.<br>
It is important to note that the security of one-way SSL (HTTPS) is important for the<br>
purpose of preventing eavesdropping and server authentication, not for the purpose of<br>
preventing client masquerading. A certificate authority (CA) function may further be used to<br>
allow two-way SSL authentication.<br>
In the preferred embodiments, to ensure maximum security, the authentication module<br>
945 physically resides on the same machine as the modules for member access and token<br>
retrieval 930, DA access 935, and server administration access 940. Although one<br>
embodiment of the PXa3 server system 800 (Figure 8) is in a secured area, with only a web<br>
server 801 being directly accessible from the Internet, the security of the embodiment can be<br>
further enhanced by having the authentication module 945 run on the same Java Virtual<br>
Machine ("JVM") to take advantage of the Java security model.<br>
(b) Monitoring/Reporting/Logging Service Module. In the preferred embodiments of<br>
the present invention, this module 950 handles the following tasks:<br>
1) monitors the status of the servers;<br>
2) reports abnormalities to responsible person(s); and<br>
3) logs meaningful events (e.g, logs errors and exceptions to one or more log files;<br>
logs user events to a database).<br>
For the monitoring and reporting tasks, a third party commercial monitoring and<br>
reporting tool, such as SiteScope (Version 4.0 and above), offered by Freshwater Software,<br>
Inc., is adequate. If a third party tool is used, then one of ordinary skill in the art will<br>
implement the PXa3 application server to include hooks (and triggers) for the monitoring and<br>
reporting tool.<br>
Meaningful events that preferably should be logged mainly fall into two categories:<br>
(a) errors and exceptions; and (b) user events. Errors and exceptions are logged so that a<br>
server administrator can later diagnose server problems; user evenxs are valuable information<br>
for purposes such as billing, auditing and server performance evaluating.<br>
Depending upon the monitoring and reporting tool chosen, it may be desirable to<br>
leave the task of logging certain types of errors and exceptions to that tool. However, in most<br>
cases, it is desirable to have error logs in a single place. Furthermore, it is possible that the<br>
log of the chosen monitoring and reporting tool does not contain the exact information<br>
needed for diagnosing the PXa3 application server 805. As a result, it is preferred to log error<br>
and exception information independently of the tool. Error and exception logs are preferably<br>
stored in one or more log files.<br>
Naturally, error reporting and logging is closely related to exception handling and<br>
recovery. In the preferred embodiments of the PXa3 application server design, errors are<br>
categorized into three types:<br>
1) Fatal System Error: a system level error that renders a (sub-) system of the server<br>
unrecoverable without human intervention.<br>
2) Critical Error, an error that makes a function nonfunctional under certain conditions.<br>
Critical errors are normally unrecoverable unless the conditions change.<br>
3) Non-Critical Error: an error from which an automatic recovery is possible.<br>
hi the preferred embodiments, all fatal system errors should be logged, as well as<br>
most critical errors. In addition, all fatal system errors should be reported as well. Some<br>
critical errors should also be reported. Depending upon the specific implementation of a<br>
PXa3 system, it may also be desirable to log some non-critical errors, but in most cases, it is<br>
advisable not to log them if a recovery attempt succeeds.<br>
hi contrast, the preferred place to store user event information is in a database for the<br>
convenience of querying and sorting. Exactly what events need to be logged is more a<br>
marketing decision than a design decision, and thus depends upon the specific<br>
implementation of the present invention. In the preferred embodiments, the domain<br>
authority/workgroup administrator should be allowed to enable and/or disable user event<br>
logging. It is suggested that events be classified into three categories: required, desired, and<br>
optional. Only the events in the latter two categories should be able to be disabled by the<br>
domain authority/workgroup administrator. Events required for billing and auditing<br>
preferably should be given a required rating.<br>
It is extremely important that the monitoring and reporting service be reliable. False<br>
alarms are at best annoying, but failure to report a fatal error can be disastrous. When a non-<br>
critical error occurs, a recovery should be attempted. Under some conditions, the same error<br>
can occur recurrently. This is particularly true when the cause of the non-critical error is<br>
some other, undetected critical or fatal error. The preferred embodiments will therefore<br>
include a mechanism that upgrades to critical any non-critical error that repeats itself for a<br>
number of times during recovery. In such a case, further recovery attempts are abandoned<br>
and the user is informed.<br>
In most cases, non-critical errors need not be logged if recovery is successful. If user<br>
event logging is implemented, it is preferable to have a database connection pool of some<br>
kind to enhance performance.<br>
(c) Billing/Auditing Service Module. This module 955 provides a billing/auditing<br>
interface. In the preferred embodiments, the billing/auditing service module 955: (a) queries<br>
database tables for information, as dictated by established billing requirements at a preset<br>
time interval; (b) generates a billing report for the company offering (running) the PXa3<br>
service; and (c) stores the report in a database table or in a file.<br>
Like the server administration module 940, the billing/auditing module 955 is the<br>
static side of user event logging. In other words, the billing/auditing module 955 is the user<br>
of the user event logs. In essence, the billing/auditing service module is nothing but a web-<br>
based database application that makes use of the user event data logged by the<br>
monitoring/reporting/logging module 950. In the preferred embodiments, billing will be<br>
based on an active time-based subscription. As result, specific usage data of an individual<br>
user may have no significance to billing. Nonetheless, these data are still valuable for<br>
auditing purposes, and in the case that a customer organization may want to bill on a basis<br>
other than time periods {e.g., number of member accesses).<br>
Billing report generation, like any server maintenance tasks, must not impair the<br>
normal usage of members. Thus, in the preferred embodiments, so as not to impact normal<br>
usage of the server, billing reports are generated from a mirrored copy of the data. The<br>
operation of mirroring and synchronizing the data between the production copy and the<br>
mirror copy should preferably be scheduled to happen at a time when member usage is the<br>
lightest. It is recommended that this time be made configurable by the server administrator<br>
830.<br>
It is also advisable that generating a billing report does not take a prolonged period of<br>
time. It is desirable, for example, to generate a summary every day for that day"s activity,<br>
rather than do it all together at the end of each month, even if the billing cycle is one month.<br>
In the preferred embodiments, a mechanism to generate a monthly report based on the daily<br>
report is included.<br>
(b) Logical Configuration<br>
The PXa3 server system 800 (Figure 8) has a typical three-tier architecture,<br>
which is well known to one of ordinary skill in the art. As shown in Figure 10, at the front is<br>
a presentation tier 1025 that interacts with fee user directly; in the middle is a business logic<br>
tier 1030 where logic flow and data processing happens; in the back is a data tier 1035 where<br>
persistent data are stored. One of ordinary skill in the art will appreciate that, as in any<br>
typical Internet deployment, a firewall 1000 and load balancer 1005 are placed between the<br>
Internet 330 and one or more PXa3 web servers) 801. Preferably, an additional firewall 1010<br>
is placed between the application server(s) 805 and database and token generators (810 and<br>
815, respectively) to provide isolated physical subnets.<br>
This multi-tier design provides separation between various functional components of<br>
the PXa3 server system 800. With a well-defined interface between these tiers, each tier<br>
becomes a system component that can be developed and maintained separately. Thus, each<br>
tier can be scaled separately, which greatly enhances the scalability of the entire system.<br>
(1) The Presentation Tier<br>
A PXa3 system preferably uses a flexible user interface that may specifically be<br>
tailored to a wide variety of customer-branded look and feel requirements. Thus, the<br>
preferred embodiments of the present invention use a PXa3 server architecture design that<br>
segregates the presentation components from the business logic components: adopting a<br>
three-tier implementation affords customers flexibility in customizing everything from,<br>
background color to the icons associated with data presentation. Additionally, PXa3 frames<br>
can readily be embedded into existing customer pages.<br>
The presentation tier 1025 is the tier that interacts with the user. In a multi-tiered,<br>
web-based solution, the presentation tier consists of two sub-tiers. One sub-tier is a web<br>
client running on the user"s computing device, such as a desktop system. A typical example<br>
of such a client is a web browser, such as Internet Explorer or Netscape Navigator. The other<br>
sub-tier comprises web pages, which reside on a PXa3 web server 801 and are downloaded to<br>
the web client for display.<br>
In the preferred embodiments, what constitutes a web client sub-tier depends upon<br>
whether or not the user interaction is member access or domain authority/workgroup<br>
administrator access. In the case of member access, the web client is a specially developed<br>
client system of the present invention called a PXa3 member client 850 (Figure 11, further<br>
described below), specifically designed for member access. In the preferred embodiments, a<br>
PXa3 member client acts as an agent between a PXa3-enabled application (such as Microsoft<br>
Word) and the PXa3 application server, and retrieves a member token for the PXa3-enabled<br>
application from the PXa3 server system upon request. In the case of domain<br>
authority/workgrottp administrator access and server administration access, the web client is a<br>
web browser 831 and 832, respectively (Figure 8). Exactly which browser is used, however,<br>
is a minor issue that bears little consequence to the server design.<br>
In the case of DA access, for example, a domain authority may use a web browser to<br>
communicate with the PXa3 server system and to input member information and credentials.<br>
The browser transmits the information to the server system for the purpose of creating a<br>
member token. Selection of a web browser for this purpose can be any commercially<br>
available product, such as Internet Explorer or Netscape Navigator.<br>
In the preferred embodiments, the presentation tier 1025 (Figures 9 and 10) of the<br>
PXa3 web server 801 (Figure 10) includes various static HTML pages, JSP pages and<br>
servlets. With fee usage of EJBs and a J2EE based application server such as the BEA<br>
WebLogic server, it is preferred to minimize the usage of servlets, since the presentation<br>
functions are best fulfilled by JSPs and the business logic functions should be at the business<br>
logic tier 1030 (Figures 9 and 10) and performed by various EJBs 936 (Figure 9).<br>
With respect to the modules for the above described embodiments of the present<br>
invention, the member access and token retrieval module 930, DA access module 935, server<br>
administration module 940, and possibly the billing/auditing module 955 all relate in some<br>
way to the presentation tier 1025. (The billing/auditing module is a little special. In the case<br>
of multiple domains, it is expected that both the server administrator 830 and the domain<br>
administrators may need to check the billing/auditing records, albeit with different scope. In<br>
a more complicated scenario, it may be the case that the persons who have rights to checking<br>
billing records do not necessarily have administrative privileges. In any case, a web-based<br>
interface for billing/auditing record checking are present in the preferred embodiments.)<br>
(a) Presentation Tier Of The Member Access Module. In the preferred embodiments,<br>
the presentation tier 1025 of the member access and token retrieval module 930 (Figure 9)<br>
should provide at least the following functions:<br>
1) accept client requests in a format as defined by a member access protocol, and pass<br>
the requests to the business logic tier 1030 for processing; and<br>
2) obtain a return object from the business logic tier about the results of client requests,<br>
and present the results to the client in a format defined by the member access<br>
protocol.<br>
It must be stressed that, in the preferred embodiments of the present invention, the<br>
presentation tier 1025 of the member access and token retrieval module 930 is special, in that<br>
the web client part of this tier is not a browser-rather, it is specially designed for a PXa3<br>
system (further described below). As a result, the response to a client request need not follow<br>
HTML format, so long as the response can be understood by the PXa3 client (for example, the<br>
response follows a proprietary member access protocol and is HTTP-based). Hence, it is<br>
advisable that the presentation tier 1025 of the member access and token retrieval module 930<br>
be implemented in servlets rather than JSP pages.<br>
(b) Presentation Tier of the DA Access Module. In the preferred embodiments of the<br>
present invention, the presentation tier 1025 of the DA access module 935 (Figure 9) should<br>
provide at least the following functions:<br>
1) accept a client request in HTML format and as defined by a DA access protocol, and<br>
pass the request to the business logic tier 1030 for processing;<br>
2) get a return object from the business logic tier about the results of client requests, and<br>
direct the requesting user to the relevant URLs accordingly.<br>
It is recommended that the presentation tier 1025 of the DA access module 935 be<br>
implemented in JSP pages, since the DA web client is preferably a browser.<br>
(c) Presentation Tier For The Server Administration Module. In the preferred<br>
embodiments of the present invention, the presentation tier 1025 for the server administration<br>
module 940 provides at least the following functions:<br>
1) accept a client request in HTML format and as defined by a server administration<br>
protocol, and pass the request to the business logic tier 1030 for processing;<br>
2) get a return object from the business logic tier about the results of client requests, and<br>
direct the requesting user to the relevant URLs accordingly.<br>
It is recommended that the presentation tier 1025 of the server administration module<br>
940 be implemented in JSP pages, since (in the preferred embodiment) the web client is a<br>
browser. It is further recommended that the design of the presentation tier take into account<br>
the fact that, in the preferred embodiments, there are three independent web applications in<br>
the PXa3 application server 805 (Domain Access, Member Access and Server<br>
Administration). Thus, there should be a degree of separation among the presentation tier of<br>
the three web applications. Preferably, interaction between Web applications should occur at<br>
the business logic tier 1030 or perhaps at the data tier 1035, using a notification/messaging<br>
service such as the Java Messaging Service ("JMS").<br>
(2) The Business Logic Tier<br>
In the preferred embodiments of the present invention, the business logic tier 1030 of<br>
a PXa3 server system is implemented by various EJBs 936 (Figure 9) in a J2EE based<br>
application server. This tier is in the middle of the other two tiers in the PXa3 server system<br>
800. For this reason, the business logic tier is also called middle tier. In J2EE terminology, it<br>
is also called EJB tier.<br>
A J2EE based solution is easily portable from one platform to another. In particular,<br>
as long as the design and implementation of the PXa3 application server 805 follows the J2EE<br>
specifications, the PXa3 server solution can be deployed onto a number of different platforms.<br>
To date, various J2EE-based application servers are available from different vendors for<br>
many flavors of Unix and Windows platforms. For example, the WebLogic Server from<br>
BEA Systems is available for both Unix and Windows platforms, as well as the IBM<br>
WebSphere Server.<br>
In the preferred embodiments, all the six server modules (described above) are<br>
involved in the business logic tier.<br>
(a) Business Logic Tier Of The Member Access Module. In the preferred<br>
embodiments of the present invention, the business logic tier 1035 of the member access and<br>
token retrieval module 930 (Figure 9) performs at least the following functions:<br>
1) processes member client requests;<br>
2) checks the authentication information, and asks the member client for more<br>
information, if needed;<br>
3) in the event that a single application server hosts multiple domains, it checks the<br>
domain information for the member client and decides on the relevant database to<br>
query for the stored member information;<br>
4) conveys member information to the authentication module 945 (Figure 9) for<br>
verification;<br>
5) checks the return result from the authentication module 945, and decides whether or<br>
not the result has authenticated the member 105 (Figure 2);<br>
6) retrieves and delivers an appropriate member token 122 (Figure 8) if the member<br>
authentication has succeeded;<br>
7) prepares a response for the presentation tier 1025 to present to the member 105; and<br>
8) requests the monitoring/reporting/loggmg service module 950 (Figure 9) to log<br>
meaningful events.<br>
As described above, in the preferred embodiments of the present invention, member<br>
access is stateless. Hence, there is no need to store sessions in the business logic tier 1030 for<br>
the member access and token retrieval module 930 (Figure 9), and the member access session<br>
bean is a stateless one.<br>
(b) The Business Logic Tier For The DA Access Module. In the preferred<br>
embodiments, the business logic tier 1030 for the DA access module 935 (Figure 9) provides<br>
at least the following functions:<br>
1) processes DA client requests;<br>
2) checks the authentication information, and asks the DA client for more information if<br>
needed;<br>
3) if multiple domains are supported, checks the domain information to determine which<br>
relevant database to query for the stored DA information;<br>
4) conveys DA client information to the authentication module 945 (Figure 9) for<br>
verification;<br>
5) checks authentication result;<br>
6) sets up an administrative session after an initial login procedure succeeds;<br>
7) when necessary, makes requests to the token generator 815 (Figure 8);<br>
8) according to the return results from authentication module 945 (and, if applicable, the<br>
token generator 815), prepares a response for the presentation tier 1025 to present to a<br>
domain administrator (125,126, or 140; Figure 2);<br>
9) requests the monitoring/reporting/logging service module 950 (Figure 9) to log<br>
meaningful events; and<br>
10) cleans up the session after receiving a domain administrator logout request, or after<br>
being timed out.<br>
In one embodiment of a PXa3 server design, DA access is stateful. As a result, the DA<br>
access session bean is a stateful one.<br>
(c) The Business Logic Tier For The Server Administration Module. In the preferred<br>
embodiments of the present invention, the functions required for the business logic tier 1030<br>
of this module 940 (Figure 9) parallel those of the DA access module 935 (Figure 9), with<br>
two exceptions: first, in the server administration module, 940 there is no need to check<br>
domain information, because a server administrator 830 (Figure 8) does not belong to any<br>
CKM domain 100 (Figure 2); second, there is no need to call the token generator 815. Rather<br>
than these two functions, the server administration module 940 performs various server<br>
administration tasks. Thus, in the preferred embodiments of the present invention, the<br>
business logic tier 1030 of the server administration module 940 performs at least the<br>
following functions:<br>
1) processes administrator client requests;<br>
2) checks the authentication information, and asks the client for more information if<br>
needed;<br>
3) conveys administrator client information to the authentication module 945 (Figure 9)<br>
for verification;<br>
4) checks the returned result from the authentication module 945;<br>
5) sets up a session after an initial login succeeds;<br>
6) performs various server administration tasks (as described above);<br>
7) according to the results returned from authentication module 945 and the server<br>
administration tasks requested, prepares a response for the presentation tier 1025 to<br>
present to the server administrator 830 (Figure 8);<br>
8) requests the monitoring/reporting/logging service module 950 (Figure 9) to log<br>
meaningful events; and<br>
9) cleans up the session after receiving an administrator logout request, or after being<br>
timed out.<br>
In the preferred PXa3 server design, server administrator access is stateful. As a result,<br>
the server administrator access session bean is a stateful one.<br>
(d) The Business Logic Tiers Of The Auxiliary Modules. Referring to Figure 9, the<br>
authentication module 945, monitoring/reporting/logging service module 950, and<br>
billing/auditing service module 955 each execute all of their respective functions in the<br>
business logic tier 1035. Those functions are described above.<br>
As was mentioned before, the preferred embodiments of the present invention use<br>
three web applications in the PXa3 application server 805. These three web applications run<br>
in different virtual memory address space inside the same Java Virtual Machine ("JVM").<br>
Under some circumstances, these web applications need to interact with each other. Some of<br>
the interactions can be static, in the sense that one application stores a piece of information in<br>
a database, and another application queries the database for the information. More often than<br>
not, however, an application must communicate with another application dynamically. In<br>
this case, an application needs to notify another application about status changes that may<br>
affect the execution of that other application. For this reason, in the preferred embodiments<br>
of the present invention, interweb application communications are accomplished using the<br>
Java Messaging Service (JMS) of the J2EE platform.<br>
(3) The Data Access Tier<br>
The data access tier 1035 is where persistent data is stored, In the preferred<br>
embodiments, the data access layer provides support for concurrent multiple domains to<br>
reside within a single (or multiple) database server(s), in order to achieve an economically<br>
efficient and scalable deployment required for co-location facilities. If a customer desires to<br>
operate the service internally for performance or security reasons, then a single domain may<br>
be configured within a single database server.<br>
In the preferred embodiments, token generation is a batch process. Member tokens<br>
122 (Figures 2 and S) are preferably stored in a specially designed, secure file system. Also in<br>
the preferred embodiments, all domain-specific sensitive information is stored in encrypted<br>
form. Audit trails are constructed each time the database is modified by trapping both the old<br>
and new values using, for example, native Oracle database modification mechanisms. As<br>
described above, the preferred embodiments include a monitoring/reporting module 950<br>
(Figure 9) that provides historical logging on connections, token requests (including, for<br>
example, requests for member indemnification, timestamp, connection, and token served),<br>
and administrative changes.<br>
In the preferred embodiments, the data that is stored in the data tier 1035 is<br>
categorized into four types: (a) server configuration information; (b) domain information; (c)<br>
membership information; and (d) member tokens. For each category of data, a separate data<br>
access module is developed for efficient and secure data access.<br>
(a) Server Configuration Information. In the preferred embodiments, and in contrast<br>
to other information, server configuration information is stored in various files. The<br>
configuration properties in these files are loaded into the memory when the servers are started<br>
up. After being loaded into the memory, some application-specific information may be<br>
stored in an application-wide memory storage such as servlet context. By storing the server<br>
configuration information in files rather than a database, the risk of any server failure as a<br>
result of database failure is minimized.<br>
(b) Domain Information. In the preferred embodiments, domain information may be<br>
stored in database tables or ACL configuration files. It is also possible to store this<br>
information using Java Network Directory Interface ("JNDI").<br>
(c) Membership Information. In the preferred embodiments, membership information<br>
is stored in database tables. Depending on customer requirements and the specific<br>
implementation of the present invention, in the case of multiple domain support, the<br>
membership information database for different domains may be in separate tables in the same<br>
database, separate databases on the same database server, or on separate machines. Database<br>
access should be transaction-based, and it is recommended that Java Transaction Service<br>
("JTS") be used as the data access mechanism. This will ensure the data integrity and data<br>
consistency of multiple concurrent user accesses from multiple servers. However, one of<br>
ordinary skill in the art will recognize that with any well designed and developed database<br>
access mechanism, development and maintenance efforts are reduced.<br>
(d) Member Tokens. As described above, the preferred embodiments implement<br>
token generation as a batch process, instead of a real time process, so as to avoid a<br>
performance bottleneck of token generation. Thus, when a domain administrator requests<br>
that a member token be created, the request is first queued. Referring back to Figure 8, the<br>
token generator 815 later checks the queue and creates tokens (one method of token<br>
generation is described in further detail below). In the preferred embodiments, the token<br>
generator 815 also takes responsibility for storing the newly created tokens in the secure<br>
token storage of the database server(s) 810. As mentioned above, the preferred embodiments<br>
employ the TECSEC CKM 5.1 product as the token provider 817. The token generator 815<br>
creates a member token file from an individual"s member account information (including the<br>
member"s [access permissions] security profile 120) and stores it in encrypted form in the<br>
secure token storage of the database server(s) 810. Preferably, member tokens are stored in a<br>
specially designed file system. As a result, an internal token storage standard is defined so<br>
that both the token generator 815 and the member access and token retrieval module 930<br>
(Figure 9) can follow the same database convention.<br>
The database 810 also stores all information concerning the availability of an<br>
individual member"s token 122 (Figure 8). When a member token is available and is enabled<br>
for retrieval, the member access and token retrieval module 930 (Figure 9) retrieves the token<br>
and transmit it to the requesting member.<br>
2. The Member Client Design<br>
In the preferred embodiments, the administrator client implementation is designed to<br>
use commercially available browsers for the domain authority, workgroup administrator,<br>
server administrator and security officer functions. The member client application, however,<br>
preferably uses a specifically adapted design. Although in the preferred embodiments<br>
domain administrators (domain authority 125 and workgroup administrators 145) do not<br>
necessarily need to have a member client application 850 resident on their local computing<br>
device for administrative functionality, administrators may need it if they ever desire to<br>
encrypt or decrypt files, since a security profile 120 (and associated member token 122) is<br>
required for cryptographic capability. A browser-based implementation is, however,<br>
otherwise sufficient for the administration functions and their associated security-level<br>
requirements (as detailed above), and where scalability is less important.<br>
In the preferred embodiments, all client connections follow the HTTPS standard, and<br>
client requests are realized through form submissions, entered by a member via an on-line,<br>
user interface. Furthermore, in addition to SSL encryption, all PXa3 client-server<br>
transmission data is optionally encrypted at the application level with pre-defined encryption<br>
key selections, and there will be no key exchange process in the application level.<br>
Also in the preferred embodiments, the PXa3 member client package is packed into a<br>
self-extract Win32 executable Setup file, so that members can download and execute this<br>
Setup file via the web. Ideally, the package installation procedure records the changes made<br>
to the member"s client system, so mat the package removal procedure can reverse those<br>
changes. The package installation procedure will also copy the PXa3 token provider modules<br>
(described below) to the appropriate destination path(s), and set up all required Windows<br>
registry and desktop short cuts. The final step of the package installation will launch the<br>
member client application.<br>
One embodiment of an overall client architecture and its major component<br>
relationships are shown in Figure 11. A PXa3 member client application (system) 850 is<br>
available to be downloaded by a member 105 (Figure 2) as soon as a workgroup<br>
administrator 140 (Figure 2) has set up his or her member account 300 (Figure 2) at the PXa3<br>
web site 305 (Figure 2). The member client application 850 contains both a CKM Run Time<br>
Environment (including cryptographic libraries and functions) 855 and a PXa3 token provider<br>
860. The PXa3 token provider 860 further comprises: (a) a token retrieval module 861, which<br>
facilitates member access and server communication functionalities; (b) a session definition<br>
module 870, which provides for token expiration; and (c) a CKM token provider module 875,<br>
which enables encryption and decryption functionalities and provides for token file handling.<br>
The member client application 850 also works with a generic object encryptor 856,<br>
which performs the data object encryption and decryption, and various application plugins<br>
857 and other applications 858. In the preferred embodiments, the generic object encryptor<br>
856 will encrypt and decrypt any data object type, but would not deal with objects smaller<br>
than a complete file. A plugin, however, is designed to work within a specific application,<br>
such as, for example, Microsoft Word, so that objects can be designated as subset parts of a<br>
typical file, thus delivering on the fine grained promise of the present invention. The member<br>
client application also preferably includes an authentication module 880, for managing user<br>
authentication processes at the level of the member client system, and a user interface module<br>
885.<br>
In the preferred embodiments, the CKM token provider module 875 of the member<br>
client application 850 utilizes the commercially available CKM application offered by<br>
TECSEC, mentioned earlier, which implements the ANSI X9.69 encryption standard. The<br>
TECSEC product provides software for the both the CKM Run Time Environment ("RTE")<br>
855 and the CKM token provider 875 in the preferred embodiments of the member client<br>
application. This commercially available product provides a CKM runtime environment<br>
which includes: (a) utility software that allows members to locally manage their member<br>
tokens; (b) utility software to encrypt/decrypt a user"s CKM files; (c) TECSEC proprietary<br>
token provider software, used as the CKM token provider module 875 of the preferred<br>
embodiment; and (d) proprietary TECSEC runtime libraries and tools for developing a<br>
working interface between the TECSEC product and the specific implementation of the PXaJ<br>
member client application.<br>
Also in the preferred embodiments, a module called the "TXa3 session manager" 865<br>
manages the retrieval of member tokens 122 (Figure 8) from the secure central storage 810 of<br>
a PXa3 server system 800 to the member"s client system via a secure delivery channel. As<br>
described above, using the TECSEC CKM product as a CKM token provider 817 (Figure 8)<br>
within the token generator 815 (Figure 8) of the server system 800, a member token file is<br>
encrypted, hashed and then stored. The token file includes member account information,<br>
which is specific to the particular implementation of the present invention and contains the<br>
member"s access permissions security profile 120 (Figure 2). The member client application<br>
850 also includes a member token expiration mechanism (further described below).<br>
The member authentication module 880 of the PXa3 member client application 850<br>
initiates authentication (using any of the authentication schemes described previously) when<br>
a login function in the PXa3 token provider 860 is invoked. To ease the burden of the PXa3<br>
server system 800, the PXa3 member client application 850 also performs algorithms to<br>
protect against incorrect passwords used in the authentication process, according to a<br>
specifically established domain policy. For example, after a certain amount of wrong<br>
password attacks, the member token retrieval request is denied until a certain amount of<br>
elapsed time.<br>
Upon successful authentication, if there is no physical presence of the member token<br>
within the client system, or if the existing member token has expired, the PXa3 session<br>
manager 865 will attempt to retrieve the member"s latest token from the PXa3 server system<br>
800 via the Internet 330. In such a case, at least the following data will be sent to the PXa3<br>
server system to qualify the retrieval of a new member token via a "retrieve token request":<br>
1) the member"s domain name, indicating the domain to which mat the member belongs;<br>
2) a User ID and/or password, identifying the member for purposes of authentication;<br>
and<br>
3) a serial number, uniquely identifying the member"s client system (and is created<br>
during the member client package installation)<br>
Although the preferred embodiments invoke token retrieval automatically via the<br>
session manager 865, it is conceivable that members can also manually request to load a<br>
member token 122 via some other convenience tool, e.g., one provided by the commercial<br>
TECSEC CKM product. In either case, requests for member tokens occur in-band-in other<br>
words, a request is initiated (either manually by the user or automatically by the PXa3 session<br>
manager) using the same application currently running on the member"s client system, and<br>
the request is transmitted over the same communication network connection as that used by<br>
the PXa3 system to distribute encrypted data objects/digital content over the network.<br>
Additionally, in the preferred embodiments of the present invention, there are at least<br>
two types of requests from a member client to the PXa3 server system: one is a "retrieve<br>
token request," described above; the other is a "change password request". As described<br>
above, the "retrieve token request" may be sent either automatically by the PXa3 session<br>
manager, or manually by the member. The "change password request" is provided to allow a<br>
member to change his or her password on demand. This request passes a new password, a<br>
confirmed password, and all the parameters listed above as comprising the information<br>
included in "retrieve token request." If a "change password request" is successful, the PXa3<br>
server system returns a new member token with an updated password in effect. Other<br>
embodiments may provide for additional types of client-to-server requests (for example, a<br>
"recover request" initiated by a member for the purpose of recovering a forgotten password).<br>
In the preferred embodiments, the member client application includes a progress<br>
meter indicating the member token retrieval progress. Automatic retries are attempted if the<br>
member token retrieval communication between the PXa session manager 865 and the PXa3<br>
server system 800 is broken. After a successful member token retrieval, the member token<br>
will be stored in an appropriately defined location, along with the proper Windows registry<br>
modifications. In the preferred embodiments, the retrieved member token, comprising<br>
encrypted member security profile information, is "wrapped" within a data object conforming<br>
to the soft token requirements of the TECSEC CKM product before it can be used for<br>
encrypting/decrypting by the member.<br>
3. PXa3 Session Expiration<br>
A PXa3 session is opened upon a first request for a member token from the PXa3<br>
. server system. A session remains established (and is therefore defined) during the<br>
operational life of a member token within the PXa3 client system. A session terminates upon<br>
token expiration. In the preferred embodiments of the present invention, there are three<br>
levels at which member token expiration can be modified: (a) at the domain authority level;<br>
(b) at the workgroup administrator level; and (c) at the member level. Each level supports<br>
member token expiration based on, for example, one or more of the following criteria:<br>
1) a specified number of accesses to encrypted data objects (as, for example, free trials in<br>
the context of content vending);<br>
2) whether or not the member token is RAM-resident or stored in nonvolatile storage on<br>
the user"s client system (i.e., token expiration upon closing a CKM-enabled<br>
applications versus persistence of the token for future use, even after a CKM-enabled<br>
application has been closed);<br>
3) elapsed time; or<br>
4) flush on demand (i.e., a command to expire the token is explicitly made by the<br>
member).<br>
In the preferred embodiments, a member token is determined to be expired if any one<br>
of these expiration criteria is met at any level. Upon expiration, the member token is flushed<br>
and removed from the member client system, and a new token retrieval request is issued<br>
automatically by the PXa3 session manager. If the newly retrieved token is still determined 1<br>
be expired, then that token is also flushed and removed, and no more new token retrieval<br>
requests will issue until a configurable elapsed time has passed.<br>
In addition, one embodiment supports a token expiration mechanism that includes<br>
"member roaming" by a fixed date, or number of days and hours. The date and days are<br>
measured based on the date and time as perceived by the administrator"s time zone.<br>
While the foregoing describes a number of preferred embodiments and<br>
implementations of the present invention, a person having ordinary skill in the art will<br>
recognize that still other embodiments and implementations of the general technique for a<br>
web-based application service model herein disclosed are possible. It is therefore intended<br>
that the scope of the invention" be limited only by the claims appended below.<br>
WE CLAIM<br>
1. A method for controlling access to a secured system, the method comprising:<br>
(a) selecting (700) one or more portions of the system to be secured;<br>
(b) creating (705) one or more groups of system users, said groups<br>
defining which users are to be allowed access to which secured<br>
portions of the system;<br>
(c) establishing (710) one or more access codes for each group;<br>
(d) assigning (715) the access codes to the secured portions of the<br>
system, wherein each access code is adapted to be combined with<br>
other components to form a key for controlling access to one or more<br>
secured portions of the system.<br>
(e) securing (230) the access codes; and<br>
(f) distributing (720) over a decentralized public network (330) the<br>
secured access codes to users of the system who are to be allowed<br>
access to one or more of the selected portions of the system.<br>
2. The method as claimed in claim 1, wherein the secured system is a physical<br>
system.<br>
3. The method as claimed in claim 1, wherein the secured system is a computer<br>
network.<br>
4. The method as claimed in claim 1, wherein the secured access codes are at<br>
least partially secured through biometric identification.<br>
5. The method as claimed in claim 1, wherein the secured access codes are at<br>
least partially secured through a software token.<br>
6. The method as claimed in claim 1, wherein the secured access codes are at<br>
least partially secured through a hardware token.<br>
7. The method as claimed in claim 1, wherein the secured access codes are at<br>
least partially secured through a password.<br>
8. The method as claimed in claim 1, wherein the secured access codes are at<br>
least partially secured by the use of a record of time at which the request was<br>
made.<br>
9. The method as claimed in claim 1, wherein the secured access codes are at<br>
least partially secured by the use of a record of a user"s physical location.<br>
lO.Apparatus for controlling access to a secured system, comprising:<br>
(a) means (700) for selecting one or more portions of the system to be<br>
secured;<br>
(b) means (705) for creating one or more groups of system users, said<br>
groups defining which users are to be allowed access to which secured<br>
portions of the system;<br>
(c) means (710) for establishing one or more access codes for each<br>
group;<br>
(d) means (715) for assigning the access codes to the secured portions of<br>
the system, wherein each access code is adapted to be combined with<br>
other components to form a key for controlling access to one or more<br>
secured portions of the system.<br>
(e) means (230) for securing the access codes; and<br>
(f) means (720) for distributing over a decentralized public network (330)<br>
the secured access codes to users of the system who are to be<br>
allowed access to one or more of the selected portions of the system.<br>
11.The apparatus as claimed in claim 10, wherein the secured system is a<br>
physical system.<br>
12.The apparatus as claimed in claim 10, wherein the secured system is a<br>
computer network.<br>
13.The apparatus as claimed in claim 10, wherein the secured access codes are<br>
at least partially secured through biometric identification.<br>
14.The apparatus as claimed in claim 10, wherein the secured access codes are<br>
at least partially secured through a software token.<br>
15.The apparatus as claimed in claim 10, wherein the secured access codes are<br>
at least partially secured through a hardware token.<br>
16.The apparatus as claimed in claim 10, wherein the secured access codes are<br>
at least partially secured through a password.<br>
17.The apparatus as claimed in claim 10, wherein the secured access codes are<br>
at least partially secured by the use of a record of time at which the request<br>
was made.<br>
18.The apparatus as claimed in claim 10, wherein the secured access codes are<br>
at least partially secured by the use of a record of a user"s physical location.<br>
The invention relates to a method for providing cryptographic capabilities to a<br>
plurality of network users over a decentralized public network, the method<br>
comprising: receiving a request for an access permission security profile on<br>
behalf of a network user; authenticating the request; creating the access<br>
permission security profile, to be used in forming a cryptographic key for<br>
enabling the network user to decrypt selected portions of an encrypted object<br>
and to encrypt selected portions of a plaintext object; and securely transmitting<br>
the access permission security profile to the network user over the network.</td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTEyLWtvbG5wLTIwMDMtZ3JhbnRlZC1hYnN0cmFjdC5wZGY=" target="_blank" style="word-wrap:break-word;">112-kolnp-2003-granted-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTEyLWtvbG5wLTIwMDMtZ3JhbnRlZC1jbGFpbXMucGRm" target="_blank" style="word-wrap:break-word;">112-kolnp-2003-granted-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTEyLWtvbG5wLTIwMDMtZ3JhbnRlZC1jb3JyZXNwb25kZW5jZS5wZGY=" target="_blank" style="word-wrap:break-word;">112-kolnp-2003-granted-correspondence.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTEyLWtvbG5wLTIwMDMtZ3JhbnRlZC1kZXNjcmlwdGlvbiAoY29tcGxldGUpLnBkZg==" target="_blank" style="word-wrap:break-word;">112-kolnp-2003-granted-description (complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTEyLWtvbG5wLTIwMDMtZ3JhbnRlZC1kcmF3aW5ncy5wZGY=" target="_blank" style="word-wrap:break-word;">112-kolnp-2003-granted-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTEyLWtvbG5wLTIwMDMtZ3JhbnRlZC1leGFtaW5hdGlvbiByZXBvcnQucGRm" target="_blank" style="word-wrap:break-word;">112-kolnp-2003-granted-examination report.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTEyLWtvbG5wLTIwMDMtZ3JhbnRlZC1mb3JtIDEucGRm" target="_blank" style="word-wrap:break-word;">112-kolnp-2003-granted-form 1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTEyLWtvbG5wLTIwMDMtZ3JhbnRlZC1mb3JtIDE4LnBkZg==" target="_blank" style="word-wrap:break-word;">112-kolnp-2003-granted-form 18.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTEyLWtvbG5wLTIwMDMtZ3JhbnRlZC1mb3JtIDIucGRm" target="_blank" style="word-wrap:break-word;">112-kolnp-2003-granted-form 2.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTEyLWtvbG5wLTIwMDMtZ3JhbnRlZC1mb3JtIDI2LnBkZg==" target="_blank" style="word-wrap:break-word;">112-kolnp-2003-granted-form 26.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTEyLWtvbG5wLTIwMDMtZ3JhbnRlZC1mb3JtIDMucGRm" target="_blank" style="word-wrap:break-word;">112-kolnp-2003-granted-form 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTEyLWtvbG5wLTIwMDMtZ3JhbnRlZC1mb3JtIDUucGRm" target="_blank" style="word-wrap:break-word;">112-kolnp-2003-granted-form 5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTEyLWtvbG5wLTIwMDMtZ3JhbnRlZC1sZXR0ZXIgcGF0ZW50LnBkZg==" target="_blank" style="word-wrap:break-word;">112-kolnp-2003-granted-letter patent.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTEyLWtvbG5wLTIwMDMtZ3JhbnRlZC1yZXBseSB0byBleGFtaW5hdGlvbiByZXBvcnQucGRm" target="_blank" style="word-wrap:break-word;">112-kolnp-2003-granted-reply to examination report.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTEyLWtvbG5wLTIwMDMtZ3JhbnRlZC1zcGVjaWZpY2F0aW9uLnBkZg==" target="_blank" style="word-wrap:break-word;">112-kolnp-2003-granted-specification.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTEyLWtvbG5wLTIwMDMtZ3JhbnRlZC10cmFuc2xhdGVkIGNvcHkgb2YgcHJpb3JpdHkgZG9jdW1lbnQucGRm" target="_blank" style="word-wrap:break-word;">112-kolnp-2003-granted-translated copy of priority document.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="213954-combing-machine-with-an-oscillating-nipper-aggregate.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="213956-a-process-for-the-catalytic-epoxidation-of-olefins-with-hydrogen-peroxide-in-a-continous-flow-reaction-system.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>213955</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>112/KOLNP/2003</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>04/2008</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>25-Jan-2008</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>23-Jan-2008</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>29-Jan-2003</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>VIAQUO CORPORATION</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>2460 N. FIRST STREET, SUITE 280 SAN JOSE, CALIFORNIA 95131</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>SWEET, WILLIAM B.</td>
											<td>3415 OAKWOOD COURT, MORGAN HILL, CALIFORNIA 95037</td>
										</tr>
										<tr>
											<td>2</td>
											<td>YU, JOHN, J.</td>
											<td>770 WOODSTOCK LANE, LOS ALTOS, CALIFORNIA 94022</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04L 28/06</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/US01/25730</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2001-08-15</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>60/225,796</td>
									<td>2000-08-15</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/213955-a-method-and-system-for-providing-cryptographic-capabilities-to-a-plurality-of-network-users-over-a-decentralized-public-network by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 07:03:39 GMT -->
</html>
