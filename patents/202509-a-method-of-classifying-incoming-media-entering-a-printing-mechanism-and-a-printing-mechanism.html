<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/202509-a-method-of-classifying-incoming-media-entering-a-printing-mechanism-and-a-printing-mechanism by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 00:33:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 202509:A METHOD OF CLASSIFYING INCOMING MEDIA ENTERING A PRINTING MECHANISM AND A PRINTING MECHANISM</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">A METHOD OF CLASSIFYING INCOMING MEDIA ENTERING A PRINTING MECHANISM AND A PRINTING MECHANISM</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>A system of classifying incoming media entering an inkjet or other printing mechanism is provided to identify media without requiring any special manufacturer markings. The incoming media is optically scanned using a blue-violet light to obtain both diffuse and specular reflectance data, from which a media signature is generated. The generated signature is compared with known signatures for different media types to classify the incoming media, and a corresponding print mode is selected. Finally, the selected print mode for the classified incoming media is stored for future reference. Thus, a consumer can teach the printing mechanism to recognize new types of media. For borderline media falling between two categories, the printer remembers which category was selected previously, and then applies the same print mode to the next borderline media to provide a visually consistent output. A printing mechanism constructed to implement this method is also provided.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>EDUCATABLE MEDIA DETERMINATION SYSTEM<br>
FOR INKJET PRINTING<br>
Related Applications<br>
This is a continuation-in-part application of pending U.S. patent application serial no. 09/676,100, filed on September 29, 2000, which is a continuation-in-part application of pending U.S. patent application serial no. 09/607,206, filed on June 28, 2000, which is a continuation-in-part application of U.S. patefirapplication serial p&gt;09743O,487, filed on October 29, 1999, which is a continuation-in-part application of U.S. patent application serial no. 09/183,086, filed on October 29, 1998, which is a continuation-in-part application of U.S. Patent No. 6,036,298, issued on March 14, 2000, all having one inventor in common.<br>
Field of the Invention<br>
"to a method ot classifying lnscnrii**-madia entering a printing . The present, invention relates generally to inkjot printing mechanisms, and "<br>
necham-sm   am a printing machanism, and<br>
£more particularly to an optical sensing system for determining information about the type of print media entering the printzone (e.g. transparencies, plain paper, premium paper, photographic paper, etc.), so the printing mechanism can automatically tailor the print mode to generate optimal images on the specific type of incoming media without requiring bothersome user intervention.<br>
Background of the Invention<br>
InkJet printing mechanisms use cartridges, often called "pens," which shoot drops of liquid colorant, referred to generally herein as "ink," onto a page. Each pen has a printhead formed with very small nozzles through which the ink drops are fired. To print an image, the printhead is propelled back and forth across the page, shooting drops of ink in a desired pattern as it moves. The particular ink ejection mechanism within the printhead may take on a variety of different forms known to those skilled in the art, such as those using piezo-electric or thermal printhead technology. For instance, two earlier thermal ink ejection mechanisms are shown in U.S. Patent Nos. 5,278,584 and 4,683,481, both assigned to the present assignee,<br><br>
Hewlett-Packard Company. In a thermal system, a barrier layer containing ink channels and vaporization chambers is located between a nozzle orifice plate and a substrate layer. This substrate layer typically contains linear arrays of heater elements, such as resists, which are energized to heat ink within the vaporization chamfers. Upon heati      an ink droplet is ejected from a nozzle associated with the energized resistor. By selectively energizing the resistors as the printhead moves across the page, the ink is expelled in a pattern on the print media to form a desired image (e.g., picture, chart or text).<br>
In closed loop inkjet printing, sensors are used to determine a particular attribute of interest, with the printer then using the sensor signal as an input to adjust the particular attribute. For pen alignment, a sensor may be used to measure the position of ink drops produced from each printhead. The printer then uses this information to adjust the timing of energizing the firing resistors to bring the resulting droplets into alignment. In such a closed loop system, user intervention is no longer required, so ease of use is maximized.<br>
In the past, closed loop inkjet printing systems have been too costly for the home printer market, although they have proved feasible on higher end products. For example, in the DesignJet® 755 inkjet plotter, and the HP Color Copier 210 machine, both produced by the Hewlett-Packard Company of Palo Alto, California, the pens have been aligned using an optical sensor. The DesignJet® 755 plotter used an optical sensor which may be purchased from the Hewlett-Packard Company of Palo Alto, California, as part no. C3195-60002, referred to herein as the "HP '002" sensor. The HP Color Copier 210 machine uses an optical sensor which may be purchased from the Hewlett-Packard Company as part no. C5302-60014, referred to herein as the "HP '014" sensor. The HP '014 sensor is similar in function to the HP '002 sensor, but the HP '014 sensor uses an additional green light emitting diode (LED) and a more product-specific packaging to better fit the design of the HP Color Copier 210 machine. Both of these higher end machines have relatively low production volumes, but their higher market costs justify the addition of these relatively expensive sensors.<br>
2<br><br>
In the home printer market, the media may range from a special photo quality glossy paper, down to a brown lunch sack, fabric, or anything in between. To address this media identification problem, a media detect sensor was placed adjacent to the media path through the printer, such as on the media pick pivoting mechanism or on the media input tray. The media detect sensor read an invisible-ink code pre-printed on the printing side of the media- This code enables the printer to compensate for the orientation, size and type of media by adjusting print modes for optimum print quality to compensate for these variances in the media supply, without requiring any customer intervention.<br>
However, media type detection is not present in the majority of inkjet printers on the commercial market today. Most printers use an open-loop process, relying on an operator to select the type of media through the software driver of their computer. Thus there is no assurance that the media actually in the input tray corresponds to the type selected for a particular print request, and unfortunately, printing with an incorrectly selected media often produces poor quality images. Compounding this problem is the fact that most users never change the media type settings at all, and most are not even aware that these settings even exist. Therefore, the typical user always prints with a default setting of the plain paper-normal mode. This is unfortunate because if a user inserts expensive photo media into the printer, the resulting images are substandard when the normal mode rather than a photo mode is selected, leaving the user effectively wasting the expensive photo media. Besides photo media, transparencies also yield particularly poor image quality when they are printed on in the plain paper-normal mode.<br>
The problem of distinguishing transparencies from paper was addressed in the Hewlett-Packard Company's DeskJet 2000C Professional Series Color InkJet Printer, which uses an infrared reflective sensor to determine the presence of transparencies. This system uses the fact the light passes through the transparencies to distinguish them from photo media and plain paper. While this identification system is simple and relatively low cost, it offers limited identification of the varying types of media available to users.<br>
3<br><br>
Another sensor system for media type determination used a combination transmissive/reflective sensor. The reflective portion of the sensor had two receptors at differing angles with respect to the surface of the media.- By looking at the transmissive detector, a transparency could be detected due to the passage of light through the transparency. The two reflective sensors were used to measure the specular reflectance of the media and the diffuse reflectance of the media, respectively. By analyzing the ratio of these two reflectance values, specific media types were identified. To implement this system, a database was required comprising a look-up table of the reflective ratios which were correlated with the various types of media. Unfortunately, new, non-characterized media was often misidentified, leading to print quality degradation. Finally, one of the worst shortcomings of this system was that several different types of media could generate the same reflectance ratio, yet have totally different print mode classifications.<br>
One proposed system offered what was thought to be an ultimate solution to media type identification. In this system an invisible ink code was printed on the front side of each sheet of the media in a location where it was read by a sensor onboard the printer. This code supplied the printer driver with a wealth of information concerning the media type, manufacturer, orientation and properties. The sensor was low in cost, and the system was very reliable in that it totally unburdened the user from media selection through the driver, and insured that the loaded media was correctly identified. Unfortunately, these pre-printed invisible ink codes became visible when they were printed over. The code was then placed in the media margins to avoid this problem, for instance as discussed in U.S. Patent No. 5,984,193, assigned to the present assignee, the Hewlett-Packard Company; however market demand is pushing inkjet printers into becoming photo generators. Thus, the margins became undesirable artifacts for photographs with a "full-bleed" printing scheme where the printed image extends all the way to the edge of the paper. Thus, even placing the code in what used to have been a margin when printed over in full-bleed printing mode created severe print defects.<br>
Still another media identification system marked the edge of the media by deforming the leading edge of the media. These edge deformations took the form of<br>
4<br><br>
edge cuts, punched holes, scallops, etc. to make the leading edge no longer straight, with a straight edge being the plain paper default indicator. Unfortunately these edge deformation schemes required additional media processing steps to make the media. Moreover, a deformed edge lacks consumer appeal, appearing to most consumers as media which was damaged in shipping or handling.<br>
Thus, it would be desirable to provide an optical sensing system for determining information about the type of media entering the printing mechanism, so the printing mechanism can automatically adjust printing for optimal images without requiring user intervention and without damaging the media or the finished image.<br>
Summary of the Invention<br>
According to one aspect of the invention, a method of classifying incoming media entering a printing mechanism is provided. The method includes the steps of optically scanning a printing surface of the incoming media to gather specular and diffuse reflectance data, and comparing the specular and diffuse reflectance data with known values for different media types to classify the incoming media as one of the different media types. In a selecting step, a print mode corresponding to the classified media type is selected. Finally, in a storing step, selected print mode for the classified incoming media is stored for future reference.<br>
According to a yet another aspect of the invention, an inkjet printing mechanism is provided as including a frame which defines a printzone, and a printhead which prints a selected image on a printing surface of media in the printzone in response to a printing signal. A media sensor optically scans the printing surface of incoming media entering the printzone to gather specular and diffuse reflectance data. The printing mechanism also has a controller which<br>
compares the specular and diffuse reflectance data with known values for different<br>
\ -<br>
media types to classify the incoming media as one_of the different media types. The<br>
controller selects a print mode corresponding to the classified type, generates the printing signal for the selected image in response to the selected printmode, and stores the selected print mode for future reference.<br>
5<br><br>
An overall goal of the present invention is to provide an optical sensing system for an inkjet printing mechanism, along with a method for optically distinguishing the type of media so future droplets may be adjusted by the printing mechanism to produce high quality images on the particular type of media being printed upon without user intervention.<br>
A further goal of the present invention is to provide an easy-to-use inkjet printing mechanism capable of compensating for media type to produce optimal images for consumers, and one which does this quickly and efficiently.<br>
Another goal of the present invention is to provide an optical sensing system for identifying the major types of media, such as plain paper, premium paper, photo media, and transparencies, without requiring any special markings on the print side of the media which may otherwise create undesirable print artifacts, and which does not require user intervention or recalibration.<br>
Yet a further goal of the present invention is to provide an optical sensing system for a printing mechanism that is educatable to learn to identify new types of media beyond those studied by the manufacturer, and capable thereafter of printing optimal images on the new types of media.<br>
An additional goal of the present invention is to provide an optical sensing system for an inkjet printing mechanism that is lightweight, compact and produced with minimal components to provide consumers with a more economical inkjet printing product.<br>
Still another goal of the present invention is to provide an educatable media identification system which a user may teach how to identify new types of media and apply a selected print mode to such new media when encountered in the future.<br>
Yet another object of the present invention is to provide a media identification system which automatically realizes when a new type of media is encountered, and in particular, a borderline media which has characteristics falling between two recognized categories, with the system then applying a consistent print mode to additional sheets of this borderline media to avoid alternating between two different print modes when continually encountering the borderline media.<br>
6<br><br>
WO 01/32(25	PCT/USOO/29"71<br>
Brief Description of thefD raw ings<br>
FIG. 1 is a fragmented perspective view of one form of an inkjet printing mechanism, here an inkjet printer, including one form of an optical sensing system of the present invention for gathering information about an incoming sheet of media entering a printzone portion of the printing mechanism.<br>
FIG. 2 is a schematic side eievational view of one form of an advanced media type determination optical sensor of the printer of FIG. 1.<br>
FIG. 3 is a graph of the specular light output of the media type determination of sensor FIG. 2, which uses a blue-violet colored LED.<br>
FIG. 4 is a bottom plan view of the media type optical sensor of FIG. 2, taken along lines 4-4 thereof.<br>
FIG. 5 is a side elevationaJ view of the lens assembly of FIG. 2.<br>
FIG. 6 is a top plan view of one form of a lens assembly of the media optical sensor of FIG. 2.<br>
FIG. 7 is a bottom plan view of the lens assembly of FIG. 2.<br>
FIG. 8 is a flow chart illustrating the manner in which the optical sensor of FIG. 2 may be used to distinguish transparency media without tape, GOSSIMER photo media, transparency media with a.tape header, and plain paper from each other.<br>
FIG. 9 is a graph of the direct current (DC) level diffuse reflectance versus media type for all plain papers, including an entry for transparencies ('TRAN") and one without the tape header, labeled "TAPE," as well as GOSSIMER photo papers, labeled "GOSSIMER#1 and GOSSIMER #2.<br>
FIG. 10 is a graph of the Fourier spectrum components, up to component 30 for the GOSSIMER photo media.<br>
FIG. 11 is a graph of the Fourier spectrum components, up to component 30 for the representative plain paper provided by MoDo Datacopy, labeled "MODO" in FIG. 9.<br>
FIG. 12 is a graph of the sum of the Fourier spectrum components for all of the^media shown in FIG. 9.<br>
7<br><br>
FIG. 13 is a graph of the Fourier spectrum components, up to component 30 for a transparency with a tape header, indicated as "TAPE" in FIG. 9.<br>
FIG. 14 is a graph of the summed third, sixteenth, seventeenth and eighteenth Fourier spectrum components for the plain paper media shown in FIG. 9, in addition to that of the TAPE header across a transparency indicated as "TRAN."<br>
FIG. 15 is a flow chart of one form of a method for determining which major category of media, e.g., plain paper, premium paper, photo paper or transparency, is entering the printzone of the printer of FIG. 1, as well as determining specific types of media within major media categories, such as distinguishing between generic premium paper, matte photo premium paper, and prescored heavy greeting card stock.<br>
FIG. 16 is a flow chart of the "collect raw data" portion of the method of FIG. 15.<br>
FIG. 17 is a flow chart of the "massage data" portion of the method of FIG. 15.<br>
FIG. 18 is a flow chart of the 'Verification" and "select print mode" portions of the method of FIG. 15.<br>
FIG. 19 is a flow chart of a data weighting and ranking routine used in both the "verification" and "select print mode" portions of the method of FIG. 15.<br>
FIGS. 20-23 together form a flow chart which illustrates the "major category determination" and "specific type determination" portions of the method of FIG. 15, specifically with:<br>
FIG. 20 showing transparency determination;<br>
FIG. 21 showing glossy photo determination;<br>
FIG. 22 showing matte photo determination; and<br>
FIG. 23 showing plain paper and premium paper determination.<br>
FIG. 24 is an enlarged schematic side elevational view of the media type optical sensor of FIG. 2, shown monitoring a sheet of plain paper or transparency media entering the printzone of the printer of FIG. 1.<br>
8<br><br>
FIG. 25 is an enlarged schematic side-elevationa! view of the media type sensor of FIG. 2, shown monitoring a sheet of photo media with a uniform coating entering the printzone of the printer of FIG. 1.<br>
FIG. 26 is an enlarged schematic side-elevational view of the media type sensor of FIG. 2, shown monitoring a sheet of photo media with an irregular coating entering the printzone of the printer of FIG. 1.<br>
FIGS. 27-33 are graphs of the raw data accumulated during the "collect raw data" portion of the method of FIG. 14, specifically with;<br>
FIG. 27 showing data for a very glossy photo media; FIG. 28 showing data for a glossy photo media; FIG. 29 showing data for a matte photo media; FIG. 30 showing data for a plain paper media, specifically, a Gilbert® Bond;<br>
FIG. 31 showing data for a premium media<br>
FIG. 32 showing data for HP transparency media with a tape header; and<br>
FIG. 33 showing data for transparency media without a tape header. FIGS. 34-39 are graphs of the Fourier spectrum components, up to component 100, specifically with:<br>
FIG. 34 showing the matte photo media diffuse reflection; FIG. 35 showing the matte photo media specular reflection; FIG. 36 showing the very glossy photo media diffuse reflection; FIG. 37 showing the very glossy photo media specular reflection; FIG. 38 showing the plain paper media diffuse reflection; and FIG. 39 showing the plain paper media specular reflection. FIG. 40 is a graph of the diffuse spatial frequencies of several generic media, including plain paper media, premium paper media, matte photo media, glossy photo media, and transparency media.<br>
FIG. 41 is a graph of the specular spatial frequencies of several generic mfidia, including plain paper media, premium paper media, matte photo media, glossy photo media, and transparency media.<br>
9<br><br>
WO 01/32425	PCT/USflO/39871<br>
FIG. 25 is an enlarged schematic side-elevational view of the media type sensor of FIG. 2, shown monitoring a sheet of photo media with a uniform coating entering the printzone of the printer of FIG. 1.<br>
FIG. 26 is an enlarged schematic side-elevational view of the media type sensor of FIG. 2, shown monitoring a sheet of photo media with an irregular coating entering the printzone of the printer of FIG. 1.<br>
FIGS. 27-33 are graphs of the raw data accumulated during the "collect raw data" portion of the method of FIG. 14, specifically with:<br>
FIG. 27 showing data for a very glossy photo media; FIG. 28 showing data for a glossy photo media; FIG. 29 showing data for a matte photo media; FIG. 30 showing data for a plain paper media, specifically, a Gilbert® Bond;<br>
FIG. 31 showing data for a premium media<br>
FIG. 32 showing data for HP transparency media with a tape header; and<br>
FIG. 33 showing data for transparency media without a tape header. FIGS. 34-39 are graphs of the Fourier spectrum components, up to component 100, specifically with:<br>
FIG. 34 showing the matte photo media diffuse reflection; FIG. 35 showing the matte photo media specular reflection; FIG. 36 showing the very glossy photo media diffuse reflection; FIG. 37 showing the very glossy photo media specular reflection; FIG. 38 showing the plain paper media diffuse reflection; and FIG. 39 showing the plain paper media specular reflection. FIG. 40 is a graph of the diffuse spatial frequencies of several generic media, including plain paper media, premium paper med'a, matte photo media, glossy photo media, and transparency media.<br>
FIG. 41 is a graph of the specular spatial frequencies of several generic me'dia, including plain paper media, premium paper media, matte photo media, glossy photo media, and transparency media.<br>
9<br><br>
FIG. 42 is a graph of the diffuse spatial frequencies of several specific photo media, including photo media with swell able and porous ink retention layers.<br>
FIG. 43 is a graph of the specular spatial frequencies of several specific photo media, including photo media with swellable and porous ink retention layers.<br>
FIG. 44 is a flow chart illustrating one form of a two-stage media determination system of the present invention for operating the sensor of FIG. 2.<br>
FIG. 45 is a flowchart of a user-educatable media identification system of the present invention.<br>
FIG. 46 is a flowchart of an automatic media identification system of the present invention which identifies borderline media falling between two media categories or types.<br>
Detailed Description of a Preferred Embodiment<br>
FIG. 1 illustrates an embodiment of an inkjet printing mechanism, here shown as an inkjet printer 20, constructed in accordance with the present invention, which may be used for printing for business reports, correspondence, desktop publishing, artwork, and the like, in an industrial, office, home or other environment. A variety of inkjet printing mechanisms are commercially available. For instance, some of the printing mechanisms that may embody the present invention include plotters, portable printing units, copiers, cameras, video printers, and facsimile machines, to name a few. For convenience the concepts of the present invention are illustrated in the environment of an inkjet printer 20 which may find particular usefulness in the home environment.<br>
While it is apparent that the printer components may vary from model to model, the typical inkjet printer 20 includes a chassis 22 surrounded by a housing or casing enclosure 23, the majority of which has been omitted for clarity in viewing the internal components. A print media handling system 24 feeds sheets of print media through a printzone 25. The print media may be any type of suitable sheet material, such as paper, card-stock, envelopes, fabric, transparencies, mylar, and the Hfte, with plain paper typically being the most commonly used print medium. The print media handling system 24 has a media input, such as a supply or feed tray 26<br>
10<br><br>
into which a supply of media is loaded and stored before printing. A series of conventional media advance or drive rollers (not shown) powered by a motor and gear assembly 27 may be used to move the print media from the supply tray 26 into the printzone 25 for printing. After printing, the media sheet then lands on a pair of $ -   retractable output drying wing members 28, shown extended to receive the printed sheet. The wings 28 momentarily hold the newly printed sheet above any previously printed sheets still drying in an output tray portion 30 before retracting to the sides to drop the newly printed sheet into the output tray 30. The media handling system 24 may include a series of adjustment mechanisms for accommodating different sizes of 10     print media, including letter, legal, A-4, envelopes, etc. To secure the generally rectangular media sheet in a lengthwise direction along the media length, the handling system 24 may include a sliding length adjustment lever 32, and a sliding width adjustment lever 34 to secure the media sheet in a width direction across the media width.<br>
15	The printer 20 also has a printer controller, illustrated schematically as a<br>
microprocessor 35, that receives instructions from a host device, typically a computer, such as a personal computer (not shown). Indeed, many of the printer controller functions may be performed by the host computer, by the electronics on board the printer, or by interactions therebetween. As used herein, the term "printer<br>
70     controller 35" encompasses these functions, whether performed by the host computer, the printer, an intermediary device therebetween, or by a combined interaction of such elements. A monitor coupled to the computer host may be used to display visual information to an operator, such as the printer status or a particular program being run on the host computer. Personal computers, their input devices,<br>
25     such as a keyboard and/or a mouse device, and monitors are all well known to those skilled in the art.<br>
The chassis 22 supports a guide rod 36 that defines a scan axis 38 and slideably supports an inkjet printhead carriage 40 for reciprocal movement along the scan axis 38, back and forth across the printzone 25. The carriage 40 is driven by a<br>
30     carriage propulsion system, here shown as including an endless belt 42 coupled to a carriage drive DC motor 44. The carriage propulsion system also has a position<br>
11<br><br>
feedback system, such as a conventional optical encoder system, which communicates carriage position signals to the controller 35. An optical encoder reader may be mounted to carriage 40 to read an encoder strip 45 extending along the path of carriage travel. The carriage drive motor 44 then operates in response to 5     control signals received from the printer controller 35. A conventional flexible, multi-conductor strip 46 may be used to deliver enabling or firing command control signals from the controller 35 to the printhead carriage 40 for printing, as described further below.<br>
The carriage 40 is propelled along guide rod 36 into a servicing region 48,<br>
10     which may house a service station unit (not shown) that provides various<br>
conventional printhead servicing functions. To clean and protect the printhead, typically a "service station" mechanism is mounted within the printer chassis so the printhead can be moved over the station for maintenance. For storage, or during non-printing periods, the service stations usually include a capping system which<br>
1 5      hermetically seals the printhead nozzles from contaminants and drying. Some caps are also designed to facilitate priming by being connected to a pumping unit that draws a vacuum on the printhead. During operation, clogs in the printhead are periodically cleared by firing a number of drops of ink through each of the nozzles in a process known as "spitting," with the waste ink being collected in a "spittoon"<br>
20     reservoir portion of the service station. After spitting, uncapping, or occasionally during printing, most service stations have an elastomeric wiper that wipes the printhead surface to remove ink residue, as well as any paper dust or other debris that has collected on the printhead.<br>
In the printzone 25, the media receives ink from an inkjet cartridge, such as a<br>
25      black ink cartridge 50 and three monochrome color ink cartridges 52, 54 and 56, secured in the carriage 40 by a latching mechanism 58, shown open in FIG. 1. The cartridges 50-56 are also commonly called "pens" by those in the industry. The inks dispensed by the pens 50-56 may be pigment-based inks, dye-based inks, or * combinations thereof, as well as paraffin-based inks, hybrid or composite inks haying both dye and pigment characteristics.<br>
12<br><br>
The illustrated pens 50-56 each include reservoirs for storing a supply of ink therein. The reservoirs for each pen 50-56 may contain the entire ink supply on board the printer for each color, which is typical of a replaceable cartridge, or they may store only a small supply of ink in what is known as an "off-axis" ink delivery a     system. The replaceable cartridge systems cany the entire ink supply as the pen reciprocates over the printzone 25 along the scanning axis 38. Hence, the replaceable cartridge system may be considered as an "on-axis" system, whereas systems which store the main ink supply at a stationary location remote from the printzone scanning axis are called "off-axis" systems. In an off-axis system, the<br>
10     main ink supply for each color is stored at a stationary location in the printer, such as four refillable or replaceable main reservoirs 60, 62,64 and 66, which are received in a stationary ink supply receptacle 68 supported by the chassis 22. The pens 50, 52, 54 and 56 have printheads 70, 72, 74 and 76, respectively, which eject ink delivered via a conduit or tubing system 78 from the stationary reservoirs 60-66 to<br>
15     the on-board reservoirs adjacent the printheads 70-76.<br>
The printheads 70-76 each have an orifice plate with a plurality of nozzles formed therethrough in a manner well known to those skilled in the art. The nozzles of each printhead 70-76 are typically formed in at least one, but typically two linear arrays along the orifice plate, aligned in a longitudinal direction perpendicular to the<br>
20     scanning axis 38. The illustrated printheads 70-76 are thermal inkjet printheads, although other types of printheads may be used, such as piezoelectric printheads. The thermal printheads 70-76 typically include a plurality of resistors which are associated with the nozzles. Upon energizing a selected resistor, a bubble of gas is formed which ejects a droplet of ink from the nozzle and onto a sheet of paper in the<br>
25      printzone 25 under the nozzle. The printhead resistors are selectively energized in response to firing command control signals received via the multi-conductor strip 46 from the controller 35.<br>
13<br><br>
Optical Media Type Determination Sensor<br>
FIG. 2 illustrates one form of an optical media type determination sensor or "media sensor" 100 constructed in accordance with the present invention. The !*     sensor 100 includes a casing or base unit 102 may be supported by the printhead carriage 40 in a variety different ways known to those skilled in the art. The sensor 100 has an illuminating element, here, a biue-violet light emitting diode (LED) 105 which has an output lens 106. Extending from the LED 105 are two input leads 108 and 109 which may be electrically coupled to conductors in a printed circuit board 14)     (not shown) secured to an exterior portion of the body 102 to deliver sensor signals back to the printer controller 35. The printed circuit board and flexible conductors may be used to couple the sensor 100 to an electronics portion (not shown) of the carriage 40. The sensor, signals then pass from the carriage 40 through the multi-conductor strip 46, which carries power and communication signals between 15      the controller 35 and the carriage 40. A lens assembly 110 is supported by the<br>
casing 102, with the lens assembly 110 being described in greater detail below with respect to FIGS. 5-7.<br>
The media sensor 100 preferably uses a blue-violet LED 105 which emits an output spectrum shown in FIG. 3 as graph 112. The blue-violet LED 105 has a peak 20     wavelength of around 428 nanometers, and a dominant wavelength of 464<br>
nanometers, yielding a more violet output than the blue LED described in U.S. Patent No. 6,036,298, recited in the Related Applications section above, which had a peak wavelength of around 470 nanometers. Several reasons for this change in the illumination component of the media sensor 100 will be described near the end of 25      the Detailed Description section. The LED 105 includes a negative lead frame 114 which is electrically coupled to the conductor 108. The LED .105 also has a die 115 mounted within a reflector cup 116, which is supported by the negative lead frame 114. The die 115 is used to produce the blue-violet wavelength light of graph 112 emitted by the LED 105 when energized. A positive lead frame 118 is 39     eTectrically coupled to conductor 109, and serves to carry current therethrough when the LED 105 is turned on. Preferably, the negative lead frame 114, the die 115, the<br>
14<br><br>
cup 116, and the positive lead frame 118 are all encapsulated in a transparent epoxy resin body which is conformed to define the output lens 106 as an integral dome lens that directs light from the die 115 into rays which form an illuminating beam 120. One preferred manner of operating the LED 105, including illumination routines, is 5     described in detail in U.S. Patent No. 6,036,298, recited in the Related Applications section above<br>
The media sensor 100 also has two filter elements 122 and 124, which lay over portions of the lens assembly 110. These filters 122 and 124 may be constructed as a singular piece, although in the illustrated embodiment two separate 1")     filters are shown. The filters 122 and 124 have a blue pass region where the low wavelength blue-violet LED light, with a wavelength of 360-510 nm, passes freely through the filters 122 and 124, but light of other wavelengths from other sources are blocked out. Preferably, the filter elements 122 and 124 are constructed of a 1 mm (one millimeter) thick sheet of silicon dioxide (glass) using conventional thin film 5      deposition techniques, as known to those skilled in the art.<br>
The optical sensor 100 also includes a diffuse photodiode 130 that includes a light sensitive photocell 132 which is electrically coupled to an amplifier portion (not shown) of the photodiode 130. The photodiode 130 has input lens 135, which emits light to the light sensitive photocell 132. The photocell 132 is preferably 20     encapsulated as a package fabricated to include the curved lens 135 which<br>
concentrates incoming light onto the photocell 132. The photodiode 130 also has three output leads 136, 137 and 138 which couple the output from amplifier 134 to electrical conductors on the printed circuit board (not shown) to supply photodiode sensor signals to the controller 35, via electronics on the carriage 40 and the 2 5      multi-conductor flex strip 46. While a variety of different photodiodes may be used, one preferred photodiode is a light-to-voltage converter, which may be obtained as part no. TSL257 from Texas Analog Optical Systems (TAOS) of Dallas, Texas.<br>
The optical sensor 100 also includes a second specular photodiode 130' that may be constructed as described for the diffuse photodiode 130, with like Components on the specular photodiode having the same item numbers as the diffuse photodiode, by carrying a "prime" designator (') similar to an apostrophe.<br>
15<br><br>
Preferably, the casing 102 is constructed so that the LED 120 is optically isolated<br>
from the photodiodes 130, 130* to prevent light emitted directly from the LED 120<br>
from being perceived by the photocells 132,132*. Thus, the outbound light path of<br>
the LED 120 is optically isolated from the inbound light path of the photodiode 130.<br>
i	The media sensor 100 also has two field of view controlling elements, such<br>
as field stops 140 and 142. The field stops 140 and 142, as well as the filters 122 and 124, are held in place by various portions of the casing 102, and preferably, the field stops 140 and 142 are molded integrally with a portion of the casing 102. The field stops 140 and 142 are preferably located approximately tangent to the apex of 0     the input lenses 135,135' of the photodiodes 130, 130', respectively. In the<br>
illustrated embodiment, the field stops 140, 142 define field of view openings or windows 144 and 145, respectively.<br>
FIG. 4 shows the orientation of the field stop windows 144 and 145 with respect to the scanning axis 38. In the illustrated embodiment, the field stop 5      windows 144 and 145 are rectangular in shape, with the specular window 144<br>
having a major axis 146 which is approximately parallel to the scanning axis 38, and the diffuse field stop window 145 having a major axis 148 which is substantially perpendicular to the scanning axis 38. The specular field stop 144 has window 144 oriented with a minor axis 149 which in the illustrated embodiment is colinear with 20     themajoraxis 148 of the diffuse field stop window 145. This orientation of the field stop windows 144,145 allows the diffuse photodiode 130 to collect data which may be distinguished from that collected by the specular photodiode 130'.<br>
FIG. 2 illustrates the light paths through the lens assembly 110 as a sheet of media 150, here illustrated as paper, is scanned by sensor 100. The LED 105 25      generates the output beam 120, which is aimed toward an illuminated area 152 of the media 150 by first passing through the lens assembly 110 as an illuminating beam 154. The media !50 produces two reflected beams, one, a diffuse reflected beam 155 and a specular reflected beam 155*. The diffuse and specular reflected beams 155, 155* pass through the filter elements 122, 124, respectively to form the 30      respective diffuse and specular filtered beams 156 and 156'. The diffuse reflected light beam 155 has a flame-like scattering of rays arranged in a I^ambertian<br>
16<br><br>
distribution. The specuiar beam 155* is reflected off the media 150 at the same angle that the incoming light beam 154 impacts the media, according to the well known principle of optics: l*angle of incidence equals angle of reflection." In the illustrated embodiment, the angle of incidence and the angle reflection are selected 5     to be around 55°.<br>
FIGS. 5-7 illustrate the construction of the lens assembly 110, which may be made of an optical plastic material molded with lens elements formed therein. FIG. 5 shows an LED output lens as having a diffractive lens element 160 formed along a top surface 162 of the lens 110. The diffractive lens 160 is located directly 10     beneath the LED output beam 120. FIG. 6 illustrates a bottom view of the lens assembly 110 which has a bottom surface 164 facing down toward the media 150. Opposite the diffractive lens element 160, the LED output lens has a Fresnel lens element 165 formed along the lower surface 164. FIG. 5 best shows a diffuse lens as having a photodiode input lens element 166 projecting outwardly from the<br>
15     tower surface 164. Preferably, the lens 166 is a convex aspheric condenser lens. FIG. 6 illustrates another portion of the diffuse lens as having an upper or output lens element 168 which is directly opposite the input element 166. While the output element 168 may be a flat extension of the upper surface 162 of the lens 110, in some embodiments, contouring of the upper surface 168 may be desired to improve<br>
20     the optical input to the photodiode lens 135. Preferably, the photodiode output<br>
element 168 is also a diffractive lens, which may be constructed as described above for the upper diode lens element 160 to provide correction of chromatic aberrations of the primary input lens element 166.<br>
The specular photodiode 130* receives the filtered specular beam 156'. To<br>
25     accommodate this incoming specular reflectance beam 155* the lens assembly has a specular lens with an incoming Fresnel lens element 165', and an outgoing diffractive lens element 160', which may be constructed as described above for lens elements 165 and 160, respectively. It is apparent to those skilled in the art that other types of lens assemblies may be used to provide the same operation as lens<br>
30     assembly 110. For instance, the specular lens clement 165* may be constructed with an aspheric refractive incoming lens element, and an outgoing aspheric refractive<br>
17<br><br>
lens element or an outgoing micro-Fresnel lens. A detailed discussion of the operation of these lens elements is described in U.S. Patent No. 6,036,298, recited in the Related Applications section above, or may be found in most basic optics textbooks.<br>
A few definitions may be helpful at this point:<br>
"Radiance" is the measure of the power emitted by a light source of finite size expressed in W/sr-cm2 (watts per steradian - centimeters squared).<br>
10	'Transmission11 is measure of the power that passes through a lens in terms<br>
of the ratio of the radiance of the lens image to the radiance of the original object, expressed in percent. "Transmittance" is a spectrally weighted transmission, here, the ratio of the<br>
transmitted spectral reflectance going through the lens, e.g.<br>
15	beam 154, to the incident spectral reflectance, e.g. beam 155'.<br>
'Specular reflection" is that portion of the incident light that reflects off the media at an angle equal to the angle at which the light struck the media, the angle of incidence.<br>
"Reflectance" is the ratio of the specular reflection to the incident light,<br>
20	expressed in percent.<br>
"Absorbance" is the converse of reflectance, that is, the amount of light<br>
which is not reflected but instead absorbed by the object,<br>
expressed in percent as a ratio of the difference of the incident<br>
light minus the specular reflection, with respect to the incident<br>
25	light.<br>
"Diffuse reflection" is that portion of the incident light that is scattered off the surface of the media 150 at a more or less equal intensity with respect to the viewing angle, as opposed to the specular reflectance which has the greatest intensity only at the angle of reflectance.<br>
18<br><br>
"Refraction" is the deflection of a propagating wave accomplished by<br>
modulating the speed of portions of the wave by passing them through different materials.<br>
"Index of refraction" is the ratio of the speed of light in air versus the speed<br>
5	of light in a particular media, such as glass, quartz, water, etc.<br>
"Dispersion** is the change in the index of refraction with changes in the wavelength of light.<br>
Basic Media Type Determination System<br>
13	FIG. 8 illustrates one form of a preferred basic media type determination<br>
system 400 as a flow chart, constructed in accordance with the present invention, which may be used in conjunction with the optical sensor 100 of FIG. 2. The first step of this media-type determination method 400 consists of starting the media pick routine 402 where a fresh sheet of media is picked by the media handling system 24<br>
15      from the input tray 26. This fresh sheet of media is then moved into the printzone in step 404. After the media pick routine is completed, the LED 105 of the optical sensor 100 is illuminated, and in step 405 this illumination is adjusted to bring the signal received from an imprinted portion of the media up to a near-saturation level of the analog to digital (A/D) converter, which is on the order of 5 volts. This A/D<br>
20      converter is within the controller 35, and during data acquisition this A/D converter is enabled and allowed to acquire the output signal of the photodiode 130.<br>
Once the illumination of the LED 105 has been adjusted in a scanning step 406, the optical sensor 100 is scanned across the media by carriage 40 to collect reflectance data points and preferably, to record these data points at every positional<br>
25      encoder transition along the way, with this positional information being obtained through use of the optical encoder strip 45 (FIG. 1). Thus, the data generated in the scanning and collecting step 406 consists of both positional data and the corresponding reflectance data, with the reflectance and position being in counts. For instance, for the reflectance, twelve bits, or 212 which equals 4096 counts, are<br>
30      equally distributed over a 0-5 Volt range of the A/D converter. Thus, each count is equal to 5/4096, or 1.2 mV (millivolts). The light (reflectance from the media is<br>
19<br><br>
captured by the LVC (light-to-voltage converter) and provides as an output an analog voltage signal which is translated by the analog-to-digital converter into a digital signal expressed in counts. The position on the media (e.g., paper) is also expressed in counts derived from the 600 quadrature transitions per inch of the encoder in the 5     illustrated embodiment, although it is apparent to those skilled in the art that other transitions per inch, or per some other linear measurement, such as centimeters, may also be used. Thus, a position count of 1200 in the illustrated embodiment translates to a location on the paper or other media of 1200/600 position counts, or 2.0 inches (5.08 centimeters) from the start of the scan. Preferably, the media is scanned a<br>
10      single time and then the data is averaged in step 408. step -During the scanning and collecting step 406, the field of view of the optical sensor 100 is placed over the media with the media resting at the top of form position. In this top of form position, for a transparency supplied by the Hewlett-Packard Company, which has a tape header across the top of the transparency, this implies that the tape header is<br>
15      being scanned by the sensor 100.<br>
Since the A-D conversions used during the scanning and collecting step 406 is triggered at each state transition of the encoder strip 45, the sampling rate has spatial characteristics, and occurs typically at 600 samples per inch in the illustrated printer 20. During the scan, the carriage speed is preferably between 2 and 30 inches<br>
20      per second. The data collected during step 406 is then stored in the printer<br>
controller 35, and is typically in the range of a 0-5 volt input, with 9-bit resolution. At the conclusion of the scanning, the data acquisition hardware signals the controller 35 that the data collection is complete and that the step of averaging the data points 408 may then be performed.<br>
25	The media type determination system 400 ihen performs a spatial frequency<br>
media identification routine 410 to distinguish whether the media sheet that has been scanned is either a transparency without a header tape, photo quality media, a transparency with a header tape, or plain paper. The first step in the spatial frequency media identification routine 410 is step 412, where a Fourier transform is<br>
30      performed on all of the data to determine both the magnitude and phase of each of the discrete spatial frequency components of the data recorded in step 406. In the<br>
20<br><br>
illustrated embodiment for printer 20, the data record consists of 4000 samples, so the Fourier components range from 0-4000. The magnitude of the first sorted component is the direct current (DC) level of the data.<br>
If a transparency without a tape header is being examined, this DC level of 5      the data will be low. FIG. 9 is a graph 414 of the DC level of reflectance for a group of plain papers which were studied, with the abbreviation key being shown in Table 1 beiow. Also shown in FIG. 9 are the DC levels of reflectance for transparencies with afaeader tape, labeled "TAPE," as shown by bar 416 and for that without the tape header, labeled as "TRAN", as shown by bar 418 in graph 414. 10<br>
21<br><br>
Table 1: Graph Abbreviations<br>
Label	Media Type Archive<br>
GOSSIMER      Gossimer (HP Photo Glossy)<br>
GBND	Gilbert Bond<br>
GPMS	Georgia-Pacific Multi-System<br>
ARRM	Aussedat-Rey-Reymat<br>
CDCY	Champion DataCopy<br>
EGKL	Enso-Gutzeit Berga Laser<br>
HFDP	Hammermill Fore DP<br>
HNYR	Honshu New Yamayuri<br>
HOKM	Hokuestsu kin-Mari<br>
KCLX	KymCopy Lux<br>
MODO	MoDo DataCopy<br>
NCLD	Neenah Classic Laid<br>
OJIS	Oji Sunace PPC<br>
PMCY	Stora Papyrus Multicopy<br>
SFIP	SFI-PPC<br>
STZW	Steinbeis/Zweckform<br>
TAPE	HP transparency (Scotty) WITH paper tape<br>
TRAN	HP transparency (Scotty) NO Tape<br>
UCGW	Union Camp Great White<br>
WFCH	Weyerhauser First Choice<br>
WTCQ	Wiggens Teape Conqueror<br>
22<br><br>
Also included in the DC level reflectance graph of FIG. 9 are two types of Gossimer photo paper, labeled GOSSIMER#1 and GOSSIMER#2, as shown by bars 420 and 422, respectively in graph 414. The remainder of the bars in graph 414 indicate varying types of plain paper, as shown in Table 1 below, of which bar 424 is $     used for MoDo DataCopy plain paper media, labeled as "MODO". From a review of graph 414, it is seen that the low level of light passing through the transparency without a tape header at bar 414 is readily distinguishable from the remainder of the reflectance values for the other types of media, which is because rather than the light being reflected back to the photo sensor 130, it passes through the transparency.<br>
19	Thus, in step 426, a determination is made based on the DC level of the reflectance<br>
data which, if it is under a reflectance of 200 counts then a YES signal 428 is<br>
generated to provide a transparency without tape signal 430 to the controller 35,<br>
which then adjusts the printing routine accordingly for a transparency. If instead, the<br>
DC level of the data collected is greater than 200 counts, then a NO signal 432 is<br>
5     generated and further investigation takes place to determine which of the other types of media may be present in the printzone. Note that step 426 of comparing the reflectance data may also be performed before the Fourier transform step 412, since the Fourier spectrum values are not needed to determine whether or not the media is a regular transparency without tape.<br>
20	So if the media is not a transparency without a tape header, a determination is<br>
then made whether the media is a photo quality media. To do this, a Fourier<br>
spectrum component graph 434 is used, as shown in FIG. 10, along with a Fourier<br>
spectrum component graph 436 for plain paper, here the MoDo Datacopy brand of<br>
plain paper shown in FIG. 11. Before delving into an explanation of this analysis, an<br>
25      explanation of the units for the spatial frequency label along the horizontal axis of these graphs (as well as for the graph in FIG. 13) is in order. The spatial frequency components are the number of cycles that occur u ithin the scan data collected in the scan media step 406 of FIG. 8. For the examples illustrated herein, the length of the data sample was selected to be 4000 samples. As discussed above, in the illustrated<br>
30     embodiment, the data is sampled at 600 samples per inch of movement of the<br>
sensor 100. A spatial frequency that completes 30 cycles within the length of the<br>
23<br><br>
scan data would therefore have an equivalent spatial frequency found according to the equation:<br>
(30 cycles) x (600 samples/inch) = 4.5 cycles/inch (4000 samples)<br>
In the illustrated embodiment, a data scan of 4000 samples is equivalent to a traverse of 6.6 inches across the media which is the scan distance used herein, from the equation: 10<br>
(4000 samples)	- 6.6 inches<br>
(600 samples/inch)<br>
From the comparison of graphs 434 and 436, it is seen that the magnitudes of<br>
15      the spectrum components above the count n equals eight (n = 8) are much greater in the plain paper spectrum of graph 436 then for the photo media in graph 434. Thus, in step 438 the spectral components from 8-30 are summed and in a comparison step 448, it is determined that if the sum of the components 8-30 is less than a value, here a value of 25, a YES signal 450 is generated. In response to the YES signal,<br>
20     step 452 generates a signal which is provided to the controller 35 so the printing routines may be adjusted to accommodate for the photo media. Note that in FIGS. 10 and 11, several of the components having a count of less than eight (n 
25      values are immaterial to our discussion here.<br>
Fourier spectrum component graphs such as 434 and 436 may be constructed for all of the different types of media under study." FIG. 12 shows a graph 440 of the sum of the magnitude of components 8-30 for each of the different types of plain paper and photo media. Here we see the GOSSIMER#1 and GOSSIMER#2 photo<br>
30      rrtSdias having their summed components shown by bars 442 and 444. It is apparent that the magnitude of the photo media summed components 442 and 444 is much<br>
24<br><br>
less than that for any of the remaining plain paper medias, including the bar 446 for * the MoDo Datacopy media. Thus, returning to the flow chart of FIG. 8, in response to the sum components step 438 in a comparison step 448 the magnitude of the sum of components 8-30 is compared, and if less than the value of 25 a YES signal 450 is *      generated.<br>
However, if the media in printzone 25 is not photo media, the decision step 448 generates a NO signal 454 having determined that the media is not a transparency without a header tape and not photo media it then remains to be determined whether the media is either a transparency with a header tape or plain 10      paper. FIG. 13 is a graph 455 of the Fourier spectrum components for a<br>
transparency with a tape header, with a tape header 456 being shown below the graph and having starting and ending points 464 and 466 also being indicated. Over the duration of the scan, there are three HP logos 458 encountered and roughly seventeen directional arrows 460, indicating which way a user should insert the 1 f      media into the printer. These logos and arrows create a media signature in the spectrum as can be seen from an analysis of graph 455. As can be seen from a review of the graph 455, the third component 468 and the seventeenth component 470 are much larger than those in the plain paper spectrum of the respective third and seventeenth components 472 and 474 in graph 436 of FIG. 11 (note that the 20     vertical scale on graph 455 in FIG. 13 is fragmented, and the magnitude of the third component 468 is at a value above 800.). Due to positioning errors at the beginning of the scan, which are compensated in step 408 where the data points are averaged, the sixteenth and eighteenth components 476 and 478, respectively, of graph 455 are much larger than the sixteenth and eighteenth components 480 and 482, for the plain 25      paper in graph 436. Consequently, the sixteenth and eighteenth components are also contained within this unique frequency signature.<br>
Returning to flow chart 400 of FIG. 8, in slip 484 the magnitude of the components of the third, sixteenth, seventeenth and eighteenth spectrums are summed, with these resulting sums being shown in graph 485 of FIG. 14. The sum for the tape is shown as bar 486, which is clearly of a much greater magnitude than the various plain papers, such as bar 488 for the MoDo Datacopy plain paper. Thus,<br>
25<br><br>
a decision may then be made in step 490, to determine whether the sum of the frequency sub-components 3, 16,17 and 18 performed by step 484 is greater than 1300 if so, a YES signal 492 is delivered to indicate that the media is a transparency with a tape header, and this information is then transferred by step 494 f*      to the printer controller 35 for subsequent processing and adjustment of the printing routines. However, if the decision by step 490 is that the sum is less than 1300, then a NO signal 496 is generated which is then sent to a decision block 498 indicating plain paper is in the printer, and the default plain paper print mode may be used by the controller 35. 1©<br>
Advanced Media Determination System<br>
FIG. 15 illustrates one form of a preferred advanced media type determination system 500 as a flow chart, constructed in accordance with the present invention. In describing this advanced media determination system 500, first an<br>
1	f      overview of the system operation will begin with respect to FIG. 15. Next will be a<br>
description of several more general portionsvof the determination system 500 with respect to FIGS. 16-19, followed by a detailed description of the heart of the determination method with respect to FIGS. 20-23. Following a description of the method, FIGS. 24-26 will be used to explain how the media sensor of FIG. 2 is used 20     in the determination routines of FIGS. 20-23, followed by graphical examples of several different types of media studied, with respect to FIGS. 27-39. In FIGS. 40 through 43, the spatial frequencies of light collected by the media type determination sensor are studied to show how system 500 determines which type of media is entering the printzone 25 of printer 20. Finally, FIG. 44 will be used to describe a<br>
2	5      preferred two-stage media determination system which speeds printer throughput<br>
(pages per minute) when printing on plain paper.<br>
26<br><br>
1. System Overview<br>
Returning to FIG. 15, the advanced media determination system 500 is shown in overview as having a first collect raw data step 502. Following collection of the raw data, a massage data routmeiS04 is performed to placetKe data collected 5      in step 502 into a suitable format for further analysis. Following the massaging data step, comes a major category determination step 506 and a specific type determination step 508. The major and specific determination steps 506 and 508 are interlaced, as will be seen with respect to FIGS. 20-23. For instance, once a major category determination is made, such as for premium paper media, then a further<br>
.0     determination may be made as to which specific type of premium media is used. However, to arrive at the major determination step for premium media, the routine must first have discarded the possibilities that the media might be a transparency, a glossy photo, a matte photo, or a plain paper media. After the method has made a specific type determination in step 508, a verification step 510 is performed to assure<br>
15      that the correct specific determination has been made. Following the verification step 510, the determination system 500 then has a select print mode step 512, which correlates the print mode to the specific type of media which is entering the printzone 25. In response to the selection of print mode step 512, the system then concludes with a print step 514, where printing instructions are sent to the<br>
20     printheads 70-76 to print an image in accordance with the print modes selected in step 512.<br>
2. Collect Raw Data Routine<br>
o   Now that the construction of the media sensor 100 is understood, its use will 25     be described with respect to the collection of raw data routine 502, which is<br>
illustrated in detail in FIG. 16. In a first step 530 of routine 502, the blue-violet LED 105 is turned on, and the brightness of the LED 105 is adjusted. Following step 530, in a scanning step 532, the printhead carriage 40 transports the media sensor 100 across the printzone 25, parallel to the scanning axis 38. During the scanning 33     Step 532, the media surface is spatially sampled and both the diffuse reflected light components 200, and the specular reflected light components 200' are collected at<br>
27<br><br>
^VO 01/32425<br>
every state transition as the carriage optical encoder reads markings along the encoder strip 45. These diffuse and specular reflectance values are stored as analog-to-digital (A/D) counts to generate a set of values for the reflectances at each encoder position along the media. In some implementations, it may be desirable to 5      scan the media several times to produce an averaged data set, although typically only one scan of the media is required to produce good results.<br>
During this scanning step 532, the sheet of media 150 is placed under the media sensor 100 at the "top of form" position. For an HP transparency media with a tape header 456, as shown in FIG. 13, the tape 456 is within the field of view, even 1 3     though at this point the tape is located along the undersurface of the media. Indeed, even though the tape header 456 is facing away from the sensor 100, as well as away from sensor 100 in the basic media type determination method 400 (FIG. 8), the markings 458,460 on the tape header 456 are viewable by sensor 100, and may be used to identify this media as described above in method 400.<br>
5	In a final checking step 534 of the raw data collection routine 502, a high<br>
level look or check is performed to determine whether all of the data collected during step 532 is actually data which lies on the media surface. For instance, if a narrower sheet of media is used (e.g. A-4 sized media or custom-sized greeting card media) than the standard letter-size media for which printer 20 is designed, some of<br>
20     the data points collected during the scanning step 532 will be of light reflected from the media support member, also known as a platen or "pivot," which forms a portion of the media handling system 24. Thus, any data corresponding to the pivot is separated in step 534 from the data corresponding to the sheet of media, which is then sent on as a collected raw data signal 536 to the massage data routine 504.<br>
25	During the analog to digital conversion portion of the scanning step 532, the<br>
A-to-D conversion is triggered at each state transition of the carriage positional encoder which monitors the optical encoder strip 45. In this manner, the data is collected with a spatial reference, that is, spatial as in "space," so the data corresponds to a particular location in space as the carriage 40 moves sensor 100<br>
2 0     across the printzone 25. For the illustrated printer 20 the sampling rate typically occurs at the rate of 600 samples per inch (1524 samples per centimeter). During<br>
28<br><br>
this scanning step 532, preferably the speed of the carriage 40 is between two and thirty inches per second (5.08 to 76.2 centimeters per second). One preferred analog-to-digital conversion is over a 0-5 volt range, with a 9-bit resolution.<br>
5     3. Massage Data Routine<br>
FIG, 17 illustrates the details of the massage data routine 504, which generates a set of four signals as outputs which are sent to the major category determination routine 506. In two steps, averages of the incoming data are found. Specifically, in a "find specular average" step 540, and a "find diffuse average"<br>
10     step 544, the averages for all of the incoming specular raw data and diffuse raw data, respectively, are found The specular, average step 540 produces a specular average signal 542, also indicated by the letter "A" in FIG. 17, which is provided as an input to the major category determination routine 506. The diffuse average step 544 produces a specular average signal 545, also indicated by the letter "B" in FIG. 17,<br>
1 j.     which is provided as an input to the major category determination routine 506.<br>
The other major operations performed by the massage data routine 504 are preformed in a "generate specular reflectance graph" step 546, and in a "generate diffuse reflectance graph" step 548. In step 548, the collected raw data is arranged with the diffuse and specular reflectance values referenced to the same spatial<br>
20     position with respect to the pivot or platen.<br>
The steps of generating the specular and diffuse reflectance graphs 546, 548 each produce an output signal, 550 and 551, which are received by two conversion steps 552 and 554, respectively. In step 552, the aligned data 550 is passed through a Harming or Welch's fourth power windowing function. Following this<br>
25     manipulation, a discrete fast Fourier transform may be performed on the windowed data to produce the frequency components for the sheet of media entering the printzone 25. In each of steps 546 and 548, the graphs are produced in terms of magnitude versus ("vs.") position, such as the graphs illustrated in FIGS. 27-33, discussed further below. The specular spatial frequency, shown as a bar chart of frequency versus the magnitude2 (magnitude squared), which is an output signal 556, also labeled as letter "S," which is supplied to the major category determination<br>
29<br><br>
routine 506. In step 554, the incoming data 551 is converted to a diffuse spatial frequency, shown as a bar chart of frequency versus the magnitude2, to produce an output signal 558, also labeled as letter "D," which is supplied to the major category determination routine 506. Examples of the graphical data provided by the 5      conversion steps 552 and 554 are shown in FIGS. 34-39, discussed further below.<br>
Thus, during the massage data routine 504, a Fourier transform is performed on the collected raw data to determine the magnitude and phase of each of the discrete spatial frequency components of the recorded data for each channel, that is, channels for the specular and diffuse photodiodes 130', 130. Typically this data<br>
10     consists of a record of 1000-4000 samples. The Fourier components of interest are limited by the response of the photodiodes 130,130' to typically less than 100 cycles per inch. The magnitude of the first order component is the DC (direct current) level of the data. This DC level is then used to normalize the data to a predetermined value that was used in characterizing signatures of known media which has been<br>
15      studied. A known media signature is a pre-stored Fourier spectrum, typically in magnitude values, for both the specular and diffuse channels for each of the media types which are supported by a given inkjet printing mechanism, such as printer 20.<br>
4. Verification and Selection of Print Mode Routines<br>
20	FIG. 18 illustrates the details of the verification and select print mode<br>
steps 510, 512 of the media determination system 500. Here we see the verification step 510 receiving incoming data from the specific type determination step 508. This incoming data is first received by a "make assumption" step 560, with this assumption regarding the specific media type. Step 560 yields an assumed specific<br>
25     type signal 562, which is received by a "determine the quality fit" step 564. The determine the quality fit step 564 is used to test the correctness of the assumption made in step 560. In a look-up step 565, a table of the various type characteristics for each specific type of media is consulted, and data corresponding to the assumed media type of signal 562 is provided to the quality fit step 564 as a reference data<br>
30      signal 566. The quality fit step 564 processes the reference values 566 and the<br>
30<br><br>
assumed media type signal 562 and provides an output signal 568 to the select print mode routine 512.<br>
The output signal 568 from the verification step 510 is received by a comparison step 570, where it is determined whether the assumption data 562 *5     matches the reference data 566. If this data does indeed match, a YES signal 571 is issued by the comparison step 570 to a "select print mode" step 572. Step 572 then selects the correct print mode for the specific type of media and issues a specific print mode signal 574 to the print step 514. However, if the comparison step 570 determines that the media type assumed step 560 does not have characteristics which<br>
' 0     match the reference data 566, then a NO signal 575 is issued. The NO signal 575 is then sent to a "select default print mode" step 576. The default print mode selection step 576 then issues a default print mode signal 578, corresponding to the major type of media initially determined, and then the incoming sheet is printed in step 514 according to this default determination. 5<br>
5. Types of Media<br>
At this point, it may be helpful to describe the various major types of media which may be determined using system 500, along with giving specific examples of media which falls into the major type categories. It must be noted that only a few of<br>
20     the more popular medias have been studied, and their identification incorporated into the specifics of the ii lustra ted determination system 500. Indeed, this is a new frontier for printing, and research is continuing to determine new ways to optically distinguish one type of media from another. The progress of this development routine is evidenced by the current patent application, which has progressed from a<br>
25     basic media determination routine 400 described in the parent application, to this more advanced routine 500 which we are now describing. Indeed, other medias remain yet to be studied, and further continuing patent applications are expected to cover these determination methods which are so far undeveloped.<br>
31<br><br>
Table 2 shows the print modes assigned by media type:<br>
Table 2: Print Modes By Media Type<br><br>
Print Mode	PM = 0	PM = 2	PM = 3	PM = 4<br>
	Plain	Premium	Photo	Transp.<br>
Default	Default	Default	Default	Default<br>
	(0.0)	(2.0)	(3,0)	(4.0)<br>
Specific A	PlarnA	Matte Photo	Gossimer	HP (Tape)<br>
	(0.1)	(2.1)	(3,0)	(4.1)<br>
Specific B		Clay Coated	Combined	<br>
		(2.2)	(3,1)	<br>
Specific C		Slight Gloss	Very Glossy	<br>
		(2.3)	(3,2)	<br>
Specific D		Greeting Card (2,4)		<br>
In the first major type category of plain paper, a variety of different plain papers have been listed previously with respect to Table 1, with the specific type of plain paper shown in graphs 42,49 and 50 being a Gilbert® Bond media, as a representative of these various types of plain paper.<br>
16	Several different.types of media fall within the premium category, and<br>
several of these premium papers have coatings placed over an underlying substrate layer. The coatings applied over premium medias, as well as transparency medias and glossy photo medias, whether they are of a swellable variety or a porous variety, are known in the art as an ink retention layer ("IRL"). The premium coatings<br>
\5     typically have porosities which allow the liquid ink to pool inside these porosities until the water or other volatile components within the ink evaporate, leaving the pigment or dye remaining clinging to the inside of each cavity. One group of prCmium papers having such porosities are formed by coating a heavy plain paper<br>
32<br><br>
with a fine layer of clay. Premium papers with these clay coatings are printed using the "2,2" print mode.<br>
Another type of premium paper has a slightly glossy appearance and is formed by coating a plain paper with a swellable polymer layer. Upon receiving ink, 3     the coating layer swells. After the water or other volatile components in the ink composition have evaporated, the coating layer then retracts to its original conformation, retaining the ink dyes and pigments which are the colorant portions of ,   the ink composition. This swellable type of media is printed with a "2,3" print<br>
mode. Another type of media which falls into the premium category is pre-scored 10     greeting card stock, which is a heavy smooth paper without a coating. However, the heavy nature of the greeting card media allows it to hold more ink than plain paper before the greeting card stock begins to cockle (referring to the phenomenon where media buckles as the paper fibers become saturated, which can lead to print he ad damage if the media buckles high enough to contact the printhead). Thus, greeting 15     card stock may be printed with a heavier saturation of ink for more rich colors in the resulting image, than possible with plain paper. The print mode selected for greeting card stock is designated as "2,4".<br>
The third major category used by the determination system 500 is photographic media. The various photo medias studied this far typically have a 20     polymer coating which is hydroscopic, that is, the coating has an affinity for water. These hydroscopic coatings absorb water in the ink, and as these coating absorb the ink they swell and hold the water until it evaporates, as described above with respect to the slightly glossy premium media. The Gossimer paper which has a print mode selection of "3,0" is a glossy media, having a sweliable polymer coating which is 25     applied over a polymer photobase substrate, which feels like a thick plastic base. Another common type of photo media is a combination media, which has a print mode of "3,1". This combination media has the same swellable polymer coating as the Gossimer media, but instead, the combination media has this coating applied over a photo paper, rather than the polymer substrate used for Gossimer. Thus, this combination photo media has a shiny polymer side which should be printed as a<br>
33<br><br>
^VO 01/3242'	-PCT/US08/29871<br>
photo type media, and a plain or dull side, which should be printed under a premium print mode to achieve the best image.<br>
The very glossy photo media which is printed according to print mode "3,2" is similar to the Gossimer media. The very shiny media uses a plastic backing layer 5     or substrate like the Gossimer, but instead applies two layers of the swellable<br>
polymer over the substrate, yielding a surface finish which is much more glossy than that of the Gossimer media.<br>
The final major media type studied were transparencies, which have not been studied beyond the two major categories described with respect to the basic media 13     determination system 400, specifically, HP transparencies or non-HP transparencies. Further research may study additional transparencies to determine their characteristics and methods of distinguishing such transparencies from one another but this study has yet to be undertaken.<br>
Before returning to discussion of the determination method 500, it should be<br>
. 15      noted that the various print modes selected by this system do not affect the normal quality settings, e.g.. Best, Normal, Draft, which a user may select. These Best/Normal/Draft quality choices affect the speed with which the printer operates, not the print mode or color map which is used to place the dots on the media. The Best/Normal/Draft selections are a balance between print quality versus speed, with<br>
20      lower quality and higher speed being obtained for draft mode, and higher quality at a lower speed being obtained for the Best mode. Indeed, one of the inventors herein prefers to leave his prototype printer set in draft mode for speed, and allow the media determination system 500 to operate to select the best print mode for the type of media being used.<br>
25	For example, when preparing for a presentation and making last minute<br>
changes to a combination of transparencies for overhead projection, premium or photo media for handouts, and plain paper for notes which the presenter is using during a speech, all of these images on their varying media may be quickly generated at a high quality, without requiring the user to interrupt the printing sequence and.<br>
3b      adjust for each different type of media used. Indeed, the last statement assumes that the user may have the sophistication to go into the software driver program screen<br>
34<br><br>
and manually select which type of media has been placed in the printer's supply tray 26. Unfortunately, the vast majority of users do not have this sophistication, and typically print with the default plain paper print mode on all types of media, yielding images of acceptable, but certainly not optimum print quality which the printer is S      fully capable of achieving if the printer has information input as to which type of media is to be printed upon. Thus, to allow all users to obtain optimum print quality matched to the specific type of media being used, the advanced media determination system 500 is the solution, at least with respect to the major types of media and the most popular specific types which have thus far been studied.<br>
6. Weighting and Ranking Routine<br>
Before delving into the depths of the major and specific media type determination routines 506,508 a weighting and ranking routine 580 will be described with respect to FIG. 19. This weighting and ranking routine 580 is<br>
15      performed during the quality fit step 564 of the verification routine 510. The specific type of assumption signal 562 is first received by a find error step 582. The find error step 582 refers to a subtable 584 of the type characteristics table 565. The subtable 584 contains the average or reference values for each spatial frequency, for each specific media type that has been studied. The find error step 582 then<br>
20     compares the value of the spatial frequency measured with the reference value of<br>
that spatial frequency with each of the values for a corresponding frequency stored in table 584 for each media type, and during this comparison generates an error value, that is, the difference between the frequency value measured versus the value of the corresponding frequency for each media type. The resulting error signals are sent to<br>
25      a weight assigning step 585.<br>
The weight assigning step 585 then refers to another subtable 586 of the look-up table 565. The subtable 586 stores the standard deviation which has been found during study at each spatial frequency for each type of media. The assigning step 585 then uses the corresponding standard deviation stored in table 586 to each of the errors produced by step 582. Then all of the weighted errors produced by step 585 are ranked in a ranking step 588. After the ranking has been assigned by<br>
35<br><br>
step 588, the ranking for each media type are summed in the summing step 590. Of course, on this first pass through the routine, no previous values have been accumulated by step 590.<br>
Following the summing step 590, comes a counting step 592, or the 6     particular frequency X under study is compared to the final frequency value n. If the particular frequency X under study has not yet reached the final frequency value n, the counting step 592 issues a NO signal 594. The NO signal 594 has been received by an incrementing step 595, where the frequency under study X is incremented by one ("X = X + 1"). Following step 595, steps 582 through 592 are repeated until 10     each of the frequencies for both the spatial reflectance and the diffuse reflectance have been compared with each media type by step 582, then assigned a weighting factor according to the standard deviation for each frequency and media type by step 585, ranked by step 588, and then having the ranking summed in step 590.<br>
Upon reaching the final spatial frequency N, the counting step 592 finds that 15     the last frequency N has been reached (X = N) and a YES signal 596 is issued. Upon receiving this YES signal 596, a selection step 598 then selects the specific type of media by selecting the highest number from the summed ranking step 590. This specific type is then output as signal 568 from the verification block 510. It is apparent that this weighting and ranking routine 580 may be used in conjunction 20     with various portions of the determination method 500 to provide a more accurate guess as to the type of media entering the printzone 25.<br>
During the weighting and ranking routine 580, for a standard letter-size sheet of media analyzing both the specular and diffuse readings for a given sheet of media, a total of 84 events are compared for both the specular and diffuse waveforms for 2 5      each media type. It is apparent that, while the subject media entering the printzone has been compared to each media type by incrementing the frequency, other ways could be used to generate this data, for instance by looking at each media type separately, and then comparing the resulting ranking for each type of media rather than incrementing by frequency through each type of media. However, the ittttstrated method is preferred because it more readily lends itself to the addition of new classifications of media as their characteristics are studied and compiled.<br>
36<br><br>
Each component of the pre-stored Fourier spectrum for each media type has an associated deviation which was determined during the media study. The standard deviations stored in the look-up table 586 of FIG. 19 are preferably arrived at by analyzing the spectra over many hundreds of data scans for many hundreds of pages<br>
^5     of each specific type of media studied. The difference between each component of the fresh sheet of media entering the printzone 25 and each component of the stored signatures is computed in the find error step 582 of FIG. 19. The ratio ("x') of the error to the standard deviation is then determined. If this ratio is found to be less than two (x 
10     found to be between two and three (2  3), then the error is weighted by a factor of four (4). This "weighting" of step 585 then takes into account the statistical set for each of the characterized media types which have been studied. In the illustrated embodiment, the media type with the lowest weighted<br>
15     error is assigned a ranking of three (3) points. The media type with the second<br>
lowest error is assigned a ranking of two (2) points, and the media type with the third lowest error is given a ranking of one (1) point, as shown in FIG. 19.<br>
The media type having the highest sum of the ranking points across all of the specular and diffuse frequency components is then selected as the best fit for<br>
2J     characterizing the fresh sheet of media entering the printzone 25. The select print mode routine 512 then selects the best print mode, which is delivered to the printing routine 514 where the corresponding rendering and color mapping is performed to generate an optimum quality image on the particular type of media being used.<br>
37<br><br>
7. Major Category &amp; Specific Type Media Type Determination Routines<br>
Having dispensed with preliminary matters, our discussion will now turn to the major category determination and the specific type determination routines 506 5     and 508. This discussion will cover how the routines 506 and 508 are interwoven to provide information to multiple verification and select print mode steps, ultimately resulting in printing an image on the incoming sheet of media according to a print mode selected by routine 500 to produce an optimum image on the sheet, in light of the available information known. FIGS. 20-23 together describe the major category<br>
10     and specific type determination routines 506 and 508.<br>
Referring first to FIG. 20, the massage data routine 504 is shown as first supplying the specular and diffuse spatial frequency data 556 and 558 to a match signature step 600. Step 600 receives an input signal 602 from a major category look-up table 604. Table 604 contains both specular and diffuse spatial frequency<br>
15     information for a generic glossy finish media and a generic dull finish media. The term "generic" here means an average or a general category of information, basically corresponding to a gross sorting routine. The match signature routine 600 then compares the incoming massaged data for both the specular and diffuse reflectances 556 and 558 with the reference values 602 from table 604, and then<br>
10     produces a match signal 605. In a comparison step 606, the question is asked<br>
whether the incoming matched data 605 corresponds to media having a dull finish. If it does, a YES signal 608 is issued to a plain paper, premium paper, or a matte photo branch routine 610. The photo branch routine 610 issues an output signal 612, which is further processed as described with respect to FIG. 22 below. However, if<br>
25      the dulled determination step 606 determines that the match signature output<br>
signal 605 is not dull, a NO signal 614 is issued to a photo or transparency decision branch 615.<br>
The photo or transparency branch 615 sends a data signal 616 carrying the massaged specular and diffuse spatial frequency data 556 and 558 to another match signature step 618. A second major category look-up table 620 supplies an input 622 to the second match signature step 618. The data supplied by table 620<br>
38<br><br>
is specular and diffuse spatial frequency information for two types of media, specifically a generic photo finish media, and a generic transparency media. The match signature step 618 then determines whether the incoming data 616 corresponds more closely to a generic photo finish data, or a generic transparency 5     data according to a gross sorting routine. An output 624 of the match signature step 618 is supplied to a comparison step 626, which asks whether the match signature output signal 624 corresponds to a transparency. If not, a NO signal 628 is issued to a glossy photo or a matte photo branch 630.<br>
However, if the match signature output 624 corresponds to a transparency,<br>
10     then the comparison step 626 issues a YES signal 632. For the yes transparency signal 632 is received by a ratio generation step 634. In response to receiving the YES signal 632, the ratio generation step 634 receives the average specular (A) signal S42, and the average diffuse (B) signal 545 from the massage data routine 504. From these incoming signals 542 and 545, the ratio generation step 634<br>
15     then generates a ratio of the diffuse average to the specular average (B/A) multiplied by 100 to convert the ratio to a percentage, which is supplied as a ratio output signal 635. In a comparison step 636, the value of the ratio signal 635 is compared to determine if the ratio B/A as a percentage is less than a value of 80 per cent (with the t4%" sign being omitted in FIG. 20 for brevity). If not, the comparison step 636<br>
20     issues a NO signal 638 to the glossy photo or matte photo branch 630.<br>
Thus, the average specular and diffuse data are used as a check to determine whether the transparency determination was correct or not. If the ratio that the diffuse averaged to the specular average is determined by step 636 to be less than 80, a YES signal 640 is then supplied to a verification step 642. The verified step 642<br>
25     may be performed as described above with respect to FIG. 18. During this<br>
verification routine, an assumption is made according to step 560 that the media in the printzone is a transparency, and if the verification routine 642 determines that it indeed is, a YES signal 644 is issued. The YES signal 644 is received by a select transparency mode step 646, which issues a transparency print signal 648 to initiate a tcansparency step 650. The print mode selected by step 646 corresponds to a "4,0" print mode, here selecting the default value for a transparency.<br>
39<br><br>
If a Hewlett-Packard transparency is identified, as described above with respect to FIG. 13, then a custom print mode may be employed for the specific HP transparency media, as described above with respect to the basic media determination system 400, resulting in a "4,1" print mode. If the verification 5      step 642 determines that the media in the printzone is not a transparency, then a NO signal 652 is issued. Upon receiving the NO signal 652, a select default step 654 chooses the default premium print mode, and issues a print signal 656. Upon receiving signal 656, a print step 658 then prints upon the media according to the generic premium media print mode "2,0".<br>
10	FIG. 21 begins with the glossy photo or matte photo branch 630 from<br>
FIG. 20, which, issued an output signal 660, carrying through the massaged specular and diffuse spatial frequency data (S and D) signals 556 and 558. This input signal 660 is received by a determination step 662 which determines whether the incoming data 660 corresponds to a specific type of glossy media or a specific type<br>
15      of matte photo media. To accomplish this, a specific media look-up table 664 provides an input signal 665 to the determination step 662. Table 664 contains reference data corresponding to the specular and diffuse spatial frequencies corresponding to various types of glossy photo media and matte photo media, illustrated in table 664 as "glossy A", "glossy B", and so on through "matte A",<br>
20     "matte B", and so on. Several types of glossy photo media and matte photo media were described above with respect to Table 2.<br>
Once the determination step 662 finds a suitable match from the values stored in table 664, an output signal 667 is issued to a comparison step 668. The comparison step 668 asks whether the incoming signal 667 is for a matte photo<br>
25      media. If so, a YES signal 670 is issued. The'YES signal 670 is then delivered to the plain paper/premium paper/matte photo branch 610, as shown in FIGS. 20 and 22. If the comparison step 668 finds that the output of determination step 662 does not correspond to a matte photo, then a NO signal 672 is issued. The NO signal 672 delivers the specular and diffuse spatial frequency data to another determination step 674. Step 674 determines which specific type of glossy photo media is entering the printzone 25 using data received via signal 675 from a glossy<br>
40<br><br>
photo look-up table 676. While tables 664 and 676 are illustrated in the drawings as two separate tables, it is apparent that the determination step 674 could also query table 664 to obtain glossy photo data for each specific type.<br>
After step 674 determines which specific type of glossy photo media is in the 5     printzone 25, a signal 678 is issued to a verification routine 680 which proceeds to verify the assumption as described above with respect to FIGS. 18 and 19. If the verification routine 680 finds that the determination step 674 is correct, a YES signal 682 is issued to a select specific glossy photo print mode step 684. The selection step 684 generates a print mode signal 686 which initiates a print step 688. 13     The printing step 688 then prints upon the sheet of glossy photo media using the print mode corresponding to the selected media, here according to "3,0" print mode for Gossimer media, a "3,1" print mode for the combination media, and a "3,2" print mode for the very glossy photo media.<br>
If the verification routine 680 finds that the determination step 674 was 15     wrong regarding the specific type of glossy photo selected, a NO signal 690 is<br>
issued. In response to receiving the NO signal 690, a select default step 692 selects a generic glossy photo print mode and issues signal 694 to a print step 696. The print step 696 then prints upon the media according to a generic print mode, here selected as "3t0" print mode.<br>
23	Travelling now to FIG. 22, we see the plain paper/premium paper/matte<br>
photo branch 610 receiving an input signal 608 from FIG. 20, and another input signal 670 from FIG. 21. Both signals 608 and 670 carry the specular and diffuse spatial frequency data for the media entering printzone 25. In response to receiving either signal 608 or 670, the branch 610 issues an output signal 612 carrying the 25      spatial frequency data to a match signature routine 700. The match signature<br>
routine 700 reviews reference data 702 received from a look-up table 704 where data is stored for a generic dull finish media and a generic matte photo finish media. When the matching step 700 has completed analyzing the incoming data 612 with respect to the data 702 stored in table 704, an output signal 705 is issued.<br>
A comparison step 706 reviews the output signal 705 to determine whether the matching step 700 found the incoming media to have a matte finish. If not, the<br>
41<br><br>
comparison step 706 issues a NO signal 708 which is delivered to a plain paper/premium paper branch 710. In response to receiving the NO signal 708, branch 710 issues an output signal 712 which transitions to the last portion of the major and specific type determination routines 506, 508 shown in FIG. 23. Before 5     leaving FIG. 22 we will discuss the remainder of the steps shown there.<br>
If the comparison step 706 determines that the matching step 700 found the incoming media to have a matte finish, a YES signal 714 is issued. A determination step 715 receives the YES signal 714, and then determines which specific type of matte photo media is entering the printzone 25. The determining step 715 receives a 10     reference data signal 716 from a matte photo look-up table 718, which may store data for a variety of different mane photo medias. Note that while table 718 is shown as a separate table, the determination step 715 could also consult the specific media look-up table 664 of FIG. 21 to obtain this data. Note that for the purposes of illustration, data is shown in both tables 664 and 718 for a "Matte A" and "Matte B" 15      media, to date the characteristics for only a single matte photo media has been identified, and further research is required to generate reference data to allow identification of other types of matte photo media.<br>
Following the completion of the determination step 715, an output signal 720 is issued to a verification routine 722. If the verification routine 722 determines that 20     the correct type of matte photo media has been identified, a YES signal 724 is issued. In response to the YES signal 724, a selecting step 726 chooses which specific matte photo print mode, to use, and then issues a signal 728 to a printing step 730. The printing step 730 then uses a "2,1" print mode when printing on the incoming sheet. If the verification routine 722 finds that the determination step 715 25      was in error, a NO signal 732 is issued. A selecting step 734 responds to the<br>
incoming NO signal 732 by selecting a default matte photo print mode. After the selection is made, step 734 issues an output signal 736 to a printing step 738. In the printing step 738, the media is then printed upon using the default print mode, here a "2,0" print mode which corresponds to the default print mode for premium paper inthe illustrated embodiment.<br>
42<br><br>
Turning now to FIG. 23, the plain paper/premium paper branch 710 is shown issuing an output signal 712 which includes data for both the specular and diffuse spatial frequency of the media entering the printzone 25. In response to receiving signal 712, a matching step 740 compares the incoming data with reference data 5      received via a signal 742 from a look-up table 744. The look-up table 744 stores data corresponding to a generic plain finish media, and a generic premium finish media. The matching step 740 then decides whether the incoming data 712 more closely corresponds to a plain paper media, or a premium paper and issues an output signal 745. In a comparison step 746, the question is asked whether the output of the<br>
1)     matching step 740 corresponds to a premium paper. If not, then a NO signal 748 is issued to a determination step 750.<br>
The determination step 750 uses reference data received via a signal 752 from a plain paper look-up table 754. The look-up table 754 may store data corresponding to different types of plain paper media which have been previously<br>
15      studied. Once the determination step 750 decides which type of plain paper is entering the printzone, an output signal 755 is issued. A verification routine 756 receives the output signal 755 and then verifies whether or not the sheet of media entering the printzone 25 actually corresponds to the type of plain paper selected in the determination step 750. If the verification step 756 finds that a correct selection<br>
20     was made, a YES signal 758 is issued to a selecting step 760. In the selecting step 760, a print mode corresponding to the specific type of plain paper media identified is chosen, and an output signal 762 is issued to a printing step 764. The printing step 764 then prints on the incoming media sheet according to a "0,1" print mode.<br>
25	If the verification step 756 finds that the determination step 750 was in error,<br>
a NO signal 765 is issued to a selecting step 766. In the selecting step 766, a default plain paper print mode is selected, and an output signal 768 is issued to a printing step 770. In the printing step 770, the incoming sheet of media is printed upon according to a "0," default print mode for plain paper.<br>
36	Returning to the premium comparison step 746, if the media identified in the<br>
match signature step 740 is found to be a premium paper, a YES signal 772 is<br>
43<br><br>
issued. In response to receiving the YES signal 772, a detern    dtion step 774 then determines which specific type of premium media is in the printzone 25. To do this, the determination step 774 consults reference data received via signal 775 from a premium look-up table 776. Upon determining which type of specific premium 5      media is entering the printzone 25, the determination step 774 issues an Output signal 778. Upon receiving signal 778, a verification step 780 is initiated to determine the correctness of the selection made by step 774. If the verification step 780 determines that yes indeed a correct determination was made by 774, a YES signal 782 is issued to a selecting step 784. The selecting step 784 then selects the specific premium<br>
10      print mode corresponding to the specific type of premium media identified in<br>
step 774. After the selection is made, an output signal 785 is issued to a printing step 788. The printing step 788 then prints upon the incoming sheet of media according to the specific premium print mode established by step 784, which may be a "2,2" print mode corresponding to premium media having a clay coating, a "2,3"<br>
1S      print mode corresponding to a plain paper having a swellable polymer layer, or "2,4" print mode corresponding to a heavy greeting card stock, in the illustrated embodiments.<br>
If the verification step 780 finds that the determination step 774 was in error, a NO signal 790 is issued to a selecting step 792. In the selecting step 792, a default<br>
20      premium print mode is selected and an output signal 794 is issued to another printing step 796. In the printing step 796, the incoming sheet of media is printed upon according to a default print mode of "2,0".<br>
8. Operation of the Media Sensor<br>
25	The next portion of our discussion delves into one preferred construction of<br>
the media sensor 100 (FIG. 2) and the differences between the advanced media type detection system 500 and the earlier basic media type determination system 400.<br>
The basic media determination system 400 only uses the diffuse reflectance information. The basic system 400 extracted more information regarding the unique reflectance properties of media by performing a Fourier transform on the diffuse data. The spatial frequency components generated by the basic method 400<br>
44<br><br>
characterized the media adequately enough to group media into generic categories of<br>
(1) transparency media, (2) photo media, and (3) plain paper. One of the main<br>
advantages of the basic method 400 was that it used an existing sensor which was<br>
already supplied in a commercially available printer for ink droplet sensing.	A<br>
5     more advanced media type determination was desired, using the spatial frequencies of only the diffuse reflectance with sensor 100 was not adequate to uniquely identify the specific types of media within the larger categories of transparency, photo media and plain paper. The basic determination system 400 simply could not distinguish between specialty media, such as matte photo media, and premium media. To make<br>
1C      these specific type distinctions, more properties needed to be measured, and in<br>
particular properties which related to the coatings on the media surface. The manner chosen to gather information abbut these additional properties was to collect the specular reflectance light 200', as well as the diffuse reflectance light 200.<br>
In the advanced media sensor 100 uses a blue-violet LED 105 which has an<br>
15     output shown in FIG. 3 as graph 112. In graph 112, we see the blue-violet LED 105 has a peak amplitude output at about 428 nanometers. The output also extends down to approximately 340 nanometers, into the ultraviolet range past the end of the visible range, which is around 400 nanometers, with a dominant wavelength of 464 nanometers. While the illustrated peak wavelength of 428 nanometers is shown, it is<br>
20     believed that suitable results may be obtained with an LED having a peak wavelength of 400-430 nanometers.<br>
The short wavelength of the blue-violet LED 105 serves two important purposes in the collecting raw data routine 502. First, the blue-violet LED 105 produces an adequate signal from all colors of ink including cyan ink, so the<br>
25      sensor 100 may be used for ink detection, as described in U.S. Patent No. 6,036,298, recited in the Related Applications section above. Thus, the diffuse reflection measured by photodiode 130 of sensor 100 may still be used for performing pen alignment. The second purpose served by the blue-violet LED 105 is that the shorter wavelengths, as opposed to a 700-1100 nanometer infrared LED, is superior for<br>
30     detecting subtleties in the media coding, as described above with respect to Table 2.<br>
45<br><br>
FIG. 24 shows the media sensor 100 scanning over the top two millimeters of a sheet of media 150 entering the printzone 25. Here we see an incoming beam 800 generating a specular reflectance beam 802 which passes through the field stop window 144 to be received by the specular photodiode 130'. A second illuminating 5      beam of light 804 is also shown in FIG. 24, along with its specular reflectance beam 806. As mentioned above, recall that the specular beam has an angle of reflection which is equal to the angle of incidence of the illuminating beam, with respect to a tangential surface of the media at the point of illumination. The sheet of media 150 is shown in FIG. 24 as being supported by a pair of cockle ribs 810 and 812, which<br>
1 0     project upwardly from a table-like portion of the platen or pivot 814. The cockle ribs 810, 812 support the media in the printzone 25, and provide a space for printed media which is saturated with ink to expand downwardly between the ribs, instead of upwardly where the saturated media might inadvertently contact and damage the printhead.<br>
15	Some artistic license has been taken in configuring the views of FIGS. 24-26,<br>
37 and 38 with respect to the orientation of the media sensor 100. The cockle ribs 810 and 812 are orientated correctly to be perpendicular to the scan axis 38; however, the LED 105 and sensors 130, 130' are oriented perpendicular to their orientation in the illustrated embodiiuwit of printer 20. FIG. 4 shows the desired<br>
20     orientation of the media sensor 100 in printer 20 with respect to the XYZ coordinated axis system.<br>
As the incoming sheet of media 150 rests on the ribs 810, 812 peaks are formed in the media over the ribs, such as peak 815, and valleys are also formed between the ribs, such as valley 816. The incoming beam 800 impacting along the<br>
25     valley 816 has an angle of incidence 818, and the specular reflected beam 802 has an angle of reflection 820, with angles 818 and 820 being equal. Similarly, the incoming beam 804 has an angje of incidence 822, and its specular reflected beam 806 has an angle of reflection 824, with angles 822 and 824 being equal. Thus, as the incoming light beams 800, 804 are moved across the media as the rnmaop 40 moves the media sensor 100 across the media in the direction of the scanning axis 38, the light beams 800, 804 traverse over the peaks 815, and through<br>
46<br><br>
the valleys 816 which causes the specular reflectance beams 802 and 806 to modulate with respect to the specular photodiode 130'. Thus, this interaction of the media 150 with the cockle ribs 810, 812 on the media support platen 814 generates a modulating set of information which may be used by the advanced determination 5     method 500 to learn more about the sheet of media 150 entering the printzone 25.<br>
9. Energy Information<br>
Information to identify an incoming sheet of media may be gleaned by knowing the amount of energy supplied by the LED 105 and the amount of energy 1)     which is received by the specular and diffuse photodiodes 130', 130. For example, assume that the media ! 50 in FIG. 24 is a transparency. In this case, some of the incoming light from beam 800 passes through the transparency 150 as a transmissive beam 825. Thus, the amount of energy left to be received by the diodes 130 and 130' is less than for the case of plain paper for instance. In between the plain paper and 1 5     the transparency paper is the reflectance of the glossy photo media, which has a<br>
shinier surface that yields more specular energy to be received by diode 130', than a diffuse energy to be received by photodiode 130.<br>
These differences in energy are shown in Table 3 below and provide one way to do a gross sorting of the media into three major categories. 20<br>
Table 3: Enerqv Received by Sensors 130 and 130*<br>
Media Category	Diffuse Sensor 130	Specular Sensor 130'<br>
Plain &amp; Premium Papers                    1/2	1/2<br>
Glossy Photo	1/3	2/3<br>
Transparency (w/o Tape)	1/5	4/5<br>
Furthermore, by knowing the input energy supplied by the blue-violet LED 105, and the output energy received by the specular and diffuse sensors 130 an*3 130', the value of the transmittance property of the media may be determined, that is the amount of energy within light beam 825 which passes through media sheet<br>
47<br><br>
150 (see FIG. 24). The magnitude of the transmittance is equal to the input energy of the incoming beam 800, minus the energy of the specular reflected beam 802 and the diffuse reflected beam, such as light 200 in FIG. 2. After assembly of the printer 20, during initial factory calibration, a sheet of plain paper is fed into the printzone 5      25, and the amount of input light energy from the LED 105 is measured, along with the levels of energy received by the specular and diffuse sensors 130' and 130. Given these known values for plain paper, the transmittance for photo paper and transparency media may then be determined as needed. However, rather than calculating the transmissivity of photo papers and transparency media, the preferred<br>
10      method of distinction between plain or premium paper, photo paper and transparency media is accomplished using the information shown in Table 3.<br>
Thus in the case of a transparency, the majority of the diffuse energy travels directly through the transparency, with any ink retention layer coating over the transparency serving to reflect a small amount of diffuse light toward the<br>
15      photodiode 130. The shiny surface of the transparency is a good reflector of light, and thus the specular energy received by photodiode 130' is far greater than the energy received by the diffuse photodiode 130. This energy signature left by these broad categories of media shown in Table 3 may be used in steps 552 and 554 of the determination system 500. The energy ratios effectively dictate the magnitude of the<br>
2!0      frequency components. For a given diffuse and specular frequency, the energy balance may be seen by comparing their relative magnitudes.<br>
10. Media Support Interaction Information<br>
As mentioned above with respect to FIG. 24, interaction of the media with 2 5      the printer's media support structure, here the pivot, may be used to gather<br>
information about the incoming sheet of media. In other implementations, this information may be gathered in other locations by supporting the media sensor 100 with another printing mechanism component, and backing the media opposite the sensor with a component having a known surface irregularity which imparts a degree 30      offending to the media, as well as changing the apparent transmissivity of the<br>
media. For instance, in plotters using media supplied in a continuous roll, a cutter<br>
48<br><br>
traverses across the media following a print job to sever the printed sheet from the remainder of the supply roll. The sensor 100 may be mounted on the cutter carriage to traverse the media, although such a system may require the leading edge of the incoming sheet to be moved rearwardly into a top-of-form position under the 5      printheads following scanning. Indeed, in other implementations, it may be desirable to locate the media scanner 100 remote from the printzone 25, such as adjacent the media supply tray, or along the media path between the supply tray and the printzone 25, provided that the media was located between the sensor and a backing or support member having a known surface irregularity opposite the media 1©      sensor 100.<br>
In the illustrated printer 20, the cockle ribs 810 and 812 generate a modulating signature as the sensor 100 passes over peaks 815 and valleys 816 on the media sheet 150. The degree of bending of the media sheet 150 over the ribs 810 and 812 is a function of the media's modulus of elasticity (Young's Modulus).<br>
15      Thus, the degree of bowing in the media sheet 150 may be used to gather additional information about a sheet entering the printzone 25.<br>
For example, some premium media have the same surface properties as plain paper media, such as the greeting card media and adhesive-backed sticker media. However, both the sticker media and the greeting card media are thicker than<br>
2D     convention plain paper media so the bending signatures of these premium medias are different than the bending signature of plain paper. In particular, the spatial frequency signatures are different at the lower end of the spatial frequency spectrum, particularly in the range of 1.4 to .1 cycles per inch. In this lower portion of the spatial frequency spectrum, lower amplitudes are seen for the thicker premium<br>
25      media as well as for glossy photo and matte photo medias. Thus, the signature imparted by the effect of the cockle ribs 810, 812 may be used to distinguish premium media and plain paper, such as in steps 710 of the determination system 500. It is apparent that other printing mechanisms using different media support strategies in the printzone 25, other than ribs 810 and 812 or other<br>
30      configurations of media support members may generate their own unique set of properties which may be analyzed to impart a curvature to the media at a known<br>
49<br><br>
location (S) and this known information then used to study the degree of bending imparted to the different media types.<br>
11. Surface Coating Information<br>
5	While the effect of the cockle ribs 810, 812 is manifested in the lower spatial<br>
frequencies, such as those lower than approximately 10 cycles per inch, the effect of the surface coatings is seen by analyzing the higher spatial frequencies, such as those in the range of 10-40 cycles per inch. FIG. 25 illustrates a coated sheet of media 830, having a backing sheet or substrate 832 and a coating 834, such as an ink 1C      retention layer of a swellable material, or of a porous material, several examples of which are discussed above with respect to Table 2. In FIG. 25, we see one incoming light beam 835 which travels through the coating layer 834 and the substrate 832, and is reflected off of the rib 810 as a specular reflected beam 836. Another incoming beam 838 from the blue-violet LED 105 is shown generating three<br>
1	&gt;     different types of reflected beams: (1) a group of diffuse beams 840 which are<br>
received by the diffuse sensor 130, (2) an upper surface reflected specular beam 842 which is received by the specular sensor 130', and (3) a boundary layer specular reflected beam 844 which is formed when a portion of the incoming beam 838 goes through the coating layer 834 and reflects off a boundary 845 defined between the<br>
2	)     substrate 832 and the coating layer 834. This boundary 845 may also be considered<br>
to be the upper surface of the substrate layer 832.<br>
The characteristics provided by the boundary reflected beam 844 may be used to find information about the type of coating 834 which has been applied over the substrate layer 832. For example, the swellable coatings used on the glossy<br>
^5     photo media and the slightly glossy premium media described above with respect to Table 2 are typically plastic polymer layers which are clear, to allow one to see the ink droplets trapped inside the ink retention layer 834. Different types of light transmissive solids and liquids have different indices of refraction, which is a basic principle in the study of optics. The index of refraction for a particular material,<br>
20     s"Ch as glass, water, quartz, and so forth is determined by the ratio of the speed of light in air versus the speed of light in the particular media. That is, light passing<br>
50<br><br>
through glass moves at a slower rate than when moving through air. The slowing of the light beam entering a solid or liquid is manifested as a bending of the light beam at the boundary where the beam enters the media, and again at the boundary where the light beam exits the optic media. This change can be seen for a portion 846 of f&gt;v   the incoming light beam 838. Rather than continuing on the same trajectory as the incoming beam 838, beam 846 is slowed by travel through the coating layer 834 and thus progresses at a more steep angle toward the boundary layer 845 than the angle at which the incoming beam 838 encountered the exterior surface of coating layer 834, The angle of incidence of the incoming beam 846 is then equal to the<br>
10     angle of reflection of the reflected beam 848 with respect to the boundary layer 845. As the reflected beam 848 exits the coating layer 834, it progresses at a faster rate in the surrounding air, as indicated by the angle of the remainder of the reflected beam 844.<br>
Now that the index of refraction is better understood, as the ratio of the speed<br>
15     of light in air versus the speed of light in a particular medium, this information can be used to discover properties of the coating layer 834. As mentioned above, "dispersion ' is the change in the index of refraction with changes in the wavelength of light. In plastics, such as the polymer coatings used in the glossy photo media and some premium medias, this dispersion increases in the ultra-violet light range. Thus,<br>
20     the use of the blue-violet LED 1 OS instead of the blue LED 120 advantageously accentuates this dispersion effect Thus, this dispersion effect introduces another level of modulation which may be used to distinguish between the various types of glossy photo media as the short wavelength ultra-violet light (FIG. 3) accentuates the change in the angle of the exiting beam 844, and this information is then used to<br>
25     distinguish specific photo glossy medias. This modulation of the dispersion may be used in step 574 of the media determination system 500.<br>
Note in FIG. 24, that the transmissive beam 825 has been drawn with a bit of artistic license, in the fact that the angle of incidence has been ignored as the transmissive beam 825 is shown going straight through the sheet 150, although it is<br>
30     now better understood that a more correct illustration which show a steeper path<br>
through the sheet of media than through the surrounding air. Before moving on, one<br>
51'<br><br>
further point should be noted concerning the effect of the ribs 810, 812 on the information collected by the media sensor 100. FIG. 24 shows the transmissive beam 825 travelling through the sheet of media 150 between ribs 810 and 812, whereas FIG. 25 shows an incoming beam 835 being reflected off of rib 810 as the 5     specular reflected beam 836. While the media shown in FIG. 25 is a coated substrate, even plain paper will reflect light off of the ribs 810 as shown for beam 836. Thus, more light is seen by the specular sensor 130* when the sensor 100 passes over a rib 810, 812 then the amount of light received when the sensor 100 passes through a valley 816 between the ribs. The lower energy received when<br>
10     traversing a valley 816 is due to the fact that not all of the energy supplied by the<br>
incoming beam 800 is reflected to sensor 130' at 802, because some of the incoming energy passes through the media 150 in the form of the transmissive beam 825. Thus, the variations in energy levels received by the specular sensor 130' varies with respect to the presence or absence of ribs 810, 812.<br>
15	FIG. 26 illustrates two other methods by which the various types of media<br>
may be classified using the determination system 500. In FIG. 26 we see a multi-layered sheet of media 850, which has a backing or substrate layer 852 and a clear swellable coating layer 854. Here we see a substrate layer 852 which has a rough surface, forming a rough boundary 855 between the coating layer 854 and the<br>
20     substrate 852. Depending upon at which point an incoming beam of light 856<br>
impacts the boundary layer 855, the resulting reflected specular beam 858 has a high modulation as the beam traverses over the rough boundary layer 855 as moved by carriage 40 parallel to the scanning axis 38. The media 850 in FIG. 26 has a rough backing layer, whereas the illustrated media 830 in FIG. 25 has a backing layer<br>
25     which performs a smooth internal boundary 845. As described above with respect to Table 2, Gossimer media has a swellable polymer coating which is applied over a polymer photo substrate, with the substrate having a smooth surface more resembling media 830 of FIG. 25. The very glossy media which has two layers of a polymer coating over a plastic backing substrate also has a smooth boundary<br>
30     la^er 845 as shown in FIG. 25. However, the combination photo media has the same polymer coating as the Gossimer media, but this coating is applied over a photo<br>
52<br><br>
¦paper, which may have rougher boundary more closely resembling boundary layer 855 in FIG. 26. Thus, this information about the boundary layer 855 may be used to distinguish between specific types of photo media, such as in step 674 (FIG. 21) of the determination system 500.<br>
5	The other phenomenon that may be studied with respect to FIG. 26 is the<br>
characteristics of the specular beam reflecting off of the upper surface of the coating layer 854. In FIG. 26, an incoming light beam 860 is shown reflecting off of an upper surface 862 of the coating layer 854, to produce a specular reflected beam 864. As mentioned above, the ink retention layers formed by coatings, such as 10     coating 854 are clear layers, which are typically applied using rollers to spread the coating 854 over the substrate 852. In the medias under study thus far, it has been found that different manufacturers use different types of rollers to apply these coating layers 854. The uniqueness of each manufacturer's rollers imparts a unique signature to the upper surface 862 of the coating layer 854. That is, during this<br>
15     coating application process, the rollers create waves or ripples on the surface 862, as shown in FIG. 26. These ripples along the coating upper surface 862 have low magnitude, high frequency signatures which may be used to distinguish the various glossy photo media types.<br>
Alternatively, rather than looking for specific modulation signatures in the<br>
20     specular spatial frequency graph, the ripples formed in the upper surface 862 also impart a varying thickness to the ink retention layer 854. This varying thickness in the coating layer 854 produces changes in the boundary reflected beam 858, as the incoming beam 856 and the reflected beam 858 traverse through varying thicknesses of the ink retention layer 854. It should be noted here, that the swellable coatings on<br>
25     the photo medias, such as the Gossimer media, the combination media, and the very glossy photo media experience this rippling effect along the coating upper surface 862. In contrast, the porous coatings used on the premium medias, such as the matte photo media, or the clay coated media are very uniform coatings, having substantially no ripple along their upper surfaces, as shown for the media sheet 830 iirflG. 25. Thus, the surface properties of the coatings may be used to distinguish the swellable coatings which have a rippled or rough upper surface from the porous<br>
53<br><br>
premium coatings which have very smooth surface characteristics. The one exception in the premium category of Table 2 is the slightly glossy media which has a swellable ink retention layer like coating 854 of FIG. 26, but which is applied over a plain paper. This slightly glossy media having a swellable ink retention layer (IRL) 5      applied over plain paper miay be distinguished from media having a swellable IRL over photo paper by comparing the rough nature of the plain paper and with the smoother surface of the photo paper at the boundary layer 855 in FIG. 26. Alternatively, the peaks 815 and valleys 816 formed by ribs 810 and 812 may be used to make this distinction, knowing that the photo paper substrate is stiffer and<br>
O     bends less than the plain paper substrate when traveling through the printzone 25, yielding different reflectance signatures.<br>
Another advantage of using the ultra-violet LED 105, is that refraction through the polymer coating layers 834, 854 increases as the wavelength of the incoming light beams decreases. Thus, by using the shorter wavelength ultra-violet 5      LED 105 (FIG. 3), the refraction is increased. As the thickness of the coating 854 thickens, or the index of the refraction varies, for instance due to composition imperfections in the coating, the short wavelength ultra-violet light refracts through a sufficient angle to move in and out of the field of view of the specular sensor 130'. As shown in FIGS. 4,24 and 25-26, the specular field stop 140 has the window 144<br>
20     oriented with the minor axis 149 aligned along a central axis of the sensor 100.<br>
Thus, the specular field stop 140 provides a very small field of view in the axis of illumination, which is shown parallel to the page in FIGS. 24-26. Thus, this modulation of the specular reflected beams 802, 858 and 864 is more acutely sensed by the specular photodiode 130' as these beams move in and out of the field stop<br>
25      window 144.<br>
54<br><br>
12. Raw Data Analysis<br>
Now it is better understood how the advanced media determination system 500 uses the data collected by the media sensor 100, several examples of raw data collected for various media types will be discussed with respect to FIGS. 27-33. 5     The next section will discuss the resulting Fourier spectrum components which are generated from this raw data in the massaging data routine 504.<br>
FIG. 27 shows the raw data collected during routine 502 for the very glossy photo media. Here we see the specular data curve 870. FIG. 27 also shows a diffuse curve 872. FIG. 28 shows the raw data for a glossy photo media, and in particular<br>
10     Gossimer, with a specular data being shown by curve 874, and the diffuse data being shown by curve, 876. FIG. 29 shows the raw data for a matte photo media, with the specular data being shown as curve 878, and the diffuse data shown as curve 880. FIG. 30 shows the raw data for a plain paper media, specifically Gilbert® bond media, with the specular data being shown as curve 882, and the diffuse data being<br>
15     shown as curve 884. FIG. 31 shows the raw data for a premium media, with the specular data being shown as curve 886, and the diffuse data being shown as curve 887. FIG. 32 shows the raw data for HP transparency media, with the specular data being shown as curve 888, and the diffuse data being shown as curve 889. FIG. 33 shows the raw data for a generic transparency media, with the specular data<br>
20     being shown as curve 890, and the diffuse data being shown as curve 892.<br>
As described above with respect to Table 2, the very glossy photo media has two layers of a swellable polymer applied over a plastic backing substrate layer, resembling the media 850 in FIG. 26. The specular curve 870 of the very glossy photo media (FIG. 27) has much greater swings in amplitude than the specular.<br>
25      curve 874 for the glossy (Gossimer) photo media of FIG. 28 due to the double polymer coating layer on the very glossy media. Thus, the specular curves 870 and 874 may be used to distinguish the very glossy photo media from glossy photo media, while the diffuse 872 and 876 are roughly the same magnitude and shape, although the very glossy photo media curve 872 has a slightly greater amplitude than the glossy photo media diffuse curve 876.<br>
55<br><br>
In comparing the curves of FIGS. 27 and 28 with the matte photo curves of FIG. 29, it can be seen that the specular reflectance curve 878 for the photo media resides at a much lower amplitude than either of the photo media specular curves 870 and 874. Moreover, there is less variation or amplitude change within the ¦5     matte photo specular curve 878, which is to be expected because the porous coating over the matte photo substrate, which is a paper substrate, has a much smoother surface than the swellable coatings applied over the glossy and very glossy photo media, as discussed above with respect to FIGS. 25 and 26. The diffuse curve 880 for the matte photo media is of similar shape to the diffuse curves 872 and 876 for 1 3     the very glossy and glossy photo medias, although the amplitude of the matte photo diffuse curve 880 is closer to the amplitude of the very glossy diffuse curve 872. FIG. 30 has curves 882 and 884 which are very different from the curves shown in FIGS. 27-29. One of the major differences in the curves of FIG. 42 versus the curves of FIGS. 27-29 is that the specular curve 882 is lower in magnitude than<br>
15     the diffuse curve 884, which is the opposite of the orientations shown in<br>
FIGS. 27-29 where the specular curves 870, 874 and 878 are of greater amplitude than the diffuse curves 872, 876 and 880, respectively. Indeed, use of the relative. magnitudes of the specular and diffuse curves of FIGS. 27-30 has been described above with respect to Table 3. Another significant difference in the plain paper<br>
2b     curves 882-884 is the similarity in wave form shapes of the specular and diffuse curves 882, 884. In FIGS. 27-29, there is a vast difference in the shapes of the specular curves 870, 874 and 878 versus the diffuse curves 872, 876 and 880.<br>
FIG. 31 shows the reflectances for a premium media. While the premium specular and diffuse curves 886 and 887 most closely resemble the plain paper<br>
25     curves 882 and 884 of FIG. 30, they can be distinguished from one another, and<br>
indeed they are in the match signature step 740 of FIG. 23. A close examination of the specular curves 882 and 886 shows that the premium specular curve 886 is much smoother than the plain paper specular curve 882. This smoother curve 886 is to be expected due to the smoother IRL surface coating on the premium media versus the<br>
10     rtfugher non-coated plain paper.<br>
56<br><br>
At this point it should be noted that the relative magnitudes of the specular and diffuse curves may be adjusted to desired ranges by modifying the media sensor 100. For instance, by changing the size of the field stop windows 526 and 528, more or less light will reach the photodiode sensors 130* and 130, so the 5"     magnitude of the resulting reflectance curves will shift up or down on the reflectance graphs 39-45. This magnitude shift may also be accomplished through other means, such as by adjusting the gain of the amplifier circuitry. Indeed, the magnitude of the curves may be adjusted to the point where the specular and diffuse curves actually switch places on the graphs. For instance in FIG. 31, by downsizing the specular 10     field stop window 526, the magnitude of the specular curve 886 may be dropped from the illustrated 475-count range to a position closer to the 225-count range. Such a change in the field stop size or the amplifier gain would of course also affect the other reflectance curves in FIGS. 27-30 and 32-33.<br>
FIGS. 32 and 33 show the reflectances of an HP transparency media with a<br>
15     tape header 456, and a transparency media without a tape header, respectively. FIG. 32 shows a specular curve 888 and a diffuse curve 889. FIG. 33 shows a specular curve 890, and a diffuse curve 892, In both FIGS. 32 and 33, the specular curves 888 and 890 lie above the diffuse curves 889 and 892. However, the magnitude of the signals received by the transparency with reflective tape in FIG. 32<br>
20     are much greater than the magnitudes of the transparency without the reflective tape in FIG. 33, which is to be expected due to the transmissive loss through the transparency without tape, leaving less light to be received by sensors 130 and 130' when viewing a plain transparency.<br>
Besides the relative magnitudes between the graphs of FIGS. 32 and 33 there<br>
25     is a vast difference in the diffuse waveform 889 and 892, although the specular waveforms have roughly the same shape, with the location of ribs 810, 812 being shown at wave crest 894 in FIGS. 32 and 33. Regarding the diffuse waveforms 889 and 892, the HP transparency media with the tape header has a relatively level curve 889 because the undersurface of the tape is reflecting the incoming beams<br>
20     Hack up toward the diffuse sensor 130. The diffuse waveform of FIG. 33 is more interesting due to the transmissive loss experienced by the incoming beam, such as<br>
57<br><br>
beam 800 in FIG. 24, losing energy in the form of the transmissive beam 825 leaving less energy available to reflect off the media surface upwardly into the diffuse sensor 130. Indeed, the locations of the valleys 816 between ribs 810 and 812 are shown at point 895 in FIG. .33, and the ribs are shown at point 896.<br>
5	Another interesting feature of the media support structure of printer 20 is the<br>
inclusion of one or more kicker members in the paper handling system 24. These kickers are used to push an exiting sheet of media onto the media drying wings 28. To allow these kicker members to engage the media and push an exiting sheet out of the printzone, the platen 814 is constructed with a kicker slot, such as slot 897<br>
1C      shown in FIG. 24. As the optical sensor 100 transitions over slot 897, the<br>
transmissive loss caused by beam 825 increases, leaving even less light available to be received by the diffuse sensor 130, resulting in a very large valley or canyon appearing in the diffuse waveform 892 at location 898.<br>
Thus, from a comparison of the graphs of FIGS. 27-33, a variety of<br>
15      distinctions may be easily made to separate the various major categories of media by merely analyzing the raw data collected by sensor 100.<br>
13. Spatial Frequency Analysis<br>
To find out more information about the media, the massage data routine 504 20     uses the raw data of FIGS. 27-33 in steps 552 and 554 to generate the Fourier spectrum components, such as those illustrated in FIGS. 34-39. In steps 546 and 548, the massage data routine 504 generated the curves shown in FIGS. 27-3.3. FIGS. 34 and 35 show the Fourier spectrum components for the diffuse reflection and the specular reflection, respectively, of a premium media, here the matte photo 25      media. FIGS. 36 and 37 show the Fourier spectrum components for the diffuse reflection and the specular reflection, respectively, of a premium media, here the very'glossy photo media. FIGS. 38 and 39 show the Fourier spectrum components for the diffuse reflection and the specular reflection, respectively, of a premium media, here the plain paper media, specifically, Gilbert® bond.<br>
30	In comparing the graphs of FIGS. 34-39, remember to compare the values for<br>
the diffuse reflection with the other diffuse reflection curves (FIGS. 34, 36 and 38)<br>
58<br><br>
and to compare the specular reflection curves with other specular reflection curves (FIGS. 35, 37 and 39). For instance, to distinguish between the matte photo media and the very glossy photo media, the frequency of 10 cycles per inch for the specular curves of FIGS. 35 and 37 may be compared. In FIG. 35, the matte photo has a it      frequency magnitude of around 10 counts as shown at item number 888 in FIG. 35. In comparison, in FIG. 37 for the very glossy photo media, the frequency magnitude at a spatial frequency of 10 cycles per inch is nearly a magnitude of 42 counts, as indicated by item number 889 in FIG. 37.<br>
A better representation of the Fourier spectrum components for five basic 10     media types is shown by the graphs of FIGS. 40 and 41. In the graphs of FIGS. 40 and 41, the various data points shown correspond to selected frequency magnitude peaks taken from generic bar graphs like those shown in FIGS. 34-39 for the Fourier spectrum components. Thus, the points shown in the graphs of FIGS. 40 and 41 represent maximum frequency magnitudes corresponding to selected spatial<br>
15      frequencies up to 40 cycles per inch, which comprises the useful data employed by the advanced determination system 500. In FIGS. 40 and 41, selected spectrum components are shown for five generic types of media: plain paper media, premium media, matte photo media, glossy photo media, transparency media, each of the graphs in FIGS. 40 and 41 has a left half corresponding to low spatial frequency<br>
20      values, toward the left, and high frequency spatial values toward the right, with the border between the low frequency and high frequency portions of each graph occurring around 10 or 20 cycles per inch<br>
Now that the roadmap of the media determination method 500 has been laid out with respect to FIGS. 15-23, as well as the intricacies of the manner in which<br>
25     information is extracted from the media with respect to FIGS. 24-39, the<br>
interrelation between the roadmap and these intricacies will be described. Indeed, to draw on the roadmap analogy, the various branches in the major category determinations and specific type determinations of FIGS. 20-23 may be considered as branches or forks in the road, with the various schemes used to make these<br>
30     determinations considered to be points of interest along our journey.<br>
59<br><br>
Table 4 below lists some of our various points of interest and destinations where our journey may end, that is ending by selecting a specific type of media.<br>
Table 4: Media Determinations<br>
FIG. No.<br>
#	Medias Compared	- Step No.	Result<br>
1	Transparency (Tape or Not)	8 - 426,430	No Tape Transp.<br>
2	Photo vs. Transparency	20 - 626, 636	Tape Transparency<br>
3	Glossy Photo vs. Matte Photo	21 - 668	Glossy Photo<br>
4	Plain vs. Premium vs. Matte	22 - 706	Matte Photo<br>
5	Plain vs. Premium	23 - 746, 772	Premium Paper<br>
6	Plain vs. Premium	23 - 746, 748	Plain Paper<br>
7	Matte Swellable vs.Matte Porous	22-715	Swellable IRL Matte<br>
8	Matte Swellable vs.Matte Porous	22-715	Porous IRL Matte<br>
9	Very Glossy vs. Glossy Photo	21 - 674	Very Glossy Photo<br>
10	Very Glossy vs. Glossy Photo	21 - 674	Glossy Photo<br>
The graphs of FIGS. 40-43 have been broken down into four quadrants, with the generic diffuse spatial frequency graphs of FIGS. 40 and 42 having: (I) a first quadrant 900 which has a low frequency and high magnitude, (2) a second<br>
16     quadrant 902 which has a high frequency and high magnitude, (3) a third quadrant 904 which has a low frequency and low magnitude, and a fourth quadrant 906 which has a high frequency and low magnitude. The generic specular spatial frequency graphs of FIGS. 41 and 43 have four quadrants: (1) a first quadrant 910 which has a low frequency and a low magnitude, (2) a second quadrant 912<br>
15      which has a high frequency and high magnitude, (3) a third quadrant 914 which has a low frequency and high magnitude, and a fourth quadrant 916 which has a high frequency and low magnitude.<br>
By comparing the data for the various types of media shown in the graphs of FIGS. 40-43, the determinations made in operations #3-10 of Table 4 may be<br>
60<br><br>
determined. Other more basic data as described earlier is used to determine whether an incoming sheet of media is a transparency ( A ), with or without a tape header as described earlier, according to operations #1 and #2 of Table 4. Table 5 below shoftvs which quadrant of which graph is used to determine the media types of operations #3-10 of Table 4.<br>
Table 5: Media Cateqorization Steps by Reqion of Spatial Frequency Graphs (FIGS. 40-43)<br><br>
(Region #902)<br>
Low Maqnitude<br>
(Region #906)<br>
7 and 8<br>
Graph        Low Frequency    High Frequency Hiqh Maqnitude    Hiqh Maqnitude Diffuse        (Region #900)<br>
5<br>
Low Maqnitude Diffuse        (Region #904) 6 (maybe 3) Hiqh Maqnitude    Hiqh Maqnitude Specular     (Region #910)        (Region #912)<br>
3, 9 and 10	-<br>
Low Maqnitude      Low Magnitude Specular     (Region #914)        (Region #916) 4<br>
In the third operation (#3) of Table 4, the distinction between glossy photo media and matte photo media may be made by examining the data in quadrant 904 of FIG, 40, or in quadrants 910 and 914 of FIG. 41.   In FIG. 40, the magnitude of the matte photo spatial frequencies (X) are greater than the magnitude of the glossy photo spatial frequencies (0). Perhaps even better than FIG. 40, the difference is shown in FIG. 41 for the specular spatial frequencies, where we find the matte photo spatial frequencies (X) falling within quadrant 914, and the glossy photo (0) spatial frequencies falling in quadrant 910. Thus, while the information supplied by the<br>
61<br><br>
diffuse sensor 130 may be used to make a determination between glossy and mane photos, as shown in FIG. 41, a much clearer distinction is made using the data collected by the specular sensor 130', as shown with respect to FIG. 41.<br>
In operation #4 of Table 4, the method distinguishes between plain paper versus premium paper versus matte photo. This distinction may be accomplished again using the data in quadrant 914 of FIG. 41. In quadrant 914, we see the matte photo (X) spatial frequencies are far greater in magnitude than the plain paper (D) spatial frequencies, and the premium paper (O ) spatial frequencies. Thus, the selection of matte media in operation #4 is quite simple.<br>
0	In operations #5 and #6 of Table 4, the characteristics of plain paper and<br>
premium paper are compared. Referring to the diffuse spatial frequency graph of FIG. 40, the premium paper ( O ) spatial frequencies appear in quadrant 904, whereas the plain paper (0) spatial frequencies appear in quadrant 900.<br>
Following operation #6 of Table 4, a sheet of media entering the printzone 25<br>
15      has been classified according to its major category type: transparency (with or without a header tape), glossy photo media, matte photo media, premium paper, or plain paper. Note that in the original Table 2 above, matte photo was discussed as a sub-category of premium medias, but to the various characteristics of matte photo media more readily lend themselves to " separate analysis when working through the<br>
20     major category and specific type determination routines 506 and 508, as illustrated in detail with respect to FIGS. 20-23.<br>
Following determination of these major categories, to provide even better results in terms of the image ultimately printed on a sheet of media, it would be desirable to make at least two specific type determinations. While other distinctions<br>
25      may be made between specific types of media, such as between specific types of plain paper (FIG. 23, table 754) in practice so far, no particular advantage has been found which would encourage different printing routines for the different types of plain paper media because basically, of the plain paper medias studied thus far, they all provide comparable results when printed upon according to a plain paper default<br>
30      print mode ("0,0"), as shown in step 770 of FIG. 23. However, if in the future it becomes desirable to tailor print routines for different types of plain paper, the<br>
62<br><br>
method 500 has been designed to allow for this option, by including steps 760<br>
and 764 to allow for tailored plain paper print modes (FIG. 23). Two of the major<br>
categories, specifically matte photo and glossy photo lend themselves better to<br>
specific type media determinations, allowing for different print modes.<br>
"	The specific type determinations will be made according to the data shown in<br>
FIGS. 42 and 43. Thus, operations #7 and #8 of Table 4 are used to distinguish matte photo medias having swellable coatings from those having porous coatings. The matte photo (X) data from FIGS. 40 and 41 has been carried over into FIGS. 42 and 43. The matte photo data depicted with the X's in FIGS. 40-43 is for a swellable 0     coating, or ink retention layer (**IRL**). The specular frequencies for a matte photo media with a porous coating or IRL is shown in FIGS. 42 and 43 as A. While the specular data of FIG. 43 could be used to distinguish the matte photo swellable coatings (X) from the porous coatings (?), the diffuse data shown in quadrant 906 tends itself to an easier distinction. In quadrant 906, we see the swellable coating<br>
1 5      matte photo (X) spatial frequencies as having a magnitude greater than the matte photo porous coated media (?). Thus, the information in quadrant 906 best lends itself for making the determination of operations #7 and #8 in Table 4.<br>
The other desired specific type media distinction is between glossy photo media (Gossimer) and very glossy photo media (double polymer IRL coatings).<br>
20     While the diffuse data of FIG. 42 could be used to determine the distinction between the very glossy media (o) and the glossy Gossimer media (*), an easier distinction is made with respect to the specular data shown in FIG. 43. As shown in quadrant 910, the very glossy (o) specular frequencies have a greater magnitude than the glossy Gossimer (*) spatial frequencies. Thus, the data shown in quadrant 910 allows for<br>
25      the distinctions made in the ninth and tenth operations #9 and #10 of Table 4.<br>
63<br><br>
Two-Stage Media Determination System<br>
In implementing the advanced media determination system 500 of FIGS. 15-23, it occurred to the inventors that there may be a way to increase the §     speed of the routine 500, allowing users to receive their hardcopy output faster alter initiating a print job. Since the vast majority of users most often use plain paper (even people printing photographic images on photo paper typically run a sheet of plain paper through first to proof the print job before printing the final version on more expensive photo media), it would be desirable to be able to quickly identify the<br>
10     plain paper in a single scanning pass of sensor 100, then employ a detailed multi-pass scanning routine to more accurately identify the other media types. FIG. 44 illustrates such a two-stage media determination system 920 constructed in accordance with the present invention, which may be used in conjunction with the advanced media determination system 500 of FIGS. 15-23, to accomplish these<br>
15      objectives.<br>
The two-stage media determination system 920 includes a first or preliminary sorting stage 922, and a second or detailed follow-up sorting stage 924. In the first sorting stage 922, in an optimization step 926 the LED 105 of sensor 100 is optimized in intensity for reading plain paper 150. In the preferred embodiment, this<br>
20     optimization step 926 merely uses the brightness previously determined during a standard calibration sequence which occurs upon printing a pen calibration sheet, such as occurs routinely after replacement of one of the inkjet.pens 50-56, although a custom calibration for the incoming sheet may be employed as described in further detail below with respect to the second stage 924. Following the optimization<br>
25      step 926, in a single sweep step 928, the carriage 40 traverses once in a single sweep across the printzone 25, with the sensor 100 collecting both specular and diffuse data during this single sweep. In a comparison step 930, both the specular and diffuse data are analyzed to determine whether they are within range of the sensors 130 and 130' to determine whether a good set of readable and interpretable specular and<br>
30     diffuse data was found in the single sweep step 928. If indeed, both the specular and diffuse data are within range, a YES signal 932 is generated and provided as an input<br>
64<br><br>
to a match signature and select print mode step 934. The match signature and select print mode step 934 then proceeds according to the media determination system 500 as described with respect to FIGS. 15-23, eventually resulting in a print step, represented collectively as print step 935, which may include any of the print 5      steps 650,658,688,696, 730; 738,764, 770, 788 or 796.<br>
Returning to the top of FIG. 44, if the range comparison step 930 finds that the specular and/or diffuse data is not within a useable range, a NO signal 936 is issued to initiate the second sorting stage 924 of the two-stage media determination system 920. The second stage 924 provides for separate optimal gathering of 0     specular and diffuse data, which may be collected in either order, but here are<br>
illustrated with the diffuse data being collected first. While the first stage 922 may take on the order of five seconds from step 926 through an ultimate printing step, labeled collectively as print step 935, progression through both the first and second stages to an ultimate printing step may take on the order of 10-20 seconds, but may 5     result in a more accurate set of data being collected, as a portion of the collecting raw data step 502, than may be available on a single pass sweep of step 928.<br>
In the two-stage media sorting system 920, in the first stage 922, the intensity of the light source, here the blue-violet LED 105, is optimized for plain paper in a manner similar to the turning on and brightness adjustment step 530 of FIG. 16.<br>
20     Preferably the LED intensity is adjusted to allow the signals generated by both the specular and diffuse reflectances 155', 155 reflected from an incoming sheet to fall within the mid-span range of the analog-to-digital (A/D) converter, which, as mentioned above, has a near-saturation level on the order of five volts. The illustrated A/D converter is within the controller 35, and during data acquisition this<br>
25      A/D converter is enabled to acquire the output signals of the specular and diffuse photodiodes 130', 130.<br>
Thus, if the data gathered during a single sweep step 928 has saturated the A/D converter, then the second stage 924 is initialized upon receiving the NO signal 936. In the illustrated embodiment, a calibrating step 938 begins in<br>
30     response to the NO signal 936*to recalibrate the LED 105 for the particular type of media entering the printzone 25. To carry out the calibrating step 938, the<br>
65<br><br>
sensor 100 first takes a "peek" or quick look at the incoming media. Preferably, the carriage 40 moves the sensor 100 to a location along the printzone 25 where a maximum diffuse brightness may be measured. This maximum brightness location will depend on the configuration of the media support platen, and may be 5     empirically determined by the printer designer using a trial and error method, wiiich in the illustrated embodiment resulted in a location near one of the cockle ribs 810, 812. Once the carriage 40 is at the desired location, the brightness of the LED 105 is gradually increased in a step-wise fashion from zero (the off condition) until the A/D converter is saturated. Once the saturation brightness is determined, the brightness<br>
W     of the LED 100 is reduced at least one step to arrive at a maximum brightness value for measuring diffuse data on the particular type of media entering the printzone 25. To increase the chance of gathering useable data on the next pass, the calibrating step 938 may then reduce the LED brightness another increment below this new maximum value, which in the illustrated embodiment is a 5 % reduction to a value<br>
15     of 95% of the maximum brightness value just determined. Following LED<br>
calibration 938, in a scanning and data collection step 940, the carriage 40 carries the sensor 100 across the incoming media while sensor 130 collects data concerning the diffuse reflectance beam 155 at this 95% LED brightness value.<br>
Following the scanning and collecting step 940, in a comparison step 942 it<br>
20     is determined whether the diffuse data is within the range of the A/D converter. If the data is still saturating the A/D converter, a NO signal 944 is issued. Then in a checking step 945, it is determined whether the brightness of the LED 105 is at a minimum value, such as a floor of 12% of the maximum value found in step 938. If the LED 105 is not at this minimum level, a NO signal 946 issued. In a brightness<br>
23     reduction step 948, in response to receiving signal 946, the brightness of the<br>
LED 150 used in the previous scan is reduced by 10% in intensity, and the scanning and collecting step 940 is repeated.<br>
Steps 940, 942,945 and 948 repeat if the data is beyond the range of the A/D converter, with the reduction step 948 reducing the brightness of LED 105 in 10% increments from the value used in the last iteration, until this value falls below a selected level, here selected as 55% of the maximum value found in step 938. Upon<br>
66<br><br>
dropping below this 55% threshold, then the reduction step 948 reduces the intensity of LED 105 to 25% of the maximum value found in step 938. If after another scan and collect step 940 is performed, the NO signal 946 is again issued, then the brightness of the LED 105 is reduced to 12% of the maximum value found in 5      step 938.<br>
If following the scanning and collecting step 940 at a 12% brightness level, upon again reaching the comparison step 945, since 12% in the illustrated embodiment has been selected as the minimum level, a YES signal 950 is generated. The YES signal 950 then activates a select default print mode step 952. In the 1 3      illustrated embodiment, the default print mode corresponds to generic plain paper print mode, corresponding to step 766 in FIG. 23, resulting in a print step 954, which correlates with the "print ("0,0")" print mode of step 770 in FIG. 23.<br>
If during one of the passes through steps 940-948, the comparison step 942 determines that the collected data is within a useable range, then a YES signal 955 is ' 5      issued. In response to the YES signal 955, a specular data collection routine is<br>
-initiated. As mentioned above, the specular and diffuse data collection routines of the second stage 924 may occur in either order, or they may occur simultaneously if processing capabilities permit. The specular data collection portion of the second stage 924 may proceed in much the same way as the diffuse data collection routine<br>
20     of steps 938-948. Here for the specular data gathering, a calibration step 956 begins in response to the YES signal 955 and finds the maximum intensity for the LED 105 in exactly the same manner as described above for the diffuse calibration in step 938. Note that in some implementations, differing locations along the printzone 25 may be empirically found to generate maximum specular and diffuse reflectance values<br>
25      for use in steps 956 and 938. Once this maximum specular brightness without<br>
saturating the A/D converter is found, the calibration step 956 then reduces the LED to 95% of this maximum before moving on to a first try at a scanning and collecting specular data step 958.<br>
Following this initial specular LED calibration of step 956, the scanning<br>
S"0      aria collecting step 958 is performed with the carriage 40 traversing the optical<br>
sensor 100 across the printzone 25 to collect specular data in step 958. Following<br>
67-<br><br>
this data collection step 958, a comparison step 960 then determines whether the specular data collected is in range, that is, whether a good signal which did not saturate the A/D converter was obtained. If not, a NO signal 964 is issued and in a checking step 965, it is determined whether the intensity of the LED 105 is at a t     minimum level, here selected as 12% of the maximum value found in step 956. If the LED is not at the selected minimum brightness, a NO signal 966 is generated to a brightness reduction step 968.<br>
In the illustrated embodiment, the brightness of the LED 105 is reduced in the same increments as described above for the diffuse data LED brightness 13     reduction 948. It is apparent that different steps in LED brightness reduction may be made to collect the diffuse and specular data, although testing has indicated that good results are obtained by making the illustrated intensity step reductions. In the illustrated embodiment, the minimum LED level is 12%, and when this level is found by the checking step 965, a YES signal 970 is issued. In response to the YES 15     signal 970, the select default print mode step 952 is activated as described above, resulting in selection of the plain paper print mode in the illustrated embodiment, terminating the method with print step 954.<br>
The reason for the gradual reduction of the LED brightness in steps 948 and 968 is that more accurate, larger amplitude data is obtained with the maximum 20     illumination intensity, provided that the A/D converter is not saturated so the data is useless. Thus, better resolution is obtained by using the maximum brightness of LED 105 to generate stronger signals for the specular and diffuse sensors 130', 130. Furthermore, use of the two-stage media determination system 920 advantageously allows for a quick look for plain paper in the single sweep step 928, which may also 25     advantageously result m generating good useable data in some instances for determining other types of media, such as photo media, speeding printing. Activation of the second stage 924 advantageously allows for highly accurate data collection for the specialty medias, resulting in media signatures with greater resolution being passed onto the media determination system 500, as indicated by ^0     steps 934 and 935 in FIG. 44.<br>
68<br><br>
As mentioned above, if only the first stage 922 is used, in current implementations, a print job may begin within five seconds after the print job is initiated, in contrast to a wait on the order of 10-20 seconds for detailed media analysis by the second stage 924. Thus, if plain paper is screened during the first stage 922 in the majority of cases, printing occurs in V2 to V* of the time required for specialty media identification using the multi-pass second stage 924. Indeed, the first stage 922 may also be referred to as a "single pass sensor mode,1* with the second stage 924 being referred to as a "multi-pass sensor mode." That is, at a minimum the second stage 924 steps may be: the calibration step 938, the scanning 10      and collecting step 940, the comparison step 942, followed by issuance of a YES<br>
signal 955, the calibrating step 956 followed by the specular scan and data collection step 958, and finally the comparison step 960 issuing a YES signal 962. In the slowest operation of the illustrated second stage 924, the diffuse data may be repeatedly scanned through repetition of steps 940,942, 945 and 948 over a total of 15      seven different LEI) brightness. Following collection of the diffuse data in the slowest operation of the illustrated two-stage method 920, the specular data may then be collected in a similar seven step process by repetition of steps 958, 960, 965, and 96$ through the same, or different, LED intensity reductions, before eventually resulting in either a YES signal 962 or a default YES signal 970 to initiate printing. 20<br>
Educatable Media Determination System<br>
While the printer manufacturers may develop automatic media identification systems for the more common types of media as described above, it would be 25      desirable to have a media identification system which is educatable or teachable, to identify eew media categories introduced by a user. For example, some users may have specialized stationery, or some regions may favor particular types of media, such as 2 talc-coated media often used in India and surrounding regions. Another older type of media used with manual typewriters was referred to in the United States 3ft "onion skin," and it is conceivable that some users may have a supply of onion sfein on hand which they wish to use with their inkjet printers. While the basic<br>
69<br><br>
and advanced media identification systems 400, 500 described above are centered around identifying currently popular groups of media for inkjet printers, it would be desirable to have an inkjet printer which is capable of identifying other specialized types of media, and applying a best matched print mode consistently to these uncharacterized types of media when they are continually encountered.<br>
FIG. 45 illustrates one form of an educatable or learning media identification system 1000, constructed in accordance with the present invention, which a user may teach how to identify new types of print media and then print on this new type of media with a selected print mode when encountered in the future. In a starting<br>
10      step 1002, a user starts the "teach mode" method, preferably by interaction with a personal computer or host interface, which may be a portion of the printer driver circuitry or supplied as a special software upgrade application. Alternatively, the printer 20 may be equipped with a special teach mode button, or other user interface which a user selects to perform the start step 1002. For the purposes of discussion,<br>
15      the illustrated embodiment of the educatable media identification system 1000 will be described in terms of a software application run on a user's personal computer or host computer, which generates display screens having instructions and various selections available for a user to choose. It is apparent to those skilled in the art that the particular computer display screen configuration may take on a variety of<br>
20     different forms which may be used to implement the educatable media identification method 1000.<br>
Following the starting step 1002, the system 1000 includes an acquiring step 1004, where the signature of the custom media of interest is acquired. The acquiring step 1004 has two basic steps, first a collecting step 1006, which is<br>
25      followed by a processing step 1008. Preferably, the user interface or display screen instructs the user to load a selected number of sheets of the custom media into the input tray 26 of the printer 20. In the illustrated example, the collecting step 1006 indicates that raw data should be collected for "X" custom sheets, with the X being selected as 20 sheets for the purposes of discussion. It is apparent that if a greater<br>
30     number of sheets is used for the raw data collection step 1006, better results may be obtained, while the use of fewer sheets may also be beneficial to generate a reliable<br>
70<br><br>
signature, although increased reliability will be obtained by generating a signature based on a greater number of sample sheets.<br>
After a user signals the printer that the custom media is loaded for test, the printer then picks and scans each sheet and collects the raw data for the test media in step 1006. Preferably, the collecting step 1006 is done in a multi-pass sampling routine, similar to that described for the second stage 924 in FIG. 44. Alternatively, the collecting step 1006 may be conducted as described above for the collecting raw data step 502 of FIG. 16. This collected data is then transferred to the host computer or to the printer controller 35 for processing to form a custom media signature in<br>
10     step 1008.<br>
The processing step 1008 processes the collected raw data to form a custom media signature, similar to the signatures generated by the inventors when developing the basic and advanced media determination systems 400, 500. Preferably, the processing step 1008 performs a Fourier transform on the collected<br>
15      raw data and a data averaging routine, similar to the performing step 412 and the averaging step 408 of FIG. 8. Alternatively, the processing step 1008 may be conducted according to the data massaging step 504 of FIG. 17, where the specular and diffuse reflectance graphs are generated and then converted to the specular and diffuse spatial frequency signatures. Indeed, the reflectance graphs and the spatial<br>
20     frequency charts may both be used in a matching signature and selecting print mode step 1010. The matching and selecting step 1010 may operate as described above for the basic and advanced media determination systems 400, 500, such as in the match signature steps 600,618, 700 and 740.<br>
Advantageously, in the educatable media determination system 1000,<br>
25      additional resources beyond those stored within the look-up tables of method 400 may be consulted for reference media signatures. A reference media signature look-up table 1012 may include printer look-up tables 1014, which collectively refers to all of the media signatures stored within the advanced system 500, including look-up tables 664, 676, 704, 718, 744, 754 and 776. Another source<br>
3 )     afreference media signatures within table 1012 may be available on the user's computer, indicated collectively as look-up Table 1016 in FIG. 45. The reference<br>
71<br><br>
signatures within table 1016 may be stored on the host computer, within the printer driver residing within the host computer, or supplied with the software application 1000 being operated from the host computer, which typically today is provided on a CD ROM compact disc storage media. Another source of reference $o      signatures within the look-up table 1012 may be within an internet or web based look-up table 1018, which a user's computer may consult automatically, or when directed by the user.<br>
It is apparent that in progressing from the printer look-up tables 1014, to the computer based tables 1016, and then finally to the internet web based tables 1018,<br>
10     that greater flexibility and more selections are available with each step. While the printer look-up tables 1014 are restricted in most instances to those available at the time of manufacturing printer 20, upon purchasing the teachable system 1000 as a software upgrade, for instance in the form of a CD ROM, additional signatures may be supplied which were available at the time of recording the software application of<br>
15     method 1000. As new media signatures are identified, the most flexible way for a manufacturer to make these new signatures available to users is by storing them on an internet website in tables 1018, from which a user may download the signatures onto their host computer, or allow their host computer to interactively consult with these reference tables to search for a media signature match.<br>
20	In one preferred embodiment, the printer controller 35, whether resident in<br>
the printer 20 or in the host computer, on a periodic basis either directly or remotely polls the internet website tables 1018 for updates to the signature file and/or for updated print modes, including new color map databases and the like. If newly posted updates are detected by the controller 35, they are automatically downloaded<br>
25     and appended to all future printjobs to be available to the printer for signature comparison. Updated.print modes may replace earlier print modes stored in the printer look-up table 1014.<br>
After the matching step 1010 sorts through the various reference media signatures within table 1012, after a given amount of searching either based on time, number of signatures to analyze, or upon completion of consulting all the available reference signatures, in a comparison step 1020, the question is then asked whether<br>
72<br><br>
step 1010 found a reference signature which matches the custom media signature generated in step 1008. If an exact matching signature was not found, then step 1020 issues a NO signal 1022, which is delivered to a sample printing step 1024. The sample printing step 1024 then prints a variety of different print 5     modes on the custom media, with these print modes being selected from the available reference media signatures stored within table 1012.<br>
If the matching query step 1020 determines that step 1010 indeed found a match to one of the reference signatures of table 1012, then a YES signal 1026 is issued. Preferably, the YES signal 1026 activates a showing step 1028, which then<br>
10     displays for the user which matching signature was found. In another querying step 1030, the user is then asked by the software application whether the user approves of the matched signature. For instance, a user may not approve of a signature which erroneously found stationery having reflective fibers within the media to be a transparency. In such a case, the user will then disapprove of the<br>
1 S      selection and a NO signal 1032 will be issued. In response to receiving the NO signal 1032, the sample printing step 1024 is activated to print a sample of the various types of print modes available. While these print samples generated by step 1024 may be printed with only one sample per sheet of media, most users prefer to have several print samples displayed on a single piece of media, for instance as<br>
20,    described in U.S. Patent No. 6,039,426 for a "Simplified Print Mode Selection Method and Apparatus/* currently assigned to the present assignee, the Hewlett-Packard Company. In a selecting step 1034, the user then examines the print samples generated by the printing step 1024, and through the use of the host computer interface may select a desired print mode. If the user selects a print mode,<br>
25      a YES signal 1035 is issued.<br>
Alternatively, if in the querying step 1030, the user approves of the signature match shown in step 1028, then a YES signal 1036 is issued. Upon receiving either the YES signal 1036, or the YES signal 1035 indicating a user-selected print mode in step 1034, a storing step 1038 then stores the matched custom signature and print mode. This storing step 1038 may store the matched signature and print mode either within the printer controller 35, indicated in a storing step 1040, or on the host<br>
73<br><br>
computer, indicated by a computer storing step 1042. While storing the matched signature on the printer controller 35 in step 1040 may slightly speed later computations and matching of the custom media signature, storing of this information on the host computer is also quite feasible. If this media signature and 5      print mode information is stored on the host computer in step 1042, then when initiating all future printing routines, this media signature and print mode information may be downloaded to the printer at the beginning of each print job along with other resource manager information. While downloading this information at the beginning of each print job may seem burdensome or laborious, K      indeed transmitting all of this information to the printer takes approximately one second or less using current printing and computing technologies.<br>
Following the storing step 1038, in an ending step 1044, the teach mode sequence is ended and a printing step 1045 is initiated to performing selected print job on the new custom media, or other print media as identified by the media 15      determination system 500.<br>
Thus, using the educatable teach mode media determination system 1000, customers are able to teach the printer 20 how to recognize media of their choice, and to assign a selected print mode to this custom media when encountered in the future. The print modes assigned may vary in a variety of different features, such as 20     the amount of ink put down, the color map used, the halftoning routines employed, and the number of print passes used, such as those employing a shingling ink application system. The selected print mode may also contain information about the location of the new media supply. For instance, if a specialized business card sized supply tray, or a snap-shot sized photo media supply tray is used to store the custom 25      media, then the selected print mode instructs the media handling system 24 to pull the next sheet from the specialized supply tray.<br>
In an alternative embodiment, the signature matching step 1010 may first look to the printer look-up tables 1014, but if the user does not like any of the print modes on the custom media, then a NO signal 1046 is issued, hi response to the NO signal 1046, in this optional alternative system, a repeat of the matching step 1010 is performed in the repeating step 1048. In this repeat, the matching step may then<br>
74<br><br>
look to the computer based tables 1016, followed by a repeat of steps 1020, 1028, 1030 and possibly 1038 or 1024 and 1034, followed by another repetition if the user does not select one of the computer based print modes of the repeating step 1048. In this third round, the matching step 1010 would then look to a broader base of 3     reference signatures, specifically in the illustrated example, the internet web-based tables 1018. Of course if additional resources were available where reference media signatures may exist, then the repeating step 1048 will cause the matching step 1010 to increment through these additional media reference signature tables. In the illustrated example, following the internet web-based table matching 1018, the NO<br>
10     step 1046 would no longer be available for the user, or the system may increment back through the printer look-up tables 1014, followed by the computer based tables 1016, etc.<br>
In an alternative embodiment, the user may initiate a printer calibration procedure through interaction with the software application for instance. After the<br>
15     printer controller has received new signature and print mode updates, either from the internet tables 1018 or from another software upgrade source, such as tables 1016, the user initiates this calibration process. The user first identifies the media type which they desire to use to generate a list of supported media types. Following this selection, the user then loads a selected number of samples of this media which the<br>
7 0     printer then picks and scans to generate a new custom media signature, as described above for the aquiring step 1004. This new signature is then linked to a color map and print mode that has been delivered via the external source, so in the future when this particular custom media is detected it is immedately mapped to the linked color map and print mode.Thus, the user-initiated teaching mode 1000 allows a user to<br>
2	5      select a desired print mode to match a custom print media, and then to store this<br>
match through steps 1038,1040 or 1042 where the match is available for future use.<br>
FIG. 46 illustrates an alternate embodiment of an educatable media identification system 1050, constructed in accordance u ith the present invention, to identify borderline media falling between two known types of print media. In the<br>
3	)     advanced media determination system 500 described above with respect to<br>
FIGS. 15-23, there is no memory within the system for remembering which print<br>
75<br><br>
mode was used on a previous sheet or sheets. Due to variations between printers 20 and media, it is common to find certain media that have signatures which fall between the reference signatures for two different types of media.<br>
For example, it is common for the properties of a measured unknown new 5     media to be halfway between a printer's definition of plain paper and a specialty or coated paper, such as between plain and premium paper in FIG. 23. The media determination system 500 needs to make a selection between either premium or plain paper in step 746, and for this borderline media, the results are inconsistent. For the first sheet in a print job, the printer may determine that it is a premium sheet<br>
1)     so the entire job is printed using a premium print mode, while for the next sheet in the stack, the printer may determine the media is a plain paper so the next print job is printed using a plain paper print mode, resulting in different print modes being used on the same media. Thus, the resulting image from print job to print job varies, and users find this printer behavior to be very confusing, resulting in a non-uniform print<br>
15     behavior and varying print quality on a given type of media.<br>
Most users would appreciate consistent printer-to-media use interaction, even though not optimal, for instance if the determination system 500 decides that a piece of premium paper is a plain paper, the plain paper print mode would not be optimal, but the results would be consistent from print job to print job rather than varying<br>
2 3     print modes from one print job to the next. Most consumers would prefer this<br>
consistency from job to job in the overall product. Moreover, besides all of the print jobs having the same appearance or print quality, each page of a job will take approximately the same amount of time to print, instead of printing one job with a faster plain paper print mode, and another job with a slower premium paper print<br>
25     mode. Thus, the consistent printing results even though they may not be the optimal print results, are preferred by most users, rather than oscillating back and forth between two different print modes from print job to print job.<br>
Returning now to FIG. 46, the self-taught media determination system 1050 first shows the major category determination step 506, as including four substeps, wliere decisions are made between various types of media, with a transparency versus default premium determination being made in step 642, a glossy versus matte<br>
76<br><br>
photo (abbreviated as "Matte" in the drawings) determination being made in step 668, a matte photo versus plain paper versus premium paper determination being made in step 706, and a premium versus plain paper determination being made in step 746 (see FIGS. 15 and 20-23). The self-taught determination system 1050 5     also dovetails into the specific type media determination step 508, which has various verifying steps including a glossy photo verification step 680, a matte photo verification step 722, a premium media determination step 780. and a plain paper determination step 756 (see FIGS. 15 and 21-23).<br>
Whenever the advanced media determination system 500 processes through<br>
1)     one of the major category determination verifying steps 642,668, 706 or 746, this data is transmitted via signal 1052 to a determination step 1054. Similarly, when the specific media type determination step 508 passes through any of the verifying steps 680, 722, 780 or 756, this data is transmitted via signal 1055 to the determining step 1054. The determining step 1054 then determines how close the<br>
1 5      media signature of the verifying steps 642, 668, 706, 746, 680, 722,780 or 756 is to the reference signatures of the particular verifying step. Following the determination step 1054, a comparison step 1056 then activates to determine whether the new media signature is on the borderline between the two sets of reference signatures. For instance, in exercising the determination step 1054, if it is determined that a new<br>
23     media signature is passing through step 668 is on the borderline between being glossy print media and matte print media, then the comparing step 1056 issues a YES signal 1058. If the new media signature is not a borderline signature between two groups of reference values, then the querying step 1056 issues a NO signal 1060, and in a proceeding step 1062 the media determination method 500 then.<br>
25     proceeds as described above with respect to FIGS. 15-23.<br>
If the new media signature is on the borderline between two different types or categories of media, then the YES signal 1058 initiates a storing step 1064, where the new media signature is stored, along with the print mode selected by the determination system 500 corresponding to this new media in a look-up table 1064.<br>
2 0     While this self-educating media determination system 1050 may be used in<br>
conjunction with the user operated teach mode determination system 1000, either<br>
77<br><br>
through being downloaded from the web, or supplied as the new application on a CD ROM powered by the host computer, or downloaded thereon. Preferably this self-teaching system 1050 is supplied along with future releases of the advanced media determination system 500, and thus is totally transparent to a user. If provided as an upgrade, the look-up table 1064 may be stored on the host computer, as described above with respect to step 1042 of FIG. 45. Instead, if the self-teaching system 1050 is supplied with new releases of the advanced media determination system 500, then preferably the look-up table 1064 is located within the printer controller 35.<br>
For the next sheet of media entering the printzone, in an acquiring step 1065, the signature of the next piece of incoming media is collected and processed, such as according to the acquiring media signature step 1004 of FIG. 45, perhaps through the use of the second stage data collection step 924 of FIG. 44. Following acquisition of the signature of the next incoming media in step 1065, a comparing step 1066 then compares the signatures of this next sheet of media with the previously stored media signatures residing within the look-up table 1064, as indicated by signal 1068. Following this comparing step 1066, in a querying step 1070, it is asked whether this next media signature matches one of the previous new media signatures stored in table 1064. If the matching step 1070 determines that this next sheet of incoming media has a signature which does not match any of the previously stored signatures in table 1064, then a NO signal 1072 is issued. In response to the NO signal 1072, the proceeding step 1062 is activated, and the advanced media determination system 500 is then continued. If the matching step 1070 finds a match between the next media signature and one of the previously stored new signatures within table 1064, then a YES signal 1074 is issued.<br>
In response to the YES signal 1074, a selecting step 1075 is then issued to select the same print mode for this next incoming sheet as was previously selected and stored within look-up table 1064 for an earlier printed sheet. Thus, if in this borderline situation, initiating from the major category determination step 746 determine that the incoming media was plain paper rather than premium paper, then a plain paper print mode is selected, either a default print mode of step 766, or a<br>
78<br><br>
specific plain paper print mode of step 760, as shown in FIG. 32. Following the selecting step 1075, a printing step 1076 occurs, printing on this next sheet of incoming media with either the default plain paper print mode of step 770, or the specifically selected plain paper print mode of step 764. If instead the previous sheet $     determination indicated that a premium print mode was selected according to table 1064, then the selecting step 1075 would select a premium print mode, specifically the same print mode selected for the previous sheet, resulting in step 1076 being conducted according to either the default premium print mode 796, or a specific premium print mode of step 788 (FIG. 23).<br>
10	Thus, using the self-teaching media determination system 1050, when a new<br>
media signature is read by the sensor 100, the specific signature just read is stored in the printer's memory or look-up table 1064 in the preferred embodiment. When the signature is read on the next incoming sheet, prior to printing according to the advanced determination system 500 of FIGS. 15-23, it will instead be first compared<br>
15      in steps 1054 to see whether it is a borderline signature, and if so, then compared in step 1066 with the recently stored signatures and print modes in table 1064. If a match is found in the comparison step 1066, then this next incoming sheet of media will be printed according to the same print mode used for the previous sheet, as stored in the look-up table 1064.<br>
20	Thus, by employing the self-teaching media identification system 1050,<br>
stable consistent media detection results from page to page in a given print job are provided in a given printer 20. In the illustrated example, the signatures stored in table 1064 are stored in a temporary memory, which is then erased when the printer 20 is powered off, so the collection of new media signatures would begin<br>
25      again when the printer is turned back on. This occasional clearing of the memory accommodates variations over time in the media sensor 100, as well as variations in the new borderline media signatures, which may vary from ream to ream for a particular type of media. Alternatively, the value stored within table 1064 may be placed in permanent memory which would not be lost during a power down sequence, if such an application proves useful in some implementations. Furthermore, while the look-up table 1064 may be structured to carry a single group<br>
79<br><br>
of media signatures, a more advantageous system might allow several different types of media signatures to be stored within table 1064 to accommodate users which switch between several different media types on a routine basis. Allowing for multiple different types of signatures to be stored within table 1064 allows the user to receive consistent results on a regular basis when switching between different types of media which they commonly use.<br>
Conclusion<br>
Thus, a variety of advantages are realized using the advanced media determination system 500 of FIGS. 15-23. as well as the advantages realized using the more simple basic determination method 400 of FIG. 8. Indeed, preferably portions of the basic method of FIG. 8 are incorporated into and used in the advanced detection system 500, specifically, the identification of a transparency without a header tape. While the basic media determination system 400 was able to sort out photo media from plain paper, and able to distinguish transparencies with and without a tape header, a more advanced media determination system was desired to distinguish between various types of premium paper and various types of photo medias. This desire to identify the various types of premium and photo medias was spurred on by a desire to provide users with photographic quality images. While the current printer drivers do allow users to go into the program and select a specific type of media, it has been found that most users lack the sophistication to enter the program and make these determinations. Often though it is not a matter of lack of sophistication, but users may also suffer from a lack of time to make such a selection, as well as simply not knowing which type of photo media or premium media which they have in their hand to print upon. Whatever the reason, for simplicity of use, an automatic media determination system which selects the optimum print modes for the type of media entering the printzone is desired, and the advance determination system 500 accomplishes these objectives.<br>
Furthermore, use of the media sensor 100 advantageously is both a small ctfmpacl unit, which is economical, lightweight, and easily integrated into existing printer architectures. Another advantage of the advanced media determination<br>
80<br><br>
system 500. and the use of the media sensor 100, is that the system does not require any special markings to be made on a sheet of media   Earlier systems required the media suppliers to place special markings on the media which were then interpreted by a sensor, but unfortunately these markings would often run into the printed image, 5     resulting in undesirable print artifact defects<br>
Additionally, the media sensor 100 may also be used for detecting printed ink droplets, to assist in pen alignment routine as described above with respect to the monochromatic sensor described in U.S. Patent No. 6,036.298, recited in the Related Applications section above. Furthermore, the advanced determination system 500 10     operates without requiring absolute calibration at the factory for each type of media because the measurements made by the sensor 100 are relative measurements, with the only factory calibration needed revolving around the use of plain paper media, as mentioned above. Thus, a variety of advantages are realized using the advanced media determination system 500. in conjunction with the illustrated blue-violet 1 &gt;      media sensor 100 ard the cducaublc media identification system 920, to provide consumers with a fast, economical, easy to use printing unit, which provides outstanding print quality outputs without user intervention.<br>
A variety of advantages are also realized using the cducatable media determination systems, whether the user-activated teach mode system 1000 is used, 20     or the self-taught determination system 1050 is used. Indeed, both the teach mode system 1000 and the self-taught system 1050 may be employed together, allowing a user to teach the printer about a specific new type of custom media using the method 1000, or if the particular user tacks the sophistication to implement the teach mode, then the printer can accommodate new or borderline medias by making a best 25      guess, and then applying the same best guess pnnt mode to subsequent sheets of the new type of media. Use of both of the educatablc media identification systems 1000 and 1050 provides users with consistent pnnt modes for custom or borderline pnnt medias<br>
Moreover, use of the teach mode system 1000 allows users to select what ."0      they consider to be the best print mode for a lypc of media to accommodate personal preferences which may vary from those selected by the advanced detcrmiaaiion<br>
81<br><br>
system 500 of FIGS. 15-23, or from the print modes selected by the self-taught system 1050. Furthermore, use of the teach mode system 1000 aJlows customers to upgrade their printers with the ability to recognize new media types over time, whether these new media signatures are introduced through the user's computer and 5      table 1016, or from manufacturer upgradable sources supplied on the internet via web-based tables 1018. When the advanced media determination system 500 was originally developed, the most common types of inkjet media was characterized and sorted into these various major categories and specific types or subsets of the major categories. This initial sorting routine of the advanced system 500 was done to 1)     accommodate variations in printers 20 and in the optical sensor 100. Thus, use of the teach mode identification system 1000 allows users to upgrade their particular printer to recognize a specific type of new media and to apply the print mode which a user considers to be the best fit when encountering this custom media in the future.<br>
82<br><br>
We claim:<br>
1.	A method (400, 500, 920, 1000, 1050) of classifying incoming media (170,<br>
830, 850) entering a printing mechanism (20), comprising the steps of:<br>
optically scanning (406, 502, 928, 940, 958, 1006) a printing surface (815, 834 854) of the incoming media (170, 830, 850) to gather specular and diffuse reflectance data;<br>
comparing (506, 508, 934, 1010) the specular and diffuse reflectance data (536) with known values for different media types to classify the incoming media (170, 830, 850) as one type thereof;<br>
selecting (512, 934, 1034, 1075) a print mode corresponding to said one type; and<br>
storing (1038, 1062) said selected print mode for the classified incoming media.<br>
2.	A method according,to claim 1-wherein:<br>
aaa^tioftalliyvcompijxses the methodf^rthor include fne step or generating a media signature for the<br>
incoming media (170, 830, 850) from the gathered specular and diffuse reflectance data (536); and<br>
the comparing step comprises the step of comparing (506, 508, 934, 1010, 1048) the generated media signature for the incoming media (170, 830, 850) with media signatures for said different media types.<br>
S3<br><br>
3.	A method according to claim 1 or 2 wherein:<br>
the optically scanning step comprises the step of optically scanning (1006) a group of incoming media each having substantially identical printing surface characteristics to ^her flne^^: an^^gi^e^|Qectance data (536) for said group;<br>
methodjurther includes the step of generating (1008) a group media signature for said group from the gathered specular and diffuse reflectance data (536); and<br>
the comparing step comprises the step of comparing (1010) the generated group media signature with media signatures for said different media types to classify the group of incoming media as one type thereof.<br>
4.	A method according to any of claims 1 through 3, wherein said comparing step<br>
comprises comparing the specular and diffuse reflectance data with known values (1014)<br>
stored within a controller portion (35) of the printing mechanism (20).<br>
5.	A method according to any of claims 1 through 4, wherein said comparing step<br>
comprises comparing the specular and diffuse reflectance data (536) with known values<br>
stored (1016) within a host computing device in communication with the printing<br>
mechanism (20).<br>
6.	A method according to any of claims 1 through 5, wherein said comparing step<br>
comprises comparing the specular and diffuse reflectance data (536) with known values<br>
stored (1018) at an internet website accessed by a host computing device in<br>
communication with the printing mechanism (20).<br>
Of,<br><br>
7.	A method according to any of claims 1 through 6,(£urtker including the steps<br>
of:<br>
determining (1020, 1030, 1054) whether a suitable classification was made in the comparing step;<br>
when the determination step determines that an unsuitable classification was made in the comparing step, printing samples (1024) of available print modes for user selection and classification (1034) of the incoming media; and<br>
wherein the storing step (1038) comprises storing a user selected print mode and user classification of the incoming media.<br>
f~*-^<br>
8.	A method according to any of claims 1 through 7,(£urther including the steps<br>
of:<br>
determining (1056) whether the gathered data for the incoming media is between known values for first and second media types; and<br>
classifying the incoming media as the first media type;<br>
wherein the storing step comprises storing (1062) the gathered data and the classification of the incoming media as the first media type;<br>
wherein the comparing step comprises comparing (1066) the specular and diffuse reflectance data with known values for previously classified incoming media as the first media type; and<br>
when the incoming media is classified as the previously classified incoming media which was classified as the first media type, the selecting step comprises selecting (1075) the print mode corresponding to the first media type.<br>
9.	A printing mechanism (20), comprising:<br>
a frame (22) which defines a printzone (25);<br>
a printheacT(70, 72, 74, 76) which prints (514) a selected image on a printing surface (815, 834, 854) of media (170, 830, 850) in the printzone (25) in response to a printing signal;<br>
a media sensor (515) which optically scans the printing surface (815, 834, 854) of incoming media (170, 830, 850) entering the printzone (25) to gather specular and diffuse reflectance data (536); and<br>
a controller (35) which compares the specular and diffuse reflectance data (536) with known values for different media types to classify the incoming media (170, 830, 850) as one type thereof, selects a print mode (512) corresponding to said one type,<br><br>
generates the printing signal for the selected image in response to the selected printmode, and stores (1038, 1062) the selected print mode.<br>
10. A printing mechanism according to claim 9, wherein in response to user initiation, the controller (35) compiles specular and diffuse reflectance data (536) for a group of incoming media each having substantially identical printing surface characteristics, and generates a group media signature (1008) from said compiled data.<br>
A system of classifying incoming media entering an inkjet or other printing mechanism is provided to identify media without requiring any special manufacturer markings. The incoming media is optically scanned using a blue-violet light to obtain both diffuse and specular reflectance data, from which a media signature is generated. The generated signature is compared with known signatures for different media types to classify the incoming media, and a corresponding print mode is selected. Finally, the selected print mode for the classified incoming media is stored for future reference. Thus, a consumer can teach the printing mechanism to recognize new types of media. For borderline media falling between two categories, the printer remembers which category was selected previously, and then applies the same print mode to the next borderline media to provide a visually consistent output. A printing mechanism constructed to implement this method is also provided.</td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
		<br>
		<div class="pull-left">
			<a href="202508-method-and-apparatus-for-filling-and-vacuum-sealing-pairs-of-bags.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="202510-oxy-fuel-combustion-system-and-uses-therefor.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>202509</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>IN/PCT/2001/00628/KOL</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>09/2007</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>02-Mar-2007</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>02-Mar-2007</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>14-Jan-2001</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>HEWLETT-PACKARD COMPANY</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>3000 HANOVER STREET, PALO ALTO, CA 94304 UNITED STATES OF COMPANY</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>WALKER, STEVEN, H</td>
											<td>2218 N E 232ND AVENUE, CAMAS, WA 98607, UNITED STATES OF AMERICA</td>
										</tr>
										<tr>
											<td>2</td>
											<td>SCOFIELD, STUART, A</td>
											<td>N E Allworth Road, Battle Ground, Wa 98604,</td>
										</tr>
										<tr>
											<td>3</td>
											<td>WARD, JEFFERSON, P</td>
											<td>17903 N E HOMESTEAD DRIVE, BRUSH PRAIRIE, WA 98606 UNITED STATES OF AMERICA</td>
										</tr>
										<tr>
											<td>4</td>
											<td>RICE, HUSTON, W</td>
											<td>6705 N E 12TH STREET, VANCOUVER, WA 98680, UNITED STATES OF AMERICA</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>B 41 J 2/01</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/US00/29871</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2000-10-27</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>09/607,206</td>
									<td>2000-06-28</td>
								    <td>U.S.A.</td>
								</tr>
								<tr>
									<td>2</td>
									<td>09/687,999</td>
									<td>2000-10-13</td>
								    <td>U.S.A.</td>
								</tr>
								<tr>
									<td>3</td>
									<td>09/430,487</td>
									<td>1999-10-29</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/202509-a-method-of-classifying-incoming-media-entering-a-printing-mechanism-and-a-printing-mechanism by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 00:33:20 GMT -->
</html>
