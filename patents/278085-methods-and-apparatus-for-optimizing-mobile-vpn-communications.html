<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/278085-methods-and-apparatus-for-optimizing-mobile-vpn-communications by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 04 Apr 2024 23:44:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 278085:METHODS AND APPARATUS FOR OPTIMIZING MOBILE VPN COMMUNICATIONS</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">METHODS AND APPARATUS FOR OPTIMIZING MOBILE VPN COMMUNICATIONS</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>Methods and apparatus for optimizing Mobile VPN communications are disclosed. When a data packet is transmitted between a Mobile Node that is a member of a VPN and a Correspondent Node, the data packet is transmitted between the Mobile Node and a Home Agent via a Mobile IP tunnel without transmitting the data packet via a VPN tunnel. However, the data packet is transmitted between the Home Agent and a VPN headend via a VPN tunnel.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>METHODS AND APPARATUS FOR OPTIMIZING MOBILE VPN<br>
COMMUNICATIONS<br>
BACKGROUND OF THE INVENTION<br>
The present invention relates to Mobile IP network technology. More<br>
specifically, this invention relates to mechanisms for optimizing communications<br>
between a Mobile Node supporting Mobile IP and a Correspondent Node, where the<br>
Mobile Node is a member of a Virtual Private Network (VPN).<br>
Mobile IP is a protocol which allows laptop computers or other mobile<br>
computer units (referred to as "Mobile Nodes" herein) to roam between various sub-<br>
networks at various locations — while maintaining internet and/or WAN connectivity.<br>
Without Mobile IP or a related protocol, a Mobile Node would be unable to stay<br>
connected while roaming through various sub-networks. This is because the IP<br>
address required for any node to communicate over the internet is location specific.<br>
Each IP address has a field that specifies the particular sub-network on which the<br>
node resides. If a user desires to take a computer which is normally attached to one<br>
node and roam with it so that it passes through different sub-networks, it cannot use<br>
its home base IP address. As a result, a business person traveling across the country<br>
cannot merely roam with his or her computer across geographically disparate network<br>
segments or wireless nodes while remaining connected over the internet. This is not<br>
an acceptable state-of-affairs in the age of portable computational devices.<br>
To address this problem, the Mobile IP protocol has been developed and<br>
implemented. An implementation of Mobile IP is described in RFC 2002 of the<br>
Network Working Group, C. Perkins, Ed., October 1996. Mobile IP is also described<br>
in the text "Mobile IP Unplugged" by J. Solomon, Prentice Hall. Both of these<br>
references are incorporated herein by reference in their entireties and for all purposes.<br>
The Mobile IP process in a Mobile IPv4 environment are illustrated in Figure<br>
1. As shown there, a Mobile IP environment 2 includes the internet (or a WAN) 4<br>
over which a Mobile Node 6 can communicate remotely via mediation by a Home<br>
Agent 8 and may also include a Foreign Agent 10. In the absence of a Foreign Agent,<br>
the Mobile Node 6 can obtain a topologically correct IP address (i.e., collocated IP<br>
address) and register this IP address with the Home Agent. Typically, the Home<br>
Agent and Foreign Agent are routers or other network connection devices performing<br>
 <br>
appropriate Mobile IP functions as implemented by software, hardware, and/or<br>
firmware. A particular Mobile Node (e.g., a laptop computer) plugged into its home<br>
network segment connects with the internet through its designated Home Agent.<br>
When the Mobile Node roams, it communicates via the internet through an available<br>
Foreign Agent. Presumably, there are many Foreign Agents available at<br>
geographically disparate locations to allow wide spread internet connection via the<br>
Mobile IP protocol. Note that it is also possible for the Mobile Node to register<br>
directly with its Home Agent.<br>
• As shown in Figure 1, Mobile Node 6 normally resides on (or is "based at") a<br>
network segment 12 which allows its network entities to communicate over the<br>
internet 4 through Home Agent 8 (an appropriately configured router denoted R2).<br>
Note that Home Agent 8 need not directly connect to the internet. For example, as<br>
shown in Figure 1, it may be connected through another router (a router Rl in this<br>
case). Router Rl may, in turn, connect one or more other routers (e.g., a router R3)<br>
with the internet.<br>
Now, suppose that Mobile Node 6 is removed from its home base network<br>
segment 12 and roams to a remote network segment 14. Network segment 14 may<br>
include various other nodes such as a PC 16. The nodes on network segment 14<br>
communicate with the internet through a router which doubles as Foreign Agent 10.<br>
Mobile Node 6 may identify Foreign Agent 10 through various solicitations and<br>
advertisements which form part of the Mobile IP protocol. When Mobile Node 6<br>
engages with network segment 14, Foreign Agent 10 relays a registration request to<br>
Home Agent 8 (as indicated by the dotted line "Registration"). The Home and<br>
Foreign Agents may then negotiate the conditions of the Mobile Node's attachment to<br>
Foreign Agent 10. For example, the attachment may be limited to a period of time,<br>
such as two hours. When the negotiation is successfully completed, Home Agent 8<br>
updates an internal "mobility binding table" which specifies the care-of address (e.g.,<br>
a collocated care-of address or the Foreign Agent's IP address) in association with the<br>
identity of Mobile Node 6. Further, the Foreign Agent 10 updates an internal "visitor<br>
table" which specifies the Mobile Node address, Home Agent address, etc. In effect,<br>
the Mobile Node's home base IP address (associated with segment 12) has been<br>
shifted to the Foreign Agent's IP address (associated with segment 14).<br>
Now, suppose that Mobile Node 6 wishes to send a message to a<br>
Correspondent Node 18 from its new location. In Mobile IPv4, a message from the<br>
2<br>
 <br>
Mobile Node is then packetized and forwarded through Foreign Agent 10 over the<br>
internet 4 and to Correspondent Node 18 (as indicated by the dotted line "packet from<br>
MN") according to a standard internet protocol. If Correspondent Node 18 wishes to<br>
send a message to Mobile Node — whether in reply to a message from the Mobile<br>
Node or for any other reason - it addresses that message to the IP address of Mobile<br>
Node 6 on sub-network 12. The packets of that message are then forwarded over the<br>
internet 4 and to router Rl and ultimately to Home Agent 8 as indicated by the dotted<br>
line ("packet to MN(1)"). From its mobility binding table, Home Agent 8 recognizes<br>
that Mobile Node 6 is no longer attached to network segment 12. It then encapsulates<br>
the packets from Correspondent Node 18 (which are addressed to Mobile Node 6 on<br>
network segment 12) according to a Mobile IP protocol and forwards these<br>
encapsulated packets to a "care of address for Mobile Node 6 as shown by the dotted<br>
line ("packet to MN(2)"). The care-of address may be, for example, the IP address of<br>
Foreign Agent 10. Foreign Agent 10 then strips the encapsulation and forwards the<br>
message to Mobile Node 6 on sub-network 14. The packet forwarding mechanism<br>
implemented by the Home and Foreign Agents is often referred to as "tunneling." In<br>
the absence of a Foreign Agent, packets are tunneled directly to the Mobile Node 6<br>
collocated care-of address.<br>
The Mobile IP protocol for Ipv6 has been described in RFC 3775, entitled<br>
"Mobility Support in Ipv6," published in June 2004, by Johnson et al. RFC 3775<br>
discloses a protocol which allows nodes to remain reachable while roaming in IPv6.<br>
RFC 3775 is incorporated herein by reference for all purposes. As disclosed in<br>
"Mobility Support in IPv6," the Home Agent generally advertises its address, which is<br>
obtained by a Mobile Node. In Mobile Ipv6, there is no Foreign Agent. However, an<br>
access router 10 is present to provide connectivity to the network. The Mobile Node<br>
then sends a Binding Update message to the Home Agent. The Home Agent then<br>
sends a Binding Acknowledgement message to the Mobile Node. The Binding<br>
Update and Binding Acknowledgement messages are protected in IPSec transport<br>
mode. The Home Agent creates a binding cache entry and a tunnel is established<br>
between the Mobile Node's care-of address and the Home Agent. When a<br>
Correspondent Node sends a packet to the Mobile Node, it is forwarded to the Mobile<br>
Node by the Home Agent via the tunnel that has been established.<br>
Mobile operators and service providers assign private IP addresses to their<br>
subscribers. More specifically, mobile operators worldwide typically use private<br>
3<br>
 <br>
Dynamic Host Configuration Protocol (DHCP) or PPP IP Control Protocol (IPCP)<br>
address assignment to their mobile users due to the lack of IP addresses. When the<br>
users are accessing the internet, the private IP address assigned to a user is translated<br>
to a public address at the edge of the private network before the packets are sent via<br>
the internet. This function is typically referred to as Network Address Translation<br>
(NAT).<br>
In a virtual private network (VPN), addresses used within the network are<br>
typically private IP addresses. In order for nodes within the VPN to communicate<br>
with nodes outside the VPN, NAT is typically performed to convert private to public<br>
addresses and vice versa. This address conversion is performed by a NAT module or<br>
device as set forth in RFC 1631, entitled "The IP Network Address Translator<br>
(NAT)," published in May 1994 by Egevang et al, which is incorporated herein by<br>
reference for all purposes.<br>
Internet draft entitled, "Mobile IPv4 Traversal Across IPsec-based VPN<br>
Gateways" by S. Varaala and Stinghom, published on September 28,2004, and<br>
available at "http ://wwwl .ietf.org/proceedings_new/04nov/TDs/draft-ietf-mip4-vpn-<br>
problem-solution-OO.txt," discloses a layered solution for VPN traversal, and is<br>
incorporated herein by reference for all purposes. Specifically, this solution requires<br>
two layers of tunneling at mobility layers and an additional layer of tunneling at the<br>
VPN layer. The first Mobile IP tunnel exists between the Home Agent and the<br>
Mobile Node to provide mobility inside the enterprise. A second Mobile IP tunnel<br>
exists between the Home Agent and the Mobile Node when the Mobile Node moves<br>
outside the enterprise network. In addition, a VPN tunnel also exists between the<br>
Mobile Node and a VPN headend. The VPN headend is also sometimes referred to as<br>
a "VPN concentrator.' The VPN headend is a network device that manages<br>
information associated with a VPN session. The VPN tunnel associated with a<br>
Mobile Node terminates at the VPN headend. In order to create a VPN session, a<br>
VPN client attaches to the VPN headend.<br>
Since the VPN tunnel and the second Mobile IP tunnel are required when the<br>
Mobile Node roams outside the VPN, two different tunnels are used simultaneously to<br>
transport data between the Mobile Node and the VPN headend. These two layers of<br>
encapsulation result in significant overhead, particularly on wireless links.<br>
In view of the above, it would be beneficial if Mobile VPN communications<br>
could be optimized.<br>
4<br>
 <br>
SUMMARY OF THE INVENTION<br>
Methods and apparatus for optimizing Mobile VPN communications are<br>
disclosed. This is accomplished, in part, by tunneling data packets between a Mobile<br>
Node and its Home Agent via a single tunnel, rather than two different tunnels, where<br>
the Mobile Node is a member of a VPN. In this manner, Mobile VPN<br>
communications are optimized.<br>
In accordance with one aspect of the invention, when a data packet is<br>
transmitted between a Mobile Node that is a member of a VPN and a Correspondent<br>
Node, the data packet is transmitted between the Mobile Node and a Home Agent via<br>
a Mobile IP tunnel without transmitting the data packet via a VPN tunnel. However,<br>
the data packet is transmitted between the Home Agent and a VPN headend via a<br>
VPN tunnel.<br>
In accordance with one embodiment, a Home Agent supports data<br>
communications from a Mobile Node to a Correspondent Node. Specifically, the<br>
Home Agent receives a data packet from a Mobile Node via a Mobile IP tunnel. The<br>
Home Agent changes a source address of the data packet from the Mobile Node's<br>
care-of address to the Mobile Node's home address, and changes a destination address<br>
of the data packet from the address of the Home Agent to an address of a VPN<br>
headend. The Home Agent then transmits the data packet to the VPN headend via a<br>
VPN tunnel.<br>
In accordance with another embodiment, the Home Agent supports data<br>
communications from a Correspondent Node to a Mobile Node. Specifically, the<br>
Home Agent receives a data packet from a VPN headend via a VPN tunnel. The<br>
Home Agent changes a source address of the data packet from an address of a VPN<br>
headend to an address of the Home Agent. In addition, the Home Agent changes a<br>
destination address of the data packet from a home address of the Mobile Node to a<br>
care-of address of the Mobile Node. The Home Agent then transmits the data packet<br>
to the care-of address of the Mobile Node via a Mobile IP tunnel.<br>
 In accordance with another aspect of the invention, a Mobile Node supports<br>
data communications by the Mobile Node to a Correspondent Node. Specifically, a<br>
method of optimizing Mobile IP communications includes generating (or receiving) a<br>
data packet, setting up a Mobile IP tunnel, setting up a VPN tunnel, and transmitting<br>
the data packet to the Home Agent via only the Mobile IP tunnel. The VPN tunnel<br>
5<br>
 <br>
may thereafter be used to tunnel packets to the Mobile Node (e.g., from a<br>
Correspondent Node).<br>
la accordance with yet another aspect of the invention, a Mobile Node<br>
supports data communications by a Correspondent Node to the Mobile Node.<br>
Specifically, in accordance with one embodiment, the Mobile Node receives a data<br>
packet from a Home Agent at a Mobile IP layer of the Mobile Node via a Mobile IP<br>
tunnel. The Mobile Node modifies a source address of the data packet from an<br>
address of a Home Agent to an address of a VPN headend. The Mobile Node also<br>
modifies a destination address of the data packet from a care-of address of the Mobile<br>
Node to a home address of the Mobile Node. The Mobile Node then forwards the<br>
modified data packet to a VPN client of the Mobile Node such that the data packet<br>
appears as if it originated at the VPN headend.<br>
In accordance with another aspect of the invention, the invention pertains to a<br>
system operable to perform and/or initiate optimized Mobile VPN communications<br>
between a Mobile Node and a Correspondent Node, where the Mobile Node is a<br>
member of a VPN. The system includes one or more processors and one or more<br>
memories, which may be implemented in a Mobile Node, Home Agent, and/or VPN<br>
headend. At least one of the memories and processors are adapted to provide at least<br>
some of the above described method operations. In yet a further embodiment, the<br>
invention pertains to a computer program product for performing the disclosed<br>
methods. The computer program product has at least one computer readable medium<br>
and computer program instructions stored within at least one of the computer readable<br>
product configured to perform at least some of the above described method<br>
operations.<br>
These and other features and advantages of the present invention will be<br>
presented in more detail in the following specification of the invention and the<br>
accompanying figures, which illustrate by way of example the principles of the<br>
invention.<br>
6<br>
 <br>
BRIEF DESCRIPTION OF THE DRAWINGS<br>
FIG. 1 is a diagram of a Mobile IP network segment and associated<br>
environment.<br>
FIG. 2 is a diagram illustrating a system for performing Mobile VPN<br>
communications in accordance with various embodiments of the invention.<br>
FIG. 3 is a process flow diagram illustrating the general control and data paths<br>
for optimizing Mobile VPN communications in accordance with one embodiment of<br>
the invention.<br>
FIG. 4A is a process flow diagram illustrating the forward data path when a<br>
NAT box is not in the path from the Mobile Node to its home network in accordance<br>
with one embodiment of the invention.<br>
FIG. 4B is a process flow diagram illustrating the reverse data path when a<br>
NAT box is not in the path from the Mobile Node to its home network in accordance<br>
with one embodiment of the invention.<br>
FIG. 5A is a process flow diagram illustrating the data path when a NAT box<br>
is in the path from the Mobile Node to its home network and the VPN client performs<br>
UDP encapsulation.<br>
FIG. 5B is a process flow diagram illustrating the data path when a NAT box<br>
is in the path from the Mobile Node to its home network and the MIP client performs<br>
UDP encapsulation.<br>
FIG. 6 is a diagrammatic representation of a router in which embodiments of<br>
the present invention may be implemented.<br>
DETAILED DESCRIPTION OF SPECIFIC EMBODIMENTS<br>
Reference will now be made in detail to a specific embodiment of the<br>
invention. An example of this embodiment is illustrated in the accompanying<br>
drawings. While the invention will be described in conjunction with this specific<br>
embodiment, it will be understood that it is not intended to limit the invention to one<br>
embodiment. On the contrary, it is intended to cover alternatives, modifications, and<br>
equivalents as may be included within the spirit and scope of the invention as defined<br>
by the appended claims. In the following description, numerous specific details are<br>
set forth in order to provide a thorough understanding of the present invention. The<br>
present invention may be practiced without some or all of these specific details. In<br>
7<br>
 <br>
other instances, well known process operations have not been described in detail in<br>
order not to unnecessarily obscure the present invention.<br>
Embodiments of the invention support optimized Mobile VPN<br>
communications. This is accomplished through "collapsing" two tunnels into a single<br>
tunnel such that data packets are transmitted between two nodes via a single tunnel<br>
rather than two different tunnels, where at least one of the nodes is a member of a<br>
VPN. In accordance with various embodiments disclosed herein, data packets<br>
transmitted between a Mobile Node and its Home Agent are transported via a Mobile<br>
W tunnel without tunneling the data packets between the Mobile Node and the Home<br>
Agent via a VPN tunnel, where the Mobile Node is a member of a VPN.<br>
FIG. 2 is a diagram illustrating a system for performing Mobile VPN<br>
communications in accordance with various embodiments of the invention. The<br>
system 202 includes a Mobile Node 204 that is a member of a VPN. In order to<br>
function in a VPN, the Mobile Node (client) 204 includes a Mobile IP client 206 and<br>
a VPN client 208. Specifically, the Mobile IP client 206 performs Mobile IP<br>
operations such as Mobile IP tunneling, while the VPN client 208 performs operations<br>
such as VPN tunneling. Both clients 206 and 208 may be implemented in hardware<br>
and/or software.<br>
When the Mobile Node 204 registers with its Home Agent 210, a Mobile IP<br>
tunnel 212 is generated between the Mobile Node 204 and the Home Agent 210.<br>
Similarly, a VPN tunnel 214 is established between the VPN client 208 and a VPN<br>
headend 216. The VPN tunnel 214 may be used to transmit data packets between the<br>
Home Agent 210 and the VPN headend 216, but will not be used simultaneously with<br>
the Mobile IP tunnel 212 used to transmit data packets between the Mobile Node 204<br>
and the Home Agent 210.<br>
As described above with reference to FIG. 1, a Foreign Agent is optional in<br>
Mobile IPv4 and is not implemented in Mobile IPv6. The disclosed embodiments<br>
may be implemented in a system including a Foreign Agent. However, since the<br>
Foreign Agent performs the Mobile IP tunneling in these instances, the Mobile IP<br>
client does not add any extra encapsulation on the airlink. As a result, the disclosed<br>
embodiments do not improve performance in a system in which a Foreign Agent is<br>
implemented. Accordingly, the disclosed embodiments are only described with<br>
reference to a system in which a Foreign Agent is not implemented.<br>
8<br>
 <br>
It is also important to note that a NAT module 220 may be implemented in the<br>
path between the Mobile Node 204 and the Home Agent 210. Thus* the NAT module<br>
220 is optional. Specifically, although private addresses are commonly used in an<br>
enterprise such as a VPN, it is possible that the addresses that are assigned to Mobile<br>
Nodes are public addresses. In such an instance, since the network is using publicly<br>
routable addresses, a NAT module 220 is not required.<br>
Specifically, devices within the VPN may be configured to use HDP tunneling<br>
for NAT traversal. However, it is important to note that depending upon the<br>
implementation of the VPN and associated VPN tunneling, UDP tunneling may be<br>
used, but is not necessarily required for NAT traversal.<br>
In instances where the VPN client of the Mobile Node 204 and the VPN<br>
headend 216 are configured to always use UDP tunneling (for purposes of NAT<br>
traversal), if there is no NAT module 220 in the path between the Mobile Node 204<br>
and the Home Agent 210, the additional UDP header merely adds 8 extra bytes of<br>
unnecessary information and overhead to the data packet. Since the VPN layer of the<br>
Mobile Node 204 is typically unaware of the presence or absence of a NAT module<br>
220 in the path between the Mobile Node 204 and the Home Agent 210, the VPN<br>
layer may append a UDP encapsulation header that is used for purposes of NAT<br>
traversal. In these instances, since the Mobile IP layer of the Mobile Node 204 can<br>
detect the presence or absence of a NAT module 220 in the path between the Mobile<br>
Node 204 and the Home Agent 210, the Mobile IP layer of the Mobile Node 204 can<br>
remove the UDP encapsulation header when a NAT module 220 is not present before<br>
sending a data packet. The Home Agent 210 may then append the UDP encapsulation<br>
header before forwarding the data packet to the VPN headend, thereby ensuring that<br>
the VPN headend receives the data packet in the appropriate format.<br>
FIG. 3 is a process flow diagram illustrating the general control and data paths<br>
for optimizing Mobile VPN communications in accordance with one embodiment of<br>
the invention. Steps performed by a Mobile Node, Home Agent and VPN headend<br>
are represented by vertical lines 302,304, 306, respectively. The VPN headend and<br>
the Home Agent may be implemented as separate devices or as a single device. If the<br>
Home Agent and the VPN headend are implemented as separate devices, the Home<br>
Agent is aware of an IP address of the VPN headend, in accordance with one<br>
embodiment. This may be accomplished, for example, by configuring the Home<br>
Agent with the IP address of the VPN headend or sending a notification message<br>
9<br>
 <br>
including the IP address of the VPN headend to the Home Agent (e.g., from the<br>
Mobile Node).<br>
In the control path 307, the Mobile Node can detect whether a NAT device is<br>
in the path between the Mobile Node and the Home Agent at 308 in accordance with<br>
standard processes, as set forth in RFC 3519, entitled, "Mobile IP Traversal of<br>
Network Address Translation (NAT) Devices," published in April, 2003, by<br>
Levkowetz et al, which is incorporated herein by reference for all purposes. In<br>
addition, the Mobile Node detects whether the VPN performs UDP encapsulation at<br>
310.<br>
In order to register with the Home Agent, the Mobile Node sends a registration<br>
request at 312. The Mobile Node may indicate in the registration request that it<br>
supports tunneling optimization. In addition, the registration request may also<br>
indicate that whether a NAT device is in the path between the Home Agent and the<br>
Mobile Node and/or whether UDP encapsulation is required. These indications may<br>
be provided in one or more extensions to the registration request. When the Home<br>
Agent sends a registration reply to the Mobile Node at 314 indicating whether the<br>
registration with the Home Agent was successful, the Home Agent may similarly<br>
indicate that it supports tunneling optimization. The Home Agent may also indicate<br>
whether it performs UDP encapsulation, as will be described in further detail below.<br>
These indications may be provided in one or more extensions to the registration reply.<br>
The Mobile Node and Home Agent set up the Mobile IP tunnel at 316. At that time,<br>
the Home Agent may store any information it has obtained from the registration<br>
request in a table such as its mobility binding table, in which the Home Agent<br>
associates the Mobile Node with the Mobile Node's care-of address. For instance, the<br>
Home Agent may indicate in the appropriate mobility binding table entry that UDP<br>
encapsulation is required and/or a NAT module is in the path between the Home<br>
Agent and the Mobile Node. The Mobile Node and VPN headend then perform VPN<br>
signaling to set up the VPN tunnel between the Mobile Node and the VPN headend at<br>
318. In accordance with one embodiment, the VPN tunnel is set upon upon<br>
completion of Mobile IP registration of the Mobile Node with its Home Agent.<br>
Once the control signaling is completed, data packets may be transmitted<br>
between the Mobile Node associated with a VPN and a Correspondent Node. The<br>
data path 320 illustrates the flow of data packets. As will be described in further<br>
detail below, the Mobile Node optionally performs UDP encapsulation at 322 and<br>
10<br>
 <br>
transmits a data packet at 324. The Home Agent intercepts the data packet and<br>
determines whether the data packet has been tunneled via a VPN/UDP tunnel at 326.<br>
This may be accomplished by determining whether the data packet has been tunneled<br>
via a HDP tunnel or whether a NAT device is in a path between the Home Agent and<br>
a Mobile Node. This may be ascertained by obtaining the appropriate information<br>
associated with the registered Mobile Node from the appropriate entry in the Home<br>
Agent's mobility binding table. When the Home Agent determines that the data<br>
packet has been tunneled via a UDP tunnel or a NAT device is in the path between the<br>
Home Agent and the Mobile Node, the Home Agent transmits the data packet to a<br>
VPN headend via a UDP/VPN tunnel. The Home Agent forwards the data packet to<br>
the VPN headend at 328 and the VPN headend forwards the data packet to its<br>
destination at 330.<br>
When the Home Agent determines that the data packet has not been tunneled<br>
via a UDP tunnel or that a NAT device is not in the path between the Home Agent<br>
and the Mobile Node, the Home Agent may forward the data packet to its destination<br>
via a Mobile IP tunnel at 332.<br>
A NAT module may or may not be in the path between a Mobile Node and its<br>
home network (e.g., Home Agent). When a NAT module is not in the path between<br>
the Mobile Node and the home network, NAT traversal need not be performed. In<br>
such an instance, in the event that the VPN client is configured to automatically add a<br>
UDP header, the UDP header may be removed by the Mobile IP client. In the event<br>
that a NAT module is in the path between the Mobile Node and the home network,<br>
NAT traversal may be performed by the Mobile Node (e.g., either the Mobile IP<br>
client or the VPN client) and/or the Home Agent. In addition, UDP encapsulation<br>
may be performed by the Mobile Node (e.g., Mobile IP client or VPN client) or the<br>
Home Agent. Various embodiments for transmuting data packets between a Mobile<br>
Node in a VPN and a Correspondent Node under each of these scenarios will be<br>
described in further detail below with reference to FIGs. 4A, 4B, 5A, and 5B.<br>
FIG. 4A is a process flow diagram illustrating the forward data path when a<br>
NAT box is not in the path from the Mobile Node to its home network in accordance<br>
with one embodiment of the invention. In this embodiment, the Mobile IP client does<br>
not perform UDP encapsulation. However, the VPN client may perform UDP<br>
encapsulation. The control path for UDP tunneling is illustrated at 402. In the event<br>
that the VPN client performs UDP encapsulation, the Mobile Node may provide the<br>
11<br>
 <br>
source port and destination port used by the VPN client to the Home Agent. This may<br>
be accomplished by sending a registration request indicating a source port and<br>
destination port used by a VPN client of the Mobile Node to the Home Agent at 404.<br>
This registration request maybe the same registration request described above with<br>
reference to FIG. 3, or may be a second registration request. The Home Agent sends<br>
a registration reply at 406 acknowledging this registration request. In addition, the<br>
Home Agent may associate the Mobile Node with its care-of address, the source port<br>
and the destination port at 408. This may be accomplished, for example, by storing<br>
this information in an entry in its mobility binding table.'<br>
The forward data path 410 includes steps enabling a Mobile Node to send data<br>
packets to a Correspondent Node. When an application of the Mobile Node generates<br>
a data packet, for example, the VPN client may encrypt the data packet and add a<br>
UDP header at 414. While the VPN client is not aware of the presence (or absence)<br>
of a NAT device, the Mobile IP client can detect the presence of a NAT device. Thus,<br>
if the VPN client does perform UDP encapsulation at 416 and the Mobile IP client has<br>
detected that there is no NAT module in the path between the Mobile Node and the<br>
Home Agent, the Mobile IP client removes the UDP header at 418. The Home Agent<br>
will later add a UDP header such that the VPN headend will receive the data packet in<br>
the appropriate format, as will be described in further detail below. The Mobile IP<br>
client then forwards the data packet at 422.<br>
As shown at 424, the forwarded data packet no longer includes the VPN<br>
header that is typically included in the data packet. In other words, the data packet is<br>
not also transmitted to the Home Agent via an additional VPN tunnel. As shown, the<br>
VPN header typically includes the home address of the Mobile Node as the source<br>
address and the address of the VPN headend as the destination address. Thus, as<br>
shown, the original data packet is addressed to a Correspondent Node and the source<br>
address is the VPN client. The header of the data packet identifies the care-of address<br>
of the Mobile Node as the source address and the address of the Home Agent as the<br>
destination address.<br>
When the Home Agent receives the data packet via the Mobile IP tunnel, it<br>
typically decapsulates the data packet. However, instead, it performs address<br>
translation of both the source and destination IP addresses of the IP header of the data<br>
packet at 426 before it forwards the data packet to the VPN headend. Specifically, the<br>
Home Agent changes a source address of the data packet from the Mobile Node's<br>
12<br>
 <br>
care-of address to the Mobile Node's home address. In addition, the Home Agent<br>
changes a destination address of the data packet from the address of the Home Agent<br>
to an address of a VPN headend.<br>
If UDP encapsulation is required, as indicated to the Home Agent in the<br>
registration request it previously received, the Home Agent appends a UDP header to<br>
the data packet at 428 prior to forwarding the data packet to the VPN headend. This<br>
Home Agent functionality is performed, since the data packet received by the Home<br>
Agent from the Mobile Node does not include a UDP header, since it was removed by<br>
the Mobile IP client to remove this additional tunneling layer. Specifically, the UDP<br>
header identifies the source port and destination port specified in the registration<br>
request that the Home Agent received from the Mobile Node. The Home Agent then<br>
transmits the data packet to the VPN headend via a VPN tunnel at 430. The VPN<br>
headend decrypts the data packet at 432 and forwards the data packet.<br>
FIG. 4B is a process flow diagram illustrating the reverse data path when a<br>
NAT box is not in the path from the Mobile Node to its home network in accordance<br>
with one embodiment of the invention. When the VPN headend receives a data<br>
packet from a Correspondent Node at 450, it encrypts the packet and forwards the<br>
packet at 452 to the Home Agent via a VPN tunnel. As shown at 454, the source IP<br>
address of the data packet is the address of the Correspondent Node and the<br>
destination IP address of the data packet is the address of the VPN client. Once the<br>
data packet has been encrypted, the source IP address of the packet header is the<br>
address of the VPN headend and the destination IP address of the packet header is the<br>
home address of the Mobile Node, since the data packet has been addressed by the<br>
VPN headend for transmission via a VPN tunnel.<br>
When the Home Agent receives the data packet, it processes the data packet at<br>
456. As shown at 458, rather than decapsulating the packet, it changes a source<br>
address of the data packet header from an address of a VPN headend to an address of<br>
the Home Agent, and changes a destination address of the data packet header from a<br>
home address of the Mobile Node to a care-of address of the Mobile Node. The<br>
Home Agent then transmits the data packet to the care-of address of the Mobile Node<br>
via only a Mobile IP tunnel at 460 and the packet is routed to the Mobile Node at 462.<br>
Thus, the data packet is not transmitted from the Home Agent to the Mobile Node via<br>
a VPN tunnel.<br>
13<br>
 <br>
When the Mobile Node receives a data packet from a Home Agent, the data<br>
packet is intercepted by a Mobile IP layer of the Mobile Node via a Mobile IP tunnel.<br>
The Mobile IP client performs reverse address translation by modifying a source<br>
address of the data packet from an address of the Home Agent to an address of the<br>
VPN headend, and modifies a destination address of the data packet from the care-of<br>
address of the Mobile Node to the home address of the Mobile Node at 464. The<br>
Mobile IP client then forwards the modified data packet to a VPN client of the Mobile<br>
Node such that the data packet appears as if it originated at the VPN headend at 466.<br>
The VPN client then decrypts the data packet and forwards the decrypted data packet<br>
to the Mobile IP layer at 468.<br>
FIG. 5A is a process flow diagram illustrating the data path when a NAT box<br>
is in the path from the Mobile Node to its home network and the VPN client performs<br>
UDP encapsulation. In this embodiment, the Mobile IP client does not perform UDP<br>
encapsulation. However, the VPN client performs UDP encapsulation. The control<br>
path for UDP tunneling is illustrated at 502. In the event that the VPN client performs<br>
UDP encapsulation, the Mobile Node may provide the source port and destination<br>
port used by the VPN client to the Home Agent. This may be accomplished by<br>
sending a registration request indicating a source port and destination port used by a<br>
VPN client of the Mobile Node to the Home Agent at 504. This registration request<br>
may be the same registration request described above with reference to FIG. 3, or may<br>
be a second registration request. The Home Agent sends a registration reply at 506<br>
acknowledging this registration request. In addition, the Home Agent may associate<br>
the Mobile Node with its care-of address, the source port and the destination port at<br>
508. This may be accomplished, for example, by storing this information in an entry<br>
in its mobility binding table.<br>
The forward data path 510 includes steps enabling a Mobile Node to send data<br>
packets to a Correspondent Node. When an application of the Mobile Node generates<br>
a data packet at 512, the VPN client encrypts the data packet and appends a UDP<br>
header at 514. In accordance with one embodiment, the VPN client chooses a random<br>
source port and sets the destination port to 10,000 for Cisco's VPN, for example, at<br>
516. The Mobile IP client then modifies the destination port at 520 to port 434, which<br>
is the Mobile IP port as specified in RFC 3519. The Mobile Node then forwards the<br>
data packet to the Home Agent at 522. As shown at 524, the data packet includes a<br>
UDP header, and includes an IP header in which the source address is the care-of<br>
14<br>
 <br>
address of the Mobile Node and the destination address is the address of the Home<br>
Agent. The data packet is sent by the VPN client to the Correspondent Node.<br>
However, the data packet is transmitted by a Mobile IP tunnel, but not via a VPN<br>
tunnel.<br>
When the Home Agent receives the data packet at 526 via the Mobile IP<br>
tunnel, it typically decapsulates the data packet. However, instead, it performs<br>
address translation of both the source and destination IP addresses of the IP header of<br>
the data packet at 528 before it forwards the data packet to the VPN headend at 530<br>
via a VPN tunnel. Specifically, the Home Agent changes a source address of the data<br>
packet from the Mobile Node's care-of address to the Mobile Node's home address.<br>
In addition, the Home Agent changes a destination address of the data packet from the<br>
address of the Home Agent to an address of a VPN headend. As shown at 532, the<br>
data packet includes the UDP header described above. When the VPN headend<br>
receives the data packet, it decrypts the data packet and forwards the data packet to<br>
the Correspondent Node at 534.<br>
FIG. 5B is a process flow diagram illustrating the data path when a NAT box<br>
is in the path from the Mobile Node to its home network and the MP client performs<br>
UDP encapsulation. In this embodiment, the Mobile IP client, rather than the VPN<br>
client, performs UDP encapsulation. The control path for UDP tunneling is illustrated<br>
at 550. The Mobile Node sends a message such as a registration request at 551<br>
indicating that a VPN client of the Mobile Node does not add a UDP header and/or<br>
the Home Agent needs to remove a UDP header added by a Mobile IP client of the<br>
Mobile Node. Such indications may be provided in the registration request via an<br>
extension to the registration request. This registration request may be the same<br>
registration request described above with reference to FIG. 3, or may be a second<br>
registration request. The Home Agent may then send a message such as a registration<br>
reply acknowledging the message sent by the Mobile Node at 552.<br>
The forward data path 554 includes steps enabling a Mobile Node to send data<br>
packets to a Correspondent Node. When an application of the Mobile Node generates<br>
a data packet at 556, the VPN client does not encrypt the packet or append a UDP<br>
header at 558 as described above with reference to FIG. 5A. Rather, the Mobile IP<br>
client encrypts the data packet and appends a UDP header at 562. In accordance with<br>
one embodiment, the Mobile IP client chooses a random source port and sets the<br>
15<br>
 <br>
destination port to port 434, which is the Mobile IP port as specified in RFC 3519.<br>
The Mobile Node then forwards the data packet to the Home Agent at 564.<br>
As shown at 566, the data packet includes a UDP header, and includes an IP<br>
header in which the source address is the care-of address of the Mobile Node and the<br>
destination address is the address of the Home Agent. The data packet is sent by the<br>
VPN client to the Correspondent Node. However, the data packet is transmitted by a<br>
Mobile IP tunnel, but not via a VPN tunnel.<br>
When the Home Agent receives the data packet via the Mobile IP tunnel, it<br>
removes the UDP header at 568. In addition, it performs address translation of both<br>
the source and destination IP addresses of the IP header of the data packet at 570<br>
before it forwards the data packet to the VPN headend at 572 via a VPN tunnel.<br>
Specifically, the Home Agent changes a source address of the data packet from the<br>
Mobile Node's care-of address to the Mobile Node's home address. In addition, the<br>
Home Agent changes a destination address of the data packet from the address of the<br>
Home Agent to an address of the VPN headend. As shown at 574, when the VPN<br>
headend receives the data packet, it decrypts the data packet and forwards the data<br>
packet to the Correspondent Node at 576.<br>
The disclosed embodiments support optimized communications between a<br>
Mobile Node that is a member of a VPN and a Correspondent Node. This is<br>
accomplished by transporting data packets between two nodes via either a Mobile IP<br>
tunnel or a VPN tunnel, but not both tunnels simultaneously. The above-described<br>
embodiments are merely illustrative. Accordingly, alternative methods and packet<br>
formats are contemplated for accomplishing this optimization.<br>
The invention can also be embodied as computer readable code on a computer<br>
readable medium. The computer readable medium is any data storage device that can<br>
store data which can thereafter be read by a computer system. Examples of the<br>
computer readable medium include read-only memory, random-access memory, CD-<br>
ROMs, magnetic tape, and optical data storage devices.<br>
The apparatus (e.g. Mobile Node, Home Agent, or VPN headend) of this<br>
invention may be specially constructed for the required purposes, or may be a general<br>
purpose programmable machine selectively activated or reconfigured by a computer<br>
program stored in memory. The processes presented herein are not inherently related<br>
to any particular router or other apparatus. In a preferred embodiment, any of the<br>
Home Agents of this invention may be specially configured routers such as specially<br>
16<br>
 <br>
configured router models 1700, 1800,2500,2600, 3200, 3600, 4000,4500,4700,<br>
7200, and 7500 available from Cisco Systems, lac. of San Jose, California.<br>
Moreover, in a preferred embodiment, the Home Agent of this invention may be a<br>
specially configured router such as specially configured router model 3200 available<br>
from Cisco Systems, Inc. of San Jose, California. A general structure for some of<br>
these machines will appear from the description given below.<br>
Generally, the route optimization technique of the present invention may be<br>
implemented on software and/or hardware. For example, it can be implemented in an<br>
operating system kernel, in a separate user process, in a library package bound into<br>
network applications, on a specially constructed machine, or on a network interface<br>
card, hi a specific embodiment of this invention, the technique of the present<br>
invention is implemented in software such as an operating system or in an application<br>
running on an operating system.<br>
A software or software/hardware hybrid route optimization system of this<br>
invention is preferably implemented on a general-purpose programmable machine<br>
selectively activated or reconfigured by a computer program stored in memory. Such<br>
programmable machine may be a network device designed to handle network traffic.<br>
Such network devices typically have multiple network interfaces including frame<br>
relay, ISDN, and wireless interfaces, for example. Specific examples of such network<br>
devices include routers and switches. For example, the roaming systems of this<br>
invention may be specially configured routers such as specially configured router<br>
models 350,1100,1200,1400,1600, 2500, 2600, 3200, 3600,4500, 4700, 7200,<br>
7500, and 12000 available from Cisco Systems, Inc. of San Jose, California. A<br>
general architecture for some of these machines will appear from the description<br>
given below. In an alternative embodiment, the route optimization system maybe<br>
implemented on a general-purpose network host machine such as a personal computer<br>
or workstation. Further, the invention may be at least partially implemented on a card<br>
(e.g., an interface card) for a network device or a general-purpose computing device.<br>
Referring now to FIG. 6, a router 1110 suitable for implementing the present<br>
invention includes a master central processing unit (CPU) 1162, interfaces 1168, and<br>
a bus 1115 (e.g., a PCI bus). When acting under the control of appropriate software<br>
or firmware, the CPU 1162 is responsible for such router tasks as routing table<br>
computations and network management. It may also be responsible for updating<br>
mobility binding and visitor tables, etc. It preferably accomplishes all these functions<br>
17<br>
 <br>
under the control of software including an operating system (e.g., the Internetwork<br>
Operating System (IOS®) of Cisco Systems, Lie.) and any appropriate applications<br>
software. CPU 1162 may include one or more processors 1163 such as a processor<br>
from the Motorola family of microprocessors or the MIPS family of microprocessors.<br>
In an alternative embodiment, processor 1163 is specially designed hardware for<br>
controlling the operations of router 1110. In a specific embodiment, a memory 1161<br>
(such as non-volatile RAM and/or ROM) also forms part of CPU 1162. However,<br>
there are many different ways in which memory could be coupled to the system.<br>
The interfaces 1168 are typically provided as interface cards (sometimes<br>
referred to as "line cards"). Generally, they control the sending and receiving of data<br>
packets over the network and sometimes support other peripherals used with the<br>
router 1110. Among the interfaces that may be provided are Ethernet interfaces,<br>
frame relay interfaces, cable interfaces, DSL interfaces, token ring interfaces, and the<br>
like. In addition, various very high-speed interfaces may be provided such as fast<br>
token ring interfaces, wireless interfaces, Ethernet interfaces, Gigabit Ethernet<br>
interfaces, ATM interfaces, HSSI interfaces, POS interfaces, FDDI interfaces and the<br>
like. Generally, these interfaces may include ports appropriate for communication<br>
with the appropriate media. In some cases, they may also include an independent<br>
processor and, in some instances, volatile RAM. The independent processors may<br>
control such communications intensive tasks as packet switching, media control and<br>
management. By providing separate processors for the communications intensive<br>
tasks, these interfaces allow the master microprocessor 1162 to efficiently perform<br>
routing computations, network diagnostics, security functions, etc.<br>
Although the system shown in FIG. 6 is one specific router of the present<br>
invention, it is by no means the only router architecture on which the present<br>
invention can be implemented. For example, an architecture having a single<br>
processor that handles communications as well as routing computations, etc. is often<br>
used. Further, other types of interfaces and media could also be used with the router.<br>
Regardless of network device's configuration, it may employ one or more<br>
memories or memory modules (including memory 1161) configured to store program<br>
instructions for the general-purpose network operations and mechanisms for roaming,<br>
route optimization and routing functions described herein. The program instructions<br>
may control the operation of an operating system and/or one or more applications, for<br>
18<br>
 <br>
example. The memory or memories may also be configured to store tables such as<br>
mobility binding, registration, and association tables, etc.<br>
Because such information and program instructions may be employed to<br>
implement the systems/methods described herein, the present invention relates to<br>
machine-readable media that include program instructions, state information, etc. for<br>
performing various operations described herein. Examples of machine-readable<br>
media include, but are not limited to, magnetic media such as hard disks, floppy disks,<br>
and magnetic tape; optical media such as CD-ROM disks; magneto-optical media<br>
such as floptical disks; and hardware devices that are specially configured to store and<br>
perform program instructions, such as read-only memory devices (ROM) and random<br>
access memory (RAM). The invention may also be embodied in a carrier wave<br>
traveling over an appropriate medium such as airwaves, optical lines, electric lines,<br>
etc. Examples of program instructions include both machine code, such as produced<br>
by a compiler, and files containing higher level code that may be executed by the<br>
computer using an interpreter.<br>
Although the foregoing invention has been described in some detail for<br>
purposes of clarity of understanding, it will be apparent that certain changes and<br>
modifications may be practiced within the scope of the appended claims. For<br>
instance, the disclosed message formats and methods are merely illustrative, and<br>
therefore other messages and methods may be used to establish Mobile VPN<br>
optimization. Moreover, although the example described refers to IPv4, the present<br>
invention may be used with IP addresses that conform to other versions of IP.<br>
Therefore, the described embodiments should be taken as illustrative and not<br>
restrictive, and the invention should not be limited to the details given herein but<br>
should be defined by the following claims and their full scope of equivalents.<br>
19<br>
 <br>
WHAT IS CLAMED IS:<br>
1.	A method of transmitting a data packet between a Correspondent Node and a<br>
Mobile Node supporting Mobile IP, wherein the Mobile Node is a member of a VPN,<br>
comprising:<br>
transmitting a data packet between the Mobile Node and a Home Agent via a<br>
Mobile IP tunnel without transmitting the data packet via a VPN tunnel; and<br>
transmitting the data packet between the Home Agent and a VPN headend via<br>
a VPN tunnel.<br>
2.	In a Mobile Node supporting Mobile IP, wherein the Mobile Node is a<br>
member of a VPN, a method of optimizing Mobile IP communications, comprising:<br>
generating a data packet;<br>
... setting up a Mobile IP tunnel;<br>
setting up a VPN tunnel; and<br>
transmitting the data packet to the Home Agent via only the Mobile IP tunnel.<br>
3.	The method as recited in claim 2, wherein the VPN tunnel is used to transmit<br>
data packets to the Mobile Node.<br>
4.	The method as recited in claim 2, further comprising:<br>
appending a UDP header to the data packet by a VPN client of the Mobile<br>
Node; and<br>
removing the UDP header from the data packet by a Mobile IP client of the<br>
Mobile Node.<br>
5.	The method as recited in claim 2, further comprising:<br>
appending a UDP header to the data packet by a VPN client of the Mobile<br>
Node; and<br>
modifying a destination port of the UDP header by a Mobile IP client of the<br>
Mobile Node to port 434.<br>
20<br>
 <br>
6.	The method as recited in claim 2, further comprising:<br>
sending a registration request indicating at least one of a VPN client of the<br>
Mobile Node does not add a UDP header and the Home Agent needs to remove a<br>
UDP header added by a Mobile IP client of the Mobile Node.<br>
7.	The method as recited in claim 6, further comprising:<br>
appending a UDP header to the data packet by a Mobile IP client of the<br>
Mobile Node, wherein a destination port of the UDP header is port 434.<br>
8.	In a Home Agent supporting Mobile IP, a method of optimizing Mobile IP<br>
communications between a Mobile Node and a Correspondent Node, comprising:<br>
receiving a data packet from a VPN headend via a VPN tunnel;<br>
changing a source address of the data packet from an address of a VPN<br>
headend to an address of the Home Agent;<br>
changing a destination address of the data packet from a home address of the<br>
Mobile Node to a care-of address of the Mobile Node; and<br>
transmitting the data packet to the care-of address of the Mobile Node via a<br>
Mobile IP tunnel, wherein the Mobile Node is a member of a Virtual Private Network.<br>
9.	The method as recited in claim 8, wherein the data packet is not transmitted<br>
from the Home Agent to the Mobile Node via a VPN tunnel.<br>
10.	In a Mobile Node, a method of optimizing Mobile IP communications,<br>
comprising:<br>
receiving a data packet from a Home Agent at a Mobile IP layer of the Mobile<br>
Node via a Mobile IP tunnel;<br>
modifying a source address of the data packet from an address of a Home<br>
Agent to an address of a VPN headend;<br>
modifying a destination address of the data packet from a care-of address of<br>
the Mobile Node to a home address of the Mobile Node; and<br>
forwarding the modified data packet to a VPN client of the Mobile Node such<br>
that the data packet appears as if it originated at the VPN headend.<br>
21<br>
 <br>
11.	The method as recited in claim 10, further comprising:<br>
decrypting the data packet by the VPN client; and<br>
forwarding the decrypted data packet to the Mobile IP layer of the Mobile<br>
Node.<br>
12.	In a Home Agent supporting Mobile IP, a method of optimizing Mobile IP<br>
communications, comprising:<br>
receiving a data packet from a Mobile Node via a Mobile IP tunnel, wherein<br>
the Mobile Node is a member of a Virtual Private Network;<br>
modifying a source IP address of the data packet from the Mobile Node's<br>
care-of address to the Mobile Node's home address;<br>
modifying a destination IP address of the data packet from me address of the<br>
Home Agent to an address of a VPN headend; and<br>
transmitting the data packet to the VPN headend via a VPN tunnel.<br>
13.	The method as recited in claim 12, wherein the data packet is not received via<br>
a VPN tunnel.<br>
14.	The method as recited in claim 12, further comprising:<br>
receiving a registration request indicating at least one of a VPN client of the<br>
Mobile Node does not add a UDP header and the Home Agent needs to remove a<br>
UDP header added by a Mobile IP client of the Mobile Node.<br>
15.	• The method as recited in claim 12, wherein the data packet received includes a<br>
UDP header, the method further comprising:<br>
removing the UDP header from the data packet prior to transmitting the data<br>
packet to the VPN headend.<br>
16.	The method as recited in claim 12, further comprising:<br>
receiving a registration request from the Mobile Node, the registration request<br>
indicating at least one of whether a NAT device is in the path between the Home<br>
Agent and the Mobile Node and whether UDP encapsulation is required.<br>
22<br>
 <br>
17.	The method as recited in claim 16, further comprising:<br>
sending a registration reply to the Mobile Node indicating that the Home<br>
Agent performs UDP encapsulation.<br>
18.	The method as recited in claim 12, further comprising:<br>
receiving a registration request from the Mobile Node, the registration request<br>
indicating that the Mobile Node supports tunneling optimization.<br>
19.	The method as recited in claim 18, further comprising:<br>
sending a registration reply from the Home Agent to the Mobile Node, the<br>
registration reply indicating that the Home Agent also supports tunneling<br>
optimization.<br>
20.	The method as recited in claim 12, wherein the Home Agent and the VPN<br>
headend are implemented in a single device.<br>
21.	The method as recited in claim 12, wherein the Home Agent is aware of an IP<br>
address of the VPN headend.<br>
22.	The method as recited in claim 12, further comprising:<br>
receiving notification of an IP address of the VPN headend from the Mobile<br>
Node.<br>
23.	The method as recited in claim 12, further comprising:<br>
receiving a registration request indicating a source port and destination port<br>
used by a VPN client of the Mobile Node.<br>
24.	The method as recited in claim 23, further comprising:<br>
associating the Mobile Node with its care-of address, the source port and the<br>
destination port.<br>
25.	The method as recited in claim 23, further comprising:<br>
appending a UDP header to the data packet prior to forwarding the data packet<br>
to the VPN headend;<br>
23<br>
 <br>
wherein the data packet received by the Home Agent from the Mobile Node<br>
does not include a UDP header.<br>
26.	The method as recited in claim 25, wherein the UDP header identifies the<br>
source port and destination port specified in the registration request received from the<br>
Mobile Node.<br>
27.	The method as recited in claim 12, further comprising:<br>
wherein modifying the source IP address and modifying the destination IP<br>
address are performed prior to forwarding the data packet to the VPN headend via the<br>
VPN tunnel.<br>
24<br>
<br>
Methods and apparatus for optimizing Mobile VPN communications are disclosed. When a data packet is transmitted between a Mobile Node that is a member of a VPN and a Correspondent Node, the data packet is transmitted between the Mobile<br>
Node and a Home Agent via a Mobile IP tunnel without transmitting the data packet via a VPN tunnel. However, the data packet is<br>
transmitted between the Home Agent and a VPN headend via a VPN tunnel.<br>
</td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/viewdoc.aspx?id=w1RiWeOXuW8/p/n8RQJhWQ==&amp;amp;loc=wDBSZCsAt7zoiVrqcFJsRw==" target="_blank" style="word-wrap:break-word;">http://ipindiaonline.gov.in/patentsearch/GrantedSearch/viewdoc.aspx?id=w1RiWeOXuW8/p/n8RQJhWQ==&amp;amp;loc=wDBSZCsAt7zoiVrqcFJsRw==</a></p>
		<br>
		<div class="pull-left">
			<a href="278084-combination-switch-cover-attachment-structure-of-motorcycle.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="278086-methods-of-controlling-polymer-properties.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>278085</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>5085/KOLNP/2007</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>52/2016</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>16-Dec-2016</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>13-Dec-2016</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>31-Dec-2007</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>CISCO TECHNOLOGY, INC.</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>170 WEST TASMAN DRIVE, SAN JOSE, CALIFORNIA</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>PATEL ALPESH</td>
											<td>4448 NEWMAN PLACE, PLEASANTON, CALIFORNIA 94588</td>
										</tr>
										<tr>
											<td>2</td>
											<td>DOMMETY GOPAL</td>
											<td>371 ELAN VILLAGE LANE, APARTMENT 302, SAN JOSE, CALIFORNIA 95134</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04M 7/00</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/US2006/026810</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2006-07-06</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>11/177454</td>
									<td>2005-07-07</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/278085-methods-and-apparatus-for-optimizing-mobile-vpn-communications by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 04 Apr 2024 23:44:20 GMT -->
</html>
