<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/216413-a-method-of-measuring-time-of-arrival-of-satellite-signals-received-in-a-satellite-positioning-system-sps-receiver by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 10:37:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 216413:A METHOD OF MEASURING TIME OF ARRIVAL OF SATELLITE SIGNALS RECEIVED IN A SATELLITE POSITIONING SYSTEM (SPS) RECEIVER</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">A METHOD OF MEASURING TIME OF ARRIVAL OF SATELLITE SIGNALS RECEIVED IN A SATELLITE POSITIONING SYSTEM (SPS) RECEIVER</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>The present invention relates to the method and apparatus is disclosed for measurement processing of Satellite Positioning System (SPS) signals. A plurality of SPS signals from a corresponding plurality of SPS satellites are received in an SPS receiver. The signal environment corresponding to the location in which the SPS receiver is located is characterized to produce signal environment data. In one exemplary embodiment, an information source, such as a cellular network based database, is searched to retrieve the signal environment data given an approximate location of the GPS receiver. This approximate location may be specified by a location of a cell site which is in cellular radio communication with a cellular communication device which is co-located with the GPS receiver. One or more parameters related to signal characteristics of the satellite signals are defined. Threshold values for the parameters are determined using the signal environment data. Code phases corresponding to times of arrival of respective satellite signals from the plurality of satellites are measured. The data representing measured times of arrival are examined using threshold values for the parameters to produce a set of times of arrival from which a location fix for the GPS receiver is calculated. Other methods and apparatuses for other embodiments of the invention are also described.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>METHOD AND APPARATUS FOR MEASUREMKNTT PROCESSTNG OF SATELLITE Positioning. SYSTEM fSPS^ STGNAT S<br>
CROSS-REFERENCE TO RELATED APPLICATION<br>
This application is a continuation-in-part of co-pending application serial no. 09/109,112. filed July 2, 1998.<br>
FIELD OF THE INVENTION<br>
The present invention relates generally to the field of satellite positioning systems (SPS), such as global positioning system (GPS) receivers  and more particularly to processing of SPS signals.<br>
BACKGROUND OF THE INVENTION<br>
Global Positioning System (GPS) receivers normally determine their position by computing times of arrival of signals transmitted simultaneously from a multiplicity of GPS (or NA VSTAR) satellites. These satellites transmit, as part of their message, both satellite positioning data as well as data on clock timing, so-called "ephemeris" data. The process of searching for and acquiring GPS signals, reading the ephcmeris data for a multiplicity of satellites and computing the location of the reviver from this data is time consuming, often requiring several minutes. In many cases, this lengthy processing time is unacceptable and, furthermore, greatly limits battery life in miniaturized potable applications.<br>
GPS receiving systems have two principal functions. The first is the computation of the pseudoranges to the various GPS satellites, and the second is die computation of the position of the receiver using these pseudoranges and satellite timing and ephemeris data. The pseudoranges are simply the times of arrival of satellite signals measured by a local clock. This definition of pseudorange is sometimes also called code phase. The satellite ephemeris and timing data is extracted torn the GPS signal once it is acquired and tracked. As stated above, collecting this information normally takes a relatively long time {30 seconds to several minutes) and must be accomplished with a good received signal level in order to achieve low error rates.<br>
Most GPS receivers utilize correlation methods to compute pseudoranges. These correlation methods are performed in real time, often with hardware<br><br>
correlators. GPS signals contain high rate repetitive signals called pseudorandom (PN) sequences. The coctes available for civilian applications are called C/A (coarse/acquisition) codes, and have a binary phase-reversal rate, or "chipping" rate, of 1.023 MHz and a repetition period of 1023 chips for a code period of 1 millisecond. The code sequences belong to a family known as Gold codes, and each GPS satellite broadcasts a signal with a unique Gold code.<br>
For a signal received from a given GPS satellite, following a downconversion process to baseband, a correlation receiver multiplies the received signal by a stored replica of the appropriate Gold code contained within its local memory, and then integrates, or low-pass Alters, the product in order to obtain an indication of the presence of the signal. This process is tanned a "correlation" cfjeration. By sequentially adjusting the relative timing of this stored replica relative to the received signal, and observing the conflation output, the receiver can determine the time delay between the received signal and a local clock. The initial determination of the presence of such an output is termed "acquisition." Once acquisition occurs, the process enters the "tracking" phase in which the timing of the local reference is adjusted in small amounts in order to maintain a high correlation output. The correlation output during the tracking rise may be viewed as the GPS signal with the pseudorandom code removed, or. in common terminology, "despread." This signal is narrow band, with a bandwidth commensurate with a 50 bit per second binary phase shift keyed (BPSK) data signal which is superimposed on the GPS wavcfonn.<br>
The correlation acquisition process is very time consuming, especially if received signals are weak. To improve acquisition time, most GPS receivers utilize a multiplicity .of correlators (up to 36 typically) which allows a parallel search for ccarelation peaks.<br>
Conventional GPS receiving equipment is typically designed to receive GPS signals in open spaces since the satellite signals are line-of-sight and can thus be blocked by metal and other materials. Improved GPS receivers provide signal sensitivity that allows tracking GPS satellite signals indoors, or in the presence of weak multipath signals or signals that are pure reflections. The ability to acquire such weak GPS signals, however, typically causes other problems. For example, the simultaneous tracking of strong and weak signals may cause the receiver to lock on to a cross-correlated signal, which is not a tine signal. Instead of finding a<br><br>
weak true peak, a stronger cross-correlated peak may be acquired. Tracking a weak satellite signal does not guarantee \hat it is a direct signal. This weak signal may be a reflected signal or a combination of direct and indirect signals. The combined signals are refrared to as multipaih signals. The path of the reflected signal is typically longer than the path of the direct signal. This i^fference in path length causes the time-of-arrival nwasurement of the reflected signal to be delayed or the corresponding code phase measurement lo contain a positive bias. In general, the magnitude of the bias is proportional to the relative delay between the reflected and direct paths. The possible absence of a direct signal component makes the existing multipaih mitigation techniques (such as a narrow correlator or a strobe correlator) obsolete.<br>
It is therefore desirable lo provide a measurement processing algorithm that optimally utilizes various types of available data to achieve an optimal location solution.<br>
SUMMARY OF THE INVENTION<br>
A method and apparatus for measurement processing of 5PS signals is disclosed. In one embodiment of the present invention, a plurality of GPS signals from a corresponding plurality of GPS satellites are received in a GPS receiver. The signal environment corresponding to the location in which the GPS receiver is located is characterized to produce signal environment data. In one exemplary embodiment, an information source, such as a cellular network based daubase, is searched to retrieve the signal environment data given an approximate location of the GPS receiver. This approximate location may be ^aecified by a location of a cell site which is iri cellular radio communication with a cellular communication device which is co-locaied with the GPS receiver. One or more parameters related to signal characteristics of the satellite signals are <tefined. thre values for the parameters are determined using signal environment data. code phases corresponding to times of arrival respective sateiiite signals from plurality satellites measured. data representing measured tested threshold produce a set which location solution gps receiver is calculated.></tefined.>
In another embodiment of the invention, the signal environment corresponding to the location in which a GPS receiver is located is characterized to<br><br>
produce signal environment data. This signal environment data reflects the manner in which SPS signals are propagated in the location. The signal environment data is used to detennine at least one processing value which is, in turn, used to process data representative of SPS signals received by the GPS receiver.<br>
In one particular embodiment of the invention, a cell based information source (e.g. a celluJar phone network based database) is used to detennine a signal environment data which represents a manner in which SPS signals are propagated in a location at which an SPS receiver is located, and SPS signals by the SPS receiver at this location are processed in a manner specified by the signal environment data-in another embodiment of the invention, a method of processing SPS signals determines the existence of two (or more) correlation peaks from the same set of SPS signals from a first SPS satellite. A measurement representing a time-of-amvai of the set of SPS signals is derived from the two (or more) correlation peaks; typically the earlier correlation peak represents a direct path of the set of SPS signals, rather than a reflected path, and the earlier correlation peak is used to derive the measurement representing the time-of-arrival of the set of SPS signals. Other features and embodiments of the present invention will be apparent from the accompanying drawings and from the detailed description which follows.<br>
BRTT-F DRSrRTPTTON OF THE DRAWINnS<br>
The present invention is illustrated by way of example and not by way of limitation in the figures of the accompanying drawings in which references indicate similar elements and in which:<br>
Figure 1 is a block diagram of one example of a GPS receiving system utilizing embodiments of the present invention, and shows data links that may exist between a baseslation and a remote GPS receiver.<br>
Figure 2 is a table that illustrates an example of data elements with exemplary values for seven different in-view satellites, that may be used in an embodiment of the present invention.<br>
Figure 3 is a graphical representation of amplitudes of fifteen correlator outputs with 1/2-chip delays in the vicinity of a punctual channel for a satellite illustrated in Figure 2.<br><br>
Figure 4 is a flowchart which outlines the major operations performed by GPS recei ver 20, or other types of GFS receivers, or a combination of a mobile GPS receiver and a data processing system such as a server computer system, in processing received satellite signals to produce a location fix, according to a measurement processing method of an embodiment of the present invention.<br>
Figure 5 is a flowchart that outlines operations included in the signal environment characterization process illustrated in Figure 4, according to one embodiment of the present invention.<br>
Figure 6 is a flowchart that outlines operatJOTis included in the algorithm controlling parameter setup process illustrated in Figure 4, according to one embodiment of the present invention.<br>
Figure 7 is a flowchart that outlines operations included in the measurement selection and computation process illustrated in Figure 4, according to one embodiment of the present invention.<br>
Hgure 8 is a flowchart that outlines operations included in the fault detection and isolation process illustrated in Figure 4, according to one embodiment of the present invention.<br>
Figure 9 is a flowchart that outlines operations included in the bias adjustment process illustrated in Figure 4, according to one embodiment of the present invention.<br>
Figure 10 is a flowchart that outlines operations included in the sequential measurement optimization process illustrated in Figure 4, according to one embodiment of the present invention.<br>
Figure 11 is a flowchart that outlines operations included in a computation and error estimation process illustrated in Figure 4, according to one embodiment of the present invention.<br>
Figure 12A is an example of a cellular network system which includes a cell based infonnation source.<br>
Figure 12B is an example of an SPS server according to one embodiment of the invention.<br>
PFTAn,Fnr&gt;RsrRTPnoN<br>
A method and apparatus for measurement processing Satellite Positioning System (SPS) signals is described.<br><br>
In the following discussion, embodiments of the present invention will be described witt» reference to application in the United Stales GicA)aI Positioning System (GPS) system, which is an example of an SPS system. It should be evident, however, that these methods are equally applicable to other satellite positioning systems, such as the Russian GJonass system. Thus, the term "GPS" used herein includes such alternative satellite positioning systems, including the Russian Glonass system. Likewise, the term "GPS signals" includes signals from alternative satellite positioning systems.<br>
Furthemiore, although embodiments of the present invention arc described with reference to GPS satellites, it will be appreciated that the teachings are equally applicable to positioning systems which utilize pseudolites or a combination of satellites and pseudolites. Pseudolites are ground based transmitters which broadcast a PN code (similar to a GPS signal) modulated on an L-band (or other frequency) carrier signal, generally synchronized witii GPS time. Each transmitter may be assigned a unique PN code so as to permit i<tentification by a remote receiver. pseudolites are useful in situations where gps signals from an orbiting satellite might be unavailable such as tunnels mines buildings urban canyons or other enclosed areas. the term used herein is intended to include equivalents of and tenn inclucte gps-like pseudolites.></tentification>
GPS Receiving Svstem<br>
Figure 1 is a block diagram of a GPS receiving system which may be used to implement methods of the present invention. The GPS receiving system of Figure 1 includes i mobile or remote GPS receiver unit 20 which includes a GPS processing stage and a communication stage. Thus, GPS receiver unit 20 includes circuitry for performing the functions required for processing GPS signals, as well as the functions required for processing communication signals transmitted and received through a communication link. The communication link, such as data link 16, is typically a radio frequency conmiunication link (e.g. a cellular telephone communication link) to another communication component, such as a basestation 10 having a communication antenna 14.<br><br>
In accordance with traditional GPS methods, GPS receiver 20 receives GPS signals transmitted from orbiting GPS satellites and determines the times-of-anival of unique pseudo-random noise (FN) codes by comparing the time shifts between the received PN code signal sequences and internally generated PN signal sequences. GPS signals are received through GPS antenna 40 and input to an acquisition circuit which acquires the PN codes for the various received satellites. The navigational data (e.g., pseudorange data) produced by the acquisition circuit are processed by a processor for transmission over data communication link 16.<br>
GPS receiver 20 also includes communication transceiver section, shown as modem 22, for communication over data link 16. Modem 22 is coupled to communication antenna 24. Modem 24 transmits navigational data processed by GPS receiver 20 through communication signals (typically radio frequency signals) to a remote basestation, such as basestation 10. The navigational data may be the actual latitude, longitude, and altitude of the GPS receiver, or it may be raw or partially processed data. Received communication signals are input to modem 22 and passed to a processor for processing and possible output through an audio speaker.<br>
According to one embodiment of the present invention pseudorange data generated by GPS receiver 20 is transmitted over data link 16 to basestation 10. Basestation 10 then detennines the location of GPS receiver 20 based on the pseudorange data from the combined receiver, the time at which the pseudoranges were measured, and ephemeris data received from its own GPS receiver (e.g., through GPS antenna 12) or other sources of such data, such as a network of GPS reference receivers. The location data can then be transmitted back to GPS receiver 20 or to other remote locations. The data link 16 between GPS receiver 20 and basestation 10 may be implemented in a number of various embodiments including a direct link or a cellular telephone link, or any other type of wireless<br>
link.<br>
In one embodiment of the present invention, basestation 10 commands the GPS receiver 20 to perform a location measurement through a message transmitted over data link 16. Within this message, basestation 10 also sends Doppler related information (or other information, such as Satellite Almanac, from which Doppler may be (terived) for the satellites in view. Doppler related information may also include Doppler rate of change, Doppler acceleration or other mathematical<br><br>
repnesentmions of the Doppler related infonnation. The Doppler information is a form of satellite d^a information related to the satellite position and velocity and is typically in the form of frequency information. The message will typically also specify an identification of the particular satellites in view, or other initialization data. The message is received by modem 22, and is stored in a menKjry 30 coupled to microprocessor 26. Microprocessor 26 handles data information transfer between the remote unit processing elements 32-48 and the modem 22.<br>
The Doppler information included in the message is typically very short in duration since the required accuracy of such Doj^ler information is not high. For example, if 10 Hz accuracy were required and the maximum Doppler is approximately ± 7 kHz, then an 11 -bit word would suffice for each satellite in view. Additional bits would be required to transmit Doppler rate of change information. If eight satellites were in view, then 88 bits would be required to specify all such Dopplers. The use of this information eliminates the requirement for remote 20 to search for such Dopplers, thereby reducing its processing time by in excess of a factor of ten. "Die use of the Doppler infonnation also allows the GPS receiver 20 to more quickly process a sample of GPS signals such as a collection of digidzed GPS signals stored in a digital memory.<br>
When the GPS receiver 20 receives a command (e.g., from basestation 10) to process GPS signals through a message which includes Doppler information, microprocessor 26 activates the RF to IF Converter 42, analog to digital (A/D) Convener 44 and digital snapshot memory 46 via a battery and power regul^or and power s&gt;vitch circuit 36 (and controlled power lines 21a, 21b. 21c and 21d), thereby providing full power to These component. This causes the signals from the GPS satellites which are received via antenna 40 to be downconverted from a radio frequency (RF) to an intermediate frequency (IF), where they subsequently undergo digitization in A/D converter 44. A contiguous set of such data, typically corresponding to a duration of 100 milliseconds to one second (or even longer), is then stored in snapshot memory 46. The addressing of this memory 46 to store this data is controlled by a Field Programmable Gate Array (FPGA) integrated cireuit 48. Downconversion of the GPS signals is accomplished using a frequency synthesizer 38 which provides local oscillator signal 39 to the convener 42 as discussed in further detail below.<br><br>
During the period of time in which the snapshot memory 46 is being filled with the digitized GPS signals from the in-vtew satellites, DSP microprocessor 32 may be kept in a low power state. The RF to IF Converter 42 and A/D Converter 44 are typically only turned on for a shon period of time, sufficient to collect and store the data required for pseudorangc calculation. After the data collection is complete, these converter circuits are turned off or power is otherwise reduced via controlled power lines 21b and 21c (while the memory 46 continues to receive full power), thus not contributing to additional power dissipation during the actual pseudorangc calculation. The pseudorangc calculation is then performed using, in one embodiment of the present invention, a general purpose, programmable Digital Signal Processor (DSP) IC 32. DSP 32 is placed in an active power state by the microprocessor 26 and the circuit 36 via controlled power line 21e prior to performing such caicuiations.<br>
In one embodiment, DSP 32 is a general purpose and programmable processor, as opposed to a specialized custom digital signal processor, as is used in other GPS units. Once DSP 32 completes its computation of pseudoranges for each of the in-view satellites, it may compute its final position using satellite ephemeris data supplied to it via a data link or gathered through standard demodulation techniques. Alternatively, it may transmit the pseudoranges to a basestation (e.g., basestation 10), which provides a final position computation. Figure 12A shows an example of a basestation which in this case is referred to as an SPS server. The SPS server is communicatively linked to the SPS receiver/cell phone through a cellular telephone network and a public switched telephone network (PSTN).<br>
In one embodiment of the invention, DSP 32 transmits this position information to the microprocessor 26 via interconnect bus 33. At this time the microprocessor 26 may cause the DSP 32 and memory 46 to again enter a low power state by sending an appropriate control signal to the battery and power regulator circuit 36. Microprocessor 26 then uses modem 22 to transmit the pseudorangc data, or position data over data link 16 to basestation 10 for final position computation or for output on a display device (not shown).<br>
It is expected that the position caicuiations in DSP 32 will typically require less than a few seconds of time, depending upon the amount of data stored in the digital snapshot memory 46 and the speed of the DSP.<br><br>
As indicated above, digital snapshot memory 46 captures a record corresponding to a relatively long period of time. The efficient processing of this large block of data using fast convolution methods contributes to the ability of the present invention to process signals at low received levels (e.g., when reception is poor due to partial blockage from buildings, trees, etc.). Examples of such methods are described in U.S. Patent No. 5,663,734. All pseudoranges for visible GPS satellites are computed using this same buffered data. This provides improved performance relative to continuous tracking GPS receivers in situations (such as urban blockage conditions) in which the signal amplitude is rapidly changing.<br>
Different GPS receiver architectures may be used with the present invention. While the foregoing discussion has focused on a GPS receiver with a digital memory and a digital signal processor, other GPS receiver architectures may perform all or portions of the methods of the invention and may form all or portions of the apparatuses of the invention. For example, conventional hardware correlator style GPS receivers may be used with the invention. Also, the types of GPS receivers described in PCT applications PCT/US98/0747I or PCT/US98/11375 or PCTAJS 97/06946 (Publication No. 97/40398) may be used with the present invention. In each case, the correlator outputs for each SPS satellite (e.g. Figure 3) are saved for use in the measurement processing techniques of the invention.<br>
In each case, the receiver itself may perform the entire processing of one of these measurement processing techniques or may perform a portion of the processing of the technique and may forward the intermediate processing results to a "server" system, such as an SPS server as shown in Figure 12A, which server system completes the jaocessing. In the case where the GPS receiver (e.g. mobile unit 20) performs all of the processing for one of these techniques, the GPS receiver may receive aiding data from an external source through its communication link such as a cellular telephone system; this aiding data, such as a characterization of the signal environment (and associated parameter values) may be transmitted to the mobile unit 20. In the case where the GPS receiver performs some of the processing, the GPS receiver will typically store samples of the correlator outputs for each SPS satellite (such as the data shown in Figure 3).<br><br>
and these correlator outputs are transmitted to the server system which perfomis a measurement processing technique of the invention.<br>
Measurement Processing<br>
In one embodiment of the present invention, an improved GPS receiver processes several different types of data for each in-view satellite. These data types may include: a code phase corresponding to the maximum conelation peak value also referred to as main peak (measuring time-of-arrival); a set of code phases around the maximum correJation peak value (computed at, for example, 1/8,1/4,1/2,1 C/A code chip or at some other arbitrary spacing); a correlation peak-width (computed at some selected signal level, e.g., 3 dB below peak); a Doppler (measuring code phase rate of change); a signal-to-noise ratio (SNR); a signal-to-interference ratio (SIR); an integration period; and a flag indicating presence of multiple peaks and their location(s) relaive to the main peak.<br>
In a typical embodiment of the invention, a signal environment is characterized by using these data types which are measured for SPS signals (e.g. an SNR of an SPS signal), and this represents a manner in which SPS signals are propagated locally (e.g. not in the ionosphere) in the location of the SPS receiver. In a typical example, a locally propagated SPS signal is an SPS signal which is propagated within about 1000 meters of the location of the SPS receiver. That is, the SPS signals which are propagated within about 1000 meters of the location may be considered to be locally propagated SPS signals; this distance may be considered a range from about 0.1 meters from the SPS receiver to about 1000 (to perhaps 3000) meters from the SPS receiver. In another embodiment, a signal environment may be characterized by using these data types which are n»casured for cellular communication signals (e.g. an SNR of a received cellular telephone communication signal). For example, one or more of these data types may be deiemiined for received cellular commimication signals or one or nrore of these data types may be derived from the power level (e.g. a higher power level suggests lower SNR) of the cellular transmitter in the cellular telephone. The signal environment characterized by measiirements of cellular communication signals will typically also represent the manner in which SPS signals are propagated locally in the location of the SPS receiver. It is also noted that<br><br>
processing of cellular communication signals may utilize a characterization of the signal environment.<br>
Figure 2 is a table that illustrates an example of some of the data elements with exemplary values for seven different in-view satellites, that may be used in an embodiment of the present invention. The satellites are numbered in accordance with their corresponding PRN codes as 2, 4, 7, 9, 15, 26. and 27. Data for each satellite includes signal-to-noise ratio, signal-to-imerference ratio, peak-width, azimuth, elevation, code phase and Doppler information.<br>
Figure 3 illustrates an example of scaled amplitudes of fifteen correlator outputs measured with 1/2-chip delays in the vicinity of a punctual channel. The waveform of Figure 3 corresponds to the data values for sateliite number 27 ^own in the table of Figure 2. Figure 3 illustrates an example of "twin-peak" behavior, evidenced by a presence of two strong signals. Figure 3 also demonstrates the presence of two more weak signals, one at a time corresponding to 3 half-chips relative delay and the other at 11 half-chips relative delay. Both of these signals may be tested forthetime-of-arnvalofa direct signal. Atypical case of twin-peak behavior from the same SPS satellite signal occurs when an SPS receiver receives both a reflected signal and a direct signal from the same SPS satellite signal, and both signals are relatively strong and above the signal detection level. Normally, the direct signal produces an earlier correlation peak {e.g. time = about 6, y = about 4500 as shown in Figure 3) and the reflected signal produces a later correlation peak (e.g. time =* about 8.5, y « about 6500 as shown in Figure 3). In certain circumstances (e.g. an SPS satellite which is low along the horizon), the reflected signal may be a stronger signal than the direct signal; Figure 3 shows this example.<br>
Another type of interference, referred to as cross-correlation, can also exist and can occur when a strong SPS satellite signal interferes with the processing of a weaker signal; examples of methods for mitigating this interference is described in co-pending U.S. Patent Application Serial No. 09/109.112 filed July 2, 1998.<br>
Figure 4 is a flowchart which outlines the major operations perfonned by GPS receiver 20 in processing received satellite signals to produce a position information according to a measurement processing method of an embodiment of the present invention. The measurement processing method illustrated in Rgure 4 includes seven main processes. In operation 101, the signal environment of the<br><br>
GPS receiver location is characterized Empirical data indicates that signal characteristics, such as various measures of signal strengths, pseudorange and multipath errors, vary significantly from one environment (e.g. an urban canyon) to another (e.g. indoors). This is largely due to the fact that the material, height and spatial distribution of buildings in different urban environments influence ihe paths that the satellite signals traverse on the way to GPS receiver"s antenna. The signal environment data represents a manner in which SPS signals are propagated to an SPS antenna at the particular location.<br>
Characterizing the cellular site with which GPS receiver 20 is communicating in terms of its signal environment can aid in the algorithm selection for measurement processing. This inforrnadon may be available as part of the wll object information. In addition to the cell signal classification, the cell object information may also contain the cell service area, cell site identification, cell site location and estimated altitude. The classes of signal envircHunents can be defmed as "open sky", "rural", "urban", "urban canyon", and so on. The "urban canyon" may be sub-classified by the actual city or metropolitan area, such as "urban canyon of Tokyo" or "urban canyon of San Francisco" to further accurately define the environment. For example, "uiban canyon of Minneapolis" implies flat terrain, whereas "urban canyon of San Francisco" indicates hilly terrain with possible significant variations in altitudes.<br>
In a typical embodiment of the invention, a characterization of the signal environment is performed each time an SPS receiver is operated in a location without reference to prior analysis of a signal environment for the same location. However, it is possible to use a prior analysis of the location"s signal environment, and tlus prior analysis may be considered a set-up step. The signal environment of a location, such as the location of a cell site or a typical location of a cellular telephone in the cell area serviced by the cell site, may be characterized in a set-up step (as a prior analysis) by taking several measurements at the locjuion (or several "representative" locations in the area covered by the cell site). Since satellites move around, the empirical data may be valid only at specific times. The above measurements can be repeated at different tinws of day or around peak usage time. These measurements are analyzed empirically to deteimine the typical signal surnglhs and typical peak-widths (e.g. SNR Out and/or SIR Out, and/or peak-width as shown in Fieure 2), interference patterns and presence of<br><br>
muJtipath errors. Since the location (or representative locations) is (are) known when performing the set-up characterization, the comslation outputs fnDm the satellite signals may be compared to tiie expected correlation omputs, and this comparison will show the magnitude of reflections (e.g. a reflected signal) and the presence of twin-peaks in the signal environment. In another example, the RMS (root mean squared) difference of the correlation ouqnits and nominal values may be analyzed for multipath errors. Also, actual knowledge that most or all of a cell site"s coverage is urban or rural may be included in the signal envinDnment data. Once the characterization is completed, the data characterizing the signal environment may be stored in a database (e.g. a cell based database) in which the location (e.g. a cell site identifier or other identifiers of the location of the cell) is associated in the database with this data characterizing the signal environment. Figure 12A shows an example of this dat^ase which may be maintained at an SPS server. In the operation of one embodiment of the invention, a mobile cellular telephone/GPS receiver (e.g. receiver 901b) provides pseudoranges and correlation outputs (used for measurement processing) which are transmitted to the cell site (e.g. cell site 90Ia). The cell site then forwards this data to an SPS server (e.g. server 912) which, in turn, determines the signal environment (e.g. by receiving an identifier of the cell site in a cellular radio communication and looking in the database (e.g. database 9I2a) for the signal environment data associated with the location of the cell site). The data representing the signal environment is then used to process, according lo various embo(timents of Uie invention, *e pseudoranges and correlation outputs received from the mobile cellular telephone/GPS receiver (e.g. receiver 90ib). This data for the signal environment may be supplemented by dynamically obtained signal environment measurements which are made in actual use of the system after these set-up characterizations. However, the set-up characterizations may provide aiding information; for example, in certain cells of a cellular telephone network, most of the ceil will be urban or rural, and this information may be forwarded to tiw mobile SPS receiver and used at the mobile SPS receiver as part of the signal environment classification.<br>
In one embodiment of the present invention, the environment classification obtained in operation 101 is used to aid in the algorithm controlling parameter selection of operation 103. The controlling parameters set-up in operation 103<br><br>
typically include masks for signal-to-noise ratio, signai-to-interference ratio, peak-width. HDOP, satellite elevation, and other such parameters. These controlling parameters are used in the measurement selection and computation process, operation 105. Based on the parameter mask values, measurement selection is performed. As part of operation 105, some measurement computation is also performed. For example, input signal-to-noise ratio is estimated from the measured (output) signal-to-noise ratio, measurement integration period (defined in terms of number of prc-detection integrations and post-detection integrations), and Doppler enor.<br>
Based on the parameter selection of operation 103, some measurements may be identifjed as potential cross-correlations. In operation 105, a test is performed to determine if the receiver generated code phase measurement is a cross-correlation peak rather than a true signal.<br>
Measurements that successfully pass operation 105 are then used by a fault detection and isolation (FDI) process of operation 107. The fault detection and isolation process serves to isolate (i.e., ictentify) any errant satellites so that they may be corrected or removed from the solution. The prerequisite for fault detection and isolation is an ovcrdeiermined solution where the number of measurements exceeds the number of unknowns.<br>
If there is an error (bias) in the pseudorange measurement, a bias adjustment process is performed, opwration 109. In one embodiment, the bias adjustment process first performs bias estimation and then bias adjustment This step may also include correction of pseudorange measurement with the bias estimate.<br>
In operation-111, a sequential measurement optimization (SMO) process is used to improve a selected error statistic. The enw statistic that is used may be influenced by the signal environment characterization of operation 101. The sequential measurement optimization process analyzes a subset of solutions one measurement at a time, and selects the solution that has the best error statistic. For example, if there are n measurements and only one error, the sequential measurement optimization process may consider the n subset solutions obtained by omitting (de-weighting) one satellite at a time from the initial set. Instead of satellite removal, in an alternative embodiment of the present invention, satellite measurements are adjusted by an error estimaie computed in operation 109. In this<br><br>
manner, Uie sequential measurement optimization process analyzes all possible subsets to achieve the best solution. In yet another embodiment, the bias adjustment may be performed as part of a sequential measurement optimization process.<br>
Position and velocity are computed in operation 113. In addition, the error statistics such as unit variance, estimated horizontal error, vifeighted HDOP, error ellipse and its orientation are also computed.<br>
A detailed description of individual operations within each of the main processes of Figure 4 will be provided in the sections that follow.<br>
Sipnal Environment Characterization<br>
Figure S is a flowchart that outlines the operations included in the signal environment characterization process illustrated as operation 101 in Figure 4, according to one embodiment of the present invention. Identifying or ascertaining the signal environment of the GPS receiver is important for attaining maximum flexibility for different applications and supporting various performance levels.<br>
In operation 201, the signal environment is classified as "indoor" or "outdoor". In one embodiment of the present invention, this information is provided to the GPS receiver through user input. In an alternative embodiment, this information may be derived from available GPS-based measurements. For example, the distribution of signal-to-noise ratio and/or signal attenuation and the satellite linenDf-sight information (azimuth and elevation angles) may indicate an indoor environment as opposed to an outdoor environment Signal attenuation is computed as the difference between the measured input signal level and the expected input signal level. The expected signal level is the signal level that is received for an unobstructed direct satellite signal for a given combination of elevation and azimuth angles. The expected input signal level is determined as a function of Doppler error and total integration period. A GPS receiver"s antenna gain pattern may be used to adjust the expected signal level.<br>
For example, the signal environment may be identified as "indoors" if the signals for all satellites in-view are attenuated by a specified threshold level. The presence of short multipatii errors (
 <br>
from satellites which are lower in the sky, the signal environment may also be identified as "indoors." The presence of peak-width deviation, generally in the form of wider peaks, on all or a majority of satellites is also indicative of an indoor environment Under certain signal conditions, such as ouiof-phase signal combinations, the resulting peak widths may be narrowed as a result of multipath signal presence.<br>
In an alternative embodiment of the present invention, signal levels from cellular outbound transmission, such as from basestadon to handset, are used to aid the signal environment detennination. In a manner similar to that described above for the GPS satellite signals, signal attenuation measures of the cellular or wireless radio signals may be used to aid the detennJnMion if the combined GPS receiver such as GPS receiver 20 is being used inside or outside.<br>
In operation 202, it is determined whether the signal environment is "outdoors." If the signal is deiennined lo be indoors, the processing proceeds to operation 207, thereby skipping operations 203-205. Optionally, the processing may skip operations 203-209 because it is not likely that an indoor environment will have a dynamic chaiKteristic (although if it does, this suggests that the characterization as indoor may be erroneous and signal environment may be re¬characterized as "outdoors"). If the environment is outdoor, the environment is further sub-classified as either "open sky", "rural", "urban" or "urban canyon" in operation 203. In one embodiment of the present invention, these sub-classifications are detennined by funher analyzing the signal attenuation and pseudorange error characteristics of the GPS signals. For example, if the GPS sensor is able to acquire and track signals fi-om all satellites in-view and these signals exhibit direct signal behavior with little or no multipath. then the environment is declared as an "open sky" signal environment.<br>
For operation 203, the combination of the signal attenuation/signal blockage information is used to determine the type of "urban" environment. For example, in the urban environment where the buildings are assumed 20 meters apart, a 30" satellite visibility mask is equivalent to being surrounded by 6-meter tall buildings. Satellite visibility mask information is derived from either total signal blockage or signal attenuation of a specified level. For instance, the signal environment with direct signals received exclusively above 60" elevation mask may be declared as an "urban canyon" signal environment. A typical urban signal<br><br>
environment is where the satellites are masked by buildings in one direction but with better visibility present in the perpendicular direction. Pseudorange measurements with large multipath errors (&gt;I0O m) are also indicative of urban canyon environments. In many cases, the presence of multiple peaks or deviations in peak shapes is also indicative of urban canyon environments.<br>
In operation 204. it is deteiroined whether the outdoor signal environment is urban orurbancanyon, instead of open or rural. If the outdoor signal is classified as an "urban" or "urban canyon" environment, the environment is further classified by identifying it by its metropolitan area or city name, operation 205. For example, an urban canyon environment may be specified as either an "urban canyon of Chicago" or an "urban canyon of San Francisco". As stated previously, the actual city environment may have a significant impact on the reception of GPS signals depending on the topography of the city or the nature and type of the buildings surrounding the GPS receiver.<br>
In one embodiment of the present invention, this infcnmation is derived from the cell object information. In another embodiment, this information is provided by the user input. Alternatively, it may be derived from the initial GPS position solution. An initial fix, unaided by specific urban canyon information, is typically accurate enough to serve as a database lookup for urban canyon identification. In an alternative embodiment, initial position infOTmation may be derived in conjunction with other location methods, such as terrestrial radiolocation using wireless signals as ranging measurements. Computer models for saieiiite line-of-sight and signal strength expectations may be avail^le and/or developed for specific urban canyon environments. Parameters modeled may include distribution of building heights, street widths, street intersections, sateHite visibility and masking due to surrounding building, possible reflections and corresponding multipath errors. The models may be self-ieaniing, such as through the use of artificial intelligence, to inctaporate data made available with every location fix. Stanc^d models rrmy be employed first to facilitate the analysis. An example of such model may be an urban mottel where, within a five mile radius, 60% of all buildings are 20-story buildings and the average street width is about 60 feet. In the area between 5 and 20 miles from the center, 20% of all buildings are 8-story buildings and the average street width is SO feet. In the area between 20 and 40 miles from tiie center, 35% of all buildings are single-<br><br>
story buildings and the average street width is about 100 feet. The urban model may improve with every position fix by getting updated and refined with corresponding GPS-based information.<br>
In operation 207 the user dynamics of the GPS receiver is identified. Typical portable GPS receivers, such as the combined GPS receiver illustrated in Hgure 1 may be used in mobile (dynamic) applications or stationary (static) applications. In one embodiment of the present invention, identification of the user dynamics is accomplished by user provided input. In another embodiment, this information may be derived from the initial GPS-based velocity solution. In yet another embodiment, user dynamics may be derived by alternative radiolocation methods. Alternatively, the user dynamic information is detennined by relying on previous solution information or by using the urban canyon model and the particular application to set the expected levels. For example, in Automatic Vehicle Location applications, the standard urban model may include the expected average vehicle speeds such as 20 mph within a 5-mile radius, 35 mph within a 20-mile radius and 50 mph within a 40-mile radius. This nxxlel may be updated with every velocity solution. It also may be aided by the database of maximtun allowable speeds for a particular street of a particular city.<br>
In operation 209 the "dynamic" environment is further sub-classified as either "low," "medium" or "high" dynamic environment. The sub-classification of the dynamic environment provides speed of a^ivel informauon to the GPS receiver. In one embodiment of the present invention, the dynamic sub-classification inform^ion of operation 207 is provided by user input to the GPS receiver. In an alternative embodiment, this information is determined on previous solution information (such as velocity and acceleration), or by using the urban canyon model and the particular application to set the expected levels. In vehicle tracking applications, for instance, additional sensor (such as speedometer and gyroscope) inputs may be used to provide initial velocity estimates or velocity and/or heading information for further integration with GPS data.<br>
Algorithm Controlling Parameter Setup<br>
Figure 6 is a flowchart that outlines the operations included in the algorithm controlling parameter setup process illustrated as operation 103 in Figure 4, according to one embodiment of the present invention. An initial<br><br>
selection of signal thresholds is performed in operation 301. In one embodiment, this initial selection is based on the signal environment determination of operation 101, as illustrated in the flowchart of Figure 5. The signal thresholds selected in operation 301 include minimum signal-to-noise (SNR) and signal-to-inlerference (SIR) ratios. For example, if the urban canyon of San Francisco is used as an illustrative signal environment, the minimum signal-to-noise and signal-io-inlerfcrencc ratios are set to 15.5 and 14.5 dB respectively. These thresholds are used in the satellite measurement selection of operation 105.<br>
In operation 303. peak-width parameters are set. These parameters are used in the satellite selection and a cross-correlation check performed during the measurement selection and computation process of operation 105. In one embodiment of the present invention, peak-widths for all satellites are computed at a selected signal-lo-noise or signal-to-interference ratio level. For example, peak-widths may be computed at a signal level which is 3 dB below the signal level of the punctual correlator. The correlator function illustrated in Figure 3 demonstrates the punctual correlator output located at a sample with a relative time delay of eight half-chips. The peak-width for this particular correlator peak is computed to be 1.02 half-chips. In general, the peak-width, the peak-width deviation, and the shape of the correlator function are indicative of the multipath present in the signal. For example, the wider the peak, the larger the multipath error. Therefore, the peak-width mask may be used in the satellite measurement selection of operation 105. in addition, die shape of the correlator function may indicate the presence of multiple signals. For example, the correlator function of Figure 3 demonstrates the presence of two earlier signals. Also, an inclination pwini at a sample with a relative time delay of 5 half-chips may indicate the presence of one more signal. In most cases, cross-correlated signals exhibit wider peaks. Tliis allows peak-width measurements to be used in the identification of potential cross-correlated signals during the measurement selection and computation process (operation 105 in Figure 4).<br>
In operation 305. a "strong" satellite is defined. A "strong" satellite is a characteristic of a satellite measurement that is least likely lo be affected by multipath errors. In one embodiment of the present invention, the parameters thai are used in "stit&gt;ng" satellite identification are satellite elevation, peak-width deviation, signal-to-noise ratio, signal-to-interference ratio, signal attenuation and<br><br>
input signal strength. For the urban canyon of San Francisco example, the eJevation mask may be set at 20° and the signal input strength set to -135 dB. Alternatively, for a different city environment, such as the urban canyon of San Jose, the signal input strength may be set to -130 dB.<br>
A satellite elevation mask, unrelated to the "strong" satellite definition, is also set in operation 305. This mask may be used in the satellite selection step of the measurement selection and computation process. In the "open sky" signal environment this elevation mask may be set to a low value, such as 5", since only small multipalh errors are expected. However, in the "urban canyon" environment the elevation mask may be raised to as much as i5"to avoid processing satellites that are potentially affected by large multipath errors.<br>
The flow of a state machine that executes the fault detection and isolation (FDI), bias adjustment (BA) and sequential measurement optimization (SMO) algorithms may be controlled by the parameters that are set in operation 307. For example, depending on the signal environment characterization and the probability of missed cross-conelation ctetection, the order in which fault detection and isolation, bias adjustment, and sequential measurement optimization calculations take place may be modified. For instance, in the "open-sky" environment where the probability of missed cross-correlation is low, bias adjustment may not be performed at all or performed before fault detection and isolation. In another example, altitude aiding measurements may be included or excluded from the fauli detection and isolation, bias adjustment, and sequential measurement optimization algorithms. An error estimate associated with altitude aiding measurement may be set based on the signal environment characterization of operation lOl. For instance, for an "iridoor" environment, altitude aiding may be disabled or the altitude error may be set to a lai^ value (like 50m) to indicate lack of confidence in the source of altitude infonnation which in one embodiment could be a terrain elevation database. In another example, a "strong" satellite as defined by conu-olling parameters may differ between FDI, Bias Adjustment and SMO algorithms.<br>
Measurement Selection and Computation<br>
Figure 7 is a flowchart that outlines the operations included in the measurement selection and computation process illustrated as operation 105 in<br><br>
Figure 4, according to one embodiment of the present invention. The measurement selection and computation process serves to pre-filter location fix measurements and to compute parameters required for further GPS signal processing using a measurement processing method of the invention.<br>
In operation 401, the low elevation satellites are removed from funher measurement processing. The elevation masks may be set according to the signal environmeni characterization process illustrated m Figure 5 and controlling parameter set-up illustrated in Figure 6. In operation 403, an estimated input signal strength is computed based on the measured output signal-to-noise ratio, measurement integration period, and Doppler error. The input signal su-ength is then used to calculate the peak-width deviation and signal attenuation. Peak-width cteviation is computed as the dinerence between the measured peak-width and the expected peak-width for a satellite signal with a given input signal strength. Depending on the signal environment characterization, the signal-to-noise ratio mask or signal-to-inleiference ratio mask or esdmaled signal input strength or a combination of the tiiree masks is used in operation 405 to remove weak signals from further measurement processing. In one embodiment, the signal thresholds are set as described with relation to operation 301 in the algorithm controlling parameter setup process of Rgure 6.<br>
Cross-conelated signals are detected and removed in operation 407. Cross-correlated signals generally exhibit wider peaks and high noise-to-interference ratio (NIR). Cross-correlations take place in high-dynamic signal environment when a strong satellite signal cross-correlaies witii a weak satellite signal. In gcneraJ, both "indoor" and "urban canyon" environments tend to produce a significant number of cross-correlated signals. The SNRs, SIRs, and the estimated input signal strengths for strong and weak satellite couples may be examined (and typically are examined) for significant signal separation. In one exemplary embodiment involving an urban canyon situation in San Francisco, an 18 dB difference is searched for. Cross-correlations are then verified by examining the relative code phases and Dopplers of the strong and weak satellite couples.<br>
Under certain receiving conditions, the correlation peak wavefonn may exhibit a twin-peak signal with two dominating peaks. The wavefonn of Figure 3 illustrates such a twin-peak signal. A twin-peak signal is a special case of<br><br>
multiple peak signal which is the result of a combination of multiple signals incident simultaneously on a GPS antenna. In operation 409, the correlation peak function, such as the waveform of Figure 3, is analyzed for presence of twin-peaks. For example, the signal corresponding to the nxaximum correlation peak of Figure 3, was received about J microsecond later than an earlier signal. Since, the reflected signal always travels a longer path than the direct signal, the main peak corresponds to a reflected signal and the earlier peak corresponds to the direct signal. In this example, a correction may be applied to the pseudorange (code phase) measurement to account for the presence of the multipath signal. Typically, this correction selects the earlier peak as the correct correlation output for this signal from an SPS satellite. In the case where a mobile SPS receiver performs some measurement processing techniques of the invention (e.g. identification of the existence of twin-peaks) and an SPS server performs other measurement processing techniques (e.g. f^I), the mobile receiver may transmit an indication that twin-peaks exist for a particular satellite. In another example, it may also transmit the relative locations of all identified peaks in the correlation peak function with respect to the prompt correlator (e.g. sample 8 in Figure 3). In yet another example, the nwbile receiver may transmit a set of samples of the correlation peak function. This data may be used by a bias adjustment algorithm and/or an SMO algorithm to process potential time-of-anival candidates in order to correct pseudorange measurements as described in operations 601 and 703. In operation 411, if a wide-peak is detected and it does not belong to a twin-peak, this signal is either corrected or removed from further measurement processing.<br>
Based on the signal environment, a weighting scheme is selected in operation 413. Weights represent a priori error uncertainties in pseudorange measurements. For instance, a weight of 0.1 corresponds to an error estimate of 10 meters. Weights may be derived from a variety of parameters including signal-to-noise ratio, signal-to-interference ratio, noise-to-interference ratio, input signal strength, signal attenuation, elevation angle, measurement integration period, peak-width, peak-width deviation, and so on. A weight for a particular satellite measurement may be adjusted if a twin-peak was detected for tiiat satellite signal. A weight may also be adjusted if the measurement is not differentially corrected or the correction is too old (e.g.. a correction age greater than 30 seconds) to account for the presence of a Selective Availability error. Error estimates may be improved<br><br>
by incorporating signal environment measurements made available through a system set-up characierization, which may be performed as part of signal environment charactenzation in operation 101. Weighting may also be impnsved if additional infonnation is available. For instance, in an "urban canyon" environment an error estimate may be further improved by an external source of reflection information available from the continually updated urban computer model, such as the relative location of surrounding buildings.<br>
In an outdoor signal environment, altitude aiding may be used to improve the accuracy of measurement processing algorithm in operation 415. Altitude aiding improves the geometry of the solution and provides an extra measurement necessary for the under-determined case. If an estimated altitude is available (e.g. an" average altitude for a cell site), this may be used as an altitude aiding parameter. Altitude aiding will also improve as the vertical terrain niodel improves. The fault detection and isolation, bias adjustment and sequential measurement optimization algorithms may also benefit from accural altitude aiding.<br>
In an indoor signal environment, attitude aiding may be applied if it is required to produce a fix as opposed to a no fix condition. In this case, the weighting reflects the uncertainty in the altitude measurement. A weight is defined as an inverse of a measurement error estimate. The altitude uncertainty may be derived from the urban computer model. For example, if the indoors environment is a 20-meter building, a weight of 0.1 may be used. Altitude aiding may be applied iteratively, where tfie initial fix with a large altitude uncertainty or no altitude aiding at all, may be used as a look-up in the urban computer model to derive the building height information and the corresponding altitude uncertainty. Alternatively, an external source may provide information (i.e., 10th floor) that may be used to correa the altitude derived from a terrain elevation database. In operation 417, clock aiding may be applied. Clock uncertainty may be derived from a clock model based on the quality of the internal oscillator used in the GPS receiver or the quality of the external timing signal such as the one in the CDMA network used to set the time in the GPS receiver. A clock model may be updated in real-time by clock bias and clock drift estimates derived from GPS pseudorange and Dopplcr measurements. If network provided timing information is very accurate (e.g. accurate to within about 1 microsecond), such information may also<br><br>
aid a measurement processing method of the present invention by providing an extra degree of freedom.<br>
Fault Detection and Isolation Algorithm<br>
Figure 8 is a flowchart that outlines the operations included in the fault detection and isolation (FDI) process illustrated as operation 107 in Figure 4. acconiing to one embodiment of the present invention.<br>
In one embodiment of the present invention, the fault detection and isolation process is performed as pan of a Receiver Autonomous Integrity Monitoring (RAIM) function within the GPS receiver. In another embodiment of the invention, the fault detection and isolation process is performed at an SPS server using the position information received from the GPS receiver. A variety of RAIM schemes have been proposed, and all are based on some type of self-consistency check among the available measurements. Some of the better known error detection methods are range comparison, least-squares-residuals, and parity, among others (see R. Grover Brown, "Global Positioning System: Theory and Applications", Volume II, Chapter 5). In one embodiment of the present invention, the fault detection and isolation process is an extension of a failure detection problem, where the integrity system may also attempt to isolate the errant satellite measurement so that it can be removed from the navigation solution.<br>
In operation 501, fault detection and isolation takes place. In one embodiment of the present invention a parity me^od is used. (See Mark Sturza, "Navigation System Integrity Monitoring Using Redundant Measurement", Navigation). As part of fault detection and isolation, an F-test is performed to ascertain reliability of the isolation. Depending on the signal environmwit and isolation reliability, if a "strong" satellite is isolated as an errant satellite, control may be passed to bias adjustment and sequential measurement processing algorithms without any further fault detection and isolation processing. Also, if the fault detection and isolation process is altitude aided, again based on attitude aiding parameters, and if the altitude measurement is isolated, control may be passed to the bias adjustment and sequential measurement processing algorithms without any further pnxessing by the fault detection and isolation process. For example, if a solution computation takes place under "open sky" conditions with a good altitude estimate (i.e., uncertainty is small), and altitude measurement is<br><br>
isolated as an errant measurement, further fault detection and isolation processing may be stopped and the control may be passed to the bias adjustment and sequential measurement processing algorithms.<br>
Otherwise, in operation 503, bias estimation in the isolated measurement is performed. In one embodiment of the present invention, using a well-known mathematical relationship between a priori and a posteriori residuals of a leasl-squares solution, a hypothesis is made that only the isolated measurement is affected by a bias of unknown magnitude and the rest of the measurements are perfect. The bias is then solved for in a least-squares fashion. In one embodiment of the present invention, if the bias magnitude exceeds a pre-selected threshold, then the isolated measurement is declared as a missed cross-correlation and de-weighted appropriately.<br>
Based on the signal environment and number of degrees of freedom, the isolated measurement may be bias adjusted or de-weighted. Number of degrees of freedom is defined as the diff^erence between total number of measurements and the number of unknown parameiers being solved for. Depending on the weighting factor, de-weighting may be considered equivalent to measurement removal from the solution. In operation 505, the measurement is bias adjusted. In this manner, the measurement is corrected by the bias estimated in operation 503. In one embodiment of this invention, the measurement is bias adjusted only if bias is positive.<br>
In operation 507, a new weight for the adjusted measurement is computed. The new weight may be based on the signal environment, isolation reliability, bias magnitude, presence of multiple peaks in the satellite measurement, and other such factors.<br>
A new solution and corresponding error estimates are calculated in operation 509. In operation 511 it is determined whether any of a pre-defined set of break-out conditions are triggered. In one embodiment of the present invention, the break-out conditions include HDOP exceeding the HDOP mask, the estimated horizontal error exceeding a pre-selected threshold, the unit variance falling below a pre-selected threshold or exceeding a second pre-selected threshold, a change in the solution before and after isolation being below the pre-selected threshold or exceeding a second pre-selected threshold, fault isolation failing a reliability test, number of degrees of freedom being be\ow a pre-seiecled threshold, and other<br><br>
such factors. If, in operation 511 it is determined that none of the break-out conditions are triggered, the entire fault detection and isolation pixjcess is repeated again from operation 501. Otherwise, the fault detection and isolation process ends.<br>
Bias Adjustment Algorithm<br>
Figure 9 is a flowchart that outlines the operations included in the bias adjustment process illustrated as operation 109 in Figure 4. according to one embodiznent of the present invention.<br>
In one embodiment of the present invention, the bias adjustment algorithm illustrated in Figure 9 is similar to the bias estimation process described in reference to operation 503 of Figure 8. In the bias adjustment process of Figure 9, however, bias estimation is performed for any one or any sub-set of cuirently received signals and not just for the detected and isolated errant measurements. In certain instances, the selected sub-set may be the entire set of measurements. In one embodiment of the present invention, the set may exclude cross-correlated signals, may exclude the "strong" satellites, and may also exclude "twin-peak" measurements. It should be noted that the definition of a "strong" satellite in the context of the bias adjustment |»ocess may be different from the definition of a "strong" satellite used in the context of fault detection and isolation algorithm. In another embodiment, the set may exclude any or all measurements that were pre-fiiiered out as pan of measurement selection and compulation in operation 105 of Figure 4.<br>
In operation 601, bias errors are estimated for the selected set of satellites. Depending on the signal environment and altitude aiding parameters, bias estimation may include or exclude altitude measurement. In operation 603. the largest positive bias estimate is selected. In one embodiment of this invention, the bias in the altitude measurement if altitude aiding is used may be excluded from this selection. In another embodiment of this invention, the location of any of the multiple peaks in the correlation function may be selected as a bias estimate. In one example, an earliest tdentifi^le peak is selected. In another example, any of the inclination points in the correlation function may be selected as a bias estimate. The selected measurement is then corrected by the bias estimate, operation 605.<br><br>
In operation 607, the weight of the correcied measurement is adjusted to account for bias correction. A new wei^t may be b^ed on the signal environment, bias magnitude, magnitude of the corrected pseudorange residual, algorithm controlling parameters, SNR, SIR, signal input strength at die correlation function sample corresponding to the bias estimate and so on. A new solution and corresponding error estimates arc calculated in operation 609.<br>
In operation 611 itisdetermined whether any of a pre-defined set of break¬out conditions are triggered. In one embodiment of the present invention, the break-out conditions include unit variance scaled estimated horizontal error exceeding a pre-selected threshold, tiie unit variance falling below a prc-selected threshold or exceeding a second pre-selected tiireshold, a change in the solution before and after bias adjustment being below a pe-selected threshold or exceeding a second pre-selected ti\reshold, number of degrees of freedom being below a pre¬selected threshold, and other such factors. If in operation 611 it is determined that none of the break-out conditions are triggered, the bias adjustment process is repeated from operation 601, otherwise the bias adjustment process ends.<br>
Sequential Measurement Optimization Algorithm<br>
Figure 10 is a flowchart that outlines the operations included in the sequential measurement optimization (SMO) process illustrated as operation H1 in Figure 4. according to one embodiment of the present invention.<br>
In one embodiment of the present invention, the sequential measurement optimization process is executed only if certain conditions, referred to as "initiation conditions" are met. In operation 701, initiation conditions of the sequential measurement optimization process are checked. Initiation conditions include failure of the fault detection and isolation reliability test, or isolation of a "strong" satellite or altitude measurement by the fault detection and isolation algorithm. The sequential measurement optimization process may also be initiated if an error statistic such as an estimated horizontal error exceeded a selected threshold, where the threshold selected may be based on signal environment characterization. The initial conditions may also include any of the break-out conditions of the fault detection and isolation and/or bias adjustment.<br>
In an alternative embodiment of the present invention, one of the controlling parameters set in operation 307 of the algorithm controlling parameter<br><br>
setup process may be configured to force the sequential measurement optimization algorithm to always execute, instead of executing only upon occurrence of an initiation condition.<br>
In operation 703, a bias is estimated for each of the selected satellites. In one embodiment, a selected set of satellite measurements may excluck satellites that have already been removed from a solution by prior measurement processing steps, such as through the measurement selection and computation process, the fault detection and isolation process or the bias adjustment process. The set may also exclude "strong" satellites. Again, the definition of a "strong" satellite in the context of sequential measurement optimization may be different from the definition of "strong" satellite used in the context of fault detection and isolation or bras adjustment In an alternate embodiment, the set may include all satellites.<br>
The selected satellite measurement is processed in operation 705. according to the selected method. The selected method may be a bias adjustment technique, a weight adjustment technique, a time adjustment technique, a multipath mitigation technique, or some other nieasurement optimization technique. The bias adjustment technique may use the bias estimate computed in operation 703 to correct the selected measurement and adjust the weight correspondingly to account for correction. A weight adjustment technique may de-weight the satellite measurement reducing the measurement impact on the overall solution. A time adjustment technique niay adjust the satellite measurement in either direction (delaying or advancing time-of-anival) to improve the solution. In an aliematt embodiment, only advancing time-of-arrival (e.g. decrementing the time-of-arrival) may be performed as part of the time adjustment technique. A multipath mitigation technique-may use the signal computer model to estimate the multipah error at a particular location and use this information in weighting the satellite measurement. In an alternate embodiment, the correlation waveforms (correlation functions) are analyzed for inflection points which signify the deviation from an ideal peak shape and may represent points where multiple signals are combined. In yet another embodiment, the correlation waveforms are analyzed for multiple peaks as possible times of arrival.<br>
In operation 707, a new solution and corresponding error statistics are re¬computed. In operation 709, a measurement that optimizes the error statistic is identified. In certain circumstances, optimizing may correspond to minimizing the<br><br>
error statistic. For example, a chosen error statistic may be a weighted rooi-sum-squared a posteriori residuals. The error statistic selection may be based on signal environment characterization or an "urban canyon" computer model, or a prior information relative to a success of a particular approach in the particular signal environment Other error statistics that may be used are un-weighted root-sum-squared a posteriori residuals, weighted root-sum-squared a priori residuals, estimated horizontal error, unit variance, unit variance scaled by HDOP, among others.<br>
In operation 711 it is determined whether there are any degrees of free available for further sequential measurement optimization. If there are any degrees of freedom still available, the sequential measurement optimization is repeated from operation 601, otherwise the sequential measurement optimization process ends. In one embodiment of the present invention, the sequential measurement optimization process may be stopped if a resultant HDOP exceeds a pre-selected HDOP mask, or if a resultant weighted HDOP exceeds a pre-selected weighted HDOP mask, if a selected raror statistic falls below a pre-selected threshold level, or if a current sequential nuasurement optimization iteration did not result in an improvement of the selected error statistic. Any of the break-out conditions of the FDI and/or Bias Adjustment process may be used to stop the SMO process.<br>
Final Solution and Error Estimate Computation<br>
Figure 11 is a flowchart that outlines the operations included in the final computation and error estimation process illusu^tedas operation 113 in Figure 4, according to one embodiment of the present invention.<br>
In operation 801, final solution and error estimates are computed. In one embodiment of the present invention, a solution may include at least one of position, velocity and timing information. A test may also be performed to validate the solution. In one embodiment, the test is based on the environment type, such as an "urban canyon" city model. In an alternative embodiment, in vehicle u^cking applications, a solution is checked for on-street location by comparing a solution"s position to its location on a digital map or other CIS (geographical information system) resource. The test checks if selected error statistics exceed pre-selected thresholds. The test may also compare this solution to the previous solution or a series of previous solutions.<br><br>
In operation 803, an error ellipse is computed. The magnitude of the semi-major and semi-minor axes and the orientation of the error ellipse may be analyzed with respect to the environment type. For example, in the "urban canyon" environment under severe multipath conditions, the orientation of the enur ellipse should generally be perpendicular to the direction of the street. In other words, the semi-minor axis should coincide with the direction of the street.<br>
In operation 805, the signal environment computer model is updated with the location solution information. Also, the terrain elevation database may be updated with altitude solution for outdoor signal environment.<br>
The various methods of the present invention may be performed in part by a mobile SPS receiver and in remaining part by a remotely located SPS server. An fexampie of a system which operates in this way is shown in Figure 12A, and an example of an SPS server is shown in Figure 22B.<br>
The system 900 of Figure 12A includes, for purposes of explanation only, four cells 901, 902. 903. and 904 serviced respectively by cellular basestations. henceforth referred to as cell sites 901a, 902a, 903a, and 904a. Each cell site provides two-way cellular radio ccmimunication with cell phones in the vicinity of the cell site in the well-loiown manner of cellular telephone communications. A typical cell phone may also include a mobile SPS receiver such as the receiver 901b. Figure 1 shows a specific example of a mobile unit 20 which may be constructed to implement the integrated mobile SPS receiver and cell phone 90lb. The cellular telephone in the mobile unit 90Ib provides radio communication to and from the cell site. This radio communication may include voice data as well as SPS aiding data or SPS position information outputs as described previously. For example, signal environment data may be provided to the cell phone which can then be used by the SPS receiver in order to perform the measurement processing techniques of the present invention. This data may be obtained from a cell based database, such as the database 912a maintained by the SPS server 912, and this signal environment data may then be used by the SPS receiver in the unit 901b to perform measurement pirxessing techniques of the invention within the SPS receiver. Typically, the SPS receiver will receive SPS signals and determine correlation outputs from these signals for each satellite. Some of the measurement processing techniques of the present invention may then be performed within the SPS receiver and the remainder performed by an SPS<br><br>
server, such as the servers 914 or 912. Each mobile unit is in communication with the server through a cell site and a mobile switching center, such as mobile switching centers 906 and 907 which in turn communicate to the servers through the public switched telephone network 908 as shown in Figure 12A. Thus, pseudoranges and correlation outputs and other measurement processing outputs generated in the mobile SPS system 901b may be forwarded to an SPS server through the cell site 90la and the mobile switching center 907 and the PSTN (public switched ttlephone network) 908 to the particular server, such as the SPS server 912. This SPS server then performs the remainder of measurement processing techniques according to the present invention in order to detennine final pseudoranges to the various satellites in view. The position calculation is also performed using satellite ephemeris data received from a wide area reference network (WARN) 915. The determination of ttie final position by the SPS server may then allow the server to provide this final position information to another system, such as an application system 910, which in one embodiment may be a public safety answering point (PSAP). Further examples of systems which may be utilized with the present invention are described in co-pending U.S. pMent application entitled "Distributed Satellite Position System Processing and Application NetwOTk" by inventors Norman F. Krasner, Mark Moeglein, and David Coleman, filed on April 28, 1998, as Serial No. 09/067,406. Examples of a wide area reference network are described in co-pending U.S. patent application entitled "Satellite Positioning Reference System and Method" by inventors Mark Moeglein, Leonid Sheynblat, and Norman F. Krasner, which was filed April 28, 1998 as Serial No. 09/067.407. In addition to signal environment data which may be stored in the cell based databases 9I2a or 914a, these databases may store averse altitudes and may also store satellite related information, such as estimated Dopplers for satellites in view of the various cell sites. Examples of cell based databases of this type are described in co-pending U.S, application entitled "An Improved GPS Receiver Utilizing a Communication Link" which was filed on April 15, 1997 by Norman F. Krasner as Serial No. 08/842,559.<br>
It should be noted that a cellular based communication system is a communication system which has more than one transmitter, each of which serves a different geographical area, which is predefined at any instant in time. Typically, each transmitter is a wireless transmitter (e.g. a cell site) which serves a cell which<br><br>
has a geographical radius of less than 20 miles, although the area covered depends on the particular cellular system. There are numermis types of cellular communication systtms, such as cellular telephones, PCS (personal communication system), SMR (specialized mobile radio), one-way and two-way pager systems, RAM, ARDIS, and wireless packet data systems. Typically the predefined different geographical areas are referred to as cells and a number of cells are grouped together into a cellular service area, and these number of cells are coupled to one or more cellular switching centers which provide connections to land based telephone systems and/or networks. Service areas are often used for billing purposes. Hence, it may be the case that cells in more than one service area are connected to one switching center. Alternatively, it is sometimes the case that cells within one service area are connected to different switching centers, especially in dense population areas. In general, a service area is defined as a collection of cells within close geographical proximity to one another. Another class of cellular systems that fits the above description is satellite based, wherein the cellular baseslations are satellites that typically orbit the earth. In these systems, the cell sectors and service areas move as a function of time. Examples of such systems include the Iridium, Globalstar, Orbcomm and Odyssey systems.<br>
Figure 12B shows an example of an SPS server according to one embodiment of the present invention. TTiis server includes a data processing unit 951 which is coupled to a modem or other interface 953 and is also coupled to a modem or other interface 952 and is coupled to another modem or interface 954. In addition, a mass storage unit 955 is coupled to the data processing unit 951. An optional GPS receiver 956 may also be coupled to the data processing unit 951. The mass storage 955 includes executable computer programs for peifomiing the processing operations of the present invention and also include storage for a cell based information source such as the cell based database 9l2a which associates a location within a cell site to a particular signal environment data as described herein. Each modem or other interface provides an interface between the data processing unit 951 and the various components of the system 9(X) shown in Figure 12A. For example, the modem or other interface 953 provides a connection from the cellular switching centers, such as mobile switching center 907 and the unit 951 in the case where the SPS server is directly coupled to a mobile switching center. As shown in Figure 12A, the link between the mobile<br><br>
switching center is through the public switched telephone network and thus the interface 953 couples the servers 912 and 914 to the public switched telephone nerwork. In yet another embodiment, each cell site may include a server system and thus the interface 953 couples the data processing unit 951 directly to a cell site, such as cell site 90la. Interface 952 couples the unit 951 to other systems, such as the application system 910 shown in Figure 12A. The interface 954 couples the unit 951 to a GPS signal source such as the WARN 915 shown in Figure 12A.<br>
In the foregoing, a system has been described for measurement processing of navigational data in a SPS system such as a GPS receiver. Although the present invention has been described with reference to specific exemplary embodiments, it will be evident that various mddifications and changes may be made to these embodiments without departing from the broader spirit and scope of the invention as set forth in the claims. AcccMilingly, the specification and drawings are to be regarded in an illustrative rather than restrictive sense.<br><br><br>
WE CLAIM :<br>
1.	The method of measuring times of arrival of satellite signals received in a<br>
Satellite Positioning System (SPS) receiver said method comprising:<br>
receiving a plurality of SPS signals from a plurality of SPS satellites; characterizing a signal environment corresponding to the location in which said SPS receiver is located, to produce environment data which represents a marker in which SPS signals are propagated locally to said location;<br>
measuring times of arrival of respective satellite signals from two or more satellites of said plurality of satellites; and<br>
processing data representing said times of arrival using said environment data to produce a set of times of arrival with which to calculate a location fix for said SPS receiver.<br>
2.	The method as claimed in claim 1 wherein said environment data comprises at least one of a signal-to-noise ratio, a signal-to-interference ratio, an input signal strength, a signal attenuation, a correlation function waveform, and a peak-width value of a si^al of said plurality of signals.<br>
3.	The method as claimed in claim 1 wherein SPS signals are propagated locally to said location when said SPS signals are within about 1000 meters of said location.<br>
4.	The method as claimed in claim 3 wherein said characterizing comprises determining whether said signal environment resembles an indoor environment or an outdoor environment.<br>
5.	The method as claimed in claim 3 comprising:<br>
identify one or more errant SPS signals;<br>
correcting time-of-arrival measurements performed by said SPS receiver as a result of identifying one or more errant SPS signals.<br><br>
6.	The method as claimed in claim 3 wherein said SPS receiver is included within a combination receiver and radio communication device, said combination receiver comprising a digital processor configured to process said data representing said times of arrival using said environment data.<br>
7.	The method as claimed in claim 6 wherein said radio communication device is a cellular communication system which processes a cellular communication signal and wherein said characterizing comprises determming a signal parameter of said cellular communication signal.<br>
8.	The method as claimed in claim 3 wherein said set of times of arrival are transmitted to a basestation over a communication link.<br>
9.	The method as claimed in claim 3,comprising:<br>
determining a first possible correlation peak for a first set of SPS signals from a first SPS satellite;<br>
determining a second possible correlation peak for said fast set of SPS signals;<br>
transmitting from said SPS receiver which received said fusty set of SPS signals an identification that said first and said second possible correlation peaks have been determined.<br>
10.	The method as claimed in claim 3 wherein a time-of-arrival measurement of said set of tunes of arrival is corrected with a bias adjustment based on said signal environment.<br>
11.	The method of determining a position of a Satellite Positioning System (SPS) receiver, said method comprising:<br>
receiving an SPS signal from an SPS satellite;<br><br>
determining at least a selected one of a peak-width value of a correlation output of said SPS signal or a signal-to interference ratio (SIR) of said SPS signal;<br>
determining said position of said SPS receiver using said selected one of said peak width value or said SIR.<br>
12.	The method as claimed in claim 11 comprising:<br>
identifying one or more errant SPS signals;<br>
correcting time-of-arrival measurements performed by said SPS receiver as a result of identifying one or more errant SPS signals.<br>
13.	The method as claimed in claim 11 wherein a time-of-arrival measurement is corrected with a bias adjustment based on one of said peak width value or said SIR.<br>
14.	The method of measuring times of arrival of satellite signals received in a Satellite Positioning System (SPS) receiver, said method comprising:<br>
receiving a plurality of SPS signals from a plurality of SPS satellites;<br>
characterizing a signal environment corresponding to the location in which said SPS receiver is located, to produce environment data;<br>
selecting threshold values for one or more parameters related to one or more characteristics of said satellite signals using said environment data;<br>
measuring times of arrival of respective satellite signals from two or more satellites of said plurality of satellites, to produce a plurality of measured times of arrival; and<br>
testing data representing said times of arrival using said threshold values for said one or more parameters to produce a set of times of arrival with which to calculate a location fix for said SPS receiver.<br>
15.	The method as claimed in claim 14 wherein one or more characteristics of said<br>
environment data comprises at least one of a signal-to-noise ratio, a signal-to-<br><br>
interference ratio, an input signal strength, a signal attenuation, a correlation function waveform,  and a  peak-width value  of a  signal of said plurality of signals.<br>
16.	The method as claimed in claim 15 wherein said characterizing said signal environment further comprises characterizing said signal environment as an indoor environment if said SPS receiver receives said plurality of SPS signals while located inside a building, or as an outdoor environment if said SPS receiver receives said plurality of SPS signals while not located inside a building.<br>
17.	The method as claimed in claim 16 wherein said characterizing said signal environment further comprises characterizing said signal environment as an urban environment if said SPS receiver receives said plurality of SPS signals while located in an area with a pre-defined number of buildings, or as a rural environment if said SPS receiver receives said plurality of SPS signals while located in an area with fewer than said pre-defined number of buildings.<br>
18.	The method as claimed in claim 15 comprising:<br>
identifying one or more errant SPS signals; and<br>
correcting time-of-arrival measurements performed by said SPS receiver as a result of identifying one or more errant SPS signals.<br>
19.	The method as claimed in claim 18 comprising:<br>
estimating a bias error in one or more measured times of arrival of said plurality of measured times of arrival, to produce an estimated bias value; and<br>
conecting said plurality of measured times of arrival using said estimated bias value.<br>
20.	The method as claimed in claim 19 comprising:<br>
defining an error threshold for each measured time-of-arrival using said<br><br>
environment date;<br>
comparing an error in said each measured time-of-arrival with said error threshold; and<br>
removing a time-of-arrival measurement if said error in said time-of-arrival measurement exceeds said error threshold.<br>
21.	The method as claimed in claim 16 wherein said SPS receiver is included within a combination receiver and radio communication device, said combination receiver comprising a digital processor configured to execute said measuring said times of anival of said satellite signals.<br>
22.	The method as claimed in claim 14 wherein said characterizing said signal environment comprises determining at least one of a signal-to-noise ratio, a signal-to-interference ratio, an input signal strength, a signal attenuation, a correlation fimction waveform, and a peak-width value of at least one signal of said plurality of SPS signals.<br>
23.	The method as claimed in claim 21 wherein said radio communication device comprises a cellular telephone, and wherein said location of said SPS receiver is within a cellular telephone transmission region,<br>
24.	The method as claimed in claim 14 wherein said characterizing said signal environment comprises determining at least one of a signal-to-noise ratio, a signal-to-interference ratio, a signal strength, or a peak width value of a cellular communication signal which is received by a cellular .communication system, wherein said SPS receiver and said cellular communication system are coupled together and are part of a combined system.<br><br>
25.	The method of processing satellite positioning system signals received by a<br>
satellite    positioning    system    (SPS)    receiver,     said    method    comprising;<br>
receiving a plurality of SPS signals from a plurality of in-view SPS satellites;<br>
determining an integration period for each of said plurality of SPS signals, said integration period conesponding to a period of time used to perform a time-of-arrival measurement for each corresponding SPS signal;<br>
determining a maximum correlation peak value and a correlation peak-width for each signal of said plurality of SPS signals;<br>
determining a code phase corresponding to each said maximum correlation peak value;<br>
determming a Doppler value for each of said plurality of SPS signals; and<br>
determining one or more signal characteristics associated with each of said plurality of SPS signals.<br>
26.	The method as claimed in claim 25 comprising:<br>
determining a set of code phases around said maximum correlation peak value for said each of said plurality of SPS signals; and<br>
setting a flag for each signal of said plurality of SPS signals for which there exist multiple peaks occurring within said integration period.<br>
27.	The method as claimed in claim 25 wherein said one or more signal characteristics associated with each of said plurality of SPS signals comprises at least one of a signal-to-noise ratio, a peak-width value, an input signal strength value, a signal attenuation, a correlation function waveform, and a signal-to-interference ratio.<br>
28.	The method as claimed in claim 27 comprising characterizmg a signal environment corresponding to the location in which said SPS receiver is located to produce environment data.<br><br>
29.	The method as claimed in claim 28 comprising: calculating a position based at least in part on said environment data.<br>
30.	The method as claimed in claim 28 comprising measuring a time-of-arrival of a SPS signal using said environment data and a corresponding maximum correlation peak value, Doppler value, code phase, and signal characteristics determined for said satellite.<br>
31.	The method as claimed in claim 30 comprising:<br>
correcting a time-of-arrival measurement for SPS signals not satisfying a predetermined error threshold criteria.<br>
32.	The method as claimed in claim 31 wherein said predetermined error threshold criteria comprises multiple peak values caused by multipath signals transmitted by one or more satellites of said plurality of satellites.<br>
33.	The method as claimed in claim 30 comprising eliminating time-of-arrival measurements for SPS signals transmitted by satellites not meeting pre-determined threshold criteria.<br>
34.	The method as claimed in claim 30 comprising eliminating time-of-arrival measurements for SPS signals not meeting pre-determined error threshold criteria.<br>
35.	The method as claimed in claim 34 wherein said pre-determined error threshold criteria comprises cross-correlation signals transmitted by one or more satellite of said plurality of satellites.<br>
36.	The method as claimed in claim 25 wherein said set of code phases includes an entire code frame for each of said plurality of SPS signals.<br><br>
37.	ASPS receiver apparatus comprising:<br>
an antenna for receiving SPS signals at an RF frequency from a plurality of inview satellites;<br>
a downconverter coupled to said antenna, said downconverter reducing the RF frequency of said received SPS signals to an intermediate frequency (IF) to produce a baseband signal;<br>
a digitizer coupled to said downconverter;<br>
a processor coupled to said digitizer, wherein said processor is configured to:<br>
determine a signal environment corresponding to the location in which said SPS receiver is located, to produce environment data;<br>
select threshold values for one or more parameters related to one or more characteristics of said satellite signals using said envb-onment data;<br>
measure times of arrival of respective satellite signals from two or more satellites of said plurality of in-view satellites, to produce a plurality of measured times of arrival; and<br>
test data representing said times of arrival using said threshold values for said one or more parameters to produce a set of times of arrival with which to calculate a location fix for said SPS receiver.<br>
38.	The SPS receiver apparatus as claimed in claim 37 comprising a communication antenna and a communication receiver coupled to said communication antenna and to said processor, said communication receiver operable to receive a data signal containing satellite data information over a communication link.<br>
39.	The SPS receiver apparatus as claimed in claim 38 wherein said set of times of arrival are transmitted to a basestation over said communication link.<br>
40.	The SPS receiver apparatus as claimed in claim 39 wherein said characteristics of said satellite signals are transmitted to said basestation over said communication<br><br>
link and said characteristics are used to derive said environment data.<br>
41.	The SPS receiver apparatus as claimed in claim 39 wherein said communication link comprises a cellular telephone transmission link.<br>
42.	The SPS receiver apparatus as claimed in claim 41 wherein said environment data specifies whether said SPS receiver is located indoors or outdoors, and whether said SPS receiver is located in an urban or rural location.<br>
43.	The SPS receiver apparatus as claimed in claim 42 wherein said environment data is input to said SPS receiver by a user.<br>
44.	The SPS receiver apparatus as claimed in claim 42 wherein said environment data is determmed by analyzing data transmitted by said communication link.<br>
45.	The method of processing satellite positioning system (SPS) signals, said method comprising:<br>
determining a first possible correlation peak for a first set of SPS signals from a first SPS satellite;<br>
determining a second possible correlation peak for said first set of SPS signals wherein said second possible correlation peak follows said first possible correlation peak in time;<br>
deriving a measurement representing a time-of-arrival of said first set of SPS signals from one of said first possible correlation peak and said second possible correlation peak;<br>
transmitting from an SPS received which received said first set of SPS signals an identification that said first possible correlation peak and said second possible correlation peak have been determined.<br><br>
46.	The method as clahned in claim 45 comprising:<br>
receiving at a remote processing system said measurement representing said time-of-arrival and receiving said identification, said remote processing system being coupled communicatively to said SPS receiver through a cellular radio frequency network.<br>
47.	The method of processing satellite positioning system (SPS) signals, said<br>
method comprising:<br>
determining a first possible correlation peak for a first set of SPS signals from a first SPS satellite;<br>
determining a second possible correlation peak for said fu"st set of SPS signals wherein said second possible correlation peak follows said first possible correlation peak in time;<br>
deriving a measurement representing a time-of-arrival of said first set of SPS signals from one of said first possible correlation peak and said second possible correlation peak;<br>
identifying a wide peak correlation output and discarding said wide peak correlation output from measurements used to determine a position information for an SPS receiver which received said first set of SPS signals.<br>
48.	The method of processing satellite positioning system (SPS) signals, said<br>
method comprising:<br>
determining a signal environment data which represents a manner in which SPS signals are propagated in a location at which an SPS receiver is located, wherein said signal environment data comprises data representing at least one of multipath conditions or interference conditions for SPS signals near said location;<br>
determining how data representing SPS signals received by said SPS receiver is processed based on said signal environment data;<br><br>
transmitting measurements representing time-of-arrivals of SPS signals at said SPS receiver;<br>
receiving at a remote processing system said measurements representing time-of-arrivais through a cellular radio frequency communication link;<br>
processing at said remote processing system said measurements representing time-of-arrivals to determine a position solution for said SPS receiver.<br>
49.	The method of processing satellite positioning system (SPS) signals, said<br>
method comprismg:<br>
determming a first possible correlation peak for a first set of SPS signals;<br>
determming a second possible conelation peak for said first set of SPS signals;<br>
deriving a measurement representing a time-of-arrival of said first set of SPS signals fi^om one of said first possible correlation peak and said second possible correlation peak;<br>
transmitting from an SPS receiver which received said first set of SPS signals an identification that said first possible correlation peak and said second possible correlation peak have been determined.<br>
50.	The method as claimed in claim 49 wherein said second possible correlation peak follows said first possible correlation peak in time.<br>
51.	The method as claimed in claim 50 wherein said second possible correlafion peak results from a reflected SPS signal.<br>
52.	The method as claimed in claim 51 wherein said measurement representing said time-of-arrival is derived from said first possible correlation peak.<br>
53.	The method as claimed in claim 49 comprising:<br>
identifying a wide peak correlation output and discarding said wide peak<br><br>
correlation output from measurements used to determine a position information for said SPS receiver which received said first set of SPS signals.<br>
54.	The method as claimed in claim 49 comprising:<br>
receiving at a remote processing system said measurement representing said time-of arrival and receiving said identification, said re mote processing system being coupled communicatively to said SPS receiver through a cellular radio frequency<br>
network.<br>
55.	The method of processing satellite positioning system (SPS) signals, said<br>
method comprising:<br>
determining from a cell based information source a signal environment which represents a manner in which SPS signals are propagated in a location at which an SPS receiver is located;<br>
determining how data representing SPS signals received by said SPS receiver is processed based on said signal environment;<br>
determining measurements representing time-of-arrivals of SPS signals, said measurements based on said signal environment;<br>
transmitting said measurements representing time-of-arrivals of SPS signals at said SPS receiver;<br>
receiving at a remote processing system said measurements representing time-of-arrivals through a cellular radio frequency communication link;<br>
processing at said remote processing system said measurements representing time-of-arrivals to determine a position solution for said SPS receiver.<br>
56.	The method of processing satellite positioning system (SPS) signals, said<br>
method comprising:<br>
determining a signal envh-onment data which represents a manner in which<br><br>
SPS signals are propagated in a location at which an SPS receiver is located, wherein said signal environment data comprises data representing at least one of multipath conditions or interference conditions for SPS signals near said location; determining how data representing SPS signals received by said SPS receiver is processed based on said signal environment data, wherein said determining determines an integration time used to perform a time-of-arrival measurement for SPS signals from at least one SPS satellite.<br>
57. The method of processing satellite positioning system (SPS) signals, said<br>
method	comprising:<br>
determining a signal environment data which represents a maimer in which SPS signals are propagated in a location at which an SPS receiver is located, wherein said signal environment data comprises data representing at least one of multipath conditions   or   interference   conditions   for   SPS   signals   near   said   location;<br>
determining how data representing SPS signals received by said SPS receiver is processed based on said signal environment data;<br>
determining an SPS time-of-arrival measiirement;<br>
correcting said time-of-arrival measurement with a bias adjustment based on said signal environment.</td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgYWJzdHJhY3QuanBn" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che abstract.jpg</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgYWJzdHJhY3QucGRm" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgYXNzaWdubWVudC5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che assignment.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgY2xhaW1zLWR1cGxpY2F0ZS5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che claims-duplicate.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgY2xhaW1zLnBkZg==" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgY29ycmVzcG9uZGVuY2Utb3RoZXJzLnBkZg==" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che correspondence-others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgY29ycmVzcG9uZGVuY2UtcG8ucGRm" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che correspondence-po.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgZGVzY3JpcHRpb24gKGNvbXBsZXRlKS1kdXBsaWNhdGUucGRm" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che description (complete)-duplicate.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgZGVzY3JpcHRpb24gKGNvbXBsZXRlKS5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che description (complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgZHJhd2luZ3MucGRm" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgZm9ybS0xLnBkZg==" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che form-1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgZm9ybS0xOS5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che form-19.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgZm9ybS0yNi5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che form-26.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgZm9ybS0zLnBkZg==" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che form-3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgZm9ybS01LnBkZg==" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che form-5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgb3RoZXJzLnBkZg==" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgcGN0LnBkZg==" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che pct.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDEtMTA4Mi1jaGUgcGV0aXRpb24ucGRm" target="_blank" style="word-wrap:break-word;">in-pct-2001-1082-che petition.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="216412-a-device-and-method-for-switching-from-a-first-compressed-data-input-stream-to-a-second-compressed-data-input-stream.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="216414-a-system-for-warranting-the-identity-of-a-party.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>216413</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>IN/PCT/2001/1082/CHE</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>13/2008</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>31-Mar-2008</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>13-Mar-2008</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>31-Jul-2001</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>SNAPTRACK INCORPORATED</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>C/O QUALCOMM INCORPORATED, 5775 MOREHOUSE DRIVE, SAN DIEGO, CALIFORNIA 92121,</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>SHEYNBLAT, Leonid</td>
											<td>1208 North Road Belmont, California 94002,</td>
										</tr>
										<tr>
											<td>2</td>
											<td>KRASNER, Norman, F</td>
											<td>1 Torino Lane San Carlos, California 94070,</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>G01S 5/14</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/US00/01704</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2000-01-24</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>09/241,334</td>
									<td>1999-02-01</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/216413-a-method-of-measuring-time-of-arrival-of-satellite-signals-received-in-a-satellite-positioning-system-sps-receiver by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 10:37:30 GMT -->
</html>
