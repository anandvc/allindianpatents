<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/264387-reproducing-device-recording-device-recording-medium-data-processing-method-data-processing-program-data-recording-method-data-recording-program-and-integrated-circuit by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 01:08:25 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 264387:REPRODUCING DEVICE, RECORDING DEVICE, RECORDING MEDIUM, DATA PROCESSING METHOD, DATA PROCESSING PROGRAM, DATA RECORDING METHOD, DATA RECORDING PROGRAM, AND INTEGRATED CIRCUIT</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">REPRODUCING DEVICE, RECORDING DEVICE, RECORDING MEDIUM, DATA PROCESSING METHOD, DATA PROCESSING PROGRAM, DATA RECORDING METHOD, DATA RECORDING PROGRAM, AND INTEGRATED CIRCUIT</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>To provide a data generating device capable of preventing unauthorized extraction of plaintext content between decryption processing and digital watermark embedment processing. A content reproducing device B102 to which the present invention relates obtains restoration information and, in accordance with the restoration information, selectively performs predetermined restoration processing and processing of embedding device unique information, on content data at a position shown by the restoration information.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>DESCRIPTION<br>
REPRODUCING DEVICE, RECORDING DEVICE, RECORDING MEDIUM, DATA<br>
PROCESSING METHOD, DATA PROCESSING PROGRAM, DATA RECORDING<br>
METHOD, DATA RECORDING PROGRAM, AND INTEGRATED CIRCUIT<br>
Technical Field<br>
[0001]<br>
The present invention relates to a method for storing<br>
data obtained by digitizing content that is a work such as<br>
a movie, onto a large-capacity medium such as a digital optical<br>
disc, and enabling the data to be completely acquired only<br>
in a specific terminal. In particular, the present invention<br>
relates to a technique for transforming content data for<br>
copyright protection, and a technique for reproducing content<br>
data that is recorded on a large-capacity medium and has been<br>
encrypted and transformed for copyright protection.<br>
Background Art<br>
[0002]<br>
Systems in which content that is a work such as a movie<br>
is digitized, and stored and distributed on a medium have<br>
become widespread. In such a system, the content is recorded<br>
on the medium in an encrypted form, in order to prevent<br>
unauthorized use of the content. A reproducing device reads<br>
the encrypted content from the medium, decrypts the encrypted<br>
content, and reproduces the decrypted content.<br>
Furthermore, a technique for preventing unauthorized<br>
1<br><br>
copying of the content which has undergone the decryption<br>
in the reproducing device is disclosed in patent document<br>
1. According to this technique, a digital watermark is<br>
embedded in the content generated as a result of decrypting<br>
the encrypted content. In so doing, unauthorized copying of<br>
the generated content can be suppressed. Even if the content<br>
is unauthorizedly copied, the device which copied the content<br>
unauthorizedly can be specified.<br>
Patent document 1: Japanese Patent Application<br>
Publication No. 2000-312 291<br>
Patent document 2: Japanese Patent Application<br>
Publication No. 2000-100069<br>
Disclosure of the Invention<br>
Problems the Invention is going to Solve<br>
[0003]<br>
According to the above technique, however, there is a<br>
possibility that, during transfer from a decryption circuit<br>
to a digital watermark superimposing circuit, plaintext<br>
content before embedding a digital watermark may be extracted<br>
and used unauthorizedly. In view of this, the present<br>
invention aims to provide a data generating device, a data<br>
processing device, a recording medium, a data recording method,<br>
a data processing method, a data recording program, a data<br>
processing program, and an integrated circuit that can prevent<br>
unauthorized extraction of content between decryption<br>
processing and digital watermark embedment processing.<br>
2<br><br>
Means of Solving the Problems<br>
[0004]<br>
To achieve the stated aim, the present invention is a<br>
reproducing device for reproducing content data recorded on<br>
a recording medium, the content data and at least one piece<br>
of restoration information being recorded on the recording<br>
medium, each piece of restoration information including<br>
restoration position information that shows a position in<br>
the content data, a restoration-use parameter, and a<br>
restoration instruction flag, the restoration instruction<br>
flag indicating any of that (a) restoration processing of<br>
replacing part of the content data with the restoration-use<br>
parameter is performed, (b) the restoration processing is<br>
not performed, and (c) the restorationprocessing is performed<br>
depending on device unique information unique to the<br>
reproducing device, the reproducing device including: a<br>
device unique information storage unit operable to store the<br>
device unique information; an acquisition unit operable to<br>
acquire the content data and each piece of restoration<br>
information from the recording medium; a position<br>
specification unit operable to specify, in the acquired<br>
content data, the position shown by the restoration position<br>
information included in the acquired piece of restoration<br>
information; a restoration unit operable to perform the<br>
restoration processing on part of the content data<br>
corresponding to the specified position, depending on the<br>
restoration instruction flag; and a reproducing unit operable<br>
to reproduce the content data after the restoration processing<br>
3<br><br>
is performed depending on the restoration instruction flag.<br>
[0005]<br>
Also, the present invention is a recording device for<br>
recording content data onto a recording medium, including:<br>
a transformation control unit operable to generate at least<br>
one piece of restoration information; and a storage unit<br>
operable to write the content data and the at least one piece<br>
of restoration information onto the recording medium, wherein<br>
each piece of restoration information includes restoration<br>
position information that shows a position in the content<br>
data, a restoration-use parameter, and a restoration<br>
instruction flag, and the restoration instruction flag<br>
indicates any of that (a) restoration processing of replacing<br>
part of the content data with the restoration-use parameter<br>
is performed, (b) the restoration processing is not performed,<br>
and (c) the restoration processing is performed depending<br>
on device unique information.<br>
[0006]<br>
Also, the present invention is a recording medium on<br>
which content data and at least one piece of restoration<br>
information are recorded, wherein each piece of restoration<br>
information includes restoration position information that<br>
shows a position in the content data, a restoration-use<br>
parameter, and a restoration instruction flag, and the<br>
restoration instruction flag indicates any of that (a)<br>
restoration processing of replacing part of the content data<br>
with the restoration-use parameter is performed, (b) the<br>
restoration processing is not performed, and (c) the<br>
4<br><br>
restoration processing is performed depending on device<br>
unique information.<br>
Effects of the Invention<br>
[0007]<br>
The function of the "device unique information storage<br>
unit" is realized by a device unique information storage unit<br>
B13 3 in the following embodiment B, and a device unique<br>
information storage unit D13 3 in the following embodiment<br>
D. The function of the "acquisition unit" is realized by a<br>
disc reading unit B121 and a stream analysis unit B134 in<br>
the embodiment B, and a disc reading unit D121 and a content<br>
restoration processing unit D12 6 in the embodiment D. The<br>
functions of the "position specification unit" and<br>
"restoration unit" are realized by a content restoration<br>
processing unit B126 in the embodiment B, and the content<br>
restoration processing unit D12 6 in the embodiment D. The<br>
function of the "reproducing unit" is realized by a<br>
demultiplexing unit B12 7, a video decoder B12 8, and an audio<br>
decoder B12 9 in the embodiment B, and a demultiplexing unit<br>
D12 7, a video decoder D12 8, and an audio decoder D12 9 in the<br>
embodiment D.<br>
[0008]<br>
Also, the function of the "transformation control unit"<br>
is realized by a transformation control unit A106 in the<br>
following embodiment A, and a transformation control unit<br>
C106 in the following embodiment C. The function of the<br>
"storage unit" is realized by a storage unit A105 in the<br>
5<br><br>
embodiment A, and a storage unit C105 in the embodiment C.<br>
According to this construction, the reproducing device<br>
determines whether to perform the restoration processing,<br>
and whether to perform the restoration processing depending<br>
on device unique information, in accordance with the<br>
restoration flag. Therefore, an authorized content provider<br>
can obtain information that differs depending on the device<br>
unique information, by checking whether the restoration<br>
processing has been performed for the position shown by the<br>
restoration position information of the content on which a<br>
series of restoration processing has completed. Which is to<br>
say, performing the restoration processing depending on the<br>
device unique information is substantially equivalent to<br>
embedding the device unique information (the digital<br>
watermark in the conventional techniques).<br>
[0009]<br>
Thus, by employing a construction of selectively<br>
performing mere restorationprocessing and substantial device<br>
unique information embedment at each restoration position<br>
in the content data, there is no occasion for plaintext content,<br>
on which neither transformation processing such as encryption<br>
nor device unique information embedment has been performed,<br>
to exist in the reproducing device. As a result, the danger<br>
that the plaintext data is extracted and submitted to<br>
unauthorized use can be prevented.<br>
[0010]<br>
Also, even when the restoration instruction flag<br>
indicates that the restoration processing is performed<br>
6<br><br>
depending on the device unique information, that is, even<br>
when the restoration instruction flag substantially instructs<br>
to embed the device unique information, the operation actually-<br>
performed by the restoration unit is the replacement with<br>
the restoration-use parameter. This being so, it is difficult<br>
for a third party to distinguish, based on the operation of<br>
the reproducing device, whether the device unique information<br>
was inserted or the mere restorationprocessing was performed.<br>
This prevents a third party from obtaining the plaintext<br>
content data while excluding part of the content data where<br>
the device unique information has been inserted.<br>
[0011]<br>
Here, the present invent ion may be the reproducing device<br>
wherein each piece of restoration information is encrypted<br>
using a secret parameter, a byte code, in which a procedure<br>
of outputting the secret parameter is described in a form<br>
executable by the reproducing device, is further recorded<br>
on the recording medium, the reproducing device further<br>
includes: a byte code execution unit operable to execute the<br>
byte code; and a decryption unit operable to decrypt the<br>
encrypted piece of restoration information using the secret<br>
parameter output as a result of executing the byte code, and<br>
the restoration unit performs the restoration processing<br>
using the decrypted piece of restoration information.<br>
[0012]<br>
Here, the present invention may be the recording device<br>
wherein the transformation control unit further encrypts each<br>
piece of restoration information using a secret parameter,<br>
7<br><br>
and generates a byte code including a procedure of outputting<br>
the secret parameter, and the storage unit writes the encrypted<br>
piece of restoration information onto the recording medium,<br>
and further writes the generated byte code onto the recording<br>
medium.<br>
Here, the present invention may be the recording medium<br>
wherein each piece of restoration information is encrypted<br>
using a secret parameter, and a byte code including a procedure<br>
of outputting the secret parameter is further recorded on<br>
the recording medium.<br>
[0013]<br>
The function of the "byte code execution unit" is<br>
realized by a byte code execution unit B124 in the embodiment<br>
B, and a byte code execution unit D124 in the embodiment D.<br>
The function of the "decryption unit" is realized by a packet<br>
decryption unit B13 5 in the embodiment B, and a packet<br>
decryption unit in the embodiment D.<br>
According to this construction, the restoration<br>
information is encrypted, so that the restoration position<br>
information, the restoration-use parameter, and the<br>
restoration flag are unknown to a third party. This prevents<br>
an unauthorized third party from unauthorizedly restoring<br>
the content data.<br>
[0014]<br>
Here, the present invent ion may be the reproducing device<br>
wherein each piece of restoration information is multiplexed<br>
in the content data, and the acquisition unit includes: a<br>
reading unit operable to read the content data including each<br>
8<br><br>
piece of restoration information; and an analysis unit<br>
operable to detect each piece of restoration information in<br>
the content data.<br>
Here, the present invention may be the recording device<br>
further including: a multiplexing unit operable to multiplex<br>
each piece of restoration information in the content data,<br>
wherein the storage unit writes the content data in which<br>
each piece of restoration information has been multiplexed,<br>
onto the recording medium.<br>
[0015]<br>
Here, the present invention may be the recording medium<br>
wherein each piece of restoration information is multiplexed<br>
in the content data.<br>
The function of the "reading unit" is realized by the<br>
disc reading unit B121 in the embodiment B, and the disc reading<br>
unit D121 in the embodiment D. The function of the "analysis<br>
unit" is realized by a stream analysis unit B134 in the<br>
embodiment B, and the content restoration processing unit<br>
D126 in the embodiment D.<br>
[0016]<br>
Also, the function of the "multiplexingunit" is realized<br>
by a multiplexing unit A103 in the embodiment A, and a<br>
multiplexing unit C103 in the embodiment C.<br>
According to this construction, the restoration<br>
information is multiplexed in the content data. This being<br>
so, in the case where the position specification unit and<br>
the restoration unit are implemented on a single CPU, just<br>
transferring the content data to this single CPU enables the<br>
9<br><br>
position specif ication unit and the restoration unit to easily<br>
acquire the restoration information and the content data<br>
respectively.<br>
[0017]<br>
Here, the pre sent invent ion may be the reproduc ing devi ce<br>
wherein a restoration file constituted by the at least one<br>
piece of restoration information is recorded on the recording<br>
medium, and the acquisition unit acquires each piece of<br>
restoration information from the restoration file.<br>
Here, the present invention may be the recording device<br>
wherein the at least one piece of restoration information<br>
generated by the transformation control unit constitutes a<br>
restoration file, and the storage unit writes the restoration<br>
file constituted by the at least one piece of restoration<br>
information, onto the recording medium.<br>
[0018]<br>
Here, the present invention may be the recording medium<br>
wherein a restoration file constituted by the at least one<br>
piece of restoration information is recorded on the recording<br>
medium.<br>
According to this construction, the restoration<br>
information is recorded separately from the content data.<br>
This being so, in the case where the position specification<br>
unit and the restoration unit are implemented on separate<br>
CPUs, the content data and the restoration information can<br>
easily be transferred to the CPUs to which the respective<br>
units belong.<br>
10<br><br>
Brief Description of the Drawings<br>
[0019]<br>
FIG. 1 is a block diagram showing a structure of a<br>
transformation processing subsystem in an embodiment Al of<br>
the present invention.<br>
FIG. 2 is a block diagram showing a structure of a disc<br>
production system in the embodiment Al of the present<br>
invention.<br>
FIG. 3 is an operation flowchart showing an operation<br>
of the transformation processing subsystem in the embodiment<br>
Al of the present invention.<br>
FIG. 4 shows multiplexing processing in the embodiment<br>
Al of the present invention.<br>
FIG. 5 shows a structure of restoration information in<br>
the embodiment Al of the present invention.<br>
FIG. 6 shows meanings of a restoration instruction flag<br>
in the restoration information in the embodiment Al of the<br>
present invention.<br>
FIG. 7 shows a structure of a restoration instruction<br>
descriptor in the embodiment Al of the present invention.<br>
FIG. 8 shows a structure of a private section in the<br>
embodiment Al of the present invention.<br>
FIG. 9 shows a structure of a TS packet that includes<br>
a private section in the embodiment Al of the present invention.<br>
FIG. 10 shows a structure of a secret parameter list<br>
in the embodiment Al of the present invention.<br>
FIG. 11 shows a structure of a reproducing terminal and<br>
of data on a recording medium in the embodiment Al of the<br>
11<br><br>
present invention.<br>
FIG. 12 shows a different example of multiplexing<br>
processing in the embodiment A1 of the present invention.<br>
FIG. 13 shows a structure of restoration information<br>
in an embodiment A2 of the present invention.<br>
FIG. 14 shows a structure of a PMT section in the<br>
embodiment A2 of the present invention.<br>
FIG. 15 shows a structure of a PMT section that includes<br>
a restoration instruction descriptor in the embodiment A2<br>
of the present invention.<br>
FIG. 16 shows a structure of a TS packet including a<br>
PMT section in the embodiment A2 of the present invention.<br>
FIG. 17 shows multiplexing processing in the embodiment<br>
A2 of the present invention.<br>
FIG. 18 shows a structure of a secret parameter list<br>
in the embodiment A2 of the present invention.<br>
FIG. 19 shows multiplexing into a PAT in the embodiment<br>
A2 of the present invention.<br>
FIG. 2 0 shows multiplexing into an adaptation field in<br>
the embodiment A2 of the present invention.<br>
FIG. 21 shows a structure of another example of the<br>
transformation processing subsystem in the embodiment A2 of<br>
the present invention.<br>
FIG. 2 2 shows a structure of another example of a<br>
transformation processing subsystem in an embodiment A3 of<br>
the present invention.<br>
FIG. 23 is an operation flowchart showing an operation<br>
of the transformation processing subsystem in the embodiment<br>
12<br><br>
A3 of the present invention.<br>
FIG. 24 shows a structure of restoration information<br>
in the embodiment A3 of the present invention.<br>
FIG. 2 5 shows a structure of a restoration information<br>
file in the embodiment A3 of the present invention.<br>
FIG. 2 6 shows a structure of a reproducing terminal and<br>
of data on a recording medium in the embodiment A3 of the<br>
present invention.<br>
FIG. 2 7 shows a structure of another example of the<br>
transformation processing subsystem in the embodiment A3 of<br>
the present invention.<br>
FIG. 2 8 shows a structure of a recording medium and a<br>
content reproducing device in an embodiment Bl of the present<br>
invention.<br>
FIG. 2 9 is a flowchart of content reproductionprocessing<br>
in the embodiment Bl.<br>
FIG. 3 0 is a flowchart of revocation confirmation<br>
processing of the content reproducing device in the embodiment<br>
Bl.<br>
FIG. 31 is a flowchart of content key generation<br>
processing in the embodiment Bl.<br>
FIG. 32 is a flowchart of decryption processing of<br>
restoration processing-use TS packets in the embodiment Bl.<br>
FIG. 33 is a flowchart of restoration processing of<br>
transformed content data in the embodiment Bl.<br>
FIG. 34 is a data structure example of transformed<br>
content data in the embodiment B1.<br>
FIG. 3 5 is a data structure example of a restoration<br>
13<br><br>
processing-use TS packet in the embodiment B1.<br>
FIG. 36 is a data structure example of a restoration<br>
instruction descriptor in the embodiment Bl.<br>
FIG. 3 7 shows meanings of a restoration instruction flag<br>
in the embodiment B1.<br>
FIG. 3 8 shows a data structure of a secret parameter<br>
held by a byte code in the embodiment B1.<br>
FIG. 3 9 shows a data structure example of a restoration<br>
processing-use TS packet in the embodiment B1.<br>
FIG. 4 0 shows a data structure example of a restoration<br>
processing-use TS packet in the embodiment B1.<br>
FIG. 41 shows a data structure example of a restoration<br>
processing-use TS packet in the embodiment B1.<br>
FIG. 42 shows a structure of a recording medium and a<br>
content reproducing device in an embodiment B2 of the present<br>
invention.<br>
FIG. 43 shows a data structure example of a restoration<br>
information file in the embodiment B2.<br>
FIG. 44 shows a data structure example of restoration<br>
information in the embodiment B2.<br>
FIG. 45 is a flowchart of content reproductionprocessing<br>
in the embodiment B2.<br>
FIG. 46 is a flowchart of restoration processing of<br>
transformed content data in the embodiment B2.<br>
FIG. 4 7 is a block diagram showing a structure of a<br>
transformation processing subsystem in an embodiment C1 of<br>
the present invention.<br>
FIG. 4 8 is a block diagram showing a structure of a disc<br>
14<br><br>
production system in the embodiment C1 of the present<br>
invention.<br>
FIG. 49 is an operation flowchart showing an operation<br>
of the transformation processing subsystem in the embodiment<br>
C1 of the present invention.<br>
FIG. 5 0 shows a structure of a transformation<br>
processing-use packet in the embodiment C1 of the present<br>
invention. FIG. 5 0A shows a structure of a transformation<br>
processing-use packet specifying operation processing, a<br>
transformation position, and an operation-use parameter.<br>
[0020]<br>
FIG. 50B shows a structure of a transformation<br>
processing-use packet specifying only a transformation<br>
position.<br>
FIG. 51 shows a structure of byte code data in the<br>
embodiment C1 of the present invention. FIG. 51A shows a<br>
structure of a byte code specifying an operation mode and<br>
an operation-use parameter use position.<br>
[0021]<br>
FIG. 51B shows a structure of a byte code specifying<br>
an operation mode, transformation processing, and an<br>
operation-use parameter.<br>
FIG. 52 is a block diagram showing main parts of a<br>
reproducing terminal in the embodiment C1 of the present<br>
invention.<br>
FIG. 53 shows a structure of a transformed content file<br>
in the embodiment C1 of the present invention.<br>
FIG. 54 shows a combination of information transmitted<br>
15<br><br>
by a transformation processing-use packet and byte code data<br>
in the embodiment C1 of the present invention.<br>
FIG. 5 5 is a block diagram showing a structure of a<br>
transformation processing subsystem in an embodiment C2 of<br>
the present invention.<br>
FIG. 5 6 shows a structure of a recording medium and a<br>
content reproducing device in an embodiment D of the present<br>
invention.<br>
FIG. 57 is a flowchart showing content reproduction<br>
processing in the embodiment D of the present invention.<br>
FIG. 58 is a flowchart showing revocation confirmation<br>
processing of the content reproducing device in the embodiment<br>
D of the present invention.<br>
FIG. 59 is a flowchart showing content key generation<br>
processing in the embodiment D of the present invention.<br>
FIG. 6 0 is a flowchart showing byte code execution<br>
processing in the embodiment D of the present invention.<br>
FIG. 61 is a flowchart showing restoration processing<br>
of transformed content data in the embodiment D of the present<br>
invention.<br>
FIG. 62 shows a data structure example of restoration<br>
setting information in the embodiment D of the present<br>
invention.<br>
FIG. 63 shows a data structure example of transformed<br>
content data in the embodiment D of the present invention.<br>
FIG. 64 shows a data structure example of a restoration<br>
processing-use TS packet in the embodiment D of the present<br>
invention. FIG. 64A shows a structure of a restoration<br>
16<br><br>
processing-use TS packet for use in a device unique mode.<br>
[0022]<br>
FIG. 64B shows a structure of a restoration<br>
processing-use TS packet for use in a content unique mode.<br>
FIG. 65 shows a matching criterion example of an<br>
operation mode in the embodiment D of the present invention.<br>
Description	of Reference Numerals<br>
[0023]<br>
A101			transformation processing subsystem<br>
A103			multiplexing unit<br>
A104			transformation processing unit<br>
A105			storage unit<br>
A106			transformation control unit<br>
A10 7			input unit<br>
B102			content reproducing device<br>
B121			disc reading unit<br>
B122			reproduction control unit<br>
B123			user operation reception unit<br>
B124			byte code execution unit<br>
B125			stream decryption unit<br>
B126			content restoration processing unit<br>
B12 7			demultiplexing unit<br>
B128			video decoder<br>
B129			audio decoder<br>
B13 0			content key generation unit<br>
B131			revocation information processing unit<br>
B132			device key storage unit<br>
17<br><br>
B133 		device unique information storage unit<br>
B134 		stream analysis unit<br>
B135 		packet decryption unit<br>
C101 		transformation processing subsystem<br>
C103 		multiplexing unit<br>
C104 		transformation processing unit<br>
C105 		storage unit<br>
C106 		transformation control unit<br>
CI07 		input unit<br>
D102 		content reproducing device<br>
D121 		disc reading unit<br>
D122 		reproduction control unit<br>
D123 		user operation reception unit<br>
D124 		byte code execution unit<br>
D125 		decryption unit<br>
D126 		content restoration processing unit<br>
D127 		demultiplexing unit<br>
D128 		video decoder<br>
D129 		audio decoder<br>
D130 		content key generation unit<br>
D131 		revocation information processing unit<br>
D132 		device key storage unit<br>
D133 		device unique information storage unit<br>
Best Mode for Carrying out the Invention<br>
[0024]<br>
Below, the embodiments of the present invention are<br>
described with reference to drawings. It is to be noted that<br>
18<br><br>
the present invention is by no means limited to these<br>
embodiments and may take various forms that do not depart<br>
from the scope of the invention.<br>
1. Embodiment A: Disc Production System<br>
(Embodiment A1)<br>
FIG. 1 is a block diagram showing mainparts of a structure<br>
of a transformation processing subsystem A101 for executing<br>
transformation processing in an embodiment Al of the present<br>
invention. The transformation processing subsystem A101<br>
includes a multiplexing unit A103, a transformation<br>
processing unit A104, a storage unit A105, a transformation<br>
control unit A106, and an input unit A107. The multiplexing<br>
unit A103 is connected to a recording medium A102 and the<br>
transformation control unit A106, and multiplexes, with a<br>
content file, multiplex information, which includes<br>
restoration information for restoring content that has been<br>
transformed according to instructions from the transformation<br>
control unit A106, and outputs the resultant content file.<br>
The transformation processing unit A104 is connected to the<br>
multiplexing unit A103 and the transformation control unit<br>
A106, and executes transformation processing on specified<br>
content packets in the content file according to instructions<br>
from the transformation control unit A106. The storage unit<br>
A105 is connected to the transformation processing unit A104<br>
and the transformation control unit A106, and stores, on a<br>
recording medium A108, a post-transformation, transformed<br>
content file and byte code data that has been received from<br>
19<br><br>
the transformation control unit A106. The transformation<br>
control unit A106 is connected to the input unit A107, and,<br>
based on data received from the input unit A107, issues<br>
transformation processing instructions to the multiplexing<br>
unit A103 and to the transformation processing unit A104.<br>
The transformation control unit A106 also generates the byte<br>
code data including processes and parameters for reversing<br>
the transformation corresponding to the transformation<br>
processing, and transmits the byte code data to the storage<br>
unit A105. The input unit A107 inputs data to specify the<br>
transformation processing.<br>
[0025]<br>
Below, a disc production system including the<br>
transformation processing subsystem A101 is described with<br>
reference to FIG. 2.<br>
FIG. 2 is a block diagram showing main parts of a disc<br>
production system for producing a recording medium A205 , such<br>
as an optical disc, in the embodiment Al of the present<br>
invention. This disc production system includes an encode<br>
subsystemA2 01, the transf ormationprocessing subsystemAlOl,<br>
an encryption subsystem A2 02, and a disc writing subsystem<br>
A2 04. The encode subsystem A201 converts content data such<br>
as audio and video into a data format suitable for storing<br>
on the recording medium A2 05 such as the optical disc, and<br>
stores the result as a content file on the recording medium<br>
A102. The transformation processing subsystem A101<br>
implements transformation processing on the content file<br>
stored in the recording medium A102, and stores a transformed<br>
20<br><br>
content file together with the byte code data that corresponds<br>
to the transformation processing on the recording medium A108 .<br>
The encryption subsystem A202 is connected to the recording<br>
medium A108, carries out encryption processing on the<br>
transformed content file to generate an encrypted content<br>
file, and stores at least the encrypted content file and the<br>
byte code data on a recording medium A203. The disc writing<br>
subsystem A2 04 is connected to the recording medium A2 03 and<br>
writes at least the encrypted content file and the byte code<br>
data to the recording medium A2 05 . Thus at least the encrypted<br>
content file and the byte code data are stored in the recording<br>
medium A205. Further, a key for decrypting the encrypted<br>
content file may also be stored in the recording medium A2 05 .<br>
[0026]<br>
An operation of the transformation processing subsystem<br>
A101 having the kind of structure described above is described<br>
with reference to an operation flowchart of FIG. 3.<br>
FIG. 3 is an operation flowchart showing the operation<br>
of the transformation processing subsystem A101.<br>
In step SA3 01, various information is input into the<br>
transformation control unit A106 from the input unit A107.<br>
This information includes: transformation position<br>
information indicating the ordinal number, counted from the<br>
head packet of a content file, of a packet and the ordinal<br>
numbers of the bytes within the packet that are to be<br>
transformed; operation processing information indicating<br>
which operation of a set of operations including logic<br>
operations such as XOR (Exclusive OR) and encryption methods<br>
21<br><br>
such as AES (Advanced Encryption Standard) is to be performed;<br>
an operation-use parameter for use in operation processing;<br>
and an operation mode which is information for judging, on<br>
the basis of information such as a terminal ID that specifies<br>
a reproducing terminal, whether or not to perform restoration<br>
processing at a given reproducing terminal for reproducing<br>
the recording medium A2 05.<br>
[0027]<br>
Next, in step SA3 02, based upon the information input<br>
in step SA3 01, the transformation control unit A106 generates<br>
multiplex information that includes restoration information,<br>
and generates a multiplex position and the byte code data.<br>
The multiplex position is information specifying the ordinal<br>
number from the head of the content file of the packet at<br>
which the generated multiplex information is multiplexed.<br>
The multiplex position is generated to allow for processing<br>
time at the reproducing terminal, so that the multiplex<br>
information is multiplexed a certain number of packets before<br>
the transformation position specified by the above<br>
transformation position information. The multiplex<br>
information and the byte code data are described at a later<br>
stage in this description. The transformation control unit<br>
A106 transmits the generated multiplex information and the<br>
multiplex position to the multiplexing unit A103, transmits<br>
the transformation position information, the operation<br>
processing information, and the operation-use parameter to<br>
the transformation processing unit A104, and transmits the<br>
generated byte code data to the storage unit A105.<br>
22<br><br>
[0028]<br>
Next, in step SA3 03, the multiplexing unit A103<br>
multiplexes the multiplex information into a position in the<br>
content file specified by the multiplex position.<br>
Next, instepSA3 04, the transformation processing unit<br>
A104 specifies the packet that is to be transformed and the<br>
transformation target data, the data that is to transformed<br>
within the packet, on the basis of the transformation position.<br>
Next, instepSA3 05, the transformation processing unit<br>
A104 executes operation processing using the received<br>
operation-use parameter on the transformation target data<br>
in the specified transformation packet. For example, when<br>
the operation processing is an XOR operation, the<br>
transformation processing unit A104 takes the XOR sum of the<br>
transformation target data and the operation-use parameter,<br>
and overwrites (replaces) the transformation target data with<br>
the resulting value. Note that the operation processing is<br>
not limited to an XOR operation, but may consist of other<br>
logic operations or encryption processes. Alternatively,<br>
the transformation target data may simply be overwritten with<br>
the operation-use parameter. If this is the case, before<br>
overwriting the transformation target data, the<br>
transf ormationprocessingunit A104 stores the transformation<br>
target data in the multiplex information as a restoration-use<br>
parameter. To put this processing into practice, steps SA3 04<br>
and SA305 may be executed before steps SA302 and SA303.<br>
[0029]<br>
Next, in step SA3 06, the storage unit A105 stores the<br>
23<br><br>
transformed content file that has finished undergoing<br>
transformation processing on the recording medium A108.<br>
Next, in step SA307, the storage unit A105 stores the<br>
byte code data on the recording medium A108 in a different<br>
file from the transformed content file.<br>
Note that a plurality of transformation positions can<br>
be specified within one content file, in which case, in step<br>
SA3 01, operation processing and an operation-use parameter<br>
are input for each of the plurality of transformation positions .<br>
Transformation can then be realized by repeating step SA3 02<br>
to step SA3 05 for each of the plurality of transformation<br>
positions.<br>
[0030]<br>
FIG. 4 shows a representation of the transformed content<br>
file generated via the kind of operation flow described above .<br>
In FIG. 4, the multiplex information is represented as a<br>
restoration processing-use TS (transport stream) packet that<br>
includes restoration information for restoring the content.<br>
A post-transformation processing content file A402, which<br>
is a content file after transformation processing, is<br>
generated by the multiplexing unit A103 multiplexing a<br>
restoration processing-use TS packet with a<br>
pre-transformation processing content file A401, and by the<br>
transformation processing unit A104 carrying out<br>
transformation processing. Here, the restoration<br>
processing-use packet has a packet identifier that is<br>
different from those of other packets in the content file.<br>
[0031]<br>
24<br><br>
The restoration information included in the multiplex<br>
information and the byte code data generated using the above<br>
operation flow, are described below. The restoration<br>
information and the byte code data are used at the reproducing<br>
terminal for reversing the transformation processing, and<br>
respectively include information indicated in FIG. 5 and FIG.<br>
10. The byte code data is, for example, the type of code<br>
executable in a virtual operation unit, such as a JAVA virtual<br>
machine, and is the data describing a code executable at the<br>
reproducing terminal.<br>
[0032]<br>
A piece of restoration information A501 of FIG. 5<br>
includes a restoration instruction flag for judging whether<br>
or not to perform the restoration processing, or for judging<br>
whether or not to reference a terminal ID before carrying<br>
out restoration processing, as shown in FIG. 6. For the case<br>
when the restoration instruction flag indicates terminal ID<br>
reference, the restoration information further includes: a<br>
terminal ID reference position specifying which value of the<br>
terminal ID to reference; a relative packet count indicating<br>
the ordinal number, counted from the restoration<br>
processing-use packet, of the packet that is to be restored,<br>
and thereby acting as a restoration position; an in-packet<br>
position indicating a position of restoration target data<br>
within the packet to be restored; a byte size of restoration<br>
target data; and a restoration-use parameter to be employed<br>
intherestorationprocessing. For example, when the relative<br>
packet count is "5", the fifth packet from the restoration<br>
25<br><br>
processing-use packet is the transformation target packet,<br>
when the in-packet position is "100" , a restoration starting<br>
position is the hundredth byte from the first byte of the<br>
transformation target packet, and when the byte size of the<br>
restoration target data is "16" , the restoration target data<br>
extends 16 bytes from the restoration starting position.<br>
[0033]<br>
The piece of restoration information A5 01 is then<br>
encrypted via an operation such as an XOR operation using<br>
a secret parameter. After storing the piece of restoration<br>
information A5 01 in a descriptor format as a restoration<br>
instruction descriptor as shown in FIG. 7, and storing the<br>
restoration instruction descriptor in a private section as<br>
shown in FIG. 8 , the private section is stored in a restoration<br>
processing-use TS packet in a TS packet format as shown in<br>
FIG. 9. Here, the descriptor, the section, and the TS packet<br>
conform to formats stipulated in specifications such as MPEG<br>
2, and their description is omitted here.<br>
[0034]<br>
The aforementioned secret parameters are managed in a<br>
secret parameter list A1001, such as the one of FIG. 10, each<br>
secret parameter being stored in correspondence with a packet<br>
count from a packet header that indicates which piece of<br>
restoration information it has been used with respect to.<br>
The transformation control unit A10 6 generates the byte code<br>
data so as to include this secret parameter list A1001.<br>
To assist in the comprehension of the effects of the<br>
present embodiment, an example operation of a reproducing<br>
26<br><br>
terminal is described with reference to FIG. 11, which shows<br>
its main parts . A reproducing terminal A1101 reads byte code<br>
data All 03 from the recording medium A2 05 . In the reproducing<br>
terminal A1101, in preparation for reproduction, a byte code<br>
processing unit A1110 then analyzes the byte code data A1103 ,<br>
acquires the secret parameters, and transmits the secret<br>
parameters together with the terminal ID to a restoration<br>
processing unit A1106.<br>
[0035]<br>
Subsequently, at reproduction, the reproducing<br>
terminal A1101 reads an encrypted content file A1102. A<br>
decryption unit A1104 decrypts the encrypted content file<br>
and outputs the resultant decrypted content file A1102 to<br>
a restoration processing-use packet extraction unit A1105<br>
as the transformed content. Upon detecting the restoration<br>
processing-use packets, the restoration processing-use<br>
packet extraction unit A1105 outputs the restoration<br>
processing-use packets and the remaining transformed content<br>
to the restoration processing unit A1106. The restoration<br>
processing unit A1106 decrypts the piece of restoration<br>
information A501 in each of the restoration processing-use<br>
packets, via an XOR operation or the like using the<br>
corresponding secret parameters, and carries out the<br>
following restorationprocessing on the basis of the decrypted<br>
piece of restoration information A501.<br>
[0036]<br>
When the restoration instruction flag indicates that<br>
restoration is performed, or alternatively, when the<br>
27<br><br>
restoration instruction flag indicates terminal ID reference<br>
and a part of the value of the terminal ID specified by the<br>
terminal ID reference position is 1, the restoration<br>
processing unit A1106 implements restoration processing. It<br>
achieves this by specifying the starting position of the<br>
restoration target data in the transformed content on the<br>
basis of the relative packet count and the in-packet position,<br>
and by overwriting, with the restoration-use parameter, a<br>
same number of bytes as indicated by the restoration target<br>
data byte size.<br>
Subsequently, the restoration processing unit A1106<br>
outputs the restored content to a demultiplexer A1107, and<br>
the demultiplexer A1107 converts the content information,<br>
which includes video and audio data, into a format that can<br>
beprocessedbya decoding unit Alio 9 . The demultiplexer All 0 7<br>
outputs the converted content information to a video buffer<br>
A1108 , and the decoding unit A1109 carries out the processing<br>
associated with reproduction and output of the content.<br>
[0037]<br>
In this way, in this embodiment, data in the content<br>
file relating to transformation processing can be specified<br>
using the restoration information in each restoration<br>
processing-use packet and the byte code data, and hence,<br>
transformation processing different from the encryption<br>
performed by the encryption subsystem A2 02 can be freely<br>
implemented for each content file.<br>
Further, as a result of making instructions as to whether<br>
or not a terminal should implement restoration processing<br>
28<br><br>
depend on the terminal ID, a part of the post-restoration<br>
content data will be different for every terminal ID, and<br>
it will be possible to specify a reproducing terminal that<br>
has taken an unauthorized copy or unauthorizedly distributed<br>
the content.<br>
[0038]<br>
Further, in the transformation processing subsystem<br>
A101, if an unauthorized terminal ID list is input from the<br>
input unit A107, the unauthorized terminal ID list can be<br>
stored as part of the byte code data. In such a case, when<br>
a reproducing terminal references its terminal ID, if a<br>
terminal ID that matches its own is stored in the unauthorized<br>
terminal ID list contained in the byte code data, reproduction<br>
can be discontinued, analysis of the byte code data cancelled,<br>
or the like. Consequently, unauthorized terminals can be<br>
rendered incapable of reproducing content in a normal way.<br>
[0039]<br>
Note that the byte code data need not be JAVA, but may<br>
be another type of execution code. Moreover, the byte code<br>
data can be a self-modifying type of execution code, making<br>
it possible to obtain an improvement in the degree of<br>
concealment of the byte code data.<br>
Further, though the private section that includes the<br>
restoration processing was described as being stored in<br>
restoration processing-use TS packets which have a different<br>
PID from the other content packets, the private section may<br>
instead be stored in a payload of a PCR (Program Clock<br>
Reference) packet, in which case the number of restoration<br><br>
processing-use TS packets can be reduced.<br>
[0040]<br>
Further, the pieces of restoration information A501 may<br>
be stored in payloads of PCR packets.<br>
Further, it goes without saying that a plurality of<br>
restoration instruction descriptors can be stored in a single<br>
section, and that a plurality of pieces of restoration<br>
information can be stored in a single restoration instruction<br>
descriptor.<br>
Further, rather than including descriptors for the<br>
pieces of restoration information A501, the restoration<br>
processing-use packets may be generated by making the pieces<br>
of restoration information PES packets which are stipulated<br>
by MPEG 2 or the like.<br>
[0041]<br>
Further, though in the reproducing terminal A1101, the<br>
restoration-use parameters were described as being used to<br>
overwrite the restoration target data, encryption processing<br>
such as XOR and AES can also be used.<br>
Further, though in the secret parameter list A10 01 of<br>
FIG. 10 positions at which the secret parameters are used<br>
are indicated by a number of packets from the head packet,<br>
the positions can be indicated by read-out time information<br>
that accompanies TS packets.<br>
[0042]<br>
Further, though multiplexing processing was used to<br>
insert the restoration processing-use packet between AV<br>
data-use TS packets as shown in FIG. 7, the restoration<br>
30<br><br>
processing-use packet may instead be inserted in place of<br>
a null packet as shown in FIG. 12. In such a case, while it<br>
is necessary to pre-insert null packets into the content file,<br>
the effect of the content file not increasing in size under<br>
transformation processing can be obtained.<br>
(Embodiment A2)<br>
Since a structure of a transformation processing<br>
subsystem of an embodiment A2 is the same as that of the<br>
transformation processing subsystem A101 of the embodiment<br>
Al, a specific description is omitted, and the embodiment<br>
A2 is described using the transformation processing subsystem<br>
A101.<br>
[0043]<br>
In this embodiment, the transformation processing<br>
subsystem A101 generates a piece of restoration information<br>
A13 01 shown in FIG. 13, and a secret parameter list A1801<br>
shown in FIG. 18.<br>
The piece of restoration information A13 01 of FIG. 13<br>
is the restoration inf ormation A5 01 of FIG. 5 with the addition<br>
of a secret parameter identifying value, the other information<br>
being the same as the piece of restoration information A501.<br>
The transformation control unit A106 uses a secret parameter<br>
corresponding to the secret parameter identifying value in<br>
the piece of restoration information A13 01 to encrypt all<br>
or part of the information from the restoration instruction<br>
flag to the restoration-use parameter, via an XOR operation<br>
or the like. Subsequently, the transformation control unit<br>
31<br><br>
A106 transmits the piece of restoration information A1301,<br>
as a restoration instruction descriptor in the descriptor<br>
format shown in FIG. 7, together with a multiplex position<br>
to the multiplexing unit A103.<br>
[0044]<br>
Further, the transformation control unit A106 manages<br>
the secret parameter and secret parameter identifying value<br>
combinations used in the encryption as the secret parameter<br>
list A18 01 of the type shown in FIG. 18, and generates the<br>
byte code data so as to include the secret parameter list<br>
A1801.<br>
The multiplexing unit A103 multiplexes the restoration<br>
instruction descriptor into a PMT (programmap table) existing<br>
in the multiplex position. The make-up of a PMT section is,<br>
as shown in FIG. 14, of a format prescribed by MPEG 2 or the<br>
like, and includes a descriptor first loop and a descriptor<br>
second loop for storing descriptors. The multiplexing unit<br>
A103 stores the restoration instruction descriptor in the<br>
descriptor first loop of the PMT section as shown in FIG.<br>
15, and makes the TS packet that is storing the PMT into a<br>
TS packet of the type shown in FIG. 16. This multiplexing<br>
process is illustrated in FIG. 17. As shown in FIG. 17, the<br>
multiplexing unit A103 stores the restoration instruction<br>
descriptor in a PMT TS packet, which is part of a<br>
pre-transformation processing content file A1701. The<br>
transformation processing unit A104 then transforms the<br>
necessary TS packets to generate a post-transformation<br>
processing content file A1702.<br>
32<br><br>
[0045]<br>
The transformed content file, which has undergone<br>
transformation by the transformation processing subsystem<br>
A101 in the way described above, and the byte code data are<br>
stored in the recording medium A2 0 5 via the processes of the<br>
disc production system shown in FIG. 2.<br>
Since the structure of the reproducing terminal of the<br>
embodiment A2 is the same as that of the embodiment Al, an<br>
example of its operation is also described with reference<br>
to FIG. 11.<br>
[0046]<br>
The reproducing terminal A1101 reads the byte code data<br>
A1103 from the recording medium A205. In the reproducing<br>
terminal, in preparation for reproduction, the byte code<br>
processing unit A1110 analyses the byte code data A1103,<br>
acquires the secret parameters and the secret parameter<br>
identifying values, and transmits the secret parameters, the<br>
secret parameter identifying values, and the terminal ID to<br>
the restoration processing unit A1106.<br>
Subsequently, at reproduction, the decryption unit<br>
A1104 reads and decrypts the encrypted content file A1102,<br>
and outputs the decrypted content file to the restoration<br>
processing-use packet extraction unit A1105 as the<br>
transformed content. Upon detection of the restoration<br>
processing-use packets, the restoration processing-use<br>
packet extraction unit A1105 outputs them, together with the<br>
remaining transformed content, to the restoration processing<br>
unit A1106. The restoration processing unit A1106 decrypts<br>
33<br><br>
the piece of restoration information A501 in each of the<br>
restoration processing-use packets, via an XOR operation or<br>
the like using the secret parameters indicated by the secret<br>
parameter identifying values, and carries out the following<br>
restoration processing on the basis of the decrypted piece<br>
of restoration information A501.<br>
[0047]<br>
When the restoration instruction flag indicates that<br>
restoration is performed, or alternatively, when the<br>
restoration instruction flag indicates terminal ID reference<br>
and a part of the value of the terminal ID specified by the<br>
terminal ID reference position is 1, the restoration<br>
processing unit A1106 implements restoration processing. It<br>
achieves this by specifying the position of the restoration<br>
target data in the transformed content on the basis of the<br>
relative packet count and the in-packet position, and by<br>
overwriting, with the restoration-use parameter, a same<br>
number of bytes as indicated by the restoration target data<br>
byte size.<br>
When the restoration instruction flag indicates that<br>
restoration is not performed, the restoration information<br>
is not processed.<br>
[0048]<br>
In this way, in this embodiment, data in the content<br>
file relating to transformation processing can be specified<br>
using the restoration information in each restoration<br>
processing-use packet and the byte code data, and<br>
transformation processing different from the encryption<br>
34<br><br>
performed by the encryption subsystem A2 02 can be freely<br>
implemented for each content file.<br>
Further, since the restoration instruction descriptors<br>
are stored in the PMTs, there is no need to provide TS packets<br>
having a new PID, and an increase in the quantity of data<br>
can be prevented.<br>
[0049]<br>
Further, either a part or the whole of the PMT may store<br>
the restoration instruction descriptor.<br>
Further, as a result of storing the restoration<br>
instruction descriptor in a predetermined fixed position,<br>
such as at the head or at the third bit of the descriptor<br>
first loop in the PMT, only the fixed position need be examined<br>
at restoration processing in the reproducing terminal, and<br>
a reduction in the number of processing operations is therefore<br>
possible.<br>
[0050]<br>
Note also that, a region in the PMT for storing the<br>
restoration instruction descriptor maybe emptied in advance<br>
of storing it. Doing this enables the restoration instruction<br>
descriptor to be stored without increasing the data size of<br>
the PMT.<br>
Further, the storage position for the restoration<br>
information is not limited to the examples of the embodiments<br>
A1 and A2; a fresh PA section may be prescribed in a PAT (program<br>
association table) as shown in FIG. 19, and the restoration<br>
instruction descriptor stored therein. This method is not<br>
of course limited to the PAT and a fresh section may be<br>
35<br><br>
prescribed in any other type of table.<br>
[0051]<br>
Further, as shown in FIG. 20, the restoration information<br>
maybe written into aprivate_data_byte region of an adaptation<br>
field stipulated by MPEG 2 or the like. The adaptation field<br>
for storing the restoration information may even be included<br>
in a TS packet that is to be transformed, in which case the<br>
fact that the TS packet is to be restored can be indicated<br>
by setting "relative packet count = 0" in the restoration<br>
information. In addition, it is possible to make use of any<br>
of PCR, video, audio or other TS packets.<br>
[0052]<br>
Further, at reproduction, circumstances in which<br>
restoration is not possible can be avoided by ensuring that<br>
the entry point, which is the starting point for reproducing<br>
the content file, is not between a TS packet storing the<br>
restoration information and a packet that is to be restored.<br>
As in the type of transformation processing subsystem A2101<br>
shown in FIG. 21, for example, the content file can be analyzed<br>
in an analysis unit A2102, and the result of an analysis of<br>
the whereabouts of the entry point transmitted to a<br>
transformation control unit A2106. The transformation<br>
control unit A2106 can then set the transformation position<br>
and the multiplex position so that the entry point is not<br>
between the TS packet storing the restoration information<br>
and the packet that is to be restored.<br>
[0053]<br>
(Embodiment A3)<br>
36<br><br>
FIG. 22 is a block diagram showing main parts of a<br>
structure of a transformation processing subsystem A22 01 for<br>
executing transformation processing in an embodiment A3 of<br>
the present invention. The transformation processing<br>
subsystem A22 01 includes a transformation processing unit<br>
A22 04, a storage unit A22 05, a transformation control unit<br>
A2206, andan input unit A2207 . The transf ormationprocessing<br>
unit A2204 is connected to the recording medium A102 and the<br>
transformation control unit A2206, and executes<br>
transformation processing on specified content packets in<br>
the content file according to instructions from the<br>
transformation control unit A2206. The storage unit A2205<br>
is connected to the transformation processing unit A22 04 and<br>
the transformation control unit A2206, and stores, on the<br>
recording medium A108, the post-transformation transformed<br>
content file , the byte code data and a restoration information<br>
file, the latter two being received from the transformation<br>
control unit A2206. The transformation control unit A2206<br>
is connected to the input unit A22 07, and, based on data<br>
received from the input unit A2207, issues instructions for<br>
transformation processing to the transformation processing<br>
unit A2204. The transformation control unit A2206 also<br>
generates the byte code data and the restoration information<br>
file and transmits them to the storage unit A2205, the<br>
restoration information file including pieces of restoration<br>
information and the byte code data including processes and<br>
parameters for reversing the transformation corresponding<br>
to the transf ormationprocessing. The input unit A2207 inputs<br>
37<br><br>
data to specify the transformation processing.<br>
[0054]<br>
An operation of the trans formation processing subsystem<br>
A2201 having the kind of construction described above is<br>
described with reference to an operation flowchart of FIG.<br>
23 .<br>
In step SA23 01, various information is input into the<br>
transformation control unit A2206 from the input unit A2207.<br>
This information includes: transformation position<br>
information indicating the ordinal number, counted from the<br>
head of the content file, of a packet and the ordinal numbers<br>
of the bytes within the packet that are to be transformed;<br>
operation processing information indicating which operation<br>
of a set of operations including logic operations such as<br>
XOR and encryption methods such as AES is to be performed;<br>
an operation-use parameter for use in the operation<br>
processing; and an operation mode that is information for<br>
judging, on the basis of information specifying a reproducing<br>
terminal such as a terminal ID or the like, whether or not<br>
to perform restoration processing at a given reproducing<br>
terminal for reproducing the recording medium A205.<br>
[0055]<br>
Next, in step SA2 3 02, on the basis of the information<br>
input in step SA2301, the transformation control unit A2206<br>
generates the restoration information file that includes the<br>
restoration information and the byte code data. The<br>
transformation control unit A2206 transmits the<br>
transformation position information, the operation<br>
38<br><br>
processing information, and the operation-use parameter to<br>
the transformation processing unit A2204.<br>
Next, instep SA2303 , the transf ormationprocessingunit<br>
A2204 specifies a packet that is to be transformed, and<br>
specifies the transformation target data within the packet,<br>
on the basis of the transformation position information.<br>
[0056]<br>
Next, instep SA2304, the transf ormationprocessingunit<br>
A2204 executes operation processing using the operation-use<br>
parameter on the specified transformation target data. For<br>
example, when the operation processing is XOR, the<br>
transformation processing unit A2204 calculates the XOR sum<br>
of the transformation target data and the operation-use<br>
parameter, and overwrites the transf ormat ion target data with<br>
the resulting value. Note that the operation processing is<br>
not limited to using XOR, but may consist of another type<br>
of logic operation or encryption processing . Alternatively,<br>
the transformation target data may simply be overwritten with<br>
the operation-use parameter. If this is the case, the<br>
transformation processing unit A22 04 stores the<br>
transformation target data in the restoration information<br>
as a restoration-use parameter, before it is overwritten.<br>
To put this processing into practice, steps SA23 03 and SA23 04<br>
may be executed before step SA23 02.<br>
[0057]<br>
Next, in step SA2305, the storage unit A2205 stores the<br>
transformed content file, which has finished undergoing<br>
transformation processing, on the recording medium A108.<br>
39<br><br>
Next, in step SA23 06, the transformation control unit<br>
A22 06 transmits the restoration information file and the byte<br>
code data to the storage unit A2205, and the storage unit<br>
A2205 stores the received restoration information file and<br>
the byte code data on the recording medium A108 in individual<br>
files distinct from the transformed content file.<br>
[0058]<br>
Note that a plurality of transformation positions can<br>
be specified within one content file. When this is the case,<br>
in step SA23 01 operation processing and an operation-use<br>
parameter are input for each of the plurality of transformation<br>
positions, and transformation can be realized by repeating<br>
step SA23 02 to step SA23 04 for each of the plurality of<br>
transformation positions.<br>
Hereafter, the restoration information generated by the<br>
above operation flow is described. The restoration<br>
information is information used by the reproducing terminal<br>
to reverse the transformation processing, and includes<br>
information of the type shown in FIG. 24 . The byte code data,<br>
meanwhile, is the same as that described in the embodiment<br>
Al.<br>
[0059]<br>
A piece of restoration information A2401 of FIG. 24 is<br>
the information of the piece of restoration information A5 01<br>
with the "relative packet count" removed. Here, adescription<br>
of the remaining information is omitted, as it would resemble<br>
that of the embodiment A1. The transformation control unit<br>
A22 06 generates the restoration information file holding<br>
40<br><br>
pieces of restoration information A24 01 and corresponding<br>
packet ordinal numbers counted from the head of the content<br>
file, the packet ordinal numbers being for indicating which<br>
packet each piece of restoration information A2401 is to be<br>
used to restore.<br>
[0060]<br>
According to the above description, the transformation<br>
processing subsystem A2201 must store at least three files<br>
on the recording medium A108, these being the transformed<br>
content file, the byte code data, and the restoration<br>
information file, and at least these three files are included<br>
in the recording medium A2 05 via the process of the disc<br>
production system of FIG. 2.<br>
To assist in the comprehension of the effects of the<br>
present embodiment, an example of the operation of a<br>
reproducing terminal is described with reference to FIG. 26,<br>
which shows the main parts of its structure. A reproducing<br>
terminal A2601 reads byte code data A2 6 04 from the recording<br>
medium A205. Then, in the reproducing terminal A2601 at<br>
reproduction, a byte code processing unit A2610 analyzes the<br>
byte code data A2 6 04, acquires the secret parameters, and<br>
transmits the secret parameters and the terminal ID to a<br>
restoration processing unit A2606.<br>
[0061]<br>
Next, at reproduction, the reproducing terminal A2 601<br>
reads an encrypted content file A2602. Then, in the<br>
reproducing terminal A2601, a decryption unit A2 6 05 decrypts<br>
the encrypted content file A2602 and outputs the result to<br>
41<br><br>
the restoration processing unit A2606 as transformed content.<br>
Further, a restoration information reading unit A2 611 reads<br>
a restoration information file A2603 and successively outputs<br>
the pieces of restoration information A2401 corresponding<br>
to the read encrypted content file to the restoration<br>
processing unit A2 6 06 . The rest oration processing unit A2606<br>
decrypts the received pieces of restoration inf ormation A24 01<br>
using the corresponding secret parameters via an XOR operation<br>
or the like, and executes restoration processing based on<br>
each of the decryptedpieces of restoration inf ormation A2401.<br>
[0062]<br>
Next, the restoration processing unit A2606 outputs the<br>
restored content to a demultiplexer A2607, which converts<br>
the video and audio data of the content into a format that<br>
can be processed by a decoding unit A2609, and outputs the<br>
converted content information to a video buffer A2608. The<br>
decoding unit A2609 then carries out the processing associated<br>
with reproduction and output of the content.<br>
Thus, in the present embodiment, information relating<br>
to transformation processing implemented on the content file<br>
can be specified via the restoration information file and<br>
the byte code data, and transf ormation processing that differs<br>
from the encryption by the encryption subsystem A2 02 can be<br>
freely implemented on each content file.<br>
[0063]<br>
Note that, though in the restoration information file<br>
of FIG. 2 5 positions of the packets that are to be restored<br>
were indicated by a packet count from the head of the content<br>
42<br><br>
file, read-out time information that accompanies the TS<br>
packets may be used for this purpose.<br>
Moreover, though the byte code data was the same as that<br>
of the embodiment A1, byte code data which is the same as<br>
that of the embodiment A2 may be used instead, in which case<br>
a secret parameter identifying value would be added to each<br>
piece of restoration information A2401.<br>
[0064]<br>
Further, though each piece of restoration information<br>
A24 01 was encrypted as shown in FIG. 24, rather than each<br>
piece of restoration information A24 01 being encrypted<br>
individually, part or the whole of the restoration information<br>
file may be encrypted using a secret parameter.<br>
Further, though the restoration information reading<br>
unit A2 611 outputs the pieces of restoration information one<br>
at a time, it may instead output a plurality of pieces of<br>
restoration information together, with the ordinal numbers<br>
of the corresponding packets to be restored, each ordinal<br>
number being counted from the head packet. Here, rather than<br>
the ordinal numbers of the restoration target packets being<br>
counted from the head packet, the ordinal numbers may be<br>
converted to "relative packet counts" counted from the header<br>
packet in each read-off section of the content file.<br>
[0065]<br>
Further, the transformation position information input<br>
by the input unit A2207 and the input unit A107 may be read-off<br>
time information that accompanies the TS packets. Further,<br>
there is no need to specify the operation processing<br>
43<br><br>
information if the operations have been determined in advance .<br>
Further, the embodiments A1 and A3, or the embodiments<br>
A2 and A3, can be combined such that a transformed content<br>
file with multiplexed restoration information can be<br>
generated together with byte code data and a restoration<br>
information file. In such a case, as shown in FIG. 27, a<br>
transformation control unit A2706 transmits multiplex<br>
information and multiplex positions to a multiplexing unit<br>
A2703, and the multiplexing unit A2703 multiplexes the<br>
multiplex information with a content file. Further, the<br>
transformation control unit A2706 generates the byte code<br>
data and the restoration information file and transmits them<br>
to a storage unit A2705. The storage unit A2705 stores at<br>
least three files, including the transformed content file,<br>
the byte code data and the restoration information file, on<br>
the recording medium A108. With this method, a reproducing<br>
terminal can use either the restoration information<br>
multiplexed with the transformed content file or the<br>
restoration information of the restoration information file,<br>
and can therefore select the restoration information that<br>
is easier to use when executing reproduction.<br>
[0066]<br>
Further, though all the embodiments have been described<br>
on the basis of MPEG 2 being used, they are not limited to<br>
using MPEG 2 , and the same effects can be obtained using other<br>
encoding methods.<br>
(Conclusion)<br>
44<br><br>
In recent years, as the capacity of storage media has<br>
increased, systems in which content that is a work such as<br>
a movie is converted into digital form and stored in media,<br>
such as digital optical discs or the like, have become<br>
widespread. In such systems, it is necessary that the<br>
copyright of the content is protected and that reproduction<br>
and copying of the content are practiced only within limits<br>
based on an agreement with the copyright holder. Regular<br>
systems to protect copyright material from being<br>
unauthorizedly copied or the like without permission from<br>
the copyright holder include arrangements in which the digital<br>
content is encrypted using a content key managed by the<br>
copyright holder. The encrypted digital content is then<br>
stored on a disc and can only be decrypted by terminals holding<br>
a corresponding content key. For a user to obtain the content<br>
key, rules established between the user and the copyright<br>
holder must be followed.<br>
[0067]<br>
As an example of this kind of system, in patent document<br>
2 a method is disclosed in which the content key for encrypting<br>
and decrypting the content data is protectedby being generated<br>
based on a function of seed keys and time variable data.<br>
When this technique is used, there is a requirement that<br>
the content key be strictly managed so as not to be exposed<br>
to an outside party. However, there may be times when, via<br>
some accident or incident, the content key is exposed to an<br>
unauthorized party. Once the content key has been exposed<br>
to the unauthorized party, there is a danger that the content<br>
45<br><br>
keys for subsequent content will be discovered using the same<br>
method. Consequently, it can be presumed that unauthorized<br>
use of subsequent content could not be prevented. With<br>
conventional techniques, the content data is susceptible to<br>
attacks of this type because its sole protection is a content<br>
key protected via the specified method.<br>
[0068]<br>
In view of this problem, an object of the present<br>
invention is to provide a recording medium for protecting<br>
content in such a way that even if, by some accident or incident,<br>
a method to break the content protection is discovered once,<br>
the same method cannot be used for unauthorizedly making use<br>
of other content, and further to provide a data generating<br>
method and a data generating device for generating this"<br>
content.<br>
A further object of the present invention is to provide<br>
a recording medium capable of specifying, from content whose<br>
content protection method has been broken and which is<br>
unauthorizedly circulating in a form that canbe used by anyone,<br>
the unauthorized reproducing device that was able to break<br>
the content protection, and further to provide a data<br>
generating method and a data generating device for generating<br>
this content.<br>
[0069]<br>
To solve the above problems, the present invention<br>
provides a recording medium having data recorded thereon,<br>
wherein the data is content data protected by data<br>
transformation and by encryption using a content key, the<br>
46<br><br>
data transformation being an operation distinct from the<br>
encryption.<br>
Further the present invention provides the recording<br>
medium further having at least a program recorded thereon,<br>
wherein the program is for calculating a parameter required<br>
for restoring the content data.<br>
[0070]<br>
Further the present invention provides the recording<br>
medium further having restoration information recorded<br>
thereon, wherein the restoration information is required for<br>
restoring the content data, and is multiplexed with the content<br>
data.<br>
Further, the present invention provides the recording<br>
medium further having restoration information recorded<br>
thereon, wherein the restoration information is required for<br>
restoring the content data, and is recorded as a different<br>
file from the content data.<br>
Further, the present invention provides the recording<br>
medium further having restoration information recorded<br>
thereon, wherein the restoration information is required for<br>
restoring the content data, and is both multiplexed with the<br>
content data and recorded as a different file from the content<br>
data.<br>
[0071]<br>
Further the present invention provides the recording<br>
medium, wherein part or all of the restoration information<br>
is encrypted using the parameter.<br>
Further, the present invention provides a data<br>
47<br><br>
generating method for implementing operations on content data,<br>
including a step of implementing, on part or all of the content<br>
data, a transformation operation distinct from encryption<br>
using a content key.<br>
[0072]<br>
Further, the present invention provides the data<br>
generating method further including a step of generating a<br>
program for a data processing device to calculate a parameter<br>
required for restoring the content data.<br>
Further, the present invention provides the data<br>
generating method further including the steps of: generating<br>
a program for a data processing device to calculate a parameter<br>
required for restoration processing of the content data;<br>
generating restoration information required for the<br>
restoration processing; encrypting the restoration<br>
information using the parameter; and multiplexing the<br>
encrypted restoration information with the content data.<br>
[0073]<br>
Further, the present invention provides the data<br>
generating method further including the steps of: generating<br>
a program for a data processing device to calculate a parameter<br>
required for restoration processing of the content data;<br>
generating restoration information required for the<br>
restoration processing; encrypting the restoration<br>
information using the parameter; and generating the encrypted<br>
restoration information as a different file from the content<br>
data.<br>
[0074]<br>
48<br><br>
Further, the present invention provides the data<br>
generating method further including the steps of : generating<br>
a program for a data processing device to calculate a parameter<br>
required for restoration processing of the content data;<br>
generating restoration information required for the<br>
restoration processing; encrypting the restoration<br>
information using the parameter; multiplexing the encrypted<br>
restoration information with the content data; and generating<br>
the encrypted restoration information as a different file<br>
from the content data.<br>
[0075]<br>
Further, the present invention provides a data<br>
generating device for implementing operations on content data,<br>
including a unit operable to implement, on part or all of<br>
the content data, a transformation operation distinct from<br>
encryption using a content key.<br>
Further, the present invention provides the data<br>
generating device further including: a unit operable to<br>
generate a program for a data processing device to calculate<br>
a parameter required for restoration processing of the content<br>
data; a unit operable to generate restoration information<br>
required for the restoration processing; a unit operable to<br>
encrypt the restoration information using the parameter; and<br>
a unit operable to multiplex the encrypted restoration<br>
information with the content data.<br>
[0076]<br>
Further, the present invention provides the data<br>
generating device further including: a unit operable to<br>
49<br><br>
generate a program for a data processing device to calculate<br>
a parameter required for restoration processing of the content<br>
data; a unit operable to generate restoration information<br>
required for the restoration processing; a unit operable to<br>
encrypt the restoration information using the parameter; and<br>
a unit operable to generate the encrypted restoration<br>
information as a different file from the content data.<br>
[0077]<br>
Further, the present invention provides the data<br>
generating device further including: a unit operable to<br>
generate a program for a data processing device to calculate<br>
aparameter required for restoration processing of the content<br>
data; a unit operable to generate restoration information<br>
required for the restoration processing; a unit operable to<br>
encrypt the restoration information using the parameter; a<br>
unit operable to multiplex the encrypted restoration<br>
information with the content data; and a unit operable to<br>
multiplex the encrypted restoration information as a<br>
different file from the content data.<br>
[0078]<br>
Further, the present invention provides a program<br>
causing a computer to execute the one or more steps included<br>
in the data generating method.<br>
Further, the present invention provides a computer<br>
readable recording medium having recorded thereon a program<br>
for causing a computer to execute the one or more steps in<br>
the data generating method.<br>
As described above, the present invention has the effect<br>
50<br><br>
of providing a recording medium on which content is protected<br>
from being reproduced unauthorizedly, even when by some<br>
accident or incident the content key has been divulged and<br>
circulated among an unspecified large number of devices, and<br>
further to provide a data protection method, a data generating<br>
method, and a data generating device for generating this<br>
content.<br>
[0079]<br>
Further, content can be generated from which, if its<br>
content protection has been broken and it is unauthorizedly<br>
circulating in a form that can be used by anyone, the<br>
reproducing device that was able to break its content<br>
protection can be specified.<br>
2. Embodiment B: Content Reproducing Device<br>
(Embodiment Bl)<br>
FIG. 2 8 shows a structure of a recording medium B101<br>
and a content reproducing device B102 pertaining to one<br>
embodiment of the present invention.<br>
[0080]<br>
Recorded on the recording medium B101 is reproduction<br>
control information Bill, a byte code B112 , protected content<br>
data B113, an encrypted content key B114, and revocation<br>
information B115 . While the recording medium B101 is assumed<br>
to be a BD (Blu-ray Disc) as one example here, it is not limited<br>
to being so.<br>
It is assumed in the present embodiment that one set<br>
of content is composed of a plurality of MPEG 2 TSs (Motion<br>
51<br><br>
Picture Expert Group 2 Transport Streams). It is the<br>
reproduction control information Bill that stipulates the<br>
reproduction order of the protected content data B113 when<br>
the content is reproduced.<br>
[0081]<br>
The byte code B112 is an execution code composed of an<br>
instruction set of a set length, such as a JAVA byte code.<br>
The byte code B112 may have been subject to processing such<br>
as obfuscation in order to prevent the secret information<br>
and processing content of the software from being ascertained<br>
by an act of analysis. In such a case, a byte code execution<br>
unit B124 has a function of removing processing such as<br>
obfuscation. Execution of the byte code B112 is described<br>
in detail later. Note that while an example of a JAVA byte<br>
code is given in the present embodiment, an execution program<br>
other than JAVA may be used.<br>
[0082]<br>
The protected content data B113 is plaintext MPEG 2 TS<br>
data that can be output as video by a decoder, and has been<br>
subject to encryption processing with a content key, and<br>
further to data transformation processing, for example part<br>
of the data being substituted with a different value. For<br>
this reason, in order to reproduce the protected content data<br>
B113, in addition to decryption processing with the content<br>
key, it is necessary to subject the protected content data<br>
B113 to restoration processing to overwrite (replace) the<br>
substituted data with appropriate data, thereby restoring<br>
the protected content data B113 to plaintext MPEG 2 TS data.<br>
52<br><br>
[0083]<br>
The encrypted content key B114 is data of a content key<br>
that is for decrypting the protected content data and that<br>
has been encrypted with a media key. The media key is described<br>
later.<br>
The following describes the revocation information B115 .<br>
A key management organization has a collection of a plurality<br>
of device keys and a plurality of media keys. The key<br>
management organization assigns, to each content reproducing<br>
device B102, one device key and a key identification number<br>
of the device key, and gives the assigned device key and key<br>
identification number to the content reproducing device B102 .<br>
Furthermore, the key management organization assigns one<br>
media key to the recording medium B101. Next, the key<br>
management organization encrypts the media key using each<br>
of the device keys assigned respectively to the content<br>
reproducing devices B102 , thereby generating encrypted media<br>
keys, and creates a list of all of the encrypted media keys<br>
and the key identification numbers corresponding to the device<br>
keys. This list is the revocation information B115. Note<br>
that since a drawback of this simple method is that the data<br>
size of the revocation information B115 is unrealistically<br>
large when there is a large number of content reproducing<br>
devices B102, a method that compresses the data size of the<br>
revocation information B115 disclosed in "Key Management<br>
System for Digital Content Protection" (Nakano, Ohmori, and<br>
Tatebayashi, The 2 0 01 Symposium on Cryptography and<br>
Information Security SCIS2 001 5A-5, Jan. 2 001) may be used.<br>
53<br><br>
However, the method is not limited to this method, and another<br>
method may be used to compress the data size of the revocation<br>
information B115.<br>
[0084]<br>
The content reproducing device B102 is composed of a<br>
disc reading unit B121, a reproduction control unit B122,<br>
a user operation reception unit B123, a byte code execution<br>
unitB124, a stream decryption unit B125 , a content restoration<br>
processing unit B126, a demultiplexing unit B127, a video<br>
decoder B12 8, an audio decoder B12 9, a content key generation<br>
unit B13 0, a revocation information processing unit B131,<br>
a device key storage unit B132, a device unique information<br>
storage unit B133, a stream analysis unit B134, and a packet<br>
decryption unit B135.<br>
[0085]<br>
One example of implementation of the content reproducing<br>
device B102 is a computer system composed of a CPU, a work<br>
memory, a flash memory, a BD drive, and a remote control.<br>
Here, the disc reading unit B121 is the BD drive, the device<br>
key storage unit B13 2 and the device unique information storage<br>
unit B133 are the flash memory, the user operation reception<br>
unit B123 is the remote control, and the reproduction control<br>
unit B122, the byte code execution unit B124, the stream<br>
decryption unit B12 5 , the content restoration processing unit<br>
B12 6, the demultiplexing unit B12 7, the video decoder B12 8,<br>
the audio decoder B12 9, the content key generation unit B13 0,<br>
the revocation information processing unit B131, the stream<br>
analysis unit B134, and the packet decryption unit B135 are<br>
54<br><br>
software that operates using the CPU and. the work memory as<br>
one example of a structure. However, these are not limited<br>
to being structured by software, and may be implemented in<br>
hardware or the like.<br>
[0086]<br>
This completes the description of the structure of the<br>
recording medium and the content reproducing device of an<br>
embodiment of the present invention.<br>
(Description of Content Reproduction Processing)<br>
The following describes content reproduction<br>
processing, with use of FIG. 29.<br>
First, the content reproduction processing starts upon<br>
the user operation reception unit B123 receiving a content<br>
reproduction start request from a user.<br>
[0087]<br>
When the content reproduction request is received, the<br>
revocation information processing unit B131 performs<br>
revocation confirmation processing with respect to the<br>
content reproducing device B102 (stepSB201). Details of the<br>
revocation confirmation processing are given later.<br>
Subsequently, the processing branches depending on<br>
whether or not generation of the media key succeeds in the<br>
revocation confirmation processing at step SB2 01 (step<br>
SB202) .<br>
[0088]<br>
When the generation of the media key succeeds in the<br>
revocation confirmation processing at step SB2 01, the<br>
55<br><br>
encrypted content key B114 is read from the recording medium<br>
B101, and a content key is generated (step SB2 03) . Details<br>
of the content key generation are given later.<br>
When the generation of the media key fails in the<br>
revocation confirmation processing at step SB2 01, the user<br>
is notified that the content reproducing device B102 is revoked,<br>
and the processing ends (step SB210).<br>
[0089]<br>
After step SB2 03, in order to reproduce the content<br>
requested by the user, the reproduction control unit B122<br>
instructs starting of reading of the protected content data<br>
B113 that is the target of reproduction, in compliance with<br>
the reproduction control information Bill read from the<br>
recording medium B101 (step SB204).<br>
When reading of the protected content data B113 has<br>
started, the stream decryption unit B12 5 performs decryption<br>
processing as necessary with respect to the protected content<br>
data B113 read from the recording medium B101, with use of<br>
the content key generated by the content key generation unit<br>
B13 0 (stepSB2 06) . Hereinafter, the data obtained as a result<br>
of decrypting the protected content data B113 is called<br>
transformed content data. The protected content data is<br>
encrypted using AES (Advanced Encryption Standard), but is<br>
not limited to being so. Since decryption processing is<br>
performed repeatedly during content reproduction until the<br>
protected content data B113 ends, decryption of TS packets<br>
for restoration processing (described later) (step SB207),<br>
restoration of transformed content (step SB2 08), and<br>
56<br><br>
reproduction of content data (step SB2 09) are executed in<br>
parallel.<br>
[0090]<br>
Next, the packet decryption unit B13 5 decrypts the<br>
restoration-use TS packets multiplexed with the transformed<br>
content data, in coordination with the stream analysis unit<br>
B134 and the byte code execution unit B124 (step SB2 07).<br>
Decryption of the protected content data B113 (step SB2 06),<br>
restoration of transformed content data (described later)<br>
(step SB2 08) , and reproduction of content data (step SB2 09)<br>
are executed in parallel during content reproduction.<br>
Details of restoration processing-use TS packets and<br>
decryption processing are given later.<br>
[0091]<br>
Next, the content restoration processing unit B126<br>
performs restoration processing of the transformed content<br>
data (step SB2 08). During content reproduction, the<br>
restoration processing at step SB208 is executed in parallel<br>
with decryption processing of the protected content data B113<br>
(step SB206), decryption of the restoration processing-use<br>
TS packets (step SB2 07) , and reproduction of the content data<br>
(described later) (step SB209) . Details of restoration<br>
processing of the transformed content data are given later.<br>
[0092]<br>
The restored content data is plaintext MPEG 2 TS data,<br>
which is separated into a video stream and an audio stream<br>
in the demultiplexing unit B127, and the video stream and<br>
the audio stream are transmitted to the video decoder B12 8<br>
57<br><br>
and the audio decoder B129, respectively, and output to an<br>
audio/video device such as a television (step SB2 09).<br>
Decryption of the protected content data B113 (step SB2 06),<br>
decryption of the restoration processing-use TS packets (step<br>
SB207), and restoration of transformed content data (step<br>
SB2 08) are executed in parallel during content reproduction.<br>
[0093]<br>
The processing ends when all the protected content data<br>
B113 corresponding to the content requested by the user has<br>
been read and reproduction is complete (step SB2 05).<br>
This completes the description of the content<br>
reproduction processing.<br>
(Revocation Confirmation Processing with respect to the<br>
Content Reproducing Device B102)<br>
The following describes revocation confirmation<br>
processing with respect to the content reproducing device<br>
B102, with use of FIG. 30. This processing is the details<br>
of the processing at step SB201.<br>
[0094]<br>
Revocation confirmation processing is processing for,<br>
before content reproduction, confirming according to the<br>
revocation information B115 recorded on the recording medium<br>
B101 that the content reproducing device B102 has not been<br>
revoked.<br>
The revocation information processing unit B131 reads<br>
the device key obtained from the device key storage unit B13 2<br>
(step SB301).<br>
58<br><br>
[0095]<br>
Next, the revocation information processing unit B131<br>
reads the revocation information B115 recorded on the<br>
recording medium B101 (step SB3 02), and generates a media<br>
key using the read device key and the revocation information<br>
B115 (step SB3 03) . Note that in the case of the content<br>
reproducing device B102 being revoked, a media key is unable<br>
to be generated. Generation of the media key using the device<br>
key and the revocation information B115 is described in detail<br>
in "National Technical Report, Vol. 43, No. 3, p. 118-122"<br>
(Matsushita Techno Research, June 18, 1997).<br>
[0096]<br>
This completes the description of the revocation<br>
confirmation processing with respect to the content<br>
reproducing device B102.<br>
(Content Key Generation Processing)<br>
The following describes the content key generation<br>
processing with use of FIG. 31. This processing is the details<br>
of the processing at step SB203.<br>
The content key generation unit B13 0 obtains the media<br>
key generated at step SB201 from the revocation information<br>
processing unit B131 (step SB4 01). Next, the content key<br>
generation unit B13 0 reads the encrypted content key B114<br>
from the recording medium B101, and decrypts the encrypted<br>
content key B114 with the media key obtained at step SB4 01<br>
(step SB4 02). In the present embodiment, encryption and<br>
decryption of the content key are performed using AES, but<br>
59<br><br>
are not limited to being so.<br>
[0097]<br>
This completes the description of the content key<br>
generation processing.<br>
(Decryption of Restoration Processing-use TS Packets)<br>
The following describes details of the restoration<br>
processing-use TS packet decryption processing of step SB207 ,<br>
with use of FIG. 32.<br>
Firstly, FIG. 34 shows an example of transformed content<br>
data output by the stream decryption unit B125. The<br>
transformed content data complies with transport streams as<br>
stipulated in the MPEG 2 system, and has restoration<br>
processing-use TS packets B701, video data-use TS packets<br>
B702, audio data-use TS packets B703 and the like multiplexed<br>
therewith. In the present embodiment, transformation<br>
processing is applied to the payload of the video data-use<br>
TS packets, but is not limited to being so.<br>
[0098]<br>
The stream analysis unit B134 analyzes each TS packet<br>
of the transformed content data output by the stream decryption<br>
unit B12 5, and checks the PIDs of the TS packet headers in<br>
order to confirm the type of each TS packet (step SB501).<br>
The processing branches to step SB5 03 when an analyzed<br>
TS packet is a restoration processing-use TS packet, and to<br>
step SB5 0 6 when the analyzed TS packet is any other type of<br>
TS packet (step SB5 02).<br>
[0099]<br>
60<br><br>
The following describes a data structure of a restoration<br>
processing-use TS packet with use of FIG. 35 . In the present<br>
embodiment, a PMT stipulated in the MPEG 2 system is used<br>
as a restoration processing-use TS packet. Specifically, a<br>
restoration instruction descriptor B8 05 is written at the<br>
head of a descriptor first loop B8 04 in a PMT section B8 02.<br>
FIG. 3 6 shows a data structure of the restoration<br>
instruction descriptor B805. The restoration instruction<br>
descriptor B805 includes restoration information B913. The<br>
restoration inf ormationB913 is composed of a secret parameter<br>
identifying value B921, a restoration instruction flag B922 ,<br>
a device unique information reference position B923, a<br>
relative packet count B924, an in-packet position B925, a<br>
byte size of restoration target data B926, and a<br>
restoration-use parameter B927. Except for the secret<br>
parameter identifyingvalueB921, the restoration information<br>
B913 is encrypted according to AES using a secret parameter.<br>
Note that the restoration information B913, excluding the<br>
secret parameter identifying value B921, may be encrypted<br>
using a method other than AES, such as dividing the restoration<br>
information B913 into secret parameter units and finding an<br>
XOR of each with the secret parameter. The secret parameter<br>
is an encryption key of the restoration information B913 and<br>
is held by the byte code B112.<br>
[0100]<br>
The following describes a data structure of the<br>
restoration information B913 . The secret parameter<br>
identifying value B921 is a value that specifies a secret<br>
61<br><br>
parameter that is used in subsequent encryption of the<br>
restoration information B913. The restoration instruction<br>
flag B922 is a flag that shows whether or not to perform<br>
restoration using this restoration processing-use packet,<br>
the possible values thereof having the meanings shown in FIG.<br>
37. The restoration instruction flag B922 may be omitted.<br>
In the case of the restoration instruction flag B922<br>
instructing "10 (device unique information embedment) " , the<br>
device unique information reference position B923 shows a<br>
bit position to be referenced in the device unique information.<br>
The relative packet count B924 and the in-packet position<br>
B925 are information for specifying where the data is<br>
transformed, the position where the data is transformed being<br>
shown as a relative posit ion to the restoration processing-use<br>
TS packet. The in-packet position B925 shows that a<br>
transformed TS packet is located, counting from the next TS<br>
packet after the restoration processing-use TS packet, the<br>
number of packets listed in the relative packet count B924.<br>
The in-packet position B925 additionally shows that<br>
transformation processing has been applied to data, the head<br>
of which is the number of bytes shown by the in-packet position<br>
B925 from the head of the TS packet payload of the TS packet.<br>
The byte size of restoration target data B926 shows the number<br>
of bytes of the transformed data. The restoration-use<br>
parameter B92 7 is data used in restoring the transformed data.<br>
This completes the description of the data structure of the<br>
restoration processing-use TS packets.<br>
[0101]<br>
62<br><br>
The description of the processing in FIG. 32 continues.<br>
When the TS packet is judged tobe a restoration processing-use<br>
TS packet B701 at step SB502, the stream analysis unit B134<br>
transmits a "number of packets from the head" that shows which<br>
number TS packet the restoration processing-use TS packet<br>
is from the head of the protected content data, to the byte<br>
code execution unit B124, and transmits the restoration-use<br>
TS packet to the packet decryption unit B13 5 (step SB503) .<br>
In the present embodiment, the stream analysis unit B134 keeps<br>
count of the number of read packets from start of reading<br>
data of the protected content, to manage the "number of packets<br>
from the head".<br>
[0102]<br>
At the start of reproduction, the byte code execution<br>
unit B124 reads, in advance, the byte code B112 from the<br>
recording medium B101 and the device unique information from<br>
the device unique information storage unit B133, and, having<br>
received the "number of packets from the head" from the stream<br>
analysis unit B134, executes the byte code B112, determines<br>
the secret parameter B1103 that corresponds to the "number<br>
of packets from the head" , and transmits the determined secret<br>
parameter B1103 to the packet decryption unit B13 5 (stepSB504) .<br>
Specifically, the byte code B112 holds a secret parameter<br>
table shown in FIG. 38, and the byte code execution unit B124,<br>
by executing the byte code B112 , transmits the several secret<br>
parameter identifying values B1102 that occur before and after<br>
the record corresponding to the "number of packets from the<br>
head" received from the stream analysis unit B134, the secret<br>
63<br><br>
parameters B1103, and the device unique information, to the<br>
packet decryption unit B13 5 . By transmitting a plurality of<br>
secret parameters B1103 at once, the number of times that<br>
the processing at steps SB503 and SB504 is executed can be<br>
reduced, and the processing load on the content reproducing<br>
device B102 can be reduced. Note that the device unique<br>
information is, for instance, 16-byte data composed of "device<br>
manufacturer ID + reproducing device model number +<br>
reproducing device manufacturing serial number", and is<br>
information that is unique to each content reproducing device<br>
B102.<br>
[0103]<br>
Next, the packet decryption unit B13 5 selects, fromamong<br>
the plurality of secret parameters B1103 obtained from the<br>
byte code execution unit B124, a secret parameter B1103 that<br>
matches the secret parameter identifying value B921 in the<br>
restoration-use TS packet B7 01 received from the stream<br>
analysis unit B134, and decrypts the restoration information<br>
B913 (step SB505) . Note that if the number of secret<br>
parameters 1103 that are obtained from the byte code execution<br>
unit B124 is restricted to being one, the secret parameter<br>
identifying value B921 of the restoration information B913<br>
may be omitted.<br>
[0104]<br>
Finally, the decrypted restoration processing-use TS<br>
packet B701, or the packet other than this, is transmitted<br>
to the content restoration processing unit B126 (step SB506) ,<br>
and the processing ends.<br>
64<br><br>
This completes the description of the restoration<br>
processing-use TS packet decryption processing of step SB2 07 .<br>
(Transformed Content Data Restoration)<br>
The following describes details of the transformed<br>
content data restoration processing of step SB208 by the<br>
content restoration processing unit B12 6, with use of FIG.<br>
33 .<br>
[0105]<br>
The content restoration processing unit B126 receives<br>
the transformed content data, and starts restoration<br>
processing of the transformed content data. The content<br>
restoration processing unit B126 checks the PID in the TS<br>
packet header of the input TS packet (step SB6 01), and<br>
determines the TS packet type (step SB602).<br>
When the received TS packet is a restoration<br>
processing-use TS packet B701, the content restoration<br>
processing unit B126 checks and stores the restoration<br>
instruction flag B922 in the restoration instruction<br>
descriptor B805 (step SB603) . In the case in which the<br>
restoration instruction flag B922 is omitted, it is assumed<br>
that restoration is to be performed.<br>
[0106]<br>
When restoration is to be performed, the content<br>
restoration processing unit B126 specifies a transformation<br>
position of the data based on the relative packet count B924<br>
and the in-packet position B925 in the restoration information<br>
B913 in the restorationprocessing-use TS packet (stepSB604) .<br>
65<br><br>
Next, the content restoration processing unit B126<br>
obtains the restoration-use parameter from the<br>
restoration-use parameter B927 in the restoration information<br>
B913 in the restorationprocessing-use TSpacket (stepSB605) .<br>
[0107]<br>
The content restoration processing unit B12 6 resets a<br>
packet read count that is an internal variable held by the<br>
content restoration processing unit B126 , in order to specify<br>
the transformation position in the succeeding TS packet (step<br>
SB606), and ends the processing.<br>
When the packet type is a type other than a restoration<br>
processing-use packet at step SB602, the content restoration<br>
processing unit B126 checks the restoration instruction flag<br>
in the restoration processing-use TS packet held at step SB603<br>
(step SB607).<br>
[0108]<br>
When the result of step SB607 indicates that restoration<br>
is performed, the content restoration processing unit B126<br>
increments the packet read count (step SB6 08), and checks<br>
whether or not the packet read count and the transformation<br>
position match (step SB609) . When the result of step SB607<br>
indicates that restoration is not performed, the content<br>
restoration processing unit B126 ends the processing.<br>
When the packet read count and the transformation<br>
position match, the content restoration processing unit B126<br>
specifies the transformed data based on the in-packet position<br>
B925 specified at step SB604, subjects the data to a data<br>
operation using the parameter obtained at step SB605 (step<br>
66<br><br>
SB610) , and ends the processing. When the packet read count<br>
and the transformation position do not match, the content<br>
restoration processing unit B126 ends the processing.<br>
[0109]<br>
This completes the description of the transformed<br>
content data restoration processing of step SB2 0 8 by the<br>
content restoration processing unit B126.<br>
Note that although a restoration instruction descriptor<br>
B8 05 is listed in all PMTs included in the protected content<br>
data in the present embodiment, it is not necessary to include<br>
a restoration instruction descriptor B805 in all PMTs. In<br>
such a case, processing is performed having judged in the<br>
restoration instruction checking at step SB6 03 that PMTs that<br>
do not include a restoration instruction descriptor B8 05 do<br>
not require restoration processing. Furthermore, in the<br>
present embodiment, the description position of the<br>
restoration instruction descriptor B805 is set as being first<br>
in the descriptor first loop in the PMT section in order to<br>
make analysis processing of restoration processing-use TS<br>
packets easy in hardware. However, the restoration<br>
instruction descriptor may be at another description position<br>
in the descriptor first loop, and may be variable.<br>
[0110]<br>
Furthermore, although in the present embodiment the<br>
restoration processing-use TS packets are realized using PMTs<br>
stipulated by the MPEG 2 system, the TS packets may be realized<br>
according to another method. For instance, as shown in FIG.<br>
39, a TS packet that is assigned a new PID, and that is not<br>
67<br><br>
a problem in the MPEG system, may be provided, and the<br>
restoration instruction descriptor B805 may be described in<br>
a private section thereof. Alternatively, as shown in FIG.<br>
40, PATs specified in the MPEG 2 system may be used as<br>
restoration processing-use TS packets . In such a case, anew<br>
section is added, and the restoration instruction descriptor<br>
B8 05 is described in the new section. As a further alternative,<br>
PCRs may be used as restoration processing-use TS packets.<br>
[0111]<br>
Furthermore, as shown in FIG. 41, an adaptation field<br>
may be added to a PMT, a PAT, a PCR, or the like, and restoration<br>
information B913 may be described as private_data_byte . Note<br>
that in a case in which an adaptation field is added to the<br>
video data-use TS packet and the restoration information B913<br>
is described therein, instead of using the PID for confirming<br>
the packet type in the PID check (steps SB501, SB6 01) and<br>
packet type judgment (steps SB5 02, SB6 02) in FIGS. 3 2 and<br>
33, it is checked whether or not the restoration information<br>
B913 is described in the adaptation field of the TS packet.<br>
Here, packets in which the restoration information B913 is<br>
described are judged to be restoration processing-use TS<br>
packets.<br>
[0112]<br>
Furthermore, in the present embodiment, at step SB5 04<br>
in FIG. 32, a plurality of secret parameters B1103 for<br>
decrypting the restoration processing-use packet B701 are<br>
sent at once by the byte code execution unit B124 to the packet<br>
decryption unit B135. However, it is possible to transmit<br>
68<br><br>
only one secret parameter B1103 that is of the record<br>
corresponding to the "number of packets from head" received<br>
from the stream analysis unit B134. A further alternative<br>
method is to omit the processing at steps SB5 03 and SB5 04<br>
during reproduction, by transmitting all secret parameters<br>
B1103 in the secret parameter table to the packet decryption<br>
unit B135 at initialization of reproduction processing.<br>
[0113]<br>
Furthermore, in the present embodiment, although a<br>
"number of packets from the head of the protected content<br>
data" (B1101) is used for specifying, in the secret parameter<br>
table held by the byte code, the secret parameter B1103 used<br>
in decryption of the restoration processing-use TS packet<br>
B701, any other type of information, such as a logical sector<br>
number at which the restoration processing-use TS packet B701<br>
is recorded or read timing data attached to each TS packet,<br>
may be used instead, as long as a packet in the stream can<br>
be uniquely specified.<br>
[0114]<br>
(Embodiment B2)<br>
FIG. 42 shows a structure of a recording medium B101<br>
and a content reproducing device B102 pertaining to an<br>
embodiment of the present invention.<br>
Since the embodiment B2 is essentially the same as the<br>
embodiment B1, aspects that differ from the embodiment B1<br>
are described.<br>
[0115]<br>
The recording medium B101 is the same in that it subjects<br>
69<br><br>
plaintext MPEG 2 TS data that is able to be output as video<br>
by a decoder to encryption processing using a content key,<br>
and that the data is data that has been subject to data<br>
transformation processing by replacing part of the data with<br>
a different value, for instance. However, restoration<br>
information for restoring the transformation is not<br>
multiplexed with the protected content data B113. Instead,<br>
restoration information that was multiplexed in the<br>
embodiment Bl is compiled into one file, and recorded as a<br>
restoration information file B116.<br>
[0116]<br>
FIG. 43 shows a data structure of the restoration<br>
information file B116 . The restoration information file B116<br>
is composed of a protected content data name B16 01, packet<br>
position information B1602, a restoration information<br>
identifying value B16 03 , and restoration information B1604 .<br>
The protected content data name B1601 is the file name of<br>
the protected content data B113 that is the restoration target.<br>
The packet position information B16 02 is information that<br>
specifies TS packets in the protected content data that are<br>
a restoration target, and in the present embodiment the<br>
relative position from the head packet is expressed in terms<br>
of a number of packets. However any other information may<br>
be used if it enables the packet to be specified, an example<br>
being time information that shows a timing with which the<br>
TS packet is transmitted to the demultiplexing unit B12 7 in<br>
the content reproducing device B102. The restoration<br>
information identifying value B16 03 is information for<br>
70<br><br>
identifying the restoration information B1604 . FIG. 44 shows<br>
a data structure of the restoration information B1604. An<br>
in-packet position B1701 is information for specifying the<br>
place where the data is transformed. The in-packet position<br>
B1701 shows that transformation processing has been applied<br>
to data at a position starting from the byte count shown in<br>
the in-packet position B1701 from the head of the TS packet<br>
payload. A byte size of restoration target data B1702 shows<br>
how many bytes of data are transformed. A restoration-use<br>
parameter B17 03 is data used in restoring the transformed<br>
data. The restoration information file B116 is protected by<br>
being encrypted with the held secret parameter, but may be<br>
protected using another method.<br>
[0117]<br>
The content reproducing device B102 is the same as in<br>
the embodiment Bl, except for not having the packet decryption<br>
unit B135.<br>
(Description of Content Reproduction Processing)<br>
Content reproduction processing is described with use<br>
of FIG. 45. Since the content reproduction processing is<br>
essentially the same as the embodiment B1, aspects that differ<br>
from the embodiment Bl are described. Other than the exclusion<br>
of the processing at step SB2 07, the processing is the same<br>
as in FIG. 29. However, the details of the transformed content<br>
data restoration at step SB2 08 are different.<br>
[0118]<br>
(Transformed Content Data Restoration)<br>
71<br><br>
The following describes details of the transformed<br>
content data restoration processing with use of FIG. 46. This<br>
processing is the details of step SB2 08 in the embodiment<br>
B2 .<br>
The stream analysis unit B134 analyzes each TS packet<br>
in the transformed content data output from the stream<br>
decryption unit B125, and transmits information specifying<br>
the TS packets, to the byte code execution unit B124 (step<br>
SB1901). Specifically, the stream analysis unit B134<br>
transmits the file name of the protected content data being<br>
read, and the relative position information of the TS packets<br>
from the head packet of the protected content data. In the<br>
present embodiment, information that expresses the relative<br>
position from the head packet for specifying the TS packet<br>
as a number of packets is used. However, any other information,<br>
such as time information that shows the timing of transmission<br>
to the demultiplexing unit B127, may be used as long as it<br>
enables the TS packets to be specified.<br>
[0119]<br>
Before the start of reproduction, the byte code execution<br>
unit B124 reads the byte code B112 and the restoration<br>
information file B116 from the recording medium B101 and the<br>
device unique information from the device unique information<br>
storage unit B133, executes the byte code B112 with a timing<br>
at which the information specifying the TS packets is received,<br>
and outputs a restoration-use parameter (step SB19 02).<br>
Specifically, after decrypting the restoration information<br>
file B116 using the secret parameter stored by the byte code<br>
72<br><br>
B112 itself, the byte code B112 retrieves, from the restoration<br>
information file B116, a piece of restoration information<br>
B1604 corresponding to the information that specifies the<br>
TS packet received from the stream analysis unit B134, and<br>
transmits the piece of restoration information B16 04 to the<br>
content restoration processing unit B126.<br>
[0120]<br>
Next, the content restoration processing unit B126<br>
refers to the receivedpiece of restoration information B1604 ,<br>
specifies the in-packet position B1701 of the restoration<br>
target data, restores the content data by replacing with the<br>
restoration-use parameter B1703 (step SB1903), and ends the<br>
processing.<br>
Note that in the present embodiment, during reproduction<br>
the processing at steps SB1901 and SB1902 is performed, and<br>
pieces of restoration information B1604 are transmitted one<br>
at a time to the content restoration processing unit B126.<br>
However, a plurality of pieces of restoration information<br>
B1604 may be transmitted at once together with the packet<br>
position information B16 02 and the restoration information<br>
identifying value B16 03. As a further alternative method,<br>
the byte code execution unit B124 may execute the byte code<br>
B112 at the time of initialization of reproduction processing,<br>
and transmit all the data in the decrypted restoration<br>
information file B116 to the content restoration processing<br>
unit B126. In the aforementioned two methods, the content<br>
restoration processing unit B126 performs processing to<br>
select one piece of restoration information B1604 to be used<br>
73<br><br>
in restoration of the content data, from among the plurality<br>
of pieces of restoration information B1604.<br>
[0121]<br>
This completes the description of the transformed<br>
content data restoration processing by the content<br>
restoration processing unit B126.<br>
Note that so that content can be reproduced by the content<br>
reproducing device of the embodiment Bl or the content<br>
reproducing device of the embodiment B2 using one recording<br>
medium, the information recorded on the recording medium of<br>
the embodiment Bl and the information recorded on the recording<br>
medium of the embodiment B2 may be recorded on the same one<br>
recording medium. In such a case, the content reproducing<br>
device performs content reproduction using the information<br>
corresponding to the particular reproducing method used by<br>
the content reproducing device itself.<br>
[0122]<br>
(Conclusion)<br>
In recent years, accompanying increases in capacity of<br>
storage media, systems have become widespread in which content<br>
that is a work such as a movie is digitized, and stored and<br>
distributed on a medium such as a digital optical disc. In<br>
such a system, it is necessary to protect the copyright of<br>
the content and to enable reproduction, copying, and the like<br>
of the content to be performed only under restrictions that<br>
comply with an agreement with the copyright holder . A general<br>
system for protecting works from being unauthorizedly copied<br>
by a party without the permission of the copyright holder<br>
74<br><br>
has a structure in which digital content is encrypted with<br>
a content key managed by the copyright holder, recorded on<br>
a disc, and is only able to be decrypted by a terminal that<br>
has a corresponding content key. Furthermore, regulations<br>
regarding copyright protection established with the copyright<br>
holder must be followed in order to obtain the content key.<br>
[0123]<br>
As one example of such a system, patent document 2<br>
discloses a method by which the content key for encrypting<br>
and decrypting content data is generated based on a function<br>
of a seed key and time variable data.<br>
In this case, it is necessary to manage the content key<br>
strictly so that it is not exposed. However, it is possible<br>
that the content key will be exposed to an unauthorized party<br>
due so some kind of accident or occurrence. Once the content<br>
key has been exposed to an unauthorized party, there is a<br>
risk that the content key of subsequent content will be exposed<br>
using the same method. It is expected that this will lead<br>
to subsequent unauthorized use of content being unable to<br>
be prevented. With a conventional technique, since the<br>
content data is protected only by the content key that is<br>
protected according to a stipulated method, it is susceptible<br>
to this kind of attack.<br>
[0124]<br>
In view of the aforementioned problem, the present<br>
invention has an object of providing a recording medium, a<br>
data processing method, and a data processing device that<br>
protect content so that even if a way to crack content<br>
75<br><br>
protection is discovered according to some kind of accident<br>
or occurrence, other content is unable to be used<br>
unauthorizedly with the same method.<br>
Furthermore, the present invention has an object of<br>
providing a recording medium, a data processing method, and<br>
a data processing device that enable specification of an<br>
unauthorized reproducing device that was able to crack content<br>
protection, based on content whose protection method has been<br>
cracked and is being unauthorizedly distributed in a format<br>
usable by anyone.<br>
[0125]<br>
In order to solve the aforementioned problem, the present<br>
invention provides a recording medium on which content data<br>
is recorded, wherein the content data is protected by<br>
encryption with a content key, and data transformation<br>
according to an operation that is different to the encryption.<br>
Furthermore, the present invention provides the recording<br>
medium, wherein in addition to the content data, the content<br>
key and a program for calculating a parameter necessary for<br>
restoration of the content data are recorded on the recording<br>
medium.<br>
[0126]<br>
Moreover, the present invention provides the recording<br>
medium, wherein the program enables calculation of the<br>
parameter only by a valid data processing device that is<br>
permitted to use the content data. Moreover, the present<br>
invention provides the recording medium, wherein the<br>
parameter includes terminal unique information. Moreover,<br>
76<br><br>
the present invention provides the recording medium, wherein<br>
the parameter includes information for distinguishing whether<br>
restoration processing is unique to the content or is unique<br>
to a data processing device.<br>
[0127]<br>
Furthermore, the present invention provides a recording<br>
medium on which content data is recorded, wherein the content<br>
data is protected by encryption with a content key, and data<br>
transformation according to an operation that is different<br>
to the encryption, and part or all of the parameter is recorded<br>
multiplexed with the content data. Moreover, the present<br>
invention provides the recording medium, wherein the part<br>
or all of the parameter that is recorded multiplexed with<br>
the content data includes information that specifies a data<br>
transformation position.<br>
[0128]<br>
Furthermore, the present invention provides a recording<br>
medium on which content data is recorded, wherein the content<br>
data is protected by encryption with a content key, and data<br>
transformation according to an operation that is different<br>
to the encryption, and part or all of the parameter is recorded<br>
as a file that is separate to the content data.<br>
[0129]<br>
Moreover, the present invention provides a data<br>
processing method for reproducing content data that is<br>
recorded on a recording medium, the content data being<br>
protected by encryption with a content key, and data<br>
transformation according to an operation that is different<br>
77<br><br>
to the encryption, the data processing method including: a<br>
step of decrypting with the content key; and a step of<br>
performing restoration of the content data.<br>
[0130]<br>
Moreover, the present invention provides the data<br>
processing method, wherein the step of performing restoration<br>
of the content data includes: a step of, before reproduction<br>
commences, calculating a parameter necessary for restoration<br>
processing; and a step of, during reproduction, performing<br>
the restoration processing of the content data using the<br>
parameter, the steps being separate. Moreover, the present<br>
invention provides the data processing method, wherein in<br>
the step of performing parameter calculation, device unique<br>
information is used.<br>
[0131]<br>
Furthermore, the present invention provides the data<br>
processing method, wherein in the step of performing the<br>
restoration processing of the content data, device unique<br>
information is used.<br>
Furthermore, the present invention provides the data<br>
processing method, wherein in the step of performing the<br>
restoration processing of the content data, content unique<br>
information is used.<br>
Furthermore, the present invention provides the data<br>
processing method, wherein the step of performing restoration<br>
of the content data during reproduction performs the<br>
restoration processing in accordance with restoration<br>
processing-use data that is multiplexed with the content data.<br>
78<br><br>
Moreover, the present invention provides the data processing<br>
method wherein the step of performing restoration of the<br>
content data during reproduction specifies the data<br>
transformation position according to the restoration<br>
processing-use data multiplexed with the content data, and<br>
performs restoration processing.<br>
[0132]<br>
Furthermore, the present invention provides the data<br>
processing method, wherein the step of performing restoration<br>
of the content data during reproduction performs the<br>
restoration processing in accordance with restoration<br>
processing-use data that is recorded as a separate file to<br>
the content data.<br>
Furthermore, the present invention provides a data<br>
processing device for reproducing content data that is<br>
recorded on a recording medium, the content data being<br>
protected by encryption with a content key, and data<br>
transformation according to an operation that is different<br>
to the encryption, the data processing device including: an<br>
information reading unit operable to read information from<br>
the recording medium; a unit operable to decrypt with the<br>
content key; a unit operable to store terminal unique<br>
information; a unit operable to execute a program for<br>
calculating a parameter necessary for restoration of the<br>
content data; a unit operable to perform restoration<br>
processing of the content data using the calculated<br>
information necessary for restoration; and a decoding unit<br>
operable to decode the content data.<br>
79<br><br>
[0133]<br>
As has been described, the present invention has the<br>
effect of being able to provide a recording medium, a data<br>
processing method, and a data processing device by which<br>
content is protected such that the content is not reproduced<br>
unauthorizedly, even if the content key is leaked due to some<br>
kind of accident or occurrence, and circulated among the<br>
general public.<br>
Furthermore, the present invention enables<br>
specification of an unauthorized reproducing device that was<br>
able to crack content protection, based on content whose<br>
protection method has been cracked and is being unauthorizedly<br>
distributed in a format usable by anyone.<br>
3. Embodiment C: Disc Production System<br>
(Embodiment CI)<br>
FIG. 4 7 is a block diagram showing main parts of a<br>
structure of a transformation processing subsystem C101 for<br>
executing transformation processing in an embodiment CI of<br>
the present invention. The transformation processing<br>
subsystem C101 includes a multiplexing unit C103, a<br>
transformation processing unit C104, a storage unit C105,<br>
a transformation control unit C106, and an input unit C107.<br>
The multiplexing unit C103 is connected to a recording medium<br>
C102 and the transformation control unit C106 , and multiplexes ,<br>
with a content file, transformation processing-use packets<br>
according to instructions from the transformation control<br>
unit C106, and outputs the resultant content file. The<br>
80<br><br>
transformation processing unit C104 is connected to the<br>
multiplexing unit C103 and the transformation control unit<br>
C106, and executes transformation processing on specified<br>
content packets in the content file according to instructions<br>
from the transformation control unit C106 . The storage unit<br>
C105 is connected to the transformation processing unit C104<br>
and the transformation control unit C106, and stores, on a<br>
recording medium C108, a post-transformation, transformed<br>
content file and byte code data that has been received from<br>
the transformation control unit C106. The transformation<br>
control unit C106 is connected to the input unit C107, and,<br>
based on data received from the input unit C107, issues<br>
transformation processing instructions to the multiplexing<br>
unit C103 and to the transformation processing unit C104.<br>
The transformation control unit C106 also generates the byte<br>
code data including processes and parameters for reversing<br>
the transformation corresponding to the transformation<br>
processing, and transmits the byte code data to the storage<br>
unit C105. The input unit C107 inputs data to specify the<br>
transformation processing.<br>
[0134]<br>
An operation of the transformation processing subsystem<br>
C101 having the kind of construction described above is<br>
described with reference to an operation flowchart of FIG.<br>
49.<br>
FIG. 49 is an operation flowchart showing the<br>
operation of the transformation processing subsystem C101.<br>
In step SC3 01, various information is input into the<br>
81<br><br>
transformation control unit C106 from the input unit C107.<br>
This information includes: transformation position<br>
information indicating the ordinal number, counted from the<br>
head packet of a content file, of a packet and the ordinal<br>
numbers of the bytes within the packet that are to be<br>
transformed; operation processing information indicating<br>
which operation of a set of operations including logic<br>
operations such as XOR and encryption methods is to be<br>
performed; an operation-use parameter for use in the operation<br>
processing; and a terminal operation mode which is information<br>
indicating whether to include information specifying a<br>
reproducing terminal, at a given reproducing terminal for<br>
reproducing the recording medium C205.<br>
[0135]<br>
Next, in step SC3 02, based upon the information input<br>
in step SC3 01, the transformation control unit C106 generates<br>
a transformation processing-use packet, a multiplex position,<br>
and the byte code data . The multiplex position is information<br>
specifying the ordinal number from the head of the content<br>
file of the packet at which the generated transformation<br>
processing-use packet is multiplexed. The multiplex<br>
position is generated to allow for processing time at the<br>
reproducing terminal, so that the transformation<br>
processing-use packet is multiplexed a certain number of<br>
packets before the transformation position specified by the<br>
above transformation position information. The<br>
transformation processing-use packet and the byte code data<br>
are described at a later stage in this description. The<br>
82<br><br>
transformation control unit C106 transmits the generated<br>
transformation processing-use packet and the multiplex<br>
position to the multiplexing unit C103, transmits the<br>
transformation position information, the operation<br>
processing information, and the operation-use parameter to<br>
the transformation processing unit C104, and transmits the<br>
generated byte code data to the storage unit C105.<br>
[0136]<br>
Next, in step SC3 03, the multiplexing unit C103<br>
multiplexes the transformation processing-use packet into<br>
a position in the content file specified by the multiplex<br>
position.<br>
Next, instepSC304, the transformation processing unit<br>
C104 specifies the packet that is to be transformed and the<br>
transformation target data, the data that is to transformed<br>
within the packet, on the basis of the transformation posit ion.<br>
Next, in step SC3 05, the transformation processing unit<br>
C104 executes operation processing using the operation-use<br>
parameter on the transformation target data in the specified<br>
transformation packet. For example, when the operation<br>
processing is an XOR operation, the transformation processing<br>
unit 104 takes the XOR sum of the transformation target data<br>
and the operation-use parameter, and overwrites (replaces)<br>
the transformation target data with the resulting value . Note<br>
that the operation processing is not limited to an XOR operation,<br>
but may consist of other logic operations or encryption<br>
processes.<br>
[0137]<br>
83<br><br>
Next, in step SC3 06, the storage unit C105 stores the<br>
transformed content file that has finished undergoing<br>
transformation processing on the recording medium C108.<br>
Next, in step SC307, the storage unit C105 stores the<br>
byte code data on the recording medium C108 in a different<br>
file from the transformed content file.<br>
Note that a plurality of transformation positions can<br>
be specified within one content file, in which case, in step<br>
SC3 01, operation processing and an operation-use parameter<br>
are input for each of a plurality of transformation positions .<br>
Transformation can then be realized by repeating step SC3 02<br>
to step SC3 05 for each of the plurality of transformation<br>
positions.<br>
[0138]<br>
FIG. 53 shows a representation of the transformed content<br>
file generated via the kind of operation flow described above .<br>
In FIG. 53, a post-transformation processing content file<br>
C702 , which is a content file after transf ormationprocessing,<br>
is generated by the multiplexing unit CI03 multiplexing a<br>
transformation processing-use TS packet with a<br>
pre-transformation processing content file C701, and by the<br>
transformation processing unit C104 carrying out<br>
transformation processing. Here, the transformation<br>
processing-use packet has a packet identifier that is<br>
different from those of other packets in the content file.<br>
[0139]<br>
Below, a disc production system including the<br>
transformation processing subsystem C101 is described with<br>
84<br><br>
reference to FIG. 48.<br>
FIG. 4 8 is a block diagram showing main parts of a disc<br>
production system for producing the recording medium C2 05,<br>
such as an optical disc, of the embodiment CI of the present<br>
invention. This disc production system includes an encode<br>
subsystem C2 01, the transf ormationprocessing subsystem CIO 1,<br>
an encryption subsystem C2 02, and a disc writing subsystem<br>
C204. The encode subsystem C201 converts content data such<br>
as audio and video into a data format suitable for storing<br>
on the recording medium C2 05, such as the optical disc or<br>
the like, and stores the result as a contents file on the<br>
recording medium C102. The transformation processing<br>
subsystem C101 implements transformation processing on the<br>
content file stored on the recording medium C102, and stores<br>
a transformed content file together with the byte code data<br>
that corresponds to the transformation processing on the<br>
recording medium C108. The encryption subsystem C202 is<br>
connected to the recording medium CIO 8 , carries out encryption<br>
processing on the transformed content file to generate an<br>
encrypted content file, and stores at least the encrypted<br>
content file and the byte code data on a recording medium<br>
C203. The disc writing subsystem C204 is connected to the<br>
recording medium C203 and writes at least the encrypted content<br>
file and the byte code data to the recording medium C205.<br>
Thus at least the encrypted content file and the byte code<br>
data are stored on the recording medium C2 05 . Further, a key<br>
for decrypting the encrypted content file may also be stored<br>
on the recording medium C2 05.<br>
85<br><br>
[0140]<br>
The transformation processing-use packet and the byte<br>
code data, which are generated using the above operation flow,<br>
are described below. The transformation processing-use<br>
packet and the byte code data are used at the reproducing<br>
terminal for reversing the transformation processing, and<br>
respectively include the information indicated in FIG. 50<br>
and FIG. 51. The byte code data is, for example, the type<br>
of code executable in a virtual operations unit, such as a<br>
JAVA virtual machine, and is the data describing a code<br>
executable at the reproducing terminal.<br>
[0141]<br>
In the case of FIG. 50A, the transformation<br>
processing-use packet includes data transformation operation<br>
processing specifying operation processing for transforming<br>
data, a transformation position that contains a packet count<br>
indicating the ordinal number of the transformed packet<br>
counted from the transformation processing-use packet and<br>
an in-packet position indicating the transformation target<br>
data in that packet, and a data transformation operation-use<br>
parameter that contains a parameter used in the transformation<br>
processing and dummy data. The byte code data including the<br>
dataof FIG. 51Ais generated together with this transformation<br>
processing-use packet. The byte code data of FIG. 51Aincludes<br>
an operation mode of a reproducing terminal (indicating that<br>
information specifying a reproducing terminal is not used<br>
in the case of FIG. 51A), and a data transformation<br>
operation-use parameter position specification indicating<br>
86<br><br>
which value in the data transformation operation-use<br>
parameter in the transformation processing-use packet is to<br>
be used.<br>
[0142]<br>
An example operation of a reproducing terminal in this<br>
case is described with reference to FIG. 52, which shows its<br>
main parts . A reproducing terminal C6 01 reads byte code data<br>
C603 from the recording medium C205. In the reproducing<br>
terminal C601, in preparation for reproduction, a byte code<br>
processing unit C610 then analyzes the byte code data C603,<br>
and acquires the operation mode and the data transformation<br>
operation-use parameter position specification. If the<br>
operation mode is a mode of not including information<br>
specifying a reproducing terminal, the byte code processing<br>
unit C610 transmits the data transformation operation-use<br>
parameter position specification and the operation mode to<br>
a restoration processing unit C606. Subsequently, at<br>
reproduction, the reproducing terminal C6 01 reads an<br>
encrypted content file C602 . A decryption unit C604 decrypts<br>
the encrypted content file C602 and outputs the resultant<br>
decrypted content file C602 to a transformation<br>
processing-use packet extraction unit C6 05 as the transformed<br>
content. Upon detection of the transformation<br>
processing-use packets, the transformation processing-use<br>
packet extraction unit C6 0 5 outputs the transformation<br>
processing-use packets and the remaining transformed content<br>
to the restoration processing unit C60G. The restoration<br>
processing unit C606 executes operation processing<br>
87<br><br>
corresponding to the specified data transformation operation<br>
processing on the transformation target data in the<br>
transformed content specified by the transformation position<br>
in the transformation processing-use packet, using the data<br>
in the data transformation operation-use parameter specified<br>
by the data transformation operation-use parameter position<br>
specification. The restoration processing unit C6 06 then<br>
outputs the result to a demultiplexer C607 as content. The<br>
demultiplexer C607 converts the content information, which<br>
includes video and audio data, into a format that can be<br>
processed by a decoding unit C609. The demultiplexer C607<br>
outputs the converted content information to a video buffer<br>
C608, and the decoding unit C609 carries out the processing<br>
associated with reproduction and output of the content.<br>
[0143]<br>
In the case of FIG. 50B, on the other hand, the<br>
transformation processing-use packet includes a packet count<br>
and an in-packet position. In such a case, the corresponding<br>
byte code data is generated as shown in FIG. 5IB, which includes<br>
an operation mode (indicating that information specifying<br>
a reproducing terminal is used in the case of FIG. 5IB) , data<br>
transformation operation processing, and a data<br>
transformation operation-use parameter.<br>
[0144]<br>
In this case, in the reproducing terminal C601, the byte<br>
code processing unit C610 analyzes the byte code data C603.<br>
Since the operation mode is a mode of specifying a reproducing<br>
terminal, for example the byte code processing unit C610<br>
88<br><br>
obtains the terminal ID, generates a parameter by combining<br>
the terminal ID with the data transformation operation-use<br>
parameter, and transmits the generated parameter to the<br>
restoration processing unit C606 together with the data<br>
transformation operation processing and the operation mode.<br>
The restoration processing unit C606 executes the operation<br>
processing corresponding to the data transformation operation<br>
processing on the transformation target data specified by<br>
the transformation position in the transformation<br>
processing-use packet, using the received parameter.<br>
[0145]<br>
In this way, in this embodiment, information relating<br>
to the transformation processing applied to the content file<br>
can be specified in each transformation processing-use packet<br>
and the byte code data, and hence, transformation processing<br>
can be freely changed for each content file.<br>
Also, by setting the operation mode of the reproducing<br>
terminal to the mode of using information specifying a<br>
reproducing terminal, information that varies for each<br>
terminal ID can be included in content at the time of<br>
reproduction. In this way, it is possible to specify a<br>
reproducing terminal that has taken an unauthorized copy or<br>
unauthorizedly distributed the content.<br>
[0146]<br>
Further, in the transformation processing subsystem<br>
C101, if an unauthorized terminal list is input from the input<br>
unit C107, the unauthorized terminal list can be stored as<br>
part of the byte code data. In such a case, when a reproducing<br>
89<br><br>
terminal references its terminal ID, if a terminal ID that<br>
matches its own is stored in the unauthorized terminal ID<br>
list contained in the byte code data, extraction of data<br>
transformation parameters can be suppressed, analysis of the<br>
byte code data cancelled, or the like. Consequently,<br>
unauthorized terminals can be rendered incapable of<br>
reproducing content in a normal way.<br>
[0147]<br>
Note that the transformation position in the content<br>
file is indicated by the packet ordinal number, but another<br>
method such as using a time stamp is equally applicable.<br>
Note that the byte code data need not be JAVA, but may<br>
be another type of execution code. Moreover, the byte code<br>
data can be a self-modifying type of execution code, making<br>
it possible to obtain an improvement in the degree of<br>
concealment of the byte code data.<br>
[0148]<br>
Also, though the data transformation operation<br>
processing, the transformation position, the data<br>
transformation-use parameter, the data transformation<br>
operation-use parameter position specification, and the<br>
operation mode are shown in FIGS. 5 0 and 51, the present<br>
invention is not limited to these combinations, as various<br>
other combinations are equally applicable including the<br>
representative pattern shown in FIG. 54. Also, the packet<br>
identification number may be stored in the transformation<br>
processing-use packet, so that the data transformation<br>
operation-use parameter and the data transformation operation<br>
90<br><br>
processing are varied for each packet identification number<br>
in the byte code data.<br>
[0149]<br>
Also, though the operation mode is included in the byte<br>
code data, the operation mode may instead be included in the<br>
transformation processing-use packet. In such a case, the<br>
same effects can be achieved by making the operation mode<br>
judgment in the restoration processing unit C6 06 in the<br>
reproducing terminal C601.<br>
Also, though the transformation position is stored in<br>
the transformation processing-use packet, a transformation<br>
starting packet for indicating that the next packet is the<br>
transformation target packet may be multiplexed directly<br>
before the transformation target packet. This makes it<br>
unnecessary for the reproducing terminal C6 01 to count the<br>
number of packets, with it being possible to reduce the<br>
processing load.<br>
[0150]<br>
(Embodiment C2)<br>
FIG. 5 5 is a block diagram showing main parts of a<br>
structure of a transformation processing subsystem C901 for<br>
executing transformation processing in an embodiment C2 of<br>
the present invention.<br>
The transformation processing subsystem C901 includes<br>
a video analysis unit C902 and an input unit C903 . The video<br>
analysis unit C902 is connected to the recording medium C102,<br>
and analyzes video information of a content file and transmits<br>
an analysis result to the input unit C903 . The input unit<br>
91<br><br>
C903 determines, based on the analysis result, which<br>
information of the video is subjected to transformation, and<br>
transmits transformation position information, operation<br>
processing information, an operation-use parameter, and a<br>
terminal operation mode to the transformation control unit<br>
C106. The other elements are the same as those in the<br>
transformation processing subsystem C101 and so their<br>
explanation has been omitted here.<br>
[0151]<br>
An operation of the trans formation processing subsystem<br>
C901 having this kind of construction described above is<br>
described below.<br>
The video analysis unit C902 reads a content file from<br>
the recording medium C102, and analyzes video packets in the<br>
content file. The analysis referred to here is performed by<br>
detecting which of I (intra), P (forward predicted), and B<br>
(bidirectionally predicted) pictures the video belonging to<br>
each video packet is, and which frequency component or position<br>
of the picture the video corresponds to. The video analysis<br>
unit C902 transmits an obtained analysis result of each video<br>
packet to the input unit C903.<br>
[0152]<br>
Based on the received analysis result, the input unit<br>
C903 determines which packet of the I, P, or B picture is<br>
subjected to transformation according to a predetermined<br>
transformation operation setting, and transmits information<br>
such as the transformation position to the transformation<br>
control unit C106.<br>
92<br><br>
According to the present embodiment, the transformation<br>
processing position can be specified based on the video<br>
analysis unit. For example, when the transformation<br>
operation setting is made to sub j ect a packet in a low frequency<br>
region of an I picture to transformation, the position of<br>
the corresponding packet is extracted from the analysis result<br>
and transmitted to the transformation control unit C106 . In<br>
this case, the transformation processing has significant<br>
influence on image clarity. An unauthorized reproducing<br>
terminal cannot perform transformation processing in a normal<br>
way, with it being possible to prevent reproduction of clear<br>
video.<br>
[0153]<br>
When the transformation operation setting is made to<br>
subject a packet in a high frequency region of a B picture<br>
to transformation, on the other hand, the transformation<br>
processing does not have significant influence on image<br>
clarity. Accordingly, even if information about the terminal<br>
ID is embedded in the transformation position in the<br>
reproducing terminal, clear video that can be viewed without<br>
problem can be reproduced.<br>
Note here that in-picture position information may be<br>
used instead of a frequency component.<br>
[0154]<br>
Also, the transformation processing subsystems C101 and<br>
C901 can be realized as one device.<br>
(Conclusion)<br>
93<br><br>
In recent years, as the capacity of storage media has<br>
increased, systems in which content that is a work such as<br>
a movie is converted into digital form and stored in media,<br>
such as digital optical discs or the like, have become<br>
widespread. In such systems, it is necessary that the<br>
copyright of the content is protected and that reproduction<br>
and copying of the content are practiced only within limits<br>
based on an agreement with the copyright holder. Regular<br>
systems to protect copyright material from being<br>
unauthorizedly copied or the like without permission from<br>
the copyright holder include arrangements in which the digital<br>
content is encrypted using a content key managed by the<br>
copyright holder. The encrypted digital content is then<br>
stored on a disc and can only be decrypted by terminals holding<br>
a corresponding content key. For a user to obtain the content<br>
key, rules for copyright protection established between the<br>
user and the copyright holder must be followed.<br>
[0155]<br>
As an example of this kind of system, in Japanese Patent<br>
Application Publication No. 2000-100069, a method is revealed<br>
in which the content key for encrypting and decrypting the<br>
content data is protectedby being generatedbased on a function<br>
of seed keys and time variable data.<br>
When this technique is used, there is a requirement that<br>
the content key be strictly managed so as not to be exposed<br>
to an outside party. However, there may be times when, via<br>
some accident or incident, the content key is exposed to an<br>
unauthorized party. Once the content key has been exposed<br>
94<br><br>
to the unauthorized party, there is a danger that the content<br>
keys for subsequent content will be discovered using the same<br>
method. Consequently, it can be presumed that unauthorized<br>
use of subsequent content could not be prevented. With<br>
conventional techniques, the content data is susceptible to<br>
attacks of this type because its sole protection is a content<br>
key protected via the specified method.<br>
In view of this problem, an object of the present<br>
invention is to provide a recording medium for protecting<br>
content in such a way that even if, by some accident or incident,<br>
a method to break the content protection is discovered once,<br>
the same method cannot be used for unauthorizedly making use<br>
of other content, and further to provide a data generating<br>
method and a data generating device for generating this<br>
content.<br>
[0156]<br>
A further object of the present invention is to provide<br>
a recording medium capable of specifying, from content whose<br>
content protection method has been broken and which is<br>
unauthorizedly circulating in a form that canbe usedby anyone,<br>
the unauthorized reproducing device that was able to break<br>
the content protection, and further to provide a data<br>
generating method and a data generating device for generating<br>
this content.<br>
To solve the above problems, the present invention<br>
provides a recording medium having data recorded thereon,<br>
wherein the data is content data protected by transformation<br>
and by encryption using a content key, the transformation<br>
95<br><br>
being an operation distinct from the encryption.<br>
[0157]<br>
Further, the present invention provides the recording<br>
medium further having at least a program recorded thereon,<br>
wherein the program is for calculating a parameter required<br>
for restoring the content data.<br>
Further, the present invention provides the recording<br>
medium, wherein the program enables only an authorized data<br>
processing device permitted to use the content data to<br>
calculate the parameter.<br>
[0158]<br>
Further, the present invention provides the recording<br>
medium, wherein the parameter includes unique information<br>
of the data processing device.<br>
Further, the present invention provides the recording<br>
medium, wherein the parameter includes information for<br>
distinguishing whether restoration processing is unique to<br>
the data processing device.<br>
Further, the present invention provides the recording<br>
medium, wherein part or all of the parameter is recorded<br>
multiplexed with the content data.<br>
[0159]<br>
Further, the present invention provides the recording<br>
medium, wherein the parameter recorded multiplexed with the<br>
content data includes information for specifying a data<br>
transformation portion.<br>
Further, the present invention provides a data<br>
generating method for implementing operations on content data,<br>
96<br><br>
including a step of implementing, on part or all of the content<br>
data, a transformation operation distinct from encryption<br>
using a content key.<br>
[0160]<br>
Further, the present invention provides the data<br>
generating method, wherein the step of implementing the<br>
transformation operation includes a step of generating a<br>
program for a data processing device to calculate a parameter<br>
required for restoration processing before starting<br>
reproduction of the content data.<br>
Further, the present invention provides the data<br>
generation method, wherein the step of implementing the<br>
transformation operation includes: a step of generating a<br>
program for a data processing device to calculate information<br>
about part of the parameter required for the restoration<br>
processing before starting reproduction of the content data;<br>
a step of generating restoration information data including<br>
information about the rest of the parameter required for the<br>
restoration processing; and a step of multiplexing the<br>
restoration information data with the content data.<br>
[0161]<br>
Further, the present invention provides the data<br>
generating method, wherein the step of generating the program<br>
includes, into the program, information indicating whether<br>
to use information unique to the data processing device at<br>
the reproduction by the data processing device.<br>
Further, the present invention provides the data<br>
generating method, wherein the step of generating the program<br>
97<br><br>
includes, into the program, unique information of the data<br>
processing device that is not permitted to perform<br>
reproduction.<br>
[0162]<br>
Further, the present invention provides the data<br>
generating method, wherein the step of implementing the<br>
transformation operation includes: a step of analyzing video<br>
information of the content data; and a step of specifying<br>
a position of data transformed, based on an analysis result<br>
of the video information.<br>
Further, the present invention provides a data<br>
generating device for implementing operations on content data,<br>
including a unit operable to implement, on part or all of<br>
the content data, a transformation operation distinct from<br>
encryption using a content key.<br>
[0163]<br>
Further, the present invention provides the data<br>
generating device further including: a unit operable to<br>
generate a program for a data processing device to calculate<br>
a parameter required for restoration processing before<br>
starting reproduction of the content data.<br>
Further, the present invention provides the data<br>
generating device further including: a unit operable to<br>
generate a program for a data processing device to calculate<br>
information about part of the parameter required for the<br>
restoration processing before starting reproduction of the<br>
content data; a unit operable to generate restoration<br>
information data including information about the rest of the<br>
98<br><br>
parameter required for the restoration processing; and a unit<br>
operable to multiplex the restoration information data with<br>
the content data.<br>
[0164]<br>
As described above, the present invention has the effect<br>
of providing a recording medium on which content is protected<br>
from being reproduced unauthorizedly even when by some<br>
accident or incident the content key has been divulged and<br>
circulated among an unspecified large number of devices, and<br>
further to provide a data protection method, a data generating<br>
method, and a data generating device for generating this<br>
content.<br>
Further, content can be generated from which, if its<br>
content protection has been broken and it is unauthorizedly<br>
circulating in a form that can be used by anyone, the<br>
reproducing device that was able to break its content<br>
protection can be specified.<br>
4. Embodiment D: Content Reproducing Device<br>
The following describes an embodiment for implementing<br>
the present invention, with reference to the drawings.<br>
[0165]<br>
FIG. 5 6 shows a structure of a recording medium D101<br>
and a content reproducing device D102 pertaining to one<br>
embodiment of the present invention.<br>
Recorded on the recording medium D101 is a byte code<br>
D112, protected content data D113, an encrypted content key<br>
D114, and revocation information D115. While the recording<br>
99<br><br>
medium D101 is assumed to be a BD (Blu-ray Disc) as one example<br>
here, it is not limited to being so.<br>
[0166]<br>
In this embodiment, it is assumed that one set of content<br>
is composed of data of a plurality of MPEG 2 TSs (Motion Picture<br>
Expert Group 2 Transport Streams) . It is reproduction control<br>
information Dill that stipulates the reproduction order of<br>
the protected content dataD113 when the content is reproduced.<br>
[0167]<br>
The byte code D112 is an execution code composed of an<br>
instruction set of a set length, such as a JAVA byte code.<br>
The byte code D112 may have been subject to processing such<br>
as obfuscation in order to prevent the secret information<br>
and processing content of the software from being ascertained<br>
by an act of analysis. In such a case, a byte code execution<br>
unit D124 has a function of removing processing such as<br>
obfuscation. Execution of the byte code D112 is described<br>
in detail later. Note that while an example of a JAVA byte<br>
code is given in this embodiment, an execution program other<br>
than JAVA may instead be used.<br>
[0168]<br>
The protected content data D113 is plaintext MPEG 2 TS<br>
data that can be output as video by a decoder, and has been<br>
subject to encryption processing with a content key, and<br>
further to data transformation processing, for example an<br>
XOR operation with some value. For this reason, in order to<br>
reproduce the protected content data D113, in addition to<br>
decryption processing with the content key, it is necessary<br>
100<br><br>
to subject the protected content data D113 to processing for<br>
reversing the transformation processing, and restore the<br>
protected content data D113 to plaintext MPEG 2 TS data.<br>
[0169]<br>
The encrypted content key D114 is data of a content key<br>
that is for decrypting the protected content data and that<br>
has been encrypted with a media key. The media key is described<br>
later.<br>
The following describes the revocation information D115 .<br>
A key management organization has a collection of a plurality<br>
of device keys and a plurality of media keys. The key<br>
management organization assigns, to each content reproducing<br>
device D102, one device key and a key identification number<br>
of the device key, and gives the assigned device key and key<br>
identification number to the content reproducing device D102 .<br>
Furthermore, the key management organization assigns one<br>
media key to the recording medium D101. Next, the key<br>
management organization encrypts the media key using each<br>
of the device keys assigned respectively to the content<br>
reproducing devices D102 , thereby generating encrypted media<br>
keys, and creates a list of all of the encrypted media keys<br>
and the key identification numbers corresponding to the device<br>
keys. This list is the revocation information D115. Note<br>
that since a drawback of this simple method is that the data<br>
size of the revocation information D115 is unrealistically<br>
large when there is a large number of content reproducing<br>
devices D102, a method that compresses the data size of the<br>
revocation information D115 disclosed in "Key Management<br>
101<br><br>
System for Digital Content Protection" (Nakano, Ohmori, and<br>
Tatebayashi, The 2 001 Symposium on Cryptography and<br>
Information Security SCIS2 001 5A-5, Jan. 2 001) may be used.<br>
However, the method is not limited to this method, and another<br>
method may be used to compress the data size of the revocation<br>
information D115.<br>
[0170]<br>
The content reproducing device D102 is composed of a<br>
disc reading unit D121, a reproduction control unit D122,<br>
a user operation reception unit D123, a byte code execution<br>
unit D124, a decryption unit D125, a content restoration<br>
processing unit D126, a demultiplexing unit D127, a video<br>
decoder D12 8, an audio decoder D12 9, a content key generation<br>
unit D13 0, a revocation information processing unit D131,<br>
a device key storage unit D13 2 , and a device unique information<br>
storage unit D133.<br>
[0171]<br>
One example of implementation of the content reproducing<br>
device D102 is a computer system composed of a CPU, a work<br>
memory, a flash memory, a BD drive, and a remote control.<br>
Here, the disc reading unit D121 is the BD drive, the device<br>
key storage unit D13 2 and the device unique information storage<br>
unit D133 are the flash memory, the user operation reception<br>
unit D123 is the remote control, and the reproduction control<br>
unit D122, the byte code execution unit D124, the decryption<br>
unit D125, the content restoration processing unit D126, the<br>
demultiplexing unit D127, the video decoder D128, the audio<br>
decoder D129, the content key generation unit D130, and the<br>
102<br><br>
revocation information processing unit D131 are software that<br>
operates using the CPU and the work memory as one example<br>
of a structure. However, these are not limited to being<br>
structured by software, and may be implemented in hardware<br>
or the like.<br>
[0172]<br>
This completes the description of the structure of the<br>
recording medium and the content reproducing device of an<br>
embodiment of the present invention.<br>
(Description of Content Reproduction Processing)<br>
The following describes content reproduction<br>
processing, with use of FIG. 57.<br>
First, the content reproduction processing starts upon<br>
the user operation reception unit D123 receiving a content<br>
reproduction start request from a user.<br>
[0173]<br>
When the content reproduction request is received, the<br>
revocation information processing unit D131 performs<br>
revocation confirmation processing with respect to the<br>
content reproducing device D102 (stepSD201). Details of the<br>
revocation confirmation processing are given later.<br>
Subsequently, the processing branches depending on<br>
whether or not generation of the media key succeeds in the<br>
revocation confirmation processing at step SD2 01 (step<br>
SD2 02).<br>
[0174]<br>
When the generation of the media key succeeds in the<br>
103<br><br>
revocation confirmation processing at step SD201, the<br>
encrypted content key D114 is read from the recording medium<br>
D101, and a content key is generated (step SD2 03) . Details<br>
of the content key generation are given later.<br>
When the generation of the media key fails in the<br>
revocation confirmation processing at step SD201, the user<br>
is notified that the content reproducing device Dl 02 is revoked,<br>
and the processing ends (step SD210).<br>
[0175]<br>
After step SD2 03, in order to calculate data necessary<br>
for the restoration processing of the protected content data,<br>
the byte code D112 is read from the recording medium D101<br>
and executed in the byte code execution unit D124 (stepSD2 04) .<br>
Details of the byte code execution are given later.<br>
After step SD2 04, in order to reproduce the content<br>
requested by the user, the reproduction control unit D122<br>
instructs to start reading the protected content data D113<br>
that is the target of reproduction, in accordance with the<br>
reproduction control information Dill (step SD205).<br>
[0176]<br>
The decryption unit D125 performs decryptionprocessing<br>
as necessary with respect to the protected content data D113<br>
read from the recording medium D101, with use of the content<br>
key generated by the content key generation unit D13 0 (step<br>
SD2 07). Hereinafter, the data obtained as a result of<br>
decrypting the protected content data D113 is called<br>
transformed content data. The protected content data is<br>
encrypted using AES (Advanced Encryption Standard), but is<br>
104<br><br>
not limited to being so. Since decryption processing is<br>
performed repeatedly during content reproduction until the<br>
protected content data D113 ends, restoration of transformed<br>
content (step SD2 08) and reproduction of content data (step<br>
SD209) are executed in parallel.<br>
[0177]<br>
Next, the content restoration processing unit D12 6<br>
performs restoration processing on the transformed content<br>
dataoutput fromthe decryption unitD125 (stepSD2 08) . During<br>
content reproduction, the restoration processing at step<br>
SD208 is executed in parallel with decryption processing of<br>
the protected content data D113 (step SD2 07) and reproduction<br>
of the content data (described later) (step SD209) . Details<br>
of restoration processing of the transformed content data<br>
are given later.<br>
[0178]<br>
The restored content data is plaintext MPEG 2 TS data,<br>
which is separated into a video stream and an audio stream<br>
in the demultiplexing unit D127, and the video stream and<br>
the audio stream are transmitted to the video decoder D12 8<br>
and the audio decoder D12 9, respectively, and output to an<br>
audio/video device such as a television (step SD209).<br>
Decryption of the protected content data D113 (step SD2 07)<br>
and restoration of transformed content data (step SD2 08) are<br>
executed in parallel during content reproduction .<br>
[0179]<br>
The processing ends when all the protected content data<br>
D113 corresponding to the content requested by the user has<br>
105<br><br>
been read (step SD206).<br>
This completes the description of the content<br>
reproduction processing.<br>
(Revocation Confirmation Processing with respect to the<br>
Content Reproducing Device D102)<br>
The following describes revocation confirmation<br>
processing with respect to the content reproducing device<br>
D102, with use of FIG. 58.<br>
[0180]<br>
Revocation confirmation processing is processing for,<br>
before content reproduction, confirming according to the<br>
revocation information D115 recorded on the recording medium<br>
D101 that the content reproducing device D102 has not been<br>
revoked.<br>
The revocation information processing unit D131 reads<br>
the device key obtained from the device key storage unit D132<br>
(step SD3 01) . The device key is information for specifying<br>
the content reproducing device D102, and is unique to each<br>
content reproducing device D102.<br>
[0181]<br>
Next, the revocation information processing unit D131<br>
reads the revocation information D115 recorded on the<br>
recording medium D101 (step SD302), and generates a media<br>
key using the read device key and the revocation information<br>
D115 (step SD303).<br>
Note that in the case of the content reproducing device<br>
D102 being revoked, a media key is unable to be generated.<br>
106<br><br>
Generation of the media key using the device key and the<br>
revocation information D115 is described in detail in<br>
"National Technical Report, Vol. 43, No. 3, p. 118-122"<br>
(Matsushita Techno Research, June 18, 1997).<br>
[0182]<br>
This completes the description of the revocation<br>
confirmation processing with respect to the content<br>
reproducing device D102.<br>
(Content Key Generation Processing)<br>
The following describes the content key generation<br>
processing with use of FIG. 59.<br>
The content key generation unit D13 0 obtains the media<br>
key generated at step SD2 01 from the revocation information<br>
processing unit D131 (step SD401). Next, the encrypted<br>
content key D114 is read from the recording medium D101, and<br>
decrypted with the media key obtained at step SD4 01 (step<br>
SD4 02). Encryption and decryption of the content key are<br>
performed using AES, but are not limited to being so.<br>
[0183]<br>
This completes the description of the content key<br>
generation processing.<br>
(Byte Code Execution Processing)<br>
The following describes details of the byte code<br>
execution processing, with use of FIG. 60.<br>
The byte code execution unit D124 reads the byte code<br>
D112 necessary for reproducing the specified content, from<br>
107<br><br>
the recording medium D101 (step SD501).<br>
[0184]<br>
Next, the byte code execution unit D124 obtains the<br>
device unique information necessary for the execution of the<br>
byte code, from the device unique information storage unit<br>
D13 3 (step SD5 02). The device unique information is<br>
information unique to each content reproducing device D102 .<br>
The device unique information is composed of, for example,<br>
"device manufacturer ID + reproducing device model number<br>
+ reproducing device manufacturing serial number", and<br>
assigned to each content reproducing device D102. That is,<br>
the content reproducing device D102 can be uniquely identified<br>
by the device unique information.<br>
[0185]<br>
By executing the obtained byte code D112, the byte code<br>
execution unit D124 generates restoration setting information<br>
and transmits the restoration setting information to the<br>
content restoration processing unit D126 (step SD503) . The<br>
restoration setting information is information necessary for<br>
the reverse operation of the transformation processing<br>
performed on the transformed content data. One example of<br>
the restoration setting information is shown in FIG. 62 . the<br>
restoration setting information includes an operation mode<br>
D701, restoration operation processing D702, a restoration<br>
operation-use parameter specif icationD703 , and device unique<br>
information D706. The operation mode D701 is information<br>
specifying an operation in the restoration processing of the<br>
transformed content data. The operation mode D701 is any of<br>
108<br><br>
"device unique mode (0x00)" in which processing differs for<br>
each reproducing device using the device unique information<br>
D706, "content unique mode (0x01)" in whichprocessing differs<br>
for each set of content recorded on the recording medium D101,<br>
"device unique mode + content unique mode (0x11)" that<br>
implements both the device unique mode and the content unique<br>
mode, and "non-transformation mode (0x00)" in which<br>
restoration processing is not performed. However, the<br>
operation mode D7 01 is not limited to these, as other modes<br>
may be defined and submit ted to use. The restoration operation<br>
processing D702 is an operation method for restoring the<br>
content data, and uses "XOR operation (0x00)" and "DES (Data<br>
Encryption Standard) encryption (0x01)". However, the<br>
restoration operation processing D702 is not limited to these,<br>
as other operations such as ROT may be defined and submitted<br>
to use. The restoration operation-use parameter<br>
specification D703 specifies a parameter used for the<br>
restoration operation of the content data, and is made up<br>
of a head position D704 and a data length D705. Binary data<br>
that actually serves as a parameter is written in the<br>
restoration processing-use TS packet multiplexed in the<br>
protected content data. Data of the length specified by the<br>
data length D705, beginning with the data specified by the<br>
head position D7 04 from the start of the payload data of the<br>
restoration processing-use packet, is used as the parameter<br>
for the restoration processing. In detail, 4-byte data<br>
beginning with the 10th byte from the start of the payload<br>
of the restoration processing-use TS packet is used as the<br>
109<br><br>
parameter.<br>
[0186]<br>
The device unique information D7 06 is data used when<br>
the operation mode is "device unique mode" or "device unique<br>
mode + content unique mode", and is information unique to<br>
the content reproducing device D102 . For example, the device<br>
unique information D7 06 may be the value stored in the device<br>
unique information storage unit D13 3, or may be a value newly<br>
generated by the byte code using the data stored in the device<br>
unique information storage unit D13 3.<br>
[0187]<br>
Further, when executing the byte code in the content<br>
reproducing device D102 having particular device unique<br>
information, an operation of prohibiting generation of data<br>
necessary for the restoration processing of the protected<br>
content data may be implemented in the byte code . The content<br>
holder selects the byte code D112 recorded on the recording<br>
medium D101. Hence the content holder itself can prohibit<br>
content reproduction in the particular content reproducing<br>
device D102 , independently of the revocation of the particular<br>
content reproducing device D102 by the revocation information<br>
D115.<br>
[0188]<br>
This completes the descriptionof the byte code execution<br>
processing.<br>
(Restoration of Transformed Content Data)<br>
The following describes details of the restoration<br>
110<br><br>
processing SD2 08 of the transformed content data in the content<br>
restoration processing unit D126, with use of FIG. 61.<br>
Transformed content data, which is the result of<br>
decrypting the protected content data D113 in the decryption<br>
unit D125, is input to the content restoration processing<br>
unit D126. FIG. 63 shows a structure of the transformed<br>
content data. The transformed content data complies with<br>
transport streams as stipulated in the MPEG 2 system, and<br>
is formed by multiplexing a restoration processing-use TS<br>
packet D801, video data-use TS packets D802, audio data-use<br>
TS packets D8 03, and the like. Transformation processing is<br>
applied to the payload of the video data-use TS packets, but<br>
is not limited to being so.<br>
The content restoration processing unit D126 checks the<br>
PIDs of the TS packet headers of TS packets input from the<br>
decryption unit D125, in order to confirm the type of each<br>
TS packet (step SD6 01).<br>
[0189]<br>
The content restoration processing unit D126 obtains<br>
the payload of the TS packet, when the input TS packet is<br>
a restoration processing-use TS packet.<br>
The following describes a data structure of a restoration<br>
processing-use TS packet with use of FIG. 64.<br>
The restoration processing-use TS packet is made up of<br>
a TS packet header D9 01 and a TS packet payload D9 02 which<br>
are stipulated as MPEG 2 system transport streams.<br>
[0190]<br>
The TS packet payload D902 is composed of an operation<br>
111<br><br>
mode D903, restoration operation processing D904, a<br>
transformation positionD905 , anda restoration operation-use<br>
parameter D9 08.<br>
The operation mode D903 is information for specifying<br>
the operation in the restoration processing. The operation<br>
mode D903 is any of "device unique mode (0x00)" and "content<br>
unique mode (0x01)" . However, these are not a limit for the<br>
present invention, as other modes maybe defined and submitted<br>
to use.<br>
[0191]<br>
The restoration operation processing D904 is an<br>
operation method for restoring the content data. The<br>
restoration operation processingD904 is any of "XOR operation<br>
(0x00)" and "DES encryption (0x01)" . However, these are not<br>
a limit for the present invention, as other operations such<br>
as ROT may be defined and submitted to use.<br>
The transformation position D905 is information for<br>
specifying the position where the data is transformed, and<br>
is composed of a packet D90S and an in-packet position D907.<br>
The data transformation position is specified by a relative<br>
position from the restoration processing-use TS packet, and<br>
indicates that a TS packet which matches the number written<br>
in the packet D906, counted from the next TS packet of the<br>
restoration processing-use TS packet D906, has been<br>
transformed. Further, the transformation position D905<br>
indicates that transformation processing has been applied<br>
beginning with data corresponding to the byte count shown<br>
in the in-packet position D907, from the head of the TS packet<br>
112<br><br>
payload of that TS packet. In detail, in FIG. 64A,<br>
transformation processing has been applied to data beginning<br>
with the 100th (0x64) byte from the head of the TS packet<br>
payload of the second TS packet from the next packet of the<br>
restoration processing-use TS packet. The restoration<br>
operation-use parameter D908 is binary data that serves as<br>
the parameter used in the data restoration processing.<br>
[0192]<br>
There are two types of restoration processing-use TS<br>
packet D8 01, namely, the device unique mode (FIG. 64A) and<br>
the content unique mode (FIG. 64B) . Though they have the same<br>
data structure, the restoration processing-use TS packet D801<br>
of the device unique mode (FIG. 64A) does not need the<br>
restoration operation processing D904 and the restoration<br>
operation-use parameter D908, so that 0 is embedded in these<br>
data. Although 0 is embedded in these data in the present<br>
embodiment, another value may be written instead.<br>
[0193]<br>
Returning to FIG. 61, after step SD602, the content<br>
restoration processing unit D126 checks whether the<br>
restoration setting information obtained from the byte code<br>
execution unit D124 beforehand matches the operation mode<br>
of the restoration processing-use TS packet (step SD603).<br>
A specific matching criterion is shown in a table of FIG.<br>
65 . As one example, when the value of the operation mode D7 01<br>
of the restoration setting information obtained from the byte<br>
code execution unit D124 shows the content unique mode (0x01) ,<br>
the content restoration processing unit D126 judges a match<br>
113<br><br>
for a TS packet written with the content unique mode (0x01) ,<br>
and a mismatch for a TS packet written with the device unique<br>
mode (0x10).<br>
[0194]<br>
If the operation modes match in step SD603, the data<br>
transformation position is specif iedusing the transformation<br>
position D905 in the restoration processing-use TS packet<br>
(step SD604).<br>
Next, the operation-use parameter is determined from<br>
the restoration operation-use parameter D908 in the<br>
restoration processing-use TS packet and the restoration<br>
operation-use parameter specif icationD703 in the restoration<br>
setting information obtained from the byte code execution<br>
unit D124 beforehand, and the determined operation-use<br>
parameter is acquired (step SD605).<br>
[0195]<br>
The content restoration processing unit D12 6 resets a<br>
packet read count that is an internal variable held by the<br>
content restoration processing unit D126 , in order to specify<br>
the data transformation position in the succeeding TS packets<br>
(step SD606), and ends the processing.<br>
When the packet type is other than a restoration<br>
processing-use packet at step SD602, the content restoration<br>
processing unit D126 checks whether the operation mode of<br>
the last read restoration processing-us TS packet matches<br>
the restoration setting information obtained from the byte<br>
code execution unit D124 beforehand (step SD607).<br>
[0196]<br>
114<br><br>
When the result of step SD60 7 is a match, the content<br>
restoration processing unit D126 increments the packet read<br>
count (step SD6 08) , and checks whether or not the packet read<br>
count and the transformation position match (step SD609).<br>
When the packet read count and the transformation<br>
position match, the content restoration processing unit D126<br>
specifies the transformed data based on the in-packet position<br>
D907 specif ied at stepSD604, performs a data operation using<br>
the restoration setting information obtained from the byte<br>
code execution unit D124 beforehand and the parameter acquired<br>
at step SD605 (step SD610), and ends the processing.<br>
[0197]<br>
This completes the description of the transformed<br>
content data restoration processing of step SD2 08 by the<br>
content restoration processing unit D126.<br>
Note that in the present embodiment the specification<br>
of the transformed data restoration processing is obtained<br>
as the execution result of the byte code D112, but the<br>
specification may be written in the restoration<br>
processing-use TS packet.<br>
Also, the present embodiment describes the case where<br>
the restoration operation-use parameter specification D703 ,<br>
which is the information for specifying the parameter used<br>
for the restoration processing, is obtained as the execution<br>
result of the byte code D112 . Alternatively, the restoration<br>
operation-use parameter specification may be written in the<br>
restoration processing-use TS packet.<br>
[0198]<br>
115<br><br>
Also, the present embodiment describes the case where<br>
the content restoration processing unit D126 performs the<br>
restoration processing in accordance with the operation mode<br>
D701 in the restoration setting information which is the<br>
execution result of the byte code D112. Alternatively, the<br>
restoration processing may be performed in accordance with<br>
only the operation mode D903 in the restorationprocessing-use<br>
TS packet multiplexed in the transformed content data, without<br>
using the operation mode D701 specified by the restoration<br>
setting information.<br>
[0199]<br>
Also, the present embodiment describes the case where,<br>
in the restoration processing TS packet, the transformation<br>
position D905 of the content data is specif iedusing the packet<br>
D906 showing the relative position from the restoration<br>
processing-use TS packet and the in-packet position D907<br>
showing the data position within that packet. However, other<br>
information may instead be used so long as it can specify<br>
the transformation position of the content data, such as the<br>
byte count from the head of the transformed content data.<br>
(Conclusion)<br>
In recent years, accompanying increases in capacity of<br>
storage media, systems have become widespread in which content<br>
that is a work such as a movie is digitized, and stored and<br>
distributed on a medium such as a digital optical disc. In<br>
such a system, it is necessary to protect the copyright of<br>
the content and to enable reproduction, copying, and the like<br>
116<br><br>
of the content to be performed only under restrictions that<br>
comply with an agreement with the copyright holder. A general<br>
system for protecting works from being unauthorizedly copied<br>
by a party without the permission of the copyright holder<br>
has a structure in which digital content is encrypted with<br>
a content key managed by the copyright holder, recorded on<br>
a disc, and is only able to be decrypted by a terminal that<br>
has a corresponding content key. Furthermore, regulations<br>
regarding copyright protection established with the copyright<br>
holder must be followed in order to obtain the content key.<br>
[0200]<br>
As one example of such a system, Japanese Patent<br>
Application Publication No. 2000-100069 discloses a method<br>
by which the content key for encrypting and decrypting content<br>
data is generated based on a function of a seed key and time<br>
variable data.<br>
In this case, it is necessary to manage the content key<br>
strictly so that it is not exposed. However, it is possible<br>
that the content key will be exposed to an unauthorized party<br>
due so some kind of accident or occurrence. Once the content<br>
key has been exposed to an unauthorized party, there is a<br>
risk that the content key of subsequent content will be exposed<br>
using the same method. It is expected that this will lead<br>
to subsequent unauthorized use of content being unable to<br>
be prevented. With a conventional technique, since the<br>
content data is protected only by the content key that is<br>
protected according to a stipulated method, it is susceptible<br>
to this kind of attack.<br>
117<br><br>
[0201]<br>
In view of the aforementioned problem, the present<br>
invention has an object of providing a recording medium, a<br>
data processing method, and a data processing device that<br>
protect content so that even if a way to crack content<br>
protection is discovered according to some kind of accident<br>
or occurrence, other content is unable to be used<br>
unauthorizedly with the same method.<br>
Furthermore, the present invention has an object of<br>
providing a recording medium, a data processing method, and<br>
a data processing device that enable specification of an<br>
unauthorized reproducing device that was able to crack content<br>
protection, based on content whose protection method has been<br>
cracked and is being unauthorizedly distributed in a format<br>
usable by anyone.<br>
[0202]<br>
In order to solve theaf orementionedproblem, the present<br>
invention provides a recording medium on which content data<br>
is recorded, wherein the content data is protected by<br>
encryption with a content key, and data transformation<br>
according to an operation that is different to the encryption.<br>
Furthermore, the present invention provides the recording<br>
medium, wherein in addition to the content data, the content<br>
key and a program for calculating a parameter necessary for<br>
restoration of the content data are recorded on the recording<br>
medium.<br>
[0203]<br>
Moreover, the present invention provides the recording<br>
118<br><br>
medium, wherein the program enables the calculation of the<br>
parameter only by an authorized data processing device that<br>
is permitted to use the content data. Moreover, the present<br>
invention provides the recording medium, wherein the<br>
parameter includes terminal unique information. Moreover,<br>
the present invention provides the recording medium, wherein<br>
the parameter includes information f or distinguishing whether<br>
restoration processing is unique to the content or is unique<br>
to a data processing device.<br>
[0204]<br>
Furthermore, the present invention provides a recording<br>
medium on which content data is recorded, wherein the content<br>
data is protected by encryption with a content key, and data<br>
transformation according to an operation that is different<br>
to the encryption, and part or all of the parameter is recorded<br>
multiplexed with the content data. Moreover, the present<br>
invention provides the recording medium, wherein the part<br>
or all of the parameter that is recorded multiplexed with<br>
the content data includes information that specifies a data<br>
transformation position.<br>
[0205]<br>
Moreover, the present invention provides a data<br>
processing method for reproducing content data that is<br>
recorded on a recording medium, the content data being<br>
protected by encryption with a content key, and data<br>
transformation according to an operation that is different<br>
to the encryption, the data processing method including: a<br>
step of decrypting with the content key; and a step of<br>
119<br><br>
performing restoration of the content data.<br>
[0206]<br>
Moreover, the present invention provides the data<br>
processing method, wherein the step of performing restoration<br>
of the content data includes: a step of, before reproduction<br>
commences, calculating a parameter necessary for restoration<br>
processing; and a step of, during reproduction, performing<br>
the restoration processing of the content data using the<br>
parameter, the steps being separate. Moreover, the present<br>
invention provides the data processing method, wherein in<br>
the step of performing parameter calculation, device unique<br>
information is used.<br>
[0207]<br>
Furthermore, the present invention provides the data<br>
processing method, wherein in the step of performing the<br>
restoration processing of the content data, device unique<br>
information is used.<br>
Furthermore, the present invention provides the data<br>
processing method, wherein in the step of performing the<br>
restoration processing of the content data, content unique<br>
information is used.<br>
Furthermore, the present invention provides the data<br>
processing method, wherein the step of performing restoration<br>
of the content data during reproduction performs the<br>
restoration processing in accordance with restoration<br>
processing-use data that is multiplexed with the content data.<br>
Moreover, the present invention provides the data processing<br>
method wherein the step of performing restoration of the<br>
120<br><br>
content data during reproduction specifies the data<br>
transformation position according to the restoration<br>
processing-use data, and performs restoration processing.<br>
[0208]<br>
Furthermore, the present invention provides a data<br>
processing device for reproducing content data that is<br>
recorded on a recording medium, the content data being<br>
protected by encryption with a content key, and data<br>
transformation according to an operation that is different<br>
to the encryption, the data processing device including: an<br>
information reading unit operable to read information from<br>
the recording medium; a unit operable to decrypt with the<br>
content key; a unit operable to store terminal unique<br>
information; a unit operable to execute a program for<br>
calculating a parameter necessary for restoration of the<br>
content data; a unit operable to perform restoration<br>
processing of the content data using the calculated<br>
information necessary for restoration; and a decoding unit<br>
operable to decode the content data.<br>
[0209]<br>
As has been described, the present invention has the<br>
effect of being able to provide a recording medium, a data<br>
protection method, a data processing method, and a data<br>
processing device by which content is protected such that<br>
the content is not reproduced unauthorizedly, even if the<br>
content key is leaked due to some kind of accident or occurrence,<br>
and circulated among the general public.<br>
Furthermore, the present invention enables<br>
121<br><br>
specification of an unauthorized reproducing device that was<br>
able to crack content protection, based on content whose<br>
protection method has been cracked and is being unauthorizedly<br>
distributed in a format usable by anyone.<br>
5. General Overview<br>
Each embodiment of the present invention has been<br>
described above. The following gives a general overview of<br>
the present invention by focusing on the embodiments Al and<br>
Bl which are particularly representative of the above<br>
embodiments.<br>
[0210]<br>
Although the terms used in the embodiments Al and Bl<br>
are somewhat different, the byte code processing unit, the<br>
decryption unit, the restoration processing unit, the stream<br>
decryption unit, the demultiplexer, the byte code data, the<br>
encrypted content file, the transformed content file, the<br>
terminal ID, and the terminal ID reference in the embodiment<br>
Al respectively correspond to and are substantially<br>
equivalent to the byte code execution unit, the content<br>
restoration processing unit, the demultiplexing unit, the<br>
byte code, the protected content data, the transformed content<br>
data, the device unique information, and the device unique<br>
information embedment in the embodiment B1. Also, the<br>
decoding unit in the embodiment Al corresponds to the video<br>
decoder and the audio decoder in the embodiment B1.<br>
(Summary)<br>
122<br><br>
FIG. 28 shows a structure of a recording medium B101<br>
and a content reproducing device B102 pertaining to one<br>
embodiment of the present invention.<br>
[0211]<br>
Recorded on the recording medium B101 is the byte code<br>
B112 and the protected content data B113.<br>
The protected content data B113 is plaintext MPEG 2 TS<br>
data that can be output as video by a decoder, and has been<br>
subject to encryption processing with a content key, and<br>
further to data transformation processing, for example part<br>
of the data being substituted with a different value.<br>
[0212]<br>
Hereinafter, the data obtained as a result of decrypting<br>
the protected content data B113 is called transformed content<br>
data.<br>
FIG. 34 shows an example of transformed content data.<br>
The transformed content data complies with transport<br>
streams as stipulated in the MPEG 2 system, and has the<br>
restoration processing-use TS packet B701, the video data-use<br>
TS packets B702, the audio data-use TS packets B703 and the<br>
like multiplexed therewith.<br>
[0213]<br>
The following describes a data structure of the<br>
restoration processing-use TS packet. A PMT stipulated in<br>
the MPEG 2 system is used as the restoration processing-use<br>
TS packet. Specifically, a restoration instruction<br>
descriptor is written at the head of a descriptor first loop<br>
in a PMT section. The restoration instruction descriptor<br>
123<br><br>
includes restoration information.<br>
The restoration information and the byte code data are<br>
described below. The restoration information and the byte<br>
code data are used at the content reproducing device for<br>
reversing the transformation processing. The byte code data<br>
is, for example, the type of code executable in a virtual<br>
operation unit, such as a JAVA virtual machine, and is the<br>
data describing a code executable at the content reproducing<br>
device.<br>
[0214]<br>
The restoration information includes a secret parameter<br>
identifying value, a restoration instruction flag, a terminal<br>
unique information reference position, a relative packet<br>
count, an in-packet position, a byte size of restoration target<br>
data, and a restoration-use parameter.<br>
The following describes the data structuring the<br>
restoration information. The restoration instruction flag<br>
is a flag that shows whether or not to perform restoration<br>
using this restoration processing-use packet, the possible<br>
values thereof having the meanings shown in FIG. 37. The<br>
restoration instruction flag may be omitted. In the case of<br>
the restoration instruction flag instructing "10 (device<br>
unique information embedment) " , the device unique information<br>
reference position shows a bit position to be referenced in<br>
the device unique information. The relative packet count and<br>
the in-packet position are information for specifying where<br>
the data is transformed, the position where the data is<br>
transformed being shown as a relative position to the<br>
124<br><br>
restoration processing-use TS packet. The in-packet<br>
position shows that a transformed TS packet is located,<br>
counting from the next TS packet after the restoration<br>
processing-use TS packet, the number of packets listed in<br>
the relative packet count. The in-packet position<br>
additionally shows that transformation processing has been<br>
applied to data, the head of which is the number of bytes<br>
shown by the in-packet position from the head of the TS packet<br>
payload of the TS packet. The byte size of restoration target<br>
data shows the number of bytes of the transformed data. The<br>
restoration-use parameter is data used in restoring the<br>
transformed data.<br>
[0215]<br>
The restoration information is encrypted according to<br>
AES using a secret parameter. Note that the restoration<br>
information, excluding the secret parameter identifying value,<br>
may be encrypted using a method other than AES, such as dividing<br>
the restoration information into secret parameter units and<br>
finding an XOR of each with the secret parameter. The secret<br>
parameter is an encryption key of the restoration information<br>
and is held by the byte code.<br>
An example of the operation of a reproducing terminal<br>
is described with reference to FIG. 11, which shows its main<br>
parts. The reproducing terminal A1101 reads the byte code<br>
data A1103 from the recording medium A205 . In the reproducing<br>
terminal A1101, in preparation for reproduction, the byte<br>
code processing unit A1110 then analyzes the byte code data<br>
A1103, acquires the secret parameters, and transmits the<br>
125<br><br>
secret parameters together with the terminal ID to the<br>
restoration processing unit A1106.<br>
[0216]<br>
Subsequently, at reproduction, the reproducing<br>
terminal A1101 reads the encrypted contents file A1102 . The<br>
decryption unit A1104 decrypts the encrypted content file<br>
and outputs the resultant decrypted content file A1102 to<br>
the transformation processing-use packet extraction unit<br>
A1105 as the transformed content. Upon detection of the<br>
transformation processing-use packets, the transformation<br>
processing-use packet extraction unit A1105 outputs the<br>
transformation processing-use packets and the remaining<br>
transformed content to the restoration processing unit A1106 .<br>
The restoration processing unit A1106 decrypts the piece of<br>
restoration information 501 in each of the transformation<br>
processing-use packets , via an XOR operation or the like using<br>
a corresponding secret parameter, and carries out the<br>
following restoration processing on the basis of each<br>
decrypted piece of restoration information A501.<br>
[0217]<br>
When the restoration instruction flag indicates that<br>
restoration is performed, or alternatively, when the<br>
restoration instruction flag indicates terminal ID reference<br>
and a part of the value of the terminal ID specified by the<br>
terminal ID reference position is 1, the restoration<br>
processing unit A1106 implements restoration processing. It<br>
achieves this by specifying the starting position of the<br>
restoration target data in the transformed content on the<br>
126<br><br>
basis of the relative packet count and the in-packet position,<br>
and by overwriting (replacing), with the restoration-use<br>
parameter, a same number of bytes as indicated by the<br>
restoration target data byte size.<br>
Subsequently, the restoration processing unit A1106<br>
outputs the restored content to the demultiplexer A1107, and<br>
the demultiplexer 1107 converts the content information,<br>
which includes video and audio data, into a format that can<br>
be processed by the decoding unit A1109. The demultiplexer<br>
A1107 outputs the converted content information to the video<br>
buffer A1108, and the decoding unit A1109 carries out the<br>
processing associated with reproduction and output of the<br>
content.<br>
[0218]<br>
(Effects of the Invention)<br>
The present invention makes it possible to include<br>
information that changes depending on device unique<br>
information, into content at the time of reproduction. In<br>
so doing, it is possible to specify a reproducing terminal<br>
that took an unauthorized copy or unauthorizedly distributed<br>
the content.<br>
Also, the process of decrypting (restoring) the<br>
encrypted (transformed) content and the process of including<br>
the device unique information into the content at the time<br>
of reproduction can be performed by substantially the same<br>
operation (overwriting with the restoration-use parameter<br>
at the position specified by the restoration information).<br>
[0219]<br>
127<br><br>
Conventionally, the device unique information is<br>
embedded after the content decryption process . Accordingly,<br>
the data which has been decrypted and not embedded with the<br>
device unique information can be extracted between the content<br>
decryption process and the device unique information<br>
embedment process. The data in this state is viewable since<br>
it has already been decrypted. Also, since no device unique<br>
information has been embedded yet, even if the data is<br>
distributed by unauthorized means, it is impossible to specify<br>
the distributor. Such data is extremely advantageous for an<br>
unauthorized party.<br>
[0220]<br>
In view of this, the present invention makes it possible<br>
to perform the content decryption and the device unique key<br>
embedment by substantially the same process. Both the<br>
decryption and the device unique information embedment can<br>
be completed in one process, so that the above unauthorized<br>
act of extracting the data between the two processes can be<br>
suppressed.<br>
Also, according to the present invention, these two<br>
processes can be switched as needed and are substantially<br>
equivalent toeachother. Hence it isdif f icult todistinguish<br>
whether the output data is the decrypted data or the data<br>
embedded with the device unique information. Accordingly,<br>
an unauthorized party can be prevented from distinguishing<br>
and collecting only data in which no device unique information<br>
is embedded.<br>
128<br><br>
6. Other Modifications<br>
The present invention has been described based on, but<br>
is not limited to, the above embodiments. Cases such as the<br>
following are included in the present invention.<br>
[0221]<br>
(1)	Each described device is, specifically, a computer<br>
system composed of a microprocessor, a ROM, a RAM, a hard<br>
disk unit, a display unit, a keyboard, a mouse, and the like.<br>
Computer programs are stored in the RAM or the hard disk unit.<br>
Each device achieves predetermined functions by the<br>
microprocessor operating according to the computer programs .<br>
Each computer program is composed of a plurality of command<br>
codes that show instructions with respect to the computer,<br>
for achieving the predetermined functions.<br>
[0222]<br>
(2)	All or part of the compositional elements of each<br>
device may be composed from one system LSI (Large Scale<br>
Integrated circuit). The system LSI is a<br>
super-multifunctional LSI on which a plurality of<br>
compositional units are manufactured integrated on one chip,<br>
and is specifically a computer system that includes a<br>
microprocessor, aROM, aRAM, and the like. Computer programs<br>
are stored in the RAM. The system LSI achieves its functions<br>
by the microprocessor operating according to the computer<br>
programs.<br>
[0223]<br>
(3)	Part or all of the compositional elements of each<br>
device may be composed of a removable IC card or a single<br>
129<br><br>
module . The IC card or the module is a computer system composed<br>
of a microprocessor, a ROM, a RAM, and the like. The IC card<br>
or the module may include the aforementioned<br>
super-multifunctional LSI. The IC card or the module may<br>
achieve its functions by the microprocessor operating<br>
according to computer programs. The IC card or the module<br>
may be tamper-resistant.<br>
[0224]<br>
(4) The present invention may be methods shown by the<br>
above. Furthermore, the methods may be a computer program<br>
realized by a computer, and may be a digital signal of the<br>
computer program.<br>
Furthermore, the present invention may be a<br>
computer-readable recording medium such as a flexible disk,<br>
a hard disk, a CD-ROM, an MO, a DVD, a DVD-ROM, a DVD-RAM,<br>
a BD (Blu-ray Disc) or a semiconductor memory, that stores<br>
the computer program or the digital signal. Furthermore, the<br>
present invention may be the computer program or the digital<br>
signal recorded in any of the aforementioned recording media.<br>
[0225]<br>
Furthermore, the present invention may be the computer<br>
program or the digital signal transmitted on a network such<br>
as an electric communication network, a wireless or wired<br>
communication network, or an internet, or via data<br>
broadcasting and the like.<br>
Furthermore, the present invention may be a computer<br>
system that includes a microprocessor and a memory, the memory<br>
storing the computer program, and the microprocessor<br>
130<br><br>
operating according to the computer program.<br>
[0226]<br>
Furthermore, by transferring the program or the digital<br>
signal to the recording medium, or by transferring the program<br>
or the digital signal via a network or the like, the program<br>
or the digital signal may be executed by another independent<br>
computer system.<br>
(5)	The present invention is a recording medium having<br>
data recorded thereon, wherein the data is content data<br>
protected by data transformation and by encryption using a<br>
content key, the data transformation being an operation<br>
distinct from the encryption.<br>
[0227]<br>
(6)	The present invention is the recording medium of<br>
the above (5) , further having at least a program recorded<br>
thereon, wherein the program is for calculating a parameter<br>
required for restoring the content data.<br>
(7)	The present invention is the recording medium of<br>
the above (5), further having restoration information<br>
recorded thereon, wherein the restoration information is<br>
required for restoring the content data, and is multiplexed<br>
with the content data.<br>
[0228]<br>
(8)	The present invention is the recording medium of<br>
the above (5), further having restoration information<br>
recorded thereon, wherein the restoration information is<br>
required for restoring the content data, and is recorded as<br>
a different file from the content data.<br>
131<br><br>
(9)	The present invention is the recording medium of<br>
the above (5), further having restoration information<br>
recorded thereon, wherein the restoration information is<br>
required for restoring the content data, and is both<br>
multiplexed with the content data and recorded as a different<br>
file from the content data.<br>
[0229]<br>
(10)	The present invention is the recording medium<br>
of any of the above (7) to (9) , wherein part or all of the<br>
restoration information is encrypted using the parameter.<br>
(11)	The present invention is a data generating method<br>
for implementing operations on content data, including a step<br>
of implementing, on part or all of the content data, a<br>
transformation operation distinct from encryption using a<br>
content key.<br>
[0230]<br>
(12)	The present invention is the data generating method<br>
of the above (11) , further including a step of generating<br>
a program for a data processing device to calculate a parameter<br>
required for restoring the content data.<br>
(13)	The present invention is the data generating<br>
method of the above (11), further including the steps of:<br>
generating a program for a data processing device to<br>
calculate a parameter required for restoration processing<br>
of the content data; generating restoration information<br>
required for the restoration processing; encrypting the<br>
restoration inf ormationusing the parameter; and multiplexing<br>
the encrypted restoration information with the content data.<br>
132<br><br>
[0231]<br>
(14)	The present invention is the data generating<br>
method of the above (11) , further including the steps of:<br>
generating a program for a data processing device to<br>
calculate a parameter required for restoration processing<br>
of the content data; generating restoration information<br>
required for the restoration processing; encrypting the<br>
restoration information using the parameter; and generating<br>
the encrypted restoration information as a different file<br>
from the content data.<br>
[0232]<br>
(15)	The present invention is the data generating<br>
method of the above (11), further including the steps of:<br>
generating a program for a data processing device to<br>
calculate a parameter required for restoration processing<br>
of the content data; generating restoration information<br>
required for the restoration processing; encrypting the<br>
restoration information using the parameter; multiplexing<br>
the encrypted restoration information with the content data;<br>
and generating the encrypted restoration information as a<br>
different file from the content data.<br>
[0233]<br>
(16)	Also, the present invention is a data generating<br>
device for implementing operations on content data, including<br>
at least a unit operable to implement, on part or all of the<br>
content data, a transformation operation distinct from<br>
encryption using a content key.<br>
(17)	The present invention is the data generating<br>
133<br><br>
device of the above (16) , further including: a unit operable<br>
to generate a program to calculate a parameter required<br>
for restoration processing of the content data; a unit<br>
operable to generate restoration information required for<br>
the restoration processing; a unit operable to encrypt the<br>
restoration information using the parameter; and a unit<br>
operable to multiplex the encrypted restoration information<br>
with the content data.<br>
[0234]<br>
(18)	The present invention is the data generating<br>
device of the above (16) , further including: a unit operable<br>
to generate a program to calculate a parameter required<br>
for restoration processing of the content data; a unit<br>
operable to generate restoration information required for<br>
the restoration processing; a unit operable to encrypt the<br>
restoration information using the parameter; and a unit<br>
operable to generate the encrypted restoration information<br>
as a different file from the content data.<br>
[0235]<br>
(19)	The present invention is the data generating<br>
device of the above (16) , further including: a unit operable<br>
to generate a program to calculate a parameter required<br>
for restoration processing of the content data; a unit<br>
operable to generate restoration information required for<br>
the restoration processing; a unit operable to encrypt the<br>
restoration information using the parameter; a unit operable<br>
to multiplex the encrypted restoration information with the<br>
content data; and a unit operable to multiplex the encrypted<br>
134<br><br>
restoration information as a different file from the content<br>
data.<br>
[0236]<br>
(2 0) The present invention is a program causing a<br>
computer to execute the one or more steps included in the<br>
data generating method of any of the above (11) to (15).<br>
(21)	The present invention is a computer readable<br>
recording medium having recorded thereon a program for causing<br>
a computer to execute the one or more steps in the data<br>
generating method of any of the above (11) to (15) .<br>
[0237]<br>
(22)	The present invention is a recording medium on<br>
which content data is recorded, wherein the content data<br>
is protected by encryption with a content key, and data<br>
transformation according to an operation that is different<br>
to the encryption.<br>
(23)	The present invention is the recording medium<br>
of the above (22) , wherein in addition to the content data,<br>
the content key and a program for calculating a parameter<br>
necessary for restoration of the content data are recorded<br>
on the recording medium.<br>
[0238]<br>
(24)	The present invention is the recording medium<br>
of the above (23) , wherein the program enables calculation<br>
of the parameter only by an authorized data processing device<br>
that is permitted to use the content data.<br>
(25)	The present invention is the recording medium<br>
of the above (23) , wherein the parameter includes terminal<br>
135<br><br>
unique information.<br>
[0239]<br>
(26)	The present invention is the recording medium<br>
of the above (23) , wherein the parameter includes information<br>
for distinguishing whether restoration processing is unique<br>
to the content or unique to a data processing device.<br>
(27)	The present invention is the recording medium<br>
of the above (23) , wherein part or all of the parameter is<br>
recorded multiplexed with the content data.<br>
[0240]<br>
(28)	The present invention is the recording medium<br>
of the above (27) , wherein the part or all of the parameter<br>
that is recorded multiplexed with the content data includes<br>
information that specifies a data transformation position.<br>
(29)	The present invention is the recording medium<br>
of the above (23) , wherein part or all of the parameter is<br>
recorded as a file that is separate to the content data.<br>
[0241]<br>
(30)	The present invention is the recording medium<br>
of the above (2 9) , wherein the part or all of the parameter<br>
that is recorded multiplexed with the content data includes<br>
information that specifies a data transformation position.<br>
(31)	The present invention is the recording medium<br>
of the above (23) , wherein the recording medium had recorded<br>
thereon both a file that includes part or all of the parameter<br>
and is separate from the content data, and a file that includes<br>
part or all of the parameter and is multiplexed with the content<br>
data.<br>
136<br><br>
[0242]<br>
(32)	The present invention is a data processing method<br>
for reproducing content data that is recorded on a recording<br>
medium, the content data being protected by encryption with<br>
a content key, and data transformation according to an<br>
operation that is different to the encryption, the data<br>
processing method comprising: a step of decrypting with the<br>
content key; and a step of performing restorat ion of the content<br>
data.<br>
(33)	The present invention is the data processing<br>
method of the above (32), wherein the step of performing<br>
restoration of the content data includes: a step of, before<br>
reproduction commences, calculating a parameter necessary<br>
for restoration processing; and a step of, during<br>
reproduction, performing the restoration processing of the<br>
content data using the parameter, the steps being separate.<br>
[0243]<br>
(34)	The present invention is the data processing<br>
method of the above (33) , wherein in the step of performing<br>
parameter calculation, device unique information is used.<br>
(35)	The present invention is the data processing<br>
method of the above (33) , wherein in the step of performing<br>
the restoration processing of the content data, device unique<br>
information is used.<br>
(36)	The present invention is the data processing<br>
method of the above (33) , wherein in the step of performing<br>
the restorationprocessing of the content data, content unique<br>
information is used.<br>
137<br><br>
[0244]<br>
(37)	The present invention is the data processing<br>
method of the above (33) , wherein the step of performing<br>
restoration of the content data during reproduction performs<br>
the restoration processing in accordance with restoration<br>
processing-use data that is multiplexed with the content data.<br>
(38)	The present invention is the data processing<br>
method of the above (33) , wherein the step of performing<br>
restoration of the content data during reproduction performs<br>
the restoration processing in accordance with restoration<br>
processing-use data that is recorded as a separate file to<br>
the content data.<br>
[0245]<br>
(39)	The present invention is a data processing device<br>
for reproducing content data that is recorded on a recording<br>
medium, the content data being protected by encryption with<br>
a content key, and data transformation according to an<br>
operation that is different to the encryption, the data<br>
processing device comprising: an information reading unit<br>
operable to read information from the recording medium; a<br>
unit operable to decrypt with the content key; a unit operable<br>
to store terminal unique information; a unit operable to<br>
execute a program for calculating a parameter necessary for<br>
restoration of the content data; a unit operable to perform<br>
restoration processing of the content data using the<br>
calculated information necessary for restoration; and a<br>
decoding unit operable to decode the content data.<br>
[0246]<br>
138<br><br>
(40)	The present invention is a program that enables<br>
a computer to execute the steps included in the data processing<br>
method of any of the above (32) to (38) .<br>
(41)	The present invention is a computer-readable<br>
recording medium having recorded thereon a program that<br>
enables a computer to execute the steps included in the data<br>
processing method of any of the above (32) to (38).<br>
[0247]<br>
(42)	The present invention is a recording medium having<br>
data recorded thereon, wherein the data is content data<br>
protected by data transformation and by encryption using a<br>
content key, the data transformation being an operation<br>
distinct from the encryption.<br>
(43)	The present invention is the recording medium<br>
of the above (42), further having at least a program recorded<br>
thereon, wherein the program is for calculating a parameter<br>
required for restoring the content data.<br>
[0248]<br>
(44)	The present invention is the recording medium<br>
of the above (43) , wherein the program enables calculation<br>
of the parameter only by an authorized data processing device<br>
that is permitted to use the content data.<br>
(45)	The present invention is the recording medium<br>
of the above (43), wherein the parameter includes unique<br>
information of a data processing device.<br>
[0249]<br>
(46)	The present invention is the recording medium<br>
of the above (43) , wherein the parameter includes information<br>
139<br><br>
for distinguishing whether restoration processing is unique<br>
to the data processing device.<br>
(47)	The present invention is the recording medium<br>
of the above (43) , wherein part or all of the parameter is<br>
recorded multiplexed with the content data.<br>
[0250]<br>
(48)	The present invention is the recording medium<br>
of the above (4 7) , wherein the part or all of the parameter<br>
that is recorded multiplexed with the content data includes<br>
information that specifies a data transformation position.<br>
(49)	The present invention is a data generating method<br>
for implementing operations on content data, including a step<br>
of implementing, on part or all of the content data, a<br>
transformation operation distinct from encryption using a<br>
content key.<br>
[0251]<br>
(50)	The present invention is the data generating method<br>
of the above (49), wherein the step of performing<br>
transformation of the content data includes : a step of, before<br>
commencing reproduction of the content data, a data processing<br>
device generating a program for calculating a parameter<br>
necessary for restoration processing.<br>
(51)	The present invention is the data generating method<br>
of the above (49), wherein the step of performing<br>
transformation of the content data includes : a step of, before<br>
commencing reproduction of the content data, the data<br>
processing device generating a program for calculating<br>
information about part of a parameter necessary for<br>
140<br><br>
restoration processing; a step of generating restoration<br>
information data including information about the rest of the<br>
parameter necessary for the restoration processing; and a<br>
step of multiplexing the restoration information data with<br>
the content data.<br>
[0252]<br>
(52) The present invention is the data generating method<br>
of the above (51) , wherein the step of generating the program<br>
includes, into the program, information showing whether<br>
unique information of the data processing device is used in<br>
the reproduction by the data processing device.<br>
(53 ) The present invention is the data generating method<br>
of any of the above (50) to (52) , wherein the step of generating<br>
the program includes, into the program, unique information<br>
of the data processing device not permitted to perform<br>
reproduction.<br>
[0253]<br>
(54)	The present invention is the data generating method<br>
of the above (49), wherein the step of performing<br>
transformation of the content data includes: a step of<br>
analyzing video information of the content data; and a step<br>
of specifying a position of data to be transformed based on<br>
a result of analyzing the video information.<br>
(55)	The present invention is a data generating device<br>
for implementing operations on content data, including a unit<br>
operable to implement, on part or all of the content data,<br>
a transformation operation distinct from encryption using<br>
a content key.<br>
141<br><br>
[0254]<br>
(56)	The present invention is the data generating device<br>
of the above (14), further including: a unit operable to,<br>
before commencing reproduction of the content data, a data<br>
processing device generating a program for calculating a<br>
parameter necessary for restoration processing.<br>
(57)	The present invention is the data generating<br>
device of the above (55) , further including: a unit operable<br>
to, before commencing reproduction of the content data,<br>
a data processing device generating a program for<br>
calculating a parameter required for rest oration processing<br>
of the content data; a unit operable to generate restoration<br>
information data including information about the rest of the<br>
parameter required for the restoration processing; and a unit<br>
operable to multiplex the restoration information data with<br>
the content data.<br>
[0255]<br>
(58)	The present invention is a program that enables<br>
a computer to execute the steps included in the data processing<br>
method of any of the above (49) to (54).<br>
(59)	The present invention is a computer-readable<br>
recording medium having recorded thereon a program that<br>
enables a computer to execute the steps included in the data<br>
processing method of any of the above (4 9) to (54).<br>
[0256]<br>
(60)	The present invention is a recording medium on<br>
which content data is recorded, wherein the content data<br>
is protected by encryption with a content key, and data<br>
142<br><br>
transformation according to an operation that is different<br>
to the encryption.<br>
(61)	The present invention is the recording medium<br>
of the above (60) , wherein in addition to the content data,<br>
the content key and a program for calculating a parameter<br>
necessary for restoration of the content data are recorded<br>
on the recording medium.<br>
[0257]<br>
(62)	The present invention is the recording medium<br>
of the above (61) , wherein the program enables calculation<br>
of the parameter only by an authorized data processing device<br>
that is permitted to use the content data.<br>
(63)	The present invention is the recording medium<br>
of the above (61) , wherein the parameter includes terminal<br>
unique information.<br>
[0258]<br>
(64)	The present invention is the recording medium<br>
of the above (61) , wherein the parameter includes information<br>
for distinguishing whether restoration processing is unique<br>
to the content or unique to a data processing device.<br>
(65)	The present invention is the recording medium<br>
of the above (61) , wherein part or all of the parameter is<br>
recorded multiplexed with the content data.<br>
[0259]<br>
(66)	The present invention is the recording medium<br>
of the above (65) , wherein the parameter that is recorded<br>
multiplexed with the content data includes information that<br>
specifies a data transformation position.<br>
143<br><br>
(67)	The present invention is a data processing method<br>
for reproducing content data that is recorded on a recording<br>
medium, the content data being protected by encryption with<br>
a content key, and data transformation according to an<br>
operation that is different to the encryption, the data<br>
processing method comprising: a step of decrypting with the<br>
content key; and a step of performing restoration of the content<br>
data.<br>
[0260]<br>
(68)	The present invention is the data processing<br>
method of the above (67), wherein the step of performing<br>
restoration of the content data includes: a step of, before<br>
reproduction commences, calculating a parameter necessary<br>
for restoration processing; and a step of, during<br>
reproduction, performing the restoration processing of the<br>
content data using the parameter, the steps being separate.<br>
(69)	The present invention is the data processing<br>
method of the above (68) , wherein in the step of performing<br>
parameter calculation, device unique information is used.<br>
[0261]<br>
(70)	The present invention is the data processing<br>
method of the above (67) , wherein in the step of performing<br>
the restoration processing of the content data, device unique<br>
information is used.<br>
(71)	The present invention is the data processing<br>
method of the above (68) , wherein in the step of performing<br>
the restoration processing of the content data, content unique<br>
information is used.<br>
144<br><br>
[0262]<br>
(72)	The present invention is the data processing<br>
method of the above (68) , wherein the step of performing<br>
restoration of the content data during reproduction performs<br>
the restoration processing in accordance with restoration<br>
processing-use data that is multiplexed with the content data.<br>
(73)	The present invention is the data processing<br>
method of the above (72) , wherein the step of performing<br>
restoration of the content data during reproduction specifies<br>
a data transformation position in accordance with restoration<br>
processing-use data that is multiplexed with the content data,<br>
and performs the restoration processing.<br>
[0263]<br>
(74)	The present invention is a data processing device<br>
for reproducing content data that is recorded on a recording<br>
medium, the content data being protected by encryption with<br>
a content key, and data transformation according to an<br>
operation that is different to the encryption, the data<br>
processing device comprising: an information reading unit<br>
operable to read information from the recording medium; a<br>
unit operable to decrypt with the content key; a unit operable<br>
to store terminal unique information; a unit operable to<br>
execute a program for calculating a parameter necessary for<br>
restoration of the content data; a unit operable to perform<br>
restoration processing of the content data using the<br>
calculated information necessary for restoration; and a<br>
decoding unit operable to decode the content data.<br>
[0264]<br>
145<br><br>
(75)	The present invention is a program that enables<br>
a computer to execute the steps included in the data processing<br>
method of any of the above (67) to (73).<br>
(76)	The present invention is a computer-readable<br>
recording medium having recorded thereon a program that<br>
enables a computer to execute the steps included in the data<br>
processing method of any of the above (67) to (73).<br>
[0265]<br>
(77)	The present invention may be any combination of<br>
the above-described embodiments and modifications.<br>
Industrial Applicability<br>
[0266]<br>
The information recording medium on which is recorded<br>
content data encrypted and transformed for protecting<br>
copyright and information necessary for reproducing the<br>
content data, the data generation method, the data generating<br>
device, the data processing method, and the data processing<br>
device of the present invention are beneficial in fields such<br>
as packaged media.<br>
146<br><br>
CLAIMS<br>
1. A reproducing device for reproducing content data recorded<br>
on a recording medium,<br>
the content data and at least one piece of restoration<br>
information being recorded on the recording medium,<br>
each piece of restoration information including<br>
restoration position information that shows a position in<br>
the content data, a restoration-use parameter, and a<br>
restoration instruction flag,<br>
the restoration instruction flag indicating any of that<br>
(a) restoration processing of replacing part of the content<br>
data with the restoration-use parameter is performed, (b)<br>
the restoration processing is not performed, and (c) the<br>
restoration processing is performed depending on device<br>
unique information unique to the reproducing device,<br>
the reproducing device comprising:<br>
a device unique information storage unit operable to<br>
store the device unique information;<br>
an acquisition unit operable to acquire the content data<br>
and each piece of restoration information from the recording<br>
medium;<br>
a position specification unit operable to specify, in<br>
the acquired content data, the position shown by the<br>
restoration position information included in the acquired<br>
piece of restoration information;<br>
a restoration unit operable to perform the restoration<br>
processing on part of the content data corresponding to the<br>
147<br><br>
specified position, depending on the restoration instruction<br>
flag; and<br>
a reproducing unit operable to reproduce the content<br>
data after the restoration processing is performed depending<br>
on the restoration instruction flag.<br>
2.	The reproducing device of Claim 1,<br>
wherein each piece of restoration information is<br>
encrypted using a secret parameter,<br>
a byte code, in which a procedure of outputting the secret<br>
parameter is described in a form executable by the reproducing<br>
device, is further recorded on the recording medium,<br>
the reproducing device further comprises:<br>
a byte code execution unit operable to execute the byte<br>
code; and<br>
a decryption unit operable to decrypt the encryptedpiece<br>
of restoration information using the secret parameter output<br>
as a result of executing the byte code, and<br>
the restoration unit performs the restoration<br>
processing using the decrypted piece of restoration<br>
information.<br>
3.	The reproducing device of Claim 1,<br>
wherein each piece of restoration information is<br>
multiplexed in the content data, and<br>
the acquisition unit includes:<br>
a reading unit operable to read the content data<br>
including each piece of restoration information; and<br>
148<br><br>
an analysis unit operable to detect each piece of<br>
restoration information in the content data.<br>
4.	The reproducing device of Claim 1,<br>
wherein a restoration file constituted by the at least<br>
one piece of restoration information is recorded on the<br>
recording medium, and<br>
the acquisition unit acquires each piece of restoration<br>
information from the restoration file.<br>
5.	The reproducing device of Claim 1,<br>
wherein each piece of restoration information further<br>
includes bit position information showing a bit position in<br>
the device unique information, and<br>
when the restoration instruction flag indicates that<br>
the restoration processing is performed depending on the<br>
device unique information, the restoration unit performs the<br>
restoration processing if bit data in the device unique<br>
information corresponding to the bit position shown by the<br>
bit position information has a predetermined value.<br>
6.	A recording device for recording content data onto a<br>
recording medium, comprising:<br>
a transformation control unit operable to generate at<br>
least one piece of restoration information; and<br>
a storage unit operable to write the content data and<br>
the at least one piece of restoration information onto the<br>
recording medium,<br>
149<br><br>
wherein each piece of restoration information includes<br>
restoration position information that shows a position in<br>
the content data, a restoration-use parameter, and a<br>
restoration instruction flag, and<br>
the restoration instruction flag indicates any of that<br>
(a) restoration processing of replacing part of the content<br>
data with the restoration-use parameter is performed, (b)<br>
the restoration processing is not performed, and (c) the<br>
restoration processing is performed depending on device<br>
unique information.<br>
7.	The recording device of Claim 6,<br>
wherein the transformation control unit further<br>
encrypts each piece of restoration information using a secret<br>
parameter, and generates a byte code including a procedure<br>
of outputting the secret parameter, and<br>
the storage unit writes the encrypted piece of<br>
restoration information onto the recording medium, and<br>
further writes the generated byte code onto the recording<br>
medium.<br>
8.	The recording device of Claim 6, further comprising:<br>
a multiplexing unit operable to multiplex each piece<br>
of restoration information in the content data,<br>
wherein the storage unit writes the content data in which<br>
each piece of restoration information has been multiplexed,<br>
onto the recording medium.<br>
150<br><br>
9.	The recording device of Claim 6,<br>
wherein the at least one piece of restoration information<br>
generated by the transformation control unit constitutes a<br>
restoration file, and<br>
the storage unit writes the restoration file constituted<br>
by the at least one piece of restoration information, onto<br>
the recording medium.<br>
10.	A recording medium on which content data and at least<br>
one piece of restoration information are recorded,<br>
wherein each piece of restoration information includes<br>
restoration position information that shows a position in<br>
the content data, a restoration-use parameter, and a<br>
restoration instruction flag, and<br>
the restoration instruction flag indicates any of that<br>
(a) restoration processing of replacing part of the content<br>
data with the restoration-use parameter is performed, (b)<br>
the restoration processing is not performed, and (c) the<br>
restoration processing is performed depending on device<br>
unique information.<br>
11.	The recording medium of Claim 10,<br>
wherein each piece of restoration information is<br>
encrypted using a secret parameter, and<br>
a byte code including a procedure of outputting the<br>
secret parameter is further recorded on the recording medium.<br>
12.	The recording medium of Claim 10,<br>
151<br><br>
wherein each piece of restoration information is<br>
multiplexed in the content data.<br>
13.	The recording medium of Claim 10,<br>
wherein a restoration file constituted by the at least<br>
one piece of restoration information is recorded on the<br>
recording medium.<br>
14.	A data processing method used in a reproducing device<br>
for reproducing content data recorded on a recording medium,<br>
the content data and at least one piece of restoration<br>
information being recorded on the recording medium,<br>
each piece of restoration information including<br>
restoration position information that shows a position in<br>
the content data, a restoration-use parameter, and a<br>
restoration instruction flag,<br>
the restoration instruction flag indicating any of that<br>
(a) restoration processing of replacing part of the content<br>
data with the restoration-use parameter is performed, (b)<br>
the restoration processing is not performed, and (c) the<br>
restoration processing is performed depending on device<br>
unique information unique to the reproducing device,<br>
the reproducing device including:<br>
a device unique information storage unit operable to<br>
store the device unique information,<br>
the data processing method comprising steps of:<br>
acquiring the content data and each piece of restoration<br>
information from the recording medium;<br>
152<br><br>
specifying, in the acquired content data, the position<br>
shown by the restoration position information included in<br>
the acquired piece of restoration information;<br>
performing the restoration processing on part of the<br>
content data corresponding to the specified position,<br>
depending on the restoration instruction flag; and<br>
reproducing the content data after the restoration<br>
processing is performed depending on the restoration<br>
instruction flag.<br>
15. A data processing program used in a reproducing device<br>
for reproducing content data recorded on a recording medium,<br>
the content data and at least one piece of restoration<br>
information being recorded on the recording medium,<br>
each piece of restoration information including<br>
restoration position information that shows a position in<br>
the content data, a restoration-use parameter, and a<br>
restoration instruction flag,<br>
the restoration instruction flag indicating any of that<br>
(a) restoration processing of replacing part of the content<br>
data with the restoration-use parameter is performed, (b)<br>
the restoration processing is not performed, and (c) the<br>
restoration processing is performed depending on device<br>
unique information unique to the reproducing device,<br>
the reproducing device including:<br>
a device unique information storage unit operable to<br>
store the device unique information,<br>
the data processing program comprising steps of:<br>
153<br><br>
acquiring the content data and each piece of restoration<br>
information from the recording medium;<br>
specifying, in the acquired content data, the position<br>
shown by the restoration position information included in<br>
the acquired piece of restoration information;<br>
performing the restoration processing on part of the<br>
content data corresponding to the specified position,<br>
depending on the restoration instruction flag; and<br>
reproducing the content data after the restoration<br>
processing is performed depending on the restoration<br>
instruction flag.<br>
16 . An integrated circuit provided in a reproducing device<br>
for reproducing content data recorded on a recording medium,<br>
the content data and at least one piece of restoration<br>
information being recorded on the recording medium,<br>
each piece of restoration information including<br>
restoration position information that shows a position in<br>
the content data, a restoration-use parameter, and a<br>
restoration instruction flag,<br>
the restoration instruction flag indicating any of that<br>
(a) restoration processing of replacing part of the content<br>
data with the restoration-use parameter is performed, (b)<br>
the restoration processing is not performed, and (c) the<br>
restoration processing is performed depending on device<br>
unique information unique to the reproducing device,<br>
the integrated circuit comprising:<br>
a device unique information storage unit operable to<br>
154<br><br>
store the device unique information;<br>
an acquisition unit operable to acquire the content data<br>
and each piece of restoration information from the recording<br>
medium;<br>
a position specification unit operable to specify, in<br>
the acquired content data, the position shown by the<br>
restoration position information included in the acquired<br>
piece of restoration information;<br>
a restoration unit operable to perform the restoration<br>
processing on part of the content data corresponding to the<br>
specif iedposition, depending on the restoration instruction<br>
flag,- and<br>
a reproducing unit operable to reproduce the content<br>
data after the restoration processing is performed depending<br>
on the restoration instruction flag.<br>
17. A data recording method used in a recording device for<br>
recording content data onto a recording medium, comprising<br>
steps of:<br>
generating at least one piece of restoration<br>
information; and<br>
writing the content data and the at least one piece of<br>
restoration information onto the recording medium,<br>
wherein each piece of restoration information includes<br>
restoration position information that shows a position in<br>
the content data, a restoration-use parameter, and a<br>
restoration instruction flag, and<br>
the restoration instruction flag indicates any of that<br>
155<br><br>
(a) restoration processing of replacing part of the content<br>
data with the restoration-use parameter is performed, (b)<br>
the restoration processing is not performed, and (c) the<br>
restoration processing is performed depending on device<br>
unique information.<br>
18 . A data recording program used in a recording device for<br>
recording content data onto a recording medium, comprising<br>
steps of:<br>
generating at least one piece of restoration<br>
information; and<br>
writing the content data and the at least one piece of<br>
restoration information onto the recording medium,<br>
wherein each piece of restoration information includes<br>
restoration position information that shows a position in<br>
the content data, a restoration-use parameter, and a<br>
restoration instruction flag, and<br>
the restoration instruction flag indicates any of that<br>
(a) restoration processing of replacing part of the content<br>
data with the restoration-use parameter is performed, (b)<br>
the restoration processing is not performed, and (c) the<br>
restoration processing is performed depending on device<br>
unique information.<br>
19. An integrated circuit provided in a recording device for<br>
recording content data onto a recording medium, comprising:<br>
a transformation control unit operable to generate at<br>
least one piece of restoration information; and<br>
156<br><br>
a storage unit operable to write the content data and<br>
the at least one piece of restoration information onto the<br>
recording medium,<br>
wherein each piece of restoration information includes<br>
restoration position information that shows a position in<br>
the content data, a restoration-use parameter, and a<br>
restoration instruction flag, and<br>
157<br>
the restoration instruction flag indicates any of that<br>
(a) restoration processing of replacing part of the content<br>
data with the restoration-use parameter is performed, (b)<br>
the restoration processing is not performed, and (c) the<br>
restoration processing is performed depending on device<br>
unique information.<br><br><br><br>
To provide a data generating device capable of preventing unauthorized extraction of plaintext content between decryption processing and digital watermark embedment processing. A content reproducing device B102 to which the<br>
present invention relates obtains restoration information and, in accordance with the restoration information, selectively performs predetermined restoration processing<br>
and processing of embedding device unique information, on content data at a position shown by the restoration information.<br></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDQ2NzMta29sbnAtMjAwNy1hYnN0cmFjdC5wZGY=" target="_blank" style="word-wrap:break-word;">04673-kolnp-2007-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDQ2NzMta29sbnAtMjAwNy1jbGFpbXMucGRm" target="_blank" style="word-wrap:break-word;">04673-kolnp-2007-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDQ2NzMta29sbnAtMjAwNy1jb3JyZXNwb25kZW5jZSBvdGhlcnMucGRm" target="_blank" style="word-wrap:break-word;">04673-kolnp-2007-correspondence others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDQ2NzMta29sbnAtMjAwNy1kZXNjcmlwdGlvbiBjb21wbGV0ZS5wZGY=" target="_blank" style="word-wrap:break-word;">04673-kolnp-2007-description complete.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDQ2NzMta29sbnAtMjAwNy1kcmF3aW5ncy5wZGY=" target="_blank" style="word-wrap:break-word;">04673-kolnp-2007-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDQ2NzMta29sbnAtMjAwNy1mb3JtIDEucGRm" target="_blank" style="word-wrap:break-word;">04673-kolnp-2007-form 1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDQ2NzMta29sbnAtMjAwNy1mb3JtIDIucGRm" target="_blank" style="word-wrap:break-word;">04673-kolnp-2007-form 2.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDQ2NzMta29sbnAtMjAwNy1mb3JtIDMucGRm" target="_blank" style="word-wrap:break-word;">04673-kolnp-2007-form 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDQ2NzMta29sbnAtMjAwNy1mb3JtIDUucGRm" target="_blank" style="word-wrap:break-word;">04673-kolnp-2007-form 5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDQ2NzMta29sbnAtMjAwNy1vdGhlcnMucGRm" target="_blank" style="word-wrap:break-word;">04673-kolnp-2007-others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDQ2NzMta29sbnAtMjAwNy1wY3QgcHJpb3JpdHkgZG9jdW1lbnQgbm90aWZpY2F0aW9uLnBkZg==" target="_blank" style="word-wrap:break-word;">04673-kolnp-2007-pct priority document notification.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDQ2NzMta29sbnAtMjAwNy1wY3QgcmVxdWVzdCBmb3JtLnBkZg==" target="_blank" style="word-wrap:break-word;">04673-kolnp-2007-pct request form.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LSgwOC0wOC0yMDE0KS1DT1JSRVNQT05ERU5DRS5wZGY=" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-(08-08-2014)-CORRESPONDENCE.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LSgwOC0wOC0yMDE0KS1GT1JNLTEucGRm" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-(08-08-2014)-FORM-1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LSgwOS0wNS0yMDE0KS1BTk5FWFVSRSBUTyBGT1JNIDMucGRm" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-(09-05-2014)-ANNEXURE TO FORM 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LSgwOS0wNS0yMDE0KS1DT1JSRVNQT05ERU5DRS5wZGY=" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-(09-05-2014)-CORRESPONDENCE.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LSgwOS0wNS0yMDE0KS1PVEhFUlMucGRm" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-(09-05-2014)-OTHERS.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LSgxMC0wNy0yMDE0KS1BQlNUUkFDVC5wZGY=" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-(10-07-2014)-ABSTRACT.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LSgxMC0wNy0yMDE0KS1DTEFJTVMucGRm" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-(10-07-2014)-CLAIMS.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LSgxMC0wNy0yMDE0KS1DT1JSRVNQT05ERU5DRS5wZGY=" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-(10-07-2014)-CORRESPONDENCE.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LSgxMC0wNy0yMDE0KS1EUkFXSU5HUy5wZGY=" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-(10-07-2014)-DRAWINGS.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LSgxMC0wNy0yMDE0KS1GT1JNLTEucGRm" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-(10-07-2014)-FORM-1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LSgxMC0wNy0yMDE0KS1GT1JNLTIucGRm" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-(10-07-2014)-FORM-2.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LSgxMC0wNy0yMDE0KS1QQS5wZGY=" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-(10-07-2014)-PA.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LSgxMC0wNy0yMDE0KS1QRVRJVElPTiBVTkRFUiBSVUxFIDEzNy5wZGY=" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-(10-07-2014)-PETITION UNDER RULE 137.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LSgxNC0wMi0yMDE0KS1BTk5FWFVSRSBUTyBGT1JNIDMucGRm" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-(14-02-2014)-ANNEXURE TO FORM 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LSgxNC0wMi0yMDE0KS1DT1JSRVNQT05ERU5DRS5wZGY=" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-(14-02-2014)-CORRESPONDENCE.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LUNPUlJFU1BPTkRFTkNFIE9USEVSUyAxLjEucGRm" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-CORRESPONDENCE OTHERS 1.1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LUNPUlJFU1BPTkRFTkNFLTEuMi5wZGY=" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-CORRESPONDENCE-1.2.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LUZPUk0gMS0xLjEucGRm" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-FORM 1-1.1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LUZPUk0gMTMucGRm" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-FORM 13.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1rb2xucC0yMDA3LWZvcm0gMTgucGRm" target="_blank" style="word-wrap:break-word;">4673-kolnp-2007-form 18.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LUZPUk0gMi0xLjEucGRm" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-FORM 2-1.1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LUdQQS5wZGY=" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-GPA.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LU9USEVSUyAxLjEucGRm" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-OTHERS 1.1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LU9USEVSUy0xLjIucGRm" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-OTHERS-1.2.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDY3My1LT0xOUC0yMDA3LVJFUExZIFRPIEVYQU1JTkFUSU9OIFJFUE9SVC5wZGY=" target="_blank" style="word-wrap:break-word;">4673-KOLNP-2007-REPLY TO EXAMINATION REPORT.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=YWJzdHJhY3QtMDQ2NzMta29sbnAtMjAwNy5qcGc=" target="_blank" style="word-wrap:break-word;">abstract-04673-kolnp-2007.jpg</a></p>
		<br>
		<div class="pull-left">
			<a href="264386-method-and-apparatus-for-transmitting-receiving-mbms-transport-blocks.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="264388-method-and-apparatus-for-correcting-errors-in-a-multiple-subcarriers-communication-system-using-multiple-antennas.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>264387</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>4673/KOLNP/2007</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>52/2014</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>26-Dec-2014</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>24-Dec-2014</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>03-Dec-2007</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>PANASONIC CORPORATION,</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>1006, OAZA KADOMA, KADOMA SHI, OSAKA 571 8501, JAPAN,</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>SENICHI ONODA</td>
											<td>C/O. PANASONIC CORPORATION, OF 1006, OAZA KADOMA, KADOMA-SHI, OSAKA-571-8501, JAPAN,</td>
										</tr>
										<tr>
											<td>2</td>
											<td>MASAYA YAMAMOTO</td>
											<td>C/O. PANASONIC CORPORATION, OF 1006, OAZA KADOMA, KADOMA-SHI, OSAKA-571-8501, JAPAN,</td>
										</tr>
										<tr>
											<td>3</td>
											<td>MINEHISA NAGATA</td>
											<td>C/O. PANASONIC CORPORATION, OF 1006, OAZA KADOMA, KADOMA-SHI, OSAKA-571-8501, JAPAN,</td>
										</tr>
										<tr>
											<td>4</td>
											<td>KAORU MURASE</td>
											<td>C/O. PANASONIC CORPORATION, OF 1006, OAZA KADOMA, KADOMA-SHI, OSAKA-571-8501, JAPAN,</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>G11B 20/10</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/JP2006/310274</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2006-05-23</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>60/683,654</td>
									<td>2005-05-23</td>
								    <td>U.S.A.</td>
								</tr>
								<tr>
									<td>2</td>
									<td>60/689,669</td>
									<td>2005-06-13</td>
								    <td>U.S.A.</td>
								</tr>
								<tr>
									<td>3</td>
									<td>60/683,653</td>
									<td>2005-05-23</td>
								    <td>U.S.A.</td>
								</tr>
								<tr>
									<td>4</td>
									<td>60/689,530</td>
									<td>2005-06-13</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/264387-reproducing-device-recording-device-recording-medium-data-processing-method-data-processing-program-data-recording-method-data-recording-program-and-integrated-circuit by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 01:08:26 GMT -->
</html>
