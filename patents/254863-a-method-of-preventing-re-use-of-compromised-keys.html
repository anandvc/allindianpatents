<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/254863-a-method-of-preventing-re-use-of-compromised-keys by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 11:12:45 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 254863:A METHOD OF PREVENTING RE-USE OF COMPROMISED KEYS</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">A METHOD OF PREVENTING RE-USE OF COMPROMISED KEYS</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>RENEWABLE TRAITOR TRACING&quot; A system, method, and computer program product to renewably prevent traitors in a broadcast encryption system from re-using compromised keys. A lincense agency assigns individual receivers a set of Sequence Keys preferably at manufacture, and assigns Sequence Key Blocks (SKBs) to protected content files to be distributed- The files may be distributed on prerecorded media and typically include several file modifications. The particular modifications in a pirated version of a file can help identify which traitors contributed to its theft, SKBs assigned to new files distributed after traitors have been identified cannot be usefully processes using the compromised keys employed in previous content piracy. Innocent receivers that happen to have compromised key(s) in common with traitors can use a replacement uncompromised Sequence Keyfrom the set to usefuly decrypt content. Traitors will however step through all their Sequence Keys without reaching one that will work.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>a <br><br>
RENEWABLE TRAITOR TRACING<br>
Field of the Invention<br>
This invention relates to preventing piracy of digital content in a broadcast encryption system  and more specifically to tracing traitors who may be colluding to redistribute such content and/or related decryption keys, and to renewably revoking compromised keys to prevent further use in gaining unauthorized access to content.<br>
Background of the Invention<br>
The widespread transition of data from analog format to digital format has exacerbated problems relating to unauthorized copying and redistribution of protected content.  Flawless copies of content can be easily produced and distributed via the Internet or on physical media.  This piracy is a major concern and expense for content providers;   to this end, industry consortia such as The 4C Entity (<www .com>) and AACSLA (<www .aacsla. com>) have been formed. These groups are license agencies that provide content protection tools based on Content Protection for Recordable Media (CPRM) and Advanced Access Content System (AACS), respectively-  CPRM is a technology developed and licensed by the 4C group, comprising IBM, Intel, Matsushita, and Toshiba, to allow consumers to make authorized copies of commercial entertainment content where the copyright holder for such content has decided to proLecL it from unauthorized copying,  AACS is a follow-on technology for the came purpose, under development by a  group comprising IBM, Intel, Matsushxta, Toshiba, Sony, Microsoft, Warner Brothers, and Disney.<br>
CPRM and AACS protected files are encrypted with a key that is specific to a Media Identifier on their original storage medium (such as  a DVD or CD-ROM etc.), so simply copying the content to another storage medium does not break the protection.  CPRM also adds a Media Key Block (MKB) to the medium. The MKB is a rile containing a very large number of keys. Each individual compl^anL device is assigned a set of unique Device Keys that allow it to obtain the Media Key from the MKB, that is  then combined with the Media Identifier and other values to derive the keys used to decrypt the protected content. Details of the CPP.M and AACS technology are provided, in PCT  Patent Publication numbers WO 02/060116, WO 02/060118 and published US patent application numbers 2002-0106087, 2002-0114471, 2002-0104001 and 2004-011611 and   are  also available from 4C and AACS,<br><br>
Fundamentally, Lhe AACS protection depends on Lhe Interaction between Device Keys and the tree-based Media Key Block, which allows unlimited, precise cryptographic revocation of compromised devices without danger of collateral damage to innocent devices. Because of the inherent power of the revocation of the AACS system, it is possible that attackers may forgo building clones or non-compliant devices and instead devote themselves to attacks where they try to hide the underlying compromised device(s)* These attacks are both more expensive and more legally risky for the attackers, because the attacks require them to have an active server serving either content keys or the content itself, on an instance-by-instance basis.<br>
In addition to conventional CD-ROMs, and DVDs, a new type of home consumer device for digital content management has been enabled by the advent of inexpensive, large-capacity hard disks, A movie rental box receives digital movies from some inexpensive source of data, usually a broadcast source (whether terrestrial or satellite-based). The movies are stored on the hard disk, so LhaL aL any moment Lhe hard disk contains, for example, the hundred hottest movies in the rental market. The consumer selects and plays a particular movie, and the movie rental box periodically calls a clearing center and reports the consumer's content usage for billing purposes; the box may also acquire new decryption keys during this call.<br>
The most serious attack against these new devices is likely to be the so-called '"anonymous" attack, wherein a user or a group of users purchase rental movies from legitimate movie rental boxes that have been instrumented so that the protected content and/or the decryption keys can be captured and redistributed, often over the Internet. This attack is the most urgent concern of the movie studios that are investigating content protection technology.<br>
One solution to the problem is to differently watermark and differently encrypt each movie for each authorized movie rental box, so that if a movie is pirated, the watermarking and encryption information would uniquely identify the compromised box. Alas, this solution is not feasible because of the excessive computing effort and transmission bandwidth required to prepare and transmit individualized movies . The distribution system is economical only if the movies can be distributed over broadcast channels, i.e. where every receiver gets substantially the same data at the same time.<br>
The approach known in the art as "tracing traitors" may be used to solve the problem. In one particular instance of this approach, an original version of each movie file is augmented before being broadcast.  Specifically, the file that is actually broadcast has had at least one critical file segment replaced by a set of segment variations.  Each file segment variation is<br><br>
differently encrypted and preferably also differently watermarked prior to encryption, although the entire file may be watermarked as well. Ail the variations in one segment are identical for viewing purposes though digitally different. A particular receiver is preferably given the cryptographic key to decrypt only one of the variations in each segment. All legitimate receivers with valid decryption keys can play the content, but probably through different segment combinations, if the receiver is compromised and is used to illegally rebroadcast either Lhe keys or the segments themselves, it is possible to deduce which receiver or receivers have been compromised.<br>
The tracing traitors approach has not been widely used in practice to date because previous implementations required unreasonable amounts of bandwidth in the broadcast, due to the number of segments or variations required However, published US patent application US 2004-011611, entitled "Method for Tracing Traitors and Preventing Piracy of Digital Content in a Broadcast Encryption System' teaches a method of distributing protected content that combats piracy and enables identification and revocation of compromised receivers in a broadcast encryption system without excessive transmission bandwidth.<br>
To recap, whether dealing with DVDs or set-top boxes or other distribution means, a traitor tracing scheme has two basic steps; assigning the keys to receiver devices to enable tracing, and then identifying the traitors for revocation.  Efficient trailer tracing Lechnologies direcLed to boLh these steps enable a license agency to more quickly identify traitors and to prevent piracy even by larger groups of colluding traitors.<br>
However, what happens after a traitor has been identified and a particular compromised key or set of keys is revoked? The prior art is silent as to the aftermath of a single tracing and revocation. What if a traitor repeats the attack and additional content is pirated, and/or a new key or set of keys is compromised? A system is needed that allows innocent receiver devices to still calculate a correcL cryptographic answer needed to allow content Lo be used, while at the same time preventing traitor devices from getting to such an answer.<br>
Disclosure of the Invention<br>
The invention employs Sequence Keys and a Sequence Key Block (SKB) Lo extend the previous work on broadcast encryption and traitor tracing*  The Sequence Keys are assigned by a license agency to individual playback devices preferably from a key matrix. The license agency also assigns SKBs to be used on prerecorded media, in a manner similar to that of the MKBs (Media Key Blocks)<br><br>
u<br>
used in the CPRM system.  Any compliant device can process the SKB  and  get the right decryption key and access the content correctly.  In a preferred embodiment, successful processing of the SKB enables the device to properly use the set of variations assigned to it- When a traitor device is identified and its set of Sequence Keys is to be revoked, a new SKB is formulated and distributed on new media*<br>
If  a device has no compromised  Sequence Keys, it decrypts protected content on the new media in a straightforward manner by calculating the correct decryption key, preferably for its assigned variations-  If a device has  a compromised Sequence Key, then that key is not used, but instead another Sequence Key from a set (in a preferred embodiment, the next key in a linked list) is selected and used if it too has not been compromised* If it has also been compromised, then another available key in the set is selected, and so forth.  Thus, innocent devices are given multiple opportunities to find an unrevoked Sequence Key to usefully decrypt the protected content. This approach provides renewability of the Sequence Keys -<br>
The formulation of the new SKB by the license agency assures that all of the Sequence Keys in particular devices that have been identified as traitors will be deemed compromised when those devices try to,play the content on the new media. Thus a traitor device will step through all of its Sequence Keys without finding one that will usefully decrypt the protected content-<br>
The invention may be employed with broadcast encryption systems using distribution means that may include computer networks, satellite networks, cable networks, television transmissions, and physical storage media. Files may comprise any kind of digital data sequence, including but not limited to text, audio, images, video, music, movies, multimedia presentations, operating systems, video games, software applications, and cryptographic keys.<br>
Brief Description pf tha Dravings<br>
FIG. 1 is a prior art diagram of a modified distributed file.<br>
FIG. 2 is a flowchart of the basic operation of a preferred embodiment of the present invention»<br>
FIG, 3 is a diagram oI a Sequence Key Block (SKB), according Lo a preferred embodiment of the present invention.<br><br>
FIG. 4 is a diagram of a Nonce Record format, according to an embodiment of the present invention.<br>
FIG. 5 is a diagram of a Calculate Variant Data Record format, according to an embodiment of the present invention.<br>
1;'1G, 6 is a diagram of a Conditionally Calculate Variant Data Record format, according to an embodiment of the present invention,<br>
FIG. 7 is a diagram of an End of Sequence Key Block Record format, according to an embodiment of the present invention.<br>
Detailed Description of the Invention<br>
Referring now to t'lG, 1, a prior art diagram of a modified or augmented distributed file 100 is shown. This file is described in detail in published US patent application US 2004-011611, entitled "Method for Tracing Traitors and Preventing Piracy of Digital Content in a Broadcast Encryption System". The augmented file 100 is the modified version of an original file that will actually be broadcast. The augmented file 100 includes sets of file variations that replaced critical file segments. For example, a first critical file segment has been replaced with variations 102, 104, 106, and 108, while a second critical file segment has been replaced with variations 110, 112, 114, and 116, and so forth* Each file segment variation is simply a copy of the particular corresponding critical file segment that has been differently watermarked and differently encrypted. Each entire file is also typically watermarked and encrypted in a broadcast encryption system. Each file segment variation is identified by a text designation in this application (e.g. A, B, C. . , etc.) for clarity, but in practice binary numbers are generally employed for this purpose.<br>
The number of critical file segments and the number of file segment variations preferably employed depends on the properties of the file and its audience.  For movies, one could select a single critical file segment and have several hundred file segment variations; however, attackers might sinply choose to omit that single critical file segment in a pirated copy of the file, in hopes that viewers would not find such a glitch to be overly annoying. A pirated movie with say 15 missing critical 5-second scenes is probably going to be too annoying to any viewer for it to be of any commercial value.  Thus, the illegally broadcast movies are either substantially disrupted or the attackers must incorporate some of their file segment variations, which will facilitate traitor tracing.<br><br>
Sets of Sequence Keys are assigned to individual devices by the license agency out of a matrix of keys. The licensing agency will generate Sequence Keys organized in a large matrix. The matrix preferably has 256 columns and not more than 65,536 rows* Each cell in the matrix is a different Sequence Key. A single receiver device has one key in each column. Thus, each device has 256 Sequence Keys in this example. In this respect. Sequence Keys are somewhat analogous to the CPRM technology Media Keys.<br>
The licensing agency assigns the Sequence Key Blocks to be used with protected files. Sequence Key Blocks are similar to the CPRM Media Key Blocks, but important differences exist, arising both from the use different ciphers (preferably AES instead of C2) and from unique considerations of specific attacks that could be employed against Sequence Key lists.  However, unlike MKBs, the SKBs are preferably not part of the fundamental cryptographic protection of the content.  The fundamental protection of AACS is the Media Key. In a preferred embodiment of the present invention, the 3KB merely allows different variants of the Media Key to be calculated by different devices.<br>
Referring now to FIG, 3, a diagram of a Sequence Key Block (SKB) according to a preferred embodiment of the present invention is shown. The SKB begins with a first column 300, called the "unconditional" column. This column will have an encryption of the output key 302 (denoted "K" in the figure) in every uncompromised Sequence Key (to be precise, it is encrypted in a key derived from Lhe Sequence Key, noL the Sequence Key itself) . Devices LhaL do noL have compromised keys in that column immediately decrypt the output key, and they are done. Devices, both innocent and otherwise, that do have compromised keys instead preferably decrypt a key called a Link Key 304 that allows them to process a further column in the SKB. To process the further column, such devices need both the Link Key and their Sequence Key in that column* Thus the subsequent columns are called "conditional" columns because they can only be processed by the device if it had been given the necessary Link Key in a previous column.<br>
The conditional columns are produced Lhe general same way as the lirsL column, i.e. they will have an encryption of the output key in every uncompromised Sequence Key. Devices with a compromised key will get a further Link Key 304 instead of the output key. However, after some number of columns (depending on the actual number of compromised keys), the license agency will know that only compromised devices are getting the Link Key, because all innocent devices would have found the output key in this column or a previous column. At this point, rather than encrypting a Link Key, the agency simply encrypts a 0 (item 306), and the SKB is complete.<br><br>
How do the devices know they have a Link Key 304 versus the output key 302? The short answer is they do not, at least not at first. Each conditional column preferably has a header 308 of known data (e.g, the hexademical value DEADBEEF is often used) encrypted in the Link Key 304 for that column* The device decrypts the header 308 with the key it currently has. If the header 308 decrypts correctly, the device knows it has a Link Key 304 and processes the column, if it does not decrypt correctly, the device knows it has either the output key 302 or a Link Key 304 for a further column. When it reaches the end of the SKB, it knows it must have an output key 302. Note that this device logic allows the license agency to send different populations of devices to different columns by having more than one Link Key 304 output from a single column. For example, in the figure, column (1) links to both column (2) and column (5).  This flexibility can help against certain types of attacks,<br>
A unique consideration for Sequence Key lists arises from the following attack scenario.  Suppose a coalition of hackers is formed that includes one identified and revoked traitor^ and at least one other receiver that has not been revoked.  The known traitor's first Sequence Key is used on a current SKB, and a Link Key 304 results because that Sequence Key is compromised. The invention then moves to the next column in the SKB and tries to determine if it' s dealing with an innocent receiver that merely happens to have a compromised key in common with a traitor. However, instead of using the known traitor's next Sequence Key (which would lead to yet another Link Key 304 and eventually to a 0), the coalition now employs the other, unrevoked, receiver's Sequence Key along with the Link Key 304 from the previous column.  In this attack and related variants, the possibility exists that the coalition would fool the system and gain access to the protected content in a way that would confound subsequent tracing of all the traitors. To guard against this scenario, the key matrix from which SKBs are generated is preferably subdivided into sub-populations small enough to allow deterministic identification of all traitors in a coalition comprising an identified revoked traitor and new "turncoats" that have not yet been identified and revoked by a given SKB. All tralLor tracing schemes used in this scenario are within the scope of this invention*  Similarly, SKB subdivision and population management is also employed against scenarios in which candidate Sequence Keys are not selected by proceeding through a set of Sequence Keys in any particular order.<br>
Although the invention has been described above as producing a single correct cryptographic answer enabling access to protected content, in the broader case, there is not just a single output key, but multiple output keys termed Variant Data, Calculation of the Media Key Variant Data using Sequence Keys is now described.<br><br>
Each AACS-compliant device capable of playing pre-recorded content is given a set of secret Sequence Keys when manufactured. These are in addition to the Device Keys that all AACS devices require. These Sequence Keys are provided by the license agency and are for use in processing the Sequence Key Block* The result of the calculation is Variant Data which is then combined with the Media Key from the Media Key Block to generate the Media Key Variant-Key sets may either be unique per device, or used commonly by multiple devices.<br>
In a preferred embodiment, each device receives 256 64-bit Sequence Keys, which are referred to as Ks_i (i=0,1, . . ., 255) . For each Sequence Key there is an associated Column and Row value, referred to as CS_i and Rs_i (i = 0, 1, . . ., n-1) respectively. Column and Row values start at 0* For a given device^ no two Sequence Keys will have the same associated Column value (in other words, a device will have at most one Sequence Key per Column) . It is possible for a device to have some Sequence Keys with the same associated Row values.<br>
A device uses a Sequence Key Ks_i together with the Media Key K^ to calculate the Media Sequence Key Kms_i as follows;<br>
K,s = AES G(K„, Ks_i II 0000000000000016)<br>
AES is the American Encryption Standard, a block cipher adopted as an encryption standard by the U.S. government.  AES is described in detail in National Institute of Standards and Technology (NIST), Advanced Encryption Standard {AES), FIPS Publication 197, November 26, 2001, and National Institute of Standards and Technology (NIST), Recommendation for Block Cipher Modes of Operation - Methods and Techniques, NIST Special Publication 800-38A, 2001 Edition*  See also the AES common book. Advanced Access Content System; Introduction and Common Cryptographic Elements.<br>
AES_G is a one-way function defined using the AES cipher. The AES-based one-way function result is calculated as:<br>
AES_G(x:, X2) = AES_128D(x1, X2) XOR X2.<br>
where XOR is the bitwise exclusive-OR function.  AE3_G is specified in the AES common book, in section 2.1.3.<br>
AES_ECBD is the AES decrypt function in electronic codebook mode (AES Electronic CodeBook Decrypt) *  In this mode, the cipher treats each 128-bit cipher text block as a word to be deciphered independently of any that came before or any that come after, as if it were looking it up in a codebook* When the cipher is used in this way, a change to one block of the cipher text<br><br>
only affects decryption of that block. Contrast this with AES in cipher block chaining mode, in which each cipher text block is combined with a value computed while deciphering the previous block in order to decipher it. When the cipher is operated in cipher block chaining mode, a change to any block of the cipher text affects decryption of all subsequent blocks in the chain. AES_ECBD (referred to as AES_128D(k, d) ) is specified in the AES common book, in section 2.1.1.<br>
The Sequence Keys thus serve a similar role that the Device Keys serve in CPRM, i.e. the device does not use its Sequence Key directly to decrypt, but instead it combines it with the Media Key first as shown above* That means that a given SKB is associated with a given MKB (because the 3KB depends on the Media Key for correct processing) . A device preferably treats its Sequence Keys as highly confidential, and their associated Row values as confidential, as defined in the AACS license agreement.<br>
The SKB is generated by the license agency and allows all compliant devices, each using their set of secret Sequence Keys and the Media Key, to calculate the Variant Data, Dv, which in turn allows them to calculate the Media Key Variant.  If a set of Sequence Keys is compromised in a way that threatens the integrity of the system, an updated SKB can be released that causes a device with the compromised set of Sequence Keys to calculate invalid Variant Data.  In this way, the compromised Sequence Keys are "revoked" by the new SKB.<br>
An SKB is formatted as a sequence of contiguous Records. Each Record begins with a one-byte Record Type field, followed by a three-byte Record Length field. The Record Type field value indicates the type of the Record, and the Record Length field value indicates the number of bytes in the Record, including the Record Type and the Record Length fields themselves. Record lengths are always multiples of 4 bytes. The Record Type and Record Length fields are never encrypted. Subsequent fields in a Record may be encrypted, depending on the Record Type.<br>
Using its Sequence Keys, a device calculates Dv by processing Records of the SKB one-by-one, in order, from first to last. Except where explicitly noted otherwise, a device must process every Record of the SKB. The device must not make any assumptions about the length of Records, and must instead use the Record Length field value to go from one Record to the next. If a device encounters a Record with a Record Type field value it does not recognize, it ignores that Record and skips to the next, h'or some Records, processing will result in the calculation of a Dv value. Processing of subsequent Records<br><br>
n.= y update the D. value that was calculated previously. After processing of the 3KB is completed, the device uses the most recently calculated Dv value as the final value for Dv,<br>
If a device correctly processes an SKB using Sequence Keys that are revoked by that SKB, the resulting final Dv will have the special value 000000000000016. This special value will never be an SKB's correct final Dv value, and can therefore always be taken as an indication that the device's Sequence Keys are revoked. Device behavior in this situation is defined by the particular implementation. As an example, a device could exhibit a special diagnostic code, as helpful information to a service technician.<br>
The remaining portion of this application describes in detail a particular implementation of the present invention, including various formats likely to be followed by the AACS license agency. However, the present invention is not limited to this particular implementation.<br>
Referring now to Figure 4, a Nonce Record format is shown according to an embodiment of the present invention.  The nonce number X is used in the Variant Data calculation as described below.  The nonce record will always precede the Calculate Variant Data Record and the Conditionally Calculate Variant Data Records in the SKB, although it may not immediately precede them.<br>
Referring now to Figure 5, a Calculate Variant Data Record format is shown according to an embodiment of the present invention, A properly formatted SKB will have exactly one Calculate Variant Data Record. Devices must ignore any Calculate Variant Data Records encountered after the first one in an SKB. The use of the reserved fields is currently undefined, and they are ignored. The Generation field will contain 0001-f. for the first generation. The Column field indicates the associated Column value for the Sequence Key to be used with this Record, as described below.  Bytes 20 and higher contain Encrypted Key Data (possibly followed by some padding bytes at the end of the Record, not shown in Figure 5) . The first ten bytes of the Encrypted Key Data correspond to Sequence Key Row 0, the next ten bytes correspond to Sequence Key Row 1, and so forth.<br>
Before processing the Record, the device checks that both of the following conditions are true;<br>
Generation == 000000016<br>
and<br>
the device has a Sequence Key with associated Column value Cd_i ==<br>
Column,or some i.<br><br><br>
It is not necessary for a first generation device to verify that Record Length is sufficient to index into the Encrypted Key Data, first generation devices are assured that the Encrypted Key Data contains a value corresponding to their Device Key's associated Row value.<br>
Referring now to Figure 6, a Conditionally Calculate Variant Data Record format is shown, according to an embodiment of the present invention. A properly formatted SKB may have zero or more Conditionally Calculate Media Key Records. Bytes 4 through 19 of the Record contain Encrypted Conditional Data (Dcd) • If decrypted successfully, as described below, bytes 4 through 7 contain the value DEADBEEF16, bytes 8-9 contains the associated Column value for the Device Key to be used with this Record, and bytes 10-11 contain a Generation value of 000116 for the first generation. Bytes 20 and higher contain Doubly Encrypted Variant Data (possibly followed by some padding bytes at the end of the Record, not shown in Figure 6) . The first ten bytes of the Doubly Encrypted Key Data correspond to Sequence Key Row 0, the next ten bytes correspond to Sequence Key Row 1, and so forth*<br>
Upon encountering a Conditional Calculate Variant Data Record, the device first calculates its current Media Key Variant, as follows: K^^v = AES_G(Km, Dv II OOOOOOOOOOOOOie)<br>
Where D,, is its current Variant Data calculated from a previous Calculate Variant Data Record or Conditional Calculate Variant Data Record.<br>
Using its current Kmv value, the device calculates Conditional Data (Dc) as:<br>
Dc   =   AES_ECBD(Kmvf    Dee)-<br><br><br>
bits to each as needed.  The resulting by becomes the current Variant Data value.  This record is always a multiple of 4 bytes; if necessary, pad bytes are added on the end.<br>
Referring now to Figure 7, an End of Sequence Key Block Record format is shown, according to an embodiment of the present invention.  A properly formatted SKB contains an End of Sequence Key Block Record.  When a device encounters this Record it stops processing the SKB, using whatever Dv value it has calculated up to that point as the final Dv for that SKB,<br>
The End of Sequence Key Block Record contains the license agency's signature on the data in the Sequence Key Block up to, but not including, this record. Devices may ignore the signature daLa. However, if any device checks the signatures and determines that the signature does not verify or is omitted, it must refuse to use the Variant Data. The length of this record is always a multiple of 4 bytes.<br>
Regarding the calculation of the Media Key Variant from the Variant Data, when the device has finished processing the SKB, and if it has not been revoked, it will have an 80-bit valid Variant Data Dv, The device calculates the Media Key Variant from the Variant Data as follows:<br>
K^v = AES_G(Kn„ Dv I 000000000000000016)<br><br>
In addition, the low-order 10 bits of the Variant Data identify the Variant Number for the device to use in playing the content, from 0 to 1023. This number usually denotes the particular Title Key file the device should use to decrypt the content, although the meaning and use of the Variant Number is format-specific.<br>
A general purpose computer is programmed according to the inventive steps herein.  The invention can also be embodied as an article of manufacture -a machine component - that is used by a digital processing apparatus to execute the present logic. This invention is realized in a critical machine component that causes a digital processing apparatus to perform the inventive method steps herein.  The invention may be embodied by a computer program that is executed by a processor within a computer as a series of computer-executable instructions. These instructions may reside, for example, in RAM of a computer or on a hard drive or optical drive of the computer, or the instructions may be stored on a UASD array, magnetic tape, electronic read-only memory, or other appropriate data storage device.<br><br><br><br><br><br><br><br><br><br>
CLAIMS<br>
1.	A method of preventing re-use of compromised keys in a broadcast encryption system,<br>
comprising:<br>
(a)	incorporating a particular set of Sequence Keys assigned by a license agency into individual receivers;<br>
(b)	assigning a Sequence Key Block (SKB) by the license agency to at least one distributed protected file;<br>
(c)	incremental cryptographic testing by the individual receivers to determine (200) if a selected Sequence Key is compromised;<br>
(dl) if the selected Sequence Key is not compromised then responsively properly decrypting (202) the file and ending the method;<br>
(d2) if the selected Sequence Key is compromised then responsively determining (204) if a subsequent Sequence Key from the set is available;<br>
(el) if a subsequent Sequence Key is available then selecting (206) that subsequent Sequence Key and retuming to step (c); and<br>
(e2) if a subsequent Sequence Key is not available then the method ends (208) without properly decrypting the file.<br>
2.	The method of claim 1 wherein the Sequence Keys select a particular set of variations in the file.<br>
3.	The method of claim 1 wherein the SKB is formulated to cryptographically revoke particular receivers.<br>
4.	The method of claim 1 wherein the set includes a linked list.<br>
5.	The method of claim 1 wherein the testing further comprises crytographically applying the selected Sequence Key and a Link Key if then available to the SKB to obtain a predetermined value indicating whether the selected Sequence Key is compromised.<br><br>
6.	The method of claim 5 wherein if the selected Sequence Key is compromised, a Link<br>
key leading to said subsequent Sequence Key is generated.<br>
7.	A system for preventing re-use of compromised keys configured to the perform the<br>
steps as claimed in any of the preceding method claims 1 - 6.<br>
8.	Ana Apparatus for for preventing re-use of compromised keys in a broadcast<br>
encryption system configured to perform the steps as claimed in any of the preceding claims 1<br>
-6.</www></www></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1DSEVOUC0yMDA4ICAgQU1FTkRFRCAgUEFHRVMgT0YgU1BFQ0lGSUNBVElPTiAgIDI3LTExLTIwMTIucGRm" target="_blank" style="word-wrap:break-word;">1894-CHENP-2008   AMENDED  PAGES OF SPECIFICATION   27-11-2012.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1DSEVOUC0yMDA4ICAgQU1FTkRFRCBDTEFJTVMgICAyNy0xMS0yMDEyLnBkZg==" target="_blank" style="word-wrap:break-word;">1894-CHENP-2008   AMENDED CLAIMS   27-11-2012.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1DSEVOUC0yMDA4ICAgQ09SUkVTUE9OREVOQ0UgT1RIRVJTIDE3LTEyLTIwMTIucGRm" target="_blank" style="word-wrap:break-word;">1894-CHENP-2008   CORRESPONDENCE OTHERS 17-12-2012.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1DSEVOUC0yMDA4ICAgRVhBTUlOQVRJT04gUkVQT1JUIFJFUExZIFJFQ0VJVkVEICAgMjctMTEtMjAxMi5wZGY=" target="_blank" style="word-wrap:break-word;">1894-CHENP-2008   EXAMINATION REPORT REPLY RECEIVED   27-11-2012.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1DSEVOUC0yMDA4ICAgRk9STS0xICAgMjctMTEtMjAxMi5wZGY=" target="_blank" style="word-wrap:break-word;">1894-CHENP-2008   FORM-1   27-11-2012.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1DSEVOUC0yMDA4ICAgRk9STS0xMyAgIDI3LTExLTIwMTIucGRm" target="_blank" style="word-wrap:break-word;">1894-CHENP-2008   FORM-13   27-11-2012.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1DSEVOUC0yMDA4ICAgRk9STS0zICAgMjctMTEtMjAxMi5wZGY=" target="_blank" style="word-wrap:break-word;">1894-CHENP-2008   FORM-3   27-11-2012.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1DSEVOUC0yMDA4ICAgT1RIRVIgUEFURU5UIERPQ1VNRU5UICAgMjctMTEtMjAxMi5wZGY=" target="_blank" style="word-wrap:break-word;">1894-CHENP-2008   OTHER PATENT DOCUMENT   27-11-2012.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1DSEVOUC0yMDA4ICBBTUVOREVEIFBBR0VTIE9GIFNQRUNJRklDQVRJT04gMTctMTItMjAxMi5wZGY=" target="_blank" style="word-wrap:break-word;">1894-CHENP-2008  AMENDED PAGES OF SPECIFICATION 17-12-2012.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1DSEVOUC0yMDA4ICBBU1NJR05NRU5UIDE3LTEyLTIwMTIucGRm" target="_blank" style="word-wrap:break-word;">1894-CHENP-2008  ASSIGNMENT 17-12-2012.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1DSEVOUC0yMDA4ICBDT1JSRVNQT05ERU5DRSBPVEhFUlMgIDMxLTEwLTIwMTIucGRm" target="_blank" style="word-wrap:break-word;">1894-CHENP-2008  CORRESPONDENCE OTHERS  31-10-2012.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1jaGVucC0yMDA4LWFic3RyYWN0LnBkZg==" target="_blank" style="word-wrap:break-word;">1894-chenp-2008-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1jaGVucC0yMDA4LWNsYWltcy5wZGY=" target="_blank" style="word-wrap:break-word;">1894-chenp-2008-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1jaGVucC0yMDA4LWNvcnJlc3BvbmRuZWNlLW90aGVycy5wZGY=" target="_blank" style="word-wrap:break-word;">1894-chenp-2008-correspondnece-others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1jaGVucC0yMDA4LWRlc2NyaXB0aW9uKGNvbXBsZXRlKS5wZGY=" target="_blank" style="word-wrap:break-word;">1894-chenp-2008-description(complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1jaGVucC0yMDA4LWRyYXdpbmdzLnBkZg==" target="_blank" style="word-wrap:break-word;">1894-chenp-2008-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1jaGVucC0yMDA4LWZvcm0gMS5wZGY=" target="_blank" style="word-wrap:break-word;">1894-chenp-2008-form 1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1jaGVucC0yMDA4LWZvcm0gMTgucGRm" target="_blank" style="word-wrap:break-word;">1894-chenp-2008-form 18.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1jaGVucC0yMDA4LWZvcm0gMjYucGRm" target="_blank" style="word-wrap:break-word;">1894-chenp-2008-form 26.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1jaGVucC0yMDA4LWZvcm0gMy5wZGY=" target="_blank" style="word-wrap:break-word;">1894-chenp-2008-form 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1jaGVucC0yMDA4LWZvcm0gNS5wZGY=" target="_blank" style="word-wrap:break-word;">1894-chenp-2008-form 5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTg5NC1jaGVucC0yMDA4LXBjdC5wZGY=" target="_blank" style="word-wrap:break-word;">1894-chenp-2008-pct.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="254862-a-mold-for-injection-molding-and-a-method-of-operating-a-mold.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="254864-a-tyre-having-a-radial-carcass-reinforcement.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>254863</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>1894/CHENP/2008</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>52/2012</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>28-Dec-2012</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>27-Dec-2012</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>17-Apr-2008</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>INTERNATIONAL BUSINESS MACHINES CORPORATION</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>ARMONK, NEW YORK 10504</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>LOTSPIECH, JEFFREY, BRUCE</td>
											<td>2858 HARTWICK PINES DRIVE HENDERSON, NEVADA 89052</td>
										</tr>
										<tr>
											<td>2</td>
											<td>NIN, SIGFREDO, ISMAEL</td>
											<td>2150 GREENWOOD AVENUE MORGAN HILL, CA 95037</td>
										</tr>
										<tr>
											<td>3</td>
											<td>JIN, HONGXIA</td>
											<td>1342 PETAL WAY SAN JOSE CA 95129</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04L 9/08</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/EP06/66244</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2006-09-11</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>11/230,022</td>
									<td>2005-09-19</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/254863-a-method-of-preventing-re-use-of-compromised-keys by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 11:12:46 GMT -->
</html>
