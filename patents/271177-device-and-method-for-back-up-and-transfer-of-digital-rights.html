<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/271177-device-and-method-for-back-up-and-transfer-of-digital-rights by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 02:21:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 271177:DEVICE AND METHOD FOR BACK UP AND TRANSFER OF DIGITAL RIGHTS</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">DEVICE AND METHOD FOR BACK UP AND TRANSFER OF DIGITAL RIGHTS</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>The present invention relates to a digital right management device (20), the device comprising a memory area (22) for storing information on a rights object that has been transferred from the DRM device (20) to another DRM device, wherein the rights object comprises permissions linked to a digital media object, and a processor (24) for receiving a rights object, wherein the processor is operative to access the memory area (22) to check whether information on the received rights object is stored in the memory area (22) and to set up the received rights object on the digital right management device (20) in case the information on the received rights object is not stored in the memory area (22) and to reject the received rights object in case the information on the received rights object is stored in the memory area (22).</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>Device and Method for Digital Rights Management<br>
Description<br>
The present invention generally relates to digital rights management and, more<br>
particularly, to a backup and transfer of digital rights.<br>
Digital rights management (DRM) describes a concept by which media providers enforce<br>
limitations on usage and distribution of digital media content. Presently, there are number<br>
of DRM schemes in use. For example, mobile content providers use the Open Mobile<br>
Alliance (OMA) DRM system to protect digital mobile media content.<br>
The OMA DRM family comprises digital rights management standards that are developed<br>
by the Open Mobile Alliance. To date, the OMA DRM family comprises:<br>
• OMA Digital Rights Management 1.0 (DRM vl .0),<br>
• OMA Digital Rights Management 2.0 (DRM v2.0),<br>
• OMA Digital Rights Management 2.1 (DRM v2.1),<br>
• OMA DRM v2.0 Extensions for Broadcast Support (XBS),<br>
• OMA Secure Removable Media (SRM),<br>
• OMA Secure Content Exchange (SCE).<br>
The OMA DRM system enables content issuers to distribute DRM protected content and<br>
rights issuers (RIs) to issue rights objects (ROs) for the DRM protected content. The DRM<br>
system is independent of media object formats, operating systems, and run-time<br>
environments. Contents protected by DRM can be of a wide variety, including games, ring<br>
tones, photos, music clips, video clips, streaming media, etc. For a user consumption of the<br>
content, users acquire permission to DRM protected content by contacting rights issuers,<br>
i.e. an entity that issues rights objects to DRM conformant devices. Rights issuers grant<br>
appropriate permission for the DRM protected content to use it on DRM conformant<br>
devices. The content is cryptographically protected when distributed and, hence, will not<br>
be usable without an associated rights object (RO) issued for the users device.<br>
DRM protected content can be delivered to the device by any means, for example, over the<br>
air, LAN/WLAN, local connectivity, removable media, etc. Rights objects, however, are<br>
tightly controlled and distributed by the rights issuer in a controlled manner. DRM<br>
protected content and rights objects may be delivered to the device together or separately.<br>
Within the scope of the OMA DRM family, there is a fundamental difference between a<br>
backup of rights and a move of rights between devices.<br>
The backup of rights comprises copying an OMA DRM v2.x rights object (RO) from a<br>
originating device to another medium. The copied rights object is called backup rights<br>
object. However, the backup rights object remains cryptographically bound to the<br>
originating device, such that it can only be restored or reinstalled to the originating device.<br>
A backup rights object cannot be used to exercise the rights on any other device than the<br>
originating device.<br>
The backup of rights is possible from OMA DRM v2.0 onwards. The process of restoring<br>
or reinstalling a backup rights object and making it usable on the device is called installing<br>
a backup rights object.<br>
On the other hand, the move of rights comprises moving or transferring a rights object<br>
between two devices, i.e. from an originating or source device to a sink device. Before the<br>
move takes place, the rights object is only cryptographically bound to the source device,<br>
i.e., only the source device can exercise the rights. After the move, the rights object is only<br>
bound to the sink device, i.e., only the sink device can exercise the respective rights.<br>
In the OMA DRM family, some form of moving rights appears in DRM v2.1. There, a<br>
move of rights is possible by uploading a rights object to an OMA DRM rights issuer (RI)<br>
and downloading it to another device. In SRM, protocols for the move of rights between a<br>
device and a secure removable media are defined, i.e., a removable media that implements<br>
means to protect against unauthorized access to its internal data (e.g. secure memory card,<br>
smart card). In SCE, protocols for the move of rights between devices are specified.<br>
In the OMA DRM family, there are two types of rights objects:<br>
• Stateful rights objects and<br>
• Stateless rights objects.<br>
Stateful rights objects have a state that changes during an exercise of rights. For example, a<br>
rights object can allow a certain piece of content to be played three times. In this case, the<br>
state is the number of plays left. Stateless rights objects are rights objects that are not<br>
stateful. Both stateful and stateless rights objects can be bound to a single device, in which<br>
case they are called device rights objects, or to a group of devices belonging to the same<br>
user, in which case they are called domain rights objects.<br>
In DRM v2.1, some protection mechanisms against replay of stateful rights objects are<br>
defined, which prevent an unauthorized extension of granted rights, for example, extending<br>
the number of plays originally granted to the device. Such protection mechanisms<br>
comprise keeping track of all received stateful rights objects in a local cache. Each entry of<br>
the local cache comprises a globally unique identification of the stateful rights object and a<br>
timestamp of the rights issuer (RI timestamp) for this rights object. A device will only<br>
install received stateful rights objects that are not already listed in the local cache memory<br>
(DRM v2.1, section 10.4). Additionally, stateful domain rights objects without a RI<br>
timestamp are kept in a separated local cache, which only keeps track of the unique<br>
identification of the rights object. DRM v2.1 defines yet another local cache to prevent the<br>
replay of stateless rights objects uploaded to a rights issuer. When a device uploads a<br>
stateless rights object to .the rights issuer, a new entry with a unique identification of the<br>
rights object and the rights object timestamp is inserted in the cache.<br>
In SRM, an attack of replaying a rights object that has been moved out from the device to<br>
the secure removable media has not been addressed yet.<br>
A problem occurs when both move and backup for the same rights object are allowed. In<br>
particular, this holds for SRM. The following attack may be possible:<br>
1. A user makes a backup of the rights object from the source device.<br>
2. The user then moves the rights from the source device to the sink device.<br>
3. Finally, the user restores the backup to the source device.<br>
In this way, the user might duplicate the rights. This problem also applies for the replay of<br>
a rights object via an out-of-band delivery after the rights object has been moved from the<br>
source device.<br>
Such an attack has been recognized in OMA. However, a suitable solution has not been<br>
identified yet although SRM speculates about not allowing move for a rights object of<br>
which a backup copy has been performed. This implies that the user must choose either if<br>
he may want to move the rights object sometime in the future or if he wants a safety<br>
backup. If he decides for a backup, the rights object in this case is bound to the source<br>
device forever. This would be a bad user experience, since the user is restricted in his<br>
rights although he only wants to store them in a safe place.<br>
A similar problem appears for a backup of a stateful rights object. In this case, the<br>
following attack scenario is possible.<br>
1. A user makes a backup of the stateful rights object.<br>
2. The user consumes some of the rights (changing the state).<br>
3. The user removes the rights object and accompanying state information from the<br>
device.<br>
4. The user restores the backup rights object to the device.<br>
As the state information has been deleted, the attacker can exercise the rights as they were<br>
before the state was changed.<br>
Unnecessarily restricting the user in his rights, although he only wants to store a backup in<br>
a safe place, and not providing a solution to the above-mentioned problem could result in a<br>
bad user acceptance and, thus, to a commercial failure of OMA DRM systems.<br>
Hence, it would be desirable to reduce the described inherent tension between protecting<br>
digital media content by related rights objects on the one hand and providing consumers<br>
with enough flexibility to manage the content they purchase in a reasonable way.<br>
It is therefore an object of the present invention to provide a digital rights management<br>
device and method for improving the flexibility of users to manage digital media content<br>
and, at the same time, to offer a high level of protection of said digital media content.<br>
This object is achieved by a digital rights management device according to claim 1, a<br>
digital rights management method according to claim 13 and a computer program<br>
according to claim 21.<br>
Embodiments of the present invention are based on the finding that a high level of digital<br>
media content protection and user flexibility can be achieved by providing a DRM device<br>
with means for protocoling any moves of rights objects from said DRM device to another<br>
medium or DRM device. For this purpose, the DRM device may be equipped with a<br>
memory area for storing information related to rights objects that have been transferred<br>
from the DRM device to another medium. In case a user wants to install a rights object on<br>
the DRM device, information on this rights object is compared to the information stored in<br>
the memory area related to previously moved rights objects. In case this comparison yields<br>
that the rights object to be installed on the DRM device has previously been moved or<br>
transferred from the DRM device to somewhere else, the restoration or installation of said<br>
rights object is cancelled or rejected.<br>
Embodiments of the present invention provide a DRM device comprising a memory area<br>
for storing information on a rights object that has been transferred from the DRM device to<br>
another DRM device, wherein the rights object comprises permission linked to a digital<br>
media object and a processor for receiving a rights object, wherein the processor is<br>
operative to access the memory area to check whether information on the received rights<br>
object is stored in the memory and to set up the received rights object on the DRM device<br>
in case the information on the received rights object is not stored in the memory area and<br>
to reject the received rights object in case the information on the received rights object is<br>
stored in the memory area.<br>
Further embodiments of the present invention provide a method comprising storing<br>
information on a rights object in a memory area of a first device, wherein the rights object<br>
has been transferred from the first device to a second device, and wherein the rights object<br>
comprises permissions linked to a digital media object, receiving a rights object at the first<br>
device, and accessing the memory area to check whether information on the received rights<br>
object is stored in the memory area and to set up the received rights object on the first<br>
device in case the information on the received rights object is not stored in the memory<br>
area, and to reject the received rights object in case the information on the received rights<br>
object is stored in the memory area.<br>
The memory area for storing information on transferred rights objects may be a cache<br>
memory and will therefore be also referred to as move cache in the sequel. In order to<br>
prevent that the move cache requires a large amount of memory, the move cache may only<br>
keep a small amount of information on the rights object that uniquely identifies the rights<br>
object rather than the complete rights object. According to embodiments, this small amount<br>
of information may be a piece of a cryptographic hash over the complete rights object.<br>
Thereby, a size of the piece may be taken such that it is very improbable that two different<br>
rights objects lead to the same rights object hash or to the same piece of their associated<br>
rights object hashes.<br>
According to embodiments, the move cache may be an unprotected memory area of the<br>
DRM device. However, a cryptographic hash over the (unprotected) move cache may<br>
preferably reside in a protected memory area, such that a compromise of the move cache<br>
may be detected.<br>
Of course, the size of the move cache is limited. In case the move cache exhausts, i.e.,<br>
information on a plurality of rights objects exceeds the size of the move cache,<br>
embodiments of the present invention allow to store at least parts of said move cache in a<br>
further memory area or on another medium, which might comprise unprotected memory.<br>
In the sequel of this specification this storing of at least parts of the move cache will be<br>
referred to as export from the move cache. When an export from the move cache takes<br>
place, the local move cache in the DRM device may only keep a cryptographic hash over<br>
the part of the move cache that was exported and the point in time on which the export<br>
happened. This point in time, the so-called exported move cache timestamp, is also stored<br>
in the exported move cache according to an embodiment of the present invention.<br>
In case a backup rights object is to be installed on the DRM device, the processor first<br>
checks if the backup rights object or information related thereto resides in the move cache.<br>
If so, the backup rights object is not installed on the DRM device. If the rights object or<br>
information related thereto is not in the move cache, but a related rights object timestamp<br>
indicates a time after a last export of the move cache, the rights object is accepted for<br>
installation or restoration on the DRM device. If the rights object's timestamp indicates a<br>
time before the last export of the move cache, the processor checks the exported move<br>
caches from a most recent one to older ones until the rights object or information related<br>
thereto is found or until a timestamp of the exported move cache indicates a time of the<br>
move cache export earlier than the rights object's timestamp. If the rights object is not<br>
found in any move caches, including the exported move caches, the backup rights object<br>
may be reinstalled or restored on the DRM device.<br>
Further advantages or refinements of the present invention are subject to the dependent<br>
claims.<br>
Embodiments of the present invention allow the use of both move and backup of rights in<br>
the OMA DRM family, but avoid the danger of duplicating said rights. This may increase<br>
user experience and user acceptance, since a backup of rights does not restrict the user's<br>
flexibility related to said rights.<br>
The introduction of the move cache for storing the information on rights objects may also<br>
avoid an attack of replaying a stateless rights object to a DRM device by an out-of-band<br>
delivery after this stateless rights object has been moved from the DRM device e.g. to a<br>
secure removable media. This may prevent an unauthorized duplication of rights by an<br>
attacker.<br>
Moreover, state information of rights objects comprised by the move cache may allow a<br>
user to backup stateful rights. Thus, a user may make a backup of any rights object,<br>
independent of it being stateless or stateful. This may make the backup operation<br>
consistent. A user does not need to understand why he may make a backup of certain rights<br>
objects whilst he cannot make a backup of other rights objects.<br>
A possibility to export the move cache to an external storage medium may prevent a user<br>
of being unable to move rights due to a full internal move cache of the DRM device. The<br>
storage of a timestamp of an export of the move cache may prevent a user to be requested<br>
for exported memory data as much as possible.<br>
A content issuer may benefit from embodiments of the present invention in that his<br>
interests in keeping contents safe is assured by the inventive concept, but a user has a more<br>
flexible use of the content. Due to the reduced restrictions, a user is more likely to buy<br>
protected content such that the content issuer sales are increased.<br>
Preferred embodiments of the present invention are described in the following with<br>
reference to the accompanying drawings, in which:<br>
Fig. la-c show principle steps of an attack scenario, which can be avoided by<br>
embodiments of the present invention;<br>
Fig. 2 shows a schematic block diagram of a DRM device according to an<br>
embodiment of the present invention;<br>
Fig. 3 shows a principle structure of a memory area (move cache) for storing<br>
information on rights object according to an embodiment of the present<br>
invention; and<br>
Fig. 4 shows a flowchart of a digital rights management method according to an<br>
embodiment of the present invention.<br>
Before explaining embodiments of the present invention in more detail with reference to<br>
Figs. 2 to 4, an attack scenario, which occurs when both move and backup for the same<br>
rights object are allowed, shall be explained referring to Figs, la to c.<br>
Fig. la shows a DRM device 10 having installed thereon a rights object 12 comprising<br>
permissions linked to a digital media object 14. In the scenario depicted in Fig. la, a user<br>
wants to perform a backup of the rights object 12 by copying the rights object 12 from the<br>
DRM device 10 to another medium 16. The medium 16 may, e.g., be an external memory<br>
(e.g. secure memory card, smart card) or another DRM capable device. The resulting<br>
backup rights object 12' remains cryptographically bound to the originating device 10,<br>
such that it can only be restored to and replayed on the originating device 10. Hence, the<br>
backup rights object 12' cannot be used to exercise the rights on any other device than the<br>
originating device 10.<br>
After the backup procedure depicted in Fig. la, the user might want to move the rights<br>
object 12 from the originating device 10 to a destination device 18. Before the move of the<br>
rights object 12, the rights object 12 is only cryptographically bound to the originating<br>
device 10, i.e., only the originating device 10 can exercise the rights in order, for example,<br>
to replay a content of the digital media file 14. After the move, the rights object 12 is<br>
deleted from the originating device 10 and the moved rights object 12" is only bound to<br>
the destination device 18, i.e., only the destination device 18 can exercise the rights in<br>
order to also replay a transferred content of a copied digital media object 14'. Via the move<br>
operation, the rights in form of the rights object 12 related to the digital media content 14<br>
have been transferred from source device 10 to the destination device 18.<br>
Since a backup version 12' of the rights object 12 exists on the external medium 16, the<br>
user could now re-install the backup rights object 12' to the source device 10 by receiving<br>
the backup rights object 12' from the external medium 16. In this way, the rights related to<br>
the digital media object 14 would have been duplicated, as they now exist on source device<br>
10 and destination device 18.<br>
Such an abuse of the rights object 12 is not wanted by content providers. Therefore, a<br>
straightforward solution would be to not allow a move for the rights object 12 of which a<br>
backup copy 12' has already been made. However, this would put serious restrictions on<br>
user flexibility.<br>
To circumvent this tension between protecting content and providing flexibility,<br>
embodiments of the present invention provide a device 20 capable of digital rights<br>
management, which is schematically shown in Fig. 2.<br>
The DRM device 20 comprises a memory area 22 for storing information on a rights object<br>
that has been transferred from the DRM device 20 to another DRM device (not shown),<br>
wherein the rights object comprises permissions linked to an associated digital media<br>
object. Further, the DRM device 20 comprises a processor 24 for receiving a rights object,<br>
wherein the processor 24 is operative to access the memory area 22 to check whether<br>
information on the received rights object is stored in the memory area 22 and to set up the<br>
received rights object on the DRM device 20 in case the information on the received rights<br>
object is not stored in the memory area 22, and to reject the received rights object in case<br>
the information on the received rights object is stored in the memory area 22.<br>
As has been explained before, the memory area 22 corresponds to the move cache.<br>
Examples of the DRM device 20 include personal computers, laptop computers, personal<br>
digital systems, mobile telephones, media players, work stations, file servers, mainframes,<br>
etc. The DRM device 20 could also be a removable component, such as a removable media<br>
card or one of the aforementioned devices. Of course, the DRM device 20 can also be a<br>
combination of the aforementioned devices.<br>
The DRM device 20 can communicate with other devices directly or via a network. The<br>
network may be any network that allows separate devices 20 to communicate, i.e., e.g., a<br>
local area network (LAN), a wide area network (WAN), a wireless LAN, a wireless WAN,<br>
the Internet, a wireless telephone network, etc. Different devices may communicate with<br>
each other and to the network through landlines (e.g. Tl, DSL, Cable, POTS) or wireless<br>
technology (e.g. Bluetooth, WLAN, WiFi, etc.). Of course, the communication between<br>
different devices 20 can either be secure or non-secure.<br>
Since the information on the rights object that has been transferred from the DRM device<br>
20 should also reside in the move cache 22 when switching off the DRM device 20, the<br>
move cache 22 is advantageously a part of a non-volatile memory area 26 of the DRM<br>
device 20. Examples of non-volatile memory include read-only memory, flash memory,<br>
most types of magnetic computer storage devices (e.g. hard disks, floppy disk drives, and<br>
magnetic tape), optical disc drives, etc.<br>
To prevent that the move cache 22 requires a huge amount of memory, the move cache 22<br>
may keep only a small amount of information on rights objects that have been transferred<br>
from the device 20 rather than the complete rights objects. This small amount of<br>
information may be e.g. a piece of a cryptographic hash over a complete rights object,<br>
respectively, the piece of the cryptographic hash subsequently being called rights object<br>
hash. Thereby, a hash generally denotes a result of a hash function applied to the complete<br>
rights object. A hash function is a reproducible method of turning some kind of data into a<br>
(relatively small) number that may serve as a digital fingerprint of the data (here: the rights<br>
object). The hash function chops and mixes (i.e. substitutes or transposes) the data to create<br>
such fingerprints. The fingerprints are called hash sums, hash values, hash codes or simply<br>
hashes. According to an embodiment of the present invention, the first six bytes of a SHA-<br>
1 hash may be used as the rights object hash. Of course, other parts and/or other hashes are<br>
also conceivable. However, it is important to choose a size of a rights object hash such that<br>
it is very improbable that two different rights objects result in the same rights object hash.<br>
Hence, according to embodiments of the present invention, the move cache 22 is<br>
configured to store information on the rights object that uniquely identifies the rights<br>
object among a plurality of rights objects. Likewise, the processor 24 may be configured to<br>
generate said unique information. That is, if the move cache 22 is configured to store at<br>
least a part of a cryptographic hash over the entire rights object as the information on the<br>
rights object, the processor 24 is configured to generate at least the part of the<br>
cryptographic hash.<br>
The non-volatile memory area 26 in which the move cache 22 for storing the rights object<br>
information resides may be an unprotected memory. The move cache 22 should be large<br>
enough such that it can store a sufficient amount of rights object hashes, i.e., that it allows<br>
the moving of a sufficient number of rights objects. However, if the move cache 22<br>
exhausts, embodiments of the present invention provide for storing the move cache 22 or at<br>
least parts thereof on another (unprotected) medium (not shown), which is indicated by the<br>
arrow 27. This external storing is called export from move cache 22. When an export from<br>
the move cache 22 happens, the move cache 22 in the DRM device 20 may only keep a<br>
cryptographic hash or a part of a cryptographic hash over the part of the move cache 22<br>
that was exported and the point in time on which the export happened. This point in time,<br>
called exported move cache timestamp, may also be stored in the exported move cache.<br>
The hash over the move cache 22 and/or the part of the move cache that was exported may<br>
be determined in block 28 and stored in a protected memory area 30, according to<br>
embodiments of the present invention. By storing the hash over the exported move cache<br>
or at least parts thereof in the protected memory area 30, a compromise of the exported<br>
memory move cache may be detected.<br>
If the DRM device 20 receives a rights object, which may be a backup rights object, via<br>
input/output port 32, the processor 24 checks as to whether information on the received<br>
rights object is stored in the move cache 22. If so, a rights object equal to the received<br>
rights object has been previously moved or transferred from the DRM device 20 and,<br>
therefore, the received (backup) rights object is not set up on the DRM device 20. If,<br>
however, information on the received rights object cannot be found in the move cache 22<br>
and the rights object timestamp (value of the "timestamp" field in the rights object<br>
payload) indicates a value after a last export of the move cache 22, the received rights<br>
object is accepted and set up on the DRM device 20. If the rights object timestamp is<br>
before the last export of move cache 22, the processor 24 checks the exported move caches<br>
from the most recent one to older ones until it finds information on the received rights<br>
object or until the timestamp of the exported move cache is earlier than the rights object's<br>
timestamp. If information on the received rights object is not found in any move caches,<br>
including the exported move caches, the received rights object may be accepted and<br>
installed on the DRM device 20.<br>
A schematic structure of the move cache 22 for storing information on rights objects that<br>
have been moved from the DRM device 20 to another DRM device is shown in Fig. 3.<br>
As can be seen, the move cache 22 includes memory fields 34-1 to 34-N, each storing<br>
information on a rights object that has been previously transferred from the DRM device<br>
20, e.g. for the purpose of a backup. As explained above, the stored information on the<br>
rights object may be a part of a hash over the complete rights object, respectively. Further,<br>
the move cache 22 comprises memory fields 36-1 to 36-M for storing information on<br>
exported versions of the move cache 22. Fig. 3 also shows the structure of an exported<br>
version of the move cache 38 principally having the same structure as the move cache 22.<br>
The information over the exported versions of the move cache may include the hash over<br>
the exported versions, respectively, and a pointer to a memory location as to where to find<br>
the respective exported move cache version. As mentioned above, the exported move<br>
cache versions 38 may reside in an unprotected memory area. However, the information<br>
36-1 to 36-M on the exported move cache versions should reside in a protected memory<br>
area. Protection of memory can be achieved via different means. Memory protection can<br>
be achieved by cryptographic software algorithms or by hardware modifications. In any<br>
case, protection here means that the regarded memory area should be attack-secure.<br>
If exporting the move cache 22 occurs frequently, an exported move cache file may<br>
comprise cryptographic hashes of one or more former exported move cache files as it is<br>
indicated by reference numeral 39 in Fig. 3. In this way, the DRM device 20 only needs to<br>
store a limited amount of hashes over exported move caches and can rely on the exported<br>
move caches 38 to verify a hash of some other previously exported move cache. This<br>
prevents the filling of the move cache 22 on the DRM device 20 with hashes over exported<br>
move caches and in fact allows unlimited moving.<br>
Filling of the move cache 22 may be done in sequential order from a first entry to a last<br>
entry of the move cache. If the last entry is occupied, the DRM device 20 may request to<br>
export the move cache 22 and then starts again at the first entry by removing rights object<br>
hashes already stored only when a new rights object hash is to be stored. This prevents that<br>
the DRM device 20 has to request for exported move caches immediately after an export.<br>
According to a further embodiment of the present invention, the move cache 22 may also<br>
be used to allow a backup of stateful rights objects. In order to prevent that stateful rights<br>
are re-exercised, the move cache 22 may also comprise state information of stateful rights<br>
objects. When a stateful backup rights object is to be installed on the DRM device 20, the<br>
processor 24 may collect the state information from the move cache 22 or exported move<br>
caches 38 such that a user can exercise only the rights that he is still entitled to use.<br>
The inventive method that is executed by the DRM device 20 is summarized by the<br>
flowchart depicted in Fig. 4.<br>
The method comprises a step 40 of receiving a rights object, which might be a backup<br>
rights object. After receiving the rights object, processor 24 checks in a step 42 as to<br>
whether information on the received rights object is stored in the move cache 22. If the<br>
information on the received rights object is found in the move cache 22, the received rights<br>
object is rejected in a following step 44. However, if the information on the received rights<br>
object is not found in the move cache 22, the processor 24 further checks in a step 46 as to<br>
whether a timestamp of the received rights object is after the last export of the move cache<br>
22.If this question is answered with "YES", the processor 24 accepts the received rights<br>
object for installation of the DRM device 20 in step 50. However, if question of step 46 is<br>
answered with "NO", the processor 24 further checks in step 48 as to whether the<br>
information on the received rights object may be found in one of the previously exported<br>
move caches. If this is the case, a version of the received rights object has been previously<br>
moved from the DRM device 20, such that a re-installation is rejected by the processor 24<br>
in step 44. However, if the information on the received rights object is also not found in<br>
any of the previously exported move caches, the DRM device 20 or the processor 24<br>
accepts the received rights object for installation on the device 20 in step 50.<br>
Hence, the processor 24 is adapted to access the exported move cache 38, in case the<br>
information on the received rights object is not found in the move cache 22, to check<br>
whether the information on the received rights object is stored in the exported move cache<br>
38. For this purpose the processor 24 is adapted to compare the timestamp of the received<br>
rights object with time information on the time when the last export of the move cache<br>
took place in step 46 before accessing the exported move cache in step 48. In particular,<br>
the processor 24 is adapted to only access the exported move cache in case the timestamp<br>
of the received rights object indicates an issuance of the received rights object before the<br>
time when the last export of the move cache took place.<br>
To summarize the concept of the present invention, a special memory area 22, which may<br>
be seen as a move cache, is proposed. This move cash is embedded in the DRM device 20<br>
and keeps track of all moves of rights objects that occur from the device 20. Before a<br>
received (backup) rights object is restored or re-installed on the device, the device 20<br>
checks if information on the received rights object is stored in the move cache. If it is not,<br>
it may be concluded that the received rights object has not been previously moved to<br>
another device, and as a consequence the device 20 may restore or re-install the backup<br>
rights object. However, if information on the received rights object is found in the move<br>
cache or exported versions thereof (i.e., the rights object has been moved), it must not be<br>
restored or re-installed on the device 20.<br>
To prevent rights that have been moved from being re-installed with a replay attack or by<br>
restore from off-device storage, an inventive device 20 has a move cache 22 with a reliable<br>
identification for all stateless rights objects that have been moved e.g. to a SRM. This<br>
identification may be denoted as Global Unique Identifier (GUID). However, a reduced<br>
size rights object identification may be used, such as the hash over the rights object<br>
container, e.g. truncated to a minimum size of 6 bytes. The move cache may also hold the<br><timestamp> element (RITS) of the rights object.<br>
Immediately after the rights are removed during a successful move of a stateless rights<br>
object from the device 20 to an SRM, the processor 24 (DRM Agent) may insert the<br><guid rits> pair corresponding to the rights object in the move cache 22.<br>
If a <guid rjts> pair is to be inserted in the move cache 22, but the move cache is full<br>
and the RITS in the rights object is later than the earliest RITS in the move cache 22, then<br>
the processor 24 may replace the entry with the earliest RITS in the move cache 22 with<br>
the new <guid rits> pair. If the RITS in the rights object is equal to or earlier than the<br>
earliest RITS in the move cache, the <guid rits> pair is not inserted.<br>
When receiving a stateless rights object (RO) in a way other than move (e.g. when<br>
restoring a backup from off-device storage, the processor 24 may perform the following<br>
procedure:<br>
a) Check if the move cache contains the GUID of the received RO. If it does, then a)<br>
holds, otherwise a) fails.<br>
b) If a) holds, the RO is rejected.<br>
c) If a) fails and the move cache is not full, the RO is installed.<br>
d) If a) fails, the move cache is full and the RITS of the RO is after the earliest RITS<br>
in the move cache, the RO is installed.<br>
e) If a) fails, the move cache is full and the RITS of the RO is earlier than or equal to<br>
the earliest RITS in the move cache, the RO is rejected.<br>
Multiple copies of the same rights object (i.e. two rights objects having the same ROID)<br>
shall not be installed simultaneously on the same device. Disabled rights objects (e.g.<br>
during a rights object upload or move protocol) are considered as installed, i.e. when a<br>
rights object is disabled, another copy of it should not be installed.<br>
When a stateless rights object is moved from an SRM to the device 20, and its <guid></guid>
RITS&gt; pair is already in the move cache 22, then this <guid rits> pair should be<br>
removed from the move cache 22. Notice that this happens when a stateless rights object is<br>
moved from the device to the SRM, and later returns to the same device via a move<br>
operation.<br>
When the move cache 22 is full, the device 20 may store a part with the oldest RITS values<br>
of the move cache on off-device storage. In this case, the device 20 should provide for<br>
integrity protection of the externally stored part. Additionally, the device 20 should record<br>
securely that and when it stored a part of the move cache on external storage and an<br>
identification of the latest externally stored part. When a rights object with a RITS before<br>
the time on which the last export took place is delivered out-of-band or re-installed from<br>
off-device storage, and the move cache 22 does not indicate that the rights object has been<br>
moved, the device 20 should also request the externally stored part of the move cache,<br>
verify its integrity, verify that it is the latest externally stored part and verify if the rights<br>
object has been moved. If the integrity verification of the externally stored part fails, or if<br>
the externally stored part indicates that the rights object has been moved, the rights object<br>
should not be installed. If the move cache 22 indicates that the rights object has been<br>
moved, the rights object should not be installed. Otherwise the rights object is installed. If<br>
a rights object with a RITS equal to the time on which the last export took place is<br>
delivered out-of-band or restored from a backup, both the move cache and the externally<br>
stored part should be consulted.<br>
Embodiments of the present invention allow the use of both move and backup of rights in<br>
the OMA DRM family, but avoids the danger of duplicating the rights. This may increase<br>
user experience and user acceptance, since a backup of rights does not lead to any<br>
restrictions. Due to its flexibility, safety and performance, the present invention is<br>
particularly suitable for DRM applications.<br>
Depending on the circumstances, the inventive DRM method may be implemented in<br>
hardware or in software. The implementation may be done on a digital storage medium,<br>
particularly a disc, a DVD or a CD with electronically readable control signals, which may<br>
co-operate with a programmable computer system such that the method is executed. In<br>
general, the invention also consists in a computer program product with a program code<br>
stored on a machine-readable carrier for performing the inventive method when the<br>
computer program product runs on a computer and/or microcontroller. In other words, the<br>
invention may, thus, be realized as a computer program with a program code for<br>
performing the method when a computer program runs on a computer and/or<br>
microcontroller.<br>
While this invention has been described in terms of several preferred embodiments, there<br>
are alterations, permeations and equivalents, which fall within the scope of this invention.<br>
It should also be noted that there are many alternative ways of implementing the methods<br>
and compositions of the present invention. It is therefore intended that the following<br>
appended claims be interpreted as including all such alterations, permutations and<br>
equivalents as falling within the true spirit and scope of the present invention.<br>
We claim:<br>
1. A digital right management device (20), the device comprising:<br>
a memory area (22) for storing information on a rights object that has been transferred<br>
from the DRM device (20) to another DRM device, wherein the rights object<br>
comprises permissions linked to a digital media object; and<br>
a processor (24) for receiving a rights object, wherein the processor is operative to access<br>
the memory area (22) to check whether information on the received rights object is<br>
stored in the memory area (22) and to set up the received rights object on the digital<br>
right management device (20) in case the information on the received rights object is<br>
not stored in the memory area (22) and to reject the received rights object in case the<br>
information on the received rights object is stored in the memory area (22).<br>
2. The device according to claim 1, wherein the memory area (22) stores information<br>
on the rights object that uniquely identifies the rights object among a plurality of<br>
rights objects.<br>
3. The device according to claim 1 or 2, wherein the memory area (22) stores at least a<br>
part of a cryptographic hash over the entire rights object as the information on the<br>
rights object.<br>
4. The device according to one of claims 1 to 3, wherein the memory area (22)<br>
comprises an attack-secure memory region to store a cryptographic hash over the<br>
memory area (20) in the attack-secure memory region.<br>
5. The device according to one of the preceding claims, wherein the device is<br>
configured to export stored information from a plurality of rights objects from the<br>
memory area (22) to an additional memory area in case a storage capacity of the<br>
memory area (22) is reached.<br>
6. The device according to claim 5, wherein the memory area (22) stores time<br>
information on a time when a last export took place.<br>
7. The device according to one of claims 5 or 6, wherein the processor (24) is adapted<br>
to access the additional memory area, in case the information on the received rights<br>
object is not found in the memory area (22), to check whether the information on the<br>
received rights object is stored in the additional memory area.<br>
8. The device according to claim 7, wherein the processor (24) is adapted compare a<br>
timestamp of the received rights object with the time information on the time when<br>
the last export took place before accessing the additional memory area, and to only<br>
access the additional memory area in case the timestamp of the received rights object<br>
indicates an issuance of the received rights object before the time when the last<br>
export took place.<br>
9. The device according to one of the preceding claims, wherein the memory area (22)<br>
stores state information of a stateful rights object as a part of the stored information<br>
on the rights object.<br>
10. The device according to claim 9, wherein the processor (24) is adapted to, in case<br>
information on the received rights object is stored in the memory area, compare state<br>
information of the received rights object with stored state information related to<br>
transferred rights objects.<br>
11. The device according to one of the preceding claims, wherein the device (20) is a<br>
OMA DRM compliant device.<br>
12. The device according to claim 11, wherein the device (20) is a OMA DRM<br>
compliant secure removable media device.<br>
13. A digital rights management method, comprising:<br>
storing information on a rights object in a memory area, wherein the rights object has<br>
been transferred from a first device to a second device, and wherein the rights object<br>
comprises permissions linked to a digital media object;<br>
receiving a rights object at the first device; and<br>
accessing the memory area to check whether information on the received rights<br>
object is stored in the memory area and to set up the received rights object on the<br>
first device in case the information on the received rights object is not stored in the<br>
memory area, and to reject the received rights object in case the information on the<br>
received rights object is stored in the memory area.<br>
14. The method according to claim 13, wherein storing the information comprises<br>
storing information on the rights object that uniquely identifies the rights object<br>
among a plurality of rights objects.<br>
15. The method according to claim 13 or 14, wherein storing the information comprises<br>
storing at least a part of a cryptographic hash over the entire rights object as the<br>
information on the rights object.<br>
16. The method according to one of claims 13 to 15, wherein storing the information<br>
comprises storing a cryptographic hash over the memory area (22) in the attack-<br>
secure memory region.<br>
17. The method according to one of claims 13 to 16, wherein storing the information<br>
comprises storing stored information from a plurality of rights objects in an<br>
additional memory area in case a storage capacity of the memory area (22) is<br>
reached.<br>
18. The method according to claim 17, wherein storing the information comprises<br>
storing information on a time when a last storage in the additional memory area took<br>
place.<br>
19. The method according to one of claims 13 to 18, wherein storing the information<br>
comprises storing state information of a stateful rights object as a part of the stored<br>
information on the rights object.<br>
20. The method according to claim 19, wherein checking whether information on the<br>
received rights object is stored in the memory area comprises comparing state<br>
information of the received rights object with stored state information related to<br>
transferred rights objects.<br>
21. A computer program comprising a program code for performing a method according<br>
to one of claims 11 to 18, when the computer program is running on a computer<br>
and/or a microcontroller.<br><br><br>
The present invention relates to a digital right management device (20), the device<br>
comprising a memory area (22) for storing information on a rights object that has been<br>
transferred from the DRM device (20) to another DRM device, wherein the rights object<br>
comprises permissions linked to a digital media object, and a processor (24) for receiving a<br>
rights object, wherein the processor is operative to access the memory area (22) to check<br>
whether information on the received rights object is stored in the memory area (22) and to<br>
set up the received rights object on the digital right management device (20) in case the<br>
information on the received rights object is not stored in the memory area (22) and to reject<br>
the received rights object in case the information on the received rights object is stored in<br>
the memory area (22).</guid></guid></guid></guid></guid></timestamp></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/viewdoc.aspx?id=8S1fAYRt3cu8YYcnYupoPg==&amp;amp;loc=wDBSZCsAt7zoiVrqcFJsRw==" target="_blank" style="word-wrap:break-word;">http://ipindiaonline.gov.in/patentsearch/GrantedSearch/viewdoc.aspx?id=8S1fAYRt3cu8YYcnYupoPg==&amp;amp;loc=wDBSZCsAt7zoiVrqcFJsRw==</a></p>
		<br>
		<div class="pull-left">
			<a href="271176-process-for-the-preparation-of-diaryl-carbonate.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="271178-apparatus-for-cutting-food-product.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>271177</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>4557/KOLNP/2009</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>07/2016</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>12-Feb-2016</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>05-Feb-2016</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>30-Dec-2009</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>FRAUNHOFER-GESELLSCHAFT ZUR FÖRDERUNG DER ANGEWANDTEN FORSCHUNG E.V.</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>HANSASTRASSE 27 C, 80686 MÜNCHEN, GERMANY</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>STEFAN KRÄGELOH</td>
											<td>SCHOBERTWEG 51, 91056 ERLANGEN, GERMANY</td>
										</tr>
										<tr>
											<td>2</td>
											<td>BERT GREEVENBOSCH</td>
											<td>SCHENKSTRASSE 63 91052 ERLANGEN, GERMANY</td>
										</tr>
										<tr>
											<td>3</td>
											<td>HARALD FUCHS</td>
											<td>AUF DER HÖHE 28, 91341 RÖTTENBACH GERMANY</td>
										</tr>
										<tr>
											<td>4</td>
											<td>MERCE SERRA JOAN</td>
											<td>FORCHEIMER STRASSE 9A 91056 ERLANGEN, GERMANY</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>G06F21/00; G06F21/00</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/EP2008/005448</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2008-07-03</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>60/948,078</td>
									<td>2007-07-05</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/271177-device-and-method-for-back-up-and-transfer-of-digital-rights by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 02:21:23 GMT -->
</html>
