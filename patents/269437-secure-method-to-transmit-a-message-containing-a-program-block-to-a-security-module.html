<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/269437-secure-method-to-transmit-a-message-containing-a-program-block-to-a-security-module by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 07:28:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 269437:SECURE METHOD TO TRANSMIT A MESSAGE CONTAINING A PROGRAM BLOCK TO A SECURITY MODULE</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">SECURE METHOD TO TRANSMIT A MESSAGE CONTAINING A PROGRAM BLOCK TO A SECURITY MODULE</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>The aim of this invention is to propose a transmission method of a message containing a program block that allows to avoid the consequences of a possible malicious decryption of this message. This aim is achived through a secure method to update software embedded in a security module, this method comprising the following steps: - formation of a first updating program block (PBI) - determination of a targrt memory zone of said security module, - determiniation through said security module, of a pre-registered content (MM_Ref) in said target memory zone, - formation of a second program block (SBI) obtained by the mixing of all or a part of the pre-registered content with the first program block (PBI), - transmission of the second program block(PBI) to the security module, - reception of the second block by the secutity module, - reading of the target memory zone (MEM), - obtaining and writing in the target memory zone block by the inverse mixing of all or part of the second block and of the target memory zone content.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>FORM 2 THE PATENTS ACT, 1970<br>
(39 OF 1970)<br>
 As amended by the Patents (Amendment) Act, 2005<br>
&amp;<br>
 The Patents Rules, 2003<br>
As amended by the Patents (Amendment) Rules, 2006<br>
COMPLETE SPECIFICATION<br>
(See section 10 and rule 13)<br>
TITLE OF THE INVENTION<br>
Method of securely updating a program block in a security module.<br>
APPLICANT<br>
Name    : NAGRACARD SA<br>
Address     : Route de Geneve 22, CH-1033 Cheseaux-sur-Lausanne,<br>
Switzerland Nationality : a Swiss Company<br>
INVENTOR<br>
Name	: OSEN Karl<br>
Address	: Route du Mandement 453, CH-1282 Dardagny, Switzerland<br>
Nationality     : Swiss<br>
PREAMBLE TO THE DESCRIPTION<br>
The following specification particularly describes the nature of this invention and the manner in which it is to be performed :<br><br>
The block prepared in this way is encrypted by one or several keys pertaining to the security modules. It is possible to encrypt this block either using a global key, common to<br>
all the security modules, or using a personal key, pertaining to each module. In the latter case, it will be necessary to prepare the same number of messages as they are different security modules.<br>
The message is then sent to the management centre that disposes of transmission means towards the modules. In a unidirectional system, the message is repeated during a given period in order to ensure that each module has received it.<br>
The man skilled in the art is placed in a difficult position when a security leak is detected because he/she must evaluate the risk of this type of message being analyzed by a third party and the risk of leaving this leak open. At times this dilemma led to the situation in which one has forbidden himself to correct a fault of the programme because the risk of comprehension of the substitute programme was too great.<br>
The updating of programs in a Pay-TV decoder is well known and described, for example, in the document US2004/107349. The program modules are sent to the decoder encrypted by a key that is used once. This is the principle of the strike list which is applied here. Once the programme module has been received it is stored in the memory of the decoder and activated according to a usual protocol (diversion of an address towards the patch).<br>
Brief Description of the Invention<br>
The aim of this invention is to allow the man skilled in the art to transmit a message containing a program block in a message without having to worry about the result of a malicious decryption of this message.<br>
This aim is achieved by a secure method to update software in a security module, this method comprising the following steps:<br>
-	formation of a first updating program block (PB1),<br>
-	determination of a target memory zone of said security module,<br>
3<br><br>
-	determination through said security module, of a pre-registered content (MM_Ref) in said target memory zone,<br>
-	formation of a second program block (SB1) obtained by the mixing of all or a part of the pre-registered content with the first program block (PB1),<br>
-	transmission of the second program block (SB1) to the security module,<br>
-	reception of the second block by the security module,<br>
-	reading of the target memory zone (MEM),<br>
-	obtaining and writing in the target memory zone of the first block by the inverse mixing of all or part of the second block and of the target memory zone content.<br>
Therefore, thanks to the invention, the transmitted code (second block) has no relation with the first block for those who has no knowledge of the content of the target memory.<br>
A third party succeeding to decipher the message will learn nothing more about the functioning of the security module.<br>
This method can apply to the sending of the same message to all the security modules and in this case, it is considered that the content of the target memory zone is the same for all the modules. If individual addressing is carried out, it is possible that the content of each memory is different. Once the first program block has been generated, it is mixed with the data of each security module to create the same number of second programme blocks.<br>
Brief Description of the Drawings<br>
The invention will be better understood thanks to the following detailed description that refers to the enclosed drawings that are given as a non-limitative example, namely:<br>
-	Figure 1 shows the generation process of the second block,<br>
-	Figure 2 shows the writing process in the memory of the security module.<br>
Detailed Description<br>
According to a first embodiment, the content of the target memory is pre-registered with quasi-random values. At the time of the personalization of this type of module, randomly<br>
4<br><br>
generated data MM_Ref is stored on one hand in the security module MEM and on the other hand at the management centre.<br>
According to a second embodiment, the pre-registered data is made up of a program code that could be executed by the processor of the security module. In fact, this code is never executed and serves as an initialization value of the updating region. As in the preceding example, all the modules can have the same dummy program or each module receives a different program.<br>
Figure 1 shows the process of formation of a second program block intended for diffusion.<br>
When a program block PB1 is ready to be diffused, the method of the invention consists in determining the future localization of this block in the security module. Once this localization is known, it is possible to find the content that had been programmed at the time of the personalization thanks to data stored in the management centre. Once this data is known, the operation consists of mixing this data with the program block PB1 in order to obtain a new data block SBI.<br>
This mixing operation can be of different kinds. The simplest way is to use a XOR function between the program block PB1 and the pre-registered data MM_Ref.<br>
A second example of mixing consists in enciphering each memory location of the program block PB1 with the content of the pre-registered data MM_Ref.<br>
The result of this mixing forms the second program block SBI. This block composed in this way can be transmitted to the related security module, according to the communication mode available between the management centre and the security module. It is enciphered by encryption keys of the system according to known methods.<br>
Figure 2 shows the writing process in the memory of the security module.<br>
The writing operation of the new program block in the memory of the security module, once the second block has been received, passes through a reading operation of the content of the target memory location. According to our example, each memory location i<br>
5<br><br>
of the target area MEM is read and processed (or mixed) according to the chosen algorithm. In this example, each memory location is mixed with the corresponding<br>
location i of the second block SB1 of the program. The result is registered in the memory of the security module.<br>
It should be noted that the program block to be updated is accompanied by verification data according to known modes (hash, CRC etc). Once the program is stored in the module memory, and has been duly verified, it can generally be activated by the modification of a part of the program in the main area.<br>
This process can be recurrent, that is to say that if one wishes to modify a part in the program area that has already received a program, the former program functions as a pre-registered value. According to one example wherein the new program would occupy more space, the management centre takes the contents of the previous program as pre-registered values, and for memory space still not used, would use the pre-registered values generated at the time of personalization.<br>
In practice, the management centre will preserve a virtual security module whose content represents the content of the security module in the location. All the programs intended for the security modules are also introduced into the virtual module.<br>
According to a variant of the embodiment, only one part of the target zone is pre-registered by specific values, for example one location in three. The rest are left blank. Therefore, the mixture will be executed only on one location in three, the other locations being left without modification.<br>
6<br><br>
We Claim:<br>
1. Secure method to update software embedded in a security module, this method comprising the following steps:<br>
formation of a first updating program block (PB1),<br>
-	determination of a target memory zone of said security module,<br>
determination through said security module, of a pre-registered content (MM_Ref) in said target memory zone ,<br>
-	formation of a second program block (SB1) obtained by the mixing of all or a part of the pre-registered content with the first program block (PB1),<br>
-	transmission of the second program block (SB1) to the security module,<br>
-	reception of the second block by the security module,<br>
-	reading of the target memory zone (MEM),<br>
obtaining and writing in the target memory zone of the first block by the inverse mixing of all or part of the second block and of the target memory zone content.<br>
2.	Method according to claim 1, characterized in that the target memory zone is pre-registered by randomly generated values.<br>
3.	Method according to claim 1 implementing a module that includes a microprocessor, characterized in that the target memory zone is pre-registered by a dummy programme not executed by the microprocessor of the security module.<br>
4.	Method according to claims 1 to 3, characterized in that the mixing operation is an exclusive OR function.<br>
5.	Method according to claims 1 to 3, characterized in that the mixing operation is an encryption function with the content of the pre-registered memory as the encryption<br><br><br>
key.<br><br>
Dated this 2nd day of January 2007<br><br>
7<br><br>
ABSTRACT<br>
The aim of this invention is to propose a transmission method of a message containing a program block that allows to avoid the consequences of a possible malicious decryption of this message.<br>
This aim is achieved through a secure method to update software embedded in a security module, this method comprising the following steps:<br>
-	formation of a first updating program block (PB1),<br>
-	determination of a target memory zone of said security module,<br>
-	determination through said security module, of a pre-registered content (MM_Ref) in said target memory zone ,<br>
-	formation of a second program block (SB1) obtained by the mixing of all or a part of the pre-registered content with the first program block (PB1),<br>
-	transmission of the second program block (SB1) to the security module,<br>
-	reception of the second block by the security module, reading of the target memory zone (MEM),<br>
-	obtaining and writing in the target memory zone of the first block by the inverse mixing of all or part of the second block and of the target memory zone content.<br></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/viewdoc.aspx?id=QlQAmTskv1VikleOppudOg==&amp;amp;loc=vsnutRQWHdTHa1EUofPtPQ==" target="_blank" style="word-wrap:break-word;">http://ipindiaonline.gov.in/patentsearch/GrantedSearch/viewdoc.aspx?id=QlQAmTskv1VikleOppudOg==&amp;amp;loc=vsnutRQWHdTHa1EUofPtPQ==</a></p>
		<br>
		<div class="pull-left">
			<a href="269436-method-for-preparing-rare-earth-permanent-magnet-material.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="269438-method-of-reducing-porosity.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>269437</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>4/MUMNP/2007</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>44/2015</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>30-Oct-2015</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>21-Oct-2015</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>02-Jan-2007</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>NAGRAVISION SA</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>ROUTE DE GENEVE 22CH-1033 CHESEAUX-SUR-LAUSANNE,</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>OSEN KARL</td>
											<td>ROUTE DU MANDEMENT 453 1282 DARDAGNY</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>G06F1/00,G06F9/445</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/EP2005/052797</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2005-06-16</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>EP 04102768.1</td>
									<td>2004-06-17</td>
								    <td>EUROPEAN UNION</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/269437-secure-method-to-transmit-a-message-containing-a-program-block-to-a-security-module by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 07:28:20 GMT -->
</html>
