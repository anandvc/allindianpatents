<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/201070-method-for-the-encryption-of-information-transferred-between-data-transfer-devices-and-data-communication-system by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 02:26:23 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 201070:METHOD FOR THE ENCRYPTION OF INFORMATION TRANSFERRED BETWEEN DATA TRANSFER DEVICES AND DATA COMMUNICATION SYSTEM</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">METHOD FOR THE ENCRYPTION OF INFORMATION TRANSFERRED BETWEEN DATA TRANSFER DEVICES AND DATA COMMUNICATION SYSTEM</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>The object of the invention is a method for the encryption of information transferred between data transfer devices (MS, SGSN) in a data communication system wherein one or more data frames are created from one or more data packets formed from the information by the application. The data frames comprise at least a header field and a data field. In the method, at least some part of the data packets is ciphered by using a ciphering key (Kc). To the data frames, synchronization data (COUNT) is attached, the value of which is changed at least at the transmission of each data frame.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>The present invention relates to a method for the encryption of intonation being transferred between data communication devices in a data communication system wherein one or more data frames are fined from one or more data packets formed from the information by an application, and these data frames comprise at least a header field and a data field. The invention relates additionally to a data commuiucations system which comprises the means for the encryption of information being transferred between data transfer devices, the means for forming one or more data packets from the information and the means for forming data frames from the data packets.<br>
Data transfer between separate data transfer devices can be achieved in such a way that those data transfer devices between which data at that time is to be transferred, are linked together for the time needed for the data transfer. In such a case, the link is maintained until the user stops the data transfer. In such cases, most part of the linkage time is spent in entering commands provided by the user and only a small part of the time is actual data transfer. This limits, for example, the maximum number of simultaneous users. Another possibility is to exploit a so-called packet switched data transmission. In this case, data is transferred between data transfer devices in a packet mode, in which case the time between the packets is freely available and can be used by other data transfer devices. In this case, the number of simultaneous users can be increased, especially in wireless data transfer networks, such as cellular networks, since in this case the mobile stations which are in the same cellular area can use the same transfer channel. One such a cellular system is the GSM system (Group Special Mobile) for which a packet mode data transfer service GPRS (General Packet Radio Service) has been developed. Fig. 1 shows a block diagram of principal blocks in the operation of the GPRS system. A packet switching controller SGSN (Serving GPRS Support Node) contiols the operation of packet switching service on the cellular network side. The packet switching controller SGSN contiols the sign-on and sign-off of the mobile station MS, the updating of the location of the mobile station MS and the routing of data packets to their correct destinations. The mobile station MS is connected to the base station subsystem BSS through a radio interface Um (Fig.  1). The base station subsystem is connected to the packet switching<br><br>
controller SGSN through the BSS-SGSN terrace Gb. In the base station subsystem ESS, the base station BTS and the base station controller BSC have been connected to each other by a BTS-BSC interface Abis. The location of the packet switch controller SGSN in the mobile station network can vary, for example, according to which technical supplementation is beg used. Although in Fig. 1, the packet switching controller SGSN has been marked outside the base station subsystem BSS, the packet switching controller SGSN can be placed, for example, as a part of the base station BTS connected to the base station subsystem BSS or as a part of the base station controller BSC.<br>
The GPRS system has been described, for example, in draft proposals GSM 01.60, GSM 02.60, GSM 03.60 and GSM 04.60 which have been dated prior to the application date of the present invention.<br>
The operation of both the mobile station MS and the packet switching controller SGSN can be divided into various layers, each providing a different function, as has been shown in Fig. 2. The International Standardisation Organisation, ISO, has formulated an OSI model (Open Systems Inter-comiections) for grouping data transfer into different functional layers. In this model, there are seven layers which are not necessarily needed in all data communication systems.<br>
Transferable information, such as control signalling and data transmitted by the user, between a mobile station MS and a packet switching controller SGSN is exchanged preferably in a data   mode. The data frame of each layer consists of a header field and a data field. Fig. 2 shows also the structure of data  being used in the GPRS system in different layers.<br>
The information contained m the data field can be, for example, data entered by the user of the mobile station or signalling data. The data field may contain confidential information which has to be secured as reliably as possible before transmitting it to the radio path, hi such a case, the encryption has to be executed m such a way that m all simuhaneous connections between the packet switching controller SGSN and mobile stations MS coimector to it, a separate encryption key is used. Conversely, it is not preferable to cipher the address data of the data   by the same encryption key used in the ciphering of die data field, since mobile stations MS use a shared radio path resource, i.e.<br><br>
information in many different connections is transfered in the same channel, for example, at different time intervals. In this case, each mobile station should receive all messages transmitted in the channel concerned and decrypt at least the encryption of the address data to identify to which mobile station the message is intended. Also the packet switching controller SGSN does not know which encryption key should be used.<br>
In the following, the operational functions of the layers of the GPRS system have been presented.<br>
The lowest layer is called an MAC layer (Media Access Control) which controls the use of the radio path in the communication between the mobile station MS and the base station subsystem BSS, such as allocating channels for transmitting and receiving packets.<br>
Data transmission between the base station subsystem and the packet controller SGSN in the lowest level is executed at the L2 layer (link layer) in which link layer protocol is used, such as LAPD protocol according to standard Q.921, frame relay protocol or the equivalent. The L2 layer may additionally contain also quality or routing data according to GPRS specifications. Layer L2 has properties of the physical layer and the link layer of the OSI model. The physical transmission line between the base station subsystem BSS and the packet controller SGSN depends, for example, on where the packet controller SGSN has been located in the system.<br>
Above the MAC layer, there is an RLC layer (Radio Link Control) and its fimction is to divide the data frames formed by the LLC layer into fixed sized packets to be transmitted to the radio path and their transmission and retransmission when necessary. The length of the packets in the GRPS system is the length of one GSM time slot (approximately 0.577 ms).<br>
LLC layer (Logical Link Control) provides a reliable transmission link between the mobile station MS and the packet controller SGSN. The LLC layer, for example, adds to the transmitted message error checking data by means of which it is intended to correct those uncorrectly received messages and when necessary, the message can be retransmitted.<br><br>
SNDC layer (Sub-Network Dependent Convergence) comprises ftmctions like protocol conversions of transmitted information, compression, segmentation and segmentation of messages coming from the upper layer. Additionally, ciphering and deciphering are accomplished at the SNDC layer. The structure of the SNDC frame has been presented also in Fig. 2. The SNDC frame comprises an SNDC header field (SNDC header) and an SNDC data field (SNDC data). The SNDC header field consists of protocol data (Network Layer Service access point Identity, NLSI) and of SNDC control data, such as determinations of compression, segmentation and ciphering. The SNDC layer functions as a protocol adapter between protocols used at the upper level and the protocol of the LLC layer (link layer).<br>
The transmitted information comes preferably as data packets to the SNDC layer from some application, such as messages according to the GPRS system or packets of the Intemet protocol (IP). The application can be, for example, a data application of a mobile station, a telecopy application, a computer program which has a data transmission link to a mobile station, etc.<br>
The MAC layer, RLC layer, LLC layer and the L2 layer contain properties which are described at layer 2 in the OSI model. The above mentioned layers and the layers described in the OSI model are not, however, distinctly coherent.<br>
The SNDC frame is transferred to the LLC layer where an LLC header field is added to the frame. The LLC header field consists of a Temporary Logical Link Identity (TLLI) and an LLC control part. The packet controller GPRS establishes a TLLI identity for each data transmission link between a mobile station MS and a packet controller GPRS. This data is used in data transmission for defming which data transmission link each message belongs to. Simultaneously, the same TLLI identity can only be used in one data transmission link. After the termination of the link, the TLLI identity used in the Imk can be allocated to a new link to be subsequently formed. The LLC control part defmes the frame number and the command type (info, acknowledge, retransmission request etc.) for ensuring an error free data transfer.<br><br>
Ciphering in the GSM system is executed at the physical layer as a bit per bit ciphering, i.e. bit stream transmitted to the radio path is fr)rmed by summing to the transmitted data ciphering bits which are formed by using algorithm A5 known per se, by using a ciphering key Kc. Algorithm A5 ciphers transmitted data aiid signalling information at the physical layer on the channels dedicated to data transfer (Traffic Channel, TCH or Dedicated Control Channel, DCCH).<br>
Synchronization of transmitted messages is ensured in such a way that algorithm^ is driven by means of a special synchronization data (COUNT). The synchronization data COUNT is formed on the basis of a TDMA frame number. Then the contents of each 114-bit block formed by algorithm A5 depend only on the frame numbering and the ciphering key Kc.<br>
The setting of the ciphering key Kc is most preferably executed at the stage when the communication traffic of the dedicated charmel has not yet been encrypted and the mobile station network being used has identified the mobile station MS. In the identification in the GSM system, an International Mobile Subscriber Identity, IMSI, is used which identifies the mobile station and which has been stored in the mobile station, or a Temporary Mobile Subscriber Identity, TMSI, is used which has been formed on the basis of the subscriber identity. In a mobile station, also a subscriber identification key, Ki, has been stored. The subscriber identification key Ki is also known by the mobile station network.<br>
To ensure that the ciphering key Kc is known only by the mobile station MS and the mobile station network, the transmission of the ciphering key from the base station subsystem BSS to the mobile station MS is indirect. Then, in the base station subsystem BSS, a Random Access Number, RAND, is formed which is fransmitted to the mobile station MS. The ciphering key Kc is formed from the random access number RAND aiid from the subscriber identification key Ki by using algorithm A8^ as has been shown in Fig. 3. The calculation and storing of the ciphering key Kc are executed both in the mobile station MS and in the mobile station network.<br>
Data transfer between the mobile station MS and the base station subsystem BSS is nonciphered at the start of the cormection. The fransition to the ciphered mode proceeds preferably in such a way that the base station subsystem BSS<br><br>
transmits to the mobile station a certain command (unciphered) which in this context is called the "start cipher". After the mobile station MS has received the command "start cipher", it starts the enciphering of the transmitted messages and deciphering of the received messages. Correspondingly, the base station subsystem BSS starts the enciphering of messages transmitted to the mobile station after the base station subsystem has received the ciphered message transmitted by the mobile station and deciphered the ciphering correctly.<br>
In the above described ciphering, the synchronization was based, for example, on the TDMA frame numbering of the physical layer. It is not possible to use it in all applications, particularly when information belonging to different connections is transmitted on the same channel, such as in packet switched data transmission methods.<br>
In the European patent application EP-0 689 316, a method has been presented for the encryption of data transfer wherein, for example, encryption data which comprises an encryption key is attached to the transmitted data frames. A US patent US-5,319,712 comprises a method and equipment for the encryption of data transfer so that a sequence number is attached to the data frames of the link layer and the data frame is ciphered. A disadvantage of these ciphering methods according to the prior art is, for example, that the receiver does not know without deciphering, to whom the received data frame is intended, in which case the unnecessary reception of data frames and deciphering causes a deterioration in the efficiency of the system.<br>
The aim of the present invention is to provide a method and equipment for the encryption of data transfer in a data transfer system wherein the transferred data is in a data frame mode and which data transfer system has been divided into fimctional layers in which case the data frame structure can be different in the different layers. The method according to the invention is characterized in that at least some part of the data packets is ciphered by a ciphering key and that synchronization data is attached to the data frames and its value is changed at least at the transmission of each data frame. The system according to the invention is characterized in that the means for ciphering the information comprise at least:<br>
means for ciphering data packets with a ciphering key,<br><br>
means for attaching synchronization data to the data frames,<br>
means for changing the  value  of the  synchronization data at the<br>
transmission of each data frame, and<br>
means for interpreting the synchronization data in the data transfer<br>
device of the receiver.<br>
Considerable advantages are achieved by the invention, compared to the ciphering methods according to the prior art. In the method according to the invention, die header field of the data frame of the physical layer can be transmitted in a non-ciphered mode, or methods which are presently known can be used in the ciphering. In the method according to the preferable embodiment of the invention, the ciphering key is changed for each transmission block of the physical layer, in which case deciphering without knowledge about the ciphering key is virtually impossible. By usmg the method according to the invention, it is possible additionally to implement a partial enciphering, in which case only a part of the transmitted data frames is ciphered. In this case, for example, advertisements can be delivered non-ciphered and other information ciphered only to those v^^ho have the right to receive ciphered data frames and to decipher them.<br><br>
Accordingly, the present invention provides a method for the encryption of information transferred between data transfer devices (MS, SGSN) in a data communication system wherein one or more data frames are created from one or more data packets formed from the information by the application, and these data frames comprise at least a header field and a data field, characterized in that:<br>
-	at least one part of the data frames, especially the data fields of the data<br>
frames, is ciphered by using a ciphering key (Kc),<br>
-	a synchronization data (COUNT) is attached to the data frames, wherein the synchronization data includes a sequence number of each of said data frames,<br>
-	a separate ciphering key (Kc) is allocated to each connection, and<br>
data is added to the data frame which indicate whether the data frame concerned is ciphered or non-ciphered.<br>
The present invention also provides a data communication system which comprises means for encryption of information transferred between data transfer devices (MS, SGSN), means for forming one or more data packets of the information, means for forming one or more data frames from each data packet in an appropriate data transfer level (SNDC, LCC), which data frames comprise at least a header field and a data field, characterized in that the means for encryption of information comprise at least:<br>
-	means for ciphering at least one part of the data frames, especially the data<br>
fields of the data frames, by a separate ciphering key (Kc) which is allocated to<br>
each connection,<br>
means for attaching synchronization data (COUNT) to the data frames, wherein the synchronization data includes a sequence number of each of said data frames.<br><br>
-	means for changing the value of the synchronization data (COUNT) at the transmission of each data frame,<br>
-	means for adding the data to the data frame which indicate whether the data frame concerned is ciphered or non-ciphered, and<br>
-	means for interpreting synchronization data in the data frames.<br><br>
, The invention is described in more detail in the following by referring to the attached drawings in which<br>
Fig. 1        shows the logical structure of the GPRS system as a schematic block diagram,<br>
Fig. 2        shows the layer structure of the GPRS system and the data frame structure of the layers.<br>
Fig. 3        shows defmition of the ciphering key according to the prior art in mobile stations and in a mobile station network as a schematic block diagram.<br>
Fig. 4a      shows ciphering according to  a preferable  embodiment of the invention,<br>
Fig. 4b      shows ciphering according to another preferable embodiment of the invention,<br><br>
Figs. 5a-5d show the data frame structure of the link layer according to an embodiment.<br>
Fig. 6a shows the data frame structure of the adapting layer according to an embodiment with Point-to-Point connection, and<br>
Fig. 6b shows the data frame structure of the adapting layer according to an embodiment with multipoint connection.<br>
In the following, the invention has been visualized by means of a packet switching service GPRS implemented in the GSM system, but the invention has not, however, been limited only to this system.<br>
In the invention, one has aimed at the implementation wherein as much as possible of the existing ciphering technique is exploited, such as the ciphering of the GSM system which is adjusted so that it can be applied in the transmission of data frames, for example, in the GPRS system. One advantage of the invention is that it can be applied in many operational modes, such as the Point-to-Point, PTP^ connection, multipoint connection (Point-to-Multipoint-Multicast, PTM-M; Point-to-Multipoint-Group, PTM-G) etc. The ciphering methods are classified mainly on the basis of the TLLI identity. A distinct TLLI identity is allocated for each connection type between the mobile station MS and the packet switching controller SGSN. The following different types are available for use in the GPRS system according to present standards:<br>
Point-to-Point (PTP) uses unique TLLI identity in the communication between the mobile station MS and the packet switching controller SGSN.<br>
Point-to-Multipoint-Multicast (PTM-M) uses TLLI allocated for the communication between the mobile station MS and the multicast service provider.<br>
Point-to-Multipoint-Group (PTM-G) uses TLLI allocated for mutual communication via multicast service provider of mobile stations MS within the mobile station group.<br><br>
Point-to-Point connection typically uses the acknowledged mode at the link layer level, i.e. the receiver of the transmission transmits data as an acknowledgement of a correct reception. At Point-to-Multipoint connections, data frames are usually transmitted by using operation mode in which acknowledgements are not transmitted.<br>
As akeady has been stated earlier in this description, in systems where data of different connections is transmitted in the same channel, it is not preferable to cipher the header field of data frames by a unique ciphering key for each connection. In this case, the data, firames are ciphered at least partly at some other layer than the physical layer. In the GPRS system, the ciphering is executed at the LLC layer. The transmitted data is ciphered in such a way that to each bit of the data frame, a corresponding bit of the ciphering bit string is summed. The ciphering bit string has been formed preferably by a ciphering algorithm by using an individual and unique ciphering key Kc. The ciphering algorithm is, for example, the A5 algorithm known from the GSM system.<br>
In addition to the correct address, one has to ensure that the data frames can be sequenced in the receiver. This can be implemented in a manner known per se, so that synchronization data COUNT is entered into the ciphering algorithm, in which case the receiver is able, after deciphering, to find out the sequence of the data frames. For example, in TDMA systems (Time Division Multiple Access), like GSM, the TDMA frame number can be used for numbering the data frames of the physical layer. However, the packet switching controller SGSN of the GPRS system does not know the TDMA frame number, so in this invention a method has been developed for synchronizing data frames, and in this method the sequence number of data frames (data frame number) is used as a synchronization data. Thus the contents of each transmitted block are determined by, for example, the frame numbering and the ciphering key Kc.<br>
The amount of data to be ciphered varies in different connections, but this is not significant in the application of the invention since the ciphering can be executed by dividing the transmitted data preferably into sub-blocks of standard length. Then the first bit of each sub-block is ciphered by the first bit of the ciphering algorithm, the second bit of the sub-block by the second bit of the ciphering algorithm etc. In the GPRS system, the length of a sub-block can be, for example, 114 bits, such as in the present GSM system. The length of<br><br>
the sub-block can be, preferably, also divisible by the length of a byte. In many applications, the length of the byte is eight, in which case a suitable length for a sub-block could be 64 bits.<br>
In the GSM system, a mobile station MS can use only one ciphering key Kc at a time. In the GPRS system, one ciphering key per mobile station MS is not necessarily sufficient in every situation, since the mobile station can simultaneously have many different types of active connections (PTP, PTM) with each connection having most preferably a separate ciphering key Kc which has been preferably formed by different means. The ciphered data frame contains thus the ciphering key Kc being used, the synchronization data COUNT and possibly also the values COUNTb of a block counter BLCNT attached to the TLLI. Fig. 4a shows a preferable ciphering method according to the invention as a schematic block diagram in a situation where a non-encrypted sub-block (plain text in) is transferred encrypted (encrypted text) from the network to the mobile station. In this embodiment, also the value COUNTb of the block coxmter is used in the determination of the ciphering block BLOCK 1. The block counter can be set to its initial value by means of a setting line "clear", preferably at the start of the data frame of each adapting layer. Both at the network side and in the mobile station MS, the value of the synchronization data COUNT is calculated for each transmitted block, with the value of the synchronization data COUNT and the ciphering key Kc entered into the ciphering algorithm A5. At the transmission side, the output bit string (BLOCKl) is summed to the sub-block (plain text m). The encrypted sub-block is transferred in the channel to the mobile station MS. The mobile station MS deciphers it correspondingly by summing the output bit string (BLOCKl) of the ciphering algorithm A5 to the received encrypted sub-block and, as a result of the summing, a non-encrypted sub-block (plain text out) corresponding to the transmitted sub-block is obtained. Fig. 4b shows another preferable ciphering method according to the invention as a schematic block diagram. This embodiment differs from the embodunent of Fig. 4a mamly in that the block counter BLCNT is not used.<br>
A typical length of a frame sequence number is from six to eight bits. From the ciphering security point of view, this value as COUNT variable alone is not sufficient, and therefore also other variables can be used m the determination of the COUNT value of the synchronization data in addition to the frame<br><br>
sequence number, for example, the base station identification. The base station identification is known by both the network and the mobile station, since the mobile station, which is being used, notifies the packet switching controller SGSN about the changing of the base station. The changing of the base station alters thus the COUNT value of the synchronization data in this embodiment.<br>
In the Point-to-Point connection mode, the following variables are available in the determination of the COUNT value of the synchronization data:<br>
a)	The frame number of the Logical Link Control layer (LLC frame number, LLC #) which is conveyed to the adapting layer (SNDC).<br>
b)	The data frame number of the adapting layer (SNDC data block number, SDU#) which can be attached to the transmitted data frame or initialized at the start of the connection when it is maintained at both ends of the connection.<br>
c)	Identity of a routing area (Routing area #) which is known at both ends of the connection so that the identity need not be attached to the transmitted data frame.<br>
d)	Identity of the area of a packet switching controller (SGSN #) which is known at both ends of the connection so that the identity need not be attached to the transmitted data frame.<br>
e)	Identity of a base station (Cell #) which is known at both ends of the connection so that the identity need not be attached to the transmitted data frame.<br>
In Point-to-Multipoint connection mode, the following variables are available in the determination of the COUNT value of the synchronization data:<br>
a)	The data frame number of the adapting layer (SNDC data block number, SDU #) which is transmitted within the SNDC data frame.<br>
b)	Identity of a routing area (Routing area #) which is known at both ends of the connection so that the identity need not be attached to the fransmitted data frame.<br>
c)	Identity of the area of a packet switching confroUer (SGSN #) which is known at both ends of the connection so that the identity need not be attached to the transmitted data frame.<br><br>
d) Identity of a base station (Cell #) which is known at both ends of the connection so that the identity need not be attached to the transmitted data frame.<br>
Additionally, in both connection modes, the value of the block counter BLCNT can be used, which makes cracking of an encrypted data field even more difficult for an intruder, since the same ciphering bit string is not used in the encryption of sequential data fields. Otherwise, the recalculation is executed only once for each transmission of a data frame of the adapting layer. The length of the data frame of the adapting layer can be thousands of bits, so that it may be possible to find out the encryption key if the encryption algorithm is not calculated sufficiently often.<br>
The above presented variables defining the synchronization data COUNT can either be used alone or in combination. Some of the variables thus have to be delivered to the receiver within data frames and some of them can be managed locally. The use of locally managed variables increases the level of the security and to some extent it reduces the amount of transferred data. The following tables give an example of the contents of the synchronization data COUNT. Table 1.1 shows some synchronization data according to the most preferable embodiment of the invention and in it, a block counter BLCNT has been used, and table 1.2 shows another preferable embodiment of the invention and in it, the identity of the base station has been used instead of the value of the block counter COUNTb.<br><br>
Bit/ mode	22 |21	20	19	18	17 1 16	15	14	13	12	11	10	9	8     7	6	5	4	3	2	1<br>
PTP	SDU # (local or delivered)	LLC # (delivered)	COUNTb<br>
PTM	SDU # (delivered)	1	1	1	1	1	1	COUNTb<br>
Table 1.1	<br>
Bit/ mode	22	21	20	19	18	17	16	15	14	13	12	11	10	9	8	7	6	5	4	3	2	1<br>
PTP	SDU # (local or delivered)	LLC # (delivered)	Cell #, Routing area # or SGSN # (local)<br>
PTM	SDU # (delivered)	1	1	1	1	1	1	Cell #, Routing area # or SGSN # (local)<br>
Table 1.2<br><br>
In the following, the setting of the ciphering key Kc is described. The setting of the ciphering key Kc is initiated by the network as often as the network operator finds it necessary. Additionally, a unique ciphering key has to be generated for each TLLI connection. A table of the ciphering key Kc-TLLI identity pairs is most preferably maintained both in the packet switching controller GPRS and in the mobile station MS. The setting of the ciphering key is different for different connection types.<br>
In a Point-to-Point connection, the ciphering key Kc is transmitted indirectly by using a random access number RAND. The ciphering key Kc is formed in the GPRS system preferably from the random access number RAND and from the subscriber identification key Ki of the mobile station by using the algorithm A8, just as in the GSM system. The identification key of a mobile station has been stored on the SIM card (Subscriber Identity Module) of the mobile station and in the Authentication Centre AuC of the network.<br>
In a multipoint connection, all mobile stations which are connected to the same service use the same ciphering key Kc. The ciphering key Kc is activated when the connection to the service is created. The ciphering key Kc can be entered to the mobile station MS by using different methods. A multipoint service provider can enter the ciphering key, for example, in a ciphered mode, in which case the mobile station MS has to be logged to the packet switching controller GPRS through a Point-to-Point connection prior to gaining access to the multipoint connection. During the logon stage of the Point-to-Point coimection, a ciphering key Kc has been defined for the connection and it is used in the encryption of the ciphering key of the multipoint connection when it is transmitted to the mobile station MS.<br>
The ciphering key of the multipoint connection can also be entered, for example, by using the keypad of the mobile station MS, such as, for example, a PIN code, or a kind of SIM card can be used where, among other parameters, the ciphering key Kc has been stored.<br>
The ciphering key Kc need not be regenerated when the mobile station MS changes its location to the area of another packet switching controller GPRS<br><br>
because the ciphering key can be delivered from the previous packet switching controller to the new one.<br>
The transition from clear text mode to ciphered mode proceeds preferably in such a way that the packet switching controller GPRS transmits in clear text a special "start cipher" command. In the mobile station MS, the enciphering of the fransmission and the deciphering of the receiving start after the "start cipher" command has been correctly received by the mobile station. On the packet switching controller GPRS side, the enciphering starts correspondingly after the packet switching controller has received the message transmitted by the mobile station MS and deciphered it. The above described operation corresponds, in its main parts, to the start of the enciphering of the GSM system.<br>
In some packet switching applications, ciphering can be applied also in such a way that only messages going in one direction are ciphered, i.e. messages from the mobile station MS to the packet switching controller GPRS or from the packet switching confroUer GPRS to the mobile station MS. Applications like this include, for example, delivering of advertisements which are usually transmitted non-ciphered.<br>
Additionally, ciphering according to the invention can be applied also in such a way that only some part of the transmitted data frames of the adapting layer SNDC is ciphered. In this case, one encryption bit is most preferably added to the data frame of the adapting layer and it will indicate whether the data frame concerned is ciphered or non-ciphered. For example, when the encryption bit has the value zero, the data frame is non-ciphered and when the encryption bit has the value one, the data frame is ciphered. This can be used, for example, in situations where the access rights to a service require regisfration or the equivalent, in which case the registered users can decipher the ciphered data frames. For other users, the service provider can deliver information concerning services and advertisements in non-ciphered data frames.<br>
Fig. 5a shows an example of a data frame structure of a link layer according to a preferable embodiment. The header field of the data frame (frame header) comprises a TLLI identity of three bytes and a confrol part (Control) of two bytes. A byte comprises, as is known per se, eight binary information (bits).<br><br>
The information field of the data frame comprises the transmitted information. The length of the information field may vary. The data frame also contains a check field (Check sequence) of two bytes which includes, for example, error correction information.<br>
Fig. 5b shows the structure of the control part of the data frame of Fig. 5 a when the data frame is an information delivery and system supervisory data frame (Information + supervisory) wherein:<br>
C/R indicates whether it is a question of a command or a response<br>
(Command/Response),<br>
SI and S2 describe the type of the supervisory command,<br>
N(S) is the number of the sending sequence (Send sequence number),<br>
P/F indicates whether it is a question of a confirmation request message<br>
(P) or a confirmation message (F) (Poll/Final), and<br>
N(R) is the number of the reception sequence (Receive sequence<br>
number).<br>
Fig. 5 c shows the structure of the confrol part of the data frame of Fig. 5 a when the data frame is a system supervisory data frame (Supervisory). The significance of bits has been described above.<br>
Fig. 5d shows the structure of the control part of the data frame of Fig. 5a when the data frame is an unnumbered data frame (Unnumbered) wherein:<br>
Ml-5 are uimumbered commands and responses,<br>
G/D indicates whether it is a question of a control or a data frame<br>
(Control/Data), and<br>
x-bits are not significant.<br>
Fig. 6a shows an example of a data frame structure with a Point-to-Point connection of an adapting layer according to a preferable embodiment. The first byte contains control data in which:<br>
-	M indicates whether it is a question of the last segment of the information formed by the application,<br>
-	E indicates whether the ciphering is in use,<br>
-	Pri indicates the priority classification,<br>
-	NLSI is protocol data which can be, for example,<br><br>
-	TCP/IP,<br>
-	CLNP,<br>
-	X.25,<br>
-	GPRS, etc.<br>
Fig. 6b shows an example of a data frame structure with a multipoint connection of an adapting layer according to a preferable embodiment. The significance of bits has been described above.<br>
Although the invention has been described above in a data transfer system where mobile stations MS, base station subsystems BSS and packet switching controllers SGSN of a GPRS system are used, the invention can be applied also in other data transfer systems, such as TDMA and CDMA data transfer systems, most preferably in packet switching data transfer systems.<br>
The invention has not been limited only to the above presented embodiments, but it can be modified within the scope of the attached claims.<br><br><br>
WE CLAIM :<br>
1.	A method for the encryption of information transferred between data<br>
transfer devices (MS, SGSN) in a data communication system wherein<br>
one or more data frames are created from one or more data packets<br>
formed from the information by the application, and these data frames<br>
comprise at least a header field and a data field, characterized in that<br>
-	at least one part of the data frames, especially the data fields of the data<br>
frames, is ciphered by using a ciphering key (Kc),<br>
-	a synchronization data (COUNT) is attached to the data frames,<br>
wherein the synchronization data includes a sequence number of each of<br>
said data frames,<br>
-	a separate ciphering key (Kc) is allocated to each connection, and<br>
-	data is added to the data frame which indicate whether the data frame concerned is ciphered or non-ciphered.<br><br>
2.	The method according to claim 1, wherein data frames are divided into at least one sub-block, synchronization data comprises a block counter (BLCNT) which is allocated separately to each connection and to which an initial value is set at the start of the connection and the value of which is changed at the transmission of each sub-block.<br>
3.	The method according to claims 1 or 2, wherein data frames are formed at the adapting layer (LLC).<br>
4.	The method according to claim 3, wherein the data frames of the adapting layer are transferred to the link layer (MAC, RLC, LLC, L2) wherein data<br><br>
frames of the link layer are formed from the data frames of the adapting layer for the transmission to the transmission path (Um, Gb).<br>
The method according to claim 4, wherein synchronization data (COUNT) comprises at least one of the following:<br>
-	data frame number of the link layer (LLC #),<br>
-	data frame number of the adapting layer (SDU #),<br>
-	identity of the routing area (Routing area #),<br>
-	identity of the area of the packet switching controller (SGSN #),<br>
-	identity ofa cell (Cell #).<br>
The method according to claim 5, wherein the data frame number of the adapting layer (SDU #) is formed and maintained locally in data transfer devices (MS, SGSN) linked to the data transfer connection in which case the sequence number is set to its initial value at the start of the connection and it is updated in a previously defined manner during the connection.<br>
The method according to claim 5, wherein the data frame number of the link layer (LLC #) is maintained in one data transfer device (MS, SGSN) of the data transfer connection and it is delivered to other data transfer devices in the data frame of the link layer.<br>
The method according to any of claims 1-7, wherein the data transfer connection is a data transfer connection of a packet switching system, such as a GPRS system.<br><br>
9.	The method according to any of claims 1-8, wherein the data transfer connection is a Point-to-Point connection (PTP).<br>
10.	The method according to any of claims 1-9, wherein the data transfer connection is a multipoint connection, such as a Point-to-Multipoint-Multicast (PTM-M) or a Point-to-Multipoint-Group (PTM-G).<br>
11.	The method according to claim 10, wherein information is transferred between the data transfer device (SGSN) of a data service provider and the data transfer devices (MS) of data service users, wherein a ciphering key (Kc) allocated separately to each connection is set to the data transfer devices (MS, SGSN) by transferring the ciphering key (Kc) in a ciphered mode in the data transfer system, by using the keypad of the data transfer device or a smart card (SIM).<br>
12.	The method according to claims 10 or 11, wherein<br><br>
-	only data transmitted from the data transfer device (SGSN) of a data service provider to data transfer devices (MS) of data service users is ciphered at least partly,<br>
-	only data transmitted from data transfer devices (MS) of data service users to the data transfer device (SGSN) of data service provider is ciphered at least partly, or<br>
-	data transmitted in both directions is ciphered at least to some extent.<br>
13.	The method according to claim 12, wherein at the start of ciphering, data<br>
concerning the direction in which data transfer is ciphered, is transmitted<br>
to data transfer devices.<br><br>
14.	The method according to any of the previous claims, wherein only some part of the data frames of the adapting layer is ciphered, in which case data of the ciphering of each data frame is most preferably transmitted in the header field of the data frame.<br>
15.	A data communication system which comprises means for encryption of information transferred between data transfer devices (MS, SGSN), means for forming one or more data packets of the information, means for forming one or more data frames from each data packet in an appropriate data transfer level (SNDC, LCC), which data frames comprise at least a header field and a data field, characterized in that the means for encryption of information comprise at least:<br><br>
-	means for ciphering at least one part of the data frames, especially the data fields of the data frames, by a separate ciphering key (Kc) which is allocated to each connection,<br>
-	means for attaching synchronization data (COUNT) to the data frames, wherein the synchronization data includes a sequence number of each of said data frames,<br>
-	means for changing the value of the synchronization data (COUNT) at the transmission of each data frame,<br>
-	means for adding the data to the data frame which indicate whether the data frame concerned is ciphered or non-ciphered, and<br>
-	means for interpreting synchronization data in the data frames.<br>
16.	The data communication system according to claim 15, wherein the data<br>
transfer means comprise at least one mobile station (MS).<br><br>
17.	The data communication system according to claim 15, wherein the data<br>
transfer means comprise at least one base station (BTS).<br>
18.	The data communication system according to claim 16, wherein the<br>
mobile station (MS) is a GSM mobile station.<br>
19.	The data communication system according to claim 17, wherein the base<br>
station (BTS) is a GSM base station.<br>
20.	A method for the encryption of information transferred between data<br>
transfer devices substantially as herein described with reference to the<br>
accompanying drawings.<br>
21.	A data communication system substantially as herein described with<br>
reference to the accompanying drawings.</td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTE2Mi1tYXMtMTk5NyBhYnN0cmFjdCBkdXBsaWNhdGUucGRm" target="_blank" style="word-wrap:break-word;">1162-mas-1997 abstract duplicate.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTE2Mi1tYXMtMTk5NyBhYnN0cmFjdC5wZGY=" target="_blank" style="word-wrap:break-word;">1162-mas-1997 abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTE2Mi1tYXMtMTk5NyBjbGFpbXMgZHVwbGljYXRlLnRpZg==" target="_blank" style="word-wrap:break-word;">1162-mas-1997 claims duplicate.tif</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTE2Mi1tYXMtMTk5NyBjbGFpbXMucGRm" target="_blank" style="word-wrap:break-word;">1162-mas-1997 claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTE2Mi1tYXMtMTk5NyBjb3JyZXNwb25kZW5jZSBvdGhlcnMudGlm" target="_blank" style="word-wrap:break-word;">1162-mas-1997 correspondence others.tif</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTE2Mi1tYXMtMTk5NyBjb3JyZXNwb25kZW5jZSBwby5wZGY=" target="_blank" style="word-wrap:break-word;">1162-mas-1997 correspondence po.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTE2Mi1tYXMtMTk5NyBkZXNjcmlwdGlvbiAoY29tcGxldGUpIGR1cGxpY2F0ZS5wZGY=" target="_blank" style="word-wrap:break-word;">1162-mas-1997 description (complete) duplicate.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTE2Mi1tYXMtMTk5NyBkZXNjcmlwdGlvbiAoY29tcGxldGUpLnBkZg==" target="_blank" style="word-wrap:break-word;">1162-mas-1997 description (complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTE2Mi1tYXMtMTk5NyBkcmF3aW5ncy5wZGY=" target="_blank" style="word-wrap:break-word;">1162-mas-1997 drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTE2Mi1tYXMtMTk5NyBmb3JtLTE5LnBkZg==" target="_blank" style="word-wrap:break-word;">1162-mas-1997 form-19.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTE2Mi1tYXMtMTk5NyBmb3JtLTIucGRm" target="_blank" style="word-wrap:break-word;">1162-mas-1997 form-2.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTE2Mi1tYXMtMTk5NyBmb3JtLTI2LnBkZg==" target="_blank" style="word-wrap:break-word;">1162-mas-1997 form-26.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTE2Mi1tYXMtMTk5NyBmb3JtLTQucGRm" target="_blank" style="word-wrap:break-word;">1162-mas-1997 form-4.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTE2Mi1tYXMtMTk5NyBmb3JtLTYucGRm" target="_blank" style="word-wrap:break-word;">1162-mas-1997 form-6.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTE2Mi1tYXMtMTk5NyBvdGhlcnMucGRm" target="_blank" style="word-wrap:break-word;">1162-mas-1997 others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTE2Mi1tYXMtMTk5NyBwZXRpdGlvbi5wZGY=" target="_blank" style="word-wrap:break-word;">1162-mas-1997 petition.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="201069-a-magnetoelastic-torque-sensor-and-a-method-of-sensing-a-torque.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="201071-methods-and-system-for-efficient-per-flow-resource-allocation-in-wireless-multimedia-networks.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>201070</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>1162/MAS/1997</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>08/2007</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>23-Feb-2007</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>29-Jun-2006</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>30-May-1997</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>M/S. NOKIA MOBILE PHONES LTD</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>KEILALAHDENTIE 4, FIN-2150 ESPOO</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>KARI, HANNU</td>
											<td>KULLERVONKUJA 9 B 9, FIN 02880 VEIKKOLA,</td>
										</tr>
										<tr>
											<td>2</td>
											<td>HAMALAINEN, JARI</td>
											<td>MATTI TAPION KATU 1 F 17, FIN 33720 TAMPERE,</td>
										</tr>
										<tr>
											<td>3</td>
											<td>KARPPANEN, ARTO</td>
											<td>VATTUNIEMENKATU 4 D 64, FIN-00210 HELSINKI,</td>
										</tr>
										<tr>
											<td>4</td>
											<td>JUOPPERI, JARI</td>
											<td>LUUTNANTINTIE 3 D 30, FIN-00410 HELSINKI,</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04L 9/28</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>N/A</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td></td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>962353</td>
									<td>1996-06-06</td>
								    <td>Finland</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/201070-method-for-the-encryption-of-information-transferred-between-data-transfer-devices-and-data-communication-system by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 02:26:24 GMT -->
</html>
