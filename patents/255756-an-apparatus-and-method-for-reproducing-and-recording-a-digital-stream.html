<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/255756-an-apparatus-and-method-for-reproducing-and-recording-a-digital-stream by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 10:18:06 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 255756:AN APPARATUS AND METHOD FOR REPRODUCING AND RECORDING A DIGITAL STREAM</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">AN APPARATUS AND METHOD FOR REPRODUCING AND RECORDING A DIGITAL STREAM</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>The invention relates to a reproduction apparatus for reproducing a digital stream generated by multiplexing a video stream and a graphics stream, comprising a video decoder(5) operable to decode the video stream to generate a moving picture; a graphics decoder(12) ; and a plane memory (8), wherein the graphics stream is a sequence of packets, the packets constituting the graphics stream include two types, one of which is packets containing graphics data (ODS) and the other is packets containing control data (PCS), the sequence of packets includes a pair of a packet containing graphics data (ODS) and a packet containing control data (PCS), the pair is followed by a packet containing control data (PCS) that performs a forward reference,the control data (PCS) that performs the forward reference indicates that graphics, which corresponds to the graphics data (ODS) contained in the pair of packets which precedes the control data (PCS) that performs the forward reference, is to be displayed, the graphics decoder (12) comprises: an object buffer (15) ;a processor (14) operable to generate graphics on the object buffer (15) by decoding the graphics data (ODS) contained in the pair of packets; and a controller (17) operable to execute a graphics display by writing the graphics generated on the object buffer (15) into a partial area in the plane memory (8), based on the control data (PCS) contained in the pair of packets, wherein the plane memory (8) is a memory for overlay with moving pictures and is provided in the reproduction apparatus, and when control data (PCS) that performs a forward reference has been read into the graphics decoder (12) from a recording medium, the controller (17) updates the graphics display by writing the graphics generated on the object buffer into the partial area again based on the read control data (PCS) that performs the forward reference.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td> <br><br>
Description<br>
Technical Field<br>
The present invention relates to a recording medium on<br>
which a digital stream generated by multiplexing a video stream<br>
and a graphics stream is recorded, and a reproduction apparatus<br>
for reproducing the digital stream. In particular, the<br>
present invention relates to techniques whereby the<br>
reproduction apparatus separately decodes the video stream<br>
and the graphics stream and overlays resulting video and<br>
graphics to produce a reproduction image.<br>
Background Art<br>
Video/graphics overlay techniques mentioned above<br>
enable to select graphics and display the selected graphics<br>
in accordance with a language setting or display setting of<br>
a reproduction apparatus. Also, the video/graphics overlay<br>
techniques enable to select whether or not to display graphics<br>
according to need. Because of their capability of offering<br>
such selections, the video/graphics overlay techniques are<br>
employed in player models of DVD-Video and ETSI EN 300 743.<br>
In these standards, the graphics stream is an arrangement<br>
of PES packets . The PES packets can be classified into two<br>
types : a PES packet carrying control information and a PES<br>
packet carrying graphics data which represents graphics . The<br><br>
control information is arranged before the graphics data,<br>
and one pair of control information and graphics data produces<br>
one graphics display. In more detail, the reproduction<br>
apparatus reads the control information and the graphics data<br>
in sequence, decodes the control information, and also decodes<br>
the graphics data to generate uncompressed graphics. The<br>
reproduction apparatus displays the uncompressed graphics<br>
with a desired presentation timing, according to a decoding<br>
result of the control information.<br>
According to this technique, decoding of graphics data<br>
needs to be performed for each graphics display. This being<br>
so, a time interval from one graphics display to the next<br>
graphics display depends on a time period required for a<br>
decoding process of graphics data. If graphics has a higher<br>
resolution and a decoding process of graphics data takes a<br>
longer time, a time interval with which graphics is updated<br>
lengthens.<br>
In the case of subtitling in a movie film or the like<br>
where graphics is updated with a time interval of 2 to 3 seconds,<br>
proper graphics displays can still be produced even if graphics<br>
has a higher resolution and decoding of graphics data takes<br>
a longer time. In the case where graphics is used specially<br>
as a means of amusement, however, the need to shorten the<br>
graphics update interval arises.<br>
For example, the use of graphics for amusement purposes<br>
includes such applications where graphics representing a<br>
dialog of a character is moved to attract the viewer' sattention<br>
or varied in color to surprise the viewer. Producers of video<br><br>
content such as variety shows are especially eager to adopt<br>
such graphics displays.<br>
To realize smooth movements of graphics, however, an<br>
operation of decoding graphics data and presenting graphics<br>
 needs to be performed within a short time of one frame period<br>
(1/29.97 seconds in NTSC). Repeating this operation of<br>
decoding graphics data and presenting graphics within each<br>
frame period requires a tremendous load, and is hard to be<br>
realized with hardware specifications of reproduction<br>
apparatuses that are expected to be provided at low cost.<br>
The aforementioned graphics movements and variations<br>
in color can be achieved by overlaying graphics on each frame<br>
of video beforehand so that graphics forms a part of a picture<br>
pattern of each frame. This method of overlaying graphics<br>
on each frame beforehand, however, lacks flexibility of being<br>
able to selectively display graphics in accordance with a<br>
language setting or display setting of a reproduction<br>
apparatus, and therefore does not have much future potential.<br>
Disclosure of Invention<br>
The present invention aims to provide a recording medium<br>
which enables graphics to be moved smoothly like moving<br>
pictures.<br>
The stated aim can be achieved by a recording medium<br>
used for storing data, including a digital stream generated<br>
by multiplexing a video stream and a graphics stream, wherein:<br>
the graphics stream is a sequence of a plurality of packets<br>
which include a packet containing control Information; and<br><br>
the control information indicates that graphics data<br>
contained in a preceding packet in the sequence is to be<br>
displayed at a predetermined time in a state of being overlaid<br>
on the video stream.<br>
Control information indicates that a display is to be<br>
produced using graphics data that precedes the control<br>
information. Accordingly, a display position of graphics can<br>
be changed by feeding only control information showing new<br>
coordinates of the graphics into a reproduction apparatus.<br>
Equally, a color of graphics can be changed by feeding only<br>
appropriate control information into the reproduction<br>
apparatus.<br>
Since a graphics display can be updated using only<br>
control information, graphics is easily brought into<br>
synchronization with video.<br>
Usually, a picture pattern of graphics itself need not<br>
be varied in order to change a display position of the graphics .<br>
This is because the human eye cannot perceive a moving object<br>
so distinctly. This being so, the technique provided by the<br>
present invention is suitable for displaying the same graphics<br>
while changing its position at high speed.<br>
Brief Description of Acccompanying Drawings<br>
FIG. 1 shows an example application of a recording medium<br>
to which embodiments of the present invention relate.<br>
FIG. 2 shows a structure of a BD-ROM shown in FIG. 1.<br>
FIG. 3 shows a structure of an AV Clip.<br>
FIG. 4A shows a structure of a Presentation graphics<br><br>
stream.<br>
FIG. 4B shows PES packets which contain functional<br>
Segments.<br>
FIG . 5 shows a logical structure made up of various types<br>
of functional Segments.<br>
FIG. 6 shows a relationship between subtitle display<br>
positions and Epochs.<br>
FIG. 7A shows a data structure of an ODS.<br>
FIG. 7B shows a data structure of a PDS.<br>
FIG. 8A shows a data structure of a WDS.<br>
FIG. 8B shows a data structure of a PCS.<br>
FIG . 9 shows an example description of DSs for displaying<br>
subtitles.<br>
FIG. 10 shows an example description of a PCS and a WDS<br>
in DS1.<br>
FIG. 11 shows an example description of a PCS in DS2.<br>
FIG. 12 shows an example description of a PCS in DS3 .<br>
FIG. 13 shows a memory space in an Object Buffer when<br>
performing graphics updates such as those shown in FIGS. 10<br>
to 12.<br>
FIG. 14 shows an example algorithm of calculating a<br>
DECODEDURATION.<br>
FIG. 15 is a flowchart of the algorithm shown in FIG.<br>
14.<br>
FIGS. 16A and 16B are flowcharts of the algorithm shown<br>
in FIG. 14.<br>
FIG. 17A shows a situation where one graphics Object<br>
exists in one Window.<br><br>
FIGS. 17B and 17C are timing charts showing parameters<br>
used in the algorithm shown in FIG. 14.<br>
FIG. 18A shows a situation where two graphics Objects<br>
exist in one Window.<br>
 FIGS. 18B and 18C are timing charts showing parameters<br>
used in the algorithm shown in FIG. 14.<br>
FIG. 19A shows a situation where two graphics Objects<br>
exist respectively in two Windows.<br>
FIG. 19B is a timing chart when decode period (2) is<br>
longer than a sum of clear period (1) and write period (31) .<br>
FIG. 19C is a timing chart when the sum of clear period<br>
(1) and write period (31) is longer than decode period (2) .<br>
FIG. 20 shows forward reference PCSs.<br>
FIG. 21A shows an Epoch that produces a display effect<br>
of moving graphics on a screen.<br>
FIG. 21B shows contents and PTSs of PCSs in DS1 to DS8 .<br>
FIG. 22A shows an ODS in DSO.<br>
FIG. 22B shows positions of coordinates (x1,y1), (x2,y2),<br>
(x3 , y3 ) , ... , (x8, y8) in a coordinate system defined by a Window.<br>
FIG. 23 shows a settings of a time stamp of a functional<br>
Segments in each DS.<br>
FIG. 24 shows a specific example of successive graphics<br>
updates.<br>
FIG . 25 shows a series of DSs for realizing a Palette-only<br>
Display Update.<br>
FIG. 26A shows contents of PDSs in DSO.<br>
FIG. 26B shows contents of PCSs in DSO to DS3.<br>
FIG. 27 shows a display effect achieved by feeding the<br><br>
four DSs.<br>
FIG . 28 shows an internal construction of a reproduction<br>
apparatus to which the embodiments of the present invention<br>
relate.<br>
FIG. 29 shows transfer rates Rx, Re, and Rd and sizes<br>
of a Graphics Plane, a Coded Data Buffer, and an Object Buffer<br>
shown in FIG. 28.<br>
FIG. 30 is a timing chart of pipeline processing in the<br>
reproduction apparatus.<br>
FIG. 31 is a timing chart of pipeline processing when<br>
decoding of ODSs ends before clearing of the Graphics Plane.<br>
FIG. 32 is a timing chart showing changes in occupancy<br>
of the Composition Buffer, the Object Buffer, the Coded Data<br>
Buffer, and the Graphics Plane.<br>
FIG. 33 is a flowchart of an operation of loading<br>
functional Segments.<br>
FIG. 34 shows a case when a skip operation is performed.<br>
FIG. 35 shows a situation where DS10 is loaded into the<br>
Coded Data Buffer when the skip operation is performed as<br>
shown in FIG. 34.<br>
FIG. 3 6 shows a case when normal reproduction is<br>
performed.<br>
FIG. 37 shows a situation where DS1 and DS20 are loaded<br>
into the Coded Data Buffer when the normal reproduction is<br>
performed as shown in FIG. 36.<br>
FIG. 38 is a flowchart of an operation of a Graphics<br>
Controller shown in FIG. 28.<br>
FIG. 39 is a flowchart of the operation of the Graphics<br><br><br><br>
As illustrated, the BD-ROM 100 has a BDMV directory below<br>
a ROOT directory. The BDMV directory contains a file<br>
(XXX.M2TS) storing an AV Clip, a file (XXX.CLPI) storing<br>
management information of the AV Clip, and a file (YYY.MPLS)<br>
defining a logical playback path (playlist) for the AV Clip.<br>
The BD-ROM 100 can be realized by generating such an application<br>
format. If there are more than one file for each of the above<br>
file types, three directories named STREAM, CLIPINF, and<br>
PLAYLIST may be provided below the BDMV directory, to store<br>
files of the same type as XXX.M2TS, files of the same type<br>
as XXX.CLPI, and files of the same type as YYY.MPLS<br>
respectively.<br>
The AV Clip (XXX.M2TS) in this application format is<br>
explained below.<br>
The AV Clip (XXX.M2TS) is a digital streamof the MPEG-TS<br>
(Transport Stream) format, and is obtained by multiplexing<br>
a video stream, at least one audio stream, and a Presentation<br>
graphics stream. The video streamrepresents amoving picture<br>
of the film, the audio stream represents audio of the film,<br>
and the Presentation graphics stream represents subtitles<br>
of the film. FIG . 3 shows a structure of the AV Clip (XXX. M2TS) .<br>
In the drawing, the middle level shows the AV Clip. This<br>
AV Clip can be created as follows. The video stream made up<br>
of a plurality of video frames (pictures pj1, pj2, pj3, ...)<br>
and the audio stream made up of a plurality of audio frames<br>
on the upper first level are each converted to PES packets<br>
on the upper second level, and further converted to TS packets<br>
on the upper third level. Likewise, the Presentation graphics<br><br>
stream on the lower first level is converted to PES packets<br>
on the lower second level, and further converted to TS packets<br>
on the lower third level. These TS packets of the video, audio,<br>
and Presentation graphics streams are multiplexed to form<br>
the AV Clip.<br>
FIG. 3 shows an example where only one Presentation<br>
graphics stream is multiplexed in the AV Clip. If the BD-ROM<br>
100 supports multiple languages, however, a Presentation<br>
graphics stream for each of the languages is multiplexed in<br>
the AV Clip. The AV Clip generated in the above manner is<br>
divided into a plurality of extents in the same way as computer<br>
files, and stored on the BD-ROM 100.<br>
The following explains the Presentation graphics stream .<br>
FIG. 4A shows a structure of the Presentation graphics stream.<br>
In the drawing, the first level shows the TS packet string<br>
which constitutes the AV Clip. The second level shows the<br>
PES packet string which constitutes the Presentation graphics<br>
stream. This PES packet string is formed by connecting<br>
payloads of TS packets having a predetermined PID from the<br>
TS packet string on the first level.<br>
The third level shows the structure of the Presentation<br>
graphics stream. The Presentation graphics stream is made<br>
up of functional Segments that include a PCS (Presentation<br>
Composition Segment), a WDS (Window Definition Segment), a<br>
PDS (Palette Definition Segment), an ODS (Object Definition<br>
Segment) , and an END (End of Display Set Segment) . Of these<br>
functional Segments, the PCS is a screen Composition Segment,<br>
whereas the WDS, the PDS, and the ODS are Definition Segments .<br><br>
One functional Segment corresponds to either one PES packet<br>
or a plurality of PES packets . Which is to say, one functional<br>
Segment is converted to one PES packet and recorded on the<br>
BD-ROM 100, or split into fragments which are converted to<br>
PES packets and recorded on the BD-ROM 100.<br>
FIG . 4B shows PES packets containing functional Segments .<br>
As illustrated, each PES packet is made up of a packet header<br>
and a payload. The payload carries a functional Segment, and<br>
the packet header carries a DTS and a PTS associated with<br>
the functional Segment. Hereafter, a DTS and a PTS in a packet<br>
header of a PES packet which contains a functional Segment<br>
are regarded as a DTS and a PTS of that functional Segment.<br>
These various types of functional Segments form a logical<br>
structure such as the one shown in FIG. 5. In the drawing,<br>
the third level shows the functional Segments, the second<br>
level shows DSs (Display Sets), and the first level shows<br>
Epochs.<br>
ADS on the second level is a group of functional Segments,<br>
in the Presentation graphics stream, which are used for<br>
creating one screen of graphics. Dashed lines hk2 show which<br>
DS the functional Segments on the third level belong to. As<br>
can be seen from the drawing, the series of functional Segments<br>
PCS-WDS-PDS-ODS-END composes one DS. The reproduction<br>
apparatus 200 reads these functional Segments which compose<br>
the DS from the BD-ROM 100, to produce one screen of graphics .<br>
An Epoch on the first level refers to one time unit of<br>
continuous memory management on a reproduction time axis of<br>
the AV Clip, and to a group of data allocated to that time<br><br>
unit. Memory mentioned here includes a Graphics Plane for<br>
storing one screen of graphics and an Object Buffer for storing<br>
uncompressed graphics data. Continuous memory management<br>
means that throughout the Epoch neither the Graphics Plane<br>
nor the Object Buffer is flushed and deletion and rendering<br>
of graphics are performed only within a predetermined<br>
rectangular area of the Graphics Plane (to flush means to<br>
clear the entire Graphics Plane or the entire Object Buffer) .<br>
A size and a position of this rectangular area are fixed during<br>
the Epoch. So long as deletion and rendering of graphics are<br>
performed within this fixed rectangular area of the Graphics<br>
Plane, synchronization of video and graphics is guaranteed.<br>
In other words, the Epoch is a time unit, on the reproduction<br>
time axis of the AV Clip, during which synchronization of<br>
video and graphics can be guaranteed. To change the graphics<br>
deletion/rendering area in the Graphics Plane, it is necessary<br>
to define a point of change on the reproduction time axis<br>
and set a new Epoch from the point onward. Synchronization<br>
of video and graphics is not guaranteed in a boundary between<br>
the two Epochs.<br>
In regard to subtitling, the Epoch is a time period,<br>
on the reproduction time axis, during which subtitles appear<br>
within the fixed rectangular area on a screen. FIG. 6 shows<br>
a relationship between subtitle display positions and Epochs .<br>
In the drawing, subtitle display positions are changed<br>
depending on patterns of pictures. In more detail, three<br>
subtitles "Actually", "I lied to you.", and "Sorry." are<br>
positioned at the bottom of the screen, whereas two subtitles<br><br>
"Three years have passed" and "since then." are positioned<br>
at the top of the screen . Thus, the subtitle display positions<br>
are changed from one margin to another on the screen, to enhance<br>
visibility. In such a case, on the reproduction time axis<br>
 of the AV Clip, a time period during which the subtitles are<br>
displayed at the bottom of the screen is Epochl, and a time<br>
period during which the subtitles are displayed at the top<br>
of the screen is Epoch2. These two Epochs each have an<br>
individual subtitle rendering area. In Epochl, the subtitle<br>
rendering area is Windowl that corresponds to the bottommargin<br>
of the screen. In Epoch2, the subtitle rendering area is<br>
Window2 that corresponds to the top margin of the screen.<br>
In each of Epochl and Epoch2, memory management of the Object<br>
Buffer and the Graphics Plane is continuous, so that the<br>
subtitles are displayed seamlessly in the corresponding<br>
margin of the screen. This completes the explanation on an<br>
Epoch.<br>
The following explains a DS.<br>
In FIG. 5, dashed lines hk1 indicate which Epoch DSs<br>
on the second level belong to. As illustrated, a series of<br>
DSs that are an Epoch Start DS, an Acquisition Point DS, and<br>
a Normal Case DS constitutes one Epoch on the first level.<br>
Here, Epoch Start, Acquisition Point, and Normal Case are<br>
types of DSs. Though the Acquisition Point DS precedes the<br>
Normal Case DS in FIG. 5, they may be arranged in reverse<br>
order.<br>
The Epoch Start DS provides a display effect "new<br>
display", and indicates a start of a new Epoch. The Epoch<br><br>
Start DS contains all functional Segments necessary for the<br>
next screen composition. The Epoch Start DS is provided in<br>
a position which is to be a destination of a skip operation,<br>
such as a start of a chapter in a film.<br>
The Acquisition Point DS provides a display effect<br>
"display refresh", and is identical to the preceding Epoch<br>
Start DS. The Acquisition Point DS is not the start of the<br>
Epoch, but contains all functional Segments necessary for<br>
the next screen composition. Therefore, graphics can be<br>
displayed reliably when reproduction is started from the<br>
Acquisition Point DS . Which is to say, the Acquisition Point<br>
DS enables a screen composition to be made from a midpoint<br>
in the Epoch.<br>
The Acquisition Point DS is provided in a position which<br>
can be a destination of a skip operation, such as a position<br>
that may be designated by a time search. The time search is<br>
an operation of locating a reproduction point corresponding<br>
to a time input by a user in minutes/seconds. The time input<br>
is made in a relatively large unit such as ten minutes or<br>
ten seconds. Accordingly, the Acquisition Point DS is<br>
provided in a position that can be designated by a time search<br>
made in units of ten minutes or ten seconds. By providing<br>
the Acquisition Point DS in a position that can be designated<br>
by a time search, the graphics stream can be smoothly reproduced<br>
when a time search is conducted.<br>
The Normal Case DS provides a display effect "display<br>
update", and contains only a difference from the previous<br>
screen composition. For example, if DSv has the same subtitle<br><br>
as immediately preceding DSu but a different screen<br>
composition from DSu, DSv is a Normal Case DS which contains<br>
only a PCS and an END. This makes it unnecessary to provide<br>
overlapping ODSs in DSs, with it being possible to reduce<br>
the amount of data stored on the BD-ROM 100 . Since the Normal<br>
Case DS contains only the difference, graphics cannot be<br>
displayed with the Normal Case DS alone.<br>
The following explains the ODS, the WDS, and the PDS<br>
(Definition Segments).<br>
The ODS is a functional Segment for defining a graphics<br>
Object. AV Clips recorded on BD-ROMs feature an image quality<br>
as high as high-definition television. This being so,<br>
graphics Objects are set at a high resolution of 1920x1080<br>
pixels. This high resolution allows theater screen-style<br>
subtitles, i.e. elegant handwriting-style subtitles, to be<br>
reproduced vividly on BD-ROMs. A graphics Object is made up<br>
of a plurality of pieces of run-length data. Run-length data<br>
expresses a pixel string using a Pixel Code which shows a<br>
pixel value and a continuous length of the pixel value. The<br>
Pixel Code has 8 bits, and shows one of the values from 1<br>
to 255. Through the use of this Pixel Code, the run-length<br>
data sets arbitrary 25 6 pixel colors out of full color<br>
(16,777,216 colors). Note that it is necessary to place a<br>
character string on a background of a transparent color in<br>
order to display a graphics Object as a subtitle.<br>
The ODS defines a graphics Object according to a data<br>
structure shown In FIG. 7A. As shown in the drawing, the ODS<br>
includes a segment_type field showing a Segment type "ODS",<br><br>
a segment_length field showing a data length of the ODS, an<br>
object_id field identifying the graphics Object in the Epoch,<br>
an obj ect_version_number field showing a version of the ODS<br>
in the Epoch, a last_in_sequence_flag field, and an<br>
object_data_fragment field carrying a consecutive sequence<br>
of bytes corresponding to part or all of the graphics Object.<br>
In more detail, the object_id field shows an identifier<br>
which identifies the graphics Object and a storage area in<br>
the Object Buffer that is occupied by the graphics Object,<br>
when the ODS is decoded and the graphics Object is buffered<br>
in the Object Buffer . This being so, when one or more graphics<br>
Objects are present in the Object Buffer, each individual<br>
storage area in the Object Buffer is identified by an object_id<br>
field value . Suppose one ob j ect_id is assigned to two or more<br>
ODSs . In such a case, after a graphics Object corresponding<br>
to one ODS is stored in the Object Buffer, that graphics Object<br>
is overwritten by a graphics Object corresponding to a<br>
succeeding ODS with the same object_id . Such an update intends<br>
to prevent occurrence of many small free spaces in the Object<br>
Buffer and scattering of graphics Objects in the Object Buffer .<br>
When displaying graphics, graphics Objects in the Object<br>
Buffer are constantly transferred to the Graphics Plane . This<br>
being so, if many small free spaces exist in the Object Buffer<br>
or one graphics Object is scattered in the Object Buffer,<br>
overhead for reading graphics Objects causes a reduction in<br>
 efficiency of transfer from the Object Buffer to the Graphics<br>
Plane. S.u.ch...a...reduction in transfer efficiency may affect<br>
synchronous display of graphics and video . To prevent this,<br><br>
an existing graphics Object in the Object Buffer is overwritten<br>
by a new graphics Object having the same object_id.<br>
Here, the new graphics Object overwriting the existing<br>
graphics Object needs to be equal in size to the existing<br>
graphics Object, that is, the new graphics Object can be neither<br>
smaller nor larger than the existing graphics Object. At the<br>
time of authoring, therefore, an author needs to make these<br>
graphics Objects equal in size. This size constraint that<br>
graphics Objects having the same object__id need be equal in<br>
width and height applies only within an Epoch. Graphics<br>
Objects having the same object_id need not be equal in size<br>
if they belong to different Epochs.<br>
The last_in_sequence_flag field and the<br>
object_data_flagment field are explained next. Due to a<br>
constraint of payloads of PES packets, uncompressed graphics<br>
constituting one subtitle may not be able to be contained<br>
in one ODS. In such a case, the graphics is split into a<br>
plurality of fragments and one of such fragments is carried<br>
in the ob j ect_data_f ragment field. When storing one graphics<br>
Object across a plurality of ODSs, every fragment except the<br>
last fragment is of the same size. That is, the last fragment<br>
is less than or equal to the size of the preceding fragments.<br>
The ODSs carrying these fragments of the graphics Ob j ect appear<br>
in the DS in sequence. The last_in_sequence_flag field<br>
indicates an end of the graphics Object. Though the above<br>
ODS data structure is based on a method of storing fragments<br>
in consecutive PES packets without a gap, the fragments may<br>
instead be stored in PES packets so as to leave some gaps<br><br>
in the PES packets.<br>
The PDS is a functional Segment for defining a Palette<br>
used for color conversion. The Palette is data showing<br>
combinations of Pixel Codes of 1 to 255 and pixel values.<br>
A pixel value referred to here is made up of a red color<br>
difference component (Cr value), a blue color difference<br>
component (Cb value), a luminance component (Y value), and<br>
a transparency (T value). Substituting a Pixel Code of each<br>
piece of run-length data into a pixel value on the Palette<br>
produces a color. FIG. 7B shows a data structure of the PDS.<br>
As shown in the drawing, the PDS includes a segment_type field<br>
showing a Segment type "PDS", a segment_length field showing<br>
a data length of the PDS, a palette_id field uniquely<br>
identifying the Palette, a palette_version_number field<br>
 showing a version of the PDS within the Epoch, and a<br>
palette_entry field carrying information for each entry. The<br>
palette_entry field shows a red color difference component<br>
(Cr_value), a blue color difference component (Cb_value),<br>
a luminance component (Y_value), and a transparency (T_value)<br>
for each entry.<br>
The WDS is a functional Segment for defining a<br>
rectangular area on the Graphics Plane. As mentioned earlier,<br>
memory management is continuous within an Epoch during which<br>
clearing and rendering are performed in a fixed rectangular<br>
area on the Graphics Plane. This rectangular area on the<br>
Graphics Plane is called a Window, which is defined by the<br>
WDS. FIG. 8A shows a data structure of the WDS. As shown<br>
in the drawing, the WDS includes a window_id field uniquely<br><br>
identifying the Window on the Graphics Plane, a<br>
window_horizontal_position field specifying a horizontal<br>
position of a top left pixel of the Window on the Graphics<br>
Plane, a window_vertical_position field specifying a vertical<br>
position of the top left pixel of the Window on the Graphics<br>
Plane, a window_width field specifying a width of the Window<br>
on the Graphics Plane, and a window_height field specifying<br>
a height of the Window on the Graphics Plane.<br>
The window_horizontal_position field, the<br>
window_vertical_position field, the window_width field, and<br>
the window_height field can take the following values. The<br>
Graphics Plane serves as a coordinate system for these field<br>
values. This Graphics Plane has a two-dimensional size<br>
defined by video_height and video_width parameters.<br>
The window_horizontal_position field specifies the<br>
horizontal position of the top left pixel of the Window on<br>
the Graphics Plane, and accordingly takes a value in a range<br>
of 0 to (videp_width)~l. The window_vertical_position field<br>
specifies the vertical position of the top left pixel of the<br>
Window on the Graphics Plane, and accordingly takes a value<br>
in a range of 0 to (video_height)-1.<br>
The window_width field specifies the width of the Window<br>
on the Graphics Plane, and accordingly takes a value in a<br>
range of 1 to (video_width)-(window_horizontal_position).<br>
The window_height field specifies the height of the Window<br>
on the Graphics Plane, and accordingly takes a value in a<br>
range of 1 to (video_height) - (window_vertical_position) .<br>
A position and size of a Window can be defined for each<br><br>
Epoch, using these window_horizontal_position,<br>
window_vertical_position, window_width, and window_height<br>
fields in the WDS. This makes it possible for the author to<br>
adjust, at the time of authoring, a Window to appear in a<br>
desired margin of each picture in an Epoch so as not to interfere<br>
with a pattern of the picture. Graphics for subtitles<br>
displayed in this way can be viewed clearly. The WDS can be<br>
defined for each Epoch. Accordingly, when the pattern of the<br>
picture changes with time, graphics can be moved based on<br>
such a change so as not to decrease visibility. This enhances<br>
the quality of the film to the same level as in the case where<br>
subtitles are integrated in a moving picture.<br>
The following explains the END. The END is a functional<br>
Segment indicating that the transmission of the DS is complete .<br>
The END is positioned immediately after the last ODS in the<br>
DS. The END includes a segment_type field showing a Segment<br>
type "END" and a segment_length field showing a data length<br>
of the END. These fields are not main features of the present<br>
invention and therefore their explanation has been omitted.<br>
The following explains the PCS (Composition Segment).<br>
The PCS is a functional Segment for composing a screen<br>
that can be synchronized with a moving picture. FIG. 8B shows<br>
a data structure of the PCS. As shown in the drawing, the<br>
PCS includes a segment_type field, a segment_length field,<br>
a composition_number field, a composition_state field, a<br>
palette_update_flag field, a palette_id_ref field, and<br>
composition_object(l) to composition_object(m) fields.<br>
The composition_number field uniquely identifies a<br><br>
graphics update in the DS, using a number from 0 to 15 . In<br>
more detail, the composition__number field is incremented by<br>
1 for each graphics update from the beginning of the Epoch<br>
to the PCS.<br>
The composition_state field indicates whether the DS<br>
is a Normal Case DS, an Acquisition Point DS, or an Epoch<br>
Start DS.<br>
The palette_update_flag field shows whether the PCS<br>
describes a Palette-only Display Update. The Palette-only<br>
Display Update refers to such an update that only replaces<br>
a previous Palette with a new Palette. To indicate a<br>
Palette-only Display Update, the palette_update_flag field<br>
is set to 1.<br>
The palette_id_ref field specifies the Palette to be<br>
used in the DS.<br>
The composition_object(1) to composition_object(m)<br>
fields each contain control information for realizing a screen<br>
composition in the DS. In FIG. 8B, dashed lines wdl indicate<br>
an internal structure of composition_object (i) as one example.<br>
As illustrated, composition_object(i) includes an<br>
object_id_ref field, a window_id_ref field, an<br>
object_cropped_flag field, an object_horizontal_position<br>
field, an object_vertical_position field, and<br>
cropping_rectangle information(1) to cropping_rectangle<br>
information(n).<br>
The object_id_ref field shows a reference value of an<br>
identifier of a graphics Object (object_id) . This reference<br>
value specifies the graphics Object that is to be used in<br><br>
order to produce a screen composition corresponding to<br>
composition_object(i).<br>
The window_id_ref field shows a reference value of an<br>
identifier of a Window (window_id) . This reference value<br>
specifies the Window in which the graphics Object is to be<br>
displayed in order to produce the screen composition<br>
corresponding to composition_object(i).<br>
The object_cropped_flag field shows whether the<br>
graphics Object cropped in the Object Buffer is to be displayed<br>
or not. When the object_cropped_flag field is set to 1, the<br>
graphics Object cropped in the Object Buffer is displayed.<br>
When the object_cropped_flag field is set to 0, the graphics<br>
Object cropped in the Object Buffer is not displayed.<br>
The object_horizontal_position field specifies a<br>
horizontal position of a top left pixel of the graphics Object<br>
on the Graphics Plane.<br>
The object_vertical_position field specifies a<br>
vertical position of the top left pixel of the graphics Object<br>
on the Graphics Plane.<br>
The cropping_rectangle information(1) to<br>
cropping_rectangle information(n) fields are valid when the<br>
object_cropped_flag field value is 1. Dashed lines wd2<br>
indicate an internal structure of cropping_rectangle<br>
information(i) as one example. As illustrated,<br>
cropping_rectangle information(i) includes an<br>
object_cropping_horizontal_position field, an<br>
object_cropping_vertical_position field, an<br>
object_cropping_width field, and an object_cropping_height<br><br>
field.<br>
The object_cropping_horizontal_position field<br>
specifies a horizontal position of a top left corner of a<br>
cropping rectangle in the graphics Object. The cropping<br><br>
rectangle is used for taking out one part of the graphics<br>
Object, and corresponds to a "region" in ETSI EN 300 743.<br>
The object_cropping_vertical_position field specifies<br>
a vertical position of the top left corner of the cropping<br>
rectangle in the graphics Object.<br>
The object_cropping_width field specifies a horizontal<br>
length of the cropping rectangle in the graphics Object.<br>
The object_cropping_height field specifies a vertical<br>
length of the cropping rectangle in the graphics Object.<br>
The following explains a specific description of the<br>
PCS,'using an example where the three subtitles "Actually",<br>
"I lied to you.", and "Sorry." shown in FIG. 6 are displayed<br>
sequentially by three operations of writing to the Graphics<br>
Plane as the reproduction of the moving picture progresses.<br>
FIG. 9 shows an example description for realizing such<br>
subtitling. In the drawing, an Epoch has DS1 (Epoch Start<br>
DS), DS2 (Normal Case DS), and DS3 (Normal Case DS). DS1<br>
includes a WDS defining a Window in which the subtitles are<br>
to be displayed, an ODS showing the line "Actually I lied<br>
to you. Sorry.", and a PCS . DS2 includes a PCS . DS3 includes<br>
a PCS.<br>
Each of these PCSs has the following description . FIGS .<br>
10 to 12 show example descriptions of the WDS and the PCSs<br>
belonging to DS1 to DS3.<br><br>
FIG. 10 shows descriptions of the PCS and the WDS in<br>
DS1. In the drawing, a window_horizontal_position field<br>
value and a window_vertical_position field value in the WDS<br>
specify top left coordinates LP1 of the Window on the Graphics<br>
Plane, and a window_width field value and a window_height<br>
field value in the WDS specify a width and height of the Window.<br>
An ob j ect_cropping_horizontal_position field value and<br>
an object_cropping_vertical_position field value of<br>
cropping_rectangle information in the PCS specify top left<br>
coordinates ST1 of a cropping rectangle in a coordinate system<br>
whose origin is top left coordinates of the graphics Object<br>
in the Object Buffer. The cropping rectangle is an area<br>
(enclosed by a thick-line box) defined by an<br>
object_cropping_width field value and an<br>
object_cropping_height field value from top left coordinates<br>
STl. A cropped graphics Object is positioned in area cp1<br>
(enclosed by a dashed-line box) so that a top left corner<br>
of the cropped graphics Object lies at a pixel specified by<br>
an object_horizontal_position field value and an<br>
ob j ect_vertical_position field value in the coordinate system<br>
of the Graphics Plane. In this way, the subtitle "Actually"<br>
out of "Actually I lied to you. Sorry." is written into the<br>
Window on the Graphics Plane. The subtitle "Actually" is<br>
overlaid on a picture and a resultant image is displayed.<br>
FIG. 11 shows a description of the PCS in DS2. Since<br>
the description of the WDS in the drawing is the same as that<br>
in FIG. 10, its explanation has been omitted. Meanwhile, the<br>
description of cropping_rectangle information differs from<br><br>
that in FIG. 10. In FIG. 11, an<br>
object_cropping_horizontal_position field value and an<br>
object_cropping_vertical_position field value in<br>
cropping_rectangle information specify top left coordinates<br>
 of a cropping rectangle corresponding to the subtitle "I lied<br>
to you. " in the Object Buffer, and an object_cropping_height<br>
field value and an object_cropping_width field value specify<br>
a height and width of the cropping rectangle. As a result,<br>
the subtitle "I lied to you." is written into the Window on<br>
the Graphics Plane . The subtitle "I lied to you . " is overlaid<br>
on a picture and a resultant image is displayed.<br>
FIG. 12 shows a description of the PCS in DS3 . Since<br>
the description of the WDS in the drawing is the same as that<br>
in FIG. 10, its explanation has been omitted. Meanwhile, the<br>
description of cropping_rectangle information differs from<br>
that in FIG. 10. In FIG. 12, an<br>
object_cropping_horizontal_position field value and an<br>
object_cropping_vertical_position field value specify top<br>
left coordinates of a cropping rectangle corresponding to<br>
 the subtitle "Sorry." in the Object Buffer, and an<br>
object_cropping_height field value and an<br>
object_cropping_width field value specify a height and width<br>
of the cropping rectangle. As a result, the subtitle "Sorry. "<br>
is written into the Window on the Graphics Plane. The subtitle<br>
"Sorry." is overlaid on a picture and a resultant image is<br>
displayed. FIG. 13 shows a memory space of the Object Buffer<br>
when performing graphics updates such as those shown in FIG.<br>
10 to 12. As illustrated, the Object Buffer has four storage<br><br>
areas A to D which each have a fixed height and width and<br>
a fixed position . Of storage areas A to D, the subtitle shown<br>
in FIG. 10 is stored in storage area A. Each of storage areas<br>
A to D is identified by an object_id corresponding to a graphics<br>
 Object to be stored in that storage area. In detail, storage<br>
area A is identified by object_id=l, storage area B is<br>
identified by object_id=2, storage area C is identified by<br>
object_id=3, and storage area D is identified by object_id=4 .<br>
To maintain an efficiency of transfer from the Object Buffer<br><br>
to the Graphics Plane, the height and width of each of storage<br>
areas A to D are fixed. This being so, when a graphics Object<br>
having some object_id is obtained as a result of decoding,<br>
that graphics Object is written in a storage area identified<br>
by the ob j ect_id over an existing graphics Ob j ect. For example,<br>
to display a subtitle in the same position and size as the<br>
subtitles displayed in FIGS. 10 to 12, an ODS having the same<br>
object_id as the ODS in DS1 needs to be provided in a succeeding<br>
DS. By adding the same object_id in such a way, a graphics<br>
Object in the Object Buffer is overwritten by a new graphics<br>
Object, which is displayed in the same position and size as<br>
the overwritten graphics Object.<br>
The following explains constraints for achieving<br>
display effects. To display subtitles smoothly, it is<br>
necessary to perform clearing and rendering on a Window. When<br>
performing Window clearing and Window rendering at a frame<br>
rate of video frames, the following rate of transfer from<br>
the Object Buffer to the Graphics Plane is required.<br>
First, a constraint on the size of the Window is examined.<br><br>
Let Rc be the transfer rate from the Object Buffer to the<br>
Graphics Plane. In a worst-case scenario, the Window clearing<br>
and the Window rendering need to be performed at Rc. In other<br>
words, each of the Window clearing and the Window rendering<br>
needs to be performed at half of Rc (Rc/2).<br>
To synchronize the Window clearing and the Window<br>
rendering with a video frame,<br>
(Window size) x (frame rate)≈Rc/2<br>
needs to be satisfied. If the frame rate is 29.97,<br>
Rc=(Window size)x2x29.97<br>
To display a subtitle, the size of the Window needs to<br>
be at least about 25% to 33% of the entire Graphics Plane.<br>
If a total number of pixels of the Graphics Plane is 1920x1080<br>
and a bit length of an index per pixel is 8 bits, a total<br>
capacity of the Graphics Plane is 2 Mbytes (≈1920x1080x8).<br>
Suppose the size of the Window is 1/4 of the Graphics<br>
Plane, i.e., 500 Kbytes (=2Mbytes/4). Substituting this to<br>
the above formula yields Rc=256Mbps (500Kbytesx2x29.97) .<br>
Thus, if the size of the Window is about 25% to 33% of<br>
the Graphics Plane, display effects of subtitles can be<br>
achieved without losing synchronization with a moving picture,<br>
so long as the subtitles are displayed with Rc=256Mbps.<br>
If the Window clearing and the Window rendering may be<br>
performed at 1/2 or 1/4 of the video frame rate, the size<br><br>
of the Window can be doubled or quadrupled with the same Rc.<br>
The following explains a position and range of a Window. As<br>
mentioned earlier, a position and range of a Window are fixed<br>
within an Epoch, for the following reason.<br>
 If the position or range of the Window varies in the<br>
Epoch, a write address to the Graphics Plane needs to be changed.<br>
This incurs overhead, which causes a drop in transfer rate<br>
Rc from the Object Buffer to the Graphics Plane.<br>
A number of graphics Objects that can be displayed<br>
simultaneously in one Window is limited, in order to reduce<br>
overhead when transferring decoded graphics Objects to the<br>
Graphics Plane. The overhead mentioned here occurs when<br>
setting addresses of edge parts of the graphics Objects . This<br>
overhead increases if the number of edge parts is greater.<br>
 If there is no limitation on the number of graphics<br>
Objects that can be displayed in one Window, the overhead<br>
occurs unlimitedly when transferring graphics objects to the<br>
Graphics Plane, which increases a variation in transfer load.<br>
On the other hand, if the number of graphics Objects in one<br>
Window is limited to 2, transfer rate Rc can be set on an<br>
assumption that the number of instances of overhead is 4 at<br>
the worst. Hence a minimum standard for transfer rate Rc can<br>
be determined easily. This completes the explanation on a<br>
Window.<br>
The following explains how DSs carrying functional<br>
Segments such as PCSs and ODSs described above are allocated<br>
on the reproduction time axis of the AV Clip. An Epoch is<br>
a time period on the reproduction time axis during which memory<br><br>
management is continuous, and is made up of one or more DSs .<br>
Hence it is important to effectively allocate DSs on the<br>
reproduction time axis of the AV Clip. The reproduction time<br>
axis of the AV Clip mentioned here is a time axis for defining<br>
 decoding times and presentation times of individual pictures<br>
which constitute the video stream multiplexed in the AV Clip.<br>
Decoding times and presentation times on the reproduction<br>
time axis are expressed with a time accuracy of 90KHz. DTSs<br>
and PTSs of PCSs and ODSs in DSs specify timings for synchronous<br>
control on this reproduction time axis. In other words, the<br>
DSs are allocated on the reproduction time axis by exercising<br>
synchronous control using the DTSs and PTSs of the PCSs and<br>
ODSs.<br>
Synchronous control exercised using a DTS and a PTS of<br>
 an ODS is explained first.<br>
The DTS shows a time at which a decoding process of the<br>
ODS is to be started, with an accuracy of 90KHz . The PTS shows<br>
a time at which the decoding process of the ODS is to be completed,<br>
with an accuracy of 90KHz.<br>
The decoding process is made up of decoding the ODS and<br>
transferring an uncompressed graphics Object generated by<br>
the decoding to the Object Buffer. This decoding process does<br>
not complete instantaneously, but requires a certain length<br>
of time. The DTS and the PTS of the ODS respectively show<br>
the decoding start time and the decoding end time of the ODS,<br>
to specify the beginning and end of the decoding process.<br>
Since the time shown by the PTS is a deadline, it is<br>
necessary to decode the ODS and store an uncompressed graphics<br><br>
Object in the Object Buffer by the time shown by the PTS.<br>
A decoding start time of arbitrary ODSj in DSn is<br>
specified by DTS (DSn [ODSj ] ) with an accuracy of 90KHz. This<br>
being so, a decoding end time of ODSj in DSn (i.e.<br>
 PTS (DSn [ODSj] ) is a sum of DTS (DSn [ODSj ] ) and a maximum time<br>
required for a decoding process.<br>
Let SIZE (DSn [ODSj] ) denote a size of ODSj , and Rd denote<br>
an ODS decoding rate. Then the maximum time required for the<br>
decoding process (in seconds) is SIZE(DSn[ODSj])//Rd. The<br>
symbol "//" represents an operator for a division with a<br>
fractional part being rounded up.<br>
By converting this maximum time to the accuracy of 9 0KHz<br>
and adding the result to the DTS of ODSj , the decoding end<br>
time of ODSj specified by the PTS is calculated with the<br>
accuracy of 90KHz.<br>
This PTS of ODSj in DSn can be expressed by the following<br>
formula:<br>
PTS(DSn[ODSj])=DTS(DSn[ODSj])+90, 000<br>
x(SIZE(DSn[ODSj])//Rd)<br>
Also, two adjacent ODSs (ODSj and ODSj+1) in DSn need<br>
to satisfy the following relationship:<br>
PTS(DSn[ODSj])<dts></dts>
An END in DSn indicates an end of DSn. Therefore, the<br>
END shows a decoding end time of a last ODS (ODSlast) in DSn.<br><br>
The decoding end time of ODSlast is shown by a PTS of ODSlast<br>
(PTS(DSn[ODSlast] ) ) , so that a PTS of the END is set as follows:<br>
PTS(DSn[END])=PTS(DSn[ODSlast])<br>
Meanwhile, a DTS and a PTS of a PCS in DSn are set in<br>
the following manner.<br>
The DTS of the PCS shows either a decoding start time<br>
of a top ODS (0DS1) in DSn or a time earlier than that. This<br>
is because the PCS needs to be loaded in a buffer of the<br>
reproduction apparatus 200 at the same time as or earlier<br>
than the decoding start time of ODS1 (DTS(DSn[ODS1] ) ) and<br>
a time at which a top PDS (PDS1) in DSn becomes valid<br>
(PTS(DSn[PDSl] ) ) . Which is to say, the DTS of the PCS needs<br>
to satisfy the following formulas:<br>
DTS(DSn[PCS])<dts></dts>
DTS(DSn[PCS])<pts></pts>
On the other hand, the PTS of the PCS is calculated as<br>
follows:<br>
PTS(DSn[PCS])&gt;DTS(DSn[PCS])<br>
+DECODEDURATION(DSn)<br>
Here, DECODEDURATION(DSn) indicates a time required for<br>
decoding and presenting all graphics Objects used for updates<br>
described in the PCS in DSn. Though DECODEDURATION(DSn) is<br><br>
not a fixed value, it will not be affected by factors such<br>
as differences in state or implementation of reproduction<br>
apparatuses. When a graphics Object used for a screen<br>
composition described by the PCS in DSn is denoted by<br>
 DSn.PCS.OBJ[j], DECODEDURATION(DSn) is varied by (i) a time<br>
required for Window clearing, (ii) a time required for decoding<br>
DSn.PCS.OBJ[j], and (iii) a time required for writing<br>
DSn.PCS.OBJ[j] on the Graphics Plane. Accordingly,<br>
DECODEDURATION (DSn) is the same regardless of implementations<br>
of reproduction apparatuses, so long as Rd and Rc are<br>
predetermined. Therefore, the length of each of the above<br>
time periods is calculated to specify the PTS of the PCS,<br>
at the time of authoring.<br>
The calculation of DECODEDURATION(DSn) is carried out<br>
based on a program shown in FIG. 14. FIG. 15 and FIGS. 16A<br>
and 16B are flowcharts showing an algorithm of this program.<br>
A procedure of calculating DECODEDURATION (DSn) is explained<br>
below, with reference to these drawings. In FIG. 15, a<br>
PLANEINITIALIZATIONTIME function is called, and a return<br>
value is added to decode_duration (S1) . The<br>
PLANEINITIALIZATIONTIME function (FIG. 16A) is a function<br>
for calculating a time required for initializing the Graphics<br>
Plane in order to produce display for DSn. In step S1, this<br>
PLANEINITIALIZATIONTIME function is called using DSn,<br>
DSn.PCS.OBJ[0], and decode_duration as arguments.<br>
FIG. 16A shows a procedure of the<br>
PLANEINITIALIZATIONTIME function. In the drawing,<br>
initialize_duration is a variable indicating a return value<br><br>
of the PLANEINITIALIZATIONTIME function.<br>
Step S2 judges whether a composition_state field of the<br>
PCS in DSn shows Epoch Start. If the composition_state field<br>
shows Epoch Start (S2:YES,<br>
 DSn.PCS.composition_state==EPOCH_START in FIG. 14 ) , a time<br>
required for clearing the Graphics Plane is set as<br>
initialize_duration (S3).<br>
Suppose transfer rate Rc from the Object Buffer to the<br>
Graphics Plane is 256, 000, 000 and a total size of the Graphics<br>
 Plane is (video_width)*(video_height), as mentioned above.<br>
Then the time required for clearing the Graphics Plane (in<br>
seconds) is (video_width)*(video_height)//256,000,000.<br>
This is multiplied by 90, 000Hz , to express in the PTS accuracy .<br>
Hence the time required for clearing the Graphics Plane is<br>
90,000x(video_width)*(video_height)//256,000,000. This<br>
is added to initialize_duration, which is returned as a return<br>
value.<br>
If the composition_state field does not show Epoch Start<br>
(S2:NO), an operation of adding a time required for clearing<br>
Window[i] to initialize_duration is carried out for all<br>
Windowsfi] (S4). Suppose transfer rate Rc from the Object<br>
Buffer to the Graphics Plane is 256,000,000 as mentioned<br>
earlier, and a total size of Windows [i] is ∑SIZE(WDS.WIN[i]).<br>
Then a time required for clearing all Windows [i] (in seconds)<br>
is ∑SIZE(WDS.WIN[i])//256,000,000. This is multiplied by<br>
90,000Hz to express in the PTS accuracy. Hence the time<br>
required for clearing all Windows[i] is<br>
90, 000x∑SIZE(WDS.WIN[i])//256,000,000. This is added to<br><br>
initialize_duration, which is returned as a return value.<br>
This completes the PLANEINITIALIZATIONTIME function.<br>
Referring back to FIG . 15, step S5 judges whether a number<br>
of graphics Objects in DSn is 1 or 2<br>
 (if(DSn.PCS.num_of_objects==2,<br>
if(DSn.PCS.num_of_objects==1 in FIG. 14). If the number of<br>
graphics Objects in DSn is 1 (S5:=1), a wait time for decoding<br>
that graphics Object to complete is added to decode_duration<br>
(S6) . The wait time is calculated by calling a WAIT function<br>
(decode_duration+=WAIT(DSn, DSn.PCS.OBJ[0],<br>
decode_duration) in FIG. 14). The WAIT function is called<br>
using DSn, DSn . PCS . OBJ [ 0 ] , and decode_duration as arguments,<br>
and wait_duration showing the wait time is returned as a return<br>
value.<br>
FIG. 16B shows a procedure of the WAIT function.<br>
In the WAIT function, current_duration is a variable<br>
to which decode_duration is set, and<br>
object_definition_ready_time is a variable indicating a PTS<br>
of graphics Object OBJ[i] in DSn.<br>
Also, current_time is a variable indicating a sum of<br>
current_duration and a DTS of the PCS in DSn. If<br>
object_definition_ready_time is greater than current_time<br>
(S7.-YES, if (current_time<object_def inition_ready_time in></object_def>
FIG. 14) , a difference between object_definition_ready_time<br>
and current_time is set to wait_duration, which is returned<br>
as a return value (S8, wait_duration +=<br>
object_definition_ready_time - current_time in FIG. 14).<br>
This completes the WAIT function.<br><br>
Referring back to FIG. 15, a sum of the return value<br>
of the WAIT function and a time required for rendering on<br>
a Window to which OBJ[0] belongs<br>
(90,000*(SIZE(DSn.WDS.WIN[0]))//256,000,000) is set to<br>
decode_duration (S9).<br>
The above procedure relates to the case when the number<br>
of graphics Objects in DSn is 1. If the number of graphics<br>
Objects is 2 (S5:=2, if(DSn.PCS.num_of_objects==2) in FIG.<br>
14), the WAIT function is called using DSn, DSn.PCS.OBJ[0] ,<br>
and decode_duration as arguments, and a return value of the<br>
WAIT function is added to decode_duration (S10).<br>
Step S11 judges whether the Window to which OBJ[0]<br>
belongs is the same as a Window to which OBJ[l] belongs<br>
(if(DSn.PCS.OBJ[0].window_id == DSn.PCS.OBJ[1].window_id)<br>
 in FIG. 14). If the judgement is in the affirmative (S11: YES) ,<br>
the WAIT function is called using DSn, DSn.PCS.OBJ[1], and<br>
decode_duration as arguments, and a return value of the WAIT<br>
function is added to decode_duration (S12). Furthermore, a<br>
time required for rendering on the Window to which OBJ[0]<br>
and OBJ[l] belong<br>
(90,000*(SIZE(DSn.WDS.OBJ[0] . window_id)//256,000 , 000) is<br>
added to decode_duration (S13).<br>
If the judgement is in the negative (S11:NO), on the<br>
other hand, the time required for rendering on the Window<br>
to which OBJ[0] belongs<br>
(90,000*(SIZE(DSn.WDS.OBJ[0] .window_id)//256,000,000) is<br>
added to decode_duration (S15) . After this, the WAIT function<br>
is called using DSn, DSn.PCS.OBJ[1], and decode_duration as<br><br>
arguments, and a return value of the WAIT function is added<br>
to decode_duration (S16). Furthermore, a time required for<br>
rendering on the Window to which 0BJ[1] belongs<br>
(90,000*(SIZE(DSn.WDS.OBJ[l] .window_id)//256,000 , 000) is<br>
 added to decode_duration (S17). In this way,<br>
DECODEDURATION(DSn) is calculated.<br>
The following explains how a PTS of a PCS in one DS is<br>
set, using specific examples.<br>
FIG. 17A shows a situation where one OBJ (OBJ1)<br>
corresponding to one ODS (ODS1) belongs to one Window. FIGS.<br>
17B and 17C are timing charts showing a relationship between<br>
parameters used in FIG. 14. Each of these timing charts has<br>
three levels. Of the three levels, the "Graphics Plane access"<br>
level and the "ODS decode" level indicate two processes which<br>
are performed in parallel when reproducing the ODS . The above<br>
algorithm is based on an assumption that these two processes<br>
are performed in parallel.<br>
Graphics Plane access is made up of clear period (1)<br>
and write period (3). Clear period (1) indicates either a<br>
time required for clearing the entire Graphics Plane<br>
(90,000*((size of the Graphics Plane)//256,000,000)) or a<br>
time required for clearing all Windows on the Graphics Plane<br>
(2(90,000x((size of Window[i])//256,000,000)) ) .<br>
Write period ( 3 ) indicates a time required for rendering<br>
on the entire Window (90,000x((size of the<br>
Window)//256,000,000)).<br>
ODS decode is made up of decode period (2) . Decode period<br>
(2) indicates a time period from a DTS to a PTS of ODS1.<br><br>
Clear period (1), decode period (2), and write period<br>
(3) can vary depending on the range to be cleared, the size<br>
of an ODS to be decoded, and the size of a graphics Object<br>
to be written to the Graphics Plane . In FIG. 17, the beginning<br>
 of decode period ( 2) is assumed to be the same as the beginning<br>
of clear period (1), for simplicity's sake.<br>
FIG. 17B shows a case where decode period (2) is longer<br>
than clear period (1). In this case, decode_duration is a<br>
sum of decode period (2) and write period (3).<br>
FIG. 17C shows a case where clear period (1) is longer<br>
than decode period (2). In this case, decpde_duration is a<br>
sum of clear period (1) and write period (3).<br>
FIGS. 18A to 18C show a situation where two OBJs (0BJ1<br>
and 0BJ2) corresponding to two ODSs (0DS1 and 0DS2) belong<br>
to one Window. In FIGS. 18B and 18C, decode period (2)<br>
indicates a total time required for decoding 0DS1 and 0DS2 .<br>
Likewise, write period (3) indicates a total time required<br>
for writing 0BJ1 and 0BJ2 to the Graphics Plane. Though the<br>
number of ODSs is two, decode_duration can be calculated in<br>
the same way as in FIG. 17. In detail, if decode period (2)<br>
of 0DS1 and 0DS2 is longer than clear period (1),<br>
decode_duration is a sum of decode period (2) and write period<br>
(3) as shown in FIG. 18B.<br>
If clear period (1) is longer than decode period (2),<br>
decode_duration is a sum of clear period (1) and write period<br>
(3) as shown in FIG. 18C.<br>
FIGS. 19A to 19C show a situation where OBJ1 belongs<br>
to Windowl and 0BJ2 belongs to Window2. In this case too,<br><br>
if clear period (1) is longer than decode period (2) of 0DS1<br>
and 0DS2, decode_duration is a sum of clear period (1) and<br>
write period (3). If clear period (1) is shorter than decode<br>
period (2), on the other hand, 0BJ1 can be written to Windowl<br>
without waiting for the end of decode period (2). In such<br>
a case, decode_duration is not simply a sum of decode period<br>
(2) and write period (3) . Let write period (31) denote a time<br>
required for writing OBJ1 to Windowl and write period (32)<br>
denote a time required for writing 0BJ2 to Window2 . FIG . 19B<br>
shows a case where decode period (2) is longer than a sum<br>
of clear period (1) and write period (31). In this case,<br>
decode_duration is a sum of decode period (2) and write period<br>
(32).<br>
FIG. 19C shows a case where a sum of clear period (1)<br>
and write period (31) is longer than decode period (2). In<br>
this case, decode_duration is a sum of clear period (1) , write<br>
period (31), and write period (32).<br>
The size of the Graphics Plane is fixed according to<br>
a player model. Also, sizes and numbers of Windows and ODSs<br>
are set in advance at the time of authoring. Hence<br>
decode_duration can be calculated as one of the sum of clear<br>
period (1) and write period (3), the sum of decode period<br>
(2) and write period (3), the sum of decode period (2) and<br>
write period (32), and the sum of clear period (1), write<br>
period (31), and write period (32). By setting the PTS of<br>
the PCS based on such calculated decode_duration, graphics<br>
can be synchronized with picture data with high accuracy.<br>
Such accurate synchronous control is achieved by defining<br><br>
Windows and restricting clearing and rendering operations<br>
within the Windows. Thus, the introduction of the concept<br>
"Window" in authoring is of great significance.<br>
The following explains how a DTS and a PTS of the WDS<br>
 in DSn are set. The DTS of the WDS is set so as to satisfy<br>
the following formula:<br>
DTS(DSn[WDS])≥DTS(DSn[PCS])<br>
The PTS of the WDS specifies a deadline for starting<br>
writing to the Graphics Plane. Since writing to the Graphics<br>
Plane is restricted to a Window, the time to start writing<br>
to the Graphics Plane can be determined by subtracting a time<br>
required for rendering on all Windows from the time shown<br>
by the PTS of the PCS . Let ∑SIZE(WDS . WIN [ i ] ) be a total size<br>
ofWindows[i] . Then a time required for clearing and rendering<br>
on all Windows[i] is ∑SIZE(WDS.WIN[i])//256,000,000.<br>
Expressing this time with the accuracy of 90,000KHz yields<br>
90,000x∑siZE(WDS.WIN[i])//25 6,000,000.<br>
Accordingly, the PTS of the WDS can be calculated as<br>
follows:<br>
PTS(DSn[WDS])=PTS(DSn[PCS])-<br>
90,000x∑SIZE(WDS.WIN[i])//256,000,000<br>
Since the PTS of the WDS shows the deadline, the writing<br>
to the Graphics Plane can be launched earlier than the time<br>
shown by this PTS. Which is to say, once decoding of one ODS<br><br>
belonging to one of two Windows has completed, a graphics<br>
Object obtained by the decoding can be immediately written<br>
to the Window as shown in FIG. 19.<br>
Thus, a Window can be allocated to a desired point on<br>
the reproduction time axis of the AV Clip, using the DTS and<br>
the PTS of the WDS. This completes the explanation on the<br>
DTS and PTS of each of the PCS and the WDS in DSn.<br>
The following explains a forward reference by a PCS.<br>
A forward reference is a type of reproduction control that<br>
references a graphics Object which has already been stored<br>
in the reproduction apparatus 200. FIG. 20 shows forward<br>
reference PCSs . The drawing shows three DSs, i.e. DSn, DSn+1,<br>
and DSn+2 . PCSs of DSn+1 and DSn+2 are forward reference PCSs .<br>
Arrows yy1 and yy2 indicate forward references made by these<br>
PCSs. Graphics Objects defined in ODS#1 to ODS#v in DSn are<br>
forward-referenced by these PCSs. Here, DSn contains a<br>
plurality of graphics Objects, i.e. ODS#1 to ODS#u and ODS#u+l<br>
to ODS#v. Of these graphics Objects, ODS#1 to ODS#u are<br>
referenced by a PCS of DSn, but ODS#u+l to ODS#v are not<br>
referenced by the PCS of DSn. These graphics Objects not<br>
referenced by the PCS of DSn are forward-referenced by the<br>
PCSs of DSn+1 and DSn+2.<br>
Such a graphics Object forward-referenced by a PCS in<br>
one DS has already been stored in the reproduction apparatus<br>
200, so that there is no need to wait for decoding of an ODS.<br>
This being so, by feeding only a PCS into the reproduction<br>
apparatus 200 , display control based on that PCS can be carried<br>
out. Since the display control is carried out promptly when<br><br>
the PCS is fed into the reproduction apparatus 200, a graphics<br>
update of replacing existing graphics with new graphics can<br>
be performed with a short time interval. Repeating such a<br>
short-interval graphics update makes it possible to realize<br>
 display control of moving graphics smoothly as the<br>
reproduction of the moving picture progresses. Two<br>
description examples of forward reference PCSs are given<br>
below.<br>
A description example of forward reference PCSs for<br><br>
realizing a display effect of moving graphics on a screen<br>
is explained first. FIG. 21A shows an Epoch having such a<br>
display effect. This Epoch is made up of nine DSs (DSO to<br>
DS8) . DSO, the first DS of the Epoch, includes a PCS, a PDS,<br>
and an ODS. The ODS in DSO defines a subtitle "My heart is<br>
fluttering" shown in FIG. 22A, and has object_id=1. Meanwhile,<br>
DS1 to DS8 which follow DSO each include only a PCS.<br>
FIG. 21B shows the composition_object fields and PTSs<br>
of the PCSs in DS1 to DS8. As illustrated, the PCSs in DS1<br>
to DS8 designate the graphics Object specified by<br>
object_id_ref=1 to be displayed at respective coordinates<br>
(x1,y1), (x2,y2), (x3,y3), ... , (x8,y8) specified by the<br>
object_horizontal_position and object_vertical_position<br>
fields. FIG. 22B shows positions of coordinates (xl,yl),<br>
(x2,y2), (x3,y3), ... , (x8,y8) in a coordinate system defined<br>
by a Window. As can be understood from the drawing,<br>
coordinates (x1,y1), (x2,y2), (x3,y3), .„ , (x8,y8) lie on<br>
a wavy line. Coordinates (x1,y1), (x2,y2), (x3,y3), ... ,<br>
(x8,y8) are set so that the graphics Object stays within the<br><br>
Window defined by the WDS . This is because the synchronization<br>
between the graphics display of the graphics stream and the<br>
video display of the video stream cannot be established if<br>
the graphics Object is not contained within the Window.<br>
	In FIG. 21B, the PTSs of the PCSs in DS1 to DS8 designate<br>
times t1, t2, t3, ... , t8, on the reproduction time axis of<br>
the video stream, at which the graphics Object is to be<br>
displayed at respective coordinates (x1, y1) , (x2,y2), (x3,y3),<br>
... , (x8,y8).<br>
FIG. 23 shows a display effect when DSO to DS8 having<br>
the above PCSs are sequentially fed into the reproduction<br>
apparatus 200. At t1 on the reproduction time axis of the<br>
video stream, DS1 is fed into the reproduction apparatus 200,<br>
and as a result the graphics is displayed at coordinates (x1, y1)<br>
within the Window. At t4 , DS4 is fed into the reproduction<br>
apparatus 200, and as a result the graphics is displayed at<br>
coordinates (x4,y4) . At t6, DS6 is fed into the reproduction<br>
apparatus 200, and as a result the graphics is displayed at<br>
coordinates (x6,y6) . At t8, DS8 is fed into the reproduction<br>
apparatus 200, and as a result the graphics is displayed at<br>
coordinates (x8,y8). Since these coordinates (x1,y1),<br>
(x4,y4), (x6,y6), and (x8,y8) lie on a wavy line, the graphics<br>
will end up tracing the wavy line as shown in FIG. 24.<br>
Thus, when such DSs including PCSs which each have<br>
specified object_horizontal_position and<br>
object_vertical_position field values are sequentially fed<br>
into the reproduction apparatus 200, the reproduction<br>
apparatus 200 displays the graphics Object already stored<br><br>
in the Object Buffer in accordance with these PCSs. Since<br>
the position of the graphics can be changed just by feeding<br>
the control information into the reproduction apparatus 200,<br>
quick movements of graphics on the screen can be achieved.<br>
When feeding such DSs into the reproduction apparatus<br>
200 , a new PCS may be written over an existing PCS . This allows<br>
the reproduction apparatus 200 to hold only a newest PCS,<br>
even if there are tens or hundreds of PCSs showing display<br>
coordinates of graphics for smooth movement. In this way,<br>
the memory occupancy in the reproduction apparatus 200 can<br>
be minimized.<br>
A Palette-only Display Update is explained next, as<br>
another description example of forward reference PCSs. FIG.<br>
25 shows a series of DSs for realizing a Palette-only Display<br>
Update. In the drawing, the first level shows the series of<br>
DSs (DS0, DS1, DS2, and DS3) for the Palette-only Display<br>
Update . DS0 has a PCS , four PDSs ( PDS0 , PDS1, PDS2 , and PDS3 ) ,<br>
and an ODS. DS2, DS3, and DS4 that follow DS0 each have only<br>
a PCS.<br>
The ODS in DS0 defines a subtitle "I will never forget" ,<br>
as indicatedby guidelines hv1. The words" I", "will", "never",<br>
and "forget" are each constituted by a plurality of pieces<br>
of run-length data (indicated by rectangles shown in FIG.<br>
25). Run-length data constituting "I" has Pixel Code 0.<br>
Run-length data constituting "will" has Pixel Code 1.<br>
Run-length data constituting "never" has Pixel Code 2.<br>
Run-length data constituting "forget" has Pixel Code 3.<br>
FIG. 26A shows the four PDSs in DS0. .<br><br>
PDSO which is the first PDS in DSO (on the first level)<br>
has palette_id=0, and assigns a red color to Pixel Code 0<br>
and a white color to Pixel" Codes 1 to 3.<br>
PDS1 which is the second PDS in DSO (on the second level)<br>
 has palette_id=1, and assigns the red color to Pixel Codes<br>
0 and 1 and the white color to Pixel Codes 2 and 3.<br>
PDS2 which is the third PDS in DSO (on the third level)<br>
has palette_id=2, and assigns the red color to Pixel Codes<br>
0, 1, and 2 and the white color to Pixel Code 3.<br>
PDS3 which is the fourth PDS in DSO (on the fourth level)<br>
has palette_id=3, and assigns the red color to Pixel Codes<br>
0 to 3 .<br>
FIG. 26B show descriptions of the PCSs in DSO to DS3 .<br>
The PCS in DSO (on the first level) designates display-<br>
control to be performed using a graphics Object specified<br>
by object_id_ref=1. This PCS has palette_update_flag=0 and<br>
palette_id_ref=0. Accordingly, when DSO is fed into the<br>
reproduction apparatus 200, the graphics Object shown by the<br>
ODS in DSO is displayed using the PDS specif ied by palette_id=0 .<br>
The PCS in DS1 (on the second level) designates display<br>
control to be performed using the graphics Object specified<br>
by object_id_ref=1. This PCS has palette_update_f lag=1 and<br>
palette_id_ref=1. Accordingly, when DS1 is fed into the<br>
reproduction apparatus 200, the display of the graphics Ob j ect<br>
is updated using the PDS specified by palette_id=1.<br>
The PCS in DS2 (on the third level) designates display<br>
control to be performed using the graphics Object specified<br>
by object_id_ref=1. This PCS has palette_update_f lag=1 and<br><br>
palette_id_ref = 2. Accordingly, when DS2 is fed into the<br>
reproduction apparatus 200 , the display of the graphics Object<br>
is updated using the PDS specified by palette_id=2.<br>
The PCS in DS3 (on the fourth level) designates display<br>
 control to be performed using the graphics Object specified<br>
by object_id_ref=1. This PCS has palette_update_flag=1 and<br>
palette_id_ref = 3. Accordingly, when DS3 is fed into the<br>
reproduction apparatus 200 , the display of the graphics Object<br>
is updated using the PDS specif ied by palette_id=3 . By setting<br>
the PCSs in DSO to DS3 in this way, it is possible to repeatedly<br>
update the graphics Object belonging to DSO using different<br>
palette data.<br>
FIG. 27 shows a display effect achieved when these four<br>
DSs are sequentially fed into the reproduction apparatus 200 .<br>
When DSO is fed into the reproduction apparatus 200, the<br>
subtitle "I will never forget" is displayed with the word<br>
"I" being colored in red. WhenDS1 is fed into the reproduction<br>
apparatus 200, the word "will" turns red. When DS2 is fed<br>
into the reproduction apparatus 200, the word "never" turns<br>
red. When DS3 is fed into the reproduction apparatus 200,<br>
the word "forget" turns red, as a result of which the entire<br>
subtitle "I will never forget" is displayed in red. Thus,<br>
the words constituting the subtitle "I will never forget"<br>
change from white to red one by one beginning with the leftmost<br>
word, as the DSs are sequentially fed from the BD-ROM 100<br>
to the reproduction apparatus 200. This produces a display<br>
effect of changing a subtitle in color as the reproduction<br>
of the audio stream progresses.<br><br>
Note that the data structures of DSs (PCS, WDS, PDS,<br>
and ODS) explained above are instances of class structures<br>
written in a programming language . The author writes the class<br>
structures according to the syntax defined in the Blu-ray<br>
 Disc Read-Only Format, to create these data structures on<br>
the BD-ROM 100. This completes the explanation on the<br>
recording medium according to the first embodiment of the<br>
present invention. The following explains a reproduction<br>
apparatus according to the first embodiment of the present<br>
invention. FIG. 28 shows an internal construction of the<br>
reproduction apparatus 200. The reproduction apparatus 200<br>
is manufactured based on this internal construction. The<br>
reproduction apparatus 200 is roughly made up of three parts<br>
that are a system LSI, a drive device, and a microcomputer<br>
system. The reproduction apparatus 200 can be manufactured<br>
by mounting these parts on a cabinet and substrate of the<br>
apparatus . The system LSI is an integrated circuit including<br>
various processing units for achieving the functions of the<br>
reproduction apparatus 200. The reproduction apparatus 200<br>
includes a BD drive 1, a Read Buffer 2, a PID filter 3, Transport<br>
Buffers 4a, 4b, and 4c, a peripheral circuit 4d, a Video Decoder<br>
5, a Video Plane 6, an Audio Decoder 7, a Graphics Plane 8,<br>
a CLUT unit 9, an adder 10, and a Graphics Decoder 12. The<br>
Graphics Decoder 12 includes a Coded Data Buffer 13, a<br>
peripheral circuit 13a, a Stream Graphics Processor 14, an<br>
Object Buffer 15, a Composition Buffer 16, and a Graphics<br>
Controller 17.<br>
The BD drive 1 performs loading, reading, and ejecting<br><br>
of the BD-ROM 100 . The BD drive 1 accesses to the BD-ROM 100 .<br>
The Read Buffer 2 is a FIFO (first-in first-out) memory.<br>
Accordingly, TS packets read from the BD-ROM 100 are removed<br>
from the Read Buffer 2 in the same order as they arrive.<br>
 The PID filter 3 performs filtering on TS packets output<br>
from the Read Buffer 2 . In more detail, the PID filter 3 passes<br>
only TS packets having predetermined PIDs to the Transport<br>
Buffers 4a, 4b, and 4c. There is no buffering inside the PID<br>
filter 3. Accordingly, TS packets entering the PID filter<br>
3 are instantaneously written to the Transport Buffers 4a,<br>
4b, and 4c.<br>
The Transport Buffers 4a, 4b, and 4c are FIFO memories<br>
for storing TS packets output from the PID filter 3 . A speed<br>
at which a TS packet is read from the Transport Buffer 4a<br>
is denoted by transfer rate Rx.<br>
The peripheral circuit 4d has a wired logic for<br>
converting TS packets read from the Transport Buffer 4a to<br>
functional Segments . The functional Segments are then stored<br>
in the Coded Data Buffer 13.<br>
The Video Decoder 5 decodes TS packets output from the<br>
PID filter 3 to obtain uncompressed pictures, and writes them<br>
to the Video Plane 6.<br>
The Video Plane 6 is a plane memory for a moving picture.<br>
The Audio Decoder 7 decodes TS packets output from the<br>
PID filter 3, and outputs uncompressed audio data.<br>
The Graphics Plane 8 is a plane memory having a memory<br>
area of one screen, and is capable of storing uncompressed<br>
graphics of one screen.<br><br>
The CLUT unit 9 converts index colors of the uncompressed<br>
graphics on the Graphics Plane 8 , based on Y, Cr, and Cb values<br>
shown in a PDS.<br>
The adder 10 multiplies the uncompressed graphics<br>
converted by the CLUT unit 9, by a T value (transparency)<br>
shown in the PDS. The adder 10 then performs addition for<br>
corresponding pixels in the resulting uncompressed graphics<br>
and the uncompressed picture data on the Video Plane 6 , and<br>
outputs a resultant image.<br>
The Graphics Decoder 12 decodes a graphics stream to<br>
obtain uncompressed graphics, and writes the uncompressed<br>
graphics to the Graphics Plane 8 as graphics Objects. As a<br>
result of decoding the graphics stream, subtitles and menus<br>
appear on the screen.<br>
This Graphics Decoder 12 executes pipeline processing,<br>
by reading a graphics Object belonging to DSn from the Object<br>
Buffer 15 whilst simultaneously writing a graphics Object<br>
belonging to DSn+1 to the Object Buffer 15.<br>
The Graphics Decoder 12 includes the Coded Data Buffer<br>
13,	the peripheral circuit 13a, the Stream Graphics Processor<br>
14,	the Object Buffer 15, the Composition Buffer 16, and the<br>
Graphics Controller 17 .<br>
The Coded Data Buffer 13 is used for storing functional<br>
Segments together with DTSs and PTSs. Such functional<br>
Segments are obtained by removing a TS packet header and a<br>
PES packet header from each TS packet stored in the Transport<br>
Buffer 4a and arranging remaining payloads in sequence. DTSs<br>
and PTSs contained in the removed TS packet headers and PES<br><br>
packet headers are stored in the Coded Data Buffer 13 in<br>
correspondence with the functional Segments.<br>
The peripheral circuit 13a has a wired logic for<br>
transferring data from the Coded Data Buffer 13 to the Stream<br>
Graphics Processor 14 and transferring data from the Coded<br>
Data Buffer 13 to the Composition Buffer 16 . In more detail,<br>
when the current time reaches a DTS of an ODS, the peripheral<br>
circuit 13a transfers the ODS from the Coded Data Buffer 13<br>
to the Stream Graphics Processor 14. Also, when the current<br>
time reaches a DTS of a PCS or a PDS, the peripheral circuit<br>
13a transfers the PCS or the PDS from the Coded Data Buffer<br>
13 to the Composition Buffer 16.<br>
The Stream Graphics Processor 14 decodes the ODS to<br>
obtain uncompressed graphics having index colors, and<br>
transfers the uncompressed graphics to the Object Buffer 15<br>
as a graphics Object. The decoding by the Stream Graphics<br>
Processor 14 is instantaneous, and the graphics Object<br>
obtained by the decoding is temporarily stored in the Stream<br>
Graphics Processor 14. Though the decoding by the Stream<br>
Graphics Processor 14 is instantaneous, the transfer of the<br>
graphics Object from the Stream Graphics Processor 14 to the<br>
Object Buffer 15 is not instantaneous. This is because<br>
transfer to the Object Buffer 15 is performed at a transfer<br>
rate of 128Mbps in the player model of the Blu-ray Disc<br>
Read-Only Format. An end of transfer of all graphics Objects<br>
belonging to a DS to the Object Buffer 15 is shown by a PTS<br>
of an END in the DS. Therefore, processing of the next DS<br>
will not be started until the time shown by the PTS of the<br><br>
END. Transfer of a graphics Object obtained by decoding each<br>
ODS to the Object Buffer 15 starts at a time shown by a DTS<br>
of the ODS and ends at a time shown by a PTS of the ODS.<br>
If a graphics Object of DSn and a graphics Object of<br>
DSn+1 have different object_ids, the Stream Graphics<br>
Processor 14 writes the two graphics Objects in different<br>
storage areas of the Object Buffer 15. This allows pipeline<br>
presentation of the graphics Objects, without the graphics<br>
Object of DSn being overwritten by the graphics Object of<br>
DSn+1. If the graphics Object of DSn and the graphics Object<br>
of DSn+1 have the same object_id, on the other hand, the Stream<br>
Graphics Processor 14 writes the graphics Object of DSn+1<br>
to a storage area in the Object Buffer 15 in which the graphics<br>
Object of DSn is stored, so as to overwrite the graphics Object<br>
of DSn. In this case, pipeline processing is not performed.<br>
Also, a DS may include ODSs which are referenced by a PCS<br>
of the DS and ODSs which are not referenced by the PCS. The<br>
Stream Graphics Processor 14 sequentially decodes not only<br>
the ODSs referenced by the PCS but also the ODSs not referenced<br>
by the PCS, and stores graphics obtained by the decoding to<br>
the Object Buffer 15.<br>
The Object Buffer 15 corresponds to a pixel buffer in<br>
ETSI EN 300 743. Graphics Objects decoded by the Stream<br>
Graphics Processor 14 are stored in the Object Buffer 15.<br>
A size of the Object Buffer 15 needs to be twice or four times<br>
as large as that of the Graphics Plane &amp;. This is because<br>
the Object Buffer 15 needs to be capable of storing twice<br>
or four times as much graphics as the Graphics Plane 8 in<br><br>
order to achieve scrolling.<br>
The Composition Buffer 16 is used for storing a PCS and<br>
a PDS. When active periods of PCSs in DSn and DSn+1 overlap,<br>
the Composition Buffer 16 stores the PCSs of both DSn and<br>
 DSn+1.<br>
The Graphics Controller 17 decodes the PCSs in the<br>
Composition Buffer 16. Based on a decoding result, the<br>
Graphics Controller 17 writes a graphics Object of DSn+1 to<br>
the Object Buffer 15, while reading a graphics Object of DSn<br>
from the Object Buffer 15 and presenting it for display. The<br>
presentation by the Graphics Controller 17 is performed at<br>
a time shown by a PTS of the PCS in DSn.<br>
To produce a screen composition using a PCS, the Graphics<br>
Controller 17 performs the following processing. The<br>
Graphics Controller 17 reads an object_id_ref which is a<br>
reference value of an identifier of a graphics Object, from<br>
the PCS. The Graphics Controller 17 takes out one part of<br>
the graphics Object that is defined by an<br>
object_cropping_horizontal_position, an<br>
object_cropping_vertical_position, an<br>
object_cropping_width, and an object_cropping_height. The<br>
Graphics Controller 17 writes the taken part on the Graphics<br>
Plane 8 at a position shown by an object_horizontal_position<br>
and an object_vertical_position. If the graphics Object<br>
specified by the reference value belongs to the same DS as<br>
the PCS, the above writing to the Graphics Plane 8 cannot<br>
be performed until after a corresponding ODS in that DS is<br>
decoded.<br><br>
On the other hand, when a composition_state of the PCS<br>
shows Normal Case, the graphics Ob j ect has already been decoded<br>
and stored in the Object Buffer 15. Accordingly, the above<br>
writing to the Graphics Plane 8 can be performed without waiting<br>
for decoding of an ODS.<br>
To effect a Palette-only Display Update, the Graphics<br>
Controller 17 performs the following processing. Once a DS<br>
has been read from the BD-ROM 100, the Graphics Controller<br>
17 judges whether a palette_update_flag of a PCS in the DS<br>
is "1". If the palette_update_flag is "1", the Graphics<br>
Controller 17 instructs the CLUT unit 9 to perform pixel value<br>
conversion using palette data specified by a palette_id of<br>
the PCS. The Graphics Controller 17 then reads a graphics<br>
Object from the Object Buffer 15 and writes it to the Graphics<br>
Plane 8. Thus, a graphics update can be carried out just by<br>
setting the palette data in the CLUT unit 9.<br>
Recommended transfer rates and buffer sizes for<br>
realizing the PID filter 3, the Transport Buffers 4a, 4b,<br>
and 4c, the Graphics Plane 8, the CLUT unit 9, the Coded Data<br>
Buffer 13 , the Stream Graphics Processor 14 , the Object Buffer<br>
15, the Composition Buffer 16, and the Graphics Controller<br>
17 are given below. FIG. 29 shows transfer rates Rx, Rc, and<br>
Rd and sizes of the Graphics Plane 8, the Transport Buffer<br>
4a, the Coded Data Buffer 13, and the Object Buffer 15.<br>
Transfer rateRc ( Pixel Composition Rate) from the Object<br>
Buffer 15 to the Graphics Plane 8 is a highest transfer rate<br>
in the reproduction apparatus 200, and is calculated as 256Mbps<br>
(=500Kbytesx29 .97x2) from a Window size and a frame rate.<br><br>
Transfer rate Rd (Pixel Decoding Rate) from the Stream<br>
Graphics Processor 14 to the Object Buffer 15 does not need<br>
to coincide with the frame rate unlike Rc, and may be 1/2<br>
or 1/4 of Rc . Therefore, transfer rate Rd is 128Mbps or 64Mbps .<br>
Transfer rate Rx (Transport Buffer Leak Rate) from the<br>
Transport Buffer 4a to the Coded Data Buffer 13 is a transfer<br>
rate of ODSs in a compressed state. Accordingly, transfer<br>
rate Rx can be calculated by multiplexing Rd by a compression<br>
rate of ODSs. For example, when the compression rate is 25%,<br>
transfer rate Rx is 16Mbps (=64Mbpsx25%) .<br>
These transfer rates and buffer sizes are merely shown<br>
as minimum standards, and transfer rates and buffer sizes<br>
greater than those shown in FIG. 29 are equally applicable.<br>
In the above constructed reproduction apparatus 200,<br>
the construction elements perform processing in a pipeline.<br>
FIG. 3 0 is a timing chart showing pipeline processing<br>
performed in the reproduction apparatus 200 . In the drawing,<br>
the fifth level shows a DS on the BD-ROM 100 . The fourth level<br>
shows write periods of a PCS, a WDS, a PDS, ODSs, and an END<br>
to the Coded Data Buffer 13. The third level shows decode<br>
periods of the ODSs by the Stream Graphics Processor 14 . The<br>
second level shows storage contents of the Composition Buffer<br>
16. The first level shows operations of the Graphics<br>
Controller 17.<br>
DTSs of ODS1 and 0DS2 show t31 and t32 respectively.<br>
Therefore, ODSl and ODS2 need to be buffered in the Coded<br>
Data Buffer 13 by t31 and t32 respectively. This being so,<br>
writing of ODSl to the Coded Data Buffer 13 is completed by<br><br>
t31 at which decode period dpi begins, and writing of 0DS2<br>
to the Coded Data Buffer 13 is completed by t32 at which decode<br>
period dp2 begins.<br>
Meanwhile, PTSs of 0DS1 and 0DS2 show t32 and t33<br>
respectively. Accordingly, decoding of 0DS1 by the Stream<br>
Graphics Processor 14 is completed by t32, and decoding of<br>
0DS2 by the Stream Graphics Processor 14 is completed by t3 3 .<br>
Thus, an ODS is buffered in the Coded Data Buffer 13 by a<br>
time shown by a DTS of the ODS, and the buffered ODS is decoded<br>
and transferred to the Object Buffer 15 by a time shown by<br>
a PTS of the ODS.<br>
On the first level, cd1 denotes a time period needed<br>
for the Graphics Controller 17 to clear the Graphics Plane<br>
8, and td1 denotes a time period needed for the Graphics<br>
Controller 17 to write graphics obtained in the Object Buffer<br>
15 to the Graphics Plane 8 . A PTS of the WDS shows a deadline<br>
for starting writing the graphics . A PTS of the PCS shows<br>
a time at which the writing of the graphics to the Graphics<br>
Plane 8 ends and the written graphics is presented for display .<br>
Therefore, uncompressed graphics of one screen is obtained<br>
on the Graphics Plane 8 at the time shown by the PTS of the<br>
PCS. The CLUT unit 9 performs color conversion on the<br>
uncompressed graphics, and the adder 10 overlays the graphics<br>
on an uncompressed picture stored on the Video Plane 6 . This<br>
produces a resultant image.<br>
In the Graphics Decoder 12, the Stream Graphics Processor<br>
14 continues decoding while the Graphics Controller 17 is<br>
clearing the Graphics Plane 8. As a result of such pipeline<br><br>
processing, graphics can be displayed speedily.<br>
FIG . 30 shows an example when the clearing of the Graphics<br>
Plane 8 ends before the decoding of the ODSs. FIG. 31, on<br>
the other hand, is a timing chart showing pipeline processing<br>
when the decoding of the ODSs ends before the clearing of<br>
the Graphics Plane 8. In this case, upon completion of the<br>
decoding of the ODSs, the graphics obtained by the decoding<br>
cannot yet be written to the Graphics Plane 8 . Only after<br>
the clearing of the Graphics Plane 8 is completed, the graphics<br>
can be written to the Graphics Plane 8.<br>
FIG. 32 is a timing chart showing changes in buffer<br>
occupancy in the reproduction apparatus 200 . In the drawing,<br>
the first to fourth levels show changes in occupancy of the<br>
Graphics Plane 8, the Object Buffer 15, the Coded Data Buffer<br>
13, and the Composition Buffer 16, respectively. These<br>
changes are shown in the form of a line graph in which the<br>
horizontal axis represents time and the vertical axis<br>
represents occupancy.<br>
The fourth level shows changes in occupancy of the<br>
Composition Buffer 16. As illustrated, the changes in<br>
occupancy of the Composition Buffer 16 include monotone<br>
increase Vf0 with which the PCS output from the Coded Data<br>
Buffer 13 is stored.<br>
The third level shows changes in occupancy of the Coded<br>
Data Buffer 13. As illustrated, the changes in occupancy of<br>
the Coded Data Buffer 13 include monotone increases Vf 1 and<br>
Vf 2 with which ODS1 andODS2 are stored, and monotone decreases<br>
Vg1 and Vg2 with which 0DS1 and ODS2 are sequentially read<br><br>
by the Stream Graphics Processor 14. Slopes of monotone<br>
increases Vf1 and Vf2 are based on transfer rate Rx from the<br>
Transport Buffer 4a to the Coded Data Buffer 13, whereas<br>
monotone decreases Vg1 and Vg2 are instantaneous since<br>
decoding by the Stream Graphics Processor 14 is performed<br>
instantaneously. Which is to say, the Stream Graphics<br>
Processor 14 decodes each ODS instantaneously and holds<br>
uncompressed graphics obtained by the decoding. Since<br>
transfer rate Rd from the Stream Graphics Processor 14 to<br>
the Object Buffer 15 is 128Mbps, the occupancy of the Object<br>
Buffer 15 increases at 128Mbps.<br>
The second level shows changes in occupancy of the Object<br>
Buffer 15. As illustrated, the changes in occupancy of the<br>
Object Buffer 15 include monotone increases Vh1 and Vh2 with<br>
which the graphics Objects of 0DS1 and 0DS2 output from the<br>
Stream Graphics Processor 14 are stored. Slopes of monotone<br>
increases Vhl and Vh2 are based on transfer rate Rd from the<br>
Stream Graphics Processor 14 to the Object Buffer 15 . A decode<br>
period of each of 0DS1 and 0DS2 corresponds to a time period<br>
in which a monotone decrease occurs on the third level and<br>
a monotone increase occurs on the second level. The beginning<br>
of the decode period is shown by a DTS of the ODS, whereas<br>
the end of the decode period is shown by a PTS of the ODS.<br>
Once the uncompressed graphics Object has been transferred<br>
to the Object Buffer 15 by the time shown by the PTS of the<br>
ODS, the decoding of the ODS is complete. It is essential<br>
for the uncompressed graphics Object to be stored in the Object<br>
Buffer 15 by the time shown by the PTS of the ODS. As long<br><br>
as this is satisfied, the monotone decrease and the monotone<br>
increase in the decode period are not limited to those shown<br>
in FIG. 32.<br>
The first level shows changes in occupancy of the<br>
 Graphics Plane 8. As illustrated, the changes in occupancy<br>
of the Graphics Plane 8 include monotone increase Vf3 with<br>
which the graphics Objects output from the Object Buffer 15<br>
are stored. A slope of monotone increase Vf3 is based on<br>
transfer rate Rc from the Object Buffer 15 to the Graphics<br>
Plane 8. The end of monotone increase Vf3 is shown by the<br>
PTS of the PCS.<br>
The graph such as the one shown in FIG. 32 can be created<br>
through the use of the DTSs and PTSs of the ODSs, the DTS<br>
and the PTS of the PCS, and the buffer sizes and transfer<br>
rates shown in FIG. 29. Such a graph allows the author to<br>
grasp how the buffer states change when the AV Clip on the<br>
BD-ROM 100 is reproduced.<br>
These changes of the buffer states can be adjusted by<br>
rewriting DTSs and PTSs. Therefore, it is possible for the<br>
author to prevent the occurrence of such a decoding load that<br>
exceeds specifications of a decoder of the reproduction<br>
apparatus 200, or to prevent a buffer overflow during<br>
reproduction . This makes it easier to implement hardware and<br>
software when developing the reproduction apparatus 200.<br>
This completes the explanation on the internal construction<br>
of the reproduction apparatus 200.<br>
The following explains how to implement the Graphics<br>
Decoder 12 . The Graphics Decoder 12 can be realized by having<br><br>
a general-purpose CPU execute a program for performing an<br>
operation shown in FIG. 33. An operation of the Graphics<br>
Decoder 12 is explained below, with reference to FIG. 33.<br>
FIG. 33 is a flowchart showing an operation of loading<br>
a functional Segment. In the drawing, SegmentK is a variable<br>
indicating a Segment (PCS, WDS, PDS, or ODS) which belongs<br>
to a DS and is read during reproduction of the AV Clip, and<br>
an ignore flag indicates whether SegmentK is to be ignored<br>
or loaded. In this flowchart, after the ignore flag is reset<br>
to 0 (S20), a loop of steps S21 to S24 and S27 to S31 is performed<br>
for each SegmentK (S25 and S26).<br>
Step S21 judges whether SegmentK is a PCS. If SegmentK<br>
is a PCS, the operation proceeds to step S27.<br>
Step S22 judges whether the ignore flag is 0 or 1. If<br>
the ignore flag is 0, the operation proceeds to step S23 .<br>
If the ignore flag is 1, the operation proceeds to step S24 .<br>
In step S23, SegmentK is loaded to the Coded Data Buffer 13.<br>
If the ignore flag is 1 (S22:NO), SegmentK is ignored<br>
(S24 ) . This leads to the negative judgement on all functional<br>
Segments belonging to the DS in step S22, as a result of which<br>
the functional Segments of the DS are all ignored.<br>
Thus, the ignore flag indicates whether SegmentK is to<br>
be ignored or loaded. Steps S27 to S31 and S34 to S35 are<br>
performed to set this ignore flag.<br>
Step S27 judges whether a composition_state field of<br>
the PCS shows Acquisition Point. If the composition_state<br>
field shows Acquisition Point, the operation proceeds to step<br>
S28. If the composition_state field shows Epoch Start or<br><br>
Normal Case, the operation proceeds to step S31.<br>
Step S28 judges whether an immediately preceding DS<br>
exists in any of the buffers (the Coded Data Buffer 13, the<br>
Stream Graphics Processor 14, the Object Buffer 15, and the<br>
Composition Buffer 16) in the Graphics Decoder 12. The<br>
immediately preceding DS does not exist in the Graphics Decoder<br>
12 if a skip operation is performed. In this case, the display<br>
needs to be started from the Acquisition Point DS, so that<br>
the operation proceeds to step S30 (S28:NO).<br>
In step S30, the ignore flag is set to 0 , and the operation<br>
proceeds to step S22 .<br>
On the other hand, the immediately preceding DS exists<br>
in the Graphics Decoder 12 if normal reproduction is performed .<br>
In this case, the operation proceeds to step S29 (S28:YES).<br>
In step S29, the ignore flag is set to 1, and the operation<br>
proceeds to step S22.<br>
Step S31 judges whether the composition_state field<br>
shows Normal Case. If the composition_state field shows<br>
Normal Case, the operation proceeds to step S34. If the<br>
composition_state field shows Epoch Start, the operation<br>
proceeds to step S30 where the ignore flag is set to 0. Step<br>
S34 is the same as step S28 , and judges whether the immediately<br>
preceding DS exists in the Graphics Decoder 12. If the<br>
immediately preceding DS exists, the ignore flag is set to<br>
0 (S30) . Otherwise, the ignore flag is set to 1, because<br>
enough functional Segments for composing one screen of<br>
graphics cannot be obtained (S35). In this way, when the<br>
immediately preceding DS does not exist in the Graphics Decoder<br><br>
12, the functional Segments of the Normal Case DS are ignored.<br>
The following gives a specific example of loading DSs,<br>
with reference to FIG. 34. In FIG. 34, three DSs (DS1, DS10,<br>
and DS20) are multiplexed with video. A composition_state<br>
field of DS1 shows Epoch Start, a composition_state field<br>
of DS10 shows Acquisition Point, and a composition_state field<br>
of DS20 shows Normal Case.<br>
Suppose a skip operation is performed on picture data<br>
pt10 in an AV Clip in which these three DSs are multiplexed<br>
with video, as indicated by arrow am1. In such a case, DS10<br>
which is closest to ptlO is subjected to the operation shown<br>
in FIG. 33. The composition_state field of DS10 shows<br>
Acquisition Point (S27:YES), but the immediately preceding<br>
DS (DS1) does not exist in the Coded Data Buffer 13 (S28:NO).<br>
Accordingly, the ignore flag is set to 0 (S30) . As a result,<br>
DS10 is loaded to the Coded Data Buffer 13 as indicated by<br>
arrow md1 in FIG. 35. Suppose, on the other hand, a skip<br>
operation is performed on picture data which is located after<br>
DS10, as indicated by arrow am2 in FIG. 34. In this case,<br>
DS20 is a Normal Case DS, and the immediately preceding DS<br>
(DS10 ) does not exist in the Coded Data Buffer 13 . Accordingly,<br>
DS20 is ignored, as indicated by arrow md2 in FIG. 35.<br>
FIG. 37 shows how DS1, DS10, and DS20 are loaded when<br>
normal reproduction is performed as shown in FIG. 36 . Of the<br>
three DSs, DS1 which is an Epoch Start DS is loaded to the<br>
Coded Data Buffer 13, as indicated by arrow rd1 (S23) . However,<br>
the ignore flag is set to 1 for DS10 which is an Acquisition<br>
Point DS (S29), so that the functional Segments of DS10 are<br><br>
not loaded to the Coded Data Buffer 13 but ignored, as indicated<br>
by arrow rd2 (S24). Meanwhile, DS20 which is a Normal Case<br>
DS is loaded to the Coded Data Buffer 13, as indicated by<br>
arrow rd3 (S23).<br>
 The following explains an operation of the Graphics<br>
Controller 17. FIGS. 38 to 40 are flowcharts showing the<br>
operation of the Graphics Controller 17.<br>
Steps S41 to S44 constitute a main routine, where an<br>
event specified by any of steps S41 to S44 is waited.<br>
In FIG. 38, step S41 judges whether the current<br>
reproduction time is a DTS of a PCS. If so, steps S45 to S53<br>
are performed.<br>
Step S45 judges whether a composition_state field of<br>
the PCS shows Epoch Start. If so, the entire Graphics Plane<br>
8 is cleared in step S46. Otherwise, a Window specified by<br>
a window_horizontal_position field, a<br>
window_vertical_position field, a window_width field, and<br>
a window_height field of a WDS is cleared in step S47.<br>
Step S48 is performed after step S46 or S47, and judges<br>
whether a PTS of arbitrary ODSx has passed. Clearing the<br>
entire Graphics Plane 8 takes a long time, so that decoding<br>
of ODSx may already be completed by the time the entire Graphics<br>
Plane 8 is cleared. Step S48 examines this possibility. If<br>
the PTS of ODSx has not passed, the operation returns to the<br>
main routine. If the PTS of ODSx has passed, steps S49 to<br>
S51 are performed. Step S49 judges whether an<br>
object_cropped_flag field shows 0. If so, a graphics Object<br>
corresponding to ODSx is set to non-display (S50).<br><br>
If the object_cropped_f lag shows 1, the graphics Object<br>
cropped based on an object_cropping_horizontal_position<br>
field, an object_cropping_vertical_position field, a<br>
cropping_width field, and a cropping_height field is written<br>
 to the Window on the Graphics Plane 8 at a position specified<br>
by an object_horizontal_position field and an<br>
object_vertical_position field (S51). In this way, the<br>
graphics Object is v/ritten to the Window.<br>
Step S52 judges whether a PTS of another ODS (ODSy) has<br>
passed. If decoding of ODSy is completed during when the<br>
graphics Object of ODSx is being written to the Graphics Plane<br>
8, ODSy is set as ODSx (S53), and the operation returns to<br>
stepS49. As a result, steps S49 to S51 are performed on ODSy.<br>
In FIG. 39, step S4 2 judges whether the current<br>
reproduction time is a PTS of the WDS. If so, the operation<br>
proceeds to step S54, to judge whether the number of Windows<br>
is 1. If the number of Windows is 2, the operation returns<br>
to the main routine. If the number of Windows is 1, a loop<br>
of steps S55 to S59 is performed. In this loop, steps S57<br>
to S59 are performed for each of at most two graphics Objects<br>
to be displayed in the Window. Step S57 judges whether the<br>
object_cropped_f lag field shows 0 . If so, the graphics Object<br>
is set to non-display (S58).<br>
If the object_cropped_flag field shows 1, the graphics<br>
Object cropped based on an<br>
object_cropping_horizontal_position field, an<br>
object_cropping_vertical_position field, a cropping_width<br>
field, and a cropping_height field is written to the Window<br><br>
on the Graphics Plane 8 at a position specified by an<br>
object_horizontal_position field and an<br>
object_vertical_position field (S59). As a result of this<br>
loop, one or more graphics Objects are written to the Window.<br>
 Step S4 4 judges whether the current reproduction time<br>
is a PTS of the PCS. If so, the operation proceeds to step<br>
S60 to judge whether a palette_update__f lag field shows 1.<br>
If so, a Palette identified by a palette_id field is set to<br>
the CLUT unit 9 (S61). If the palette_update_f lag field shows<br>
 0, step S61 is skipped.<br>
After this, the CLUT unit 9 performs color conversion<br>
of graphics on the Graphics Plane 8. The graphics is then<br>
overlaid on video (S62).<br>
In FIG. 40, step S43 judges whether the current<br>
 reproduction time is a PTS of an ODS. If so, the operation<br>
proceeds to step S63 to judge whether the number of Windows<br>
is 2 . If the number of Windows is 1, the operation returns<br>
to the main routine.<br>
Here, the judgements made in steps S4 3 and S6 3 have the<br>
following meaning . I f the number of Windows is 2, two graphics<br>
Objects are displayed respectively in the two Windows. In<br>
such a case, each time decoding of one ODS is completed, a<br>
graphics Object obtained by the decoding needs to be written<br>
to the Graphics Plane 8 (see FIG. 19B) . Therefore, if the<br>
current reproduction time is the PTS of the ODS and the number<br>
of Windows is 2, steps S64 to S66 are performed to write each<br>
individual graphics Object to the Graphics Plane 8 . Step S64<br>
judges whether the object_cropped_f lag field shows 0 . If so,<br><br>
the graphics Object is set to non-display (S65).<br>
If the object_cropped_flag field shows 1, the graphics<br>
Object cropped based on an<br>
object_cropping_horizontal_position field, an<br>
 object_cropping_vertical_position field, a cropping_width<br>
field, and a cropping_height field is written to a Window<br>
on the Graphics Plane 8 at a position specified by an<br>
object_horizontal_position field and an<br>
object_vertical_position field (S66). By repeating this<br>
 process, two graphics Objects are written respectively to<br>
the two Windows.<br>
(Second Embodiment)<br>
The second embodiment of the present invention relates<br>
to a manufacturing process of the BD-ROM 100 explained in<br>
the first embodiment. FIG. 41 is a flowchart showing the<br>
manufacturing process of the BD-ROM 100.<br>
The manufacturing process includes a material<br>
production step of recording video, sound, and the like ( S201) ,<br>
an authoring step of creating an application format using<br>
an authoring device (S202), and a pressing step of creating<br>
an original master of the BD-ROM 100 and performing stamping<br>
and bonding to complete the BD-ROM 100 (S203).<br>
In this manufacturing process, the authoring step<br>
includes steps S204 to S213.<br>
In step S204, control information, Window definition<br>
information, Palette definition information, and graphics<br>
are generated. In step S205, the control information, the<br><br>
Window definition information, the Palette definition<br>
information, and the graphics are converted to functional<br>
Segments. In step S206, a PTS of each PCS is set based on<br>
a time of a picture to be synchronized with. In step S207,<br>
 a DTS[ODS] and a PTS[ODS] are set based on the PTS [PCS] . In<br>
step S208, aDTS[PCS], a PTS[PDS], a DTS[WDS], and a PTS[WDS]<br>
are set based on the DTS[ODS]. In step S209, changes in<br>
occupancy of each buffer in the player model are graphed.<br>
In step S210, a judgement is made as to whether the graphed<br>
changes satisfy constraints of the player model. If the<br>
judgement is in the negative, the DTS and PTS of each functional<br>
Segment are rewritten in step S211. If the judgement is in<br>
the affirmative, a graphics stream is generated in step S212,<br>
and the graphics stream is multiplexed with a video stream<br>
and an audio stream to form an AV Clip in step S213 . After<br>
this, the AV Clip is adapted to the Blue-ray Disc Read-Only<br>
Format, to complete the application format.<br>
(Modifications)<br>
Though the present invention has been described by way<br>
of the above embodiments, the present invention is not limited<br>
to such. The present invention can be realized with any of<br>
modifications (A) to (P) below. The invention of each of the<br>
claims of this application includes extension and<br>
generalization of the above embodiments and their<br>
modifications below. The degree of extension and<br>
generalization depends upon the state of the art in the<br>
technical field of the present invention at the time when<br><br>
the present invention was made.<br>
(A) The above embodiments describe the case where the<br>
BD-ROM is used as the recording medium. Main features of the<br>
present invention, however, lie in a graphics stream recorded<br>
 on the recording medium, which does not rely on physical<br>
characteristics of BD-ROMs. Therefore, the present<br>
invention is applicable to any recording medium that is capable<br>
of recording a graphics stream. Examples of such a recording<br>
medium include: an optical disc such as a DVD-ROM, a DVD-RAM,<br>
a DVD-RW, a DVD-R, a DVD+RW, a DVD+R, a CD-R, or a CD-RW;<br>
a magneto-optical disk such as a PD or an MO; a semiconductor<br>
memory card such as a CompactFlash card, a SmartMedia card,<br>
a Memory Stick card, a MultiMediaCard, or a PCMCIA card; a<br>
magnetic disk such as a flexible disk, SuperDisk, Zip, or<br>
Clik!; a removable hard disk drive such as ORB, Jaz, SparQ,<br>
SyJet, EZFley, or Microdrive, and a nonremovable hard disk<br>
drive.<br>
(B) The above embodiments describe the case where the<br>
reproduction apparatus decodes an AV Clip on the BD-ROM and<br>
outputs the decoded AV Clip to the television. As an<br>
alternative, the reproduction apparatus may be equipped with<br>
only a BD drive, with the remaining construction elements<br>
being provided in the television. In this case, the<br>
reproduction apparatus and the television can be incorporated<br>
in a home network connected with an IEEE 1394 connector. The<br>
above embodiments describe the case where the reproduction<br>
apparatus is connected to the television, but the reproduction<br>
apparatus may instead be integrated with a display device.<br><br>
Also, the reproduction apparatus may include only the system<br>
LSI (integrated circuit) which constitutes an essential part<br>
of processing . The reproduction apparatus and the integrated<br>
circuit are both an invention described in this specification .<br>
 Accordingly, regardless of whether the reproduction apparatus<br>
or the integrated circuit is concerned, an act of manufacturing<br>
a reproduction apparatus based on the internal construction<br>
of the reproduction apparatus described in the first<br>
embodiment is an act of working of the present invention.<br>
Also, any act of assigning with charge (i.e. for sale) or<br>
without charge (i.e. as a gift), leasing, and importing the<br>
reproduction apparatus is an act of working of the present<br>
invention. Likewise, an act of offering for assignment or<br>
lease of the reproduction apparatus using storefront displays,<br>
catalogs, or brochures is an act of working of the present<br>
invention.<br>
(C) Information processing using the programs shown in<br>
the flowcharts is actually realized using hardware resources .<br>
Accordingly, the programs which describe the operational<br>
procedures shown in the flowcharts are themselves an invention.<br>
The above embodiments describe the case where the programs<br>
are incorporated in the reproduction apparatus, but the<br>
programs can be used independently of the reproduction<br>
apparatus. Acts of working of the programs include (1) an<br>
act of manufacturing, (2) an act of assigning with or without<br>
charge, (3) an act of leasing, (4) an act of importing, (5)<br>
an act of providing to the public via a bi-directional<br>
electronic communications network, and ( 6 ) an act of offering<br><br>
for assignment or lease using storefront displays, catalogs,<br>
or brochures.<br>
(D) The time elements of the steps which are executed<br>
in a time series in each of the flowcharts can be regarded<br>
 as the necessary elements of the present invention . This being<br>
so, a reproduction method shown by these flowcharts is an<br>
invention. If the processing shown in each flowchart is<br>
carried out by performing the steps in a time series so as<br>
to achieve the intended aim and the intended effect, this<br>
is an act of working of the recording method of the present<br>
invention.<br>
( E ) When recording an AV Clip on the BD-ROM, an extension<br>
header may be added to each TS packet in the AV Clip. The<br>
extension header is called a TP_extra_header, includes an<br>
 arrival_time_stamp and a copy_permission_indicator, and has<br>
a data length of 4 bytes. TS packets with TP_extra_headers<br>
(hereafter "EX TS packets" ) are grouped in units of 32 packets,<br>
and each group is written to three sectors. One group made<br>
up of 32 EX TS packets has 6,144- bytes (=32x192), which is<br>
equivalent to a size of three sectors that is 6144 bytes<br>
( =2048x3 ) . The 32 EXTS packets contained in the three sectors<br>
are called an Aligned Unit.<br>
In a home network connected with an IEEE 1394 connector,<br>
the reproduction apparatus transmits an Aligned Unit in the<br>
following manner. The reproduction apparatus removes a<br>
TP_extra_header from each of the 32 EX TS packets in the Aligned<br>
Unit, encrypts the body of each TS packet according to the<br>
DTCP Specification, and outputs the encrypted TS packets.<br><br>
When outputting the TS packets, the reproduction apparatus<br>
inserts an isochronous packet between adjacent TS packets.<br>
A position where the isochronous packet is inserted is based<br>
on a time shown by an arrival_time_stamp of the TP_extra_header .<br>
 The reproduction apparatus outputs a DTCP_descriptor, as well<br>
as the TS packets. The DTCP_descriptor corresponds to a<br>
copy_permission_indicator in the TP_extra_header. With the<br>
provision of theDTCP_descriptor indicating "copy prohibited" ,<br>
it is possible to prevent, when-using the TS packets in the<br>
home network connected with the IEEE 13 94 connector, the TS<br>
packets from being recorded to other devices.<br>
(F) The above embodiments describe the case where an<br>
AV Clip of the Blu-ray Disc Read-Only Format is used as a<br>
digital stream, but the present invention can also be realized<br>
with a VOB (Video Object) of the DVD-Video Format or the<br>
DVD-Video Recording Format. The VOB is a program stream that<br>
complies with the ISO/IEC 13818-1 Standard and is obtained<br>
by multiplexing a video stream and an audio stream. Also,<br>
the video stream in the AV Clip may be an MPEG4 video stream<br>
or a WMV video stream. Further, the audio stream in the AV<br>
Clip may be a Linear PCM audio stream, a Dolby AC-3 audio<br>
stream, an MP3 audio stream, an MPEG-AAC audio stream, or<br>
a dts audio stream.<br>
(G) The film described in the above embodiments may be<br>
obtained by encoding an analog image signal broadcast by analog<br>
broadcasting. Also, the film may be stream data made up of<br>
a transport stream broadcast by digital broadcasting.<br>
Alternatively, an analog/digital image signal recorded<br><br>
on a videotape may be encoded to obtain content. Also, an<br>
analog/digital image signal directly captured by a video<br>
camera may be encoded to obtain content. A digital work<br>
distributed by a distribution server is applicable too.<br>
	(H) Graphics Objects described in the above embodiments<br>
is run-length encoded raster data. Run-length encoding is<br>
used for compression/encoding of graphics Objects, because<br>
the run-length encoding is suitable for compression and<br>
decompression of subtitles . Subtitles have a property in that<br>
a continuous length of the same pixel value in a horizontal<br>
direction is relatively long. Therefore, by performing<br>
compression using run-length encoding, a high compression<br>
rate can be attained. In addition, run-length encoding<br>
reduces a load for decompression, and is therefore suitable<br>
for realizing decoding by software. Nevertheless, the use<br>
of run-length encoding for graphics Objects is not a limitation<br>
of the present invention. For example, graphics Objects may<br>
be PNG data. Also, graphics Objects may be vector data instead<br>
of raster data . Further, graphics Objects may be transparent<br>
patterns.<br>
(I) Graphics of subtitles selected according to a<br>
language setting in the reproduction apparatus may be<br>
subjected to display effects of PCSs. As a result, display<br>
effects achieved by using characters which are contained<br>
within the body of video in a conventional DVD can be realized<br>
with subtitle graphics displayed according- to the language<br>
setting of the reproduction apparatus. This contributesto<br>
high practicality.<br><br>
Also, subtitle graphics selected according to a display-<br>
setting of the reproduction apparatus may be subjected to<br>
display effects of PCSs. For example, graphics of various<br>
display modes such as wide screen, pan and scan, and letterbox<br>
 are recorded on the BD-ROM, and the reproduction apparatus<br>
selects one of these display modes according to a display<br>
setting of the television connected with the reproduction<br>
apparatus and displays corresponding graphics. Since the<br>
display effects of PCSs are applied to such graphics,<br>
viewability increases . As a result, display effects achieved<br>
by using characters which are contained within the body of<br>
video in a conventional DVD can be realized with subtitle<br>
graphics displayed according to the display setting. This<br>
contributes to high practicality.<br>
(J) The first embodiment describes the case where<br>
transfer rate Rc from the Object Buffer to the Graphics Plane<br>
is set so as to clear the Graphics Plane and render graphics<br>
on a Window, which is 25% in size of the Graphics Plane, within<br>
one video frame. However, transfer rate Rc may be set so that<br>
the clearing and the rendering complete within a vertical<br>
blanking time. Suppose the vertical blanking time is 25% of<br>
1/29.97 seconds. Then Rc is 1Gbps. By setting Rc in this<br>
way, graphics can be displayed smoothly.<br>
Also, writing in sync with line scan can be used together<br>
with writing within a vertical blanking time. This enables<br>
subtitles to be displayed smoothly with Rc=256Mbps.<br>
(K) The above embodiments describe the case where the<br>
reproduction apparatus includes the Graphics Plane.<br><br>
Alternatively, the reproduction apparatus may include a line<br>
buffer for storing uncompressed pixels of one line. Since<br>
conversion to an image signal is performed for each horizontal<br>
row (line), conversion to an image signal can equally be<br>
performed with the line buffer.<br>
(L) The above embodiments describe the case where<br>
graphics is character strings representing dialogs in a film,<br>
but the present invention is equally applicable to any graphics<br>
that is displayed in precise synchronization with video.<br>
Examples of such graphics include an illustration, a pattern,<br>
a cartoon character, and a symbol mark. Examples of such<br>
graphics also include a combination of figures, letters, and<br>
colors constituting a trademark, a national crest, a national<br>
flag, a national emblem, a public symbol or seal employed<br>
by a national government for supervision/certification, a<br>
crest, flag, or emblem of an international organization, or<br>
a mark of origin of a particular item.<br>
(M) The first embodiment describes the case where a<br>
Window is provided on the top or bottom of the Graphics Plane,<br>
on an assumption that subtitles are displayed horizontally<br>
on the top or bottom of the screen. Instead, a Window may<br>
be provided on the left or right of the Graphics Plane, to<br>
display subtitles vertically on the left or right of the screen .<br>
This enables Japanese subtitles to be displayed vertically.<br>
(0) The Graphics Decoder performs pipeline processing<br>
on DSn and DSn+1, when DSn and DSn + 1 belong to the same Epoch<br>
inthe-graphics stream . When DSn and DSn + 1 belong to different<br>
Epochs, on "the other hand, the Graphics Decoder starts<br><br>
processing DSn+1 after display of graphics of DSn begins.<br>
Also, there, are two types of graphics streams/ i.e.,<br>
a Presentation graphics stream which is mainly intended to<br>
synchronize with video, and an Interactive graphics stream<br>
which is mainly intended to realize an interactive display.<br>
The Graphics Decoder performs pipeline processing of DSn and<br>
DSn+1 when the graphics stream is a Presentation graphics<br>
stream, and does not perform pipeline processing when the<br>
graphics stream is an Interactive graphics stream.<br>
(P) In the example shown in FIG. 20, graphics data<br>
referenced by a PCS in a DS is set before graphics data not<br>
referenced by the PCS in the DS . However, a plurality of sets<br>
of referenced graphics data and a plurality of sets of<br>
non-referenced graphics data may instead be arranged in a<br>
DS in an order specified by their object_ids . Alternatively,<br>
the plurality of sets of referenced graphics data may be<br>
arranged in a scan line order. The scan line order referred<br>
to here is an order in which scanning is performed . In general,<br>
scanning is performed from the top left to bottom right of<br>
a screen. This being so, graphics data whose display<br>
coordinates lie at the top left of the screen is set before<br>
graphics data whose display coordinates lie at the bottom<br>
right of the screen. This accelerates presentation of<br>
graphics data.<br>
The present invention can be modified as explained above .<br>
Nevertheless, the invention of each of the claims of this<br>
application reflects means for solving, the-technical problem<br>
encountered by the conventional techniques, so that the<br><br>
technical scope of the invention according to the claims will<br>
not extend beyond the technical scope in which one skilled<br>
in the art acknowledges the technical problem. Hence the<br>
invention according to the claims substantially corresponds<br>
to the description of the specification.<br>
Industrial Applicability<br>
The above embodiments disclose the internal<br>
constructions of the recording medium and the reproduction<br>
apparatus to which the present invention relates, and the<br>
recording medium and the reproduction apparatus can be<br>
manufactured in volume based on the disclosed internal<br>
constructions . In other words, the recording medium and the<br>
reproduction apparatus are capable of being industrially<br>
manufactured. Hence the recording medium and the<br>
reproduction apparatus have industrial applicability.<br><br>
We Claim:<br>
1. A reproduction apparatus for reproducing a digital stream generated by<br>
multiplexing a video stream and a graphics stream, characterized by<br>
comprising:<br>
a video decoder (5) operable to decode the video stream to generate a<br>
moving picture;<br>
a graphics decoder (12); and<br>
a plane memory (8), wherein:<br>
the graphics stream is a sequence of packets, the packets constituting the<br>
graphics stream include two types, one of which is packets containing<br>
graphics data (ODS) and the other is packets containing control data<br>
(PCS), the sequence of packets includes a pair of a packet containing<br>
graphics data (ODS) and a packet containing control data (PCS), the pair<br>
is followed by a packet containing control data (PCS) that performs a<br>
forward reference,<br>
the control data (PCS) that performs the forward reference indicates that<br>
graphics, which corresponds to the graphics data (ODS) contained in the<br>
pair of packets which precedes the control data (PCS) that performs the<br>
forward reference, is to be displayed,<br><br>
the graphics decoder (12) comprises:<br>
an object buffer (15);<br>
a processor (14) operable to generate graphics on the object buffer (15)<br>
by decoding the graphics data (ODS) contained in the pair of packets; and<br>
a controller (17) operable to execute a graphics display by writing the<br>
graphics generated on the object buffer (15) into a partial area in the<br>
plane memory (8), based on the control data (PCS) contained in the pair<br>
of packets, wherein<br>
the plane memory (8) is a memory for overlay with moving pictures and is<br>
provided in the reproduction apparatus, and<br>
when control data (PCS) that performs a forward reference has been read<br>
into the graphics decoder (12) from a recording medium, the controller<br>
(17) updates the graphics display by writing the graphics generated on<br>
the object buffer into the partial area again based on the read control<br>
data (PCS) that performs the forward reference.<br>
2. A method of recording onto a recording medium, characterized by<br>
comprising the steps of:<br>
generating application data (S202); and<br>
recording the application data to the recording medium (S203), wherein:<br><br>
the application data includes a digital stream generated by multiplexing a<br>
video stream and a graphics stream;<br>
the graphics stream is a sequence of packets, the packets constituting the<br>
graphics stream include two types, one of which is packets containing<br>
graphics data (ODS) and the other is packets containing control data (PCS),<br>
the sequence of packets includes a pair of a packet containing graphics data<br>
(ODS) and a packet containing control data (PCS), the pair is followed by a<br>
packet containing control data (PCS) that performs a forward reference; and<br>
the control data (PCS) that performs the forward reference indicates that<br>
graphics, which corresponds to the graphics data (ODS) contained in the pair<br>
of packets which precedes the control data (PCS) that performs the forward<br>
reference, is to be displayed.<br>
3. A method of reproducing a digital stream generated by multiplexing a video<br>
stream and a graphics stream, characterized by comprising the steps of:<br>
decoding the video stream to generate a moving picture; and<br>
decoding the graphics stream to generate graphics; wherein<br><br>
the graphics stream is a sequence of packets, the packets<br>
constituting the graphics stream include two types, one of which is<br>
packets containing graphics data (ODS) and the other is packets<br>
containing control data (PCS), the sequence of packets includes a pair of a<br>
packet containing graphics data (ODS) and a packet containing control<br>
data (PCS), the pair is followed by a packet containing control data (PCS)<br>
that performs a forward reference, the control data that performs the<br>
forward reference indicates that graphics, which corresponds to the<br>
graphics data (ODS) contained in the pair of packets which precedes the<br>
control data (PCS) that performs the forward reference, is to be displayed,<br>
the graphics decoding step includes the sub-steps of:<br>
generating graphics on an object buffer (15) provided in the<br>
computer by decoding the graphics data (ODS) contained in the pair of<br>
packets; and<br>
executing (S59) a graphics display by writing the graphics<br>
generated on the object buffer (15) into a partial area in a plane memory<br>
(8) provided in the computer, based on the control data (PCS) contained<br>
in the pair of packets, wherein<br><br>
the plane memory (8) is a memory for overlay with moving<br>
pictures, and<br>
when control data (PCS) that performs a forward reference has<br>
been read into the graphics decoder (12) from a recording medium, the<br>
graphics display executing sub-step updates the graphics display by<br>
writing the graphics generated on the object buffer (15) into the partial<br>
area again based on the read control data (PCS) that performs the<br>
forward reference.<br>
4. A reproduction apparatus for reproducing a digital stream generated by<br>
multiplexing a video stream and a graphics stream, characterized by<br>
comprising:<br>
a video decoder (5) operable to decode the video stream to generate a<br>
moving picture, and store a picture constituting the moving picture into a<br>
video plane;<br>
a graphics decoder (12) operable to decode the graphics stream to<br>
generate graphics, and store the generated graphics into a graphics plane;<br>
and<br>
an adder (10) operable to overlay the graphics and the moving picture by<br>
performing addition for corresponding pixels in the picture stored in the video<br>
plane and the graphics stored in the graphics plane, wherein<br><br>
the graphics stream is a sequence of packets, the packets constituting the<br>
graphics stream include two types, one of which is packets containing<br>
graphics data (ODS) and the other is packets containing control data (PCS),<br>
the sequence of packets includes a pair of a packet containing graphics data<br>
(ODS) and a packet containing control data (PCS), the pair is followed by a<br>
packet containing control data (PCS) that performs a forward reference,<br>
the control data (PCS) that performs the forward reference indicates that<br>
graphics, which corresponds to the graphics data (ODS) contained in the pair<br>
of packets which precedes the control data (PCS) that performs the forward<br>
reference, is to be displayed,<br>
the graphics decoder (12) includes;<br>
an object buffer (12);<br>
a processor (14) operable to generate graphics on the object buffer (12)<br>
by decoding the graphics data (ODS) contained in the pair of packets; and<br>
a controller (17) operable to execute a graphics display by writing the<br>
graphics generated on the object buffer (12) into a partial area in the plane<br>
memory (8), based on the control data (PCS) contained in the pair of<br>
packets, wherein<br><br>
the plane memory (8) is a memory for overlay with moving pictures and is<br>
provided in the reproduction apparatus, and<br>
when control data (PCS) that performs a forward reference has been read<br>
into the graphics decoder (12) from a recording medium, the controller (17)<br>
updates the graphics display by writing the graphics generated on the object<br>
buffer (12) into the partial area again based on the read control data (PCS)<br>
that performs the forward reference.<br><br><br><br>
ABSTRACT<br><br><br>
TITLE: AN APPARATUS AND METHOD FOR REPRODUCING AND RECORDING<br>
A DIGITAL STREAM<br>
The invention relates to a reproduction apparatus for reproducing a digital<br>
stream generated by multiplexing a video stream and a graphics stream,<br>
comprising a video decoder(5) operable to decode the video stream to<br>
generate a moving picture; a graphics decoder(12) ; and a plane memory (8),<br>
wherein the graphics stream is a sequence of packets, the packets constituting<br>
the graphics stream include two types, one of which is packets containing<br>
graphics data (ODS) and the other is packets containing control data (PCS), the<br>
sequence of packets includes a pair of a packet containing graphics data (ODS)<br>
and a packet containing control data (PCS), the pair is followed by a packet<br>
containing control data (PCS) that performs a forward reference,the control<br>
data (PCS) that performs the forward reference indicates that graphics, which<br>
corresponds to the graphics data (ODS) contained in the pair of packets which<br>
precedes the control data (PCS) that performs the forward reference, is to be<br>
displayed, the graphics decoder (12) comprises: an object buffer (15) ;a<br>
processor (14) operable to generate graphics on the object buffer (15) by<br>
decoding the graphics data (ODS) contained in the pair of packets; and a<br>
controller (17) operable to execute a graphics display by writing the graphics<br>
generated on the object buffer (15) into a partial area in the plane memory (8),<br>
based on the control data (PCS) contained in the pair of packets, wherein the<br>
plane memory (8) is a memory for overlay with moving pictures and is<br>
provided in the reproduction apparatus, and when control data (PCS) that<br>
performs a forward reference has been read into the graphics decoder (12)<br>
from a recording medium, the controller (17) updates the graphics display by<br>
writing the graphics generated on the object buffer into the partial area again<br>
based on the read control data (PCS) that performs the forward reference.</td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDI0NjAta29sbnAtMjAwNS1jbGFpbXMucGRm" target="_blank" style="word-wrap:break-word;">02460-kolnp-2005-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDI0NjAta29sbnAtMjAwNS1kZXNjcmlwdGlvbiBjb21wbGV0ZS5wZGY=" target="_blank" style="word-wrap:break-word;">02460-kolnp-2005-description complete.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDI0NjAta29sbnAtMjAwNS1kcmF3aW5ncy5wZGY=" target="_blank" style="word-wrap:break-word;">02460-kolnp-2005-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDI0NjAta29sbnAtMjAwNS1mb3JtIDEucGRm" target="_blank" style="word-wrap:break-word;">02460-kolnp-2005-form 1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDI0NjAta29sbnAtMjAwNS1mb3JtIDIucGRm" target="_blank" style="word-wrap:break-word;">02460-kolnp-2005-form 2.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDI0NjAta29sbnAtMjAwNS1mb3JtIDMucGRm" target="_blank" style="word-wrap:break-word;">02460-kolnp-2005-form 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDI0NjAta29sbnAtMjAwNS1mb3JtIDUucGRm" target="_blank" style="word-wrap:break-word;">02460-kolnp-2005-form 5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDI0NjAta29sbnAtMjAwNS1pbnRlcm5hdGlvbmFsIHB1YmxpY2F0aW9uLnBkZg==" target="_blank" style="word-wrap:break-word;">02460-kolnp-2005-international publication.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LSgwNy0wMi0yMDEzKS1BTUFOREVEIFBBR0VTIE9GIFNQRUNJRklDQVRJT04ucGRm" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-(07-02-2013)-AMANDED PAGES OF SPECIFICATION.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LSgwNy0wMi0yMDEzKS1DT1JSRVNQT05ERU5DRS5wZGY=" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-(07-02-2013)-CORRESPONDENCE.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUFCU1RSQUNUIDEuMS5wZGY=" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-ABSTRACT 1.1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUFCU1RSQUNULnBkZg==" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-ABSTRACT.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUNBTkNFTExFRCBQQUdFUy5wZGY=" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-CANCELLED PAGES.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUNBTkNFTExFRCBQQUdFUzEuMS5wZGY=" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-CANCELLED PAGES1.1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUNMQUlNUyAxLjEucGRm" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-CLAIMS 1.1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUNMQUlNUy5wZGY=" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-CLAIMS.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUNPUlJFU1BPTkRFTkNFLnBkZg==" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-CORRESPONDENCE.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LURFU0NSSVBUSU9OIChDT01QTEVURSkgMS4xLnBkZg==" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-DESCRIPTION (COMPLETE) 1.1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LURSQVdJTkdTIDEuMS5wZGY=" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-DRAWINGS 1.1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUVYQU1JTkFUSU9OIFJFUE9SVC5wZGY=" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-EXAMINATION REPORT.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUZPUk0gMS4xLjEucGRm" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-FORM 1.1.1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUZPUk0gMTMucGRm" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-FORM 13.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUZPUk0gMTgucGRm" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-FORM 18.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUZPUk0gMi4xLjEucGRm" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-FORM 2.1.1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUZPUk0gMjYucGRm" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-FORM 26.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUZPUk0gMyAxLjIucGRm" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-FORM 3 1.2.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUdQQS5wZGY=" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-GPA.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUdSQU5URUQtQUJTVFJBQ1QucGRm" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-GRANTED-ABSTRACT.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUdSQU5URUQtQ0xBSU1TLnBkZg==" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-GRANTED-CLAIMS.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUdSQU5URUQtREVTQ1JJUFRJT04gKENPTVBMRVRFKS5wZGY=" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-GRANTED-DESCRIPTION (COMPLETE).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUdSQU5URUQtRFJBV0lOR1MucGRm" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-GRANTED-DRAWINGS.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUdSQU5URUQtRk9STSAxLnBkZg==" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-GRANTED-FORM 1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUdSQU5URUQtRk9STSAyLnBkZg==" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-GRANTED-FORM 2.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUdSQU5URUQtRk9STSAzLnBkZg==" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-GRANTED-FORM 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUdSQU5URUQtRk9STSA1LnBkZg==" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-GRANTED-FORM 5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUdSQU5URUQtU1BFQ0lGSUNBVElPTi1DT01QTEVURS5wZGY=" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-GRANTED-SPECIFICATION-COMPLETE.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LUlOVEVSTkFUSU9OQUwgUFVCTElDQVRJT04ucGRm" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-INTERNATIONAL PUBLICATION.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LU9USEVSIFBBVEVOVCBET0NVTUVOVC5wZGY=" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-OTHER PATENT DOCUMENT.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LU9USEVSUy5wZGY=" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-OTHERS.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LVBFVElUSU9OIFVOREVSIFJVTEUgMTM3LnBkZg==" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-PETITION UNDER RULE 137.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LVBSSU9SSVRZIERPQ1VNRU5ULnBkZg==" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-PRIORITY DOCUMENT.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LVJFUExZIFRPIEVYQU1JTkFUSU9OIFJFUE9SVC5wZGY=" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-REPLY TO EXAMINATION REPORT.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ2MC1LT0xOUC0yMDA1LVRSQU5TTEFURUQgQ09QWSBPRiBQUklPUklUWSBET0NVTUVOVC5wZGY=" target="_blank" style="word-wrap:break-word;">2460-KOLNP-2005-TRANSLATED COPY OF PRIORITY DOCUMENT.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="255755-sampler-for-taking-sample-from-body-cavity.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="255757-carbon-based-diazeniumdiolate-nitric-oxide-rleasing-polymer-composition.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>255756</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>2460/KOLNP/2005</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>12/2013</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>22-Mar-2013</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>20-Mar-2013</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>02-Dec-2005</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>PANASONIC CORPORATION</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>1006, OAZA KADOMA KADOMA-SHI, OSAKA 571 8501 JAPAN</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>JOSEPH MCCROSSAN</td>
											<td>1724, WEXFPRD CIRCLE, SIMI VALLEY, CA, 93065 USA</td>
										</tr>
										<tr>
											<td>2</td>
											<td>HIROSHI YAHATA</td>
											<td>24-10-303, SHYOUJI-CHO, KADOMA-SHI, OSAKA 571-0058 JAPAN</td>
										</tr>
										<tr>
											<td>3</td>
											<td>TOMOYUKI OKADA</td>
											<td>1-8-19-303, TOMIO-MOTOMACHI, NARA-SHI, NARA 631-0078 JAPAN</td>
										</tr>
										<tr>
											<td>4</td>
											<td>WATARU IKEDA</td>
											<td>1-15-18-1202, KYOMACHIBORI, NISHI-KU, OSAKA-SHI, OSAKA 550-0003 JAPAN</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04N 5/91</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/JP2004/009517</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2004-06-29</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>60/483,228</td>
									<td>2003-06-30</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/255756-an-apparatus-and-method-for-reproducing-and-recording-a-digital-stream by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 10:18:07 GMT -->
</html>
