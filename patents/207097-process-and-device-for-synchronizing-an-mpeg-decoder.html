<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/207097-process-and-device-for-synchronizing-an-mpeg-decoder by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 02:23:01 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 207097:&quot; PROCESS AND DEVICE FOR SYNCHRONIZING AN MPEG DECODER&quot;</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">&quot; PROCESS AND DEVICE FOR SYNCHRONIZING AN MPEG DECODER&quot;</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>This invention relates to a Process for synchronizing an MPEG decoder for the decoding of compressed data originating from a recording medium (4), the data consisting of PES (Packetized Elementary Stream) audio and video data packets, comprising: calculating an actual hstant of presentation Tpres of the video of an image, this instant relatinig to a local clock LSTC, calculating an offset STCO between this calculated instant under presentation and the PTS label corresponding to the instant under presentation desired by the coder for the video of the image, so as to define a virtual clock VSTC=STCO + LSTC, presenting the video and of the audb corresponding to this image at the PTS dates relating to the virtual clock VSTC.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>The invention relates to a process for synchronizing an MPEG decoder for the decoding of compressed data originating from a recording medium. The invention also relates to an MPEG decoder implementing such a process, a satellite decoder or a television receiver comprising such a decoder.<br>
Figure 1 represents a configuration of a satellite decoder using a recording of an MPEG data stream on hard disc.<br>
An MPEG program stream (PS) is received at the input of a multiplexer 1. The latter outputs the data of a program in the form of PES data packets (the initials standing for Packetized Elementary Stream). These data are sent to a memory 2 and then to a hard disc 4 by way of a disc interface 3, for their recording.<br>
For the reading of the data, the hard disc 4 is linked to a disc interface 5 and then to a memory 6. A first memory output is linked to a video MPEG decoding circuit 7 and a second memory output is linked to an audio MPEG decoding circuit 8. The output from each of these circuits corresponds to the video and audio cues transmitted to digital/analogue converters and then to a television receiver (which are not represented in the figure).<br>
The memory circuit 6 makes it possible, among other things, to demultiplex the audio and video data stored on the hard disc. These video PES and audio' PES data are thereafter processed by their respective decoders.<br>
The data stored on the hard disc are the data obtained after demultiplexing the stream. Hence, one is not dealing with storage of the PS program stream, thus avoiding the regeneration of such a stream on reading, the storage of all the programs constituting this Â¦ stream, or the storage of the scrambled data with recording of key words etc.<br>
The manner of operation of a decoder according to the MPEG standard, in a conventional configuration,<br><br>
- 2 -<br>
that is to say one which receives the data stream directly with a given transmission bit rate, for example via satellite transmission or via cable, is recalled hereinbelow so as to stress the particular characteristics relating to an environment with hard disc, that is to say with intermediate storage of the data on hard disc before decoding.<br>
Management of the buffer memory of a decoder is performed, in the MPEG standard, on the basis of modelling referred to as a virtual memory. Indeed, the coding of each image constituting a sequence is not carried out at constant cost and a buffer memory at the output of the coder is used to deliver a data stream at constant mean bit rate. On the decoder side, a buffer memory is also required so as to deliver, from the constant-bit-rate data stream, variable-cost images. Management of the buffer memory of the decoder is performed on the basis, among other things, of the clocks transmitted by the coder in the data stream and of the tags allocated to the images transmitted and defining the instant of exit from the memory of the decoder, the time gap between the instant of storage of an image in the memory of the coder and the instant of reading of the memory of the decoder having to be the same for each image.<br>
This involves the PCR clock, standing for Program Clock Reference in the MPEG standard, which is a time cue transmitted in the data stream and on the basis of which the synchronization of the decoder is performed.<br>
This also involves the DTS tag, standing for Decoding Time Stamp in the MPEG standard, which is a field transmitted in the stream and which indicates the instant at which an image is to be decoded in the decoder.<br>
The PCR cue present in the transport stream TS is used by the decoder to calculate the time. The PCR therefore delivers the scheduling tag at decoder level.<br><br>
- 3 -<br>
The DTS gives the decoding schedules, that is to say the instant at which the image must be read from the buffer memory of the decoder and decoded.<br>
The PCR and DTS cues are transmitted respectively in 18 8-byte packet headers of the transport stream TS and in packet headers of the PES stream, the first packetization step required in the production of a transport stream TS.<br>
The initials PTS, standing for Presentation Time Stamp, correspond to the instant of display of the image and allow the reordering of the images after decoding; the PTS is present in the packet headers of the PES stream.<br>
When the MPEG decoder operates on the basis of the data originating from the hard disc, these data are consumed at the tempo of the decoder. The synchronization signals of the audio and video decoders for displaying the decoded images (VSYNC) are regulated by the local 27 MHz clock so as to deliver 25 images per second approximately.<br>
Since the recording is carried out at the level of the audio and video PESs, the cue relating to the PCR of the PS stream is lost and may not therefore serve in the slaving of the local clock. This absence of slaving generates a management problem at the level of the write and read pointers of the hard disc as well as a synchronization problem at the level of the audio and video signals.<br>
As regards the management of the pointers, two modes are to be considered: the read only mode, that is to say without simultaneous writing of the hard disc, for which the problem is not too troublesome, and the read/write mode.<br>
In read only mode, when a previously recorded stream is replayed, the accuracy of the local clock in free oscillation is sufficient. The variation relative to the nominal value of the recording is found within the duration of the 4 0 ms video image. The tolerance at television and viewer level is sufficiently large to be<br><br>
- 4 -<br>
able to make do with much lower accuracy than the standards of professional television.<br>
This is because the image synchronization signal (VSYNC) is defined on the basis of the 27 MHz clock. It has a period of 40 ms. A slow drifting of this signal, due to the accuracy of the local clock, is not at all troublesome owing to the fact that the television is at the end of the transmission chain.<br>
On the other hand, in write/read mode (read shifted with respect to write mode, more commonly known as Time Shifting) , malfunctions may occur due to the fact that this clock is in free oscillation, it not being possible to slave it to the stream read back from the disc.<br>
When recording and reading are simultaneous, the case of time-shifted replaying, there is a risk that writing will be overtaken by reading on the disc, or that there will be an increase in the delay. Since the drifting is slow, this second case is not too troublesome. On the other hand, if reading overtook writing, that is to say if the read pointer overtook the write pointer and went off to read as yet unwritten memory areas, the image depicted would at best be what has been recorded in this area during a previous recording and the images being recorded could no longer be replayed. This situation can occur when the shift between recording and reading is due to a short pause in reading. In this case, and if the 27 MHz clock is slightly faster than that used by the coder when coding the data, the replaying of the data is faster than their recording and over a long period, that is to say for a recorded program of a certain duration, the read pointer can overtake the write pointer. In this mode, it is therefore necessary to prohibit such slippage between writing and reading.<br>
One idea would be to slave the local clock to the PCRs (Program Clock References) of the incident stream while being recorded. However, this would not solve another malfunction which may occur on account of<br><br>
- 5 -<br>
the fact that the validity of the recorded data is not known a priori. Since writes and reads are synchronous, in the case where the local clock is synchronized to the PCRs of the incident stream, the delay between reading and writing will be maintained unless the decoder begins to consume the data very quickly. This may happen if the data are corrupted. Indeed, while in the case of a real-time (live) transmission, these erroneous data can be detected immediately upon reading the buffer of the decoder, the same does not hold when recording on hard disc which enables such erroneous data to be detected only after the reading and storage of these data in the buffer of the decoder. When corrupted data are detected by the decoder, the latter re-synchronizes and instantaneously empties the buffer, causing the loss of data and accesses to the hard disc which are repeated for the filling of this buffer. In this case, it may happen that the read pointer overtakes the write pointer. This can occur upon transmission of erroneous cues or upon loss of data transmission owing for example to poor transmission conditions.<br>
As far as the synchronization of the audio and video data is concerned, be it in read only mode or read/write mode, the fact of not being able to initialize and synchronize the local clock to the PCR cue, for example in read only mode, may give rise to a problem of synchronization between the video and the audio. This is because the cues relating to the instants of presentation relative to the local clock cannot be utilized on account of the fact that this clock is no longer synchronized with that of the coder.<br>
The aim of the invention is to alleviate the aforesaid drawbacks.<br>
Its subject is a process for synchronizing an MPEG decoder for the decoding of compressed data originating from a recording medium, these data consisting of PES (Packetized Elementary Stream) audio<br><br>
- 6 -<br>
and  video  data  packets,  characterized  in  that  it comprises:<br>
-	a step of calculating an actual instant of<br>
presentation Tpres  of the video of an image,  this<br>
instant relating to a local clock LSTC,<br>
-	a step of calculating an offset STCO between<br>
this calculated instant of presentation and the PTS<br>
label  corresponding  to the  instant of presentation<br>
desired by the coder for the video of this image, so as<br>
to define a virtual clock VSTC = STCO + LSTC,<br>
-	a presentation of the video and of the audio<br>
corresponding to this image at the PTS dates relating<br>
to the virtual clock VSTC.<br>
According to a particular characteristic, the time of transit of the video through the buffer of the video decoder is imposed at a predetermined value TVBV.<br>
According to a variant, the determination of TVBV is dependent on the bit rate of recording of the PES data on the recording medium.<br>
According to a variant, the determination of TVBV is dependent on the VBV_delay.<br>
According to a particular characteristic, the offset is equal to:<br>
STCO = PTS - TVBV - TVSYNC - (TimeRef x 40 ms) - TDEC - LSTCpic<br>
where:<br>
TVSYNC corresponds to a frame period,<br>
TDEC corresponds to the duration of decoding of the image, rounded to a higher number of frame periods,<br>
TimeRef represents the temporal reference of the image for the reordering,<br>
LSTCpic relates to the instant of detection of the first image.<br>
According to a particular mode of operation, reading data in shifted mode (time shifting) , the data being recorded on the basis of a write pointer, the recorded data being read in shifted time on the basis of a read pointer, a minimum gap is imposed between the read and write pointer and, when this gap is achieved, the freeze mode of the decoder is actuated.<br><br>
- 7 -<br>
The subject of the invention is also a device for synchronizing an MPEG decoder to a recorded MPEG stream, the recorded data consisting of PES data packets, characterized in that it comprises means for calculating an offset STCO to be applied to the local clock LSTC of the decoder so as to define a virtual clock VSTC, this offset being equal to the difference between the instant of presentation Tpres of the video of an image, as calculated in the LSTC tag, and the PTS value of presentation of this image originating from the coder and in that the decoding of the audio and video data are carried out when this virtual clock VSTC is equal to the PTS value.<br>
Its subject is also a satellite decoder characterized in that it comprises an MPEG decoder and a synchronization device according to Claim 11, or else a television receiver, characterized in that it comprises an MPEG decoder and a synchronization device according to Claim 11.<br>
The local recording on a hard disc of a program in PES form therefore requires that precautions be taken on replay: slaving of the local clocks and synchronization of the video and audio decoders.<br>
The method proposed here strives to emulate the components of satellite transmission in such a way as to be able to operate the audio and video decoders in modes which are as similar as possible to their nominal manner of operation.<br>
The main advantage of the invention is that it proposes a synchronization process which is simple to implement, requiring no utilization of the PCRs and avoiding the malfunctions which are generally encountered upon reading data from the hard disc.<br>
The characteristics and advantages of the present invention will be more apparent from the following description given by way of example and with reference to the appended/accompanying figures, where:<br>
Figure 1 represents a simplified diagram of a satellite decoder with hard disc.<br><br>
- 8 -<br>
Figure 2 represent the operation of writing the audio and video data to disc.<br>
Figure 2b represents the operation of reading the audio and video data from disc.<br>
Figure 3 represents the write and read pointers relating to the recorded data.<br>
Figure 4 represents the manner of operation of a video decoder on start-up according to the prior art.<br>
Figure 5 represent the various steps required in the presentation of a decoded image.<br>
Management of the pointers.<br>
Figures 2a and 2b diagrammatically represent the manner of performing the storage and de-storage of the audio and video cues on the hard disc.<br>
Figure 2a corresponds to the operation of writing to the hard disc. The video and audio PESs are recorded on the disc in one and same 128 kB block (256 addressing blocks) [or lba, the acronym standing for logic block addressing] of 512 bytes). The video occupies 112 kB and the sound occupies a part of the remaining 16 kB, proportionally to the audio bit rate. The value q corresponding to the quantity of audio which arrives while the 112 kB of video are buffered, is written at the start of the 128 kB block and therefore corresponds to the quantity of audio stored. On recording a block the ratio of the video/audio bit rates is complied with.<br>
Figure 2b corresponds to the operation of reading the hard disc, the 112 kB of video are read so as to form the video PES stream at the same time as the quantity q kB of audio information {variable part) so as to form the audio PES stream.<br>
Figure 3 represents a succession of data blocks, each of 128 kB, such as they are stored on the hard disc and the position- of the read and write pointers for this hard disc. The double arrow referenced 9 represents the delay between the write pointer  (vertical arrow on the right)  and the read<br><br>
- 9 -<br>
pointer (vertical arrow on the left) . The double arrow referenced 10 represents a stipulated gap, here 5 blocks, which is the gap, predefined at the outset, between the pointers and the double arrow referenced 11 represents a freeze gap, that is to say a minimum gap causing image freeze.<br>
The idea here is to ensure, via software, a minimum gap, for example of a 128 kB block between the pointers. When it is attained, the decoding is temporarily suspended by halting the reading of the memory of the decoder, thereby causing the image on the screen to freeze, until one block at least separates writing and reading. One does not seek, in fact, to reestablish the initial gap since the data are in any case lost and there is no benefit in keeping the image frozen with the sole aim of re-establishing the initial delay.<br>
Audio/Video synchronization.<br>
Given the "interlaced" mode of storage of the audio and video data, the replaying of the two components of the program is necessarily done simultaneously. As a first approximation it may be said that the first video byte and the first audio byte reach their respective decoders at the same time. This does not mean to say that they will be decoded at the same time, on account of the time of transit of the video through its decoder.<br>
It is known that, in order to avoid the use of a large-capacity audio buffer memory, the audio is phase-delayed from the time of coding. Thus, on replay, in standard mode (direct transmission) the audio is in phase with the video. This delay is determined at the coder and is dependent on the video bit rate.<br>
When the data are recorded on hard disc and because they are no longer transmitted to the audio and video decoders with this video bit rate, a phase shift reappears between the audio and the video.<br><br>
- 10 -<br>
The manner of operation of the video decoder on start-up, in the general case, is represented in Figure 4 with the aid of a flow chart. This start-up is performed as follows:<br>
The decoding procedure, step 12, receives the data stream so as to extract, among other things, the headers. Step 13 effects a loop until the first sequence header is detected. When such is the case, step 14 is implemented and consists in reading the image header which follows this sequence header. If the PTS cue is utilizable, check undertaken in step 15, the DTS cue is then deduced during step 16. Step 17 consists of a loop comparing DTS with the local clock LSTC. The loop output corresponds to equality and, on receiving the next sync signal (VSYNC), a parity test is performed during a step 18 triggering the decoding of the image, step 19, upon detection of the correct parity.<br>
If the PTS cue is not utilizable, a step 20 consists in filling the buffer memory of the decoder. The step 21 checks the level of fill of this buffer memory. When the minimum level required for decoding is reached and on receiving the next sync signal a parity test is performed, step 18. The decoding of the image step 19 is performed upon detection of the correct parity.<br>
The decoding of a video PES stream therefore commences under several conditions. Firstly, the decoder is unaware of the start of the stream until it encounters a start-up sequence, step 13. It therefore identifies the first sequence header (SEQ) which constitutes the point of entry of the stream. The data are then accumulated in the buffer of the decoder at a tempo corresponding to the bit rate of the transmission. After the sequence header, the image header (picture_header) is received by the decoder, step 14.<br>
The cue relating to the minimum buffer level required for start-up of the decoding of this first<br><br>
- 11 -<br>
image is in this header. Once this level is reached in the buffer {step 21} , hence after a certain time related to the video bit rate, the decoder checks the correct parity (step 18) of the vertical synchronization signal (VSYNC) so as to order the decoding {step 19).<br>
In the case where the VBV_delay is not available in the stream, it is the PTS (Presentation Time Stamp) cue which fixes the start-up of the decoding.<br>
Concerning start-up, the main differences between direct reception (that is to say without involving storage on disc) and replaying of the data from a hard disc are:<br>
the  read bit  rate which may be seen as infinite in respect of the disc,<br>
- the absence of local clock (LSTC Local System Time Clock) synchronized to the PCR (Program Clock Reference) cue.<br>
By virtue of the high video bit rate which is possible during the filling of the buffer from the hard disc during the start-up of a stream, the decoding of the first image will occur sooner than for direct reception, causing a phase shift between the audio and the video. The synchronization of the audio associated with the video, such as implemented in the invention and as explained hereinbelow, makes it possible to avoid such a phase shift.<br>
The LSTC normally has a major role in stream control and in synchronizing the audio with the video. Stream control is not a problem when the data originate from the disc since transmission is halted as soon as the memory buffers are full. There is therefore no risk of data loss. On the other hand, a reference clock is still necessary so as to allow the synchronization of the audio with the video. The utilization of a virtual STC clock (VSTC) recreated from the PTS cues of the video allows this synchronization.<br><br>
- 12 -<br>
The Virtual STC must be initialized as soon as possible by the video procedure so as to allow the audio to synchronize itself with this clock. The cues required for its initialization are:<br>
the value of the local STC counter (LSTC).<br>
the PTS of the first image.<br>
the VBV_delay of the first image (if present).<br>
the time reference of the first image (TimeRef) used for the reordering of the images.<br>
the parity of the vertical sync VSYNC.<br>
Given the high bit rate available on reading the disc, these cues which are obtained on acquiring the first image header (PIC header) are available very rapidly.<br>
Figure 5 represents, diagrammatically, the various steps in time which are required for the representation of a decoded image. The upper end represents the succession of data which have been stored on the disc and which are now being read. This band is chopped into frame periods.<br>
Hereinbelow, the following notation will be adopted:<br>
- Tpic to represent a date {lower case letters after T).<br>
TVBV to represent a duration  (upper case letters).<br>
After detection of the first image header after the sequence header, reading and recording of the blocks takes place in the buffer of the decoder during a time TVBV corresponding to VBV_delay. After this time, a parity check is performed. If the sync signal is of opposite parity to that of the image which is ready to be decoded, the case in the figure, a duration equal to TVSYNC (20 ms) is added to determine the instant of decoding. This instant is called Tdec. If the actual duration of the decoding is greater than a frame period (the case in the figure in which the duration is represented by a rectangle containing the<br><br>
- 13 -<br>
inscription "decoding"), the duration of decoding taken into account TDEC is chosen equal to an integer number of durations TVSYNC which is immediately greater than the actual duration. If Tpres is the actual instant of display of the decoded image, the gap between Tpres and Tdec is equal to TDEC + TimeRef x TVSYNC, TimeRef being the time reference serving in the reordering of the images.<br>
As soon as possible, the decoding of the image, instant Tdec, commences at the first sync VSYNC of correct parity which follows the instant at which the level of the buffer memory has reached the level corresponding to the lag VBV_delay at the nominal bit rate. Here again, the high bit rate on reading the disc means that the filling time of the decoder buffer is small and much less than the VBV delay. This bit rate can easily be 20 times larger than that of satellite transmission. To give some kind of idea, the filling of the buffer of the decoder of capacity 1.8 Mbit, with a satellite transmission bit rate of 4 Mbit/s, requires 0.45 s. This lag is reduced to 0.03 s when the filling is undertaken from a hard disc.<br>
One would therefore be able to commence the decoding of the video sooner, without needing to wait for this duration VBV_delay. However, .the audio and video must remain synchronized. Since the decoding of the audio cannot itself be brought forward in the same way, the audio would lag behind the video. Such a situation is not desirable since it demands that audio data be rapidly ignored so as to catch up.<br>
To alleviate this drawback and hence to compensate for the high bit rate offered by the disc, a delay called TVBV is deliberately imposed on the video. This delay makes it possible to simulate the original VBV delay.<br>
TVBV = VBV_delay<br><br>
- 14 -<br>
If the VBV_delay cue is not available in the stream, it can be replaced, in the formula, with the size of the decoder buffer (std buffer):<br>
TVBV = std_buffer/BitRateSat) - std_buffer/BitRateDisk)<br>
This duration is dependent on the video bit rate (satellite transmission bit rate BitRateSat) and on the bit rate of the disc (BitRateDisk).<br>
Since the bit rate of the disc is very much greater than that of the satellite, the following approximation may be made:<br>
TVBV = std_buffer/BitRateSat.<br>
The value BitRateSat is calculated while writing. This is because the number of bytes written during a time unit is known.<br>
The size of the buffer is generally 1.8 Mbits.<br>
Once this delay has elapsed, decoding can cdmmence. However, in certain set-ups, the addition of a 20 ms delay may turn out to be necessary in order to wait for the correct parity of the Vertical Sync. Since it is preferable to guarantee that audio start-up will not be delayed relative to the video rather than the reverse, a 20 ms lag (TVSYNC) which allows this rephasing with the Vertical Sync (VSYNC) is introduced by default. The start date of decoding (Tdec) relative to the date of detection of the first image (Tpic) is then:<br>
Tdec = Tpic + TVBV + TVSYNC<br>
Knowing the start instant of decoding (Tdec), the instant of presentation (Tpres) is dependent on the<br>
time reference of the image  (TimeRef)and on the lag required for its decoding (TDEC):<br>
Tpres = Tdec + TimeRef * 40 ms + TDEC<br><br>
- 15 -<br>
Tdec is dependent on the implementation of the decoder (typically 20 ms or 40 ms). In the application, the implementation time is 40 ms.<br>
On replacing Tdec by the value calculated above:<br>
Tpres = Tpic + TVBV + TVSYNC + TimeRef * 40 ms + TDEC<br>
The date Tpic which is the value of the local clock LSTC at the exact moment that the first image was detected is not necessarily known. This is because, for example in our system, the implementation of the clock LSTC allows its value to be sampled only every 20 ms. It is therefore advisable to replace it with the following formula in which LSTCpic represents the value of the clock LSTC available (sampled at the previous vertical sync) at the moment that the first image is detected:<br>
Tpic = LSTCpic and<br>
Tpres = LSTCpic + TVBV + TVSYNC + TimeRef * 40 ms + TDEC<br>
An offset value is now calculated, corresponding to the gap between the actual instant of presentation of the image, Tpres, and the instant of presentation desired by the coder, PTS. This instant PTS is only of significance provided that the clock of the decoder has been initialized and synchronized to the PCR. Here, this value PTS is used not to define a time of presentation in the absolute but to enable the instants of audio and video decoding to be synchronized (same PTSs).<br>
The offset is therefore the correction STCO (System Time Clock Offset) to be made on the local clock so that the instant of presentation of the image, Tpres defined on the basis of this local clock, corresponds to the PTS label:<br>
Tpres + STCO = PTS<br><br>
16 -<br>
STCO = PTS - TVBV - TVSYNC - (TimeRef x 40 ms) - TDEC - LSTCpic<br>
We have thus defined a virtual clock VSTC such that:<br>
VSTC = LSTC + STCO<br>
This virtual clock serves as reference for the synchronization of the audio.<br>
When the value of VSTC is equal to PTS, the audio presentation can be performed and will therefore be in phase with the video presentation.<br>
The purpose of these calculations is to forecast the effective instant of presentation of the video relating to an image (time LSTC any multiple of 20 ms) so as to calculate the shift with the theoretical value PTS relating to the video for this image. This shift is then utilized to define the effective instant of presentation of the audio data.<br>
The audio PTS could also be used to initialize the VSTC and in this case the audio would be the master. This solution is not adopted since the frequency of presence of the PTSs in the audio frame is low.<br>
It may be observed that, if there is no discontinuity in the decoding procedure, the video decoding and the VSTC remain synchronous. It may be then be verified that VSTC = PTS on presentation of each image.<br>
Two types of imponderables may disturb the video decoding procedure:<br>
-	disturbances related to the stream read out<br>
from  the  disc  may  give  rise  to  delays  in  the<br>
presentation of certain images or else forward jumps<br>
following  the  reinitialization  of  the  decoder  and<br>
following the loss of data.<br>
-	the execution of "trick-modes" called for by<br>
the  application  {term  used  in  the  standard  and<br>
corresponding to special modes of operation such as<br><br>
- 17 -<br>
freeze frame, etc.} during which the LSTC is no longer meaningful.<br>
In all cases, it is advisable to reinitialize the VSTC as on start-up or by saving a fallback value (the case of a pause).<br>
The  offset  must  be  regularly  re-updated (slippage of the clock LSTC relative to the PTS which is synchronized with the PCR) . The image period could be taken as refresh period.<br>
The start-up of the decoding of the audio is more immediate than that of the video. It is sufficient to take the VSTC into account in order to know when to start. It is of course necessary to wait for the VSTC to be initialized by the video.<br>
Insofar as one is certain that the VSTC remains properly synchronous with the decoding of the video, the synchronizing of the audio with the video is carried out entirely naturally by the slaving thereof to the VSTC. It may however happen that the audio decoder is not synchronous with the 27 MHz reference clock which regulates the video decoder, but with an independent clock. The audio decoder must in this case be slaved to the VSTC.<br>
Of course, the MPEG decoder and the hard disc have been presented integrated within a satellite decoder. These elements or one of these elements could just as easily form part of a digital television receiver receiving the compressed data.<br>
The incoming stream is described as being a program stream PS. It can also, without departing from the field of the invention, pertain to a transport stream TS.<br><br>
18 We Claim<br>
1.	Process   for   synchronizing    an   MPEG   decoder   for   the   decoding   of<br>
compressed  data  originating  from  a  recording   medium   (4),  the data<br>
consisting of PES  (Packetized Elementary Stream) audio and video data<br>
packets, comprising the steps of:<br>
-	calculating an actual instant of presentation Tpres of the video of<br>
an Image, this instant relating to a local clock LSTC,<br>
-	calculating an offset STCO between this calculated instant under<br>
presentation and the PTS label corresponding to the hstant under<br>
presentation desired by the coder for the video of the image, so as<br>
to define a virtual clock VSTC=STCO + LSTC,<br>
-	presenting the video and of the audio corresponding to this image<br>
at the PTS dates relating to the virtual clock VSTC.<br><br>
2.	The process as claimed in claim 1, wherein the time of transit of the video<br>
through buffer of the video decoder is imposed at a predetermined value<br>
TVBV.<br>
3.	The  process  as claimed  m claim  2, wherein determining the TVBV  is<br>
dependent on the bit rate of recordfrig of the PES data on the recordsig<br>
medium.<br>
4.	The  process as claimed  In claim  2, wherein determining the TVBV  is<br>
dependent on the VBV_delay.<br><br>
19<br>
5.	The process as claimed in claim 1, wherein the offset is dependent on the<br>
duration of decoding of the image (TDEC), rounded to a higher number of<br>
frame periods.<br>
6.	The  process  as claimed  in  claim   1, wherein  the calculated  offset is<br>
pincremented by one frame period (TVSYNC).<br>
7.	The process as cteimed in claim 2, wherein the offset STCO is equal to:<br>
STCO = PTS - TVBV - TVSYNC - (TimeRef x 40 ms) - TDEC - LSTCpic<br>
where:<br>
TVSYNC corresponds to a frame period,<br>
TDEC corresponds to the duration of decoding of the image rounded to a higher number of frame periods,<br>
TimeRef   represents   the   temporal   reference   of   the   image   for   the reordering,<br>
LSTCpic relates to the instant of detection of the first image.<br>
8.	The process as claimed in claim 1, whereh the virtual clock VSTC is re-<br>
updated on start-up, when executing "trick-modes" or on reinitialization of<br>
the video decoder.<br>
9.	The process as claimed in claim 1, wherein the virtual clock VSTC is re-<br>
updated with each image.<br><br>
20<br>
10.	The process as claimed in claim 1, wherein for reading data in shifted<br>
mode  (time shifting), the data being recorded on the basis of a write<br>
pointer, the recorded data being read in shifted time on the bass of a<br>
read pointer, wherein a minimum gap (11) is imposed between the read<br>
and  write pointer, and whereh when this gap  is achieved, the freeze<br>
mode of the decoder is actuated.<br>
11.	Device for synchronizing an MPEG decoder (7, 8) to a recorded MPEG<br>
stream, the recorded data consisting of PES data packets, characterized<br>
by comprising: means for calculating an offset STCO to be applied to the<br>
focal clock LSTC of the decoder so as to define a virtual clock VSTC, the<br>
offset being equal to the difference between the instant of presentation<br>
Tpres of the video of an image, as calculated in the LSTC tag, and the PTS<br>
value of presentation of the image originatng from the coder and the<br>
decoding of the audio and video data are carried out when the vrtuat<br>
clock VSTC is equal to the corresponding PTS value.<br>
12.	Satellite decoder characterized by comprisfrig an MPEG decoder (7, 8) and<br>
a synchronization device as claimed in claim 11.<br>
13.Television receiver, characterized by comprising an MPEG decoder (7, 8) and a synchronization device as claimed in claim 11.<br>
This invention relates to a Process for synchronizing an MPEG decoder for the decoding of compressed data originating from a recording medium (4), the data consisting of PES (Packetized Elementary Stream) audio and video data packets, comprising: calculating an actual hstant of presentation Tpres of the video of an image, this instant relatinig to a local clock LSTC, calculating an offset STCO between this calculated instant under presentation and the PTS label corresponding to the instant under presentation desired by the coder for the video of the image, so as to define a virtual clock VSTC=STCO + LSTC, presenting the video and of the audb corresponding to this image at the PTS dates relating to the virtual clock VSTC.<br><br></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDA0MzUtY2FsLTIwMDAtYWJzdHJhY3QucGRm" target="_blank" style="word-wrap:break-word;">00435-cal-2000-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDA0MzUtY2FsLTIwMDAtY2xhaW1zLnBkZg==" target="_blank" style="word-wrap:break-word;">00435-cal-2000-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDA0MzUtY2FsLTIwMDAtY29ycmVzcG9uZGVuY2UucGRm" target="_blank" style="word-wrap:break-word;">00435-cal-2000-correspondence.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDA0MzUtY2FsLTIwMDAtZGVzY3JpcHRpb24oY29tcGxldGUpLnBkZg==" target="_blank" style="word-wrap:break-word;">00435-cal-2000-description(complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDA0MzUtY2FsLTIwMDAtZHJhd2luZ3MucGRm" target="_blank" style="word-wrap:break-word;">00435-cal-2000-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDA0MzUtY2FsLTIwMDAtZm9ybS0xLnBkZg==" target="_blank" style="word-wrap:break-word;">00435-cal-2000-form-1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDA0MzUtY2FsLTIwMDAtZm9ybS0xOC5wZGY=" target="_blank" style="word-wrap:break-word;">00435-cal-2000-form-18.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDA0MzUtY2FsLTIwMDAtZm9ybS0yLnBkZg==" target="_blank" style="word-wrap:break-word;">00435-cal-2000-form-2.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDA0MzUtY2FsLTIwMDAtZm9ybS0yNi5wZGY=" target="_blank" style="word-wrap:break-word;">00435-cal-2000-form-26.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDA0MzUtY2FsLTIwMDAtZm9ybS0zLnBkZg==" target="_blank" style="word-wrap:break-word;">00435-cal-2000-form-3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDA0MzUtY2FsLTIwMDAtZm9ybS01LnBkZg==" target="_blank" style="word-wrap:break-word;">00435-cal-2000-form-5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDA0MzUtY2FsLTIwMDAtbGV0dGVycyBwYXRlbnQucGRm" target="_blank" style="word-wrap:break-word;">00435-cal-2000-letters patent.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDA0MzUtY2FsLTIwMDAtcHJpb3JpdHkgZG9jdW1lbnQgb3RoZXJzLnBkZg==" target="_blank" style="word-wrap:break-word;">00435-cal-2000-priority document others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDA0MzUtY2FsLTIwMDAtcHJpb3JpdHkgZG9jdW1lbnQucGRm" target="_blank" style="word-wrap:break-word;">00435-cal-2000-priority document.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDA0MzUtY2FsLTIwMDAtcmVwbHkgZi5lLnIucGRm" target="_blank" style="word-wrap:break-word;">00435-cal-2000-reply f.e.r.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NDM1LUNBTC0yMDAwLUZPUk0tMjcucGRm" target="_blank" style="word-wrap:break-word;">435-CAL-2000-FORM-27.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="207096-a-stator-for-an-electric-ceiling-fan-motor.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="207098-washing-machine.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>207097</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>435/CAL/2000</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>21/2007</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>25-May-2007</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>23-May-2007</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>31-Jul-2000</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>THOMSON MULTIMEDIA</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>46,QUAI A.LE GALLO ,F-92100 BOULOGNE-BILLANCOURT</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>CHAPEL CLAUDE</td>
											<td>20 RUE CAMILLE PELLETAN F-35200 RENNES:</td>
										</tr>
										<tr>
											<td>2</td>
											<td>ABELARD FRANK</td>
											<td>20 RUE CHATEAUBRIAND ,F-35220 CHATEAUBOURG</td>
										</tr>
										<tr>
											<td>3</td>
											<td>GUILLEMOT JEAN CHARLES</td>
											<td>40 AVENUE ANNE DE BRETAGNE ,F-35235 THORIGNE FOUILLARD</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H 04 N 7/52</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>N/A</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td></td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>9910466</td>
									<td>1999-08-13</td>
								    <td>France</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/207097-process-and-device-for-synchronizing-an-mpeg-decoder by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 02:23:02 GMT -->
</html>
