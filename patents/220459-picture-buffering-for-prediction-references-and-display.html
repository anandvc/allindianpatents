<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/220459-picture-buffering-for-prediction-references-and-display by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 10:43:26 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 220459:PICTURE BUFFERING FOR PREDICTION REFERENCES AND DISPLAY</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">PICTURE BUFFERING FOR PREDICTION REFERENCES AND DISPLAY</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>The invention relates to an encoder for forming an encoded picture stream. The pictures are defined as reference pictures or non-reference pictures, and information relating to decoding order and output order of a picture is defined for pictures of the picture stream. The encoder is arranged to form to the bitstream an indication of such a number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures. The invention also relates to a signal, hypothetical encoder, decoder, hypothetical decoder, electronic device, system, software program and a storage medium.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td> <br><br>
Picture buffering for prediction references and display<br>
Field of the Invention<br>
The present invention relates to a picture buffering for prediction references and display, the method consisting of an encoding step for forming encoded pictures in an encoder, an optional hypothetical decoding step for decoding said encoded pictures in the encoder, a transmission step for transmitting said encoded pictures to a decoder, a decoding step for decoding the encoded pictures for forming decoded pictures, and rearranging step for arranging the decoded pictures in displaying order.<br>
Background of the Invention<br>
Published video coding standards include ITU-T H.261, ITU-T H.263, ISO/IEC MPEG-1, ISO/IEC MPEG-2, and ISO/IEC MPEG-4 Part 2. These standards are herein referred to as conventional video coding standards.<br>
There is a standardization effort going on in a Joint Video Team (JVT) of ITU-T and ISO/IEC. The work of JVT is based on an earlier standardization project in ITU-T called H.26L. The goal of the JVT standardization is to release the same standard text as ITU-T Recommendation H.264 and ISO/IEC International Standard 14496-10 (MPEG-4 Part 10). The draft standard is referred to as the JVT coding standard in this paper, and the codec according to the draft standard is referred to as the JVT codec.<br>
The optional reference picture selection mode of H.263 and the NEWPRED coding tool of MPEG-4 Part 2 enable selection of the reference frame for motion compensation per each picture segment, e.g., per each slice in H.263. Furthermore, the optional Enhanced Reference Picture Selection mode of H.263 and the JVT coding standard enable selection of the reference frame for each macroblock separately.<br><br>
Reference picture selection enables many types of temporal scalability schemes. Figure 1 shows an example of a temporal scalability scheme, which is herein referred to as recursive temporal scalability. The example scheme can be decoded with three constant frame rates. Figure 2 depicts a scheme referred to as Video Redundancy Coding, where a sequence of pictures is divided into two or more independently coded threads in an interleaved manner. The arrows in these and all the subsequent figures indicate the direction of motion compensation and the values under the frames correspond to the relative capturing and displaying times of the frames.<br>
In conventional video coding standards, the decoding order of pictures is the same as the display order except for B pictures. A block in a conventional B picture can be bi-directionally temporally predicted from two reference pictures, where one reference picture is temporally preceding and the other reference picture is temporally succeeding in display order. Only the latest reference picture in decoding order can succeed the B picture in display order (exception: interlaced coding in H.263 where both field pictures of a temporally subsequent reference frame can precede a B picture in decoding order). A conventional B picture cannot be used as a reference picture for temporal prediction, and therefore a conventional B picture can be disposed without affecting the decoding of any other pictures.<br>
The  JVT  coding   standard   includes  the  following   novel  technical<br>
features compared to earlier standards:<br>
The decoding order of pictures is decoupled from the display order. The picture number indicates decoding order and the picture order count indicates the display order. Reference pictures for a block in a B picture can either be before or after the B picture in display order. Consequently, a B picture stands for a  bi-predictive picture  instead  of a  bi-directional<br>
picture.<br>
Pictures that are not used as reference pictures are marked explicitly. A picture of any type (intra, inter, B, etc.) can either be a reference picture or a non-reference picture. (Thus, a B picture<br><br>
can be used as a reference picture for temporal prediction of other pictures.)<br>
A picture can contain slices that are coded with a different coding type. In other words, a coded picture may consist of an intra-coded slice and a B-coded slice, for example.<br>
Decoupling of display order from decoding order can be beneficial from compression efficiency and error resiliency point of view.<br>
An example of a prediction structure potentially improving compression efficiency is presented in Figure 3. Boxes indicate pictures, capital letters within boxes indicate coding types, numbers within boxes are picture numbers according to the JVT coding standard, and arrows indicate prediction dependencies. Note that picture B17 is a reference picture for pictures B18. Compression efficiency is potentially improved compared to conventional coding, because the reference pictures for pictures B18 are temporally closer compared to conventional coding with PBBP or PBBBP coded picture patterns. Compression efficiency is potentially improved compared to conventional PBP coded picture pattern, because part of reference pictures are bi-directionally predicted.<br>
Figure 4 presents an example of the intra picture postponement method that can be used to improve error resiliency. Conventionally, an intra picture is coded immediately after a scene cut or as a response to an expired intra picture refresh period, for example. In the intra picture postponement method, an intra picture is not coded immediately after a need to code an intra picture arises, but rather a temporally subsequent picture is selected as an intra picture. Each picture between the coded intra picture and the conventional location of an intra picture is predicted from the next temporally subsequent picture. As Figure 4 shows, the intra picture postponement method generates two independent inter picture prediction chains, whereas conventional coding algorithms produce a single inter picture chain. It is intuitively clear that the two-chain approach is more robust against erasure errors than the one-chain conventional approach. If one chain suffers from a packet  loss,  the  other chain  may  still  be  correctly  received.   In<br><br>
conventional coding, a packet loss always causes error propagation to the rest of the inter picture prediction chain.<br>
In the JVT coding standard, decoded pictures have to be buffered for two reasons: First, decoded pictures are used as reference pictures for predicting subsequent coded pictures. Second, due to decoupling of the decoding order from the-display order, decoded pictures have to be reordered in display order.<br>
The following example is used to explain the problem of separate buffering the present invention overcomes.<br>
i<br>
Consider the following sequence of pictures, where P is a predicted picture, BS a reference bi-predictive picture, and BN a non- reference bi-predictive picture, and the number relates to display order:<br>
Display order      P1     BN2  BN3  BS4   BN5  BN6  P7... Decoding order   PI     P7    BS4  BN2  BN3  BN5  BN6<br>
This can be decoded with three picture memories in the reference picture buffer, but when BN5 is decoded, it is not yet time to display it:<br>
Decoded time      P1     P7    BS4   BN2  BN3  BN5  BN6<br>
Display time	P1     BN2  BN3  BS4   BN5   BN6   P7...<br>
Therefore BN5 has to be stored to reorder pictures in display order.<br>
The problem does not exist in conventional video coding standards, because the display order for all reference pictures is the same as their decoding order and because only the latest decoded reference picture has to be buffered to reorder pictures in display order if B pictures are in use. The conventional video coding standard supporting reference picture selection have a reference picture buffer but they do not have a picture buffer for display reordering.<br>
The following straightforward proposal was proposed for the JVT coding standard: Have a picture buffer for reference pictures that is<br><br>
separate from a picture buffer for display reordering. Specify the maximum number of pictures separately for both buffers.<br>
Let us reconsider the above described example again. A reference picture enters the reference picture buffer as soon as it is decoded. A non-reference picture does not enter the reference picture buffer. A decoded picture is removed from the reference picture buffer as soon as it is no longer needed for reference. For example, picture P1 can be removed after decoding of picture BN3. A picture enters the display reordering buffer as soon as it is decoded. A decoded picture is removed from the display reordering buffer when it can be displayed. The figure below shows the contents of the buffers just after decoding each picture.<br>
Decoded time    P1     P7 Display time Reference buf   PI     PI<br>
BS4 BN2 BN3	BN5	BN6<br>
P1  BN2	BN3	BS4 BN5 BN6. P7<br>
P1  P1  BS4	BS4	P7<br>
P7  BS4	BS4	P7  P7<br>
Display buf	PI<br>
P7	P7<br>
P1  BS4 BS4	BS4	BN5 BN6 P7<br>
P7  P7	P7	P7  P7  P7<br>
It can be seen that the required sizes of the reference picture buffer and the display reordering buffer are 3 pictures and 2 pictures respectively.<br>
Summary of the Invention<br>
In the present invention the reference picture buffer and the display picture buffer are combined, wherein both the reference pictures and the pictures to be reordered are stored in the same buffer to avoid the need to store the same picture in two different places.<br>
The present invention provides a hypothetical decoder, signal, encoder, decoder, method, device, system and computer program for use in any kind of network device and terminal device, wherein the same buffer can be used to store at the decoder both the reference<br><br>
pictures and the pictures waiting to be displayed. Furthermore, the pictures are not stored twice in the memory.<br>
In one embodiment of the present invention the usability of the unified buffering is further increased by defining an attribute for the number of pictures waiting for reordering in the buffer. The attribute num_reorder_frames is the number of consecutive frames in decoding order that is required to recover the output order of pictures at any time. The sum of the maximum number of reference frames stored in the unified buffer and the maximum number of the pictures to be reordered for displaying, excluding those pictures which already are stored as reference pictures, is set smaller than or equal to the current capacity of the unified buffer. This means that the buffer can not overflow, therefore it is not necessary to test it. Instead, an optional Hypothetical Reference Decoder (HRD) can check that no picture is removed from the buffer before its output time stamp.<br>
According to one aspect of the present invention there is provided a hypothetical decoder for hypothetical^ decoding an encoded picture stream, the pictures being defined as reference pictures or non-reference pictures, and information relating to decoding order and output order of a picture is defined for pictures of the picture stream. The hypothetical decoder is primarily characterized in that the hypothetical decoder comprises a unified picture buffer for buffering reference pictures and pictures to be reordered, and that the hypothetical decoder comprises the following:<br>
a processing block for performing the following before inserting a newly decoded picture to the buffer,<br>
examining if the newly decoded picture can be inserted in the<br>
buffer without removing another picture from the buffer,<br>
on the basis of said examination, if the newly decoded picture<br>
cannot be inserted in the buffer without removing another picture<br>
from the buffer, selecting a picture to be removed from those<br>
pictures in the buffer which are not used as reference pictures<br>
and which have already been output from the buffer,<br>
if a picture was selected, removing the selected picture from the<br>
buffer.<br><br>
According to another aspect of the present invention there is provided a signal containing an encoded picture stream, the pictures being defined as reference pictures or non-reference pictures, and information relating to decoding order and output order of a picture is defined for pictures of the picture stream. The signal is primarily characterized in that the signal contains at least a first reference picture and a second reference picture, that the first reference picture precedes the second reference picture in decoding order and the second reference picture precedes the first reference picture in output order, and that the signal contains an indication of such a number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures.<br>
According to a third aspect of the present invention there is provided an encoder for forming an encoded picture stream, the pictures being defined as reference pictures or non-reference pictures, and information relating to decoding order and output order of a picture is defined for pictures of the picture stream. The signal is primarily characterized in that the encoder is arranged to include to the picture stream at least a first reference picture and a second reference picture, the first reference picture preceding the second reference picture in decoding order and the second reference picture preceding the first reference picture in output order, and that the encoder is arranged to form to the picture stream an indication of such a number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures.<br>
According to a fourth aspect of the present invention there is provided an encoder comprising a hypothetical decoder for hypothetical^ decoding an encoded picture stream, the pictures being defined as reference pictures or non-reference pictures, and information relating to decoding order and output order of a picture is defined for pictures of the picture stream. The encoder is primarily characterized in that the encoder comprises a unified picture buffer for buffering reference . pictures and pictures to be reordered, and that the hypothetical decoder comprises the following:<br><br>
a processing block for performing the following before inserting a newly<br>
decoded picture to the buffer,<br>
examining if the newly decoded picture can be inserted in the<br>
buffer without removing another picture from the buffer,<br>
on the basis of said examination, if the newly decoded picture<br>
cannot be inserted in the buffer without removing another picture<br>
from the buffer, selecting a picture to be removed from those<br>
pictures in the buffer which are not used as reference pictures<br>
and which have already been output from the buffer,<br>
if a picture was selected, removing the selected picture from the<br>
buffer, otherwise indicating an error.<br>
According to a fifth aspect of the present invention there is provided a method for forming an encoded picture stream comprising defining the pictures as reference pictures or non-reference pictures, and defining information relating to decoding order and output order of a picture for pictures of the picture stream. The method is primarily characterized in that the method comprises:<br>
-	including the signal with at least a first reference picture and a second reference picture so that the first reference picture precedes the second reference picture in decoding order and the second reference picture precedes the first reference picture in output order, and<br>
-	defining an indication of such a number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures to the picture stream.<br>
According to a sixth aspect of the present invention there is provided a method for buffering decoded pictures, the pictures being defined as reference pictures or non-reference pictures, the size of the buffer is defined, and the number of reference pictures in the buffer is defined. The method is primarily characterized in that a unified picture buffer is used for buffering both prediction references and decoded pictures for arranging them in output order.<br>
According to a seventh aspect of the present invention there is provided a decoder including means for buffering decoded pictures, the<br><br>
pictures being defined as reference pictures or non-reference pictures, the size of the buffer is defined, and the number of reference pictures in the buffer is defined. The decoder is primarily characterized in that the decoder comprises an input for inputting a signal which contains at least a first reference picture and a second reference picture, that the first reference picture precedes the second reference picture in decoding order and the second reference picture precedes the first reference picture in output order, and the signal further contains at least an indication of such a number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures, and that the means for buffering includes a unified picture buffer for buffering both prediction references and decoded pictures for arranging them in output order, wherein the decoder comprises a definer for defining the size of the unified picture buffer on the basis of said indication.<br>
According to a eighth aspect of the present invention there is provided a software program comprising machine executable steps for forming an encoded picture stream, the pictures being defined as reference pictures or non-reference pictures, and information relating to decoding order and output order of a picture is defined for pictures of the picture stream,. The software program is primarily characterized in that the software program comprises machine executable steps for including the signal with at least a first reference picture and a second reference picture so that the first reference picture precedes the second reference picture in decoding order and the second reference picture precedes the first reference picture in output order, and for forming to the picture stream an indication of such a number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures.<br>
According to a ninth aspect of the present invention there is provided a software program comprising machine executable steps for hypothetically decoding an encoded picture stream, the pictures being defined as reference pictures or non-reference pictures, and information relating to decoding order and output order of a picture is defined for pictures of the picture stream. The software program is<br><br>
primarily characterized in that the software program comprises machine executable steps for buffering reference pictures and pictures to be reordered in a unified picture buffer, and that the software program further comprises the following:<br>
machine executable steps for performing the following before inserting a newly decoded picture to the buffer,<br>
examining if the newly decoded picture can be inserted in the buffer without removing another picture from the buffer, on the basis of said examination, if the newly decoded picture cannot be inserted in the buffer without removing another picture from the buffer, selecting a picture to be removed from those pictures in the buffer which are not used as reference pictures<br>
i<br>
and which have already been output from the buffer, if a picture was selected, removing the selected picture from the buffer, otherwise indicating an error.<br>
According to a tenth aspect of the present invention there is provided a storage medium for storing a software program comprising machine executable steps for forming an encoded picture stream, the pictures being defined as reference pictures or non-reference pictures, and information relating to decoding order and output order of a picture is defined for pictures of the picture stream. The storage medium is primarily characterized in that the software program comprises machine executable steps for including the signal with at least a first reference picture and a second reference picture so that the first reference picture precedes the second reference picture in decoding order and the second reference picture precedes the first reference picture in output order, and for forming to the bitstream an indication of such a number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures.<br>
According to a eleventh aspect of the present invention there is provided an electronic device comprising a decoder including means for buffering decoded pictures, the pictures being defined as reference pictures or non-reference pictures, the size of the buffer is defined, and the number of reference pictures in the buffer is defined. The electronic device is primarily characterized in that the electronic device comprises<br><br>
an input for inputting a signal which contains at least a first reference picture and a second reference picture, that the first reference picture precedes the second reference picture in decoding order and the second reference picture precedes the first reference picture in output order, and the signal further contains at least an indication of such a number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures, and that the means for buffering includes a unified picture buffer for buffering both prediction references and decoded pictures for arranging them in output order, wherein the decoder comprises a definer for defining the size of the unified picture buffer on the basis of said indication.<br>
According to a twelth aspect of the present invention there is provided a system comprising an encoder for forming a signal containing an encoded picture stream, the pictures being defined as reference pictures or non-reference pictures, and information relating to decoding order and output order of a picture is defined for pictures of the picture stream, a transmission channel for transmitting the signal to a decoder, the decoder including means for buffering decoded pictures. The system is primarily characterized in that system comprising an encoder for forming a signal containing an encoded picture stream, the pictures being defined as reference pictures or non-reference pictures, and information relating to decoding order and output order of a picture is defined for pictures of the picture stream, a transmission channel for transmitting the signal to a decoder, the decoder including means for buffering decoded pictures.<br>
The invention solves the decoded picture buffering problem in the JVT coding standard that did not exist in conventional video coding standards. The invention saves memory compared to the other solution proposed for the JVT coding standard. The advantage that the memory needed for buffering the pictures can be minimized is a significant advantage in small devices like mobile terminals.<br>
Description of the Drawings<br><br>
1	shows an  example  of  a  recursive  temporal  scalability<br>
scheme,<br><br>
Fig. 2	depicts a scheme referred to as Video Redundancy Coding,<br>
where a sequence of pictures is divided into two or more independently coded threads in an interleaved manner,<br>
Fig. 3        presents an example of a prediction structure potentially improving compression efficiency,<br>
Fig. 4        presents an example of the intra picture postponement method that can be used to improve error resiliency,<br>
Fig. 5	depicts   an   advantageous   embodiment   of   the   system<br>
according to the present invention,<br>
Fig. 6	depicts   an   advantageous   embodiment   of  the   encoder<br>
according to the present invention,<br>
Fig. 7        depicts  an   advantageous  embodiment  of  the   decoder according to the present invention,<br>
Detailed Description of the Invention<br>
In the unified buffer solution all decoded pictures stay in the unified buffer until they are no longer used as reference pictures and until their display order comes. The unified buffer saves memory compared to separate picture buffers for reference pictures and for reordering in display order.<br>
Let us reconsider the previous example again when a unified buffer is in use.<br>
Decoded time    P1     PI     BS4   BN2   BN3   BN5   BN6<br>
Display time	P1     BN2  BN3  BS4   BN5  BN6  P7<br>
Unified buffer     PI     PI     PI     P1     BS4  BS4   BN6  P7<br>
P7  BS4 BS4 P7  BN5 P7 P7  P7      P7<br><br>
However, there are some matters which should be taken into account in the unified buffer solution. The size of the buffer should be set big enough to store all the pictures which are still needed, i.e. all reference pictures and pictures to be reordered. The memory capacity is often limited so the size of the buffer is some kind of compromise. The encoder has to check that the decoder is able to store enough pictures to decode and output all pictures without errors. This check can be performed by an optional Hypothetical Reference Decoder (HRD) in the encoding device. The HRD comprises a coded picture buffer for storing coded data stream and a decoded picture buffer for storing decoded reference pictures and for reordering decoded pictures in display .order. The HRD moves data between the buffers similarly to the decoder of an decoding device does. However, the HRD need not decode the coded pictures entirely nor output the decoded pictures, but the HRD only checks that the decoding of the picture stream can be performed under the constraints given in the coding standard. When the HRD is operating, it receives a coded data stream and stores it to the coded picture buffer. In addition, the HRD removes coded pictures from the coded picture buffer and stores at least some of the corresponding hypothetically decoded pictures into the decoded picture buffer. The HRD is aware of the input rate according to which the coded data flows into the coded picture buffer, the removal rate of the pictures from the coded picture buffer, and the output rate of the pictures from the decoded picture buffer. The HRD checks for coded or decoded picture buffer overflows, and it indicates if the decoding is not possible with the current settings. Then the HRD informs the encoder about the buffering violation wherein the encoder can change the encoding parameters by, for example, reducing the number of reference frames, to avoid buffering violation. Alternatively or additionally, the encoder starts to encode the pictures with the new parameters and sends the encoded pictures to the HRD which again performs the decoding of the pictures and the necessary checks. As a yet another alternative, the encoder may discard the latest encoded frame and encode later frames so that no buffering violation happens.<br>
Slice-based Operation<br><br>
The minimum recommended unit to encapsulate in a transmission packet is a slice or a data partition. The minimum relatively independently decodable unit is a slice. Consequently, the unified buffering model assumes that a whole slice or a whole data partition is transmitted at a time. The model also assumes that packet-based networks and transmission protocols are used, and therefore a whole slice or a whole data partition is received at a time.<br>
It is assumed that one slice is being decoded at a time. Thus, data is removed from the hypothetical input buffer slice by slice. The proposed complexity model is used to determine the time needed to virtually decode a slice. When that time is expired, the next slice can be virtually decoded.<br>
Overview of the Buffering Model of the present invention<br>
The reference decoder is based on a buffer model presented in this section. The model is based on three buffers: the pre-decoder buffer, the decoding buffer, and the post decoder buffer. The pre-decoder buffer buffers compressed data. The operation of the decoding buffer represents the operation of a real decoder and sets the processing complexity constraints. The post-decoder buffer contains reconstructed pictures that are used for reference picture for motion compensation and/or wait for a correct moment to be virtually displayed.<br>
The default buffer sizes are given in the profile and level definitions. The buffer sizes can also be negotiated. The size of the decoding buffer gives the maximum size of a slice. The size of the post-decoder buffer can be given in bytes or in units of 16x16 pixels, for example.<br>
The operation of the pre- and post-decoder buffer can be controlled by two parameters. The initial pre-decoder buffering period and the initial post-decoder buffering period define how long the buffers are filled in before any data is removed from them. The periods are signalled for each bit-stream separately.<br><br>
Three time-stamps can be associated for a data unit (a data partition, a slice, or a picture). Each slice and data partition is associated with a transmission time. In case of file access, the transmission time is indicated in the file. Otherwise, the real transmission time is used. Each slice can be associated with a decoding time. The decoding time can be used to delay decoding of a slice in order to avoid overflows of the post-decoder buffer. Each picture is associated with a display time.<br>
Time-related parameters are given in a common time-scale,. Such as clock ticks of a 90 kHz or a 27 MHz clock.<br>
The model can be applied to any continuous and independently decidable part of a coded bit-stream. In case of discontinuities, such as accessing a bit-stream from a random position, the model is reset.<br>
Operation of the Buffering Model<br>
The model is defined as follows:<br>
1.	The buffers are initially empty.<br>
2.	A slice or a data partition, excluding its real header, is added to the pre-decoder buffer at its transmission time. A certain amount of memory, for example eight bytes, of additional memory is reserved for each slice to store its header. (Actual slice headers may be closely linked with some payload header specific data, such as the parameter set indicator in the draft RTP payload format (VCEG-N72R1). It is impractical to remove this kind of data from header portion of the slice for HRD purposes only. Thus, a constant size of the slice header is assumed.)<br>
3.	No data is removed from the pre-decoder buffer during a period called the initial pre-decoder buffering period. The period starts when the first slice or data partition is added to the buffer.<br>
4.	When the initial pre-decoder buffering period has expired and if decoding time-stamps are in use, the decoding timer is started from the<br><br>
decoding time of the earliest picture in the picture buffer. Otherwise, no decoding timer is needed.<br>
5.	Pictures are removed from the pre-decoder buffer slice by slice in ascending order of picture identifiers (using modulo arithmetic). Slices of a particular picture are removed in their transmission order. A slice, including its data partitions, is moved from the pre-decoder buffer to the decoding buffer at one time when the decoding buffer becomes empty. However, a slice is not removed from the pre-decoder buffer before the decoding timer reaches the decoding time of the slice.<br>
6.	A slice remains in the decoding buffer as long as its calculated decoding duration. The duration is the larger one of the two candidates: candidate 1 = number of macroblocks in a slice / maxMacroblockPerSec  and  candidate 2  =  number of bits in a slice / maxBitsPerSec.<br>
7.	An uncompressed picture enters the post-decoder buffer when the last slice (in the decoding order) of the corresponding coded picture is removed from the decoding buffer.<br>
8.	Data is not removed from the post-decoder buffer during a period called the initial post-decoder buffering period. The period starts when the first picture has been placed into the post-decoder buffer.<br>
9.	When the initial post-decoder buffering period has expired, the playback timer is started from the earliest display time of the pictures residing in the post-decoder buffer at that time.<br><br>
10.	A picture is virtually displayed when the playback timer reaches the scheduled display time of the picture.<br>
11.	A picture is removed from the post-decoder buffer when it is virtually displayed and when it is no longer needed as a reference picture.<br>
Requirements for a Compliant Bit-Stream<br><br>
Any transmitted or stored bit-stream shall comply with the following requirements:<br>
The occupancy of the pre-decoder buffer shall not exceed<br>
the default or signalled buffer size.<br>
Any slice shall not be larger than the size of the decoding<br>
buffer.<br>
The occupancy of the post-decoder buffer shall not exceed<br>
the default or signalled buffer size.<br>
Each picture shall be inserted into the post-decoder buffer<br>
before or on its display time.<br>
When the default buffer sizes according to a certain profile and level are used, a bit-stream is compliant with this profile and level.<br>
Requirements for a Compliant Decoder<br>
A decoder shall be capable of receiving and decoding all the pictures in a compliant bit-stream when the same buffer sizes are assumed both in the decoder and in the bit-stream. Furthermore, the decoder shall pass each picture to a display process at the same time when the hypothetical reference decoder would display the picture virtually.<br>
In the following the invention will be described in more detail with reference to the system of Fig. 5, the encoder 1 and hypothetical reference decoder (HRD) 5 of Fig. 6 and decoder 2 of Fig. 7. The pictures to be encoded can be, for example, pictures of a video stream from a video source 3, e.g. a camera, a video recorder, etc. The pictures (frames) of the video stream can be divided into smaller portions such as slices. The slices can further be divided into blocks. In the encoder 1 the video stream is encoded to reduce the information to be transmitted via a transmission channel 4, or to a storage media (not shown). Pictures of the video stream are input to the encoder 1. The encoder has an encoding buffer 1.1 (Fig. 6) for temporarily storing some of the pictures to be encoded. The encoder 1 also includes a memory 1.3 and a processor 1.2 in which the encoding tasks according to the invention can be applied. The memory 1.3 and the processor 1.2<br><br>
can be common with the transmitting device 6 or the transmitting device 6 can have another processor and/or memory (not shown) for other functions of the transmitting device 6. The encoder 1 performs motion estimation and/or some other tasks to compress the video stream. In motion estimation similarities between the picture to be encoded (the current picture) and a previous and/or latter picture are searched. If similarities are found the compared picture or part of it can be used as a reference picture for the picture.to be encoded. In JVT the display order and the decoding order of the pictures are not necessarily the same, wherein the reference picture has to be stored in a buffer (e.g. in the encoding buffer 1.1) as long as it is used as a reference picture. The encoder 1 also inserts information on display order of the pictures into the transmission stream.<br>
From the encoding process the encoded pictures are moved to an optional encoded picture buffer 1.5, if necessary. The encoded pictures are transmitted from the encoder 1 to the decoder 2 via the transmission channel 4. In the decoder 2 the encoded pictures are decoded to form uncompressed pictures corresponding as much as possible to the encoded pictures. Each decoded picture is buffered in the DPB 2.1 of the decoder 2 unless it is displayed substantially immediately after the decoding and is not used as a reference picture. In the system according to the present invention both the reference picture buffering and the display picture buffering are combined and they use the same decoded picture buffer 2.1. This eliminates the need for storing the same pictures in two different places thus reducing the memory requirements of the decoder 2.<br>
The decoder 1 also includes a memory 2.3 and a processor 2.2 in which the decoding tasks according to the invention can be applied. The memory 2.3 and the processor 2.2 can be common with the receiving device 8 or the receiving device 8 can have another processor and/or memory (not shown) for other functions of the receiving device 8.<br>
Let us now consider the encoding-decoding process in more detail. Pictures from the video source 3 are entered to the encoder 1 and<br><br>
advantageously stored in the encoding buffer 1.1. The encoding process is not necessarily started immediately after the first picture is entered to the encoder, but after a certain amount of pictures are available in the encoding buffer 1.1. Then the encoder 1 tries to find suitable candidates from the pictures to be used as the reference frames. The encoder 1 then performs the encoding to form encoded pictures. The encoded pictures can, for example, be predicted pictures (P), bi-predictive pictures (B), or intra-coded pictures (I). The intra-coded pictures can be decoded without using any other pictures, but other type of pictures need at least one reference picture before they can be decoded. Pictures of any of the above mentioned picture types can be used as a reference picture.<br>
The encoder attaches two time stamps to the pictures: a decoding time stamp (DTS) and output time stamp (OTS). The decoder can use the time stamps to determine the correct decoding time and time to output (display) the pictures. However, those time stamps are not necessarily transmitted to the decoder or it does not use them.<br>
If the encoder has the HRD 5, the encoder defines the size of the DPB 5.2 (DPB size). The initial size may depend on some parameters relating to the video stream (e.g. resolution, colour/BW, etc.). There can also be a maximum size defined for the DPB 5.2 (DPBcap'acity). The initial size may not necessarily be the same as the maximum size but it can also be smaller than the maximum size. Also the maximum number of reference frames stored in the DPB is defined. This value is referred as num_ref_frames in this description.<br>
In the decoder the DPB 2.1 has a limited size (DPB size) which in some applications may be varied during the decoding process, if necessary. The initial size of the DPB 2.1 may depend on some parameters relating to the video stream (e.g. resolution, colour/BW, etc.). There can also be a maximum size defined for the DPB 2.1 (DPBcapacity). The initial size may not necessarily be the same as the maximum size but it can also be smaller than the maximum size. Also the maximum number of reference frames stored in the DPB is defined. This value is referred as num_ref_frames in this description.<br><br>
The transmission and/or storing of the encoded pictures (and the optional virtual decoding) can be started immediately after the first encoded picture is ready. This picture is not necessarily the first one in decoder output order because the decoding order and the output order may not be the same. However, because the size of the DPB 2.1 of the decoder 2 is limited it is necessary to define how long the delay between decoding time of a picture and the display time of the picture can be at maximum, i.e. the maximum number of the pictures to be reordered for displaying. This value is referred as num__reorder_frames in this description. num_reorder_frames is the number of consecutive frames in decoding order that is required to recover the output order of pictures at any time. The sum of the maximum number of reference frames stored in the DPB and the maximum number of the pictures to be reordered for displaying, excluding those pictures which already are stored as reference pictures, must not be greater than the current capacity of the DPB. DPB size illustrates how many pictures can be stored in the DPB 2.1. It can be calculated by dividing the size of the DPB (in bytes) by the size of a picture (in bytes).<br>
When the first picture of the video stream is encoded the transmission can be started. The encoded pictures are optionally stored to the encoded picture buffer 1.5. The transmission can also start at a later stage, for example, after a certain part of the video stream is encoded.<br>
The decoder 2, 5 should output the decoded pictures in correct order, for example by using the ordering of the picture order counts, and hence the reordering process need be defined clearly and normatively.<br>
Next, the operation of the decoder 2 according to an embodiment of the present invention will be described. The DPB 2.1 contains memory places for storing a number of pictures. Those places are also called as frame stores in this description. An attribute FrameStoreUsage is used here as the indicator of the reservation status of a frame store (in use/not in use). The value of FrameStoreUsage reflects the usage of current frame store. A first value (e.g. 0) means the frame store is empty and it can be overwritten safely. A second value (e.g. 1) means<br><br>
this is a frame store used for reference (but not for reordering), a third value (e.g. 2) means this is a frame store used for reordering (but not for reference). A fourth value (e.g. 3) means this is a frame store used for both reference and reordering. The initial value of FrameStoreUsage shall be the first value. It is also possible to use a separate, second attribute to define whether a picture is (virtually) displayed or not. It can have values "unused for output" or "used for output". A picture marked as "used for output" means the picture still stays in the DPB and waits for its turn to output. It shall be marked as "unused for output" as a result of outputting the picture. If the second attribute is used, only the first and second values would be used with the FrameStoreUsage, wherein the combination of the first and the second attribute gives the same information as the FrameStoreUsage with the four different value alternatives. It is also possible to define an attribute for the validity of a picture (valid/invalid). A picture is marked as "Invalid" if it is intentionally inserted in order to fill the detected gaps between neighbouring framejium. Otherwise, the picture is marked as "Valid", which may be correctly decoded or reconstructed by means of error concealments. The frame stores can also be uniquely indexed which implies the decoding order of the buffered pictures.<br>
In the beginning of the decoding procedure the status of all the frame stores is set to empty, or free. This is done by setting the FrameStoreUsage to the first value for all frame stores. The decoder 2 can also set the following variables to an initial value (e.g. 0): num_frames_in_use, which contains the number of frame stores used for either reference or output; num_frames_use_ref, which contains the number of frame stores used for reference; and num_frames_use_output, which contains the number of frame stores used for output.<br>
An additional frame store is used to save the newly decoded picture. The DPB plus the additional frame store is called the Extended DPB (EDPB).<br>
Step 1: Decoding<br><br>
The decoder 2 starts to decode the encoded pictures beginning from the picture having smallest decoding time stamp. When the picture is decoded it will be stored to the additional frame store. The picture to be decoded can either be a frame or a field. If it is a reference picture, the FrameStoreUsage is set to the fourth value, otherwise to the third value. It is labelled as "used for reordering" at first, because it cannot be determined whether the newly decoded picture needs reordering or not at this step without the information about the DPB.<br>
Step 2: Reordering<br>
Before the following steps, the decoder 2 needs to know if there is at least one more picture to be decoded and some information from the slice header of the next picture to be decoded.<br>
Step 2.1 If there is at least one more picture to be decoded and the number of frames to be reordered in DPB is less than num_reorder_frames, the decoder 2 does not output a picture. If the newly decoded picture is used for reference, then Step 3 will be executed, otherwise Step 4 will be executed.<br>
Step 2.2 If there is at least one more picture to be decoded and the number of frames to be reordered in DPB is equal to num_reorder_frames, the following conditions will be checked:<br>
The newly decoded picture is a frame.<br>
The additional frame store contains two fields.<br>
If a single field resides in the additional frame store, the next<br>
picture to be decoded is not its opposite parity of the same<br>
frame.<br>
If none of the above conditions is true, go to Step 1 to decode the opposite parity field of the same frame.<br>
Then, if at least one of the above conditions is true, the frame stores in DPB and the additional frame store will be looked through to find which picture needs to be output. The picture, which is the first picture in the<br><br>
output order among the pictures to be reordered in DPB and the additional frame store, shall be output. How to determine the first picture in the output order is described later. If the outputted picture is a field and the opposite parity field of the same frame is present, both fields are output. The output pictures should be marked as "unused for reordering".<br>
If the newly decoded picture is output and is not used for reference, then go to Step 1 to decode the next picture. If the newly decoded picture is used for reference (but not used for reordering), FrameStoreUsage is set to the second value (1) and the Step 3 follows. If the newly decoded picture is used for reordering (but not used for reference), FrameStoreUsage is set to a third value (2) and then go to Step 4 to store the picture for reordering. If the newly decoded picture is used both for reference and reordering, set FrameStoreUsage to the fourth value (3) and then go to Step 3.<br>
Step 2.3 If there are no more pictures to be decoded, all the pictures that are still marked as "used for reordering" shall be output in output order. Then the decoder stops working until there are more pictures to decode.<br>
Step 3: Marking picture as "unused for reference"<br>
If the newly decoded picture is a reference picture, "Sliding Window" or "Adaptive Memory Control" mechanism is applied to the frame store set consisting of pictures marked as "used for reference".<br>
Step 4: Storing<br>
If the newly decoded picture is a frame, the step 4.1 will be performed, otherwise the step 4.2.<br>
Step 4.1 There should be at least one empty frame store in the DPB 2.1 before storing the newly decoded frame. FrameStoreUsage is set to be equal to FrameStoreUsage of the additional frame store. Go to Step 1 to decode the next picture.<br><br>
Step 4.2 For a newly decoded field, the destination frame store will be an empty frame store if its opposite parity field of the same frame is not in the DPB 2.1. In this case the FrameStoreUsage is set to be equal to FrameStoreUsage of the additional frame store. Otherwise, the newly decoded picture should be stored into the same frame store as its opposite parity field and FrameStoreUsage is unchanged. Go to Step 4.3 to decode the next picture..<br>
Step 4.3 After storing the newly decoded picture into the DPB, it is assumed that the latest decoded picture is stored in a frame store whose FrameStorelndex is 0, the second latest decoded picture is stored in a frame store whose FrameStorelndex is 1, and so on. Last, Step 1 is performed to decode the next picture.<br>
It shall be noticed that marking a picture as "unused for reference" and marking a picture as "unused for reordering" are decoupled.<br>
To help understand the operations in the steps presented above, two examples are shown for the reordering process. The italic numbers after (or below) the picture labels indicate the frame_num. Reference pictures are indicated by underlining the letter of the picture label, 'x' means no picture is reordered before decoding the next picture.<br>
Example 1. num_reorder frames = 1; 10 frames are coded.<br>
Coded pictures in output order	10	B1	B2	P3	B4	B5	P6	B7	B8	P9<br>
Decoding order:	10 0	P3 1	B1 2	B2 2	P6 2	B4 3	B5 3	P9 3	B7<br>
4	B8 4<br>
After reordering	X	10	B1	B2	P3	B4	B5	ps-	B7	B8. P9<br>
Example 2. num reorder frames = 2; 13 frames are coded.<br>
Coded pictures in output order	10	B1	B2	B3	P4	B5	B6	B7	P8	B9	B10	B11	P12<br>
Decoding order	10 0	P4 1	B2 2	B1 3	B3 3	P8 3	B6 4	B5 5	B7 5	P12 5	B10 6	B9 7	B11 7<br>
After reordering	X	X	10	B1	B2	B3	P4	B5	B6	B7	P8	B9	810,<br><br>
													B11, P12<br>
If the decoder 2 notices that the encoded pictures can not be decoded, the size of the DPB 2.1 may be too small. In some applications the decoder 2 can inform the encoder to change the encoding parameters, for example, to use less reference pictures, or to use larger DPB size. In the error situation the decoder 2 may still output those decoded pictures which it managed to decode and/or to output some default pictures (e.g. empty frames).<br>
Sliding window operation for reordering<br>
The nurn_reorder_frames is used to define the sliding window operation for reordering purpose. The pictures to be reordered are arranged in output order to find out the picture which should jump out of the scope of the window first. Once the number of pictures to be reordered reaches the num_reorder_frames, the first picture in output order is sure to fall out of the window as the result of one sliding window operation. This subsection specifies how to find the earliest picture in output order among the pictures that are marked as "used for reordering".<br>
Step 1. Initialization. Set the oldest picture in decoding order in DPB1 be the candidate picture.<br>
Step 2. Loop from the second oldest picture to the latest picture (in decoding order) and use i as the loop counter. The loop body is composed by Step 2.1 and Step 2.2.<br>
Step 2.1 If picture i is an IDR picture, the candidate picture is the picture to find, break, the loop.<br>
Step 2.2 If the POC of picture i is less than the POC of the candidate picture, set picture i as the candidate picture.<br>
Step 3. End. The candidate picture is the oldest picture in output order.<br><br>
The num_ref_frames and num_reorder_frames are signalled to the decoder 2 by some way, for example by a sequence parameter set. Every time when a different sequence parameter set becomes effective, num_ref_frames or num_reorder_frames may change and thus special care on the DPB should be taken.<br>
1.5.1	Changing of num_ref_frames<br>
No special actions need to be done when num_ref_frames increases.<br>
When num_ref_frames decreases, a simple operation upon the DPB is proposed: Let diff_ref_frames equal to the new num_ref_frames minus old num_ref_frames. All the diff_ref_frames reference frames from the oldest in decoding order shall be marked as "unused for reference".<br>
1.5.2	Changing of num_reorder_frames<br>
When num_reorder_frames increases, 0 picture per one decoded picture is output in (new num_reorder_frames) - (old num_reorder_frames) pictures after (old num_reorder_frames) picture since the decoded picture using the new sequence parameter set. For example, the num_reorder_frames of two parts of the bitstream are 1 and 2 respectively. When P3 is decoded, no picture is output.<br><br>
Decoding order	10	P2	B1	P4	B3	10	P3	B2	B1	P6	B5	B4<br>
After reordering	X	10	B1	P2	B3	P4	X	10	B1	B2	P3	B4, B5, B6<br>
When num_reorder_frames decreases, more than one picture is output at the decoded picture using the new sequence parameter set. For example, the num_reorder_frames of two parts of the bitstream are 2 and 1 respectively. When 10 is decoded, two pictures B5 and P6 are output at the same time.<br><br>
Decoding order	10	P3	B2	B1	P6	B5	B4	10	P2	B1	P4	B3<br><br>
After reordering	X	X	10	B1	B2	P3	B4	B5, P6	10	B1	P2	B3, P4<br>
A picture that is stored for prediction, referred to as a reference picture, is marked as "used for reference", and is labelled as a short-term reference picture, in which case it is identified by its frame_number and parity. A short-term picture may be assigned a long-term reference frame index, in which case it is identified by its long-term index. A picture that is not stored for prediction is labelled as "unused for prediction". Reference picture buffer is a picture set that are composed by pictures marked as "used for reference" in DPB. Removing a picture from reference picture buffer means marking the picture as "unused for reference". To reset the reference picture buffer means to mark all the pictures in reference picture buffer as "unused for reference". Short-term reference pictures can remain marked for reference for a finite duration, given by MaxFrameNum. Long term reference pictures can remain marked "used for reference" until the next IDR picture. Memory_management_control_operation commands can be used to modify the contents of the reference picture buffer.<br>
In another embodiment of the present invention the HRD 5 is used with the encoder 1 to virtually perform the decoding of the encoded pictures similarly than the decoder 2 does. The encoded picture buffer 1.5 ca be used as a pre-decoding buffer for a HRD 5. One aim of the virtual decoding in the HRD 5 is to eliminate a risk for decoding errors due to unbalanced encoding/decoding tasks. The HRD 5 includes a decoded picture buffer 5.2 (DPB) for temporarily storing pictures decoded by the HRD 5. Also in the HRD 5 both the reference picture buffering and the display picture buffering are combined and they use the same decoded picture buffer 5.2 thus reducing the memory requirements of the encoder 1. All decoded pictures stay in the unified buffer until they are no longer used as reference pictures and until their (virtual) display time is reached. The term virtual refers to the fact that in the HRD 5 of the encoder 1, in which the decoding is performed in this advantageous embodiment, the decoded pictures are not displayed but the HRD 5 only checks if there could be errors in the decoding process of the decoder 2 due to, for example, too small buffer size. If errors exist the<br><br>
HRD 5 can inform the encoder to change some encoding parameters, or the size of the DPB 2.1 of the decoder 1 can be increased, for example, by sending a SEI (Supplemental Enhancement Information) message to the decoder 1 in some implementations (unless the maximum size of the DPB is already in use).<br>
The decoding can be simultaneous operation with encoding, or the encoder first creates the bitstream, and when the bitstream is ready, it will be input to HRD 5 for checking that the bitstream fulfils the HRD 5 and processing level requirements. The HRD may also create and modify some HRD parameters, such as the initial buffering delay in coded picture buffer, according to the characteristics of the coded stream.'<br>
To fulfil the purpose above, the reordering process shall not depend upon any HRD-related timing information, because such information may be absent in the decoder. At the same time, it should be allowed that the decoder doesn't obey HRD DTS and OTS accurately. For example, an application like streaming recorder would like to receive bit streams, decode them and store the decoded sequence as fast as possible or operates slower due to the transmission channel capacity. In this case, the HRD DTS and OTS can not be obeyed.<br>
The present invention can be applied in many kind of systems and devices. The transmitting device 6 including the encoder 1 and optionally the HRD 5 advantageously include also a transmitter 7 to transmit the encoded pictures to the transmission channel 4. The receiving device 8 include the decoder 2, a receiver 9 to receive the encoded pictures, and a display 10 on which the decoded pictures can be displayed. The transmission channel can be, for example, a landline communication channel and/or a wireless communication channel. The transmitting device and the receiving device include also one or more processors 1.2, 2.2 which can perform the necessary steps for controlling the encoding/decoding process of video stream according to the invention. Therefore, the method according to the present invention can mainly be implemented as machine executable steps of the processors. The buffering of the pictures can be implemented in the<br><br>
memory 1.3, 2.3 of the devices. The program code 1.4 of the encoder can be stored into the memory 1.3. Respectively, the program code 2.4 of the decoder can be stored into the memory 2.3.<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
WE CLAIM:<br>
1.	A reference decoder for hypothetically decoding an encoded picture stream, the pictures<br>
being defined as reference pictures or non-reference pictures, and information relating to<br>
decoding order and output order of a picture is defined for pictures of the picture stream,<br>
characterized in that the reference decoder comprises a unified picture buffer for buffering<br>
reference pictures and pictures to be reordered, and that the reference decoder comprises the<br>
following:<br>
a processing block for performing the following before inserting a newly decoded picture to the buffer,<br>
examining if the newly decoded picture can be inserted in the buffer without removing another picture from the buffer,<br>
on the basis of said examination, if the newly decoded picture cannot be inserted in the buffer without removing another picture from the buffer, selecting a picture to be removed from those pictures in the buffer which are not used as reference pictures and which have already been output from the buffer,<br>
if a picture was selected, removing the selected picture from the buffer.<br>
2.	The reference decoder as claimed in claim 1, wherein it comprises:<br>
a first attribute defining the number of reference pictures in the buffer, and a second attribute defining the number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures in the buffer,<br>
3.	A signal containing an encoded picture stream, the pictures being defined as reference<br>
pictures or non-reference pictures, and information relating to decoding order and output order<br>
of a picture is defined for pictures of the picture stream, characterized in that the signal<br>
contains at least a first reference picture and a second reference picture, that the first reference<br><br>
picture precedes the second reference picture in decoding order and the second reference picture precedes the first reference picture in output order, and that the signal contains an indication of such a number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures.<br>
4.	The signal as claimed in claim 3, wherein if the signal were processed by a hypothetical decoder as claimed in claim 1, the hypothetical decoder would not indicate an error.<br>
5.	An encoder for forming an encoded picture stream, the pictures being defined as reference pictures or non-reference pictures, and information relating to decoding order and output order of a picture is defined for pictures of the picture stream, characterized in that the encoder is arranged to include to the picture stream at least a first reference picture and a second reference picture, the first reference picture preceding the second reference picture in decoding order and the second reference picture preceding the first reference picture in output order, and that the encoder is arranged to form to the picture stream an indication of such a number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures.<br>
6.	The encoder as claimed in claim 5, wherein the encoder is arranged to form a signal such that if the signal were processed by a reference decoder as claimed in claim 1, the reference decoder would not indicate an error.<br>
7.	The encoder as claimed in claim 5 or 6, wherein if the picture to be removed is not yet displayed it is not removed.<br>
8.	The encoder as claimed in claim 5, 6 or 7, wherein the size of the buffer is defined, and the number of pictures used as reference pictures is defined.<br><br>
9.	The encoder as claimed in claim 8, wherein at any particular moment said number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures is defined so that the sum of the number of pictures used as reference pictures and said number of pictures to be buffered in decoding order which are not used as reference pictures is less than or equal to the size of the buffer.<br>
10.	The encoder as claimed in any of the claims 5 to 9, wherein the pictures being defined as reference pictures or non-reference pictures, the size of the buffer is defined, the number of reference pictures in the buffer is defined, and the number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures in the buffer is defined, wherein the number of pictures to be reordered is defined so that sum of the number of pictures used as reference pictures and the number of pictures arranged to be buffered in decoding order which are not used as reference pictures is less than or equal to the size of the buffer.<br>
11.	The encoder as claimed in any of the claims 5 to 10, wherein the pictures being defined as reference pictures or non-reference pictures, the size of the buffer is defined, the number of reference pictures in the buffer is defined, and the number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures is defined, wherein the size of the buffer is defined so that sum of the number of pictures used as reference pictures and the number of pictures arranged to be buffered in decoding order which are not used as reference pictures is less than or equal to the size of the buffer.<br>
12.	An encoder comprising a reference decoder for hypothetically decoding an encoded picture stream, the pictures being defined as reference pictures or non-reference pictures, and information relating to decoding order and output order of a picture is defined for pictures of the picture stream, characterized in that the encoder comprises a unified picture buffer for<br><br>
buffering reference pictures and pictures to be reordered, and that the reference decoder comprises the following:<br>
a processing block for performing the following before inserting a newly decoded picture to the buffer,<br>
examining if the newly decoded picture can be inserted in the buffer without removing another picture from the buffer,<br>
on the basis of said examination, if the newly decoded picture cannot be inserted in the buffer without removing another picture from the buffer, selecting a picture to be removed from those pictures in the buffer which are not used as reference pictures and which have already been output from the buffer,<br>
if a picture was selected, removing the selected picture from the buffer.<br>
13.	The encoder as claimed in claim 12, wherein it comprises:<br>
a first attribute defining the number of reference pictures in the buffer, and a second attribute defining the number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures in the buffer.<br>
14.	A method for forming an encoded picture stream comprising defining the pictures as<br>
reference pictures or non-reference pictures, and defining information relating to decoding order<br>
and output order of a picture for pictures of the picture stream, characterized in that the method<br>
comprises:<br>
-	comprising the signal with at least a first reference picture and a second reference picture so that the first reference picture precedes the second reference picture in decoding order and the second reference picture precedes the first reference picture in output order, and<br>
-	defining an indication of such a number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures to the picture stream.<br><br>
15.	The method as claimed in claim 14, wherein a signal is formed such that if the signal were processed by a reference decoder as claimed in claim 1, the reference decoder would not indicate an error.<br>
16.	A method for buffering decoded pictures, the pictures being defined as reference pictures or non-reference pictures, the size of the buffer is defined, and the number of reference pictures in the buffer is defined, characterized in that a unified picture buffer is used for buffering both prediction references and decoded pictures for arranging them in output order.<br>
17.	The method as claimed in claim 16, wherein a number of pictures to be buffered in decoding order that is sufficient to recover the output order of pictures is defined.<br>
18.	The method as claimed in claim 17, wherein the decoder is arranged to output pictures using information relating to said number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures, and that the method comprises the following:<br>
performing the following before inserting a newly decoded picture to the buffer,<br>
examining if the newly decoded picture can be inserted in the buffer without<br>
removing another picture from the buffer,<br>
on the basis of said examination, if the newly decoded picture cannot be inserted<br>
in the buffer without removing another picture from the buffer, selecting a picture to be<br>
removed from those pictures in the buffer which are not used as reference pictures and<br>
which have already been output from the buffer,<br>
if a picture was selected, removing the selected picture from the buffer.<br>
19.	A decoder comprising means for buffering decoded pictures, the pictures being defined<br>
as reference pictures or non-reference pictures, the size of the buffer is defined, and the number<br>
of reference pictures in the buffer is defined, characterized in that the decoder comprises an<br>
input<br><br>
for inputting a signal which contains at least a first reference picture and a second reference picture, that the first reference picture precedes the second reference picture in decoding order and the second reference picture precedes the first reference picture in output order, and the signal contains at least an indication of such a number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures, and that the means for buffering comprises a unified picture buffer for buffering both prediction references and decoded pictures for arranging them in output order, wherein the decoder comprises a definer for defining the size of the unified picture buffer on the basis of said indication.<br>
20.	The decoder as claimed in claim 19, wherein a number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures is defined.<br>
21.	The decoder as claimed in claim 20, wherein the decoder is arranged to output pictures using information relating to said number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures, and that the decoder comprises the following:<br>
a processing block for performing the following before inserting a newly decoded picture to the buffer,<br>
examining if the newly decoded picture can be inserted in the buffer without removing another picture from the buffer,<br>
on the basis of said examination, if the newly decoded picture cannot be inserted in the buffer without removing another picture from the buffer, selecting a picture to be removed from those pictures in the buffer which are not used as reference pictures and which have already been output from the buffer,<br>
if a picture was selected, removing the selected picture from the buffer.<br>
22.	The decoder as claimed in claim 21, wherein if the picture to be removed is not yet<br>
displayed it is not removed.<br><br>
23.	The decoder as claimed in any of the claims 19 to 22, wherein the size of the buffer is defined, and the number of pictures used as reference pictures is defined.<br>
24.	The decoder as claimed in claim 23, wherein at any particular moment said number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures is defined so that the sum of the number of pictures used as reference pictures and said number of pictures arranged to be buffered in decoding order which are not used as reference pictures is less than or equal to the size of the buffer.<br>
25.	The decoder as claimed in any of the claims 19 to 24, wherein the pictures being defined as reference pictures or non-reference pictures, the size of the buffer is defined, the number of reference pictures in the buffer is defined, and the number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures is defined, wherein before a newly decoded picture is inserted to the buffer one picture is removed from the buffer, and the picture to be removed is selected from those pictures in the buffer which are not used as reference pictures and which has already been output from the buffer.<br>
26.	The decoder as claimed in any of the claims 19 to 25, wherein the pictures being defined as reference pictures or non-reference pictures, the size of the buffer is defined, the number of reference pictures in the buffer is defined, and the number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures is defined, wherein the number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures is defined so that sum of the number of pictures used as reference pictures and the number of pictures, which are arranged to be buffered in decoding order that is sufficient to recover the output order of pictures, and which are not used as reference pictures is less than or equal to the size of the buffer.<br><br>
27.	The decoder as claimed in any of the claims 19 to 26, wherein the pictures being defined as reference pictures or non-reference pictures, the size of the buffer is defined, the number of reference pictures in the buffer is defined, and the number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures is defined, wherein the size of the buffer is defined so that sum of the number of pictures used as reference pictures and the number of pictures arranged to be buffered in decoding order which are not used as reference pictures is less than or equal to the size of the buffer.<br>
28.	An electronic device comprising an encoder for forming an encoded picture stream, the pictures being defined as reference pictures or non-reference pictures, and information relating to decoding order and output order of a picture is defined for pictures of the picture stream, characterized in that the encoder is arranged to include to the picture stream at least a first reference picture and a second reference picture, the first reference picture preceding the second reference picture in decoding order and the second reference picture preceding the first reference picture in output order, and that the encoder is arranged to form to the picture stream an indication of such a number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures.	^s^&gt;<n></n>
29.	An electronic device comprising a decoder comprising means for buffering decoded pictures, the pictures being defined as reference pictures or non-reference pictures, the size of the buffer is defined, and the number of reference pictures in the buffer is defined, characterized in that the electronic device comprises an input for inputting a signal which contains at least a first reference picture and a second reference picture, that the first reference picture precedes the second reference picture in decoding order and the second reference picture precedes the first reference picture in output order, and the signal contains at least an indication of such a number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures, and that the means for buffering comprises a unified picture buffer for buffering both prediction references and decoded pictures for arranging them in<br><br>
output order, wherein the decoder comprises a definer for defining the size of the unified picture buffer on the basis of said indication.<br>
30. A system comprising an encoder for forming a signal containing an encoded picture stream, the pictures being defined as reference pictures or non-reference pictures, and information relating to decoding order and output order of a picture is defined for pictures of the picture stream, a transmission channel for transmitting the signal to a decoder, the decoder comprising means for buffering decoded pictures, characterized in that the system is arranged to include to the picture stream at least a first reference picture and a second reference picture, the first reference picture preceding the second reference picture in decoding order and the second reference picture preceding the first reference picture in output order, and that the encoder is arranged to form to the picture stream an indication of such a number of pictures arranged to be buffered in decoding order that is sufficient to recover the output order of pictures.<br><br></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODEyLWNoZW5wLTIwMDUtYWJzdHJhY3QucGRm" target="_blank" style="word-wrap:break-word;">812-chenp-2005-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODEyLWNoZW5wLTIwMDUtY2xhaW1zLnBkZg==" target="_blank" style="word-wrap:break-word;">812-chenp-2005-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODEyLWNoZW5wLTIwMDUtY29ycmVzcG9uZG5lY2Utb3RoZXJzLnBkZg==" target="_blank" style="word-wrap:break-word;">812-chenp-2005-correspondnece-others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODEyLWNoZW5wLTIwMDUtY29ycmVzcG9uZG5lY2UtcG8ucGRm" target="_blank" style="word-wrap:break-word;">812-chenp-2005-correspondnece-po.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODEyLWNoZW5wLTIwMDUtZGVzY3JpcHRpb24oY29tcGxldGUpLnBkZg==" target="_blank" style="word-wrap:break-word;">812-chenp-2005-description(complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODEyLWNoZW5wLTIwMDUtZHJhd2luZ3MucGRm" target="_blank" style="word-wrap:break-word;">812-chenp-2005-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODEyLWNoZW5wLTIwMDUtZm9ybSAxLnBkZg==" target="_blank" style="word-wrap:break-word;">812-chenp-2005-form 1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODEyLWNoZW5wLTIwMDUtZm9ybSAxOC5wZGY=" target="_blank" style="word-wrap:break-word;">812-chenp-2005-form 18.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODEyLWNoZW5wLTIwMDUtZm9ybSAyNi5wZGY=" target="_blank" style="word-wrap:break-word;">812-chenp-2005-form 26.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODEyLWNoZW5wLTIwMDUtZm9ybSAzLnBkZg==" target="_blank" style="word-wrap:break-word;">812-chenp-2005-form 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODEyLWNoZW5wLTIwMDUtZm9ybSA1LnBkZg==" target="_blank" style="word-wrap:break-word;">812-chenp-2005-form 5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODEyLWNoZW5wLTIwMDUtcGN0LnBkZg==" target="_blank" style="word-wrap:break-word;">812-chenp-2005-pct.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="220458-aromatic-amine-derivative-and-organic-electroluminescent-element-employing-the-same.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="220460-an-x-ray-backscatter-mobile-inspection-van-for-inspecting-an-object-and-a-method-for-inspecting-an-object.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>220459</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>812/CHENP/2005</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>30/2008</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>25-Jul-2008</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>28-May-2008</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>03-May-2005</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>NOKIA CORPORATION</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td></td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>TIAN, DONG</td>
											<td></td>
										</tr>
										<tr>
											<td>2</td>
											<td>HANNUKSELA, MISKA</td>
											<td></td>
										</tr>
										<tr>
											<td>3</td>
											<td>WANG-YE-KUI</td>
											<td></td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04N 7/24</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/FI03/00832</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2003-11-06</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>60/424,409</td>
									<td>2002-11-06</td>
								    <td>U.S.A.</td>
								</tr>
								<tr>
									<td>2</td>
									<td>60/429,953</td>
									<td>2002-11-29</td>
								    <td>U.S.A.</td>
								</tr>
								<tr>
									<td>3</td>
									<td>60/430,712</td>
									<td>2002-12-03</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/220459-picture-buffering-for-prediction-references-and-display by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 10:43:27 GMT -->
</html>
