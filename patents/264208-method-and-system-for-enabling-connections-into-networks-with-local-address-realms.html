<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/264208-method-and-system-for-enabling-connections-into-networks-with-local-address-realms by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 00:14:50 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 264208:&quot;METHOD AND SYSTEM FOR ENABLING CONNECTIONS INTO NETWORKS WITH LOCAL ADDRESS REALMS&quot;</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">&quot;METHOD AND SYSTEM FOR ENABLING CONNECTIONS INTO NETWORKS WITH LOCAL ADDRESS REALMS&quot;</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>The invention generally concerns the issue of providing connectivity between two different address realms, generally referred to as an inside realm and an outside realm, by establishing connections through an intermediate gateway. The gateway normally has a number of outside-realm gateway addresses for enabling representation of inside-realm nodes in the outside realm. In a first aspect, support for flexible outside-realm initiated connections is enabled by dynamically establishing new gateway connection states triggered, for each new connection, by a respective user-resource identifier query initiated from a corresponding outside node. in a second aspect of the invention, intelligent use of predetermined connection information in the process of setting up new gateway connection states makes it possible to significantly increase the number of connections that can be simultaneously supported by the gateway using a limited number of outside-realm addresses.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>MECHANISMS FOR PROVIDING CONNECTIVITY BETWEEN NETWORKS OF DIFFERENT ADDRESS REALMS<br>
TECHNICAL FIELD OF THE INVENTION<br>
The present invention generally relates to network communication and more particularly to the issue of providing connectivity between networks of different address realms.<br>
BACKGROUND OF THE INVENTION<br>
In network communication, there is a general demand for providing connectivity between different networks, especially when the networks have different address realms. For example, this would normally be the case when a node in a private network wants to connect to a host in a public network. The private network usually have internal addresses that cannot be used outside the network, for privacy reasons or simply because the internal addresses are invalid for use outside the network. Other examples include connectivity between networks of different public domains, as well as between different private networks.<br>
With the explosive growth of Internet Protocol (IP) networks such as the Internet, intranets and other networks, the limited IP address space offered by the current version of the IP protocol, IPv4, becomes a real challenge. With a 32-bit address field, it is possible to assign 232 different addresses, which are about 4 billion globally unique addresses. The next version of the IP protocol, IPv6, will have a 128-bit address field, thus providing a virtually unlimited number of globally unique IP addresses. The challenge is that there is a limited number of IPv4 addresses available to the operators for their new networks, and IPv6 is not yet supported by more than a very limited set of nodes within the Internet. Also, a large number of legacy networks<br>
including -Internet subnets will likely be using the IPv4 or older versions of the IP protocol for many years to come.<br>
For mobile or cellular networks, telecom vendors and operators are facing a great challenge deploying support for an expected vast number of IP-enabled mobile terminals in 2.5 and 3G networks. The IPv4 address space is apparently not large enough to cover the needs when a massive deployment of 2.5 and 3G networks takes place within the near future. Today, network operators that apply for address ranges for their new cellular networks receive address spaces far below the expected number of users. The ratio can be as low as a few thousand addresses for an expected customer base of millions of subscribers.<br>
To meet the demand for addresses, telecom vendors are pushing the introduction of IPv6 into terminals as the standard protocol to use within next generation cellular networks. IPv6, fully deployed would naturally solve the address space problem, but unfortunately, IPv6 is not widely deployed in the Internet yet, and it is expected that this deployment will be quite slow, at least in the near future. Since IPv6 is not deployed in the Internet, vendors will have to use migration schemes for providing connectivity between different networks.<br>
There are a number of existing schemes for both extending an address realm and for translating between different address realms. These schemes will be briefly outlined below, mainly with respect to the issue of providing connectivity between private and public networks operating under the IP protocol.<br>
With reference to Fig. 1, a private realm is a domain where hosts are assigned addresses that are not unique within the Internet, or they are unique but for some reason they are hidden from the public realm. A common example is to assign hosts in a private network 10 with private addresses [a.a.a.a] to [a.d.d.d], for example as specified in RFC1918, to enable multiple hosts to share a single or some public IP<br>
Addresses when the number of private realm hosts exceeds the number of public addresses assigned for the private network 10. Since there is no assigned body coordinating the use of private addresses, these addresses occur at multiple locations around the world and therefore they are generally not unique and can thus not be used within the public realm. In order for private hosts to be able to access the public realm network 20, a gateway 30 can be used for enabling multiple private hosts to share a single or some public IP addresses [x.x.x.x] to [x.x.x.z] for the purpose of public realm access. The gateway 30 thus provides the necessary means for connecting hosts within the private realm to the public realm, especially when the number of private hosts is larger than the number of available public IP addresses.<br>
Network Address Translator (NAT)<br>
Existing schemes for extending address realms such as the IPv4 address space are often based on so-called Network Address Translator (NAT) gateways, which translate private addresses into public addresses and vice versa [1]. The different flavors of NAT have in common that they all hide private addresses and reuse public addresses to enable communication between hosts in a private realm and hosts in the public realm.<br>
Traditional NAT<br>
A traditional NAT gateway typically uses a set of public IP addresses to assign to individual private nodes on a per-session basis. When a host within the private realm wants to contact a host within a public network such as the Internet, the NAT assigns one of its public addresses [x.x.x.x] to fx.x.x.zj to the private host. The NAT then rewrites the sender address in the IP header of the outgoing packet with the public address so the corresponding host in the public Internet gets the impression that the packet came from the publicly assigned IP address. "When the public host sends a packet back to the publicly assigned address, the NAT rewrites the destination address in the IP header with the private address so the packet is correctly routed in the private realm.<br>
This method of translating between the two realms is simple but suffers from two drawbacks other methods have tried to solve. Firstly, it does not allow a host in the public Internet to connect to a host witliin the private realm and secondly, it does not scale very well since every time a private host wants to connect to a public realm host, an entire public IP address is reserved for the host.<br>
Network Address Port Translation (NAPT)<br>
NAPT alleviates the scalability problem by enabling multiple private realm hosts to share a single IP address. This is accomplished by including transport protocol port information into the translation procedure. When a host in the private realm wants to connect to a host in the public realm, the gateway assigns a free port on the public realm interface to the connection and uses the original and assigned ports together with the IP addresses for the translation. This way the NAPT gateway can share a single IP address among several private hosts.<br>
For example, consider a host [a.a.a.a] that wants to connect to host [d.d.d.d] on the public Internet. When the first packet to host [d.d.d.d] reaches the NAT it assigns a free port on an interface, say public IP address [x.x.x.x], to the connection and rewrites the sender address from [a.a.a.a] into [x.x.x.x] and the sender port number to the assigned port number. When the receiver replies the destination address is [x.x.x.x] and the port is the assigned port number. When this packet reaches the NAPT gateway, it rewrites the destination address with [a.a.a.a] and the destination port number with the original port number.<br>
Thus, NAPT scales better than traditional NAT, but it is still impossible for hosts within the public realm to initiate sessions to hosts within the private realm.<br>
i-directional NAT<br>
Bi-directional NAT enables hosts on the public Internet to reach hosts within a private realm. This is accomplished through the introduction of a special Application Layer Gateway (ALG), to a Domain Name Server (DNS) in conjunction with the bi-directional NAT. The ALG is capable of resolving Fully Qualified Domain Names (FQDN) of private realm hosts to assigned public realm addresses. The ALG is capable of translating the private realm address corresponding to a FQDN into a public realm address and vice versa. The bi-directional NAT allows hosts within the public Internet to communicate with hosts within a private realm, but there is a one-to-one mapping between hosts and public IP addresses which scales poorly when public IP addresses are scarce.<br>
Realm Specific IP (RSIP)<br>
RSIP takes a different approach than NAT to provide connectivity between different realms [2, 3]. RSIP uses a special node that is aware of the different realms and can distinguish between the two.<br>
In general terms, RSIP uses two entities, a RSIP server and a RSIP client. The RSIP server is present in both realms and can provide router functionality between the realms. It can also be the node assigning public addresses to private hosts. The RSIP client is a node within the private realm that can temporarily use a public address when communicating with public hosts. Hence, RSIP makes use of public addresses for both parties when communicating between the private and public realms, and does not perform any address translation.<br>
An advantage of this scheme is that there is no need to deploy ALGs for applications since public realm addresses are used even for private clients. However, plain RSIP does not allow public realm initiated connections.<br>
There are two flavors of RSIP, namely Realm Specific Address IP (RSA-IP) and Realm Specific Address and Port IP (RSAP-IP).<br>
Realm Specific Address IP (RSA-IP)<br>
An RSA-IP client is assigned a public IP address when communicating with the public realm. This procedure is a one-to-one mapping and hence, no other host can use the address until it is released by the client (so-called address granularity). The packets are typically tunneled through the private realm to the RSA-IP server or they can be tunneled end-to-end.<br>
Realm Specific Address and Port IP (RSAP-IP)<br>
RSAP-EP operates similar to RSA-IP with the difference that RSAP-IP clients are assigned public IP addresses as well as associated ports (so-called port granularity). This way, several RSAP-IP clients can share public IP addresses. The multiplexing is performed through adding both an IP tunnel and an additional transport header with the assigned port as identifier if the public host terminates the tunnel. If the RSAP-IP server terminates the tunnel, the multiplexing is based on both destination address and port.<br>
NAT-PT<br>
Another flavor of NAT, called NAT-PT, adds specific protocol translation between IPv4 and IPv6. NAT-PT comes in three flavors corresponding to standard NAT, NAPT and bi-directional NAT. Bi-directional NAT-PT has support for public realm initiated communication, but with a one-to-one mapping of public IP address to private realm host. However, this scheme also does not scale very well due to the limited number of available public IPv4 addresses.<br>
In general, public-realm initiated communication is enabled by manually and statically configuring the gateway such that an inside-bound packet with a given destination<br>
address and port will be forwarded to a certain node in the private realm. This scheme is generally referred to as static port mapping.<br>
Bridging between a private realm and a public realm could also be effectuated on the session level, e.g. as described in [4],<br>
Apparently, there are limitations regarding the number of simultaneous flows that can be supported by the gateway, as well as limitations regarding the mechanisms for establishing a connection initiated from nodes in the public realm.<br>
SUMMARY OF THE INVENTION<br>
None of the existing schemes meets the demands for supporting a massive deployment of a vast number of IP-enabled terminals in future networks, or more generally the demands for efficiently providing connectivity between networks of different address realms.<br>
The present invention overcomes these and other drawbacks of the prior art arrangements.<br>
It is a general object of the invention to provide an improved scheme for providing connectivity between networks of different address realms.<br>
It is particularly important to provide enhanced scalability, for example to enable support of a large number of private nodes by means of a limited number of available public addresses. In other words, it is highly desirable to improve the multiplexation characteristics of a communication gateway.<br>
It is also an object of the invention to provide stable support for flexible so-called outside-realm initiated communication, for example public-realm initiated connections.<br>
Another object of the invention is to provide an improved method and system for establishing a connection between an outside address realm and an inside address realm through an intermediate gateway.<br>
A particular object of the invention is to provide an improved gateway system for efficiently providing connectivity between different address realms.<br>
Yet another object of the invention is to provide a gateway resource manager for supporting enhanced scalability and/or efficient and flexible outside-realm initiated communication.<br>
These and other objects are met by the invention as defined by the accompanying patent claims.<br>
The invention generally concerns the issue of providing connectivity between two different address realms, generally referred to as an inside realm and an outside realm, by establishing connections through an intermediate gateway. The gateway normally has a number of outside-realm gateway addresses for enabling representation of inside-realm nodes in the outside realm. Typically, the inside realm is a private address realm, whereas the outside realm is a public address realm. However, both the inside realm and the outside realm may be different private address realms, or alternatively both realms may be different public domains.<br>
In this respect, it is a challenge to enable outside-realm initiated connections in a flexible and efficient manner. It is also a challenge to be able to support as many connections as possible through the gateway using a limited number of outside-realm<br>
addresses, both for inside-realm initiated as well as outside-realm initiated communication.<br>
A basic idea according to a first aspect of the invention is to enable support for flexible outside-realm initiated communication by dynamically establishing new gateway connection states triggered, for each new connection, by a respective user-resource identifier query initiated from a corresponding outside node.<br>
Preferably, an outside node that wants to initiate a new connection to an inside node prepares a user-resource identifier query, such as a DNS (Domain Name Server) query or equivalent, for transfer to a central allocation or addressing mechanism, which determines inside-realm network address information based on the inside node identifier included in the query. The identifier query from the outside node further includes predetermined connection information such as outside node address information and/or inside node port information. This predetermined connection information from the identifier query may then be used as a basis for identifying an outside-realm gateway address suitable for establishing a new dynamic gateway connection state for a flow between the outside node and the inside node through the gateway. The new dynamic gateway connection state is subsequently established at least partly based on the identified outside-realm gateway address, the predetermined connection information from the identifier query and the inside-realm network address information. In this way, the invention provides support for dynamic outside-realm initiated communication.<br>
Examples of a user-resource identifier query include a DNS query, a URI (Universal Resource Identifier) query of the SIP (Session Initiation Protocol) protocol or similar query of a proprietary protocol such as a proprietary peer-to-peer protocol for multimedia communications, file sharing or computer games.<br>
For an outside-realm initiated connection, the dynamic gateway connection state is typically, although not necessarily, established in two steps. First, a partially complete<br>
-gateway connection state is created based on the identified outside-realm gateway address, the predetermined connection information from the identifier query and the inside-realm network address. Upon receipt of a packet from the outside node, the partially complete gateway state is transformed into a complete gateway connection state based on complementary connection information associated with the packet. The outside node is generally notified of the identified outside-realm gateway address to enable communication of the initial packet in the communication flow to the gateway.<br>
The predetermined connection information used for identifying a suitable outside-realm gateway address may be an outside network address related to the initiating outside node. In this case, the complementary connection information for completing the gateway connection state preferably includes a port number related to the inside node as well as a port number related to the outside node.<br>
As an alternative or as a complement, it has been recognized that it is possible to include information of the port at which the inside node listens for incoming packets, a pre-defined port or a port made known to the outside node by signaling, in the identifier query from the outside node. This inside node port information can then be used in the identification of an outside-realm gateway address. In this case, the complementary connection information for completing the gateway connection state typically includes an outside network address related to the outside node and an associated port number, or at least the outside node port number.<br>
Advantageously, the task of setting up a new outside-realm initiated connection is functionally divided between the outside node, which sends the initiating identifier query, an identifier-to-address translator, a gateway resource manager and the actual gateway. The gateway resource manager is typically responsive to information such as the determined inside-realm network address corresponding to the relevant inside node and the predetermined connection information originally included in the identifier query, and responsible for identifying a suitable outside-realm gateway address to be used for<br>
refablishing a new dynamic gateway connection state based on this infonnation. The gateway resource manager finally sends a state set-up request to the gateway, which establishes the dynamic gateway connection state.<br>
A basic idea according to a second aspect of the invention consists in intelligently using additional multiplexation information in the process of setting up new dynamic gateway connection states such that the number of connections that can be simultaneously supported by the gateway can be significantly increased. The additional multiplexation information is generally predetermined connection infonnation that includes network address information and/or port information, and the main objective is to identify further connection information including an outside-realm gateway address based on the given address and/or port information. More particularly, the idea is to identify further connection information that in combination with the predetermined connection information defines an outside-realm gateway state representation that has no counterpart in a predetermined set of existing gateway connection states. By outside-realm gateway state representation is meant the outside-realm part of the overall gateway state representation.<br>
For outside-realm initiated connections, the process of identifying further connection information is preferably performed with the aim to identify an outside-realm gateway address, which in combination with the predetermined connection information defines a partially complete outside-realm gateway state representation that has no counterpart in any existing partially complete gateway connection state. For example, the predetermined connection information is extracted from the identifier query as indicated above. Once such a gateway address has been identified, the gateway connection state is ready to be established based on the partially complete outside-realm representation defined by the outside-realm gateway address and the predetermined connection information. The additional multiplexation information, such as outside node address information and/or inside node port information, makes it possible to distinguish a much larger number of simultaneous connections compared to any of the prior art<br>
arrangements. The above process of increasing the multiplexation characteristics of the gateway normally requires a comparison in relation to all partially complete gateway connection states currently existing in the gateway. This comparison could be performed by the gateway resource manager directly in relation to the gateway, requesting and extracting the partially complete gateway states from the gateway as and when required. However, in order to reduce the signaling between the gateway and the resource manager, a separate list representation of existing partially complete gateway connection states is preferably maintained in the resource manager, or at least accessible by the resource manager.<br>
A similar approach for obtaining support for a much larger number of simultaneous connections through the gateway can be applied also for inside-realm initiated connections. The idea here is to identify, based on predetermined connection information including outside node address information and/or outside node port information, further connection information including an outside-realm gateway address, which in combination with the predetermined connection information defines an at least partially complete outside-realm gateway state representation that has no counterpart in any existing gateway connection state. Establishment of the connection can then be initiated based on the generated outside-realm representation.<br>
For inside-realm initiated connections, the process of increasing the multiplexation characteristics of the gateway typically requires a comparison in relation to all existing gateway connection states, not only in relation to partially complete gateway states as for outside-realm initiated connections.<br>
For so-called substitution style gateways based on address and port translation, the further connection information to be identified may also include associated gateway port information in addition to the outside-realm gateway address. In this case, the resulting outside-realm representation is a complete outside-realm representation, which together<br>
with a corresponding inside-realm representation completely defines the new connection through the gateway.<br>
On the other hand, for so-called relaying style gateways, where the inside-realm representation of the gateway state may be a virtual point-to-point interface, the resulting outside-realm representation is only a partially complete representation, which forms the basis for creating a partially complete gateway state. In this case, upon receipt of a packet from the inside node, it is normally recommended to check that the partially complete representation in further combination with inside node port information associated with the received packet defines a unique compLete outside-realm representation that can be used for completing the gateway connection state.<br>
The multiplexation gain offered by the invention is truly significant, leading to a support for a considerably larger number of simultaneous connections compared to any of the prior art schemes. In fact, the invention and the advantages it offers may even render a fast introduction of the IPv6 protocol completely unnecessary.<br>
The invention, in all its aspects, is applicable to any suitable communication gateway known to the art, ranging from NAT-based gateways, or more generally substitution style gateways to RSIP-based gateways, or more generally relaying style gateways.<br>
The invention offers the following advantages:<br>
Dynamic, flexible and efficient outside-realm initiated communication.<br>
Efficient use of user-identifier queries, such as DNS-queries, in the overall process of establishing outside-realm initiated connections.<br>
Improved gateway multiplexation characteristics.<br>
Support for a much larger number of simultaneous connections through the gateway compared to prior art gateways, both for outside-realm and inside-realm initiated connections.<br>
Enhanced scalability, for example to enable support of a large number of private nodes by means of a limited number of available public addresses.<br>
Generally applicable to most types of gateways.<br>
Other advantages offered by the present invention will be appreciated upon reading of the below description of the embodiments of the invention.<br>
BRIEF DESCRIPTION OF THE DRAWINGS<br>
The invention, together with further objects and advantages thereof, will be best understood by reference to the following description taken together with the accompanying drawings, in which:<br>
Fig. 1 is a schematic diagram illustrating a gateway interconnecting a private network and a public network;<br>
Fig. 2 illustrates a basic model of an exemplary gateway providing connectivity between an inside-realm network and an outside-realm network;<br>
Fig. 3 is a schematic flow diagram of a method for enabling support for flexible outside-realm initiated communication according to a preferred embodiment of the invention;<br>
Fig. 4 is a schematic flow diagram of a basic method for improving the gateway multiplexation characteristics for outside-realm initiated communication according to a preferred embodiment of the invention;<br>
Fig. 5 is a schematic flow diagram of a basic method for improving the gateway multiplexation characteristics for inside-realm initiated communication according to a preferred embodiment of the invention;<br>
Fig. 6 is a schematic diagram of an exemplary gateway system, including a gateway and an associated gateway resource manager, providing effective support for improved gateway multiplexation characteristics;<br>
Fig. 7 is a schematic sequence diagram illustrating the relevant signaling between the involved elements for an illustrative example of inside-realm initiated communication through a substitution style gateway;<br>
Fig. 8 is a schematic sequence diagram illustrating the relevant signaling between the involved elements for an illustrative example of inside-realm initiated communication through a relaying style gateway;<br>
Fig. 9 is a schematic diagram illustrating an example of an overall system for enabling support for flexible and efficient outside-realm initiated connections according to a preferred embodiment of the invention;<br>
Fig. 10 is a schematic sequence diagram illustrating the relevant signaling between the involved elements for an illustrative example of outside-realm initiated communication through a substitution style gateway, using outside node address information for efficient multiplexation;<br>
Fig. 11 is a schematic sequence diagram illustrating the relevant signaling between the involved elements for an illustrative example of outside-realm initiated communication through a substitution style gateway, using inside node port information for efficient multiplexation;<br>
Fig. 12 is a schematic sequence diagram illustrating the relevant signaling between the involved elements for an illustrative example of outside-realm initiated communication through a relaying style gateway, using outside node address information for efficient multiplexation;<br>
Fig. 13 is a schematic sequence diagram illustrating the relevant signaling between the involved elements for an illustrative example of outside-realm initiated communication through a relaying style gateway, using inside node port information for efficient multiplexation;<br>
Fig. 14 is a schematic block diagram illustrating an implementation example of a system for providing connectivity between nodes of different address realms according to a particular embodiment of the invention; and<br>
Fig. 15 is a schematic block diagram illustrating an implementation example of a system for providing connectivity between nodes of different address realms according to another particular embodiment of the invention.<br>
DETAILED DESCRIPTION OF EMBODIMENTS OF THE INVENTION<br>
Throughout the drawings, the same reference characters will be used for corresponding or similar elements.<br>
General overview<br>
In general, there is a demand for providing connectivity between different address realms, more generally referred to as an outside realm and an inside realm. To this end, there is normally provided an intermediate gateway, which has a number of outside-realm gateway addresses for enabling outside-realm representation of inside-realm nodes. In many practical applications, the inside realm is a private address realm [5], whereas the outside realm is a public address realm. In other applications, however,<br>
the inside realm and the outside realm may be different private address realms, or alternatively different public domains.<br>
In this respect, a public realm network is generally a network having communication nodes together with an associated network address space consisting of globally unique network addresses. A private realm network on the other hand is a network having nodes together with an associated network address space consisting of possibly non-unique network addresses, in the sense that two nodes in different instances of a private realm may be assigned the same network address.<br>
A gateway is generally a network element that is connected to both an inside realm and an outside realm. As previously mentioned, there are different types of gateways, especially substitution style gateways (including different flavors of NAT) and relaying style gateways (including different flavors of RSIP). It should also be understood that the overall gateway function includes not only layer 4 packet forwarding, but could encompass packet forwarding on any network layer including also layer 3 packet forwarding.<br>
For a better understanding of the invention, it may be useful to begin with a brief introduction of a basic model of an exemplary gateway providing connectivity between an inside realm and an outside realm, referring to Fig. 2.<br>
Fig. 2 illustrates a basic model of an exemplary gateway 30 interconnecting an inside realm 10 and an outside realm 20. The gateway 30 is associated with a gateway resource manager 40, which among other things manages the pool of outside-realm network addresses that have been allocated to the gateway. In the gateway 30, the basic gateway functions are supported by an outside-bound process element 32, an inside-bound process element 34 and a packet forwarding element 36. The gateway 30 and gateway resource manager 40 may be implemented in separate, but interconnected nodes. Alternatively, the<br>
gateway resource manager 40 may be co-located with the gateway 30, even integrated in the gateway.<br>
For a substitution style gateway, as the name indicates, substitution of address and port information in the packet headers is performed to enable proper packet forwarding. A gateway connection state in a substitution style gateway is normally represented by an outside n-tuple and an inside n-tuple. In general, an n-tuple is a set of n information elements that typically include: (a source network address, a source port number, a destination network address, a destination port number, a protocol number). An outside n-tuple is typically an n-tuple with the source and destination network addresses belonging to the outside realm. An inside n-tuple is typically an n-tuple with the source network address belonging to the inside realm and the destination network address belonging to the outside realm. To enable proper packet forwarding for communication flows, there are two basic classification processes:<br>
•	The inside-bound process, in which each inside-bound packet is matched<br>
against the outside n-tuples of the gateway connection states in the gateway,<br>
and when finding a matching outside n-tuple, the destination address and port<br>
of the packet header are substituted with the source address and port of the<br>
inside n-tuple corresponding to the identified outside n-tuple.<br>
•	The outside-bound process, in which each outside-bound packet is matched<br>
against the inside n-tuples of the gateway connection states in the gateway, and<br>
when finding a matching inside n-tuple, the source address and port of the<br>
packet header are substituted with the destination address and port of the<br>
outside n-tuple corresponding to the identified inside n-tuple.<br>
For a relaying style gateway, a gateway connection state is normally represented by an outside n-tuple and a virtual point-to-point interface towards a communication node on the inside realm. An example of a virtual point-to-point interface is an IP-in-IP tunnel<br>
In which, in the inside-bound direction, a packet is encapsulated in another packet, with destination address equal to the inside node address, and source address equal to the inside gateway address, and in the outside-bound direction the incoming packet is decapsulated, whereby an inner packet is extracted. In another example, instead of encapsulation and decapsulation, there could be a layer 2 point-to-point link between the gateway and the communication node on the inside realm (for example, in a GPRS system, the PDP Context layer).<br>
In a relaying style gateway, the two basic processes for enabling proper packet forwarding for communication flows are defined as:<br>
•	The inside-bound process, in which each inside-bound packet is matched against the outside n-tuples of the gateway connection states in the gateway, and when finding a matching outside n-tuple, the packet is sent to the virtual point-to-point interface corresponding to the identified outside n-tuple.<br>
•	The outside-bound process, in which each outside-bound packet comes in on a virtual point-to-point interface and forwarded by the gateway to the outside realm.<br>
The main difference between substitution and relaying style is that in relaying style, the inside node is aware of the currently allocated outside-realm address (and port number(s)). In substitution style, the inside-realm node is not aware of the outside-realm address, and instead the gateway performs transparent translation (substitution).<br>
In both substitution and relaying style gateways, there may be partially complete gateway connection states, i.e. states which represent connections that currently are in the process of being established, but which have not yet collapsed into a complete gateway connection state for a gateway session. Such partially complete gateway states are sometimes referred to as gateway gates or pinholes.<br>
In a substitution style gateway, a gateway gate is a gateway connection state with an outside n-tuple and an inside n-tuple, where the outside n-tuple and/or the inside n-tuple has one or more unspecified connection variables (wild cards, denoted by "*"). When the gateway receives an inside-bound packet/outside-bound packet matching the specified values of the partially complete outside/inside n-tuple, that n-tuple is completed in the sense that the up-to-now unspecified values of the partially complete n-tuple are fixed to the corresponding values associated with the packet.<br>
In a relaying style gateway, a gateway gate is a gateway connection state with an outside n-tuple and an inside n-tuple, where the outside n-tuple and/or the inside n-tuple has one or more unspecified connection variables. When the gateway receives an inside-bound packet matching the specified values of the partially complete outside n-tuple, that n-tuple is completed in the sense that the up-to-now unspecified values of the partially complete n-tuple are fixed to the corresponding values associated with the packet.<br>
An outside n-tuple is generally also referred to as an outside-realm gateway state representation, since it refers to the part of the overall gateway state representation that is related to the outside realm.<br>
With the above basic insights into the operation of a general gateway, the understanding of the sometimes rather complex aspects of the invention will now be somewhat facilitated and more straightforward.<br>
As previously mentioned, it is a basic challenge to enable outside-realm initiated connections in a flexible and efficient manner. It is also highly desirable to improve the multiplexation characteristics of the gateway, both for inside-realm initiated as well as outside-realm initiated communication. The main objective in the latter respect is to be able to support as many connections as possible through the gateway using a limited number of outside-realm addresses.<br>
Exemplary basic procedures for outside-realm initiated communication<br>
The inventors have recognized that a flexible and dynamic mechanism for enabling outside-realm initiated communication is obtained by letting a user-resource identifier query, such as a DNS-query or equivalent query, initiated from an outside node trigger the set-up of a connection state in the gateway. A basic procedure according to a preferred embodiment of the invention is generally outlined in the flow diagram of Fig. 3. In step S1, an outside node that wants to initiate a new connection to a particular inside node prepares a user-resource identifier query, such as a DNS query or equivalent, for transfer to a central allocation or addressing mechanism. In step S2, an inside-realm network address is determined for the inside node based on an inside node identifier included in the query. In the case of a DNS-query, this may for example be accomplished by a conventional domain-name-to-network-address translator. The identifier query further includes predetermined connection information mat is handled by a gateway resource manager, which uses this information as a basis for identifying an outside-realm gateway address suitable for establishing a new dynamic gateway connection state, as indicated in step S3. The predetermined connection information may for example be the network address of the outside node or inside node port information. In the latter case, the port information may be a pre-defined inside node receiver port, or a receiver port number made known to the outside node by explicit signaling. Next, in step S4, the new dynamic gateway connection state for a flow between the outside node and the inside node through the gateway is established at least partly based on the identified outside-realm gateway address, the predetermined connection information and the inside-realm network address. This means that the invention provides support for dynamic outside-realm initiated communication. Among other things, this allows all forms of push services, notification services and instant messaging services.<br>
For an outside-realm initiated connection, the dynamic gateway connection state is typically, although not necessarily, established in two steps. First, a partially complete gateway connection state is created based on the identified outside-realm gateway address, the predetermined connection information extracted from the identifier query as<br>
well as the inside network address. Upon receipt of a packet from the outside node, the partially complete gateway state "collapses" into a complete gateway connection state as complementary connection information such as address and/or port information in the packet header is used to fill-in the unspecified parts of the gateway state. The outside node is generally notified of the identified outside-realm gateway address to enable communication of the initial packet towards the gateway.<br>
Improved gateway multiplexation capacity<br>
In a further aspect of the invention, the number of outside-realm initiated connections that can be simultaneously supported by the gateway can be significantly increased by intelligently using one or more additional multiplexation variables in the process of setting up new dynamic gateway connection states. Here, the additional multiplexation information preferably includes the predetermined connection information, typically outside node address information and/or inside node port information, as extracted from the initiating user-resource identifier query. However, from the viewpoint of the gateway resource manager, the origin of the predetermined connection information to be used in the state set-up process is not critical, as long as it receives proper connection information.<br>
Fig. 4 is a schematic flow diagram of a basic method for improving the gateway multiplexation characteristics for outside-realm initiated communication according to a preferred embodiment of the invention. In the following, an outside-realm gateway address is simply referred to as an outside gateway address.<br>
As indicated in step S11, the exemplary method involves receiving predetermined connection information to be used in the state set-up process. For a substitution style gateway, further connection information, typically an outside gateway address, is selected in step S12. In order to avoid a gateway resource clash between several simultaneous on-going connection set-ups, the partially complete outside n-tuple, defined by a combination of the outside gateway address and the predetermined<br>
connection information, is analyzed in comparison to all existing partially complete gateway connection states, as indicated in step S13. The analysis includes checking whether the above combination of connection information, defining a partially complete outside n-tuple, has any counterpart in the existing partially complete gateway connection states. If the partially complete outside n-tuple is already present (Y) in an existing partially complete gateway state, there is already a binding between the outside gateway address and the predetermined connection information. This generally means that another outside gateway address has to be selected from the gateway address pool, repeating steps S12-S13. The gateway resource manager repeats the process with the next address in the outside gateway address pool until a "free" address is found or the end of the address pool is reached. If it is possible to identify an outside gateway address, which in combination with the predetermined connection information has no counterpart in any existing partial gateway state (N), the procedure continues with step S14. In step S14, connection establishment is initiated based on the partially complete outside n-tuple (and naturally also the corresponding inside representation), awaiting completion in step S15 upon receipt of the first packet in the communication flow.<br>
If all outside gateway addresses in the address pool has been traversed without finding a unique partial outside n-tuple, the connection request may have to be rejected. It is however also possible to start traversing the addresses in gateway address pool once again, assuming that the delay of the mentioned selection procedure should minimize the risk of two connections being set-up simultaneously so that any existing data connection establishment should have had time to be completed upon receipt of the first packet.<br>
As mentioned above, when the first packet arrives, the partial gateway state turns into a complete gateway connection state. Complete gateway connection states can be further distinguished by complementary connection information associated with the corresponding packets, and so do not have to be represented in the list used in step S13. Therefore, as soon as there is a complete binding, when a partial gateway state turns into<br>
a complete gateway state, that partial gateway state is removed from the list of ambiguity candidates.<br>
The above process of increasing the multiplexation characteristics of the gateway apparently requires a comparison in relation to all partially complete gateway connection states currently existing in the gateway. This comparison could be performed by the gateway resource manager directly in relation to the gateway, requesting and extracting the partially complete gateway states from the gateway as and when required. However, in order to reduce the signaling between the gateway and the resource manager, a separate list representation of existing partially complete gateway connection states is preferably maintained in the resource manager, or at least accessible by the resource manager.<br>
For relaying style gateways, it should be understood that the inside-realm nodes are generally aware of the outside-realm addresses they are using, meaning that such outside-realm addresses have typically been pre-allocated to the inside nodes. This means that for relaying style gateways, step S12 is performed earlier in the overall chain of events, and that step S13 becomes more of a check whether the combination of a pre-allocated outside gateway address and received predetermined connection information has any counterpart among the existing partially complete gateway states.<br>
Exemplary scenarios<br>
For example, consider public host B that wants to connect to two private nodes Al and A2. Host B initiates a connection set-up towards node Al, and the gateway resource manager finds a free outside gateway address, say aOGl. Simultaneously, host B initiates a connection set-up towards node A2, and the gateway resource manager attempts to identify a useful outside gateway address. By using inside node receiver port information in the gateway address identification process, it is possible, assuming thai private nodes Al and A2 do listen on different port numbers, to assign the same public gateway address, aOGl, for pending connections towards both private nodes Al and<br>
A 2, since now the two pending connections can be distinguished based on the destination port information pAl and pA2. Consequently, this means mat each public gateway address can be used for any number of private nodes, as long as they all listen on different port numbers.<br>
Assume furthermore that public host B wants to initiate connections to yet another private node A3, listening on the same port number as node Al. Provided that the connection between host B and node Al has already been completely established when host B initiates a connection set-up towards node A3, it is actually safe to select the same public gateway address for node A3, since it can be safely assumed that host B will use different port numbers when sending traffic towards the private nodes Al and A3. The port number of public host B is appended as source port information in the packet header, and can be used as complementary connection information for distinguishing a given packet flow from other flows from B.<br>
In another example, consider two public hosts B1 and B2, each wanting to connect the same private network hidden behind a gateway. Host Bl initiates a connection set-up, and the gateway resource manager finds a free public gateway address, say aOGl. Simultaneously, host B2 initiates a connection set-up, and the gateway resource manager attempts to identify a useful public gateway address. By using the public host address in the process of identifying a useful outside gateway address, the same gateway address can be selected for host B2, since the two pending connections can be distinguished based on the source address information, aOB 1 and aOB2. In general, this in fact means that each public gateway address can be used for any number of different public hosts.<br>
Assume furthermore that public host Bl wants to initiate connections to two different private nodes Al and A2. Provided that the connection between host Bl and node Al has already been completely established when host Bl initiates a connection set-up towards node A2, it is actually safe to select the same public gateway address for node A2, since it can be safely assumed that host Bl will use different port numbers when sending traffic<br>
towards the private nodes Al and A2. The port number of public host Bl is appended as source port information in the packet header, and can be used as complementary connection information for distinguishing a given packet flow from other flows from Bl. This even allows private nodes Al and A2 to listen on the same port number. It is a clear advantage to be able to allow the application software in the private nodes to choose port freely.<br>
Lower complexity implementation<br>
If a lower degree of implementational complexity is desired, with a lower impact on existing gateway implementations, it is possible to eliminate the step-wise state set-up and establish a complete gateway connection state directly based only on the available connection information before packet reception. In a preferred lower-complexity implementation, the gateway resource manager requests allocation of a public gateway address to a given private node, but only for traffic coming from a particular public host, still keeping the public gateway address available for traffic to the same or other private nodes from other public hosts. Naturally, the drawback is that for flows coming from one particular public host, the number of private nodes that can simultaneously receive information is limited to the number of available public gateway addresses. However, flows originating from different public hosts can still be allocated the same public gateway address.<br>
Exemplary basic procedures for inside-realm initiated communication<br>
Improved gateway multiplexation capacity<br>
A similar approach for supporting a much larger number of simultaneous connections through the gateway can be applied also for inside-realm initiated connections, as generally outlined in the basic flow diagram of Fig. 5. In step S21, predetermined connection information including outside node address information and/or outside node port information, is received by the gateway resource manager. For a substitution style gateway, further connection information including at least an outside gateway address is selected in step S22. In step S23, it is tested whether the combination of the<br>
predetermined connection information and the further connection information, together defining an at least partially complete outside-realm representation of a new gateway connection state to be established, has any counterpart in the existing gateway connection states. If the at least partially complete outside n-tuple is already present (Y) in an existing gateway state, another outside gateway address has to be selected from the gateway address pool, repeating steps S22-S23. The gateway resource manager repeats the process with the next address in the outside gateway address pool until a "free" address is found or the end of the address pool is reached. If it is possible to identify an outside gateway address, which in combination with the predetermined connection information defines an at least partially complete outside n-tuple that has no counterpart in any existing gateway state (N), the procedure continues with step S24. In step S24, connection establishment is initiated based on the at least partially complete outside n-tuple (and naturally also the corresponding inside representation).<br>
It should be especially noted that, for inside-realm initiated connections, a comparison in relation to all existing gateway connection states is typically required, not only in relation to partially complete gateway states as for outside-realm initiated connections.<br>
For so-called substitution style gateways based on address and port translation, the further connection information to be identified may also include associated gateway port information in addition to the outside gateway address. In this case, the resulting outside-realm representation is a complete outside-realm representation, which together with a corresponding inside-realm representation completely defines the new connection through the gateway.<br>
On the other hand, for so-called relaying style gateways, where the inside-realm representation of the gateway state may be a virtual point-to-point interface, the resulting outside-realm representation is normally only a partially complete representation. This partially complete outside-realm representation forms the basis for creating a partially complete gateway state, which is subsequently transformed into a complete gateway state<br>
upon receipt of the first packet from the inside node. In addition, as previously mentioned, for relaying style, the inside-realm nodes are generally aware of the outside-realm addresses they are using, which means that outside-realm addresses have already been pre-allocated.<br>
The gateway resource manager<br>
The above processes of increasing the multiplexation characteristics of the gateway in order to be able to distinguish a much larger number of simultaneous connections compared to any of the prior art systems, apparently requires a comparison in relation to various sets of gateway connection states currently existing in the gateway. Referring to the simplified block diagram of Fig. 6, this comparison could be performed by the gateway resource manager 40 directly in relation to the gateway 30, requesting and extracting the relevant gateway states from a state database 38 in the gateway as and when required. However, in order to reduce the signaling between the gateway 30 and the resource manager 40, the analysis is preferably performed in relation to one or more separate list representations of the relevant gateway connection states. This list representation 42 is conveniently maintained in the resource manager 40, or at an external location that makes it possible for resource allocation logic 44 in the resource manager to effectively access the information.<br>
In general, the resource manager may be implemented as software, hardware, firmware or any combination thereof. In the case of a software-implementation, the steps, functions and actions related to the resource manager are mapped into a computer program, which when being executed by a computer or equivalent processing system effectuates the relevant resource allocation.<br>
Sequence diagrams for inside-realm initiated communication<br>
For a more detailed understanding of the invention, the invention will now be described with reference to exemplary signal sequence diagrams. For simplicity, we will start with inside-realm initiated communication.<br>
Substitution style<br>
Fig. 7 is a schematic sequence diagram illustrating the relevant signaling between the involved elements for an illustrative example of inside-realm initiated communication through a substitution style gateway. The gateway (GW) can enable communication initiated from a node A on the inside realm towards a node B on the outside realm. It is assumed that node A has obtained information of the destination network address aOB, typically through a conventional DNS-query based on a FQDN. The destination port number pB may be a well-known port number, or made known by explicit signaling. An exemplary sequence for supporting a communication flow between A and B through the gateway could be:<br>
1.	Node A has the network address alA and chooses the source port (ephemeral port) pA. The gateway (GW) receives the first packet in a certain communication flow initiated from the inside realm.<br>
2.	The gateway sends a request including the destination network address aOB and/or port number pB to the gateway resource manager (GRM).<br>
In process X, the gateway resource manager allocates a network address aOG from the gateway address pool and given that address preferably also a port number pG from the gateway port pool based on the destination address aOB and/or destination port pB.<br>
The gateway typically supplies the destination address and/or destination port as predetermined connection information to the gateway resource manager, which investigates whether there is a binding between the next gateway address in the gateway address pool and the destination address and/or destination port. If such a binding exists, the resource manager repeats the process with the next gateway address in the pool until a free gateway address without binding is found (or the end of the gateway address pool is reached).<br>
In this particular example, the GRM manager executes an algorithm that attempts to select aOG and pG so that the outside n-tuple (src:(aOB, pB); dest:(aOG, pG); ...) is not an outside n-tuple of an already existing gateway connection state.<br>
3.	The allocated gateway address aOG and the associated port number pG are sent<br>
back to the gateway.<br>
In process a, the gateway creates a new gateway connection state based on the available connection information. The inside n-tuple gets the values: (alA, pA; aOB, pB) and the outside n-tuple gets the values: (aOB, pB; aOG, pG).<br>
4.	The packet is processed in the gateway by the outside-bound process, and forwarded through the gateway to the outside-realm node B.<br>
5.	A reply packet in the communication flow is received by the gateway from nodeB.<br>
6.	The reply packet is processed by the inside-bound process, and delivered to the inside-realm node A.<br>
The multiplexation capacity is improved beyond the limitations of the prior art, and the number of flow can be greater than (number of network address in the gateway address pool)(number of usable ports).<br>
Relaying style<br>
Fig. 8 is a schematic sequence diagram illustrating the relevant signaling between the involved elements for an illustrative example of inside-realm initiated communication through a relaying style gateway.<br>
for relaying style it is desirable, although not necessary, to avoid the port granularity alternative by ensuring sufficient port multiplexing for the address granularity alternative. Especially in the case of communication initiated in the outside realm, as described later on with reference to Figs. 12 and 13, the receiving inside node should preferably be able to choose port number freely. This is not satisfied in the port granularity alternative. Therefore, in the following we mainly refer to the address granularity alternative when discussing the relaying style option.<br>
An exemplary sequence for supporting a communication flow from inside nodes A1 and A2 to outside node B through the gateway could be:<br>
1.	Node Al wants to initiate a communication flow towards node B, which belongs to the outside realm. Node Al sends a request including the destination network address aOB and port number pB to the gateway (GW). In the IETF RSIP framework (RFC3103), this message could be the "ASSIGN_REQUEST_RSA-IP".<br>
2.	The gateway sends a request to the gateway resource manager (GRM).<br>
In process X, the GRM manager allocates a network address aOG from the gateway address pool.<br>
The gateway typically supplies the destination address and/or destination port as predetermined connection information to the gateway resource manager. In this example, both destination address information and port information are included in the request. To improve the multiplexing capacity, the gateway resource manager executes an algorithm that given aOB and pB attempts to select aOG so that outside n-tuple (src:(aOB, pB); dest:(aOG, *); ...) is not an outside n-tuple of an already existing gateway connection state. If that is not possible (all possible gateway addresses aOG are already used), select the<br>
gateway address that is utilized in the least number of gateway connection states.<br>
3.	The allocated gateway address aOG is sent back to the gateway.<br>
4.	In process a, the gateway creates a new partially complete gateway connection state based on the available connection information. The inside-realm representation is denoted by Al and represents a virtual point-to-point link to the inside node Al, whereas the outside n-tuple gets the values: (aOB, pB; aOG, *). The "*" means that this field is for the time being unspecified.<br>
A reply is sent back to node Al, including the allocated gateway address aOG.<br>
5.	Node A2 also wants to initiate a communication flow towards node B, and sends a request including the destination network address aOB and port number pB to the gateway (GW).<br>
6.	The gateway sends a corresponding request to the gateway resource manager (GRM).<br>
In process Y, the GRM manager allocates a network address aOG from the gateway address pool, preferably by using the same algorithm as in process X described above. Assume, for illustrative reasons, that all gateway addresses in the gateway address pool have been traversed without finding a completely "free" address, forcing the resource manager to select the least utilized gateway address. In this example, further assume that the least utilized address is the same address aOG that was previously allocated to node Al.<br>
7.	The allocated gateway address aOG is sent back to the gateway.<br>
In process b, the gateway creates a further partially complete gateway connection state. The inside-realm representation is denoted by A2 and represents a virtual point-to-point link to the inside node A2, whereas the outside n-tuple gets the values: (aOB, pB; aOG, *). The "*" means that this field is for the time being unspecified.<br>
A reply is sent back to node A2, including the allocated gateway address aOG.<br>
9.	Node Al selects a source port pAl (a so-called ephemeral port) for the<br>
communication flow, and sends the first packet. This packet is received by the<br>
gateway.<br>
In process c, the corresponding partially complete outside n-tuple collapses into a complete outside n-tuple (aOB, pB; aOG, pAl), whereby the up-to-now unspecified value in the outside n-tuple is filled-in with the value pAl.<br>
10.	The packet is processed by the outside-bound process, and forwarded through the gateway to the outside-realm node B.<br>
11.	A reply packet in the communication flow is received by the gateway from node B.<br>
12.	The packet is processed by the inside-bound process of the gateway and delivered to node A1.<br>
13.	Node A2 selects a source port pA2 (a so-called ephemeral port) for the communication flow, and sends the first packet. This packet is received by the gateway.<br>
. In process Z, it is investigated whether pA2 is equal to pAl. If pA2 -- pAl, there is a collision and the second partially complete gateway connection state (in box c) should not be collapsed. Instead, the gateway should preferably try to influence node A2 to select another pA2 by resetting the communication flow, e.g. by sending a TCP reset signal.<br>
Assuming that pA2 differs from pAl, the partially complete outside n-tuple collapses in process d into a complete outside n-tuple (aOB, pB; aOG, pA2), whereby the up-to-now unspecified value in the outside n-tuple is filled-in with the value pA2.<br>
14.	The packet is processed by the outside-bound process, and forwarded through the gateway to the outside-realm node B.<br>
15.	A reply packet in the communication flow is received by the gateway from nodeB.<br>
16.	The packet is processed by the inside-bound process of the gateway and delivered to node A2.<br>
The multiplexing capacity can be increased to a point where the address granularity alternative can be used instead of the port granularity alternative. This means that arbitrary ephemeral port numbers can be used.<br>
In the following, the invention will be described with reference to outside-realm initiated communication triggered by a DNS-query or equivalent user-resource identifier query.<br>
Exemplary basic block diagram for outside-realm initiated communication<br>
For a better understanding of the complex mechanisms involved in the invention, it is useful to begin with an exemplary overall system overview, referring to Fig. 9.<br>
is a schematic diagram illustrating an example of an overall system for enabling support for flexible and efficient outside-realm initiated connections according to a preferred embodiment of the invention. The exemplary overall system for interconnecting an inside node A and an outside node B comprises an intermediate gateway 30, an associated gateway resource manager 40, a name-to-address (N/A) translator 50 or equivalent translator together with an associated AAA-server 60. The N/A-translator 50 may for example be a modified DNS server, which accepts a query including a name, and finally responds with a reply including a network address belonging to the outside realm. Optionally, the query and reply also include port number information. A name is a globally unique string that is associated to each node. For example, the name of a communication node could be a FQDN (Fully Qualified Domain Name) formed as a mobile telephone number, MSISDN, together with the operator's domain name, e.g. "070123456789.operator.country". The AAA-server 60 includes functionality for managing dynamic profile data, including name information and inside-realm related network address information, for the communication nodes currently within the inside realm. More generally, the N/A-translator 50 is an identifier-to-address translator, accepting a general identifier query including a DNS-query, a SIP-URI-query [6] and similar query of any proprietary protocol.<br>
In an exemplary basic scenario, a client application is started in an inside node A such as a mobile terminal or other node equipment. The client application opens a socket, i.e. a (low-level) networking interface, and starts listening on a port. Assume by way of example that the client has a private IPv4 address behind the gateway 30, and that outside the gateway towards the outside node B, e.g. an application server of a service provider or other node equipment, normal public routing takes place. It is furthermore assumed that the mobile terminal or other equipment of node A has a name, or similar identifier, and that it has registered itself in the private inside realm so that the AAA-server 60 includes a profile with the name together with the private network address or equivalent symbol identifying a point-to-point interface. The application server of node B may know in advance what port number (a so-called well known or pre-defined port) the<br>
client software is listening to, or alternatively the client software may signal the port number to the public application server in a registration message. Node B normally also has knowledge of the name of node A.<br>
In the example of Fig. 9, control signaling interfaces are indicated by solid lines and packet data interfaces are indicated by dashed lines.<br>
At first, the node B application server sends a DNS-query (1) or equivalent query to the N/A-translator 50. The query also includes information on the public network address of node B and/or information about which port node A is listening to. The N/A-translator 50 sends a request (2) including the name of node A to the AAA-server 60, which responds with a reply (3) including the private network address of node A, or equivalently a symbol representing a point-to-point, interface to node A. The N/A-translator 50 then sends an allocation request (4) including the name and associated private network address representation of node A together with the public network address of node B and/or the inside node port number to the gateway resource manager (GRM) 40. Based on this information, the gateway resource manager 40 identifies a suitable public gateway address for node A and sends a request (5) to the gateway (GW) 30 for creating a gateway connection state. After creating the gateway connection state, the gateway 30 sends a reply (6) confirming the state set-up to the resource manager 40. The resource manager 40 then sends a reply (7) including the public gateway address allocated to node A towards the N/A-translator 50, which in turn forwards this information in a final reply (8) to node B. The application server of node B now sends (9) the first packet to the gateway 30, which if necessary picks up complementary connection information such as the port number used by node B and perhaps also the address of node B for enabling the gateway 30 to transform a possibly incomplete gateway connection state into a complete gateway state. Upon collapsing an incomplete gateway connection state, the gateway 30 preferably informs (10) the resource manager 40, which in turn updates its list representation of gateway connection states. In the gateway 30, the inside-bound process cooperates with the packet forwarding process to deliver the packet through the gateway<br>
10 and onwards (11) to node A. Node A can reply (12) and send information through the gateway 30 and onwards (13) to node B.<br>
It is also possible to provide the DNS-query directly to the gateway resource manager, which in turn forwards the name information to an associated name-to-address translator function that returns an inside network address related to the relevant inside node. As before, the gateway resource manager assigns a public gateway address to the inside node based on predetermined connection information included in the DNS-query and sends a DNS-reply including the assigned address to the requesting outside node.<br>
From an implementational point of view the overall central addressing mechanism, including the name-to-address translator and the gateway resource manager, can be realized in a single process, in different processes running on a single node, or in different processes that are physically separated in several nodes.<br>
If the outside node network address is used for identifying a suitable gateway address, it is recommended that the name query is delivered directly and not relayed by intermediate nodes. In the case when a DNS server is used for name look-up, this corresponds to disabling so-called recursive look-ups by setting the RD (Recursive Desired) bit to "0", and instead rely on iterative look-ups. Uncontrolled caching should also be avoided by setting the TTL (Time-To-Live) parameter to a value smaller than the time distance between two consecutive flow initiations towards the same inside-realm node and port number.<br>
As previously indicated, it may not be necessary to perform the state set-up in two phases. Instead, it is actually possible to establish a complete gateway connection state directly based on the available connection information including the outside node address and/or the inside node port, eliminating the need for the signaling indicated at (10). This obviously reduces the multiplexation gain somewhat since the outside node port number<br>
can not be used as a distinguishing parameter when setting up the gateway connection state. Such a solution may however be sufficient depending on the circumstances.<br>
General mechanisms for controlling NAT/FW states have been proposed by the Internet Engineering Task Force working group on Middlebox Communication (MIDCOM).<br>
Sequence diagrams for outside-realm initiated communication<br>
Substitution style — source address known<br>
Fig. 10 is a schematic sequence diagram illustrating the relevant signaling between the involved elements for an illustrative example of outside-realm initiated communication through a substitution style gateway, using outside node (source) address information for efficient multiplexation.<br>
In this example, the initial state is that a communication node A in the inside realm has started an application that is listening for incoming traffic on port number pA. Node A has the "name" nA. Node A has registered itself in the inside realm so that the AAA-server has a profile that includes nA together with the network address (alA) that is allocated to node A. A communication node B in the outside realm wishes to establish communication towards node A. Node B has knowledge of nA and pA.<br>
In the following sequence, there are three inside nodes with names nAl, nA2, and nA3, inside-realm addresses alAl, aIA2, and aIA3, listening to ports pAl, pA2, and pA3, respectively. Also, there are two outside nodes with outside-realm addresses aOB 1 and aOB2, sending on ports pBl and pB2, respectively.<br>
1.	Node Bl sends a query including nAl to the N/A-translator. The address aOBl<br>
is visible in the source field of the query packet.<br>
2.	The N/A sends a request including nAl to the AAA-server.<br>
3       The AAA-server looks up the network address, alAl, corresponding to nAl and sends a reply to the N/A including nAl and alAl.<br>
4.	The N/A sends a request including nAl, alAl, and aOBl  to the-gateway<br>
resource manager (GRM).<br>
In Process X, the gateway resource manager performs the following algorithm: In this case, it is assumed that there are no existing partial gateway states, also referred to as gates. The gateway resource manager can therefore freely select aOG from the gateway address list, usually taking the first available address.<br>
5.	The gateway resource manager sends a request to the gateway to create the partial gateway state (gate) described in box a.<br>
6.	The gateway replies after creating the partial gateway state.<br>
7.	The gateway resource manager sends a response including nAl and aOG.<br>
8.	The N/A sends a response including nAl, aOG to node B1.<br>
9.	Node B2 sends a query including nA2 and aOB2 to the N/A. The address aOB2 is visible in the source field of the query packet.<br>
10.	The N/A sends a request including nA2 to the AAA-server.<br>
11.	The AAA-server looks up the network address, aIA2, corresponding to nA2 and sends a reply including nA2 and aIA2 to the N/A.<br>
12.	The N/A sends a request including nA2, aIA2, and aOB2 to the gateway<br>
resource manager.<br>
In Process Y, the gateway resource manager performs the following algorithm: Try to select aOG from the gateway address list so that the outside n-tuple (partly unspecified) (src:(aOB2,*);dest:(aOG,*); ...) is not an outside n-tuple of an already existing partial gateway state. In this case, since aOB2 is not equal to aOBl, it's OK to select any aOG, even the same aOG as was selected in Process X above. If that would not have been the case, another aOG than that selected in Process X had had to be chosen.<br>
13.	The resource manager sends a request to the gateway to create the gateway state described on the second row in box b.<br>
14.	The gateway replies after creating the partial gateway state.<br>
15.	The resource manager sends a response including nA2 and aOG.<br>
16.	The N/A sends a response including nA2 and aOG to node B2.<br>
17.	Node B1 sends the first packet in the communication flow towards node Al.<br>
18.	In the gateway, the partial gateway state collapses into a complete gateway state, whereby the outside n-tuple is completed so that it is: (src:(aOBl, pBl); dest:(aOG, pAl); ...) and the inside n-tuple is (src:(aIAl, pAl); dest:(aOBl, pBl); ...) as seen in box c.<br>
19.	The packet is forwarded by the gateway towards node Al.<br>
20.	Node A1 sends the next packet in the communication flow towards node Bl.<br>
21.	The packet is forwarded by the gateway towards node B1.<br>
22.      Node Bl sends a query including nA3 to the N/A. The address aOBl is visible in the source field of the query packet.<br>
23.	The N/A sends a request including nA3 to the AAA-server.<br>
24.	The AAA-server looks up the network address, aIA3, corresponding to nA3 and sends a reply including nA3 and aIA3 to the N/A.<br>
25.	The N/A sends a request including nA3, aIA3, and aOBl to the resource manager.<br>
In Process Z, the resource manager performs the following algorithm: Try to select aOG from the gateway address list, so that the outside n-tuple (partly unspecified) (src:(aOBl,*);dest:(aOG,*); ...) is not an outside n-tuple of an already existing partial gateway state. It's OK that the complete gateway state in the first row in box c already exists. This is because we can safely assume that node Bl will use a port number different from pBl when sending traffic towards node A3.<br>
26.	The resource manager sends a request to the gateway to create the partial gateway state described on the third row in box d.<br>
27.	The gateway replies after creating the gateway state.<br>
28.	The resource manager sends a response including nA3, aOG.<br>
29.	The N/A sends a response including nA3, aOG to node B1.<br>
In process V, the gateway preferably starts a timer after creating a partial gateway state. When the timer reaches a certain value, gate lifetime, and the<br>
partial gateway state has not yet collapsed, the partial gateway state is deleted, releasing the gate.<br>
30. The gateway informs the resource manager that the partial gateway state has been deleted. The resource manager updates its list of existing partial gateway states accordingly.<br>
As mentioned above, in practical cases, it may happen that the reply in steps 8, 16, and 29 is cached. However, for this solution to work satisfactory, the cached data must be deemed invalid after a time interval which is smaller than the time distance between two consecutive flow initiations towards the same inside-realm node and port number.<br>
Substitution style — destination port known<br>
Fig. 11 is a schematic sequence diagram illustrating the relevant signaling between the involved elements for an illustrative example of outside-realm initiated communication through a substitution style gateway, using inside node (destination) port information for efficient multiplexation.<br>
This applies when the port number pA that Node A is listening on becomes known to the N/A-translator in the name query. For example, the DNS query may have the form: "_port._protocol._MSISDN.operator.country". A specific example would be "_4712._tcp.070123456789.telia.se". Alternatively, the DNS query could have the form: '_service._protocol._MSISDN.operator.country". A specific example in this case would be "_http._tcp.0733634026.telia.se". The string "http" would then be translated into a port number, in this case 80.<br>
In the following example, the initial state is that a communication node A in the inside realm has started an application that is listening for incoming traffic on port number pA. Node A has the name nA. Node A has registered itself in the inside realm so that the AAA- server has a profile which includes nA together with the network address<br>
p A that is allocated to node A. A communication node B in the outside realm wishes to establish communication towards node A. Node B has knowledge of nA and pA.<br>
In the following sequence, there are three inside nodes with names nAl, nA2, and nA3, inside-realm addresses alAl, aIA2, and aIA3, listening to ports pAl, pA2, and p A3, respectively.<br>
1.	Node B sends a query including nAl and pAl to the N/A.<br>
2.	The N/A sends a request including nAl to the AAA-server.<br>
3.	The AAA-server looks up the network address, alAl, corresponding to nAl and sends a reply including nAl and alAlto the N/A.<br>
4.	The N/A sends a request including nAl, alAl, and pAl to the gateway resource manager (GRM).<br>
In Process X, the resource manager performs the following algorithm: In this case it is assumed that there are no existing partial gateway states, also referred to as gates. The resource manager can therefore freely select aOG from the gateway address list.<br>
5.	The resource manager sends a request to the gateway to create the gateway state described in box a.<br>
6.	The gateway replies after creating the partial gateway state (gate).<br>
7.	The resource manager sends a response including aOG and pAl,<br>
8.	The N/A sends a response to node B including nAl, aOG, and pAl.<br><br>
9.	Node B sends a query including nA2 and pA2 to N/A.<br>
10.	The N/A sends a request including nA2 to the AAA-server.<br>
11.	The AAA-server looks up the network address, aIA2, corresponding to nA2 and sends a reply including nA2 and aIA2 to N/A.<br>
12.	The N/A sends a request including nA2, aIA2, and pA2 to the resource manager.<br>
In Process Y, the resource manager performs the following algorithm: Try to select aOG from the gateway address list so that the outside n-tuple (partly unspecified) (src:(*,*); dest:(aOG, pA2); ...) is not an outside n-tuple of an already existing partial gateway state. Assume in this example, that pA2 is not equal pAl. This means that it's OK to select the same aOG as was selected in process X above. If pA2 is equal to pAl, the resource manager should try to select an address from the gateway address list different from aOG.<br>
13.	The resource manager sends a request to the gateway to create the gateway state described on the second row in box b.<br>
14.	The gateway replies after creating the partial gateway state.<br>
15.	The resource manager sends a response including nA2, aOG, and pA2.<br>
16.	The N/A sends a response including nA2, aOG, and pA2 to node B.<br>
17.	Node B sends the first packet in the communication flow towards node A1.<br>
18 In the gateway, the partial gateway state collapses into a complete gateway state, whereby the outside n-tuple is completed so that it is: (src:(aOB, pB); dest:(aOG, pAl); ...) and the inside n-tuple is (src:(aIAl, pAl); dest:(aOB, pB); ...), as seen in box c.<br>
19.	The packet is forwarded by the gateway towards node A1.<br>
20.	Node Al sends the next packet in the communication flow towards node B.<br>
21.	The packet is forwarded by the gateway towards node B.<br>
22.	Node B sends a query including nA3 and pA3 to N/A.<br>
23.	The N/A sends a request including nA3 to the AAA-server.<br>
24.	The AAA-server looks up the network address, aIA3, corresponding to nA3 and sends a reply including nA3 and aIA3 to N/A.<br>
25.	The N/A sends a request including nA3, aIA3, and pA3 to the resource manager.<br>
In Process Z, the resource manager performs the following algorithm: Try to select aOG from the gateway address list so that the outside n-tuple (partly unspecified) (src:(*,*); dest:(aOG, pA3); ...) is not an outside n-tuple of an already existing partial gateway state. It's OK that the complete gateway state in the first row in box c already exists. This is because we can safely assume that node B will use a port number different from pB when sending traffic towards node A3. If all addresses in the gateway address list are contained in existing partial gateway states together with the port number pA3, then the resource manager should select a new port number pG so that the outside n-<br>
tuple (partly unspecified) (src:(*,*); dest:(aOG, pG); ...) is not an outside n-tuple of an already existing partial gateway state.<br>
26.	The gateway resource manager sends a request to the gateway to create the gateway state described on the third row in box d.<br>
27.	The gateway replies after creating the partial gateway state.<br>
28.	The resource manager sends a response including nA3, aOG, and pG.<br>
29.	The N/A sends a response including nA3, aOG, and pG to node B.<br>
In process V, the gateway starts a timer after creating a partial gateway state. When the timer reaches a certain value, and the partial state has not yet collapsed, the partial state is deleted.<br>
30.	The gateway informs the resource manager that the partial state has been<br>
deleted, and the resource manager updates its lists of existing partial gateway<br>
states accordingly.<br>
As indicated in the sequence above, there are two cases. In the replies (steps 8, 16, and 29) from the N/A-translator, either the port number is equal to the port number sent in the respective queries (Steps 1, 9, and 22) or not. The former case is the desired since the application in node B is expecting to send towards port number pA. It is recommended that the latter case is used only as a fallback case since it may require implementation changes in the application in node B.<br>
As before, cached data associated with replies back to an outside node must be handled with care.<br>
prelaying style — source address known<br>
Fig. 12 is a schematic sequence diagram illustrating the relevant signaling between the involved elements for an illustrative example of outside-realm initiated communication through a relaying style gateway, using outside node (source) address infonnation for efficient multiplexation.<br>
This solution applies when the network address of node B becomes known to the N/A-translator in the name query. This is the case if the name queries are delivered directly and not relayed by intermediate nodes. In the case when DNS is used for name lookup, this corresponds to disabling recursive look-ups, instead relying on iterative lookups.<br>
As previously mentioned, in the relaying case, the inside-realm node is aware of the outside-realm network address it has been allocated. Thus, application software running on an inside-realm node expecting a communication flow initiated from the outside realm must bind to the currently assigned outside-realm network address. We can therefore assume that all inside nodes have been allocated outside-realm addresses. Since we must generally support more nodes than the number of outside-realm addresses that are available to the gateway, we must assume that some inside nodes are allocated the same outside-realm address. In the following sequence we show three inside nodes Al, A2, and A3, all having the same outside-realm address aOG. We furthermore assume that the gateway resource manager keeps track of which outside-realm address is allocated to a particular inside node based on some index represented in the sequence messages by the symbols "Al", "A2", and "A3". When the virtual point-to-point link toward an inside node is implemented as an IP-in-IP tunnel, an example would be that the symbol "Al" is the inside-realm address alAl allocated to the node Al.<br>
1.        Node Bl sends a query including nAl to the N/A-translator. The address aOBl is visible in the source field of the query packet.<br>
2.	The N/A-translator sends a request including nAl to the AAA-server.<br>
3.	The AAA-server looks-up the symbol, Al, corresponding to nAl and sends a reply including nAl and Al to the N/A.<br>
4.	The N/A sends a request including nAl, Al, and aOBl to the gateway resource manager (GRM).<br>
In Process X, the gateway resource manager performs the following algorithm: In this case it is assumed that there are no existing partial gateway states, also referred to as gates. Based on the symbol Al, the resource manager finds aOG, the outside-realm address currently allocated to node Al.<br>
5.	The gateway resource manager sends a request to the gateway to create the gateway state described in box a.<br>
6.	The gateway replies after creating the gateway state.<br>
7.	The resource manager sends a response including nAl and aOG.<br>
8.	The N/A sends a response including nA 1 and aOG to node B1.<br>
9.	Node B2 sends a query including nA2 to N/A. The address aOB2 is visible in the source field of the query packet.<br>
10.	The N/A sends a request including nA2 to the AAA-server.<br>
11.	The AAA-server looks-up the symbol, A2, corresponding to nA2 and sends a reply including nA2 and A2 to the N/A.<br>
12 The N/A sends a request including nA2, A2, and aOB2 to the gateway resource manager.<br>
In Process Y, the resource manager performs the following algorithm: Based on the symbol A2, the resource manager finds aOG, the outside-realm address currently allocated to node A2. If the outside n-tuple (partly unspecified) (src:(aOB2, *); dest:(aOG, *); ...) is not an outside n-tuple of an already existing partial gateway state, then it's OK to create a new partial gateway state with that outside n-tuple. In this case, since aOB2 is not equal to aOBl, it's OK to create a new partial gateway state (gate), with the outside n-tuple (partly unspecified) (src:(aOB2, *); dest:(aOG, *); ...).<br>
13.	The gateway resource manager sends a request to the gateway to create the gateway state described on the second row in box b.<br>
14.	The gateway replies after creating the partial gateway state.<br>
15.	The gateway resource manager sends a response including nA2 and aOG.<br>
16.	The N/A sends a response including nA2 and aOG to node B2.<br>
17.	Node B1 sends the first packet in the communication flow towards node Al.<br>
18.	In the gateway, the partial gateway state collapses into a complete gateway state, whereby the outside n-tuple is completed so that it is: (src:(aOBl, pB); dest:(aOG, pAl); ...), as seen in box c.<br>
19.	The packet is forwarded by the gateway towards node Al (relaying style).<br>
20.	Node Al sends the next packet in the communication flow towards node B1.<br>
2 1.    . The packet is forwarded by the gateway towards node B1 (relaying style).<br>
22.	Node Bl sends a query including nA3 to the N/A. The address aOBl is visible in the source field of the query packet.<br>
23.	The N/A sends a request including nA3 to the AAA-server.<br>
24.	The AAA-server looks up the symbol, A3, corresponding to nA3 and sends a reply including nA3 and A3 to the N/A.<br>
25.	The N/A sends a request including nA3, A3, and aOBl to the gateway resource manager.<br>
In Process Z, the resource manager performs the following algorithm: Based on the symbol A3, the resource manager finds aOG, the outside-realm address currently allocated to node A3. If the outside n-tuple (partly unspecified) (src:(aOBl, *); dest:(aOG, *); ...) is not an outside n-tuple of an already existing partial gateway state (gate), then it's OK to create a new partial gateway state with that outside n-tuple. It's OK that the complete gateway state in the first row in box c already exists. This is because we can safely assume that node Bl will use a port number different from pBl when sending traffic towards node A3. In case a partial gateway state with the outside n-tuple (partly unspecified) (src:(aOBl, *); dest:(aOG, *); ...) already exists, then there is not enough information available to distinguish the soon incoming communication flows. Preferably, the resource manager should therefore instruct trie N/A to either not respond at all towards node B2 or respond with an explicit error message. This error case is not shown in the sequence.<br>
26.	The gateway resource manager sends a request to the gateway to create the partial gateway state (gate) described on the third row in box d.<br>
27.	The gateway replies after creating the partial gateway state.<br>
28.      The resource manager sends a response including nA3 and aOG.    .<br>
29.	The N/A sends a response including nA3 and aOG to node B1.<br>
In process V, the gateway starts a timer after creating a partial gateway state. When the timer reaches a certain value, and the partial state has not yet collapsed, the state is deleted.<br>
30.	The gateway informs the gateway resource manager that the partial gateway<br>
state has been deleted, and the resource manager updates its lists of existing<br>
partial gateway states accordingly.<br>
As before, cached data associated with replies back to an outside node must be handled with care.<br>
Relaying style — destination port known<br>
Fig. 13 is a schematic sequence diagram illustrating the relevant signaling between the involved elements for an illustrative example of outside-realm initiated communication through a relaying style gateway, using inside node (destination) port information for efficient multiplexation.<br>
This applies when the port number pA that Node A is listening on becomes known to the N/A-translator in the name query.<br>
In the following sequence we show three inside nodes Al, A2, and A3, all having the same outside-realm address aOG. Also, it is assumed that the gateway resource manager keeps track of which outside-realm address that is allocated to a particular inside node based on some index, represented in the sequence messages by the symbols "Al", "A2", and "A3".<br>
1.	Node B sends a query including nAl and pAl to the N/A.<br>
2.	The N/A sends a request including nAl to the AAA-server.<br>
3.	The AAA-server looks-up the symbol, Al, corresponding to nAl and sends a reply including nAl and Al to the N/A.<br>
4.	The N/A sends a request including nAl, Al, and pAl to the gateway resource manager.<br>
In Process X, the resource manager performs the following algorithm: In this case it is assumed that there are no existing partial gateway states, also referred to as gates. Based on the symbol Al, the resource manager finds aOG, the outside-realm address currently allocated to node Al.<br>
5.	The gateway resource manager sends request to the gateway to create the gateway state described in box a.<br>
6.	The gateway replies after creating the partial gateway state.<br>
7.	The resource manager sends a response including nAl, aOG, and pAl.<br>
8.	The N/A sends a response including nAl, aOG, and pAl to node B.<br>
9.	Node B sends a query including nA2 and pA2 to the N/A.<br>
10.	The N/A sends a request including nA2 to the AAA-server.<br>
11.	The AAA-server looks up the symbol, A2, corresponding to nA2 and sends a reply including nA2 and A2 to the N/A.<br>
■%<br>
The N/A sends a request including nA2, A2, and pA2 to the gateway resource manager.<br>
In Process Y, the gateway resource manager performs the following algorithm: Based on the symbol A2, the resource manager finds aOG, the outside-realm address currently allocated to node A2. If the outside n-tuple (partly unspecified) (src:(*,*); dest:(aOG, pA2); ...) is not an outside n-tuple of an already existing partial gateway state (gate), then it's OK to create a new partial gateway state with that outside n-tuple. In this case, this means that if pA2 is not equal pAl, then it's OK to create a new partial gateway state with the outside n-tuple (partly unspecified) (src:(*,*); dest:(aOG, pA2); ...). On the other hand, if pA2 is equal to pAl there is not enough information available to distinguish the soon incoming communication flows. The resource manager should therefore preferably instruct the N/A-translator to either not respond at all towards node B or respond with an explicit error message. This error case is not shown in the sequence.<br>
13.	The gateway resource manager sends a request to the gateway to create the gateway state described on the second row in box b.<br>
14.	The gateway replies after creating the partial gateway state (gate).<br>
15.	The resource manager sends a response including nA2, aOG, and pA2.<br>
16.	The N/A sends a response including nA2, aOG, and pA2 to node B.<br>
17.	Node B sends the first packet in the communication flow towards node Al.<br>
18. In the gateway, the partial gateway state collapses into a complete gateway state, whereby the outside n-tuple is completed so that it is: (src:(aOB, pB); dest:(aOG, pAl); ...), as seen in box c.<br>
19.	The packet is forwarded by the gateway towards node Al (relaying style).<br>
20.	Node Al sends the next packet in the communication flow towards node B.<br>
21.	The packet is forwarded by the gateway towards node B (relaying style).<br>
22.	Node B sends a query including nA3 and pA3 to the N/A.<br>
23.	The N/A sends a request including nA3 to the AAA-server.<br>
24.	The AAA-server looks-up the symbol, A3, corresponding to nA3 and sends a reply including nA3 and A3 to the N/A.<br>
25.	The N/A sends a request including nA3, A3, and pA3 to the resource manager.<br>
In Process Z, the resource manager performs the following algorithm: Based on the symbol A3, the resource manager finds aOG, the outside-realm address currently allocated to node A3. If the outside n-tuple (partly unspecified) (src:(*,*); dest:(aOG, pA3); ...) is not an outside n-tuple of an already existing partial gateway state (gate), then it's OK to create a new partial gateway state with that outside n-tuple. If this is not possible we have the same error case as in Process Y above. It's OK that the complete gateway state in the first row in box c already exists. This is because we can safely assume that node B will use a port number different from pB when sending traffic towards node A3.<br>
26      The gateway resource manager sends request to the gateway to create the gateway state described on the third row of box d.<br>
27.	The gateway replies after creating the partial gateway state.<br>
28.	The gateway resource manager sends a response including nA3, aOG, and pG.<br>
29.	The N/A sends a response including nA3, aOG, and pG to node B.<br>
In process V, the gateway starts a timer after creating a partial gateway state. When the timer reaches a certain value, and the gate has not yet collapsed, the gate is deleted.<br>
30.	The gateway informs the resource manager that the gate has been deleted, and<br>
the resource manager updates its lists of existing gates accordingly.<br>
Implementation examples<br>
Fig. 14 is a schematic block diagram illustrating an implementation example of a system for providing connectivity between nodes of different address realms according to a particular embodiment of the invention. The implementation of Fig. 14 generally corresponds to the overall system overview of Fig. 9, but with the gateway 30 and gateway resource manager 40 implemented in a modified firewall/network address translator (FW/NAT) node, and the N/A-translator implemented in a modified DNS-server. This means that the gateway resource manager 40 is co-located with the gateway 30, and perhaps even integrated in the gateway.<br>
Fig. 15 is a schematic block diagram illustrating an implementation example of a system for providing connectivity between nodes of different address realms according to another particular embodiment of the invention. In this example, the gateway resource<br>
31.manager 40 and the N/A-translator 50 are implemented in a modified DNS-server, whereas the gateway 30 is implemented in a modified FW/NAT node.<br>
In yet another implementation, the gateway resource manager 40 is implemented in a separate network node.<br>
The embodiments described above are merely given as examples, and it should be understood that the present invention is not limited thereto. Further modifications, changes and improvements which retain the basic underlying principles disclosed and claimed herein are within the scope of the invention.<br>
REFERENCES<br>
[1] IP Network Address Translator (NAT) Terminology and Considerations, P. Srisuresh, M. Holdrege, RFC 2663 of the Internet Engineering Task Force, August 1999.<br>
[2] Realm Specific IP: Framework, M. Borella, J. Lo, D. Grabelsky, G. Montenegro, RFC 3102 of the Internet Engineering Task Force, October 2001.<br>
[3] Realm Specific IP: Protocol Specification, M. Borella, D. Grabelsky, J. Lo, K. Taniguchi, RFC 3103 of the Internet Engineering Task Force, October 2001.<br>
[4]      htttp://www.permeo.com/pdf/solutionpaperl .pdf, 2002.<br>
[5] Address Allocation for Private Internets, Y. Rekhter, B. Moskowifcs, D. Karrenberg, G.J. de Groot, E. Lear, RFC 1918 of the Internet Engineering Task Force, February 1996.<br>
[6] iSTP; Session Initiation Protocol, M. Handley, H. Schulzrinne, E. Schooler, J.Rosenberg, RFC 2543 of the Internet Engineering Task Force, March 1999 2001.<br><br><br><br><br><br><br>
WE CLAIM:<br>
1. A method for supporting establishment of a requested connection between a node of an inside address realm and a node of an outside address realm through an intermediate communication gateway (30) having a gateway address pool comprising a number of outside-realm gateway addresses for enabling outside-realm representation of nodes of an inside address realm, said method comprising the steps of:<br>
i)	a gateway resource manager (40) receiving multiplexation information, wherein<br>
said multiplexation information is predetermined connection information including network address information and/or port information;<br>
ii) said gateway resource manager (40) performing, prior to initiating establishment of said requested connection, network address allocation including the steps of:<br>
selecting, from said gateway address pool, an outside-realm gateway address for combination with said predetermined connection information,<br>
checking, for outside-realm initiated connections, whether the combination of the outside-realm gateway address and the predetermined connection information, defining a partially complete outside n-tuple, has any counterpart in the existing partially complete gateway connection states, or<br>
checking, for inside-realm initiated connections, whether the combination of the predetermined connection information and further connection information including the outside-realm gateway address, defining an at least partially complete outside-realm representation, also referred to as an at least partially complete outside n-tuple, has any counterpart in the existing gateway connection states;<br>
repeating the selecting step until a unique combination is found that has no counterpart in the partially complete gateway connection states, for outside-realm initiated connections, or the existing gateway connection states, for inside-realm initiated connections; and<br>
iii) said gateway resource manager (40) initiating establishment of the requested connection based on the partially complete outside n-tuple for outside-realm initiated connections, or based on the at least partially complete outside n-tuple for inside-realm initiated connections.<br><br>
2.	The method as claimed in claim 1, wherein the unique combination of outside-realm gateway address and said predetermined connection information defines an outside-realm gateway state representation that has no counterpart in a predetermined set of existing gateway connection states, and said checking step is based on a comparison in relation to said predetermined set of existing gateway connection states, wherein said predetermined set of gateway connection states includes, for outside-realm initiated connections, the existing partially complete gateway connection states in said gateway, or includes, for inside-realm initiated connections, the existing gateway connection states in said gateway (30).<br>
3.	The method as claimed in claim 2, wherein said gateway resource manager (40) is maintaining a separate list representation of said predetermined set of existing gateway connection states, and wherein said outside-realm gateway state representation is selected based on comparison with corresponding information of said gateway connection states represented in said list representation.<br>
4.	The method as claimed in claim 2, wherein said predetermined connection information, for an inside-realm initiated connection, includes outside node address information and/or outside node port information, said outside-realm gateway state representation is an at least partially complete gateway state representation, and said predetermined set of gateway connection states includes the existing gateway connection states in said gateway (30).<br>
5.	The method as claimed in claim 4, wherein said selecting step also includes selecting associated gateway port information for combination with said predetermined connection information, said outside-realm representation is a complete outside-realm representation, and said step of initiating establishment of said connection comprises the step of requesting that said gateway creates a gateway connection state based on said complete outside-realm representation.<br>
6.	The method as claimed in claim 4, wherein said outside-realm representation is a partially complete outside-realm gateway state representation, and said step of initiating establishment of said connection comprises the step of said gateway resource manager (40)<br><br>
requesting that said gateway (30) creates a partially complete gateway connection state based on said partially complete outside-realm gateway state representation.<br>
7.	The method as claimed in claim 2, wherein said predetermined connection information, for an outside-realm initiated connection, includes outside node address information and/or inside node port information, said outside-realm gateway state representation is a partially complete gateway state representation and said predetermined set of gateway connection states includes the existing partially complete gateway connection states in said gateway (30).<br>
8.	The method as claimed in claim 7, wherein outside-realm gateway addresses of the gateway are traversed by said gateway resource manager (40) until finding an outside-realm gateway address, which in combination with said predetermined connection information has no counterpart in any existing partially complete gateway connection state.<br>
9.	The method as claimed in claim 7, wherein said step of determining whether the combination of the selected candidate outside-realm gateway address and said predetermined connection information is already being utilized for a connection comprises the step of verifying that a pre-allocated outside-realm gateway address in combination with said predetermined connection information has no counterpart in any existing partially complete gateway connection state.<br>
10.	The method as claimed in claim 7, wherein said step of initiating establishment of said connection comprises the step of said gateway resource manager (40) requesting that said gateway (30) establishes a partially complete gateway connection state based on said partially complete outside-realm gateway state representation.<br>
11.	The method as claimed in claim 10, further comprising the step of said gateway (30) transforming, upon receipt of a packet from said node of an outside address realm to said gateway (30), said partially complete gateway connection state that has been created in said gateway (30) into a complete gateway connection state based on complementary connection information associated with said packet.<br><br>
12.	The method as claimed in claim 11, wherein said predetermined connection information is predetermined address information of said node of an outside address realm, and said complementary connection information includes port information of said node of an inside address realm and port information of said node of an outside address realm.<br>
13.	The method as claimed in claim 11, wherein said predetermined connection information is predetermined port information of said node of an inside address realm, and said complementary connection information includes address information and port information of said node of an outside address realm.<br>
14.	The method as claimed in claim 7, further comprising the steps of:<br>
said gateway resource manager (40) selecting, if it is not possible to find a unique combination based on predetermined port information of said node of an inside address realm, another gateway port; and<br>
said gateway resource manager (40) identifying further connection information including an outside-realm gateway address based on said selected gateway port to define a unique, partially complete outside-realm gateway state representation of a gateway connection state.<br>
15.	The method as claimed in claim 7, wherein said predetermined connection information originates from a user-resource identifier query initiated from said node of an outside address realm.<br>
16.	The method as claimed in claim 2, wherein said connection establishment is also based on a corresponding inside-realm representation.<br>
17.	The method as claimed in claim 1, further comprising the steps of:<br>
preparing, at said node of an outside address realm, a user-resource identifier<br>
query that includes an identifier of said node of an inside address realm as well as said predetermined connection information including outside node address information and inside node port information;<br><br>
an identifier-to-address translator (50) determining inside-realm network address information based on said identifier of said node of an inside address realm included in said identifier query;<br>
said gateway resource manager (40) selecting, based on said predetermined connection information included in said identifier query, said outside-realm gateway address to be used in establishing a dynamic gateway connection state for a flow between said node of an outside address realm and said node of an inside address realm through said gateway (30); and<br>
said gateway (30) establishing said dynamic gateway connection state based on said selected outside-realm gateway address, said predetermined connection information included in said identifier query and said inside-realm network address information, thereby enabling an outside-realm initiated connection.<br>
18.	The method as claimed in claim 17, wherein said step of said gateway (30)<br>
establishing said dynamic gateway connection state comprises the steps of:<br>
creating a partially complete gateway connection state based on said selected outside-realm gateway address, said predetermined connection information included in said identifier query and said inside-realm network address information; and<br>
upon receipt of a packet from said node of an outside address realm to said gateway, transforming said partially complete gateway state into a complete gateway connection state based on complementary connection information associated with said packet.<br>
19.	The method as claimed in claim 17, wherein said step of said gateway resource manager (40) selecting an outside-realm gateway address comprises the step of selecting an outside-realm gateway address, which in combination with said predetermined connection information included in said identifier-query defines a partially complete outside-realm gateway state representation that has no counterpart in any existing partially complete gateway connection state.<br>
20.	The method as claimed in claim 19, wherein said gateway resource manager (40) is maintaining a separate list representation of existing partially complete gateway connection states, and wherein said partially complete outside-realm gateway state representation is<br><br>
identified based on comparison with corresponding information of all existing partially complete gateway connection states represented in said list representation.<br>
21.	The method as claimed in claim 20, wherein outside-realm gateway addresses associated with said gateway (30) are traversed by said gateway resource manager (40) until finding an outside-realm gateway address, which in combination with said predetermined connection information included in said identifier query has no counterpart in any existing partially complete gateway connection state represented in said list representation.<br>
22.	The method as claimed in claim 20, wherein said step of determining whether the combination of the selected candidate outside-realm gateway address and said predetermined connection information is already being utilized for a connection comprises the step of verifying that a pre-allocated outside-realm gateway address in combination with said predetermined connection information included in said identifier query has no counterpart in any existing partially complete gateway connection state represented in said list representation.<br>
23.	The method as claimed in claim 18, wherein said predetermined connection information included in said identifier query is an outside network address of said node of an outside address realm, and said complementary connection information for completing the gateway connection state includes a port number of said node of an inside address realm and a port number of said node of an outside address realm.<br>
24.	The method as claimed in claim 18, wherein said predetermined connection information included in said identifier query is a port number of said node of an inside address realm, and said complementary connection information for completing the gateway connection state includes an outside network address of said node of an outside address realm and a port number of said node of an outside address realm.<br>
25.	The method as claimed in claim 17, further comprising the step of said gateway resource manager (40) notifying said node of an outside address realm of said selected outside-realm gateway address.<br><br>
26.	The method as claimed in claim 17, wherein said user-resource identifier query is a Domain Name Server DNS query.<br>
27.	The method as claimed in claim 17, wherein said inside address realm is a private address realm and said outside address realm is a public address realm.<br>
28.	A device for supporting establishment of a requested connection between a node of an inside address realm and a node of an outside address realm through an intermediate communication gateway (30) having a gateway address pool comprising a number of outside-realm gateway addresses for enabling outside-realm representation of nodes of an inside address realm, said device comprising:<br>
i)	a gateway resource manager (40) configured for receiving multiplexation<br>
information, wherein said multiplexation information is predetermined connection information including network address information and/or port information;<br>
ii) said gateway resource manager (40) being configured for performing, prior to initiating establishment of said requested connection, network address allocation including:<br>
selecting, from said gateway address pool, an outside-realm gateway address for combination with said predetermined connection information,<br>
checking, for outside-realm initiated connections, whether the combination of the outside-realm gateway address and the predetermined connection information, defining a partially complete outside n-tuple, has any counterpart in the existing partially complete gateway connection states; or<br>
checking, for inside-realm initiated connections, whether the combination of the predetermined connection information and further connection information including the outside-realm gateway address, defining an at least partially complete outside-realm representation, also referred to as an at least partially complete outside n-tuple, has any counterpart in the existing gateway connection states;<br>
repeating the selecting step until a unique combination is found that has no counterpart in the partially complete gateway connection states, for outside-realm initiated connections, or the existing gateway connection states, for inside-realm initiated connections; and<br><br>
iii) said gateway resource manager (40) being configured for initiating establishment of the requested connection based on the partially complete outside n-tuple for outside-realm initiated connections, or based on the at least partially complete outside n-tuple for inside-realm initiated connections.<br>
29.	The device as claimed in claim 28, wherein said gateway resource manager (40) is configured for finding a unique combination of outside-realm gateway address and said predetermined connection information defining an outside-realm gateway state representation that has no counterpart in a predetermined set of existing gateway connection states, and configured for determining whether the combination of the selected candidate outside-realm gateway address and said predetermined connection information is already being utilized for another connection based on a comparison in relation to said predetermined set of existing gateway connection states, wherein said predetermined set of gateway connection states includes, for outside-realm initiated connections, the existing partially complete gateway connection states in said gateway, or includes, for inside-realm initiated connections, the existing gateway connection states in said gateway.<br>
30.	The device as claimed in claim 29, wherein said gateway resource manager (40) is configured for maintaining a separate list representation (42) of said predetermined set of existing gateway connection states, and configured for finding said outside-realm gateway state representation based on comparison with corresponding information of said gateway connection states represented in said list representation.<br>
31.	The device as claimed in claim 29, wherein said predetermined connection information, for an inside-realm initiated connection, includes outside node address information and/or outside node port information, said outside-realm gateway state representation is an at least partially complete gateway state representation, and said predetermined set of gateway connection states includes the existing gateway connection states in said gateway (30).<br>
32.	The device as claimed in claim 31, wherein said gateway resource manager (40) is configured for selecting also associated gateway port information for combination with said predetermined connection information, said outside-realm representation is a complete outside-<br><br>
realm representation, and said gateway resource manager (40) is configured for requesting that said gateway creates a gateway connection state based on said complete outside-realm representation.<br>
33.	The device as claimed in claim 31, wherein said outside-realm representation is a partially complete outside-realm gateway state representation, and said gateway resource manager (40) is configured for requesting that said gateway creates a partially complete gateway connection state based on said partially complete outside-realm gateway state representation.<br>
34.	The device as claimed in claim 29, wherein said predetermined connection information, for an outside-realm initiated connection, includes outside node address information and inside node port information, said outside-realm gateway state representation is a partially complete gateway state representation and said predetermined set of gateway connection states includes the existing partially complete gateway connection states in said gateway (30).<br>
35.	The device as claimed in claim 34, wherein said gateway resource manager (40) is configured for traversing outside-realm gateway addresses of the gateway until finding an outside-realm gateway address, which in combination with said predetermined connection information has no counterpart in any existing partially complete gateway connection state.<br>
36.	The device as claimed in claim 34, wherein said gateway resource manager (40) is configured for verifying that a pre-allocated outside-realm gateway address in combination with said predetermined connection information has no counterpart in any existing partially complete gateway connection state.<br>
37.	The device as claimed in claim 34, wherein said gateway resource manager (40) is configured for requesting that said gateway establishes a partially complete gateway connection state based on said partially complete outside-realm gateway state representation.<br>
38.	The device as claimed in claim 37, wherein said gateway (30) is configured for transforming, upon receipt of a packet from said node of an outside address realm to said<br><br>
gateway (30), said partially complete gateway connection state that has been created in said gateway into a complete gateway connection state based on complementary connection information associated with said packet.<br>
39.	The device as claimed in claim 38, wherein said predetermined connection information is predetermined address information of said node of an outside address realm, and said complementary connection information includes port information of said node of an inside address realm and port information of said node of an outside address realm.<br>
40.	The device as claimed in claim 38, wherein said predetermined connection information is predetermined port information of said node of an inside address realm, and said complementary connection information includes address information and port information of said node of an outside address realm.<br>
41.	The device as claimed in claim 34, wherein said gateway resource manager (40) is configured for selecting, if it is not possible to find a unique combination based on predetermined port information of said node of an inside address realm, another gateway port, and configured for identifying further connection information including an outside-realm gateway address based on said selected gateway port to define a unique, partially complete outside-realm gateway state representation of a gateway connection state.<br>
42.	The device as claimed in claim 34, wherein said predetermined connection information originates from a user-resource identifier query initiated from said node of an outside address realm.<br>
43.	The device as claimed in claim 29, wherein said gateway resource manager (40) is configured for initiating establishment of said connection also based on a corresponding inside-realm representation.<br><br>
44.	The device as claimed in claim 29, wherein said device comprises an identifier-<br>
to-address translator (50) configured to be responsive to a user-resource identifier query from<br>
said node of an outside address realm for determining inside-realm network address information<br>
based on an identifier of said node of an inside address realm included in said identifier query,<br>
wherein said identifier query further includes said predetermined connection information<br>
including outside node address information and inside node port information;<br>
wherein said gateway resource manager (40) is configured for selecting, based on said predetermined connection information included in said identifier query, said outside-realm gateway address to be used in establishing a dynamic gateway connection state for a flow between said node of an outside address realm and said node of an inside address realm through said gateway; and<br>
wherein said gateway (30) is configured for establishing said dynamic gateway connection state based on said selected outside-realm gateway address, said predetermined connection information included in said identifier query and said inside-realm network address information, thereby enabling an outside-realm initiated connection.<br>
45.	The device as claimed in claim 44, wherein said gateway (30) is configured for establishing said dynamic gateway connection state by creating a partially complete gateway connection state based on said selected outside-realm gateway address, said predetermined connection information included in said identifier query and said inside-realm network address information, and transforming, upon receipt of a packet from said node of an outside address realm to said gateway (30), said partially complete gateway state into a complete gateway connection state based on complementary connection information associated with said packet.<br>
46.	The device as claimed in claim 44, wherein said gateway resource manager (40) is configured for selecting an outside-realm gateway address, which in combination with said predetermined connection information included in said identifier-query defines a partially complete outside-realm gateway state representation that has no counterpart in any existing partially complete gateway connection state.<br>
47.	The device as claimed in claim 46, wherein said gateway resource manager (40) is configured for maintaining a separate list representation (42) of existing partially complete<br><br>
gateway connection states, and configured for identifying said partially complete outside-realm gateway state representation based on comparison with corresponding information of all existing partially complete gateway connection states represented in said list representation.<br>
48.	The device as claimed in claim 47, wherein said gateway resource manager (40) is configured for traversing outside-realm gateway addresses associated with said gateway until finding an outside-realm gateway address, which in combination with said predetermined connection information included in said identifier query has no counterpart in any existing partially complete gateway connection state represented in said list representation.<br>
49.	The device as claimed in claim 47, wherein said gateway resource manager (40) is configured for verifying that a pre-allocated outside-realm gateway address in combination with said predetermined connection information included in said identifier query has no counterpart in any existing partially complete gateway connection state represented in said list representation.<br>
50.	The device as claimed in claim 45, wherein said predetermined connection information included in said identifier query is an outside network address of said node of an outside address realm, and said complementary connection information for completing the gateway connection state includes a port number of said node of an inside address realm and a port number of said node of an outside address realm.<br>
51.	The device as claimed in claim 45, wherein said predetermined connection information included in said identifier query is a port number of said node of an inside address realm, and said complementary connection information for completing the gateway connection state includes an outside network address of said node of an outside address realm and a port number of said node of an outside address realm.<br>
52.	The device as claimed in claim 44, wherein said gateway resource manager (40) is configured for notifying said node of an outside address realm of said selected outside-realm gateway address.<br><br>
53.	The device as claimed in claim 44, wherein said user-resource identifier query is a Domain Name Server DNS query.<br>
54.	The device as claimed in claim 44, wherein said inside address realm is a private address realm and said outside address realm is a public address realm.<br>
55.	A gateway resource manager (40) for a communication gateway (30) that has a number of outside-realm gateway addresses for enabling outside-realm representation of nodes of an inside address realm,<br>
wherein said gateway resource manager (40) is configured for receiving multiplexation information, wherein said multiplexation information is predetermined connection information including network address information and/or port information;<br>
wherein said gateway resource manager (40) is configured for performing the following tasks prior to initiating establishment of a requested connection:<br>
selecting, from said outside-realm gateway addresses, an outside-realm gateway address for combination with said predetermined connection information;<br>
checking, for outside-realm initiated connections, whether the combination of the outside-realm gateway address and said predetermined connection information, defining a partially complete outside n-tuple, has any counterpart in the existing partially complete gateway connection states; or<br>
checking, for inside-realm initiated connections, whether the combination of the predetermined connection information and further connection information including the outside-realm gateway address, defining an at least partially complete outside-realm representation, also referred to as an at least partially complete outside n-tuple, has any counterpart in the existing gateway connection states;<br>
repeating the task to select an outside-realm gateway address until a unique combination is found that has no counterpart in the partially complete gateway connection states, for outside-realm initiated connections, or the existing gateway connection states, for inside-realm initiated connections; and<br>
wherein said gateway resource manager (40) is configured for initiating establishment of the requested connection based on partially complete outside n-tuple for outside-realm<br><br>
initiated connections, or based on the at least partially complete outside n-tuple for inside-realm initiated connections.<br>
56.	The gateway resource manager as claimed in claim 55, wherein said gateway resource manager (40) is configured for identifying a unique combination of outside-realm gateway address and said predetermined connection information defining an outside-realm gateway state representation that has no counterpart in a predetermined set of existing gateway connection states, and configured for determining whether the combination of the selected candidate outside-realm gateway address and said predetermined connection information is already being utilized for another connection based on a comparison in relation to said predetermined set of existing gateway connection states, wherein said predetermined set of gateway connection states includes, for outside-realm initiated connections, the existing partially complete gateway connection states in said gateway (30), or includes, for inside-realm initiated connections, the existing gateway connection states in said gateway (30).<br>
57.	The gateway resource manager as claimed in claim 56, wherein said gateway resource manager (40) is configured for identifying said outside-realm gateway state representation based on comparison with corresponding information of said gateway connection states represented in a list representation of said predetermined set of existing gateway connection states.<br>
58.	The gateway resource manager as claimed in claim 56, wherein said predetermined connection information, for an inside-realm initiated connection, includes outside node address information and/or outside node port information, said outside-realm gateway state representation is an at least partially complete gateway state representation, and said predetermined set of gateway connection states includes the existing gateway connection states in said gateway.<br>
59.	The gateway resource manager as claimed in claim 56, wherein said predetermined connection information, for an outside-realm initiated connection, includes outside node address information and/or inside node port information , said outside-realm gateway state representation is a partially complete gateway state representation and said<br><br>
predetermined set of gateway connection states includes the existing partially complete gateway connection states in said gateway.<br>
60.	The gateway resource manager as claimed in claim 56, wherein said gateway resource manager (40) is configured for receiving inside-realm network address information corresponding to a node of an inside address realm, and predetermined connection information including outside node address information and inside node port information, and configured to request said gateway (30) to establish a dynamic gateway connection state for a flow between said node of an outside address realm and said node of an inside address realm through said gateway (30) based on said selected outside-realm gateway address, said predetermined connection information and said inside-realm network address information.<br>
61.	The gateway resource manager as claimed in claim 60, wherein said predetermined connection information is an address of said node of an outside address realm, and said gateway resource manager (40) is configured to request allocation of said selected outside-realm gateway address to said node of an inside address realm for traffic coming from said address of said node of an outside address realm.<br>
62.	The gateway resource manager as claimed in claim 60, wherein said gateway resource manager (40) is configured to send a request to said gateway (30) for establishment of a partially complete gateway connection state based on said outside-realm gateway address, said predetermined connection information and said inside-realm network address information.<br>
63.	The gateway resource manager as claimed in claim 62, wherein said gateway resource manager (40) is configured for receiving a reply from said gateway (30) that said partially complete gateway connection state has been created, and for notifying said node of an outside address realm of said selected outside-realm gateway address in response to said reply from said gateway (30).<br>
64.	The gateway resource manager as claimed in claim 62, wherein said gateway resource manager (40) is configured to select an outside-realm gateway address, which in combination with said predetermined connection information, defines a partially complete<br><br>
outside-realm gateway state representation that has no counterpart in any existing partially complete gateway connection state.<br>
65. The gateway resource manager as claimed in claim 64, wherein said gateway resource manager (40) is configured for maintaining a list representation (42) of existing partially complete gateway connection states, and configured to identify said partially complete outside-realm gateway state representation based on comparison with corresponding information of all existing partially complete gateway connection states represented in said list representation.</td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1ERUxOUC0yMDA0LUFic3RyYWN0LTMwMTAxNC5wZGY=" target="_blank" style="word-wrap:break-word;">2970-DELNP-2004-Abstract-301014.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LWFic3RyYWN0LnBkZg==" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1ERUxOUC0yMDA0LUNsYWltcy0oMjctMDItMjAxMikucGRm" target="_blank" style="word-wrap:break-word;">2970-DELNP-2004-Claims-(27-02-2012).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1ERUxOUC0yMDA0LUNsYWltcy0zMDEwMTQucGRm" target="_blank" style="word-wrap:break-word;">2970-DELNP-2004-Claims-301014.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LWNsYWltcy5wZGY=" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LUNvcnJlc3BvbmRlbmNlIE90aGVycy0oMDUtMTItMjAxMykucGRm" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-Correspondence Others-(05-12-2013).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LUNvcnJlc3BvbmRlbmNlIE90aGVycy0oMTUtMDctMjAxNCkucGRm" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-Correspondence Others-(15-07-2014).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LUNvcnJlc3BvbmRlbmNlIE90aGVycy0oMjAtMTEtMjAxMykucGRm" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-Correspondence Others-(20-11-2013).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1ERUxOUC0yMDA0LUNvcnJlc3BvbmRlbmNlIE90aGVycy0oMjUtMDUtMjAxMSkucGRm" target="_blank" style="word-wrap:break-word;">2970-DELNP-2004-Correspondence Others-(25-05-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1ERUxOUC0yMDA0LUNvcnJlc3BvbmRlbmNlIE90aGVycy0oMjctMDItMjAxMikucGRm" target="_blank" style="word-wrap:break-word;">2970-DELNP-2004-Correspondence Others-(27-02-2012).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1ERUxOUC0yMDA0LUNvcnJlc3BvbmRlbmNlLTMwMTAxNC5wZGY=" target="_blank" style="word-wrap:break-word;">2970-DELNP-2004-Correspondence-301014.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LWNvcnJlc3BvbmRlbmNlLW90aGVycy5wZGY=" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-correspondence-others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LWRlc2NyaXB0aW9uIChjb21wbGV0ZSkucGRm" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-description (complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1ERUxOUC0yMDA0LURyYXdpbmctMzAxMDE0LnBkZg==" target="_blank" style="word-wrap:break-word;">2970-DELNP-2004-Drawing-301014.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1ERUxOUC0yMDA0LURyYXdpbmdzLSgyNy0wMi0yMDEyKS5wZGY=" target="_blank" style="word-wrap:break-word;">2970-DELNP-2004-Drawings-(27-02-2012).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LWRyYXdpbmdzLnBkZg==" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1ERUxOUC0yMDA0LUZvcm0tMS0oMjctMDItMjAxMikucGRm" target="_blank" style="word-wrap:break-word;">2970-DELNP-2004-Form-1-(27-02-2012).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LWZvcm0tMS5wZGY=" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-form-1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LWZvcm0tMTMucGRm" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-form-13.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LWZvcm0tMTgucGRm" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-form-18.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LWZvcm0tMi5wZGY=" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-form-2.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LWZvcm0tMjYucGRm" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-form-26.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LUZvcm0tMy0oMTUtMDctMjAxNCkucGRm" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-Form-3-(15-07-2014).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LUZvcm0tMy0oMjAtMTEtMjAxMykucGRm" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-Form-3-(20-11-2013).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1ERUxOUC0yMDA0LUZvcm0tMy0oMjUtMDUtMjAxMSkucGRm" target="_blank" style="word-wrap:break-word;">2970-DELNP-2004-Form-3-(25-05-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LWZvcm0tMy5wZGY=" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-form-3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1ERUxOUC0yMDA0LUZvcm0tNS0oMjctMDItMjAxMikucGRm" target="_blank" style="word-wrap:break-word;">2970-DELNP-2004-Form-5-(27-02-2012).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LWZvcm0tNS5wZGY=" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-form-5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LWdwYS5wZGY=" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-gpa.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1ERUxOUC0yMDA0LU9USEVSUy0zMDEwMTQucGRm" target="_blank" style="word-wrap:break-word;">2970-DELNP-2004-OTHERS-301014.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LXBjdC0xMDEucGRm" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-pct-101.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LXBjdC0zMDEucGRm" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-pct-301.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LXBjdC0zMDQucGRm" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-pct-304.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LXBjdC00MDIucGRm" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-pct-402.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LXBjdC00MDkucGRm" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-pct-409.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1kZWxucC0yMDA0LXBjdC00MTYucGRm" target="_blank" style="word-wrap:break-word;">2970-delnp-2004-pct-416.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=Mjk3MC1ERUxOUC0yMDA0LVBldGl0aW9uLTEzNy0oMjctMDItMjAxMikucGRm" target="_blank" style="word-wrap:break-word;">2970-DELNP-2004-Petition-137-(27-02-2012).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=YWJzdHJhY3QuanBn" target="_blank" style="word-wrap:break-word;">abstract.jpg</a></p>
		<br>
		<div class="pull-left">
			<a href="264207-process-for-the-synthesis-of-strontium-ranelate-of-formula-i.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="264209-rolled-material-for-fracture-splitting-type-connecting-rod.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>264208</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>2970/DELNP/2004</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>51/2014</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>19-Dec-2014</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>15-Dec-2014</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>30-Sep-2004</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>TELEFONAKTIEBOLAGET LM ERICSSON (PUBL)</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>S-16483 STOCKOLM, SWEDEN</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>BERNIE VOLZ</td>
											<td>19 FISKE ROAD, ASHLAND, MA 01721, USA</td>
										</tr>
										<tr>
											<td>2</td>
											<td>CHAMBERT GEORG</td>
											<td>EKSATRAVAHEN 138, S-756 55 UPPSALA, SWEDEN</td>
										</tr>
										<tr>
											<td>3</td>
											<td>YURI ISMAILOV</td>
											<td>KOLDINGGATAN 6, 1TR. 16446 KISTA, SWEDEN</td>
										</tr>
										<tr>
											<td>4</td>
											<td>MARTIN KORLING</td>
											<td>SKUGGVAGEN 12, S-191 45 SOLLENTUNA, SWEDEN</td>
										</tr>
										<tr>
											<td>5</td>
											<td>BJORN LANDFELDT</td>
											<td>23 MAYMAN ROW, MENAI, NSW 2234, AUSTRALIA</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04L 29/12</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/US2003/09834</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2003-03-28</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>60/370,812</td>
									<td>2002-04-08</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/264208-method-and-system-for-enabling-connections-into-networks-with-local-address-realms by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 00:14:51 GMT -->
</html>
