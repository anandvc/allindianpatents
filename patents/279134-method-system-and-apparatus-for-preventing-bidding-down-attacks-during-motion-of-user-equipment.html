<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/279134-method-system-and-apparatus-for-preventing-bidding-down-attacks-during-motion-of-user-equipment by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 00:28:40 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 279134:METHOD, SYSTEM, AND APPARATUS FOR PREVENTING BIDDING DOWN ATTACKS DURING MOTION OF USER EQUIPMENT</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">METHOD, SYSTEM, AND APPARATUS FOR PREVENTING BIDDING DOWN ATTACKS DURING MOTION OF USER EQUIPMENT</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>A method for preventing bidding down attacks during motion of a UE is disclosed herein. The method includes: The UE sends a TAU Request message to a new MME; the TAU Request carries UE&quot;s stored security capabilities; the UE receives UE&quot;s security capabilities sent by the MME; and the UE checks whether the received UE&quot;s security capabilities are consistent with the stored UE&quot;s security capabilities. A system, an MME, and a UE for preventing bidding down attacks during motion of the UE are disclosed herein. When the UE performs security capability negotiation with the MME, the UE can check whether the received security capabilities are consistent with the stored security capabilities, and determine whether a bidding down attack exists, thus preventing bidding down attacks.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td> <br>
<br>
FIELD OF THE INVENTION<br>
The present invention relates to mobile communication, and in particular, to a method, a<br>
system, and an apparatus for preventing bidding down attacks during motion of a User Equipment<br>
(UE).<br>
BACKGROUND<br>
A radio network includes two parts: radio access network (RAN) and core network. A Long Term<br>
Evolution (LTE) radio core network includes a Mobile Management Entity (MME). The functions<br>
of the MME are similar to the functions of a Serving General Packet Radio Service (GPRS)<br>
Supporting Node (SGSN), and include mobility management and user authentication. When a UE is<br>
in the idle state, the UE needs to negotiate the Non-Access Signaling (NAS) security algorithms<br>
with the MME, including the NAS encryption algorithm and the NAS integrity protection algorithm<br>
in order to ensure the system security in the communication process of the UE.<br>
When the UE in the idle state moves in an LTE radio access network, or moves from a 2G\3G<br>
network to an LTE network, a Tracking Area Update (TAU) process occurs. In this process, the<br>
entity that performs mobility management and user authentication for the UE may change. For<br>
example, when the UE moves in an LTE network, the entity that performs mobility management<br>
and user authentication for the UE changes from the MME prior to moving (the old MME) to the<br>
MME subsequent to moving (the new MME). When the UE moves from a 2G/3G network to an<br>
LTE network, the entity that performs mobility management and user authentication for the UE<br>
changes from the SGSN to the MME. The security capabilities of different entities that perform<br>
mobility management and user authentication for the UE may differ. Therefore, the UE needs to<br>
renegotiate security capabilities with the new MME. For the LTE network, the negotiation of<br>
security capabilities between the UE and the MME is primarily negotiation of the NAS security<br>
algorithm and the corresponding key negotiation.<br>
FIG. 1 is a flowchart of security capability negotiation between the UE and the MME in the prior art.<br>
As shown in FIG. 1, the method of security capability negotiation includes the following steps:<br>
Step 100: The UE sends a TAU Request to the new MME.<br>
In this step, the UE sends a TAU Request to the new MME through an evolution Node B (eNB) of<br>
the LTE radio access network. For ease of description in the following text, the message transferred<br>
by an eNB between the UE and the MME is simplified as communication performed directly<br>
between the UE and the MME.<br>
Steps 101-102: The new MME sends a Mobility Management Context Request message to the old<br>
 <br>
MME. After receiving the message, the old MME returns a Mobility Management Context<br>
Response message to the new MME, and this message carries the current root key "Kasme", the<br>
current integrity protection key (Knas-int), the current NAS encryption key (Knas-enc), the current<br>
NAS security algorithm, and the security capabilities supported by the UE (including the<br>
NAS/Radio Resource Control (RRC)/User Plane (UP) security algorithm supported by the UE).<br>
Step 103: According to the intersection of the NAS security algorithms in the UE's security<br>
capabilities, the NAS security algorithms supported by the new MME, and the NAS security<br>
algorithms enabled by the system, the new MME selects a new NAS security algorithm, including<br>
the NAS integrity protection algorithm and the NAS encryption algorithm.<br>
Step 104: The new MME sends TAU Accept message to the UE. The message carries the selected<br>
new NAS security algorithm.<br>
In practice, other steps, unrelated to security capability negotiation that occurs between step 103 and<br>
step 104, are omitted here.<br>
Step 105: The UE receives the TAU Accept message that carries the selected NAS security<br>
algorithm to share the NAS security algorithm with the MME. Afterward, the UE checks the NAS<br>
security algorithm carried in the TAU Accept message. If the carried NAS security algorithm is the<br>
same as the NAS security algorithm currently used by the UE, the Knas-int and the Knas-enc<br>
currently used by the UE serve as the subsequent NAS protection key. If the carried NAS security<br>
algorithm is different from the NAS security algorithm currently used by the UE, a new Knas-int<br>
and a new Knas-enc need to be deduced according to the root key (Kasme) currently used by the<br>
UE and other parameters, and serve as the subsequent NAS protection key shared with the MME. In<br>
this way, the security capabilities are negotiated between the UE and the MME.<br>
Evidently, no process of preventing bidding down attacks is performed in the prior art. A bidding<br>
down attack means: Supposing that the UE supports two security algorithms simultaneously<br>
(high-intensity algorithm Al and low-intensity algorithm A2) and the MME also supports such two<br>
algorithms, the result of negotiation between the UE and the MME ought to be the high-intensity<br>
algorithm Al. However, if the security capabilities supported by the UE are modified by an attacker<br>
before the new MME knows the security capabilities supported by the UE, for example, if the<br>
attacker reserves only the low-intensity algorithm A2, the new MME has to select the low-intensity<br>
algorithm A2 and sends it to the UE. That is, the result of negotiation between the UE and the MME<br>
is not the high-intensity algorithm A1, but the low-intensity algorithm A2, which is more vulnerable<br>
to attacks, namely, bidding down attacks. Therefore, the prior art does not prevent bidding down<br>
attacks. The result of negotiation between the MME and the UE may be a low-intensity algorithm.<br>
Consequently, in the subsequent communication process, the communication between the UE and<br>
 <br>
the MME is vulnerable to attacks, and the subsequent interaction between the UE and the network is<br>
not secure.<br>
SUMMARY<br>
According to a first aspect of the invention a method for preventing bidding down attacks during<br>
motion of the UE is disclosed to ensure security of subsequent interaction between the UE and the<br>
network.<br>
According to a second aspect of the invention a system for preventing bidding down attacks during<br>
motion of the UE is disclosed to ensure security of subsequent interaction between the UE and the<br>
network.<br>
According to a third aspect of the invention an MME is disclosed to ensure security of subsequent<br>
interaction between the UE and the network.<br>
According to a fourth aspect of the invention a UE is disclosed to ensure security of subsequent<br>
interaction between the UE and the network.<br>
In order to fulfill the foregoing objectives, the technical solution under the present invention is<br>
implemented as follows:<br>
In a preferred implementation form the method for preventing bidding down attacks during motion<br>
of a UE includes:<br>
sending, by a UE, a TAU Request message to a MME; wherein the TAU Request carries<br>
UE's stored security capabilities;<br>
receiving UE's security capabilities sent by the MME; and<br>
determining that a bidding down attack occurs if the received UE's security capabilities are<br>
inconsistent with the stored UE's security capabilities.<br>
In a preferred implementation form the system for preventing bidding down attacks during motion<br>
of a UE includes:<br>
a UE, configured to: send a TAU Request message to the MME; receive the UE's security<br>
capabilities sent by the MME, wherein the TAU Request carries UE's stored security capabilities;<br>
and check whether the received UE's security capabilities are consistent with the stored UE's<br>
security capabilities; and<br>
an MME, configured to: receive the TAU Request message from the UE, obtain the UE's<br>
security capabilities from the TAU Request, and send the obtained UE's security capabilities to the<br>
UE.<br>
In a preferred implementation form the UE includes:<br>
an updating module, configured to: send a TAU Request message to the MME; wherein the<br>
 <br>
TAU Request carries UE's stored security capabilities; and<br>
a judging module, configured to: receive the UE's security capabilities sent by the MME,<br>
and judge whether the received UE's security capabilities are consistent with the security<br>
capabilities stored by the storing module.<br>
In the technical solution under the present invention, after the UE sends a TAU Request message to<br>
the MME, the UE receives the UE's security capabilities obtained and sent by the MME, and<br>
determines that a bidding down attack occurs if the received UE's security capabilities are<br>
inconsistent with the stored security capabilities. Therefore, if the UE's security capabilities<br>
obtained by the MME are attacked, when the MME delivers the UE's security capabilities to the UE<br>
in the process of security capability negotiation between the UE and the MME, the UE determines<br>
that a bidding down attack occurs if finding that the received UE's security capabilities are<br>
inconsistent with the stored security capabilities according to the technical solution under the<br>
present invention. In this way, bidding down attacks are prevented, and the security of the<br>
subsequent interaction between the UE and the network is ensured.<br>
BRIEF DESCRIPTION OF THE DRAWINGS<br>
In order to make the technical solution under the present invention or in the prior art clear, the<br>
accompanying drawings for illustrating the embodiments of the present invention or illustrating the<br>
prior art are outlined below. Evidently, the accompanying drawings are for the exemplary purpose<br>
only, and those skilled in the art can derive other drawings from such accompanying drawings<br>
without making any creative effort.<br>
FIG. 1 is a flowchart of a method for security capability negotiation during motion of a UE in the<br>
prior art;<br>
FIG. 2 is a flowchart of a method for preventing bidding down attacks during motion of a UE<br>
according to an embodiment of the present invention;<br>
FIG. 3 is a flowchart of a method for security capability negotiation during motion of a UE<br>
according to an embodiment of the present invention; and<br>
FIG. 4 shows a structure of a system for preventing bidding down attacks during motion of a UE<br>
according to an embodiment of the present invention.<br>
DETAILED DESCRIPTION<br>
The technical solution under the present invention is expounded below by reference to<br>
accompanying drawings. Evidently, the embodiments given herein are for the exemplary purpose<br>
only, and are not all of the embodiments of the present invention. Those skilled in the art can derive<br>
other embodiments from the embodiments given herein<br>
FIG. 2 is a flowchart of a method for preventing bidding down attacks during motion of a UE<br>
 <br>
according to an embodiment of the present invention. As shown in FIG. 2, the method includes the<br>
following steps:<br>
In step 200, the new MME receives a TAU Request message from the UE. In step 201, the new<br>
MME obtains the UE's security capabilities. In step 202, through a TAU Accept message, the UE's<br>
security capabilities are sent to the UE. In step 203, the UE checks whether the received UE's<br>
security capabilities are consistent with the stored security capabilities.<br>
FIG. 3 is a flowchart of a method for security capability negotiation during motion of a UE<br>
according to an embodiment of the present invention. The method includes the following steps:<br>
Step 300: The UE sends a TAU Request message to the new MME.<br>
In this step, the UE sends a TAU Request to the new MME through an evolution Node B (eNB) of<br>
the LTE radio access network. For ease of description in the following text, the communication<br>
transferred by an eNB between the UE and the MME is simplified as communication performed<br>
directly between the UE and the MME.<br>
The TAU Request sent by the UE to the MME in this step may carry not only the parameters well<br>
known to those skilled in the art such as Temporary Mobile Subscriber Identifier (TMSI), but also<br>
the UE's security capabilities, for example, NAS security algorithms (NAS integrity protection<br>
algorithm and encryption algorithm), the RRC security algorithms (RRC integrity protection<br>
algorithm and encryption algorithm), and/or UP security algorithm (UP encryption algorithm).<br>
Steps 301-302: The new MME sends a Mobility Management Context Request message to the old<br>
MME. The old MME sends a Mobility Management Context Response message to the new MME,<br>
and this message carries the current NAS security algorithm list and the current root key (Kasme).<br>
If the TAU Request sent by the UE to the MME in step 300 does not carry the UE's security<br>
capabilities, the old MME searches for the UE's security capabilities after receiving the Mobility<br>
Management Context Request message, and adds the found UE's security capabilities into a<br>
Mobility Management Context Response message sent to the MME.<br>
Step 303: According to the intersection of the NAS security algorithms in the UE's security<br>
capabilities, the NAS security algorithms supported by the new MME, and the NAS security<br>
algorithms enabled by the system, the new MME selects a new NAS security algorithm. Afterward,<br>
a new NAS protection key (including a Knas-int and a Knas-enc) is deduced according to the root<br>
key (Kasme) currently used by the UE and other parameters, and serves as the subsequent NAS<br>
security key.<br>
If the new NAS algorithm is different from the current NAS security algorithm returned by the old<br>
MME, it is necessary to reset the counter to prevent replay attacks.<br>
Step 304: The new MME sends TAU Accept message to the UE. The message carries the selected<br>
 <br>
new NAS security algorithm and the UE's security capabilities.<br>
In this step, the MME may perform NAS integrity protection for the TAU Accept message. For<br>
example, by using the Knas-int deduced in step 303, the information in the TAU Accept, and the<br>
NAS integrity protection algorithm in the NAS security algorithms, the MME deduces a NAS<br>
integrity protection Message Authentication Code (NAS-MAC) value, and adds this value into the<br>
TAU Accept message and sends the message to the UE.<br>
In this step, the MME may deliver the selected new NAS security algorithm and the UE's security<br>
capabilities to the UE by using a Security Mode Command (SMC) request message, the details of<br>
which are not elaborated here any further.<br>
In practice, other steps unrelated to security capability negotiation may occur between step 303 and<br>
step 304, and are omitted here.<br>
Step 305: The UE checks whether the received UE's security capabilities are consistent with the<br>
stored security capabilities.<br>
In this step, if the UE finds that the received UE's security capabilities are consistent with the<br>
security capabilities stored by the UE, the UE determines that no bidding down attack occurs;<br>
otherwise, the UE determines that a bidding down attack occurs. If it is determined that the security<br>
capability negotiation fails, the security capability negotiation process may be initiated again, thus<br>
preventing bidding down attacks.<br>
In this step, the UE may further check the NAS security algorithm carried in the TAU Accept<br>
message. If the carried NAS security algorithm is the same as the NAS security algorithm currently<br>
used by the UE, the Knas-int currently used by the UE and the Knas-enc currently used by the UE<br>
are used as the subsequent NAS protection key. If the carried NAS security algorithm is different<br>
from the NAS security algorithm currently used by the UE (or the old MME), a new Knas-int and a<br>
new Knas-enc need to be deduced according to the root key (Kasme) currently used by the UE and<br>
other parameters, and serve as the subsequent NAS security key. The counter is reset to prevent<br>
replay attacks.	<br>
In this step, the UE may check whether the NAS-MAC in the received TAU accept message is<br>
correct. If the NAS-MAC is not correct, the UE determines that the security capability negotiation<br>
fails, and may reinitiate the security capability negotiation process. For example, according the<br>
deduced Knas-enc, the information in the TAU Accept, and the NAS integrity protection algorithm<br>
carried in the TAU Accept message, the UE deduces a NAS-MAC, and checks whether the deduced<br>
NAS-MAC is the same as the NAS-MAC carried in the TAU Accept message. If they are the same,<br>
the message is not changed in the transmission process; otherwise, the message is changed in the<br>
transmission process and the security capability negotiation fails.<br>
 <br>
In this way, the NAS security capability negotiation between the UE and the new MME is<br>
completed in the TAU process.<br>
In the foregoing process, the detailed deducing process for the UE and the MME to deduce the NAS<br>
protection key according to the Kasme is based on the prior art, and is not elaborated herein.<br>
FIG. 4 shows a structure of a system for preventing bidding down attacks during motion of a UE<br>
according to an embodiment of the present invention. As shown in FIG. 4, the system includes:<br>
a UE, configured to: send a TAU Request message to the MME; receive the UE's security<br>
capabilities sent by the new MME; and check whether the received UE's security capabilities are<br>
consistent with the stored security capabilities; and<br>
an MME, configured to: receive the TAU Request message from the UE, obtain the UE's<br>
security capabilities, and send the obtained UE's security capabilities to the UE.<br>
Further, the UE adds the UE's security capabilities into the TAU Request message.<br>
Specifically, the MME includes:<br>
an obtaining module 11, configured to receive the TAU Request message from the UE,<br>
where the message carries the UE's security capabilities; and<br>
a delivering module 12, configured to send the UE's security capabilities received by the<br>
obtaining module 11 to the UE through a TAU Response message.<br>
The obtaining module 11 further obtains the current root key. The MME further includes:<br>
a selecting module 13, configured to select a NAS security algorithm according to the UE's<br>
security capabilities; and<br>
a key deducing module 14, configured to deduce a NAS protection key according to the<br>
root key obtained by the obtaining module 11 and the NAS security algorithm selected by the<br>
selecting module 13.<br>
Accordingly, the UE includes:<br>
an updating module 21, configured to send a TAU Request message to the MME; and<br>
a judging module 22, configured to: receive the UE's security capabilities sent by the MME,<br>
and judge whether the received UE's security capabilities are consistent with the stored security<br>
capabilities.<br>
The UE further includes a storing module 23, configured to store the UE's security capabilities. The<br>
updating module 21 may add the UE's security capabilities into the TAU Request message.<br>
The technical solution under the present invention brings at least the following benefits.<br>
Firstly, the UE sends a TAU Request message to the MME, and then receives the UE's security<br>
capabilities obtained and sent by the MME; and determines that a bidding down attack occurs if<br>
finding that the received UE's security capabilities are inconsistent with the stored security<br>
 <br>
capabilities. Therefore, if the UE's security capabilities obtained by the MME are attacked or<br>
modified, when the MME delivers the UE's security capabilities to the UE in the process of security<br>
capability negotiation between the UE and the MME, the UE can detect bidding down attacks<br>
according to the technical solution under the present invention. In this way, bidding down attacks<br>
are prevented.<br>
Secondly, the new MME selects a new NAS security algorithm according to the relevant security<br>
capabilities (NAS/RRC/UP security algorithm) of the UE and the LTE network. In the prior art, the<br>
old MME returns the UE's security capabilities to the new MME through a Context Response<br>
message. The UE reports all its security capabilities to the old MME through other processes before<br>
the TAU process. Therefore, the prior art is practicable for an idle UE that moves inside an LTE<br>
network. However, the idle UE may move from a 2G/3G network to an LTE network. Before<br>
moving to the LTE network, the UE reports only the security capabilities related to the 2G/3G<br>
network to the SGSN, and does not report the security capabilities related to the LTE network to the<br>
SGSN proactively. After the UE moves to the LTE network, the prior art is still applied, the SGSN<br>
still needs to query the UE about the UE's security capabilities related to the LTE network before<br>
the SGSN can report such security capabilities to the new MME, which may involve upgrade of the<br>
existing network increase unnecessary rounii trips. In the technical solution under the present<br>
invention, the UE sends the UE's security capabilities to the new MME through a TAU Request<br>
message. Therefore, the new MME does not need to query the old MME about the UE's security<br>
capabilities when the UE moves inside the LTE network. When the UE moves from a 2G/3G<br>
network to an LTE network, the SGSN does not need to query the UE's security capabilities. In this<br>
way, the processing of the network equipment is simplified, and the working efficiency of the<br>
system is improved.<br>
Thirdly, in the prior art, after the MME selects the new NAS security algorithm, the MME needs to<br>
judge whether the new NAS security algorithm is consistent with the NAS security algorithm<br>
currently used by the old MME. If the new NAS security algorithm is consistent with the NAS<br>
security algorithm currently used by the old MME, the Knas-int and the Knas-enc currently in use<br>
serve as the subsequent NAS security key. If the new NAS security algorithm is inconsistent with<br>
the NAS security algorithm currently used by the old MME, a new Knas-int and a new Knas-enc<br>
need to be deduced according to the root key (Kasme) currently in use and other parameters, and<br>
serve as the subsequent NAS security key. Therefore, the old MME needs to return the Knas-int and<br>
the Knas-enc currently in use to the new MME through an Context Response message. Such<br>
parameters are intended for the new MME to use the existing keys as far as possible and reduce the<br>
calculation load. In fact, however, such parameters are useful only when the new NAS security<br>
 <br>
algorithm selected by the MME is consistent with the NAS security algorithm currently used by the<br>
old MME. If the new NAS security algorithm is different from the NAS security algorithm<br>
currently used by the old MME, the new MME still needs to deduce such keys, which does not<br>
reduce the calculation load, but makes the MME processing more complicated. The parameters<br>
carried in the message sent to the new MME are redundant. In the technical solution under the<br>
present invention, after the new MME selects a new NAS security algorithm, no matter whether the<br>
selected NAS algorithm is consistent with the NAS security algorithm currently in use, the new<br>
MME deduces the algorithm again, thus eliminating the redundancy of the parameters in the<br>
message exchanged between the old MME and the new MME. Meanwhile, the present invention<br>
makes use of the existing NAS protection key algorithm to obtain the NAS protection key, thus<br>
simplifying the MME processing. With the algorithm being the same as that in the prior art, the<br>
present invention does not increase any calculation load.<br>
It is understandable to those skilled in the art that all or part of the steps of the foregoing<br>
embodiments may be implemented by hardware instructed by a computer program. The program<br>
may be stored in a computer-readable storage medium. Once being executed, the program performs<br>
the processes covered in the foregoing embodiments. The storage medium may be a magnetic disk,<br>
compact disk, Read-Only Memory (ROM), or Random Access Memory (RAM).<br>
t<br>
Although the invention has been described through several preferred embodiments, the invention is<br>
not limited to such embodiments. It is apparent that those skilled in the art can make modifications<br>
and variations to the invention.<br>
 <br>
WE CLAIM:<br>
1. A method for preventing bidding down attacks during motion of a User Equipment, UE,<br>
comprising:<br>
sending, by the UE, a Tracking Area Update, TAU, Request to a Mobility Management Entity,<br>
MME; wherein the TAU Request carries UE's stored security capabilities;<br>
receiving UE's security capabilities sent by the MME; and<br>
determining that a bidding down attack occurs if the received UE's security capabilities are<br>
inconsistent with the stored UE's security capabilities.<br>
2.	The method of claim 1, wherein before the receiving UE's security capabilities sent by the<br>
MME, the method further comprises:<br>
obtaining, by the MME, the UE's security capabilities from the TAU Request.<br>
3.	The method of claim 1, wherein before the receiving UE's security capabilities sent by the<br>
MME, the method further comprises:<br>
selecting a Non Access Signaling, NAS, security algorithm according to the received UE's<br>
security capabilities.<br>
4.	The method of claim 1, wherein before the receiving UE's security capabilities sent by the<br>
MME, the method further comprises:<br>
obtaining, by the MME, a root key currently in use; and<br>
deducing a NAS protection key according to the root key currently in use.<br>
5.	The method of claim 3, wherein after the selecting the NAS security algorithm according<br>
to the received UE's security capabilities, the method further comprises:<br>
sending, by the MME, a TAU Accept message carrying the received UE's security capabilities<br>
to the UE, wherein:<br>
the TAU Accept message further carries the selected NAS security algorithm.<br>
6.	The method of claim 5, after the sending, by the MME, the TAU Accept message carrying<br>
the received UE's security capabilities to the UE, the method further comprises:<br>
judging, by the UE, whether the received NAS security algorithm is the same as the NAS<br>
security algorithm currently in use; and<br>
using a current NAS protection key directly if the received NAS security algorithm is the same<br>
as the NAS security algorithm currently in use; or<br>
deducing the NAS protection key according to the root key currently in use if the received<br>
NAS security algorithm is different from the NAS security algorithm currently in use.<br>
 <br>
7.	A system for preventing bidding down attacks during motion of a User Equipment, UE,<br>
comprising:<br>
a UE, configured to send a Tracking Area Update, TAU, Request to a Mobility Management<br>
Entity, MME, wherein the TAU Request carries UE's stored security capabilities; receive UE's<br>
security capabilities sent by the MME; and check whether the received UE's security capabilities<br>
are consistent with the stored UE's security capabilities; and<br>
the MME, configured to receive the TAU Request from the UE, obtain the UE's security<br>
capabilities from the TAU Request, and send the obtained UE's security capabilities to the UE.<br>
8.	The system of claim 7, the MME comprises:<br>
an obtaining module (11), configured to receive the TAU Request message from the UE, obtain<br>
the UE's security capabilities from the TAU Request; and<br>
a delivering module (12), configured to send the UE's security capabilities obtained by the<br>
obtaining module (11) to the UE through a TAU Accept message.<br>
9.	The system of any of claims 7 to 8, the MME further comprises: a selecting module (13),<br>
configured to select a Non Access Signaling, NAS, security algorithm according to the obtained<br>
UE's security capabilities.<br>
10.	The MME of claim 9, wherein the obtaining module (11) is further configured to obtain a<br>
root key currently in use; and the MME further comprises:<br>
a key deducing module (14), configured to deduce a NAS protection key according to the root<br>
key obtained by the obtaining module (11) and the NAS security algorithm selected by the selecting<br>
module (13).<br>
11.	A Mobility Management Entity, MME, comprising:<br>
an obtaining module (11), configured to receive a Tracking Area Update, TAU, Request<br>
message from a User Equipment, UE, wherein the message carries UE's security capabilities; and<br>
a delivering module (12), configured to send the UE's security capabilities received by the<br>
obtaining module (11) to the UE through a TAU Accept message.<br>
12.	The MME of claim 11, the MME further comprises:<br>
a selecting module (13), configured to select a Non Access Signaling, NAS, security algorithm<br>
according to the received UE's security capabilities.<br>
13.	The MME of claim 11, wherein the obtaining module (11) is further configured to obtain a<br>
root key currently in use; and the MME further comprises:<br>
a key deducing module (14), configured to deduce a NAS protection key according to the root<br>
key obtained by the obtaining module (11) and the NAS security algorithm selected by the selecting<br>
module (13).<br>
 <br>
14.	An User Equipment, UE, comprising:<br>
an updating module (21), configured to send a Tracking Area Update, TAU, Request message<br>
to a Mobility Management Entity, MME; wherein the TAU Request carries UE's stored security<br>
capabilities; and<br>
a judging module (22), configured to receive UE's security capabilities sent by the MME, and<br>
judge whether the received UE's security capabilities are consistent with the stored security<br>
capabilities.<br>
15.	The UE of claim 14, further comprising: a storing module (23), configured to store the<br>
UE's security capabilities, wherein:<br>
the updating module (21) is further configured to add the UE's security capabilities stored by<br>
the storing module (23) into the TAU Request message.<br>
 <br>
<br>
A method for preventing bidding down attacks during motion of a UE is disclosed herein. The<br>
method includes: The UE sends a TAU Request message to a new MME; the TAU Request carries<br>
UE's stored security capabilities; the UE receives UE's security capabilities sent by the MME; and<br>
the UE checks whether the received UE's security capabilities are consistent with the stored UE's<br>
security capabilities. A system, an MME, and a UE for preventing bidding down attacks during<br>
motion of the UE are disclosed herein. When the UE performs security capability negotiation with<br>
the MME, the UE can check whether the received security capabilities are consistent with the stored<br>
security capabilities, and determine whether a bidding down attack exists, thus preventing bidding<br>
down attacks.<br>
</td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/viewdoc.aspx?id=43o2Z54gOIQwq8QJm6YBEA==&amp;amp;loc=wDBSZCsAt7zoiVrqcFJsRw==" target="_blank" style="word-wrap:break-word;">http://ipindiaonline.gov.in/patentsearch/GrantedSearch/viewdoc.aspx?id=43o2Z54gOIQwq8QJm6YBEA==&amp;amp;loc=wDBSZCsAt7zoiVrqcFJsRw==</a></p>
		<br>
		<div class="pull-left">
			<a href="279133-an-immunogenic-composition-for-infants-comprising-a-multivalent-streptococcus-pneumoniae-vaccine.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="279135-a-method-of-producing-a-soybean-plant.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>279134</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>4213/KOLNP/2009</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>02/2017</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>13-Jan-2017</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>12-Jan-2017</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>04-Dec-2009</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>HUAWEI TECHNOLOGIES CO., LTD.</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>HUAWEI ADMINISTRATION BUILDING, BANTIAN, LONGGANG DISTRICT, SHENZHEN, GUANGDONG 518129, P.R. CHINA</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>HE, CHENGDONG</td>
											<td>HUAWEI ADMINISTRATION BUILDING, BANTIAN, LONGGANG DISTRICT, SHENZHEN, 518129, GUANGDONG P.R. CHINA</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04Q 7/32</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/CN2008/072192</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2008-08-29</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>200710149327.5</td>
									<td>2007-09-03</td>
								    <td>China</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/279134-method-system-and-apparatus-for-preventing-bidding-down-attacks-during-motion-of-user-equipment by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 00:28:41 GMT -->
</html>
