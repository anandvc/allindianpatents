<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/265392-efficient-rate-control-techniques-for-video-encoding by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 04:28:18 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 265392:EFFICIENT RATE CONTROL TECHNIQUES FOR VIDEO ENCODING</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">EFFICIENT RATE CONTROL TECHNIQUES FOR VIDEO ENCODING</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>This disclosure describes rate control techniques that can improve video encoding. In particular, the described rate control techniques exploit relationships between the number of bits encoded per frame and the number of non-zero coefficients of the video blocks after quantization. The number of number of non-zero coefficients of the video blocks after quantization is referred to as rho (p). The value of p is generally proportional to the number of bits used in the video encoding. This disclosure utilizes a relationship between p and a quantization parameter (QP) in order to achieve rate controlled video encoding. More specifically, this disclosure provides techniques for generating a lookup table (LUT) that maps values of/) to different QPs.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>TECHNICAL FIELD<br>
[0001] The present application claims the benefit of U.S. Provisional Application Patent No. 60/586,963 filed July 8, 2004.<br>
[0002] This disclosure relates to digital video processing and, more particularly, rate controlled encoding of video sequences.<br>
BACKGROUND<br>
[0003] Digital video capabilities can be incorporated into a wide range of devices, including digital televisions, digital direct broadcast systems, wireless communication devices, personal digital assistants (PDAs), laptop computers, desktop computers, digital cameras, digital recording devices, cellular or satellite radio telephones, and the like. Digital video devices can provide significant improvements over conventional analog video systems in creating, modifying, transmitting, storing, recording and playing full motion video sequences.<br>
[0004] A number of different video encoding standards have been established for encoding digital video sequences. The Moving Picture Experts Group (MPEG), for example, has developed a number of standards including MPEG-1, MPEG-2 and MPEG-4. Other standards include the International Telecommunication Union (ITU) H.263 standard, QuickTime™ technology developed by Apple Computer of Cupertino California, Video for Windows™ developed by Microsoft Corporation of Redmond, Washington, Indeo™ developed by Intel Corporation, RealVideo™ from RealNetworks, Inc. of Seattle, Washington, and Cinepak™ developed by SuperMac, Inc. Furthermore, new standards continue to emerge and evolve, including the ITU H.264 standard and a number of proprietary standards,<br>
[0005] Many video encoding standards allow for improved transmission rates of video sequences by encoding data in a compressed fashion. Compression can reduce the overall amount of data that needs to be transmitted for effective transmission of video frames. Most video encoding standards, for example, utilize graphics and video compression techniques designed to facilitate video and image transmission over a narrower bandwidth than can be achieved without the compression.<br><br>
[0006] The MPEG standards and the ITU H.263 and ITU K264 standards, for example, support video encoding techniques that utilize similarities between successive video frames, referred to as temporal or inter-frame correlation, to provide inter-frame compression. The inter-frame compression techniques exploit data redundancy across frames by converting pixel-based representations of video frames to motion representations. In addition, some video encoding techniques may utilize similarities within frames, referred to as spatial or intra-frame correlation, to further compress the video frames,<br>
[0007] In order to support compression, a digital video device typically includes an encoder for compressing digital video sequences, and a decoder for decompressing the digital video sequences. In many cases, the encoder and decoder form an integrated encoder/decoder (CODEC) that operates on blocks of pixels within frames that define the video sequence. In the MPEG-4 standard, for example, the encoder typically divides a video frame to be transmitted into video blocks referred to as "macroblocks." The ITU H.264 standard supports 16 by 16 video blocks, 16 by 8 video blocks, 8 by 16 video blocks, 8 by 8 video blocks, 8 by 4 video blocks, 4 by 8 video blocks and 4 by 4 video blocks. Other standards may support differently sized video blocks, [0008] For each video block in the video frame, an encoder searches similarly sized video blocks of one or more immediately preceding video frames (or subsequent frames) to identify the most similar video block, referred to as the fifibest prediction." The process of comparing a current video block to video blocks of other frames is generally referred to as motion estimation. Once a "best prediction" is identified for a video block, the encoder can encode the differences between the current video block and the best prediction. This process of encoding the differences between the current video block and the best prediction includes a process referred to as motion compensation. Motion compensation comprises a process of creating a difference block indicative of the differences between the current video block to be encoded and the best prediction. In particular, motion compensation usually refers to the act of fetching the best prediction block using a motion vector, and then subtracting the best prediction from an input block to generate a difference block.<br>
[0009] After motion compensation has created the difference block, a series of additional encoding steps are typically performed to encode the difference block. These additional encoding steps may depend on the encoding standard being used. In MPEG-<br><br>
4 compliant encoders, for example, the additional encoding steps may include an 8x8 discrete cosine transform, followed by scalar quantization, followed by a raster-to-zigzag reordering, followed by run-length encoding, followed by Huffman encoding. An encoded difference block can be transmitted along with a motion vector that indicates which video block from the previous frame was used for the encoding. A decoder receives the motion vector and the encoded difference block, and decodes the received information to reconstruct the video sequences.<br>
[0010] A number of rate control techniques have been developed for video encoding* Rate control techniques are particularly important in order to facilitate real-time transmission of video sequences, but may also be used in non-real-time encoding settings. For rate control, the encoding techniques dynamically adjust the number of bits that are encoded per frame. In particular, rate control can restrict the number of bits that are encoded per frame in order to ensure that the video sequence can be effectively encoded at a given rate and transmitted over an allocated bandwidth. If the encoding techniques are not responsive to scene changes of a video sequence, the bit rate for realtime transmission of the video sequence can vary significantly as the scenes change* Therefore, in order to define a substantially constant bit rate, the number of bits per frame are dynamically adjusted during the encoding.<br>
[0011] One way to achieve rate controlled encoding is to allow for adjustment of a quantisation parameter (QP) during the video encoding process. The QP directly impacts the number of bits that are encoded per second. As the QP increases, less data is preserved and the quality of the video encoding may degrade. As the QP decreases, more data is preserved and the quality of the video encoding improves. However, if the QP is too small, the number of encoded bits per second may exceed an allocated bandwidth, and compromise the ability to transfer the frames within the limited amount of bandwidth. By selecting the QP in a dynamic fashion, the bit rate for transmission of video frames can be made substantially constant.<br>
SUMMARY<br>
[0012] This disclosure describes rate control techniques that can improve video encoding. In particular, the described rate control techniques exploit relationships between the number of bits encoded per frame and the number of non-zero coefficients of the video blocks after quantization. The number of non-zero coefficients of the video<br><br>
blocks of the frames after quantization is referred to as rho (/?). The value of/? is generally proportional to the number of bits used in the video encoding process. This disclosure utilizes a relationship between p and a quantization parameter (QP) in order to achieve rate controlled video encoding. More specifically, this disclosure provides techniques for generating a lookup table (LUT) that maps values of p to different QPs. QPs can then be selected to achieve a desired encoding rate, which is linearly related to p. The described techniques can simplify the video encoder and significantly reduce the number of computations required to generate LUTs used in rate controlled video encoding.<br>
[0013] This disclosure also describes a video encoding device that implements a rate control technique as described herein. In one embodiment, the video encoding device comprises an encoder that calculates thresholds for un-quanti2ed coefficients of a video block, wherein the thresholds identify when quantized coefficients become non-zero for different quantization parameters (QP's), and generates ap-QP look-up table (LUT) mapping numbers of non-zero coefficients after quantization (p's) to the QP's using the threshold. The video encoding device also includes a memory that stores the p-QP LUT. In a more specific embodiment, the encoder generates a threshold-QP LUT mapping the thresholds to QP's, and generates the p-QP LUT using the threshold-QP LUT. In any case, by exploiting the thresholds that identify when quantized coefficients become non-zero for different quantisation parameters, the described techniques can significantly simplify the generation of ihcp-QP LUT.<br>
[0014] These and other techniques described herein may be implemented in a digital video device in hardware, software, firmware, or any combination thereof. If implemented in software, the software may be executed in a digital signal processor (DSP). In that case, the software that executes the techniques may be initially stored in a computer readable medium and loaded and executed in the DSP for effective rate controlled encoding in a digital video device. Additional details of various embodiments are set forth in the accompanying drawings and the description below. Other features, objects and advantages will become apparent from the description and drawings, and from the claims.<br><br>
BRIEF DESCRIPTION OF DRAWINGS<br>
[0015] FIG. 1 is a block diagram illustrating an exemplary system in which a source<br>
digital video device transmits an encoded sequence of video data to a receive digital<br>
video device.<br>
[0016] FIG 2 is an exemplary block diagram of a digital video device according to an<br>
embodiment of this disclosure.<br>
[0017] FIG. 3 is a graph illustrating an approximately linear relationship between the<br>
number of bits per frame and rho (p).<br>
[0018] FIG 4 is an exemplary circuit diagram showing a circuit that can directly<br>
compute a p(0?) lookup table (LUT) in compliance with the MPEG-4 standard or the<br>
ITU H.263 standard.<br>
[0019] FIGS. 5A and 5B are exemplary circuit diagrams showing circuits that can be<br>
used to directly compute a/&gt;(OP) LUT in compliance with die ITU H.264 standard.<br>
[0020] FIG 6 is a histogram of intra DC coefficients illustrating that it is not necessary<br>
to use a separate equation (or table look-up) for the intra ac coefficients as the chances<br>
of these coefficients becoming zero after quantization are remote.<br>
[0021] FIG. 7 is an exemplary circuit diagram of an exemplary circuit that maybe used<br>
to calculate thresholds to be used in the creation of a threshold-OP LUT, in compliance<br>
with the ITU H.264 standard.<br>
[0022] FIGS. 8A and 8B are graphs illustrating the effect of rounding the bias used for<br>
address calculation of the threshold LUT.<br>
[0023] FIG, 9 is an exemplary circuit diagram of a circuit that can be used to<br>
accumulate threshold QPs to form a threshold-^ table.<br>
[0024] FIG. 10 includes four different plots showing the bits used per frame and peak<br>
signal to noise ratio (PSNR) per frame resulting from a conventional baseline approach<br>
and thep-domain rate control approach described herein.<br>
[0025] FIG. 11 is a graph of the standard deviations of bits used for different video clips<br>
using a baseline method, ap-domain method as described herein, and an adapted p-<br>
domain method as described herein.<br>
[0026] FIG. 12 includes graphs and corresponding video frames illustrating that that the<br>
significant reduction in frame-level bit-rate variance caused by the /?-domain rate<br>
control does not result in any degradation in the quality of encoded video sequences.<br><br>
DETAILED DESCRIPTION<br>
[0027] This disclosure describes rate control techniques that can be used to improve video encoding. The techniques may be used with any of a wide variety of video encoding standards, such as the MPEG-4 standard, the ITU H.263 standard, the ITU H.264 standard, or other standards. Specifically, the techniques exploit relationships between the number of bits encoded per frame (the encoding rate), and the number of non-zero coefficients of the video blocks of the frames after quantization. The number of non-zero coefficients of the video blocks of the frames after quantization is referred to as rho (/?). The value of p is generally proportional to the quantization parameter (QP) used in the video encoding. Accordingly, this disclosure utilizes the relationship between/) and QP in order to achieve rate controlled video encoding. More specifically, this disclosure provides techniques for generating a lookup table (LUT) that maps values of p to different QPs. The described techniques can simplify the video encoder and significantly reduce the number of computations required to generate LUTs used in rate controlled video encoding in the p-domain. A video encoder uses the LUT to select a QP that ensures the desired encoding rate is achieved.<br>
[0028] FIG. 1 is a block diagram illustrating an example system 10 in which a source device 12 transmits an encoded sequence of video data to a receive device 14 via a communication link 15. Source device 12 and receive device 14 are both digital video devices. In particular, source device 12 encodes video data consistent with a video standard such as the MPEG-4 standard, the ITU H.263 standard, the ITU H.264 standard, or any of a wide variety of other standards that can make use of rate controlled video encoding. One or both of devices 12,14 of system 10 implement rate control techniques, as described in greater detail below, in order to improve the video encoding process. Such rate control techniques are particularly useful for real-time transmission of video sequences over a limited bandwidth communication link 15, such as a wireless communication link.<br>
[0029] Communication link 15 may comprise a wireless link, a physical transmission line, fiber optics, a packet based network such as a local area network, wide-area network, or global network such as the Internet, a public switched telephone network (PSTN), or any other communication link capable of transferring data. Thus, communication link 15 represents any suitable communication medium, or possibly a<br><br>
collection of different networks and links, for transmitting video data from source device 12 to receive device 14. As mentioned, communication link 15 may have limited bandwidth, making rate control very important for real-time transmission of video sequences over link 15.<br>
[0030] Source device 12 may comprise any digital video device capable of encoding and transmitting video data. Source device 12 may include a video memory 16 to store digital video sequences, a video encoder 18 to encode the sequences, and a transmitter 20 to transmit the encoded sequences over communication link 15 to source device 14, Video encoder 18 may include, for example, various hardware, software or firmware, or one or more digital signal processors (DSP) that execute programmable software modules to control the video encoding techniques, as described herein. Associated memory and logic circuitry may be provided to support the DSP in controlling the video encoding techniques.<br>
[0031] Source device 12 may also include a video capture device 23, such as a video camera, to capture video sequences and store the captured sequences in memory 16. In particular, video capture device 23 may include a charge coupled device (CCD), a charge injection device, an array of photodiodes, a complementary metal oxide semiconductor (CMOS) device, or any other photosensitive device capable of capturing video images or digital video sequences.<br>
[0032] As further examples, video capture device 23 may be a video converter that converts analog video data to digital video data, e.g., from a television, video cassette recorder, camcorder, or another video device. In some embodiments, source device 12 may be configured to transmit real-time video sequences over communication link 15, In that case, receive device 14 may receive the real-time video sequences and display the video sequences to a user Alternatively, source device 12 may capture and encode video sequences that are sent to receive device 14 as video data files, i.e., not in realtime* Thus, source device 12 and receive device 14 may support applications such as video telecommunication, video clip playbacks video mail, or video conferencing, e.g., in a mobile wireless network. Devices 12 and 14 may include various other elements that are not specifically illustrated in FIG 1.<br>
[0033] Receive device 14 may take the form of any digital video device capable of receiving and decoding video data. For example, receive device 14 may include a receiver 22 to receive encoded digital video sequences from transmitter 20, e.g., via<br><br>
intermediate links, routers, other network equipment, and like. Receive device 14 also may include a video decoder 24 for decoding the sequences, and a display device 26 to display the sequences to a user, hi some embodiments, however, receive device 14 may not include an integrated display device 14, In such cases, receive device 14 may serve as a receiver that decodes the received video data to drive a discrete display device, e.g., a television or monitor.<br>
(0034] Example devices for source device 12 and receive device 14 include servers located on a computer network, workstations or other desktop computing devices, and mobile computing devices such as laptop computers or personal digital assistants (PDAs). Other examples include digital television broadcasting satellites and receiving devices such as digital televisions, digital cameras, digital video cameras or other digital recording devices, digital video telephones such as mobile telephones having video capabilities, direct two-way communication devices with video capabilities, other wireless video devices, and the like.<br>
(0035] In some cases, source device 12 and receive device 14 each include an encoder/decoder (CODEC) (not shown) for encoding and decoding digital video data-in particular both source device 12 and receive device 14 may include transmitters and receivers as well as memory and displays. Many of the encoding techniques outlined below are described in the context of a digital video device that includes an encoder. It is understoods however, that the encoder may form part of a CODEC. In that case, the CODEC may be implemented within hardware, software, firmware, a DSP, a microprocessor, an application specific integrated circuit (ASIC), a field programmable gate array (FPGA), discrete hardware components, or various combinations thereof. [0036] Video encoder 18 within source device 12 operates on blocks of pixels within a sequence of video frames in order to encode the video data. For example, video encoder 18 may execute motion estimation and motion compensation techniques in which a video frame to be transmitted is divided into blocks of pixels (referred to as video blocks). The video blocks, for purposes of illustration, may comprise any size of blocks, and may vary within a given video sequence. As an example, the ITU H.264 standard supports 16 by 16 video blocks, 16 by 8 video blocks, 8 by 16 video blocks, 8 by 8 video blocks, 8 by 4 video blocks, 4 by 8 video blocks and 4 by 4 video blocks. The use of smaller video blocks in the video encoding can produce better resolution in the encoding, and may be specifically used for locations of video ftame that include<br><br>
higher levels of detail. Moreover, video encoder 18 may be designed to operate on 4 by 4 video blocks, and reconstruct larger video blocks from the 4 by 4 video blocks, as needed.<br>
[0037] Each pixel in a video block may be represented by various n-bit values, e.g., 8 bits, that defines visual characteristics of the pixel such as the color and intensity in values of chromaticity and luminosity. Each pixel may have one or more 8-bit values for both chromaticity and luminosity. The principles of this disclosure, however, are not limited to the format of the pixels, and may be extended for use with simpler fewer-bit pixel formats or more complex larger-bit pixel formats. The pixels may also be defined in accordance with other color coordinate systems,<br>
[0038] For each video block in the video frame, video encoder 18 of source device 12 may perform motion estimation by searching video blocks stored in memory 16 for one or more preceding video frames already transmitted (or a subsequent video frames) to identify a similar video block, referred to as a prediction video block. In some cases, the prediction video block may comprise the "best prediction" from the preceding or subsequent video frame, although this disclosure is not limited in that respect Video encoder 18 performs motion compensation to create a difference block indicative of the differences between the current video block to be encoded and the best prediction. Motion compensation usually refers to the act of fetching the best prediction video block using a motion vector, and then subtracting the best prediction from an input block to generate a difference block,<br>
[0039] After the motion compensation process has created the difference block, a series of additional encoding steps are typically performed to encode the difference block. These additional encoding steps may depend on the encoding standard being used. La MPEG-4 compliant encoders, for example, the additional encoding steps may include an 8x8 discrete cosine transform, followed by scalar quantization, followed by a raster-to-zigzag reordering, followed by run-length encoding, followed by Huffman encoding. [0040] Once encoded, the encoded difference block can be transmitted along with a motion vector that identifies the video block from the previous frame (or subsequent frame) that was used for the encoding. In this manner, instead of encoding each frame as an independent picture, video encoder 18 encodes the difference between adjacent frames. Such techniques can significantly reduce the amount of data that needed to accurately represent each frame of a video sequence.<br><br>
[0041] The motion vector may define a pixel location relative to the upper-left-hand comer of the video block being encoded, although other formats for motion vectors could be used. In any case, by encoding video blocks using motion vectors, the reqiured bandwidth for transmission of streams of video data can be significantly reduced. [0042) In some cases, video encoder 18 can support intra frame encoding, in addition to inter frame encoding. Intra-frame encoding utilizes similarities within frames, referred to as spatial or intra-frame correlation, to further compress the video frames. Intra-frame compression is typically based upon texture encoding for compressing still images, such as discrete cosine transform (DCT) encoding, Intra-frame compression is often used in conjunction with inter-frame compression, but may also be used as an alterative in some implementations.<br>
[0043] Receiver 22 of receive device 14 may receive the encoded video data in the form of motion vectors and encoded difference blocks indicative of encoded differences between the video block being encoded and the best prediction used in motion estimation. In some cases, however, rather than sending motion vectors, the difference between the motion vectors and a previously calculated motion vector predictor (MVP) are transmitted. In any case, decoder 24 can perform video decoding in order to generate video sequences for display to a user via display device 26. The decoder 24 of receive device 14 may also be implemented as an encoder/decoder (CODEC). In that case, both source device 12 and receive device 14 maybe capable of encoding, transmitting, receiving and decoding digital video sequences. [0044] In accordance with this disclosure, video encoder 18 selects quantization parameters (QP&amp;) in a dynamic fashion in order to effectuate rate controlled encoding. Video encoder generates a lookup table (LUT) on a video block or video frame basis, in order to map values of rho (p) to the quantization parameters (QP&amp;) used in the video encoding. The quantity p represents the number of non-zero coefficients of the video blocks after quantization, and is generally proportional to number of bits used in the video encoding. Accordingly, video encoder 18 utilizes the relationship between p and QP in order to achieve rate controlled video encoding. More specifically, video encoder 18 executes techniques for generating a lookup table (LUT) that maps values of p to different QPs. As p is approximately linearly related to the rate, the p~QP LUT can be used to select QPs that result in effective rate controlled video encoding. The p-QP LUT may also be labeled herein as p(QP)-<br><br>
[004S] FIG 2 is an exemplary block diagram of a device 30, which may correspond to source device 12. In general, device 30 comprises a digital video device capable of performing the rate controlled encoding techniques as described herein. Device 30 may comply with a video encoding standard such as MPEG-4, ITU H.263, ITU R264, or another video encoding standard that supports motion estimation and motion compensation techniques for inter-frame video encoding.<br>
[0046] As shown in FIG 27 device 30 includes a video encoding apparatus 32 to encode video sequences, and a video memory 34 to store the video sequences before and after encoding. Device 30 may also include a transmitter 36 to transmit the encoded sequences to another device, and possibly a video capture device 38, such as a video camera, to capture video sequences and store the captured sequences in memory 34, The various elements of device 30 may be communicatively coupled via a communication bus 35. Various other elements, such as intra-frame encoder elements, various filters, or other elements may also be included in device 30, but are not specifically illustrated for simplicity.<br>
[00471 Video memory 34 typically comprises a relatively large memory space. Video memory 34, for example, may comprise dynamic random access memory (DRAM), or FLASH memory. In other examples, video memory 34 may comprise anon-volatile memory or any other data storage device.<br>
[0048] Video encoding apparatus 32 may comprise a chip set for a mobile radiotelephone, including a combination of hardware, software, firmware, and/or processors or digital signal processors (DSPs). Video encoding apparatus 32 generally includes an encoder 28 coupled to a local memory 37. Local memory 37 may comprise a smaller and faster memory space relative to video memory 34. By way of example, local memory 37 may comprise synchronous random access memory (SRAM). Local memory 37 may comprise "on-chip" memory integrated with the other components of video encoding apparatus 32 to provide for very fast access to data during the processor-intensive encoding process. During the encoding of a given video frame, the current video block to be encoded may be loaded from video memory 34 to local memory 37. A search space used in locating the best prediction may also be loaded from video memory 34 to local memory 37.<br>
10049] The search space may comprise a subset of pixels of one or more of the preceding video frames (or subsequent frames). The chosen subset may be pre-<br><br>
identified as a likely location for identification of a best prediction that closely matches the current video block to be encoded. Moreover, the search space may change over the coarse of motion estimation, if different search stages are used. In that case, the search space may become progressively smaller in terms of the size of the search space, with these later searches being performed at greater resolution than previous searches. [0050] Local memory 37 is loaded with a current video block to be encoded and a search space, which comprises some or all of one or more video frames used in inter-frame encoding* Motion estimator 40 compares the current video block to various video blocks in the search space in order to identify a best prediction. In some cases, however, an adequate match for the encoding may be identified more quickly, without specifically checking every possible candidate, and in that case, the adequate match may not actually be the "best" prediction, albeit adequate for effective video encoding. In general, the phrase "prediction video block" refers to an adequate match, which may be the best prediction.<br>
[0051] Motion estimator 40 performs the comparisons between the current video block to be encoded and the candidate video blocks in the search space of memory 37. In some cases, candidate video blocks may include non-integer pixel values generated for fractional interpolation. By way of example, motion estimator 40 may perform sum of absolute difference (SAD) techniques, sum of squared difference (SSD) techniques, or other comparison techniques, in order to define the difference value for the candidate video block. A lower difference value generally indicates that a candidate video block is a better match, and thus a better candidate for use in motion estimation encoding than other candidate video blocks yielding higher difference values. [0052] Ultimately, motion estimator identifies a "best prediction," which is the candidate video block that most closely matches the video block to be encoded. However, it is understood that9 in many cases, an adequate match may be located before the best prediction, and in those cases, the adequate match may be used for the encoding. Again, a prediction video block refers to an adequate match, which may be the best prediction.<br>
[0053] Once a best prediction is identified by motion estimator 40 for a video block, motion compensator 42 creates a difference block indicative of the differences between the current video block and the best prediction. Difference block encoder 44 may further encode the difference block to compress the difference block, and the encoded<br><br>
difference block can forwarded for transmission to another device, along a motion vector (or the difference between the motion vector and a motion vector predictor) to identify which candidate video block from the search space was used for the encoding. For simplicity, the additional components used to perform encoding after motion compensation are generalized as difference block encoder 44, as the specific components would vary depending on the specific standard being supported. In other words, difference block encoder 44 may perform one or more conventional encoding techniques on the difference block, which is generated as described herein. [0054] The encoding process, including motion estimation and motion compensation is very computationally intensive. However, the number of computations necessary for performing rate control can be limited. In order to perform such rate control, video encoder 28 includes a rate control unit 46. Rate control unit 46 exploits a relationship between the number of bits encoded per frame and the number of non-zero coefficients of the video blocks after quantization. The value of p, which represents the number of non-zero coefficients of the video blocks after quantization, is generally proportional to the number of bits encoded per frame (and thus the number of bits encoded per second at a constant frame rate). Accordingly, rate control unit 46 utilizes the relationship between p and QP in order to achieve rate controlled video encoding. More specifically, rate control unit 46 generates one or more LUTs 48 in order to map values of p to different QPs. QPs can then be selected for desirable values of p corresponding to desirable rates for the video encoding.<br>
(0055] As described in greater detail below, rate control unit 46 of video encoder 28 calculates thresholds for un-quantized coefficients of a video block, wherein the thresholds identify when quantized coefficients become non-zero for different quantization parameters (0Ps). Rate control unit 46 then generates ap-gP LUT mapping numbers of non-zero coefficients after quantization (p's) to the QP's using the threshold. Local memory 37 stores the p-QP LUT, In a more specific embodiment, rate control unit 46 of video encoder 28 may generate a threshold-^/3 LUT mapping the thresholds to QFs, and generate the p-QP LUT using the threshold-QP LUT. LUTs 48 generally represent one or more LUTs, as outlined herein, such as the p-QP LUT and possibly the threshold-^ LUT used to generate the p-QP LUT. [0056] Upon generating the p-QP LUT, video encoder 28 selects a QP for rate controlled video encoding of the video block from the p-QP LUT. Video encoder 28<br><br>
then quantizes the coefficients of the video block based on the selected QP and encodes the video block according to an inter-frame video encoding technique, e.g., as outlined above*<br>
[0057] The creation of the p-QP LUT can be performed on a video block basis or a video frame basis. In the former case, video encoder 28 generates different p-QP LUTs for different video blocks of a video frame and selects a QP for rate controlled video encoding of a given video block using a corresponding p-QP LUT for the given video block. In the later case, video encoder 28 generates different p-QP LUTs for different video frames of a video sequence and selects a QP for rate controlled video encoding of video blocks of a given video frame using a corresponding p-QP LUT for the given video frame.<br>
(0058] In video encoding, it is generally desirable to have an accurate rate-distortion model. An accurate rate-distortion model can result in a rate control scheme that not only achieves target bit rate but also yields low variance in the number of bits per frame. A rate control scheme that uses the number of non-zero coefficients (p) to predict the bit-rate achieves significantly better performance compared to many other rate-control algorithms, particularly algorithms that use a fixed quadratic rate-distortion model Conventional algorithms that use a fixed quadratic rate-distortion model are referred to herein as conventional baseline methods or the baseline approach. [0059] Fundamentally, ^-domain rate control is based on two simple principles:<br>
1.	p is linearly related to the number of bits used; and<br>
2.	the QP value that yields a particular p value can be estimated from the un-quantized transform coefficients.<br>
[0060] If R is the number of bits that need to be used on a frame, then the number of non-zero coefficients that should result after quantization is given by the following equation<br><br>
In the above Equation 1, the parameter B can be thought of as the bits due to non-texture information and the parameter .4 can be seen as the average number of bits needed to encode a non-zero coefficient. The parameters A and B can be estimated from the values of R and p from the previous frame. From the above Equation 7, if R is given, it is fairly straightforward to estimate p. FIG. 3 plots the number of bits used per<br><br>
frame and p for different frames. As can be seen from FIG. 3, the relationship between R and/? is approximately linear.<br>
[0061] Accordingly, a rate control technique can select a QP value that yields the desired value of p. In order to select such a QP value, however, one needs to know the number of non-zero transform coefficients that would result from each allowable QP supported by the standard being used. If the transform coefficients are given by Ti and the quantization step corresponding to QP is given by SQP then the p-QP table can be given by:<br><br>
In the above Equation 2, the step size Sgp and the rounding factor rqp are dependent on the following factors:<br>
1.	The encoding standard, e.g., ITU H,264, MPEG-4 or ITU H.263;<br>
2.	Whether the intra-encoding or inter-encoding is being performed; and<br>
3.	The coefficient index.<br>
[0062] For example, in MPEG-4, inter-coded macroblocks for all coefficients S^are given by 2QP and rQP is given by -(QP/2). The Equation 2 used for generating the p-QP table can be implemented with adders and comparators. The table entry p(QP) needs to be calculated for all values of QP, QP ranges from 1 to 31 for MPEG-4 and 0 to 51 for H.264. The computations generally need to be repeated for all possible values of QP. If a particular quantization-parameter p is zero, then p is guaranteed to remain zero for all larger quantization-parameter values and hence need not be computed. In other words: <br>
(0063] The p-QP table obtained from a macroblock can be accumulated over an entire frame to get the p-QP table of the frame. A "macroblock'* generally refers to a 16 pixel by 16 pixel video block. If one assumes that images of a video sequence are fairly stationary, then the p-QP table estimated from a previous frame can be used to predict<br><br><br><br><br><br>
[0066] FIG. 4 illustrates exemplary hardware circuitry that could be used to calculate the p(QP) table for an encoder that complies with the MPEG-4 or ITU H.263 encoding standards. The accumulation shown in FIG. 4 would need to the repeated for all the luminosity (luma) and chromaticity (chorma) blocks, e.g., 4 liuna and 2 chroma blocks. [0067] As illustrated in FIG, 4 circuit 400 receives DCT(i) as input. DCT(i) represents the discrete cosign transform coefficient with index (i). Block 401 generates the absolute value of DCT(i), which is forwarded to adder 402. The absolute value of DCT(i) is then added to the output of multiplexer 403. Multiplexer 403 selects one of three values. The inputs to multiplexer 403 are the dc_scaler value right shifted by one, the value 0, and the negative of the quantization parameter QP right shifted by one. Multiplexer 403 selects dc_scaler value right shifted by one when both I and DC are ones, selects the value 0 when I is one and DC is zero, and selects the negative of the quantization parameter QP right shifted by one, when I is zero, regardless of the value of DC. The value of I is one when input block is an intra block, and zero when the input block is an inter block. The value of DC is one when the input parameter is DC and zero when the input parameter is AC. The DC coefficient represents the average value of a video block, whereas AC coefficients are the remaining coefficients of the video block.<br>
[0068J The output of multiplexer 403 is added to the output of block 401 by adder 403. Block 404 then generates the absolute value of the output of adder 402 and provides the negative of this value as input to adder 405, which is added to the output of multiplexer 406. Multiplexer 406 receives the dc_scaler value and the quantization parameter QP left shifted by one. Multiplexer 406 selects the dc_scaler value as output when I and DC are both one, and otherwise selects the quantization parameter QP left shifted by one as output.<br>
[0069] Adder 405 subtracts the output of block 404 from the output of multiplexer 406. Block 407 examines the 12* bit (the sign bit) of the output of adder 405, and provides this bit to adder 408. Block 409 accumulates the p(QF) table by adding the sign bit to each previous entry. Thus, adder 408 and p(QP) table block 409 can be viewed collectively as an accumulator that generates the p(QP) table. Circuit 400 may repeat these calculations for I * 1 to 63 and QP= 1 to 31.<br>
[0070] In ITU KL264 compliant encoders, the quantization step is merged with a coefficient dependent scaling of the transform. This makes the calculation ofpiQP)<br><br><br><br>
[0072] From Equation 49 one can observe that if the un-quanti2ed value Wij is greater than or equal to C, the result will be a non-zero coefficient. Since the right hand side of Equation 4 is a fractional number, the integer value to which WQ- is compared is given by:<br><br>
The following Table 2 is a list of comparator values, C, for various indices and QP%6 for intra and inter macroblocks.<br>
Table 2<br><br>
[0073] In particular, Table 2 gives value of the comparator C for the maximum shift value of SH24 for the various QP%6. These values can be stored in an 36x13 ROM column by column from left to right. FIGS. 5A and 5B are circuit diagrams illustrating exemplary circuitry that can be used to calculate the p(QP) table in compliance with the ITU H.264 standard,<br>
[0074] As illustrated in FIGS. 5 A, the value 15 is added to the value QP/6 by adder 501. The output of adder 501 is provided to multiplexer 505 as well as the output of adder 501, which adds one to the output of adder 501. The output of multiplexer 505 is selected based on control signals from AND gate 503 and OR gate 504. The inputs i and j to AND gate 503 are the index values of the input coefficient, and are inverted. The inputs to OR gate 504 indicate whether the current block is an intra block and whether the current block is a chroma block. The output of adder 502 is selected by<br><br>
multiplexer when both inputs to multiplexer 505 are one, and the output of adder 501 is otherwise selected. The output S of circuit 500 is used by circuit 600 of FIG. 5B. [0075] As shown in FIG. 5B, multiplexer 603 selects one of the values 031 or 2 based on input signals from AND gate 601 and NOR gate 602. The inputs to gates 601 and 602 are the 2eroth bits of the index coefficients in the i and j dimensions respectively. If the output of gate 601 is zero and the output of gate 602 is one, the value 0 is selected by multiplexer 603. If the output of gate 601 is one and the output of gate 602 is zero, the value 1 is selected by multiplexer 603. If the output of gate 601 is zero and the output of gate 602 is zero, the value 2 is selected by multiplexer 603. [0076] Multiplier 604 multiples the output of multiplexer 603 by six and inputs this value into memories 605 and 606. IROM 605 corresponds to intra blocks and PROM 606 corresponds to inter blocks. The input value P to multiplexer 607 is one when an inter block is being processed-<br>
10077] Multiplexer 607 selects from one of memories 605, 606 based on input P. The output of multiplexer 607 is provided to adder 608. The value S from circuit 5A is subtracted from 15. The valueSll is right shifted by the result of (15-S) by block 609, and the output of block 609 is provided to adder 608. Adder 608 sums the outputs of block 609 and multiplexer 607. The output of adder 608 is then right shifted by 24-S, which is represented by the variable C and represents a comparator value. The value C is provided to adder 61L The value Wy represents the input coefficient Block 612 generates the absolute value of the value Wy, which is the subtracted from the value C by adder 611.<br>
[0078] Block613 generates the sign bit (the 15* bit) ofthe output of adder 611, The sign bit is then provided to adder 614, Block 615 accumulates the p(QP) table by adding the sign bit to each previous entry. Thus, adder 614 and piQP) table block 615 can be viewed collectively as an accumulator that generates the p{QP) table. Circuits 500 and 600 may repeat these calculations for i j - 1 to 3 and QP= 1 to 51. [0079J As more generally shown in FIGS. 5A and 5B, a rounding factor is added to the stored comparator value before it is shifted down. This factor can be chosen such that the fractional value resulting from the division is always ceiled. By doing so, it is guaranteed that for every value of S between 15 and 24 the resulting C is the ceiling of the faction in Equation 5. Also, much ofthe circuitry illustrated in FIGS. 5 A and 5B may be already in place in hardware components that implement the forward<br><br>
quantization in compliance with the ITU H.264 standard, including an address generator<br>
and a component that calculates S. The accumulation shown in FIGS, 5A and 5B can be<br>
repeated for all the luma and chroma blocks (16 luma and 8 chroma blocks).<br>
[0080] The direct computation of thep-QP table described above and illustrated in FIG.<br>
4 and FIGS- 5A and 5B is computationally complex. In the worst case, the direct<br>
computation may involve one comparison and one addition per coefficient per QP. If<br>
QP can have M possible values and there are .AT coefficients, then the number of<br>
operations required for the direct computation of p-QP table is M*N. More simplified<br>
approaches are described in greater detail below, including various "threshold"<br>
approaches.<br>
[0081] In a "threshold" approach, the p-QP table may involve the calculation of the QP<br>
threshold X\ for every un-quantized coefficient C,-. The threshold, Tif may be a<br>
quantization parameter such that,<br><br>
The function Q[Ci7 QP) represents the quantization operation of the coefficient Q using the quantization parameter QP. The threshold-QP table T\QP) can be calculated using the following pseudo-code:<br><br>
[0082] Then, ap-QP table can be easily calculated from T(QP) using the following pseudo-code:<br><br><br>
[0083] Using the threshold approach (also referred to as a threshold method), the total number of operations needed to calculate the p-QP table can be reduced to 2N+M, compared to JV*M computations required for the direct computation. This generally assumes that it takes N operations to lookup a table to calculate the threshold for each of the coefficients and another N operations to accumulate the threshold values of the N coefficients, followed by M operations to accumulate the T(OP) table in order to obtain the p-gP table,<br>
[0084] If calculation of the p-QP table is performed for every macroblock, then the threshold method reduces the computation by more than 90 %. Moreover, the reduction in computations will be even more if the table is only computed once per frame. The threshold method of calculating ihep-QP table is also very advantageous for hardware implementations because it avoids the need to have M accumulators running in parallel. If implemented in hardware, the hardware can calculate the T(QP) table for each macroblock and pass it on to a DSP. The DSP will use this threshold table to calculate the p-QP table,<br>
[00851 For MPEG-4 and H.263 the calculation of T; can be performed as follows:<br><br>
for Inter AC and DC coefficients For the intra case, |C,-| is limited to [0 62] and for the inter case, |C,| is limited to [0 77]. 0x666 is (2/5) and 0x4CD is (3/10) in Q12. From these equations it can be observed that<br>
for MPEG-4 and H.263 the computation that is necessary for estimating T, is nominal. It<br>
is not necessary to use a separate equation (or table look-up) for the intra ac coefficients as the chances of these coefficients becoming zero after quantization are remote. This can be observed from the histogram of the intra DC coefficients shown in FIG. 6. [0086] Table 3, below is one exemplary look up table (LUT) for finding the threshold values for MPEG4 inter coefficients.<br><br><br><br><br><br>
[0088] In particular, if it is necessary to implement the threshold calculation of MPEG-4 using a table due to hardware considerations, then the exemplary entries for inter and intra coefficients are given in Tables 3 and 4 respectively. [0089] For the ITU H.264 standard, a direct computation of the threshold from the un-quantized coefficients is more difficult because in the ITU H.264 standard, the divisor is not just dependent on QP but is also dependent on other factors. One general hardware structure that can be used to calculate the thresholds for compliance with the ITU H.264 standard is shown in FIG. 7.<br>
[0090] As shown in FIG. 7, the input coefficient Wij is input to block 701, which generates the absolute value of Wij. Block 702 limits the absolute value of Wy to 2047, and forward its output to adder 707, The output of block 702 is also right shifted by five, by block 703. The output of block 703 is the input signal to multiplexer 704. The most significant bit of the input to multiplexer 704 is used to select the output from the values 0,1,2, 3,4, 5 and 6.<br>
[0091] Adder 705 subtracts one from the output of multiplexer 704. The output of adder 705 is then left shifted by one. The output of block 706 is provided to adder 707 and added to the output of block 702. The output of adder 707 is then right sifted by the value output by multiplexer 704. Block 709 limits the value of block 708 to 31. The output of block 709 is then provided to address generator 710, [0092] Address generator 710 generates an address used by LUTs 711. In particular address generator receives the output of block 709 as well as i J and intra to generate the address that is fed to LUTs 711. Examples of LUTs 711 are provided in Tables 6 and 7, below. Table 6 represents a LUT for intra values and Table 7 represents an example LUT for inter values. The respective input values to address generator 710 can be mapped to the specific value of one of the LUTs. Given an address (addr), appropriate data is selected from LUTs 711.<br>
[0093] The output of a respective one of LUTs 711 is provided to adder 717. The output of multiplexer 704 is also provided to multiplexer 715. Adder 712 subtracts one from the output of multiplexer 704 and provides this value as the other input to multiplexer 715. The output of multiplexer 715 is selected based on control signals from AND gate 713 and OR gate 714. The inputs i and j to AND gate 713 are the index<br><br>
values of the input coefficient, and are inverted. The inputs to OR gate 714 indicate whether the current block is an intra block and whether the current block is a chroma block. The output of adder 712 is selected by multiplexer when both inputs to multiplexer 715 are one, and the output of multiplexer 704 is otherwise selected by multiplexer 715.<br>
[0094] The output of multiplexer 715 is then multiplied by six by multiplier 716. The output of multiplier 716 is added by the selected output of one of LUTs 711 by adder 717. The output of adder 717 is limited with a lower limit of 0 and an upper limit of 52 by block 718. The output of circuit 700 is the quantization parameter threshold QPT* The value QPT may be used as input to circuit 900 of FIG. 9, discussed below. [0095] In the hardware circuit diagram of FIG. 7, a limiting factor L is used to limit the absolute value of the un-quantized coefficients to below the largest divisor used for<br>
quantization. For all Wj j larger than L it is generally guaranteed that Ty (QPr) will be<br>
equal to QPmax* Hence, there is no need to store entries in LUT corresponding to Wijs larger than I. The value of I depends on the coefficient index and the mode of the macroblock (intra or inter). The various values of L are shown in Table 5, below. In particular, Table 5 lists absolute values above which the QP threshold will be clamped to QPmax-<br><br>
[0096] In some embodiments, the largest limiting value that is a power of 2 (2047) be used as a common clipping factor. The LUT can be stored for only 32 input values [0 to 31]. In ITU H264, the quantization step-size (divisor) doubles for every increment of six in QP. Hence, in order to map the input value, the smallest divisor (that is power or two), D=2S that will convert the clipped input into a number between 0 and 31 can be computed. This is done by dividing the input by 32 and counting the number of bits used to represent the output (implemented with a shift register and a multiplexer). The<br><br>
clipped value is then shifted down by S, The error in the lookup can be made less biased if this division is done with rounding. FIGS. 8A and SB are graphs illustrating the effect of rounding the bias used for address calculation of the threshold LUT. [0097] The shift factor S is multiplied by 6 and then added to the result of the lookup to get the final threshold QP* The LUT is dependent on whether the macroblock is an intra block or inter block, and also on the indices of the coefficients. Exemplary entries for intra and inter coefficients are given in Tables 6 and 7 respectively. In particular, Table 6 is an exemplary look up table for finding the threshold values for ITU H.264 intra coefficients, whereas Table 7 is an exemplary look up table for finding the threshold values for ITU H.264 inter coefficients.<br><br><br><br><br><br>
(0098] In order to further simplify the creation of the Threshold-Q/* Table, hardware can be designed to accumulate the threshold QPs over all coefficients in order to form the T(QP) table. Exemplary circuitry that can be used to accumulate threshold QPs to form the T(QP) table is shown in FIG. 9,<br>
[0099] As shown in FIG. 99 circuit 900 receives the quantization parameter threshold<br>
QPT input. Adder 901 subtracts 30 from QPT and provides this value to Chroma QP<br>
LUT 902, an example of which is provided in Table 8. Multiplexer 904 selects between<br>
the value of QPT and the value stored in the Chroma QP LUT 902 based on input<br>
signals that correspond to the sign of the output of adder 901, as determined by block<br>
903 and the Luma and H264 input signals. The value stored in the Chroma QP LUT<br>
902 is selected if the sign value is zero, the luma value is zero indicating that the block<br>
is not a luma block, and the H264 value is one indicating that the encoding standard is<br>
ITU H.264. Otherwise, multiplexer 904 selects QPT as output. The output of<br>
multiplexer 904 comprises an input address (addr) stored in T(QP) table 905. The<br>
original address value output from multiplexer 904, however, is output to adder 906,<br>
added to one and stored over the original address value in T(QP) table 905* A specific<br>
QPT is generated for each coefficient, and each of these QPT<br>
[00100]	The LUT used to convert the chroma QP value to the QP value in<br>
compliance with the ITU H.264 standard is given in Table 8. In particular, Table 8 illustrates a table to map cbroma-gP thresholds to QP thresholds.<br>
Table 8<br><br>
[00101]	Table 9 lists experimental results of the bit rate variation of different<br>
video clips. Table 9 lists the results using a conventional baseline approach, and the results using a p-domain approach as outlined herein, for purposes of comparison. Table 9 lists five different video clips that were used in the experiment. The different clips were encoded at four different rate controlled manners: 64 kilobits per second (Kbps) and quarter common interface format (QCIF) - 15 frames per second (FPS); 28 Kbps and QCIF - 15FPS; 55 Kbps and QCIF -10 FPS; and 35 Kbps and QCIF - 10FPS.<br><br>
The baseline approach generally refers to a fixed quadratic approach, mentioned previously.<br><br>
[00102]	From Table 9 it can be observed that both a conventional baseline<br>
approach, and the proposed /?-domain approach are adequate in achieving a target bit-<br>
rate. Thep-domain approach reduces the variance of bit-rate across various clips.<br>
[00103]	Table 10 lists experimental results quantifying the standard deviation of<br>
bits used per frame for various video clips encoded at different target bit rates, Table 10 lists the results using a conventional baseline approach, and the results using a/?-domain approach as outlined herein. Table 10 includes data for five different video clips, which were encoded at different target bit rates. The different clips were encoded at four different rate controlled manners: 28 kilobits per second (Kbps) and quarter common interface forniat (QCIF) -15 frames per second (FPS); 35 Kbps and QCIF - 10FPS; 55 Kbps and QCIF -10 FPS; and 64 Kbps and QCIF - 15FPS.<br><br><br>
[00104]	As can be appreciated from Table 10 thep-domain technique<br>
significantly outperforms a conventional baseline system- On an average, thep-domain technique reduces the standard deviation by more than 50 %. For some clips (mother_daughter) this reduction was a dramatic 85 %.<br>
[001 OS]	FIG. 10 includes four different plots showing the bits used per frame and<br>
peak signal to noise ratio (PSNR) per frame resulting from a conventional baseline<br>
approach and the p-domain rate control approaches described herein. The plots of FIG,<br>
10 correspond to the encoding of the mother-daughter clip at 64 Kbps.<br>
[00106]	From the plots of FIG* 10 it can be appreciated that while the reduction<br>
of variance of bits spent on frames is dramatic, the p-domain rate control does not<br>
negatively impact PSNR. In this example, thep-domain rate control even brings a<br>
smoother behavior to the PSNR trajectory across time, which is a desirable result.<br>
[00107]	Even further improvements to the performance of the encoding can be<br>
achieved by adapting the parameters A and B in Equation 17 listed above. In particular, adapting parameters A and B of Equation 1 can further improve the rate control by reducing the frame level bit fluctuation as shown in FIG. 11. Adaptation further reduces<br><br>
the variance by an average of another 37%. In this example, the parameters are updated once every frame in the Rho-Adapted technique. Adaptation of the parameters A and B in conjunction with the threshold approach described herein is referred to an adapted threshold approach.<br>
[00108]	It can also he important to reduce the variation of QP within a frame, as<br>
reductions in the variance of QP within a frame can help reduce the bits needed to encode the delta-£&gt;P, and reductions in the variance of OP can improve the encoding quality by making the quality relatively steady across a frame. This goal of reducing the variation of QP within a frame can be achieved by using a scaled p-QP table from the previous frame to perform macroblock-level rate control. This helps in reducing the variance of p-QP table estimate, thus reducing the fluctuation of QP values within a frame. Only approximately 25 % of the macroblocks have unchanged QP values if the P-QP table from the previous macroblock is used for rate control. It can be observed that by using the scaled p-QP table from the previous frame, for almost 80% of the macroblocks there is no change in the value of QP.<br>
[00109]	The significant reduction in frame-level bit-rate variance caused by the<br>
/^-domain rate control does not result in degradation in the quality of encoded video sequences as shown in Table 1L Table 11 provides comparisons of PSKR obtained from various encoded sequences.<br><br><br>
[00110]	FIG. 12 further illustrates that the significant reduction in frame-level<br>
bit-rate variance caused by the /?-domain rate control does not result in any degradation in the quality of encoded video sequences. While is has already been shown that by the use ofp-domain method a tighter rate control is achieved, from Figure 12 it can be observed that the p-domain rate control is also able to maintain a lower QP value. On an average, this does not increase the PSNR, Moreover, variation in quality may be reduced by the proposed rate-control scheme*<br>
[00111]	Various embodiments have been described. In particular, it has been<br>
demonstrated that the p-domain rate control yields excellent results reducing the variance in bits per frame by 50 to 80 % in comparison with a conventional baseline method. It is also shown that this reduction in bit-rate fluctuation is without any degradation in PSNR and perceived picture quality. A number of techniques have also been described that can simplify the generation of a p-QP LUT, including a threshold approach in which a threshold-QP LUT is created and then used to create thep-Q? LUT.<br>
[00112]	The techniques described herein may be implemented in hardware,<br>
software, firmware, or any combination thereof. If implemented in software, the techniques may be directed to a computer readable medium comprising program code, that when executed in a device that encodes video sequences, performs one or more of the methods mentioned above. In that case, the computer readable medium may comprise random access memory (RAM) such as synchronous dynamic random access memory (SDRAM), read-only memory (ROM), non-volatile random access memory (NVRAM), electrically erasable programmable read-only memory (EEPROM), FLASH memory, and the like.<br>
[00113]	The program code may be stored on memory in the form of computer<br>
readable instructions. In that case, a processor such as a DSP may execute instructions stored in memory in order to carry out one or more of the techniques described herein.<br>
In some cases, the techniques may be executed by a DSP that invokes various hardware components to accelerate the encoding process.  In other cases, the video encoder may be implemented as a microprocessor, one or more application specific integrated circuits (ASICs), one or more field programmable gate arrays (FPGAs), or some other hardware-software combination. These and other embodiments are within the scope of the following claims.<br><br><br><br><br>
CLAIMS:<br>
1.	A video encoding device comprising:<br>
an encoder that calculates thresholds for un-quantized coefficients of a video block, wherein the thresholds identify when quantized coefficients become non-zero for different quantization parameters (QP's), and generates zp-QP look-up table (LUT) mapping numbers of non-zero coefficients after quantization (p's) to the QP's using the thresholds; and<br>
a memory that stores the p-QP LUT.<br>
2.	The video encoding device of claim 1, wherein the encoder selects a QP for rate controlled video encoding of the video block using the p-QP LUT.<br>
3.	The video encoding device of claim 2, wherein the encoder quantizes the coefficients of the video block based on the selected QP and encodes the video block according to an inter-frame video encoding technique,<br>
4.	The video encoding device of claim 1, wherein the encoder:<br>
generates a threshold-QP LUT mapping the thresholds to QP's; and<br>
generates the p-QP LUT using the threshold-QP LUT,<br>
wherein the memory stores the threshold-QP LUT and the p-QP LUT.<br>
5.	The video encoding device of claim 4, wherein the encoder generates the threshold-gP LUT by accumulating thresholds for the QP's from a largest QP to a smallest QP.<br>
6.	The video encoding device of claim 4, wherein a given threshold (Tj) is such that:<br>
for all QP&gt; TL Q(Q ,QP)-0 and<br>
for all QP
 <br>
7.	The video encoding device of claim 1, wherein the encoder generates different p-QP LUTs for different video blocks of a video frame and selects a QP for rate controlled video encoding of a given video block using a corresponding p-QP LUT for the given video block,<br>
8.	The video encoding device of claim 1, wherein the encoder generates different p-QP LUTs for different video frames of a video sequence and selects a QP for rate controlled video encoding of video blocks of a given video frame using a corresponding p-QP LUT for the given video frame,<br>
9.	The video encoding device of claim ls wherein a total number of computations required by the encoder to generate the p-QP LUT is approximately 2N+M, where N represents a number of coefficients and M represents a number of possible values of<br>
OP-<br>
10.	A method of providing rate control for video encoding comprising:<br>
calculating thresholds for un-quantized coefficients of a video block wherein the<br>
thresholds identify when quantized coefficients become non-zero for different quantization parameters (gP's); and<br>
generating a p-QP look-up table (LUT) mapping numbers of non-zero coefficients after quantization (/?'s) to the QP's using the thresholds.<br>
11.	The method of claim 10, further comprising selecting a QP for rate controlled video encoding of the video block using the p-QP LUT.<br>
12.	The method of claim 11, further comprising quantizing the coefficients of the video block based on the selected QP and encoding the video block according to an inter-frame video encoding technique,<br>
13.	The method of claim 10, further comprising:<br>
generating a threshold-QP LUT mapping the thresholds to quantization parameters (£?/*'s); and<br>
generating the p-QP LUT using the threshold-QP LUT.<br><br>
14. The method of claim 13, wherein generating the threshold-£&gt;P LUT comprises accumulating thresholds for the quantization parameters (QP's) from a largest QP to a smallest QP.<br>
15 _      The method of claim 10, further comprising generating different p-QP LUTs for different video blocks of a video frame and selecting a QP for rate controlled video encoding of a given video block using a corresponding p-QP LUT for the given video block.<br>
16.	The method of claim 10, further comprising generating different p-QP LUTs for different video frames of a video sequence and selecting a QP for rate controlled video encoding of video blocks of a given video frame using a corresponding p-QP LUT for the given video frame.<br>
17.	The method of claim 10, wherein a given threshold (TO is such that:<br><br>
wherein Q(Q, QP) represents a quantization operation of a given coefficient Q using the quantization parameter QP.<br>
18.	The method of claim 10, wherein a total number of computations required to generate the p-QP LUT is approximately 2N+Ma where N represents a number of coefficients and M represents a number of possible values of QP.<br>
19.	An apparatus comprising:<br>
means for calculating thresholds for un-quantized coefficients of a video block wherein the thresholds identify when quantized coefficients become non-zero for different quantization parameters (QP7$)\ and<br>
means for generating &amp;p-QP look-up table (LUT) mapping numbers of non-zero coefficients after quantization (/J'S) to the QP7s using the thresholds.<br><br><br><br>
27.	The apparatus of claim 19, wherein a total number of computations required to<br>
generate the p~QP LUT is approximately 2N+M, where N represents a number of<br>
coefficients and M represents a number of possible values of QP.<br>
28.	The apparatus of claim 19, wherein the means for calculating thresholds for un-quantized coefficients of a video block comprises software executing on a digital signal processor.<br>
29.	The apparatus of claim 19, wherein the means for calculating thresholds for un-quantized coefficients of a video block comprises firmware.<br>
30. The apparatus of claim 19, wherein the means for calculating thresholds for un-quantized coefficients of a video block comprises hardware.<br>
31. The apparatus of claim 30, wherein the means for generating &amp;p-QP LUT comprises software executing on a digital signal processor.<br></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDg3OC1jaGUtMjAwNS1hYnN0cmFjdC5wZGY=" target="_blank" style="word-wrap:break-word;">0878-che-2005-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDg3OC1jaGUtMjAwNS1jbGFpbXMucGRm" target="_blank" style="word-wrap:break-word;">0878-che-2005-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDg3OC1jaGUtMjAwNS1jb3JyZXNwb25kbmVjZS1vdGhlcnMucGRm" target="_blank" style="word-wrap:break-word;">0878-che-2005-correspondnece-others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDg3OC1jaGUtMjAwNS1kZXNjcmlwdGlvbihjb21wbGV0ZSkucGRm" target="_blank" style="word-wrap:break-word;">0878-che-2005-description(complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDg3OC1jaGUtMjAwNS1kcmF3aW5ncy5wZGY=" target="_blank" style="word-wrap:break-word;">0878-che-2005-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDg3OC1jaGUtMjAwNS1mb3JtIDEucGRm" target="_blank" style="word-wrap:break-word;">0878-che-2005-form 1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDg3OC1jaGUtMjAwNS1mb3JtIDI2LnBkZg==" target="_blank" style="word-wrap:break-word;">0878-che-2005-form 26.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDg3OC1jaGUtMjAwNS1mb3JtIDMucGRm" target="_blank" style="word-wrap:break-word;">0878-che-2005-form 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDg3OC1jaGUtMjAwNS1mb3JtIDUucGRm" target="_blank" style="word-wrap:break-word;">0878-che-2005-form 5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODc4LUNIRS0yMDA1ICAgIENPUlJFU1BPTkRFTkNFIE9USEVSUyAgMDYtMDEtMjAxNS5wZGY=" target="_blank" style="word-wrap:break-word;">878-CHE-2005    CORRESPONDENCE OTHERS  06-01-2015.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODc4LUNIRS0yMDA1ICAgQ09SUkVTUE9OREVOQ0UgT1RIRVJTICAwOC0wMS0yMDE1LnBkZg==" target="_blank" style="word-wrap:break-word;">878-CHE-2005   CORRESPONDENCE OTHERS  08-01-2015.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODc4LUNIRS0yMDA1ICAgQ09SUkVTUE9OREVOQ0UgT1RIRVJTLiAgMDgtMDQtMjAxMy5wZGY=" target="_blank" style="word-wrap:break-word;">878-CHE-2005   CORRESPONDENCE OTHERS.  08-04-2013.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODc4LUNIRS0yMDA1ICBBTUVOREVEIENMQUlNUyAgMjktMDEtMjAxNS5wZGY=" target="_blank" style="word-wrap:break-word;">878-CHE-2005  AMENDED CLAIMS  29-01-2015.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODc4LUNIRS0yMDA1ICBBTUVOREVEIENMQUlNUyAxOS0wMy0yMDE0LnBkZg==" target="_blank" style="word-wrap:break-word;">878-CHE-2005  AMENDED CLAIMS 19-03-2014.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODc4LUNIRS0yMDA1ICBDT1JSRVNQT05ERU5DRSAgT1RIRVJTICAwOS0wMS0yMDE1LnBkZg==" target="_blank" style="word-wrap:break-word;">878-CHE-2005  CORRESPONDENCE  OTHERS  09-01-2015.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODc4LUNIRS0yMDA1ICBFWEFNSU5BVElPTiBSRVBPUlQgUkVQTFkgUkVDRUlWRUQgIDE5LTAzLTIwMTQucGRm" target="_blank" style="word-wrap:break-word;">878-CHE-2005  EXAMINATION REPORT REPLY RECEIVED  19-03-2014.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODc4LUNIRS0yMDA1ICBFWEFNSU5BVElPTiBSRVBPUlQgUkVQTFkgUkVDRUlWRUQgIDI5LTAxLTIwMTUucGRm" target="_blank" style="word-wrap:break-word;">878-CHE-2005  EXAMINATION REPORT REPLY RECEIVED  29-01-2015.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODc4LUNIRS0yMDA1ICBGT1JNLTMgMTktMDMtMjAxNC5wZGY=" target="_blank" style="word-wrap:break-word;">878-CHE-2005  FORM-3 19-03-2014.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODc4LUNIRS0yMDA1ICBPVEhFUiBQQVRFTlQgRE9DVU1FTlQgMTgtMDMtMjAxNC5wZGY=" target="_blank" style="word-wrap:break-word;">878-CHE-2005  OTHER PATENT DOCUMENT 18-03-2014.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODc4LUNIRS0yMDA1ICBQT1dFUiBPRiBBVFRPUk5FWSAxOS0wMy0yMDE0LnBkZg==" target="_blank" style="word-wrap:break-word;">878-CHE-2005  POWER OF ATTORNEY 19-03-2014.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=ODc4LUNoZS0yMDA1LVBldGl0aW9uXzEzN19mb3JlaWduIGZpbGluZyBwYXJ0aWN1bGFycy5wZGY=" target="_blank" style="word-wrap:break-word;">878-Che-2005-Petition_137_foreign filing particulars.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="265391-method-for-routing-network-call-and-network-call-center.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="265393-apparatus-and-method-for-sharing-a-unique-identifier-among-a-plurality-of-receivers.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>265392</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>878/CHE/2005</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>09/2015</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>27-Feb-2015</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>23-Feb-2015</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>05-Jul-2005</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>QUALCOMM INCORPORATED</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>5775 MOREHOUSE DRIVE, SAN DIEGO, CALIFORNIA 92121-1714, USA</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>MALAYATH, NARENDRANATH</td>
											<td>10710 SABRE HILL DRIVE, #229, SAN DIEGO, CALIFORNIA 92128, USA</td>
										</tr>
										<tr>
											<td>2</td>
											<td>MOLLOY, STEPHEN</td>
											<td>3210 HIGHLAND DRIVE, CARLSBAD, CALIFORNIA 92008, USA</td>
										</tr>
										<tr>
											<td>3</td>
											<td>CHANG, YONG</td>
											<td>13294 VIA SANTILLANA, SAN DIEGO, CA 92129, USA</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04B 14/06</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>N/A</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td></td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>11/019,331</td>
									<td>2004-12-21</td>
								    <td>U.S.A.</td>
								</tr>
								<tr>
									<td>2</td>
									<td>60/586,963</td>
									<td>2004-07-08</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/265392-efficient-rate-control-techniques-for-video-encoding by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 04:28:19 GMT -->
</html>
