<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/206699-a-method-for-controlling-data-flow-in-an-electronic-electricity-meter-and-an-electronic-electricity-meter-therefor by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 03:54:50 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 206699:&quot;A METHOD FOR CONTROLLING DATA FLOW IN AN ELECTRONIC ELECTRICITY METER AND AN ELECTRONIC ELECTRICITY METER THEREFOR&quot;</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">&quot;A METHOD FOR CONTROLLING DATA FLOW IN AN ELECTRONIC ELECTRICITY METER AND AN ELECTRONIC ELECTRICITY METER THEREFOR&quot;</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>The present invention, in one embodiment, is a method for control1ing data flow in anelectronic electric meter (100). The method includes steps of measuring current (104) and voltage (106) of a power source (102); determining a set of internal quantities (202) using the measured current and voltage; using the set of internal quantities (202) in conjunction with a set of functions to determine measurement profile quantities (204); and storing the determined measurement profile quantities (204) in registers within the meter.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>METHODS AND APPARATUS FOR<br>
CONTROLLING DATA FLOW IN ELECTRICITY<br>
METER<br>
CROSS REFERENCE TO RELATED APPLICATIONS<br>
This application claims the benefit of U.S. Provisional Application No. 60/141,771, filed June 30, 1999, entitled "Methods and apparatus for controlling data flow in an electronic electricity meter," and which is hereby incorporated by reference in its entirety.<br>
BACKGROUND OF THE INVENTION<br>
5	This invention relates generally to electricity metering, and more<br>
particularly, to a microcomputer based electricity meter.<br>
Electronic electricity meters for metering multi-phase services typically include a digital signal processor (DSP) and a microcomputer. Certain functions and operations are separately performed in the DSP and microcomputer. By dividing the 10 functionality between the DSP and microcomputer, communications of data and commands must be provided between the DSP and microcomputer. Such an architecture is complex.<br>
In addition, such meters typically are programmed to perform certain functions. Although the meters are upgradeable, the types of upgrades that can be  performed are limited to the tables and functions prestored in the meter. In addition, and in the past, increased functionality typically was a trade-off to cost. That is, adding functionality to the meter typically resulted in adding significant costs to the meter.<br>
It would thus be desirable to provide methods and apparatus for<br>
20         controlling data flow in an electricity meter that provide a simpler, more easily<br>
upgraded meter for a multi-phase power source than those requiring a division of<br>
functionality between a DSP and a microcomputer. In addition, it would be desirable<br>
-1-<br><br><br>
to provide metering methods and apparatus that accommodate user-defined functions tailored to a particular utility's needs.<br>
BRIEF SUMMARY OF THE INVENTION<br>
There is therefore provided in one embodiment of the present invention, a method for controlling data flow in an electronic electricity meter. The 5 method includes steps of measuring current and voltage of a power source; determining a set of internal quantities using the measured current and voltage; using the set of internal quantities in conjunction with a set of functions to determine measurement profile quantities; and storing the determined measurement profile quantities in registers within the meter.<br>
10	The above-described method for controlling data flow in an electricity<br>
meter is simpler than those methods requiring a division of functionality between a DSP and a microcomputer. Furthermore, the method can be expanded to accommodate user-defined functions tailored to a particular utility's needs.<br>
BRIEF DESCRIPTION OF THE ACCOMPANYING DRAWINGS <br><br>
Figure 1 is a block diagram of an electricity meter.<br>
	Figure 2 is a data flow diagram for the electricity meter shown in<br>
Figure 1.<br>
Figure 3 is a functional block diagram of the meter shown in Figure 1.<br>
Figure 4 is a table illustrating the I/O board addressing mode.<br>
Figure 5 is a mode diagram for a simple I/O board.<br>
20	Figure 6 is a mode diagram for a complex I/O board.<br>
-2-<br><br><br>
DETAILED DESCRIPTION OF THE INVENTION<br>
Figure 1 is a block diagram of an electricity meter 100. Meter 100 is coupled to a three phase, alternating current (AC) power source 102. Particularly, current sensors 104 and voltage sensors 106 are coupled to power source 102 and generate measures of current and voltage, respectively. Current and voltage sensors 104 and 106 are well known in the art. In addition, a power supply 108 and a revenue guard option board 110 also are coupled to power source 102.<br>
Current and voltage measurements output by sensors 104 and 106 are supplied to an analog-to-digital (A/D) converter 112. Converter 112, in the exemplary embodiment, is an 8 channel delta-sigma type converter. Converter 112 is coupled to a microcomputer 114. In the illustrated embodiment, microcomputer 114 is a 32 bit microcomputer with 2Mbit ROM, 64 Kbit RAM. A 32 kHz crystal 116 provides a timekeeping signal for microcomputer 114. Microcomputer 114 is coupled to a flash memory 118 and a electronically erasable programmable (i.e., reprogrammable) read only memory 120.<br>
Meter 100 also includes an optical port 122 coupled to, and controlled by, microcomputer 114, Optical port 122, as is well known in the art, is used for communicating data and commands to and from an external reader to microcomputer 114. Communications via port 122 are performed in accordance with ANSI C12.18 (optical port) and ANSI C12.19 (standard tables). A liquid crystal display 124 also is coupled to microcomputer 114 via an LCD controller 126. In addition, an option connector 128, coupled to microcomputer 114, is provided to enable coupling option boards 130 (e.g., a telephone modem board 132 or an RS-232 line 134, or a simple input/output (I/O) board 136 or a complex I/O board 138) to microcomputer 114. Option connector 128 also includes a sample output 140. When configured to operate in a time-of-use mode, a battery 142 is coupled to power source 102 to serve as a back-up to maintain date and time in the event of a power outage.<br>
Figure 2 is a data flow diagram 200 for the electricity meter 100. As illustrated by Figure 2, quantities such as watt hours per phase (WhA, WhB, WhC) as<br>
-3-<br><br>
well as other quantities are determined by microcomputer 114. These quantities are sometimes referred to herein as internal quantities 202. Microcomputer 114 then uses the pre-defined or user-selected functions F(n) to calculate a set of quantities (referred to as calculated quantities 228). Microcomputer 114 then uses the measurement profile 204 to select up to 20 quantities to store as user-selected quantities. In addition, external inputs 206 can be specified to be accumulated by measurement profile 204. In the embodiment shown in Figure 2, up to four external inputs (El, E2, E3, E4) are collected. These may also be scaled by programmed multipliers and divisors.<br>
User-selected quantities 230 specified by measurement profile 204 can be used to perform totalization. For example, a value from a register location in user-selected quantities 230 (e.g., register 7) can be added to a value stored in a register location (e.g., register 17) to provide a totalized value, and the totalized value is stored in a register location (e.g., register 17). In the embodiment illustrated in Figure 2, up to 8 totalizations can be performed.<br>
Also in the embodiment shown in Figure 2, five demand values (locations 0-4) 210 can be calculated from the quantities in user-selected quantities 230. The values to use for the demand calculations are specified by the demand select. Each demand value may have up to two coincident demands 212, 214 per demand 210. The coincident demands are specified by the coincident select. A coincident demand value may be another one of the selected demands, or the quotient of two selected demands. An average power factor 222 is stored in numerator and denominator form. Time-of-use summaries (A-D) 216 for the selected demands are also available in a time-of-use meter. Up to 20 quantities can be recorded in load profile data 218. The quantities to be recorded are specified by the load profile select. Up to five summations 226 can be calculated. The quantities to be calculated are specified by the summations select. Time of use summaries (A-D) 216 for the selected summations are also available in a time-of-use meter. Data accumulations 224, summations 226, demands 210 coincident demands 212, 214, and time-of-use summaries 216 may be selected for display 210 on the meter's LCD.<br>
-4-<br><br>
Meter 100 can be programmed by an operator, e.g., a utility, so that meter 100 determines desired quantities, regardless of whether that quantity is a common, IEEE-defined value such as apparent volt-ampere-hours, or a quantity used only by a particular utility. Generally, a momentary interval is defined as 60 cycles (for 60 Hz installations) or 50 cycles (for 50 Hz installations) of the fundamental voltage frequency. Known meters calculate a pre-defined set of quantities from the basic quantities every momentary interval. These quantities include total watt-hours (fundamental plus harmonics), apparent volt-ampere-hours, and arithmetic apparent volt-ampere hours. These quantities are summed by the minute. One-minute accumulations of data are stored in a structure called the minute first-in, first-out (FIFO) register. An example of the structure of a minute FIFO is illustrated below.<br>
1-minute accumulation of watt-hours<br>
1-minute accumulation of var-hours<br>
1-minute accumulation of apparent volt-ampere-hours<br>
1 minute accumulation of watt hours<br>
l minute accumulation of var-hours<br>
1 minute accumulation of apparent volt-ampere-hours<br>
1-minute accumulation of watt-hours<br>
1-minute accumulation of var-hours<br>
1-minute accumulation of apparent volt-ampere-hours<br>
Data is retrieved from the minute FIFO and added to other accumulators, from which summations (e.g. total kilowatt-hours), demand calculations (e.g. maximum kilowatt demand), and load profile recording operations are performed.<br><br>
in<br>
Typically there is very little flexibility provided by electricity meters how the momentary interval basic quantities are processed to generate the revenue<br>
-5-<br><br>
quantities that are of interest to utilities. A user may, for example, select from several pre-defined quantities that are computed every momentary interval, and the user may select the length of the demand interval or subinterval and the length of the load profile interval.<br>
In contrast, meter 100 enables a user to define methods of data calculations at all points in the data processing sequence, e.g, at the end of a momentary interval, at the end of a minute, at the end of a demand (sub)interval, and at the end of a load profile interval.<br>
In another embodiment, code is downloaded into an external flash memory, and then a measurement profile is programmed to use the calculation specified by the code. Vectors are used to update and perform a list of tasks in ROM, or are replaced by versions in flash memory for other function blocks.<br>
Figure 3 is a functional block diagram 300 of meter 100. The f( ) blocks in Figure3 illustrate the points during data processing at which user-defined functions can be applied to data. For example, if a user wants to compute apparent volt-ampere-hours (defined as the vector sum of watt-hours, var-hours, and distortion volt-ampere hours), the user defines a fimction that would be executed at the end of each momentary interval. This quantity could then be accumulated for summations, demands, or load profile data. Accumulations of apparent volt-ampere-hours could also be used to compute some other quantity at a different point (e.g. a demand interval accumulation of apparent volt-ampere-hours could be used to compute an average power factor for that demand interval). Examples of some of the mathematical operators that would be available are set forth in the table below. These functions are programmed into the meter non-volatile memory.<br>
Meter 100 can also accumulate data provided by external devices such as other electricity meters, gas meters, and water meters. Typically this is done through hardware that provides pulses to the electricity meter, which counts the pulses (each pulse represents some pre-defined value, e.g. I watt-hour). Meter 100 allows mathematical operations to be defined that operate on accumulations of these pulses.<br>
-6-<br><br>
For example, a utility might have an installation where three electricity meters are required. By having two of the meters provide pulse data to the third meter representing watt-hour usage, and defining in the third meter a calculation to add the pulse data from the other two meters to its own watt-hour data, the utility can read the total watt-hour usage of the installation from one meter<br>
Because a user can specify mathematical operations to be performed on data at a number of steps in the processing of metering data, meter 100 provides that a wide variety of quantities can be determined. Meter 100 also prevents the meter manufacturer from having to anticipate at the product development stage what quantities a utility might require. Since there are constraints that a user must be aware of when programming a meter to compute a given quantity, it is likely that the meter manufacturer would implement for the utility the program that defines the calculations. The utility would then install the program into its programming software package, which would ultimately download the program into meter 100.<br>
-7-<br><br>
Table 1 Momentary interval basic quantities<br>
watt-hours, element A, fundamental + harmonics watt-hours; element B, fundamental + harmonics watt-hours; element C, fundamental + harmonics var-hours, element A, fundamental + harmonics var-hours, element B, fundamental + harmonics var-hours, element C, fundamental + harmonics watt-hours; element A, fundamental only watt-hours; element B, fundamental only watt-hours; element C, fundamental only var-hours, element A, fundamental only var-hours, element B, fundamental only var-hours, element C, fundamental only volt-squared-hours, element A, fundamental + harmonics volt-squared-hours, element B, fundamental + harmonics volt-squared-hours, element C, fundamental + harmonics ampere-squared-hours, element A, fundamental + harmonics ampere-squared-hours, element B, fundamental + harmonics ampere-squared-hours, element C, fundamental + harmonics ampere-squared-hours, element A, fundamental only ampere-squared-hours, element B, fundamental only ampere-squared-hours, element C, fundamental only volt-squared hours, element A, fundamental only volt-squared hours, element B, fundamental only volt-squared hours, element C, fundamental only sample count imputed neutral ampere-squared-hours<br>
Table 2 Other data definitions<br>
Functions of momentary interval basic quantities (user defined)<br>
momentary interval calculation 1 momentary interval calculation 2<br>
momentary interval calculation K<br>
-8-<br><br>
Functions of momentary interval basic quantifies (meter defined)	<br>
momentary interval total wh all harmonic momentary interval total varh all harmonic momentary interval total Wh fundamental momentary interval total varh fundamental<br>
Distortion Vah A Distortion Vah B Distortion Vah c Total Distortion VAh<br>
Meter-defined minute quantities	<br>
one minute accumulation of pulses from channel 1 one minute accumulation of pulses from channel 2<br>
One minute accumulation of pulses from channel L<br>
delivered Wh<br>
lagging varh during delivered Wh<br>
leading varh during delivered Wh<br>
received Wh<br>
lagging varh during received Wh<br>
leading varh during received Wh<br>
User-defined minute quantities	<br>
one minute sum 1 of momentary interval basic quantities one minute sum 2 of momentary interval basic quantities<br>
one minute sum M of momentary inteirval basic quantities<br>
one minute sum 1 of moment. Int. qtys (user-defined) one minute sum 2 of moment. Int. qtys (user-defined)<br>
one minute sum N of moment Int. qtys (user-defined)<br>
one minute sum 1 of moment Int. qtys (meter-defined) one minute sum 2 of moment. Int. qtys (meter-defined)<br>
one minute sum P of moment. Int. qtys (meter-defined)<br>
Functions of one minute user-defined sums (user-defined)	<br>
function 1 of other one minute user-defined sums function 2 of other one minute user-defined sums<br>
function Q of other one minute user-defined sums<br>
-9-<br><br>
Functions of one minute meter-defined sums (user-defined)	<br>
function 1 of other one minute meter-defined sums function 2 of other one minute meter-defined sums<br>
function R of other one minute meter-defined sums<br>
Functions of minute fifo sums (user-defined)	<br>
function 1 of minute fifo sums function 2 of minute fifo sums<br>
function S of minute fifo sums<br>
Demand interval sums (stored in subiniterval queue)	<br>
demand interval sum 1 of one minute user-defined qtys demand interval sum 2 of one minute user-defined qtys<br>
demand interval sum T of one minute user-defined qtys<br>
demand interval sum 1 of one minute meter-defined qtys demand interval sum 2 of one minute meter-defined qtys<br>
demand interval sum U of one minute meter-defined qtys<br>
Functions of demand interval sums (user-defined)	<br>
function 1 of other demand interval sums function 2 of other demand interval sums<br>
function V of other demand interval sums<br>
minimum value 1 during demand interval minimum value 2 during demand interval<br>
minimum value W during demand interval<br>
maximum value 1 during demand interval maximum value 2 during demand interval<br>
maximum value X during demand interval<br>
Load profile interval sums (stored in load profile accumulators)	<br>
load profile interval sum 1 of one minute user-defined qtys load profile interval sum 2 of one minute user-defined qtys<br>
load profile interval sum Y of one minute user-defined qtys<br>
-10-<br><br>
load profile interval sum 1 of one minute meter-defined qtys load profile interval sum 2 of one minute meter-defined qtys<br>
load profile interval sum Z of one minute meter-defined qtys<br>
Functions of load profile interval sums (user-defined)	<br>
function 1 of other load profile interval sums function 2 of other load profile interval sums<br>
function A of other load profile interval sums<br>
minimum value 1 during load profile interval minimum value 2 during load profile interval<br>
minimum value B during load profile interval<br>
maximum value 1 during load profile interval maximum value 2 during load profile interval<br>
-11-<br>
maximum value C during load profile interval min and max values may be voltage, frequency, current, etc. Table 3 Example mathematical operations<br><br><br><br><br><br>
-12-<br><br><br>
-13-<br><br><br>
Flash Memory<br>
In one embodiment, a nonvolatile, alterable flash memory 118 is utilized to store configuration, diagnostic, metering and other data. Flash memory 118 provides the advantage that a tremendous amount of data can be stored, which eliminates a need for a daughter board to add additional memory. Also, a data manager maps requests for data to the physical location of the data. By utilizing the data manager, data can move from one storage medium to another without affecting the metering application.<br>
Flash memory 118 is typically organized into multiple large sectors (64 KB) which can be erased in their entirety. When flash memory is erased, all bits in a sector are set to 1. When data is written, 1 bits are changed to 0 bits. Once a bit has been changed to a 0, it cannot be changed back to a 1 without erasing the entire sector.<br>
For practical purposes, a given location in flash memory can be written to once after it has been erased. To update even a single byte in a record, a new copy of the entire record is written to an unused location. There are many known methods for tracking used, unused and obsolete memory in each sector including file allocation tables (FAT) and linked lists. When a sector becomes full, it is necessary to transfer all "active" records to an unused sector and then erase the "dirty" sector.<br>
-14-<br><br>
Data within meter 100 is organized into logical blocks (e.g. Current Season rate A data, Previous Reset data, Previous Season Data) that are treated as atomic data units (ADU) by the data manager. Each ADU is managed separately. The data manager is responsible for maintaining a pointer to the physical location of the current copy of each ADU. For the metering application to update an ADU stored in flash memory 118, a new copy of the ADU is written to an unused portion of flash memory 118. Since the physical location of the ADU has changed, the pointer to the current ADU is updated. Keeping a pointer to the current ADU eliminates the need to traverse a linked list through flash memory 118 to find the current ADU at the end of the chain.<br>
The list of pointers to current ADUs maintained by the data manager may be kept in RAM or non-volatile memory. The list, however, is saved in nonvolatile at power failure. If stored in flash memory 118, each change to a single ADU requires rewriting the entire list of pointers. Another approach is to maintain the list of pointers in EEPROM 120. With EEPROM 120, only the pointers to affected ADUs must be updated.<br>
ADUs can be combined into logical groupings that are stored in a common set of flash sectors. These logical groupings can be based on, for example, the frequency with which the ADUs are updated and, the size of the ADUs. Each logical grouping of ADUs has at least two sectors dedicated to data storage. One or more sectors are "active", and the remaining sector is erased and available when the last "active" sector fills up. Possible groupings of ADU's include power fail data and communications snap shots, configuration and revenue data, self-reads and event logs, and load profile data.<br>
The data manager also performs a garbage collection task that monitors each group of sectors. When the active sector(s) in a group is full, the garbage collection task initiates the copying of all active ADUs in the oldest sector to a new sector. The copying is done atomicly, one ADU at a time. When an ADU is copied to the new sector, the pointer to the current ADU is updated to match its physical location in the new sector.<br>
-15-<br><br>
Meter 100 can service a power failure in the middle of garbage collection and pick up where it left off without losing any data, and minimizes the amount of time the power fail interrupt is disabled to permit the meter sufficient time to close down in an orderly fashion.<br>
Determining when a sector is full can be done in one of many ways. A "high water" mark can be set for a sector. When the sector crosses that high water mark, garbage collection is initiated. The high water mark could be determined by the size of the largest ADU for a group. Alternatively, the data manager could wait to consider a sector full until it is unable to satisfy a request to allocate storage. If too much space is wasted at the end of the sector, the erase time will increase.<br>
If a second set of pointers are used for data that affects the configuration of meter 100, this second set of pointers can be used to allow the "commitment" and "roll-back" of configuration information. At the beginning of a session to change the configuration, the pointers to the current configuration information are copied. When the configuration information is updated, the updated copy is written to flash and the "copy" pointer is updated. After all configuration information has been written, a command to indicate that the configuration is complete is issued. At that point, the current pointers are updated with copies of the updated pointers. If the configuration process is interrupted before it completes, meter 100 maintains the current configuration. The old configuration information is still available in flash since the original pointers and data were not changed.<br>
Nonvolatile, alterable flash memory and vectors also can be utilized to update the firmware of microcomputer 114 while meter 100 is in service. As explained above, meter 100 uses vectors to functions and/or tasks to provide a level of indirection that can be used to upgrade or patch the code. Meter 100 includes two forms of program memory, specifically, on-chip masked ROM or flash and off-chip flash 118. The on-chip masked ROM typically has a speed advantage over off-chip memory. Time critical functions are stored in the on-chip masked ROM. Other, non-time critical features are stored in either on-chip masked ROM or off-chip flash 118.<br>
-16-<br><br>
For the initial release of the firmware, the on-chip masked ROM could be filled with as much firmware as is practical.<br>
The off-chip flash 118 can be used to store vectors to functions, tasks and/or tables of tasks to be executed and non-time critical functions and tasks. The vectors in the table point to functions or tasks stored in on-chip masked ROM or off-chip flash 118. At power up, these vectors and tables are read into memory. Rather than call a function and/or task directly, the firmware uses the vectors to call functions and/or tasks.<br>
The firmware can be upgraded in multiple ways. For example, a function or task stored in off-chip flash can be directly over written, replacing the old code with new code, or a new function or task can be written to off-chip flash and the corresponding vector updated to point to the new function or task.<br>
A built-in "bootloader" allows new code to be downloaded into the off-chip flash. Meter 100 ceases metering when the bootloader is initiated. The bootloader accepts blocks of new code and writes them to the off-chip flash 118. When the download is complete, meter 100 "reboots" and begins executing with the new code.<br>
Commercially available off-chip flash memories permit programming without any special voltages. In addition, such off-chip flash memories combine two "banks" of memory that act like separate chips. One bank of the chip can be used for code storage. The other bank can be used for data storage. Each bank operates independent of the other. One can be programmed while the other is being read. One such chip can be used to store off-chip code and data.<br>
In other embodiments, a large electrically erasable programmable (i.e., reprogrammable) read only memory (EEPROM) is used for part of the nonvolatile, alterable memory, fa this embodiment, some of the data that is described above as being stored in flash memory is stored, instead, in the EEPROM. However, the load profile is still stored in flash memory 1 18.<br>
-17-<br><br>
It should be recognized that in still other embodiments, other types of nonvolatile, alterable memory can be substituted for EEPROM and flash memory 118. The memory or memories used should retain their contents during periods when power is not applied, and it should be possible to update their contents as needed, although not necessarily in the manner required by a flash memory. One skilled in the art would be able to select appropriate memories and make the necessary circuit modifications to use the selected memory or memories.<br>
I/O Board Addressing<br>
As described above with reference to Figure 1, meter 100 includes an option connector 128 which connects to both simple and complex input/output board (I/O) boards 136 and 138. Flash memory 118 enables functional expansion of meter 100, and such expansion is further facilitated by enabling use of multiple types of I/O boards 130. To facilitate such board interchangeability, microcomputer 114 is programmed to determine the type of I/O board 130 which is being utilized. Figure 4 illustrates the status of microcomputer pins utilized in connection with communication with I/O board 130. The pin positions relate to the identified signals. Microcomputer 114 is operable in a normal mode, and ID mode, and address mode, a read mode, and a write mode with respect to such I/O board 130.<br>
As explained above, multiple types of boards can be provided, and each board type has an identifier. In one specific embodiment, a 3-bit address specifies the board type. For example, an input/output board is specified as a type 001. A logic 0 on all response lines means no option board of the specified type is present. A simple I/O board 136 has an identifier of 01. A complex I/O board 138 has an identifier of 10.<br>
Figure 5 is an exemplary mode diagram for signals of a simple I/O board 136. The signal supplied to I/O board 136 controls the mode of operation of the board, e.g., ID mode, address mode, read mode, and write mode. "X" means "don't care", and "N/A" means "not available". In the write mode, for KYZ outputs, a logic<br>
-18-<br><br>
1 closes the K-Z contact and opens the K-Y contact:  For a 2-wire output, a logic 1 closes the output contact.<br>
Figure 6 illustrates an exemplary mode diagram for signals at a complex I/O board 138. Again, the signal supplied to I/O board 138 controls the mode of operation of the board, e.g., ID mode, address mode, read mode (nib 0), read mode (nib 1), write mode (nib 0), and write mode (nib 1). In the read mode, logic 1 indicates the corresponding input is activated. For 2-wire inputs, only the Z inputs are used. In the write mode, for KYZ outputs, a logic 1 closes the K-Z contact and opens the K-Y contact. For 2-wire outputs, a logic I closes the output contact.<br>
Fast Optocom<br>
As shown in Figure 1, meter 100 includes an optical port 122 for communications with external hand held units and other devices. To enable such communications, both the external unit and optical port 122 include phototransistors. Meter 100 can store significant volume of data (e.g., 2 months of load profile data for 20 channels), and it is desirable to quickly transmit such data to a hand held unit during a communication session. A phototransistor, however, requires that the voltage across the transistor must change in order to switch from a first state to a second state.<br>
To facilitate faster communications, op-amps are connected to the phototransistors. Each op-amp is configured as a current to voltage converter. The op-amp therefore maintains a constant voltage across the phototransistor. As a result, the output can change between a first state and a second state with minimal impact on phototransistor voltage.<br>
Waveform Capture<br>
Microcomputer 114 is programmed to capture waveform data (gain and phase corrected samples) upon the occurrence of a predetermined event An event may, for example, be that the voltage in one of the phases falls below a predetermined percentage of a reference voltage, the voltage in one of the phases rises above a<br>
-19-<br><br>
predetermined percentage of a reference voltage, or a power fail transient is detected. Waveform capture is activated by setting a waveform capture flag, and if the flag is set, a waveform counter is set to a predetermined count, e.g., 70. Upon the occurrence of the event, and if the waveform capture flag is set and if the counter has a value greater than 0, then voltage samples and current samples for each phase are stored in RAM. These samples are stored after DAP 112 interrupts the main process running in microcomputer 114 and the DSP interrupt service routine is invoked. The counter is decremented, and if the counter still has a value greater than 0, then the voltage samples and current samples for each phase at that time are stored. These samples are  also stored after the DAP 112 interrupts the main process and the DSP interrupt routine is serviced. Operations continue in this manner so that upon the occurrence of an event, the desired waveform data is collected.<br>
In one embodiment, microcomputer 114 can be programmed to collect more or less than 70 samples per waveform from a set of six waveforms (three current waveforms and three voltage waveforms). For example, the amount of data collected can be programmed based on the type of triggering event.<br>
Revenue Guard Plus<br>
Microcomputer 114 is programmable to determine energy consumption and other metering quantities for many different form types. In addition, and if one phase voltage is lost during metering operations and the other two phase voltages are still available, microcomputer 114 automatically converts from a three voltage source metering operation to a two voltage source metering operation. For example, and if metering is being performed with three input voltage sources Va, Vb, and Vc, and if one of the phase voltages, e.g., Va, is lost, microcomputer 114 automatically changes to metering to the appropriate form type, i.e., generating metering quantities using Vb and Vc.<br>
More specifically, an in an exemplary embodiment, microcomputer 114 is operable to perform metering in accordance with multiple form types. A case number is assigned to each form type depending, for example, upon the number of<br>
-20-<br><br>
elements and the number of wires. For example, form type 6 corresponds to a WYE configuration when all voltages Va, Vb, and Vc are present. Form types 7, 2, and 8 correspond to metering operations performed when Va, Vb, and Vc, respectively, are absent. If microcomputer 114 is operating in accordance with type 6 and voltage Vt is lost (Va = -{Vb + Vc]), then microcomputer automatically converts to metering in accordance with form type 7. Similarly, if voltages Vb or Vc are lost, then microcomputer 114 automatically converts to metering in accordance with form type 2 or form type 8, respectively. Therefore, rather than discontinuing metering and possibly losing metering data, meter 100 automatically converts to another form type in the event that one of the phase voltages is lost. In one embodiment, meter 100 converts to a 2 1/2 element meter. After a programmable interval, voltage is checked again and an appropriate type (6, 2,7 or 8) is then invoked.<br>
In one embodiment, determining whether voltage Va is lost comprises checking three consecutive times at a 15 second interval after switching back to DSP form type 6. Also, in one embodiment, Vt is considered "lost" when it drops to one-half of the normal voltage. In yet another embodiment, at least one of the number of consecutive checks made before Va is deemed lost, the interval between the checks, and the voltage at which V, is deemed lost is programmable.<br>
Long Communication Session<br>
When an external reader attempts to obtain data from meter 100, and since a large volume of data can be stored in the meter memory, it is desired to provide the reader with a snap shot of data at a particular point in time, rather than accessing the different metering data at different points in time during one communication session. If different data is accessed at different points in time, then it is possible that the metering data will not be consistent, especially if the communication session is long, e.g., 1 hour. For example, a load 142 continues to consume energy during a read operation, and if the communication session requires more than a few minutes to complete, the metering data collected at the beginning of the session will not necessarily correspond to the metering data collected at the end of the session.<br>
-21-<br><br>
Accordingly, in one embodiment, upon receipt of a request for a communication session, e.g., reading a revenue table or a communication requiring a billing read command, microcomputer 114 generates a static copy of selected revenue-related data. For example, the current load profile data is written to EEPROM 120, or a static copy is made in RAM. This snapshot of data is then read out by the reader/host via port 122.<br>
In one embodiment, microcomputer 114 generates the static copy of selected revenue-related data in response to a PSEM command.<br>
By storing the snapshot of data and providing such snapshot of data to the external device, the read data all corresponds to a particular point in time and is consistent, i.e., the data read at minute 1 of the session is obtained under the same circumstance as the data read at minute 60 of the session.<br>
Rollback<br>
In the event that meter 100 is to be updated or reprogrammed during operation, the following procedure is performed to ensure that the update, or new program, is executed as quickly as possible upon initiation of the change. Specifically, EEPROM 120 includes storage locations for active and inactive metering programs, i.e., an active program segment and an inactive program segment. The program currently being utilized by meter 100 is stored in the active program segment of EEPROM 120. The active program controls include, for example, display scroll parameters, time-of-use data, a calendar, season change, and holidays. Billing data is generated in accordance with the active program.<br>
In the event that an update to the active program is required, or in the event that an entirely new program is to be utilized, then a host writes the updated/new program to the inactive segment in EEPROM 120. Upon initiation of writing the updated/new program to EEPROM 120, meter microcomputer 114 also interrupts the then active program and the metering data is stored in the meter memory.   Upon successful completion of the program update, or loading the new<br>
-22-<br><br>
program, microcomputer 114 designates the inactive segment containing the new program as the active segment, and causes metering operations to then proceed. The metering data stored in the meter memory during the update is processed by the new program.<br>
By interrupting metering program operations during the update, and storing the metering data collected during the update and processing such data with the new program once the new program is loaded, the new program is utilized in metering operations as soon as possible. Such operation sometimes is referred to as "rollback" because meter 100 "rolls back" to a previous configuration if a change to a current configuration is interrupted before it is completed. In this manner, meter 100 is not left in an inconsistent state, and can continue operating with a previously programmed set of parameters. (Previously, meters would lose their programs entirely if programming were interrupted.)<br>
If the new program is not successfully written into the inactive segment, then microcomputer 114 does not change the designation of the active segment and metering continues with the program stored in the active segment. Specifically, the metering data collected during the attempted update is processed using the program in the active segment and metering operations continue.<br>
Diagnostics<br>
The following diagnostic operations are performed by meter microcomputer 114. Of course, additional diagnostic operations could be performed by microcomputer 114, and fewer than all the diagnostic operations described below could be implemented. Set forth below are exemplary diagnostic operations and a description of the manner in which to perform such operations. In one exemplary embodiment, diagnostics 1-5 and 8 are checked once every 5 seconds. Also in this embodiment, diagnostics 6 and 7 are checked once every second. A programmable number of consecutive failures are permitted for diagnostics 1-5 and 8, and another, different, programmable number of consecutive failures are permitted for diagnostics 6 and 7 before a diagnostic error results.<br>
-23-<br><br>
Diagnostic #1 (Polarity, Cross Phase, Rev. Energy Flow)<br>
This diagnostic verifies that all meter elements are sensing the correct voltage and current for the electrical service. In an exemplary embodiment, this diagnostic is accomplished by comparing each voltage and current phase angle with expected values. In one specific embodiment, voltage phase angles must be within ten degrees of the expected value and current phase angles must be within 120 degrees of the expected value to prevent a diagnostic 1 error.<br>
Diagnostic #2 (Phase Voltage Alert)<br>
This diagnostic verifies that the voltage at each phase is maintained at an acceptable level with respect to the other phases. In an exemplary embodiment, and for diagnostic 2 tests, the A phase voltage is combined with the user programmed percentage tolerance to determine the acceptable range for the B and C phases voltages as appropriate for the ANSI form and service type. For a 4 wire delta service, Vc is scaled before being compared to Va. In one embodiment, this diagnostic is not performed if Vt is bad.<br>
Diagnostic #3 (Inactive Phase Current)<br>
This diagnostic verifies that the current of each phase is maintained at an acceptable level. A diagnostic 3 error condition is triggered if the current of one or more phases, as appropriate for the ANSI form and service type, falls below a user programmed low current value and at least one phase current remains above this value.<br>
Diagnostic #4 (Phase Angle Alert)<br>
This diagnostic verifies that the current phase angles fall within a user a specified range centered on expected values. In an exemplary embodiment, diagnostic #4 is enabled only if diagnostic #1 is enabled and is checked only if diagnostic #1 passes. The user programmed current phase angle tolerance value for diagnostic #4 has a range of zero to ninety degrees in increments of 1/10 degree.<br>
-24-<br><br>
Diagnostic #5 (Distortion Alert)<br>
This diagnostic verifies that the user-selected form of distortion measured on each individual element and, in the case of distortion power factor, across all elements, is not excessive. This diagnostic is selectable to monitor one of the following distortion measures.<br>
Distortion Power Factor (DPF), per element and summed<br>
Total Demand Distortion (TDD), per element only<br>
Total Harmonic Current Distortion (FTHD), per element only<br>
Total Harmonic Voltage Distortion (VTHD), per element only, if a valid element.<br>
A diagnostic 5 error condition is triggered if any of the distortion calculations exceed a user-specified threshold.<br>
Four counters are associated with diagnostic 5 (one counter for each element, and for DPF only, and one counter for the total of all elements). In an exemplary embodiment, diagnostic 5 is checked only when the one second kW demand exceeds a user programmed threshold which is the same demand threshold used for the power factor threshold output The user programmed distortion tolerance value for diagnostic 5 has a range of 0 to 100% in increments of 1%.<br>
Diagnostic 6 (Undervoltage, Phase A)<br>
This diagnostic verifies that the phase A voltage is maintained above an acceptable level. In an exemplary embodiment, the user programs an undervoltage percentage tolerance for diagnostic 6 that has a range of 0 to 100% in increments of 1%. A diagnostic 6 error condition is triggered if the voltage at phase A falls below the reference voltage (Vref) minus the undervoltage percentage tolerance (T).<br>
Fail Condition: Va 
-25-<br><br>
The threshold used for diagnostic 6 is also used for the potential annunciators.<br>
Diagnostic #7 (Overvoltage, Phase A)<br>
This diagnostic verifies that the phase A voltage is maintained below an acceptable level. In an exemplary embodiment, the user programs an overvoltage percentage tolerance for diagnostic 7 that has a range of 0 to 100% in increments of 1%. A diagnostic 7 error condition is triggered if the voltage at phase A rises above the reference voltage (Vref) plus the overvoltage percentage tolerance (T).<br>
Fail Condition: Va &gt; Vref(100% + T%) Diagnostic #8(High Imputed Neutral Current)<br>
This diagnostic verifies that the imputed neutral current is maintained below an acceptable level. In an exemplary embodiment, a diagnostic 8 error condition is triggered if the imputed neutral current exceeds a user-programmed threshold. Form 45 and 56 as 4WD and 4WY applications are not valid services for determining the imputed neutral values. In these cases, the imputed neutral is zeroed after the service type has been determined.<br>
Meter 100 includes an event log stored in meter memory for capturing information about events. The event log is used, for example, to store the occurrence of events, such as a diagnostic condition sensed as a result of performing one of the tests described above.<br>
In addition, and using complex I/O board 138, an output can be generated by microcomputer 114 to such board 138 to enable remote determination of a diagnostic failure. Such capability is sometimes referred to as a Diagnostic Error Alert When configured for a diagnostic error alert, the following designation may be used to correlate a diagnostic error condition to an output.<br>
Function	Bit<br>
-26-<br><br>
Diagnostic 1	0<br>
Diagnostic 2	1<br>
Diagnostic 3	2<br>
Diagnostic 4	3<br>
Diagnostic 5	4<br>
Diagnostic 6	5<br>
Diagnostic 7	6<br>
Diagnostic 8	7<br>
For example, an output of 01010101 provides a diagnostic error alert for diagnostic tests 1,3,5, and 7.<br>
When one of the selected diagnostics is set, the output is set. When all selected diagnostics are cleared, the output is cleared. Diagnostic operations are not performed when meter 100 is determining the electrical service.<br>
Programmable Durations<br>
In one specific embodiment, the diagnostic tests described above, except diagnostics 6 and 7 (undervoltage and overvoltage), are performed every 5 seconds using one second worth of data. Diagnostics 6 and 7 are performed every second. If a diagnostic fails each check performed during a programmed duration which begins with the first failed check, the diagnostic error is set and the diagnostic counter is incremented.<br>
In an exemplary embodiment, two programmable diagnostic fail durations are provided. One programmable fail duration is for diagnostics 6 and 7, and one programmable fail duration for the other diagnostics. The fail duration for diagnostics 6 and 7 is programmable from 3 seconds to 30 minutes in 3 second<br>
o27-<br><br>
increments. The fail duration for the remaining diagnostics is programmable from 15 seconds to 30 minutes in 15 second increments.<br>
In the exemplary embodiment, two consecutive error free checks are required to clear a diagnostic error condition. The range for all diagnostic counters is 0 to 255. When a diagnostic counter reaches 255, it must be reset by a user. Diagnostic errors and counters may be reset via communications procedures.<br>
Totalizations<br>
As explained above, meter 100 includes a measurement profile 204 that accepts external inputs. The external inputs can, for example, be pulse inputs from other meters associated with a load, e.g., a manufacturing plant. The external inputs can be collected, scaled (e.g., every minute), and then totaled (i.e., summed together) to provide a quantity of total energy consumed from one plant. The totalized value can then be stored in one location. In addition, internal quantities can be totalized (e.g., user-selected quantities can be totalized).<br>
Data Accumulators<br>
In one embodiment, microcomputer 114 includes a 64KB on-board RAM, microcomputer 114 is programmed to accumulate values in its RAM, and these accumulated values are then subsequently displayed on display 124. By programming microcomputer 114 to store and accumulate data in this manner, meter 100 can accumulate metering data for display to an operator. Moreover, a utility company can monitor many quantities without having data by time of use rate, demand reset, seasonal change, etc.<br>
Load Profile<br>
Electricity meters typically store integrated quantities as load profile data. In addition to adding quantities, meter 100 can be programmed to store the maximum and minimum or most recent quantities, i.e., meter 100 can track non-integrated quantities.  A user, therefore, can select up to 20 quantities for recording.<br>
-28-<br><br>
Accordingly, microcomputer 114 is programmed to compare the maximum and minimum values at every interval with the stored quantities, and if a new maximum or minimum is detected, the new maximum or minimum is stored in the appropriate recorder channel.<br>
Demand<br>
As with load profile data, microcomputer 114 is programmed to compare the demand value at every interval with a stored maximum demand in, for example, the on-board RAM. If the current demand is greater than the stored maximum demand, then the current demand is copied over the stored maximum demand and stored. In addition, for non-integrated quantities", momentary by momentary interval comparisons can also be performed.<br>
Coincident Power Factors<br>
Meter 100 is configurable to determine multiple types of demands, such as kW, kVAr, kVA, and distortion KVA. For each demand, there are other, e.g., two, coincident values. Accordingly, meter microcomputer 114 determines, on each interval, demand values and compares the calculated demand values to the stored maximum values. If one of the then calculated values is greater than the corresponding demand stored value, i.e., the current value is the maximum, then the value of the other demands is of interest Specifically, power factor is the quotent of two of the demands, and two coincident power factors can be determined and stored. For example, if there are five demand types, an operator can specify that upon the occurrence of a maximum demand, two coincident power factor values are stored, e.g., Demand 1 / Demand 2 and Demand 3 / Demand 4.<br>
Multiple Distortion Measurements<br>
Meter microcomputer 114 also is configured to calculate distortion power factor for each element (e.g., distortion Van / apparent Van). Microcomputer 114 also calculates a sum of the element distortion power factors, and VTHD. ITHD, and TDD, all per element. The equations used to calculate these values are well known. In<br>
-29-<br><br>
meter 100, the multiple distortion measurements are available for display, and the calculations are performed every momentary interval.<br>
Bidirectional Measures<br>
Microcomputer 114 is father configured to determine, for every momentary interval, the quadrant in which user-selected quantities and other metering quantities such as watthours are being measured. As is well known in the art, the quadrants are defined by real (Wh) and imaginary (VAR). Meter 100 therefore tracks the quadrant in which energy is being received/delivered. Such measurements are  specified by the user in measurement profile 204.<br>
Transformer Loss Compensation<br>
Microcomputer 114 is configured to compensate for energy losses that occur within distribution transformers and lines. Such compensation is enabled if a user selects this option. Transformer loss compensation (TLC) is applied to momentary interval per element Wh, Varh, and Vah data. The transformer model for loss compensation is based on the following relationships with metered voltage and current as variables.<br>
No-load (core) (iron) loss watts are proportional to V2<br>
Load (copper) loss watts are proportional to I2<br>
No-load (core) (iron) loss vars are proportional to V4<br>
Load (copper) loss vars are proportional to I2<br>
Line losses are considered as part of the transformer copper losses.<br>
Every momentary interval the signed losses for each element (x = a, b, c) are determined using the TLC constants and the measured momentary interval V2h and I2h for each element:<br>
LWhFex = iron loss watt hours - Vx2h * G<br>
-30-<br><br>
LWhCUx = copper loss watt hours = Ix2h * R LVarhFEx = iron loss var hours = (Vx2h/h) * Vx2h * B/V2 LVarhCUx = copper loss var hours = Ix2h * X<br>
Compensated watt hours and var hours are then determined for each element by adding the signed losses to the measured momentary interval watthours and var hours.<br>
Compensated Wxh = measured Wxh + LWhFEx + LWhCUx Compensated Varhx = measured Varh + LVarhFEx + LVarCUx<br>
Momentary VAh calculations are made using the compensated watthours and var hours. The distortion component of the Vah value is not compensated for transformer losses.<br>
Pending Actions<br>
When operating in a time-of-use mode, a user may desire to implement a new real-time pricing schedule. In one embodiment, microcomputer 114 also checks every 15 minutes for a real-time pricing command.<br>
More specifically, microcomputer 114 includes a real-time pricing mode for executing a specified real-time pricing (RTP) rate for as long as real-time pricing is active. Microcomputer 114 enters the RTP mode by, for example, a dedicated input from a modem board or an I/O board 130, or by a pending or immediate action. The inputs for RTP include setting an RTP procedure flag which indicates whether to enter or exit RTP. A RTP activation delay (time in minutes) delays entering RTP after the input has been activated. In one specific embodiment, the delay is programmable from 0 to 255 minutes.<br>
During power-up, the saved RTP procedure flag and time remaining until RTP activation are retrieved from EEPROM 120 by microcomputer 114. After microcomputer 114 completes its initialization tasks, the following task are performed.<br>
-31-<br><br>
If the power outage crossed one or more quarter-hour boundaries, microcomputer 114 determines whether a pending RTP action was scheduled for one of the crossed quarter-hour boundaries.<br>
If an RTP action was scheduled, microcomputer 114 determines what the pending RTP action was, and if the action was to enter RTP, microcomputer 114 enters RTP and sets the RTP procedure flag. The RTP activation delay does not delay entering the RTP rate via the pending action.<br>
If the RTP pending action was to exit RTP, the RTP procedure flag is cleared.<br>
If the RTP pending action was to exit RTP or no pending RTP action was scheduled to start during the outage, microcomputer 114 checks the status of the RTP input and the status of the RTP procedure flag. If RTP has been activated, or the enter RTP command had been sent prior to the power failure, microcomputer 114 checks the RTP activation delay timer. If the timer is zero, microcomputer 114 enters the RTP rate. Otherwise, microcomputer 114 enters the RTP rate after the timer expires.<br>
During normal operation, microcomputer 114 checks the status of the RTP input When microcomputer 114 detects that the RTP input has changed state from inactive to active, microcomputer 114 checks the programmed activation delay time. If the delay time is zero, microcomputer 114 enters the RTP rate. Otherwise, microcomputer 114 sets the activation delay timer and enters the RTP rate when the timer has expired.<br>
During RTP mode operations, microcomputer 114 continues to calculate data accumulations, and average power factor and demands are calculated as when in the TOU metering mode. When the RTP signal is de-activated, microcomputer 114 checks the status of the RTP procedure flag.    If the RTP<br>
-32-<br><br>
procedure flag is not set, microcomputer 114 exits the RTP mode. Otherwise, microcomputer 114 remains in the RTP mode until the exit RTP immediate procedure is received or a pending exit RTP action is executed.<br>
When microcomputer 114 exits RTP, microcomputer 114 returns to the TOU rate in effect for the time and date when the RTP ends. Microcomputer 114 processes any unprocessed summations and demand data. For block and rolling demand, the demand intervals end.<br>
In one embodiment, meter 100 is also able to automatically install a new TOU schedule when a pending date/time is reached. This feature allows a new calendar and/or tier structure with setpoints. Generally, microprocessor 114 checks, at midnight of every day, for a pending TOU schedule. If, for example, a TOU schedule is pending for September 1 at midnight, the pending TOU schedule is loaded and becomes active.<br>
Voltage Sags and Swells<br>
The term voltage sag refers to a situation in which a phase voltage falls below a predetermined level, and the term voltage swell refers to a situation in which a phase voltage rises above a predetermined level. Voltage sags and swells generally are power quality concerns, and typically are associated with brown outs and similar events. In meter 100, and if a voltage sag or swell is detected, an event is logged in the event log, and the voltages and currents per event (e.g., maximum and minimum voltage and current per phase) are stored.<br>
-33-<br>
Thresholds are selected to compare the current voltage values against. Specifically, a sag threshold and a swell threshold are determined. For 120 to 480 V services, an exemplary threshold is:<br><br><br>
where SF is a scale factor equal to 3125 x 10-6.    For 57 to 120 V services, an exemplary threshold is given by the above equation, where SF = 500 x 10-6.<br>
5	Given the number of units in a cycle and the sample count, the mean measurement in<br>
volts is:<br><br>
Mean voltages can be determined in accordance with the following:<br><br>
The V2 cycle accumulations are accumulated every sample. Remote Upgrade<br>
Converting meter operation refers to enabling a user to selectively operate the meter in different metering modes, such as selectively operating a meter either a time of use (TOU) or demand metering mode. Specifically, and as described below in more detail, a user can convert, meter operation from a demand only mode to a time of use mode, for example. In one form, the meter has three different modes. These modes are the demand only mode, the demand with load profile mode (sometimes referred to in the art as the demand with timekeeping mode), and the TOU mode.<br>
In general, and in accordance with one aspect of the present invention, a soft switch is associated with optional features, and the soft switch enables remote upgrade and downgrade of the meter. The routines associated with the optional features are stored in meter memory, and when the soft switch for a particular feature is enabled, the routine for the enabled feature is executed, and tables become visible.<br>
-34-<br><br>
Similarly, when the soft switch for a particular feature is not enabled, the routine for the not-enabled feature is not executed and tables are no longer visible.<br>
Examples of optional features enabled and disabled by soft switches are listed below.<br>
TOU<br>
Expanded Measures<br>
Basic Recording / Self-read<br>
Event Log<br>
Alternate Communications<br>
DSP Sample Output<br>
Pulse Initiator Output<br>
Channel Recording/Self-reads<br>
Totalization<br>
transformer Loss Compensation<br>
Transformer Accuracy Adjustment<br>
Revenue Guard Plus<br>
Voltage Event Monitor<br>
Bi-Directional Measurements<br>
Waveform Capture<br>
To downgrade meter function, e.g., remotely using a remote computer communicating with the meter via a communications option board, the meter memory is read to determine which soft switches are installed. An operator then selects a soft switch to be removed, and the appropriate file associated with the switch is disabled. If a significant change will result in removal of a switch, e.g., removing a TOU switch in a TOU meter, a warning message is displayed to the operator requesting confirmation that the selected switch should be removed.<br>
To upgrade a meter, an operator selects a soft switch to be installed. The soft switch is then enabled in the meter and the particular tables and routines associated with the function for that switch are utilized during meter operations.<br>
-35-<br><br>
Additional details regarding upgrade/downgrade are set forth in U.S. Patent Application Serial No. 08/565,464, filed November 30, 1995, now U.S. Patent No. 5,742,512, issued April 21, 1998, and entitled ELECTRONIC ELECTRICITY METERS, which is assigned to the present assignee and hereby incorporated herein, in its entirety, by reference. In this application, at least some operations described as being performed in the DSP would be performed in the microcomputer of the present meter.<br>
Meter Form Types<br>
Meter 100 includes instruction sets identifying processing steps to be executed to determine line voltages and line currents for respective meter form types. Such instruction sets are . stored, for example, in microcomputer memory. Microcomputer 114 is configured to receive a control command via optical port 122, and microcomputer 114 then processes the data received from ADC 112 in accordance with the selected instruction set.<br>
The underlying process steps to make calculations such as reactive power and active power are dependent upon the meter form and the electrical circuit in which the meter is connected. For example, the meter form types includes meter ANSI form 9 and meter ANSI form 16 type forms, the number of elements may be 3, 2, 2 1/2, or 1, and there are a number of circuit configurations in which the meter can be connected. The meter form, elements, and circuit configurations affect the inputs received by microcomputer 114 and the meter operation. Additional details regarding such operations are set forth in U.S. Patent Application Serial No. 08/857,322, filed May 16, 1997, and entitled AN ELECTRONIC ELECTRICITY METER CONFIGURABLE TO OPERATE IN A PLURALITY OF METER FORMS AND RATINGS, which is assigned to the present assignee and hereby incorporated herein, in its entirety, by reference. In this application, at least some operations described as being performed in the DSP would be performed in the microcomputer of the present meter.<br>
-36-<br><br>
it will be seen that the above-described embodiments control data flow in an electricity meter more simply than embodiments requiring a division of functionality between a DSP and a microcomputer. Furthermore, embodiments of the present invention readily accommodate user-defined functions tailored to a particular utility's needs.<br>
While the invention has been described in terms of various specific embodiments, those skilled in the art will recognize that the invention can be practiced with modification within the spirit and scope of the claims.<br>
-37-<br><br>
WE CLAIMS<br>
1.   A method for controlling data flow in an electronic elec fcricifcy meter comprising the steps of s<br>
measuring current and voltage of a power source;<br>
determining a set of internal quantities using the measured current and voltage;<br>
using the set of internal quantities in conjunction with a set of functions to determine calculated quantities;<br>
using a measurement profile to select calculated quantities to store calculated quantities as measurement profile quantities; and<br>
storing the determined measurement profile quantities in registers within the meter.<br>
2.	A method as claimed in claim 1 wherein determining a set  of<br>
internal  quantities comprises the step of determining  at  least<br>
one  of  watt hours, var-hours, volt-squared hours,  and  ampere-<br>
squared hours.<br>
3.	A  method as claimed in claim 1 wherein using  the  set  of<br>
internal  quantities  in conjunction with a set of  functions  to<br>
determine  measurement profile quantities  comprises the step  of<br>
determining  total  kilowatt  hours  (kWh)  and   kilovoIt-ampere<br>
reactive hours (KVArh)<br>
38<br><br>
4.	A method as claimed in claim 1 wherein using the set  of<br>
internal  quantities  in conjunction with a set of  functions  ta<br>
determine measurement profile quantities  comprises the step of<br>
using user defined functions stored in the meter to determine the<br>
measurement profile quantities.<br>
5-	A method as claimed in claim 1 wherein using the set  of<br>
internal  quantities  in conjunction with a set of  functions  to<br>
determine measurement profile quantities  comprises the step of<br>
using-pre-programmed  functions stored in the meter to  determine<br>
the measurement profile quantities.<br>
6.	A method as claimed in claim 1 comprising the step of  col<br>
lecting additional data provided by an external device comprising<br>
at least one of an electric meter, a gas meter, or a water meter.<br>
7.	A method as claimed in claim 6 wherein the external  device<br>
is another electric meter.<br>
8.	A method as claimed in claim 6 wherein the external device<br>
is a gas meter-<br>
9.	A method as claimed in claim 6 wherein the external device<br>
is a water meter.<br>
10.	A  method  as claimed in claim 1  comprising  the  step  of<br>
totalizing selected stored measurement profile values to generate<br>
a  totalized  quantity, and storing the totalized quantity  in  a<br>
register of the meter.<br>
39<br><br>
11.	A method as claimed in claim 1 comprising the step of deter<br>
mining demand values using the stored measurement profile values.<br>
12.	A  method  as claimed in claim 1 comprising  the  step  of<br>
determining coincident demand using the stored measurement  prov-<br>
ile values.<br>
13.	A  method  as claimed in claim 1 comprising  the  step  of<br>
determining  power  factor values using  the  stored  measurement<br>
profile values.<br><br>
14.	A method as claimed in claim 1 wherein user-selected  quan<br>
tities  are determined using the measurement profile  quantities,<br>
and wherein the user-selected quantities are  stored in a  first-<br>
in, first-out (FIFO) register.<br>
15.	An electronic electricity meter (100,104, 106,114)  config<br>
ured to:<br>
measure current and voltage of a power source (102);<br>
determine a set of internal quantities (202) using the measured current and voltage;<br>
use the set of internal quantities (202) in conjunction with a set of functions (F (n&gt;) to determine calculated quantities (228)1<br>
use a measurement profile (204) to select calculated quantities (228) to store calculated quantities as measurement profile quantities (230); and<br>
store the determined measurement profile quantities in registers within the meter.<br>
40<br><br>
16 A meter as claimed in claim 15 wherein said meter (100) being configured to determine a set of internal quantities (202) comprises said meter being configured to determine at least one of watt hours, var-hours, volt-squared hours, and ampere-squared hours.<br>
17.	A meter  as claimed in claim 15 wherein said meter (100)<br>
being  configured to use the set of internal quantities (202)  in<br>
conjunction with a set of functions  (F(n)) to determine measure<br>
ment profile quantities (230) comprises  said meter being config<br>
ured to determine total kilowatt hours CkWh) and  kiloval t-ampere<br>
reactive hours (kVArh).<br>
18.	A meter  as claimed in claim 15 wherein said meter (100)<br>
being configured to use the set of internal quantities (202)   in<br>
conjunction with a  set of functions (F(n) to determine  measure<br>
ment profile quantities (230) comprises said meter being  config<br>
ured to use user defined functions stored in the meter to  deter<br>
mine the measurement profile quantities (230).<br>
19.	A meter  as claimed in claim 15 wherein said meter (100)<br>
being  configured to use the set of internal quantities (202)  in<br>
conjunction with a set of functions (F(n)) to determine  measure<br>
ment profile quantities (230) comprises said meter being  config<br>
ured  to  use  pre-programmed functions stored in  the  meter  to<br>
determine the measurement profile quantities (230).<br>
41<br><br>
20.	A meter  as claimed in claim 15 configured to collect  addi<br>
tional  data provided by an external device comprising  at  least<br>
one of an electric meter, a gas meter, or a water meter.<br>
21.	A meter  as claimed in claim 20 configured to collect  the<br>
additional data from another electric meter.<br>
22.	A meter  as claimed in claim 20 configured to collect  the<br>
additional data from a  gas meter.<br>
23.	A  meter  as claimed in claim 20 configured to collect the<br>
additional data from a  water meter.<br>
24.	A  meter  as claimed in claim 15  configured  to  totalize<br>
selected, stored measurement profile values to generate a  total<br>
ized quantity) and to store the totalised quantity in a  register<br>
of the meter.<br><br>
25.	A  meter   as claimed in claim 15  configured  to  determine<br>
demand values using the stored measurement profile values.<br>
26.	A  meter   as claimed in claim 15  configured  to  determine<br>
coincident demand using the stared measurement profile values.<br>
27.	A  meter  as claimed in claim 15  configured  to  determine<br>
power   factor   values   using the  stored  measurement  profile<br>
values.<br>
42<br><br>
43<br>
28. A meter as claimed in claim 15 wherein said meter is configured to determine user-selected quantities using the measurement profile quantities, and to store user selected quantities in a first-in first-out (FIFO) register-<br>
The present invention, in one embodiment, is a method for control1ing data flow in anelectronic electric meter (100). The method includes steps of measuring current (104) and voltage (106) of a power source (102); determining a set of internal quantities (202) using the measured current and voltage; using the set of internal quantities (202) in conjunction with a set of functions to determine measurement profile quantities (204); and storing the determined measurement profile quantities (204) in registers within the meter.</td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
		<br>
		<div class="pull-left">
			<a href="206698-interleaving-apparatus-and-method-for-use-in-serial-concatenated-convoluttional-code-encoder-in-a-mobile-communication-system.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="206700-a-process-for-treating-an-aqueous-liquid.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>206699</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>IN/PCT/2001/00152/KOL</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>19/2007</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>11-May-2007</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>10-May-2007</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>06-Feb-2001</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>GENERAL ELECTRIC COMPANY</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>ROVER ROAD, SCHENECTADY, NEW YORK 12345,</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>LAVOIE, GREGORY P</td>
											<td>73 BROOK FARM VILLAGE ROCHESTER, NEW HAMPSHIRE 03839,</td>
										</tr>
										<tr>
											<td>2</td>
											<td>OUELLETTE, MAURICE</td>
											<td>790 OAKWOODS ROAD, NORTH BERWICK, MAINE 03906,</td>
										</tr>
										<tr>
											<td>3</td>
											<td>LEE, JR. ROBERT E</td>
											<td>44 LEDGEVIEW DRIVE, ROCHESTER, NEW HAMPSHIRE 03839,</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>G0/R11/32</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/US00/18013</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2000-06-29</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>60/141,771</td>
									<td>1999-06-30</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/206699-a-method-for-controlling-data-flow-in-an-electronic-electricity-meter-and-an-electronic-electricity-meter-therefor by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 03:54:51 GMT -->
</html>
