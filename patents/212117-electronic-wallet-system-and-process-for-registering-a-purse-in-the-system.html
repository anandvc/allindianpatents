<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/212117-electronic-wallet-system-and-process-for-registering-a-purse-in-the-system by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 00:40:09 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 212117:ELECTRONIC WALLET SYSTEM AND PROCESS FOR REGISTERING A PURSE IN THE SYSTEM</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">ELECTRONIC WALLET SYSTEM AND PROCESS FOR REGISTERING A PURSE IN THE SYSTEM</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>The electronic wallet system comprises a plurality of devices (10-13) interconnected through a local network and capable of conducting electronic business transactions on an open network. Each device contains a smart card reader (130-133). A plurality of smart cards (3I-3P) represent electronic purses able to contain electronic money. One of the devices contains an entity(1,101), the server, which contains a list of data entries, each entry corresponding to a purse liable to receive electronic money, contained in tokens, from other purses of the system. The tokens transferred between purses are stored temporally by the server. In order to improve the security of the transactions, the messages which are exchanged between the devices and/or the smart cards during token transfer operations are protected by secret keys which are only stored in the smart cards of the system.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>FIELD OF THE INVENTION<br>
The present invention relates generally to electronic wallets for performing electronic commercial transactions on open networks such as internet, and more particularly to a new electronic wallet architecture and to methods for transferring tokens (or electronic money units) between electronic wallets.<br>
BACKGROUND ART<br>
Another European patent application No. 00400606.0 filed the same day as the present application (March 7, 2000), in the name of the same applicant and having the following title : "electronic wallet system", describes an electronic wallet system having a client / server architecture and comprising a plurality of purses. The client and server applications are executed in devices, such as set-top boxes (STB) and the system allows secure inter-purses operations.<br>
The present application proposes an alternative solution to secure inter-purses operations in the electronic wallet system.<br>
SUMMARY OF THE INVENTION<br>
The invention relates to an electronic wallet system comprising n devices capable of conducting electronic business transactions on an open network and containing a smart card reader, wherein n is superior or equal to 1, and a plurality of smart cards representing electronic purses able to contain electronic money. The devices are interconnected through a local network and one of the devices comprises an entity, called the server, which contains a list of data entries, each entry corresponding to a purse liable to receive electronic money contained in tokens from others purses of the system. The server stores temporally the tokens when they are transferred between purses. According to the invention the messages which are exchanged between the devices and/or the smart cards during token transfer operations are protected by secret keys which are only stored in the smart cards.<br>
The invention further relates to a process for registering a purse in such an electronic wallet system as described in section A-2. of the description.<br>
The invention also relates to a process for depositing a token from a first purse for a second purse in such an electronic wallet system as described in section A-3. of the description and to a process for receiving a token in a purse as described in section A-4. of the description.<br>
In addition, the invention concerns a process for recovering tokens which have been deposited for one purse using the token depositing process as<br>
described in section A-3. bellow but which have not been received by said purse when using the token receiving process described in section A-4. bellow. This lost token recovery process is described in section B of the description.<br>
Moreover, the invention relates to an electronic wallet system in which each smart card of the system further contains an address of the server on the open network and in which each device is capable of conducting remote token depositing process, as described in section C-1. of the description, and / or remote token receiving process, as described in section C-2. of the description, with a remote electronic wallet system connected to the open network.<br>
BRIEF DESCRIPTION OF THE DRAWINGS<br>
The various features and advantages of the present invention and its preferred embodiments will now be described with reference to the accompanying drawings which are intended to illustrate and not to limit the scope of the present invention and in which:<br>
Fig. 1 illustrates the general architecture of an electronic wallet system according to the invention.<br>
Fig. 2 illustrates an example of hardware architecture of an electronic wallet system according to the invention.<br>
Fig. 3 illustrates some data contained in one entity called the server of the electronic wallet system.<br>
Fig. 4 illustrates a first process involved in the transfer of tokens from one purse of the electronic wallet system to another.<br>
Fig. 5 illustrates a second process involved in the transfer of tokens from one purse of the electronic wallet system to another.<br>
Fig. 6 illustrates a process for registering one purse in the server of the electronic wallet system.<br>
Fig. 7 illustrates the first process for transferring tokens from one purse to another in which security features have been added.<br>
Fig. 8 illustrates the second process for transferring tokens from one purse to another in which security features have been added.<br>
Fig. 9 is an example illustrating a lost token recovery process.<br>
Fig. 10 describes a lost token recovery process.<br>
Fig. 11 illustrates an interconnection of electronic wallet systems through an open network.<br>
Fig. 12 and 13 illustrate a remote process for transferring tokens from one purse to another in the case of electronic wallet systems interconnected through an open network as shown in Fig. 11.<br>
DESCRIPTION OF THE PREFERRED EMBODIMENTS<br>
Fig. 1 illustrates the general architecture of a local electronic wallet<br>
system according to the invention which corresponds to the configuration of the<br>
system in a family.<br>
As it can be seen on this Fig. 1, an electronic wallet system contains three entities:<br>
- a first entity 1 called the Server which is connected to an open<br>
network 40 (for example internet). This entity is responsible for the inter-purses operations, as will be explained in more details bellow ;<br>
- a set of k second entities 21 to 2k called clients which are also connected to an open network 40 (e.g. Internet). Moreover, each of these clients is also connected to the server via a local home network;<br>
- a set of p smart cards 31 to 3p, the third entities (where p is the number of persons in the family) which implement the purses. Thus, each member of the family possesses his own purse represented by a smart card.<br>
From these different entities, each member of the family should be able to participate to secured e-commerce activities. In fact, a smart card provides to the user an efficient and secure way to store all personal and sensitive data such as private keys, digital tokens, authentication data, etc.<br>
An example of hardware implementation of this architecture is illustrated in Fig. 2. The entities "Server" and "Clients" are implemented, in a preferred embodiment, by software applications running in devices such as set-top boxes, computers, game stations, portable phones or any other home equipment.<br>
In the example of Fig. 2, a first set-top box 10 contains the server application 101 and one Client) application 121. This first set-top box is for example located in the living-room of the family house. A second set-top box 11, located in another room of the house, contains another Clients application 122, while two other devices, a game station 12 and a computer 13, located in children bedrooms for example, contain respectively Client3 application 123 and Client* application 124. The devices are equipped with smart card readers 130 - 133 and are all connected to a home network 250, which may be an IEEE 1394 wire or wireless network. This home network 250 provides a connection to an open network 140 for all the devices 10-13.<br>
All the applications 101, 121 - 124 use some resources of the devices to access to the smart card readers 130-133 and to the local and / or open network.<br>
In order to simplify the further discussion, the terms "server" and 5 "client" will be used hereafter to refer either to the application itself or to the device containing the application, with the exception that the device referred to as "server" also contains a client application.<br>
Thus, when the user wants to perform electronic financial operations<br>
(electronic commerce, token purchase, purse-to-purse token transfer...), he has<br>
 to insert his smart card in the smart card reader of a client (here, the device)<br>
that contains all needed software in order to perform all of these activities<br>
(macropayment protocols, micropayment protocols, etc.).<br>
It should be noted that the server is also capable of performing electronic financial and business operations because it also contains a client<br>
5 and that, in an extreme solution, the electronic wallet system contains only one device containing the server application and one client application.<br>
We will now describe the inter-purses operations.<br>
Contrary to classical financial operations (e-commerce, token<br>
 purchase, etc.), the inter-purses operations need the participation of the server.<br>
 All needed information used to make these inter-purses operations are<br>
centralized in the server which is connected to all clients via a local home<br>
network (250 in Fig. 2).<br>
The inter-purses transfer of tokens is implemented by two operations: token depositing and token receiving. During the token depositing operation, a<br>
user A deposits x tokens intended for another family member B from any client. The x tokens are debited from the purse of the user A and stored temporally in<br>
 the server. Next time, when the user B inserts his purse at any client, the token receiving operation is called to download the x tokens from the server. In this<br>
 way, tokens are transferred from the purse of the user A to the purse of the user<br>
 B thanks to the server.<br>
To this end, the server contains a list of all registered purses<br>
representing the purses which can receive tokens from other purses. The registered purses are used to temporally store the list of tokens intended for the owner of the purses.<br>
Figure 3 shows an example of these internal data located on the<br>
server. On this figure, three purses denoted by Pa, Pb and PD are registered in the server. As for purse Pa, no tokens have been stored meaning that the purse Pa has not received any token from another purse. As for purse Pb, the token Ti<br>
denoted by (10,Pa) indicates that the purse PB has received 10$ (or 10 Euro, or 10 units of any money used in the electronic wallet system) from the purse PA. This token will be transferred to the purse PB at the next use of Ps. As for purse Pd, the tokens T2 (20 units of money received from purse Pa) and T3 (1 unit of money received from purse PB) will be transferred to Pd at the next use of Pd-<br>
It is therefore necessary to consider, in addition to the operations of token depositing and token receiving, a third one, called purse registering. This operation consists in the registration of the purses in the server. It should be noted that only a user who whishes to receive tokens from other purses" holders of the family must have his purse registered.<br>
The first operation, called the token depositing process, will now be described in view of Fig. 4.<br>
When a user A who owns a purse Pa desires to transfer tokens to another purse, the user A has first to insert his smart card corresponding to purse Pa in a client and to chose, via the user interface of the client, the application for transferring tokens to another purse. Then, the client on which the user A is connected (that means, on which the smart card representing the purse Pa is inserted) sends a request to the server (Message "getPurseLisf sent at step 50 - Fig. 4) which sends back a response with the list of all registered purses (designating those which can receive tokens) in a message "ListPurses(m,PIDi,...,PIDm)" (step 51) where "m" designates the number of registered purses and "PID1, ..., PIDm" designate the different purse"s identifiers of the list of registered purses. Once the client receives this list, it displays it to the user A who can choose the recipient Pb of the token transfer and the amount to be transferred.<br>
Next, the client sends to the server a message "Deposit(amount,purse_recipient,purse_sender)" (at step 52) wherein "amount corresponds to a number of units of money to transfer, "purse_recipienf is the recipient"s purse identifier (here, it corresponds to PIDb) and "purse_sender" is an information about the sender of the tokens. Advantageously this information will be the sender"s purse identifier PIDa or the name of user A. When the server receives this message, it adds a token Ti=(amount,PA) in the list of tokens stored in the entry corresponding to purse Pb. In a simplified implementation of the invention, the "purse_sender" information can be omitted from the "Deposit() message. In this case, the token stored in the server will only contain the "amount information.<br>
Now, the second operation, called the token receiving process, will be described in view of Fig. 5.<br>
This process is executed each time a user B enters his smart card, corresponding to purse Pe, in a client and is used to contact the server in order to download tokens stored in the entry corresponding to purse PB in the server.<br>
The two following messages will be exchanged at steps 60, 61, 60", 61" as long as there are remaining tokens stored in the server"s entry corresponding to purse Pb.<br>
The first message "GetNextToken(purseJd)" is sent by the client to the server (steps 60, 60") with "pursejd" being the identifier of the purse (here PIDB). On receipt of this message, the server copies the first token of the list attached to the pursejd entry and deletes this token. Then, it sends to the client (at steps 61, 61") the second message "Token(purse-id,amount)", where "pursejd" is the identifier of the purse (here PIDB) and "amount" indicates the amount of money to be transferred. When the client receives this second message, it credits the purse PB with the amount indicated.<br>
A - Security issues<br>
Before participating in e-commerce activities as well as inter-purses operations with the electronic wallet system of the invention, the user must be sure that the system cannot be easily attacked and for this purpose, solutions providing a sufficient level of security have to be proposed.<br>
We will first present the security requirements concerning the inter-purses operations supplied by the electronic wallet system. Then, based on these security requirements, the security solutions proposed by the invention, which ensure a sufficient level of security of the electronic wallet system, will be presented.<br>
The main threats on the electronic wallet system can be listed as follows :<br>
- the purses registered in the server belong to outsiders of the family;<br>
- money is illegally minted;<br>
- tokens are lost forever during the inter-purses operations;<br>
- tokens intended for a user are stolen by another user, either inside or outside the family.<br>
The invention therefore proposes security solutions to reduce these threats and meet the following security requirements:<br>
- only the purses owned by the family members can be registered in the server (of course, this requirement is not strictly limited to real members of a family and can be extended to people "considered as" family members);<br>
- the money minting should be prevented;<br>
- the tokens lost during inter-purses operations should be detected and recovered;<br>
- the tokens should be transferred to the destined person.<br>
1. Configuration<br>
Each family possesses a set of secret keys SK, SKA, SKT and SKR (acronyms are explained in Table 1 bellow) shared by the purses owned by the family members. These secret keys are sealed inside the purses (i.e. the smart cards) before their delivery and only the electronic wallet system manufacturer knows them.<br>
We suppose in the following that a family has p purses (i.e p smart cards) and that m purses are registered in the server of the electronic wallet system (with m=p).<br>
According to the invention, all the secrets which are used to secure the inter-purses operations of the electronic wallet system are only stored inside the smart cards representing the purses of the electronic wallet system.<br>
Each purse P, (i.e. each smart card SCard1 to SCardp) contains the information listed in Table 1 bellow (with 1= i = p):<br>
The server contains a list of entries. Each entry corresponds to a registered purse whose purse identifier is PIDi, with 1
It should be noted that the notation SK(M) will be used throughout the specification to designate "M || Sign(K, M)" where "Sign(K, M)" is the signature or the MAC (standing for "Message Authentication Code", more details about which can be found in « Handbook of applied cryptography, Alfred J. Menezes, Paul C. van Oorschot, Scott A. Vanstone, 1997, page 325 ») of the message M using the key K and where "||" represents the concatenation operator.<br>
2. Purse registration<br>
D As mentioned previously, in order to receive tokens from other<br>
purses, a purse must be registered in the server which is responsible for inter-purses operations.<br>
So, before a user B, for example a children, can receive tokens from a user A, for example one of his/her parents, the purse of user B must be 5 registered in the server.<br>
In a preferred embodiment of the invention, this registration phase<br>
will ensure that only members of the family can have their purse registered in<br>
the server. Of course this is not strictly limited to real members of the family and<br>
the purse registration can be extended to people "considered as" members of<br>
 the family.<br>
It is therefore proposed that a given member of the family has the root rights to register the purses of all members of the family. Unlike the other members of the family, only this privileged user, called the "root user" in the following, will be authorized to execute the registration phase. In the electronic 5 wallet system, the root user is considered as a "third trust party" which will ensure that all registered purses are owned by a member of the family.<br>
In order to implement this functionality, a special smart card for which the PIN (Personal Identification Number) has the administration rights ("roof rights) is provided by the electronic wallet system manufacturer together with 0 the other entities of the system. This special card will be referred to as the "roof card" in the following. A "rootPIN" is stored in the root card to provide a way to verify that the user who attempts to execute the registration phase is the root<br>
user. Moreover, in a preferred embodiment, the software for executing this registration phase is preferably only contained in the server and this registration phase is always executed on the server.<br>
In an alternative embodiment, this root card may be one of the purses of the electronic wallet system.<br>
Now, we will describe more precisely, in view of Fig. 6, how this registration phase is executed according to a preferred embodiment. We suppose that user X is the root user. When X wants to initiate the registration process, X has first to insert the root card in the server. Then he enters rootPIN to prove that he is indeed the root user in order to start the registration process.<br>
This entered rootPIN is sent by the server to the smart card (the root card) in a message "register(rootPIN)" (at step 70). Then, the root card verifies that the root PIN received matches the one stored in the card.<br>
The rootPIN is used to ensure that only the authorized person has the right to register the purses of the family. This ensures that only the purses owned by the family members can be registered in the server.<br>
Then, if the verification is positive, the root user will be able to remove the root card and to insert the smart card corresponding to the purse he wants to register in the server, for example purse Pb belonging to user B.<br>
The smart card corresponding to Pb creates a signed purse identifier Sska(PIDb) and a signed transaction identifier Sskt(PIDb, TranslDBS) where TranslDBS is initialized with TranslDsP stored in PB. It should be noted that, at the installation of the system, TranslDes is initialized at 0<br>
Sska(PIDb) prevents the purse identifiers PIDb to be modified during the transmission or when it is stored in the server.<br>
Sskt(PIDb, TranslDBs) aims at initializing the transaction identifier TranslDBS of tokens deposited for the purse Pe. The TranslDBs is associated to the PIDB and signed using the secret key SKT. This prevents the TranslDBs to be modified during the transmission or when it is stored in the server.<br>
The smart card sends this information to the server in a message "Reglnfo" (step 71). Then, the server creates an entry for the purse Pb and stores the information contained in Reglnfo in this entry.<br>
These steps are repeated for each one of the m purses to be registered.<br>
It should be noted that the modification of either PIDB or TranslDBs stored in one entry of the server would cause the tokens to be refused by the purse for which they are intended, therefore resulting in the loss of these tokens.<br>
In addition, this registration process should be executed preferably at the very beginning of the electronic wallet system installation. It should also be noted that, in the case that the server loses the information of registered purses due to technical failure or vandalism attacks, the purses should be registered<br>
 again using the same process..<br>
 In an alternative embodiment of the registration process, the root<br>
card contains the purse identifiers PID, of all the purses of the electronic wallet system as well as the secret keys SKA and SKT. In this particular embodiment, the registration process is executed at the installation of the system and it is not<br>
necessary to enter all the smart cards corresponding to the purses of the electronic wallet system in the server.. The Reglnfo message sent at step 71 for each registered purse is constructed by the root card thanks to the information it contains with the signed transaction identifier initialized at zero. Reglnfo therefore contains, for example for purse PB.<br>
5 Reglnfo = SSka(PIDb), SSkt(PIDb, 0).<br>
This alternative registration process can only be used at the installation of the system and the process which has been described previously according to a preferred embodiment is still used when it is necessary to register again one purse (for example when the server has lost the information<br>
3 regarding this purse).<br>
3. Token depositing process<br>
In Fig. 4, we have illustrated the general principle of the Token depositing process. We will now describe an improved secure protocol used in the first process of the inter-purses operations and illustrated in Fig. 7.<br>
5 We suppose that a user A having a purse PA wants to deposit some<br>
tokens for another purse PB. The user A first inserts the smart card corresponding to purse Pa in a client and selects a Token depositing application on the client. The client then sends to the server a message "getPurseLisf at step 150 to request the list of the registered purses.<br>
 On receipt of this message, the server sends back to the client the<br>
list of the identifiers of the registered purses in a message "PID1,...,PIDm" at step 151. This list is presented to the user by the client and the user chooses the recipient purse identifier PIDB and enters the number N of units of money he wants to transfer to the recipient purse.<br>
5 The client then sends a message "getPurselnfo(PIDB)" to the server<br>
at step 152 to request some information about the chosen recipient purse. Next, the server constructs a "Purselnfo" message containing local data stored in the<br>
entry corresponding to PIDB on the server. The "Purselnfo" message contains the signed purse identifier SSka(PIDb) and the signed transaction identifier Sskt(PIDb, TranslDBs) and is sent to the client at step 153. Thanks to the signatures Sska and Sskt, both the PIDb and the TranslDBs cannot be modified<br>
 during the transmission.<br>
TranslDBS is an ever increasing integer, stored in the server"s local data, in the entry corresponding to the registered purse PB. It memories the number of tokens deposited for purse PB since the registration of the purse PB. The deposited tokens are temporarily stored in the server and will be transferred to the purse PB through the "token receiving" process at the next use of purse PB. As previously stated, the transaction identifier TranslDBs is initialized with the value of the purse transaction identifier TranslDBp stored in the purse during the registration phase (which is equal to zero at the installation of the system). It is then incremented when tokens are deposited on the server for purse Pb-<br>
When the client receives the "Purselnfo" message, it sends a message "debitTokens(N, Purselnfo)" to the smart card corresponding to purse Pa (which is inserted in the client) at step 154. This message will debit the counter of purse Pa of N units of money to be transferred to purse PB-<br>
 On receipt of the "debitTokens(N, Purselnfo)" message, the smart<br>
card (corresponding to purse Pa) executes the following operations :<br>
- it checks the signature of the purse identifier PIDB using key SKA;<br>
- it checks the signature of the transaction identifier TranslDBs using key SKT;<br>
i - If these verifications are positive, then it generates a random<br>
number C;<br>
- it decrements the purse Pa counter by N units;<br>
- it creates a signed token "SSk(N, PIDb, TranslDBs, PIDA, Cf meaning that N units of money are intended for purse Pb from purse Pa,<br>
i - it increments the received transaction identifier TranslDBS and<br>
creates a signed incremented transaction identifier "SSKT(TranslDBS++)"\ and<br>
- it sends to the client the signed token and the signed incremented transaction identifier in a message "Tokenlnfo" at step 155.<br>
Since the token is signed using the secret key SK shared by the<br>
 purses in the family, an attacker cannot forge or modify the token. In addition,<br>
since PIDB is included in the token representation, an attacker cannot steal<br>
tokens intended for another family member. The transaction identifier Trans/Dss<br>
is introduced in the token to prevent a replay attack and the random number C<br>
contained in the token is used to counter an attack that would compromise the secret key SK of the smart card by analyzing the output cipher texts.<br>
Moreover, the information PIDA contained in the token may be omitted in an alternative simplified embodiment.<br>
When the client receives the "Tokenlnfo" message, it forwards it to the server at step 156 in a command message "putTokens(Tokenlnfo)". On receipt of this command, the server stores the corresponding token in the entry of purse Pb, it increments the index and it updates the signed transaction identifier Trans\Des with the incremented transaction identifier received in the "Tokenlnfo" message.<br>
4. Token receiving process<br>
The general principle of the Token receiving process has been described in view of Fig. 5. We will now present an improved secure protocol used in the second process of the inter-purses operations and illustrated in Fig. 8.<br>
This process is executed each time a user inserts his/her smart card representing a purse in a client. Here, we suppose that the user has a purse Pb whose identifier is PIDb-<br>
The first step 160 consists for the client in sending a message "getPID" to the smart card to request the purse identifier. The smart card responds to this request by sending, at step 161, the purse identifier PIDb to the client. Then, the client sends a message "GetNextToken(PIDB)" to the server (step 162) to fetch the next token stored on the server.<br>
On receipt of this message, the server checks whether tokens are stored in the entry corresponding to purse PIDb. If no tokens have been deposited for purse PIDB, then the server sends "-1" to the client (at step 163). Otherwise:<br>
- it fetches the first token (in fact a signed token "Ti - Ssk(N, PIDb, TranslDBs, PIDA, C)") stored in the entry corresponding to Pe;<br>
- it decrements the Indexs of entry Pe, the IndexB indicating the number of tokens still left on entry PB of the server; and<br>
- it sends to the client the lndexB and the token at step 163.<br>
If the client has not received "-1" at step 163, then it forwards the token to the purse Pb in a command message "CreditToken(Token)" sent at step 164.<br>
When the purse Pe receives tokens through creditTokens command, it checks the validity of the tokens by verifying if the following conditions hold:<br>
- Vsk(Ssk(N, PIDb, TranslDBs, PIDA, C)) == N, PID, TranslDBs, PIDA; C (verification of the signature of the received token); and<br>
- TranslDBs= TranslDBp<br>
where the secret key SK, the purse identifier PID and the purse transaction identifier TranslDBp come from the user"s purse PB, where the challenge C, the purse sender identifier PIDA, the server transaction identifier TranslDBs and the amount of units of money N are copied from the received token and where "Vsk(Ssk(M)) == M" if the message M has been signed with the key SK.<br>
The purse transaction identifier TranslDBp is an ever increasing integer, stored in the purse PB. It memories the number of tokens received by the purse PB. These tokens are downloaded from the server. The purse transaction identifier is initialized at 0 when the purse is registered by the electronic wallet system manufacturer. Upon reception of tokens, the purse verifies if TranslDBp is equal to or less than the server transaction identifier (TranslDBs) contained in the token. Then, if this verification and the verification of the signature of the token are positive, the purse increments its counter by N and it updates its transaction identifier TranslDBp to TranslDBs +1. Thanks to this feature, the same tokens can never be used more than once to credit the purse.<br>
Next, steps 162 to 164, followed by verifications and actions described above performed in the purse PB, are repeated while Index, (received at step 163) is greater than zero.<br>
B - Lost tokens recovery<br>
Based on the security solution described previously, it is possible to ensure that only the purses owned by the family members can be registered in the electronic wallet system. Moreover tokens can never be forged, modified, replayed or stolen during the inter-purses operations.<br>
However, no solution has been presented to prevent tokens to be lost. Tokens can be lost due to some accidental errors such as technical failure of local network or Set-Top Boxes of the electronic wallet system. It can also be caused by vandalism attacks like deleting tokens stored in server or in transmission, etc.<br>
Therefore, in a preferred embodiment of the invention, an audit process allowing to identify and recover lost tokens will be implemented in the electronic wallet system.<br>
The tokens are defined as being lost if and only if they have been debited from a purse PA or PB, but they are never credited to the purse PD. Here we use an example to illustrate the process where PA and Pb transfer tokens to Pd through the server 1 as illustrated in Fig. 9.<br>
1. Starting of the process<br>
The audit process starts when the owner of PD claims (falsely or truly) that he has not received tokens from PA or Ps. Another alternative solution is that the process is called periodically.<br>
The audit is processed locally by the root user of the electronic wallet system. He has to collect all the purses of the family (i.e. all the smart cards representing the purses of the family members). The process is executed by the server of the electronic wallet system.<br>
During the audit process, the "transaction traces" stored in all the purses (Pa, Pb, Pd) will be studied in order to recover the lost tokens.<br>
2. Transaction traces for audit<br>
As for purses PA or Pb, they store traces of "Token depositing" transactions intended for the purse PD, noted as :<br>
DepositTraces{Px, Pd) = <transldxd sum_of_depositedxd><br>
TranslDxD is an inter purse transaction identifier and sum_of_depositedxD is an inter purse deposit count.<br>
In other words, each time when the purse Px deposits 1 token containing N units of money and the server transaction identifier TranslDDS to the purse Pd, TranslDxo is updated to TranslDos and N is added to sum_of_depositedxD- The definition of inter-purses operations (Token depositing and Token receiving process) ensures that TranslDxo keeps an ever increasing order. Note that X is either A or B in our example.<br>
As for purses Pd, it stores traces of "Token receiving" transactions originated from purses PA and Pb, noted as :<br>
ReceiveTraces(PD) = sum_of_receivedD<br>
sum_of_receivedD is a receive count.<br>
In other words, each time when the purse Pd recovers 1 token containing N units of money sent by the purse Px, N is added to sum_of_receivedo-<br>
3. Identify lost tokens from transaction traces<br>
From the definition of inter-purses operations, it is possible to prove that:<br>
- Sx sum_of_depositedxD ^ sum_of_receivedD always holds, meaning that token minting is impossible ;<br>
- if Sx sum_of_depositedxD - sum_of_receivedo then no token has been lost;<br>
- if Sx sum_of_depositedxD &gt; sumjofjreceivedo then some tokens have been lost.<br>
The amount of lost tokens intended for PD is equal to: LostTokens(Po) = Sx sum_of_depositedXD - sum_of_receivedo<br>
4. Recovery of lost tokens<br>
In order to recover the lost tokens intended for PD (containing the current purse transaction identifier TranslDoP), four operations should be done:<br>
- first, the counter of PD is credited by LostTokens{PD);<br>
- second, the purse transaction identifier of Pd is updated to Max(TranslDDp, TranslDxD +1);<br>
- third, sum_of_receivedD is set to 0 ;<br>
- and fourth, for the purse Px, sum_of_depositedxD is set to 0 where X is A or B in our example.<br>
It should be noted that the second operation aims at preventing the following attack: the holder of PD keeps the tokens intended for him and claims the loss of those tokens. If the transaction identifier of PD was not updated, he would be able to recover those tokens through the "Token receiving" operation. This attack would cause the minting of money.<br>
5. Secure audit process<br>
Fig. 10 illustrates the secure audit process which allows to recover lost tokens intended for the purse PD with the help of transaction traces stored in the purses of the family.<br>
In a first step (not represented in Fig. 10), as during the registration process, the root user has to insert the root card in the server and to enter the root PIN before being allowed to start the secure audit process.<br>
Then, in a second step, the root user inserts purse PD in the server which sends to purse Pd a message "getChallenge" at step 180 requesting the purse PD to generate a random number C. On receipt of this message, PD generates and stores a challenge C and it sends C to the server at step 181.This random number C is stored in both PD and the server. Thanks to C, it will not be possible to replay messages exchanged during one execution of the process during another execution of the audit process.<br>
Then the root user will insert all the other purses of the family (Pa and Pb in our example). For each purse Px inserted in the server, the server will first send a message "getDepositTracesfPIDo, C)" to the purse Px (steps 182 and 184 in Fig. 10). In response to this message, the purse Px generates the following message using the uDepositTrace(PIDx,PIDD)" field stored in purse Px:<br>
TracexD - SsKFt(TranslDxD, sum_of_depositedxD, PIDx, PIDd, C)<br>
which is sent to the server at steps 183, 185.<br>
Then, the sum_of_depositedxD field of DepositTrace(PIDx,PIDo) stored in Px is set to 0 when the purse Px sends the TracexD message to the server.<br>
The TracexD message is signed using a secret key SKR by the purse Px which has deposited tokens for PD. Therefore, nobody can forge/modify this message. SKR is a secret key used in the lost tokens recovery process. Like other secret keys, it is stored in the smart cards representing the purses by the electronic wallet system manufacturer and shared by the family members.<br>
The random number C (received by the purse Px in the "getDepositTrace" message sent at step 182, 184) is introduced in the Tracexo message to counter a possible replay attack (e.g. replaying recoverTokens message explained bellow).<br>
All the TracexD messages received by the server are stored in the entry corresponding to purse Po in the server.<br>
Then, when the root user has successively introduced and removed all other purses of the family in the server, he finally reintroduced purse Po in the server.<br>
Next, at step 186, all the Tracexo messages are sent to Pd through a recoverTokens command.<br>
Upon reception of TracexD by Pd, the signature of TracexD is checked by verifying if the following condition holds:<br>
VsKR(SsKR(TranslDXD, sum_of_depositedXD, PIDx, PIDD, C) == TranslDxD, sum_of_depositedXD, PIDx, PID, C;<br>
where the secret key SKR, the purse identifier PID and the challenge C come from the purse Pd,<br>
where TranslDxD, sum_of_depositedxD and PIDx are copied from the received Tracexo message and<br>
i where "Vskr(Sskr(M)) == M" if the message M has been signed with<br>
the key SKR.<br>
Then, if the verification is positive, the following calculation is made by purse Pd-<br>
LostTokens(Po) = Sx sum_of_depositedXD - sum_of_receivedD<br>
= sum_of_depositedAD + sum_of_depositedBD - sum_of_receivedo<br>
where sum_of_receivedD is taken from the ReceiveTraces(PD) stored inPD.<br>
The result of this calculation gives the number N of units of money which have been lost due to the loss of tokens. This amount N is therefore credited to the counter of PD.<br>
Then, as explained in point 4. above, the transaction identifier of Pd is updated to:<br>
TranslDoP = Max (TranslDoP, TranslDAB + 1, TranslDaD + 1).<br>
Finally, the sum_of_receivedo field of ReceiveTraces(Po) is set to 0.<br>
Moreover, it should be noted that it is the root user"s responsibility to gather all the purses of the family before launching the secure audit process which has been described here. Otherwise, some lost tokens would not be recovered.<br>
C - Remote access mode<br>
Thanks to the architecture of the electronic wallet system of the invention presented in Fig. 1, it is possible to interconnect several electronic wallet systems 200 ... 300 through an open network 240 as illustrated in Fig. 11.<br>
In Fig. 11, we have represented:<br>
- a first Electronic wallet systemi 200 comprising a Server 201, a set of Clients 221 to 22k and a set of p smart cards representing purses 231 to 23p of a first family; and<br>
- another Electronic wallet systemr 300 comprising a Server 301, a set of Clients 321 to 32I and a set of q smart cards representing purses 331 to 33q of another family.<br>
The servers 201, 301 and the clients 221 - 22k, 321 - 32I are all connected to the open network 240 (e.g. Internet).<br>
With this extended architecture, it is now possible to perform inter-purses operations between several local electronic wallet systems and thus each inter-purses operation presented in sections A-3. and A-4. above can be made locally or remotely depending on the recipient purse (in the case of Token depositing process) or on the locality of the client (in the case of Token receiving process).<br>
More precisely, a user A can transfer tokens from his purse towards another purse of the family whatever the compliant electronic wallet system he<br>
is connected on and he can receive tokens from any purse of the family each time he inserts the smart card representing his purse on a client of a compliant electronic wallet system, this system being at home or not.<br>
This feature is made possible thanks to the fact that each electronic<br>
5 wallet system server is connected to an open network such as Internet and has a unique IP address ("IP" standing for "Internet Protocol") which identifies the server on the network and which is known by all family members. This IP address of the server is preferably stored in the smart cards of the family, for example at the initialization of the system.<br>
3 We will now describe how the remote inter-purses operations are<br>
performed based on the secure protocols that have been described previously (in sections A-3. and A-4.) to perform local inter-purses operations.<br>
1. Remote Token depositing process 5 This process is illustrated in Fig. 12.<br>
We suppose that a user A having a purse Pa belonging to a first electronic wallet system wants to deposit a token containing N units of money on a purse PB which is registered on a server S belonging to the same electronic wallet system.<br>
D The user A inserts his smart card representing purse Pa in a client<br>
connected to a local server S1.<br>
At first, at step 251, the IP address of the server S which is stored in Pa is sent to the client. The client then checks whether the received IP address is or is not the one of the local server S".<br>
5 If S and S" are the same server, then the local mode will be chosen<br>
and the process will be the same as the one which has been described previously in view of Fig. 7. Otherwise, if S1 belongs to a different electronic wallet system than S, the remote mode will be chosen.<br>
Here, we suppose that S and S" are different servers of different 0 electronic wallet systems and that the remote mode has been chosen.<br>
In this case, at the next step 252, the client sends to the server S" a first message ugetPurseList(IP address S)". This message is the same as the one sent at step 150 in Fig. 7 (as the other messages which will follow) except the fact that, in remote mode, the IP address of the server S on which is 5 registered the recipient purse Pb is added to the message. At the following step 253, this message is forwarded to the server S by the server S" through the open network 240 in a known manner thanks to the IP address of the server S.<br>
On receipt of this message, the server S responds by sending (at step 254) the list of registered purses "PIDh ..., PIDB,.... PIDm" to the server S" which forwards this message to the client on which the user A is connected at step 255.<br>
The client displays the received list to the user A who can choose the recipient purse PB and indicate the amount N of money to be transferred to PB. Then, at step 256, a message "getPurselnfo(PIDB)" is sent by the client to the server S1 (as in step 152 in Fig. 7) which forwards it to the server S at step 257. The server S responds, at step 258, by sending a "Purselnfo" message to the ) server S" (as in step 153 of Fig. 7), the "Purselnfo" message being forwarded to the client on which the user A is connected at step 259.<br>
On receipt of this "Purselnfo" message, at step 260, the client sends to the smart card representing purse Pa a "debitToken(N, Purselnfo)" message similar to the message sent at step 154 in Fig. 7.<br>
i Next, the smart card (or purse Pa) verifies the content of "Purselnfo"<br>
by checking the signatures of the purse identifier PIDb and of the transaction identifier TranslDBs using keys SKA and SKT.<br>
It should be noted that each electronic wallet system has its own set of secret keys SK, SKA, SKT and SKR which are embedded in the purses of ) the family members and which are different from one electronic wallet system to the other. In this case, as the purse Pa belongs to the same electronic wallet system as the purse PB, they both share the same set of secret keys SK, SKA, SKT and SKR and Pa can verify the content of the "Purselnfo" message.<br>
i Returning to Fig. 12, if the verification of the content of "Purselnfo" is<br>
positive, then the purse Pa sends to the client a signed token and a signed incremented transaction identifier in a message "Tokenlnfo" at step 261 (similar to the message sent at step 155 in Fig. 7).<br>
When the client receives the "Tokenlnfo" message, it sends it to the<br>
) server S" at step 262 in a command message "putTokens(Tokenlnfo)"", this message being forwarded by the server S" to the server S at step 263.<br>
On receipt of this command, the server S stores the corresponding token in the entry of purse PB and performs the same actions as described previously in view of Fig. 7, after step 156.<br>
2. Remote Token receiving process This process is illustrated in Fig. 13.<br>
We suppose now that a user B has his purse PB registered in a server S of a first electronic wallet system and that B wants to receive the tokens which have been transferred to his purse and which are registered on the server S.<br>
The token receiving process is either launched as soon as a user inserts his smart card representing a purse in a client connected to a local server S1 or when the user has chosen, through the user interface of the client, to launch this process. Here, we suppose that the user B has inserted his purse Pb in the client and that the token receiving process is launched.<br>
The first step 270 consists in the sending of a message "getPID" by the client to the smart card representing purse Pb- The purse responds by sending its purse identifier and the IP address of the server S on which it is registered (message UPIDB, IP address S" sent at step 271).<br>
When the client receives this message, it checks whether the received IP address is the one of the local server S" on which it is connected or not to choose between the local mode and the remote mode. If S and S1 are the same server, then the local mode will be chosen and the token receiving process will be the same as the one described previously in view of Fig. 8. Otherwise, the remote mode will be chosen.<br>
In the following, we will suppose that S and S" are different servers of different electronic wallet systems and that the remote mode has been chosen for the token receiving process.<br>
In this case, the client sends to the local server S" a message "GetNextToken(PIDB, IP address S)" at step 272. When the server S" receives this message, it checks the IP address contained in the message and if the IP address is different from its own, then it forwards the message through the open network 240 to the server S at step 273.<br>
When the server S receives this message, it will act in the same manner as what has been described previously in view of Fig. 8 when the server receives message "GetNextToken(PIDB)" at step 162. If at least one token has been deposited for purse Pb on the server S, it will send back to the server S1 a message "IndexB, Token" at step 274 (message similar to the message sent at step 163 in Fig. 8) and the server S1 will forward this message to the client on which the user B is connected at step 275.<br>
Next, at step 276, the client forwards the token to the purse Pb in a command message "CreditToken(token)" similar to the one sent at step 164 in Fig. 8. The smart card representing purse PB will then do the same verifications<br>
(thanks to the secret key SK stored in the smart card) and actions as the ones that have been described in view of Fig. 8, after step 164.<br>
Steps 272 to 276, followed by the above mentioned verifications and actions performed by the smart card are repeated while lndexB (received at step 275) is greater than zero.<br>
WE CLAIM:<br>
1 .Electronic wallet system comprising:<br>
n devices (10-13) capable of conducting electronic business transactions<br>
on an open network (40,140) and containing a smart card reader (130-133), wherein n is superior or equal to 1, said devices being interconnected through a local network (250)<br>
a plurality of smart cards (31-3p) representing electronic purses able to contain electronic money;<br>
wherein one of said devices comprises an entity (1,101), called the server, which contains a list of data entries, each entry corresponding to a purse liable to receive electronic money contained in tokens from others purses of said system.;<br>
said server storing temporally said tokens when they are transferred between purses;<br>
and wherein messages which are exchanged between said devices and/or said smart cards during token transfer operations are protected by secret keys which are only stored in said smart cards.<br>
2.System as claimed in claim 1, wherein each smart card contains:<br>
- a unique purse identifier (PIDi<br>
- a counter of money;<br>
- a purse transaction identifier (TranslDip);<br>
- a first purse identifier secret key (SKA); and<br>
- a second transaction identifier secret key (SKT);<br>
said first and said second secret keys being shared by all the purses of said system.<br>
3.System as claimed in claim 2, wherein at the installation of the system, said counter of money and said transaction identifier(TranslDPjP) are initialized at zero.<br>
4.System as claimed in claim 2 or 3, wherein each entry corresponding to a purse (Pi) in said server contains:<br>
-said purse indentifier (PIDi) and a signature of said purse identifier using said first secret key (SKA);<br>
-a server transaction identifier (TranslDis) and a signature of said transaction identifier and of said purse identifier using said second secret key (SKT); and<br>
-an index (Indexi) of the number of tokens received for said purse by the server.<br>
5.System as claimed in claim 4, wherein each smart card contains a third token secret key (SK) shared by all the purses of said system; and wherein each entry corresponding to a purse (Pj) in said server contains, should the index (Index) be greater than zero: at least one token containing:<br>
-an amount of money (N); -said purse identifier (PIDj);and - said server transaction identifier (TranslDiS); and a signature of said token using said third secret key.<br>
6.System as claimed in claim 5, wherein said token contains an information about the sender of the token.<br>
7.Process for registering a purse (Pj) in a system as claimed in any one of claim 2 to 6, said process for a device containing said server, comprising the steps of:<br>
(a) receiving a specific smart card, called the root card;<br>
(b) receiving a personal identification number (rootPIN) entered by a user on said device and sending said personal identification number to said root card, said root card verifying that the received personal identification number matches a personal identification number stored in said root card; and should verification be positive:<br>
(c) receiving a smart card corresponding to the purse (Pj) to be registered; and<br>
(d) receiving from said smart card data containing:<br>
a purse identifier (PID,) and a signature of said purse identifier using said first secret key (SKA);<br>
- a server transaction identifier (TranslDjS) initialized with the value of the purse transaction identifier (TranslDip) stored in said smart card and a signature of said server transaction identifier and of said purse identifier (PID,) using said second secret key (SKT); and<br>
(e) storing the data received from said smart card in the entry corresponding to said purse in said server.<br>
8.Process for depositing a token from a first purse(PA) for a second purse (PB) in an electronic wallet system as claimed in claim 5 or 6, said process for a device having an entity (21,22,2K;121-124) called a client, comprising the steps of:<br>
(a) receiving a smart card corresponding to said first purse (Pa);<br>
(b) receiving (153) from the server data (Purselnfo) containing:<br>
-a purse identifier (PIDB) of said second purse (PB) and a signature of said purse identifier using the first secrej key (SKA); and<br>
- a server transaction identifier (TranslDBs) for said second purse and a signature of said server transaction identifier and of said second purse identifier (PIDB) using the second secret key (SKT);<br>
( c) sending (154) to said smart card said data (Purselnfo) received from said server and the amount (N) of money to be deposited for said second purse; said smart card verifying the signatures contained in said data using said first (SKA) and said second (SKT) secret keys, and should verification be positive:<br>
(d) receiving (155) from said smart card data (Tokenlnfo) containing:<br>
- a token and a signature of said token using the third secret key (SK); and<br>
- an incremented server transaction identifier (TranslDBs++) for said second purse and a signature of said incremented server transaction identifier and of said second purse identifier using the second secret key (SKT);<br>
(e) sending (156) to said server said data received from said smart<br>
card.<br>
9.Process as claimed in claim 8, comprising, before step (b), the steps<br>
comprising of: (a1) sending (150) a first message (getPurseList) to said server to request a<br>
list of purses liable to receive tokens;<br>
(a2) receiving (151) from said server a list of purse identifiers (PID1.....PIDm) of<br>
the purses liable to receive tokens; and<br>
(a3) sending (152) a second message (getPurselnfo(PIDB) to said sefyer to request information about said second purse (PB)<br>
10. Process as claimed in claim 8 or 9, wherein said smart card corresponding to said first purse (PA) decrements said first purse counter by the amount (N) of money to be deposited for said second purse before step (d).<br>
11.Process as claimed in any one of claims 8 to 10, wherein when the token contained in data sent at step (d), the data comprises:<br>
- the amount (N) of money to be deposited for said second purse;<br>
- said second purse identifier (PIDb);<br>
- the server transaction identifier (TranslDBS) for said second purse; and<br>
- a random number (C ).<br>
12.Process as claimed in claim 11, wherein said token comprises: said first purse identifier (PIDA).<br>
13.Process for receiving a token in a purse (PB) in an electronic wallet system as claimed in claim 5 or 6, said process for a device having an entity (21,22,2k; 121-124) called a client, comprising the steps of:<br>
(a) receiving a smart card corresponding to said purse (PB);<br>
(b) sending (162) to the server a message (GetNextToken(PIDB) to request a token stored for said purse (Pb) in the server, and should at least one token be stored in the entry corresponding to said purse (PB) in the server:<br>
(c) receiving (163) from the server the index (lndexB) and a token stored in the entry corresponding to said purse;<br>
(d) sending (164) the token to said smart card; and „<br>
(e) repeating steps (b) to (d) while the value of the received index (Indexs) is greater than zero.<br>
14. Process as claimed in claim 13, wherein the server decrements said index (lndexB) before step ( c).<br>
15.Process as claimed in claim 13 or 14, comprising , before step (b), the steps of:<br>
- sending (160) said smart card a first message (getPID) to request the purse identifier; and<br>
- receiving (161) from said smart card said purse identifier (PIDB).<br>
16. Process as claimed in any one of claims 13 to 15, wherein when a signature of the token using said third secret key (SK) is attached to the token received at step ( c) and is sent to said smart card at step (d); Said process for said smart card comprising the steps of: (d1) verifying said signature of the token and<br>
(d2) verifying that the server transaction identifier (TranslDBs) contained in said token is greater than or equal to the purse transaction identifier (TranslDBp) stored in said smart card; and should verifications be positive: (d3) incrementing the purse counter by the amount (N) of money contained in said token; and<br>
(d4) storing in said purse transaction identifier(TranslDBp) the value of the server transaction identifier (TranslDBs) incremented by one.<br>
17. Process as claimed in any one of claims 8 to 12 in an electronic wallet system wherein each smart card additionally contains deposit trace data for each purse liable to receive tokens from other purses, said data comprising:<br>
- an inter purse transaction identifier; and ; •<br>
- an inter purse deposit count; and<br>
wherein, before step (d), said smart card corresponding to said first purse (Pa):<br>
- updates the inter purse transaction identifier for said second purse (TranslDAB) with the value of said server transaction identifier for said second purse (TranslDBS) received at step (b); and<br>
- adds the amount (N) of money to be deposited for said second purse (Pb) to the inter purse deposit count for said second purse<br>
(sum_of_deposiiedAB)-<br>
18. Process as claimed in claim 16 in an electronic wallet system wherein each smart card additionally contains receive trace data having a receive count,<br>
Wherein, after step (d4), said smart card adds the amount (N) of money contained in said token to the receive count (sum_of_receivedB) of said purse (PB).<br>
19. Process for recovering tokens which have been deposited for one first purse (PD) using a process as claimed in claim 17 but which have not been received by said purse when using a process as claimed in 18 in an electronic wallet system as claimed in 5 or 6, said process (for a device containing the server), comprising the steps of:<br>
(i) successively receiving the smart cards corresponding to all the other purses of said system and, for each of said purses (Px), receiving deposit trace data (TraceXD) for said first purse (PD), said deposit trace data containing ¦ t*4<br>
- the inter purse transaction identifier (TranslDXD); and<br>
- the inter purse deposit count (sum_of_depositedXD);<br>
(j) receiving the smart card corresponding to said first purse (PD);<br>
(k) sending to said smart card all the deposit trace data received at step<br>
(0;<br>
the process further comprising the steps consisting for said smart card in:<br>
(I) calculating the sum of the received inter purse deposit counts (£x sum of_depositedXD) minus the receive count of said first purse (sum_of_receivedD) and incrementing the counter of said first purse<br>
(PD) with the result of this calculation;<br>
(m)setting the the receive count of said first purse (sum_of_receivedD) to<br>
zero. 20. Process as claimed in claim 19, comprising, before step (i), the steps of:<br>
(hi) receiving the smart card corresponding to said first purse (Pd);<br>
(h2) sending (180) to said smart card a first message (getChallenge)<br>
requesting a random number; and<br>
(h3) receiving (181) from said smart card a random number (C );<br>
said random number (C ) being sent, at step (i), with the first purse<br>
identifier (PIDD) to each smart card corresponding to all the other purses<br>
of said system in a second message (getDeposit Traces(PIDD,C)) and<br>
wherein each deposit trace data (TracexD) for said first purse (PD) received at step (i) further contains:<br>
- said random number ( C );<br>
- the purse identifier (PIDX) of each other purse; and<br>
- said first purse identifier (PIDd)<br>
21. Process as claimed in claim 20 in a system is which each smart card additionally a fourth token recovery secret key (SKR), wherein a signature of said deposit trace data using said fourth secret key is attached to said deposit trace data received at step (i).<br>
22. Process as claimed in claim 21, comprising, before step (I), for the smart card corresponding to said first purse (Pd), the steps of:<br>
- verifying the signature of said deposit trace data using said fourth secret key (SKR); and<br>
- verifying that the random number ( C ) contained in said deposit trace data matches the random number generated by said smart card before step (h3);<br>
the steps (I) and (m) being executed only if said verifications are positive.<br>
23.Process as claimed in claim 22 comprising, after step (I) for the smart card corresponding to said first purse (Pd), the steps of:<br>
Updating said first purse transaction identifier (TranslDDP) with the maximum value of:<br>
- said first purse transaction identifier (TranslDDp); and<br>
- each inter purse transaction identifier contained in the deposit trace data incremented by-one (TranslDXD+1)-<br>
24.Electronic wallet system as claimed in any one of the claims 1 to 6, wherein each smart card of the system additionally comprises an address of said server on the open network (IP address S) and wherein each device is capable of conducting remote token depositing process and /or remote token receiving process with a remote electronic wallet system connected to said open network.<br>
The electronic wallet system comprises a plurality of devices (10-13) interconnected through a local network and capable of conducting electronic<br>
business transactions on an open network. Each device contains a smart card<br>
reader (130-133). A plurality of smart cards (3I-3P) represent electronic purses<br>
able to contain electronic money. One of the devices contains an entity(1,101),<br>
the server, which contains a list of data entries, each entry corresponding to a<br>
purse liable to receive electronic money, contained in tokens, from other purses<br>
of the system . The tokens transferred between purses are stored temporally by<br>
the server. In order to improve the security of the transactions, the messages<br>
which are exchanged between the devices and/or the smart cards during token<br>
transfer operations are protected by secret keys which are only stored in the<br>
smart cards of the system.</transldxd></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAxMjYtY2FsLTIwMDEtYWJzdHJhY3QucGRm" target="_blank" style="word-wrap:break-word;">00126-cal-2001-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAxMjYtY2FsLTIwMDEtY2xhaW1zLnBkZg==" target="_blank" style="word-wrap:break-word;">00126-cal-2001-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAxMjYtY2FsLTIwMDEtY29ycmVzcG9uZGVuY2UucGRm" target="_blank" style="word-wrap:break-word;">00126-cal-2001-correspondence.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAxMjYtY2FsLTIwMDEtZGVzY3JpcHRpb24gKGNvbXBsZXRlKS5wZGY=" target="_blank" style="word-wrap:break-word;">00126-cal-2001-description (complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAxMjYtY2FsLTIwMDEtZHJhd2luZ3MucGRm" target="_blank" style="word-wrap:break-word;">00126-cal-2001-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAxMjYtY2FsLTIwMDEtZm9ybSAxLnBkZg==" target="_blank" style="word-wrap:break-word;">00126-cal-2001-form 1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAxMjYtY2FsLTIwMDEtZm9ybSAxOC5wZGY=" target="_blank" style="word-wrap:break-word;">00126-cal-2001-form 18.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAxMjYtY2FsLTIwMDEtZm9ybSAyLnBkZg==" target="_blank" style="word-wrap:break-word;">00126-cal-2001-form 2.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAxMjYtY2FsLTIwMDEtZm9ybSAyNi5wZGY=" target="_blank" style="word-wrap:break-word;">00126-cal-2001-form 26.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAxMjYtY2FsLTIwMDEtZm9ybSAzLnBkZg==" target="_blank" style="word-wrap:break-word;">00126-cal-2001-form 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAxMjYtY2FsLTIwMDEtZm9ybSA1LnBkZg==" target="_blank" style="word-wrap:break-word;">00126-cal-2001-form 5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAxMjYtY2FsLTIwMDEtbGV0dGVyIHBhdGVudC5wZGY=" target="_blank" style="word-wrap:break-word;">00126-cal-2001-letter patent.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAxMjYtY2FsLTIwMDEtcHJpb3JpdHkgZG9jdW1lbnQgb3RoZXJzLnBkZg==" target="_blank" style="word-wrap:break-word;">00126-cal-2001-priority document others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAxMjYtY2FsLTIwMDEtcmVwbHkgZi5lLnIucGRm" target="_blank" style="word-wrap:break-word;">00126-cal-2001-reply f.e.r.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="212116-process-for-producing-chromans.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="212118-an-improved-loop-sensor-for-measuring-the-looper-angle-forthe-purpose-of-strip-tension-regulation-in-a-hot-strip-mill.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>212117</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>126/CAL/2001</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>47/2007</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>23-Nov-2007</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>20-Nov-2007</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>02-Mar-2001</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>THOMSON MULTIMEDIA</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>46 QUAI A. LE GALLO, F-92100 BOULOGNE-BILLANCOURT</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>DURAND ALAIN</td>
											<td>79 RUE DE DINAN, F-35000 RENNES</td>
										</tr>
										<tr>
											<td>2</td>
											<td>LELIEVRE SYLVAIN</td>
											<td>69 RUE DE VERN, F-35000 RENNES</td>
										</tr>
										<tr>
											<td>3</td>
											<td>TANG-TALPIN YAN-MEI</td>
											<td>39 SQUARE DU GRAND PLACIS, F-35700 RENNES</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>G 07 F 7/08</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>N/A</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td></td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>00400605.2</td>
									<td>2000-03-07</td>
								    <td>EPO</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/212117-electronic-wallet-system-and-process-for-registering-a-purse-in-the-system by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 00:40:10 GMT -->
</html>
