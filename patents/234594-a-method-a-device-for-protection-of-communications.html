<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/234594-a-method-a-device-for-protection-of-communications by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 14:20:12 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 234594:A METHOD A DEVICE FOR PROTECTION OF COMMUNICATIONS.</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">A METHOD A DEVICE FOR PROTECTION OF COMMUNICATIONS.</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>A method for protection of information for use in a device coupled to a communications channel, comprises : determining a security service to perform with a data block; generating security information to pass along with the data block, the security information identifying the security service ; and processing in a controller adapted to control communication with the communications channel, the data block according to the security information. A device (50) for protection of information, comprises a machine-reliable storage medium containing instructions for execution in a system having a controller (52) adapted to control communications with a communications channel (47), the instructions when executed causing the system to : identify a security service to be performed on data to be transmitted over the communications channel ; and prepare security control information to pass along with the data to the controller to perform processing according to the identified security service.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>Background of the Invention<br>
The invention relates to a method and a device for protection of<br>
communications, communicated over a transport medium such as a network.<br>
With the increasing use of networks and other transport media for<br>
communications, security has become an increasing concern. Various<br>
security protocols have been utilized to protect data entering or leaving a<br>
device that is coupled to a transport medium such as a network (e.g. local<br>
area network, wide area network, the Internet). A security protocol may<br>
include cryptographic algorithms (including encryption, decryption, and<br>
authentication) to maintain the confidentiality of transmitted information as<br>
well as authentication of the information origin.<br>
Cryptographic operations typically involve data intensive arithmetic<br>
operations that take up substantial amounts of processing in a system. To<br>
reduce the load on a main processor in a system in performing cryptographic<br>
operations, some systems include a co-processor to perform some of the<br>
data intensive processing. In a conventional co-processor architecture, a<br>
main processor (under control of an application program) loads data to be<br>
processed (encrypted, hashed, and so forth) into a system memory, which<br>
may be accessed by a co-processor over a system bus. After processing, the<br>
co-processor may then copy the processed data back to the memory for<br>
access by the main processor, which may then transmit the data out onto a<br>
transport medium (e.g. a network, telephone line, etc.). This process is<br>
inefficient as data is copied twice over the bus into system memory prior to it<br>
being transmitted over a transport medium. Similarly, at the receive end, the<br>
data also is copied twice to and from a co-processor before it is decrypted<br>
and validated.<br>
Running cryptographic operations in a conventional co-processor<br>
architecture may use up valuable shared systems resources, including the<br>
main processor, bus, and system memory, making them unavailable to other<br>
devices in a system. This may reduce overall system performance. Thus, a<br>
need arises for a technique and apparatus that reduces use of system<br>
resources in performing operations associated with a security protocol when<br>
communicating information to a transport medium.<br>
Summary of the Invention<br>
The present invention provides a method for protection of information<br>
for use in a device coupled to a communications channel, said method<br>
comprising : determining a security service to perform with a data block ;<br>
generating security information to pass along with the data block, the security<br>
information identifying the security service ; and processing, in a controller<br>
adapted to control communication with the communications channel, the data<br>
block according to the security information.<br>
During the processing there may be provided a step of performing<br>
cryptographic processing of the data block.<br>
In a preferred embodiment the method also comprises : receiving<br>
the data block from a software routine ; and routing the processed data block<br>
back to the software routine after processing.<br>
The method may further comprise : determining if the security service<br>
can be performed by the controller ; and if not, processing the data block<br>
according to the security service in a software routine instead of the<br>
controller. The method may also comprise identifying a security service<br>
according to an Internet Protocol security protocol.<br>
In addition, the present invention also provides a device for protection<br>
of information, said apparatus comprising a machine-reliable storage medium<br>
containing instructions for execution in a system having a controller adapted<br>
to control communications with a communications channel, the instructions<br>
when executed causing the system to : identify a security service to be<br>
performed on data to be transmitted over the communications channel ; and<br>
prepare security control information to pass along with the data to the<br>
controller to perform processing according to the identified security service.<br>
The storage medium may contain instructions that when executed<br>
further causes the system to perform processing according to the identified<br>
security service instead of the controller if the security service cannot be<br>
performed by the controller.<br>
Brief Description of the Accompanying Drawings<br>
In the accompanying drawings -<br>
Fig.1A is a block diagram of an embodiment of a system including a<br>
network and devices coupled to a network ;<br>
Fig.1B is a block diagram of a network controller according to one<br>
embodiment in a device in the system of Fig. 1A ;<br>
Fig.2 is a block diagram of a device in the system of Fig. 1A according<br>
to another embodiment of the invention ;<br>
Fig.3 is a more detailed block diagram of the network controller of<br>
Fig. 1B;<br>
Figs.4A-4C are diagrams of packets according to a security protocol<br>
used by the device of Fig. 2 ;<br>
Fig.5 is a flow diagram of a security process according to an<br>
embodiment performed by the network controller of Fig.3 ;<br>
Fig.6 illustrates a flow tuple stored in a storage device in the network<br>
controller of Fig.3 ;<br>
Fig.7 is a flow diagram illustrating parsing of packet data by a receive<br>
parser of the network controller of Fig.5 ;<br>
Figs.8 and 9A-9B are flow diagrams of security routines in different<br>
layers in the device of Fig.2 ; and<br>
Fig. 10 is a flow diagram of a process of determining security services<br>
associated with a data block performed by the security routine of Fig.8.<br>
Detailed Description<br>
In the following description, numerous details are set forth to provide<br>
an understanding of the present invention. However, it is to be understood by<br>
those skilled in<br>
the art that the present invention may be practiced without these details and that numerous<br>
variations or modifications from the described embodiments may be possible.<br>
Referring to Fig. 1, an embodiment of a system includes a first device 50 and a second<br>
device 51 that are coupled to a transport medium, which may be a wired or wireless transport<br>
medium (or a combination of both). In the ensuing description, the transport medium is<br>
referred to as a network 47, which may include one or more types of transport media, whether<br>
wired or wireless, such as telephone lines, cable lines, local area networks (LANs), wide area<br>
networks (WANs), the Internet, radio frequency links, cellular links, or other transport media.<br>
Each of the devices 50 and 51 may include a computer, a hand-held computing device, a set-<br>
top box, an appliance, a game system, or any other controller-based system in which the<br>
controller may be a microprocessor, a microcontroller, a programmable device such as an<br>
application-specific integrated circuit (ASIC), a programmable gate array (PGA), or the like.<br>
Different types of communications may be possible over the network 47 between the<br>
devices 50 and 51 as well as other devices. Communications may include, for example,<br>
transmission of electronic mail; Internet browsing; file access and copying; database<br>
searching; on-line sale and financial transactions; and so forth.<br>
To provide secure communications between devices or systems on the network 47, a<br>
security protocol according to some embodiments may be implemented in devices coupled to<br>
the network 47. In some embodiments, Internet Protocol security (IPSEC), as discussed in<br>
Request for Comment (RFC) 2401, entitled "Security Architecture for the Internet Protocol,"<br>
dated November 1998, implemented in devices coupled to the network 47 may provide<br>
security services to ensure confidential communications between authenticated parties, as<br>
further described below.<br>
In this description, reference is made to various Requests for Comments (RFCs),<br>
which are available at several sites on the Internet. One such site is<br>
{http://www.ietf.org/rfc.html}.<br>
As illustrated in Fig. 1 A, each of the devices 50 and 51 (as well as other devices that<br>
may be coupled to the network 47) may include various layers and components to enable<br>
communication on the network 47. For example, in the device 50, a network controller 52<br>
(which may be an integrated network controller chip or a board or card including several<br>
chips or some other hardware component) is coupled between the network 47 and a system<br>
bus 72. In one example embodiment, the system bus 72 may be a Peripheral Component<br>
Interconnect (PCI) bus, as described in the PCI Local Bus Specification, Production Version,<br>
Revision 2.1, published in June 1995. More complete diagrams and descriptions of the<br>
device 50 and the network controller 52 are provided in connection with Figs. 2 and 3,<br>
respectively, below.<br>
According to some embodiments, to improve system performance, cryptographic<br>
processing (including encryption, decryption, and/or cryptographic signature) that is part of<br>
the network security protocol is performed by the network controller 52, which may be<br>
implemented as a hardware component with associated firmware or microcode, "on-the-fly"<br>
or "in transit." Other types of controllers for controlling communications with a<br>
communications channel or transport medium may also be used in further embodiments.<br>
Such controllers may include purely hardware implementations or a combination of hardware<br>
and firmware or software.<br>
Referring further to Fig. IB, the network controller 52 includes cryptographic engines<br>
(126 in the transmit side and 102 in the receive side) to perform encryption, decryption, and<br>
authentication operations on data blocks to be transmitted or that have been received. An<br>
advantage of separate cryptographic engines 102 and 126 in the receive and transmit paths,<br>
respectively, is that cryptographic processing of transmission data and received data may be<br>
performed concurrently. In an alternative embodiment, a single engine may be used for both<br>
transmission and received data.<br>
As used in this description, a data block or data blocks may refer to data of various<br>
formats in the device. For example, a data block from the transport and network layers 406<br>
may include an IP datagram or packet (if the network layer is an IP layer). If an IPSEC<br>
protocol (e.g., AH or ESP) is used, then the data block is transformed to an IPSEC packet<br>
after IPSEC processing. An IP datagram or packet and an IPSEC packet may be reformatted<br>
after flowing through each of the different layers in the device 50. The security protocol may<br>
be applied to one or more IP datagrams or packets and IPSEC packets. If other security<br>
protocols are implemented, other types of data blocks may be defined. IPSEC may use one<br>
of two protocols to provide traffic security—Authentication Header (AH) and Encapsulating<br>
Security Payload (ESP). These protocols may be applied alone or in combination with each<br>
other to provide a desired set of security services. The AH protocol is described in RFC<br>
2402, entitled "IP Authentication Header," dated November 1998, and the ESP protocol is<br>
described in RFC 2406, entitled "IP Encapsulating Security Payload (ESP)," dated November<br>
1998.<br>
To reduce complexity of the network controller 52, generation of security control<br>
information associated with security protocols may be performed by one or more software<br>
routines (e.g., 410 and 411) in the device 50. In one embodiment, security control<br>
information may include information identifying the encryption and authentication<br>
algorithms, location of keys, location and length of data to be encrypted or signed, location of<br>
signatures, and other information used by the network controller 52 for cryptographic<br>
processing (including encryption, decryption, and/or authentication).<br>
There may be instances (described below) in which multiple cryptographic operations<br>
are performed on a data block by the network controller 52. To handle such cases, a<br>
loopback feature in the network controller 52 routes data blocks processed by the<br>
cryptographic engine 126 back to the device 50 for further processing by the one or more<br>
software routines 410 and 411. After further processing by routines 410 and 411, the data<br>
blocks may be sent back to the network controller 52 for further cryptographic processing.<br>
Another feature of some embodiments is that the cryptographic engine 126 or 102 (or<br>
both) in the network controller 52 may be used by application processes aside from processes<br>
that need to perform secure communications over the network 47. Such application processes<br>
are referred to as secondary use processes. For example, a secondary use process may<br>
perform communications to an external device through another interface (other than the<br>
network controller 52) in the device 50. A secondary use process may include any process<br>
that does not perform, or that is not capable of performing, cryptographic processing in<br>
transit. Examples of secondary use processes include encrypted file systems, secure e-mail,<br>
secure remote procedure call (RPC), and so forth. Instead of using a separate coprocessor or<br>
a main processor 54 to perform cryptographic operations for such secondary use processes, a<br>
cryptographic engine of the network controller 52 may be used.<br>
The device 50 may include a policy management routine 413 that keeps track of the<br>
security services available in the device 50. The policy management routine 413 maintains<br>
databases (e.g., 520A described below) that identify security services to perform with<br>
different data flows between different devices on the network 47. For example, security<br>
services for devices that are coupled by a local area network may be different from security<br>
services for devices that are coupled through an unsecure channel such as the Internet. The<br>
device 50 also includes a key exchange component 415 that manage the generation and<br>
transport of keys used for encryption and authentication. The components 413 and 415 may<br>
be defined according to an Internet Security Association and Key Management Protocol<br>
(ISAKMP), as described in Request for Comment (RFC) 2408, dated November 1998.<br>
Still referring to Fig. 1 A, in the device 50, the system bus 72 is coupled to other<br>
devices in the system, including the main processor 54 that may be coupled to the system bus<br>
72 through one or more bridge layers 59. As examples, the processor 54 may include a<br>
microprocessor, a microcontroller, an ASIC, a PGA, and the like. Data packets, frames, or<br>
blocks transmitted between the network 47 and various application processes (such as 402<br>
and 404) are passed through several layers in the device 50. As examples, the application<br>
processes 402 and 404 may include electronic mail applications, network browsers, file<br>
managers, or any other applications that are able to access locations on the network 47.<br>
In the transmit and receive paths, data is routed between the application processes<br>
402, 404 and the network 47 through the network controller 52, a network device driver 408,<br>
transport and network layers 406, and an operating system (OS) 400. The network and<br>
transport layers 406 may be a Transmission Control Protocol/Internet Protocol (TCP/IP)<br>
stack to perform data routing and flow control as well as verification and sequencing of data<br>
in the device 50. Thus, in one embodiment, the network layer may be an Internet Protocol<br>
(IP) layer, as described in Request for Comment (RFC) 791, entitled "Internet Protocol,"<br>
dated September 1981, which defines a protocol for transmission of blocks of data called<br>
datagrams from sources to destinations identified by source and destination IP addresses.<br>
Above the network layer is the transport layer, which may be the Transmission Control<br>
Protocol (TCP) or User Datagram Protocol (UDP) layer, as examples. TCP is described in<br>
Request for Comment (RFC) 793, entitled 'Transmission Control Protocol," dated September<br>
1981. UDP is described in RFC 768, entitled "User Datagram Protocol," dated August 1980.<br>
According to some embodiments, to implement a security protocol for the network 47<br>
in the network controller 52, a security routine 410 in the network device driver 408 and a<br>
security routine 411 in the transport and network layers 406 format data blocks according to<br>
the security protocol and add security control information to send to the network controller 52<br>
along with associated data blocks. In this description, the routine 410 is referred to as the<br>
driver security routine 410, and the routine 411 is referred to as the IP security routine 411.<br>
In further embodiments, the tasks performed by the security routines 410 and 411 may be<br>
performed by one routine or by more than two routines.<br>
Depending on the type of OS 400 used, the IP security routine 411 may be part of the<br>
network and transport layers 406 (as illustrated in Fig. 1) or it may be a separate routine. For<br>
example, with the Windows® NT, Version 5, operating system, the IP security routine 411<br>
may be part of layers 406. With the Windows® NT, Version 4, or the Windows® 98<br>
operating system, however, the IP security routine 411 may be a separate driver routine.<br>
Based on the security control information, if any, generated by the security routines<br>
410 and 411, the network controller 52 performs cryptographic processing (including<br>
encryption and/or authentication) of data blocks before transmission to the network 47. If the<br>
security control information indicates that cryptographic processing is unnecessary, the<br>
network controller 52 sends the data blocks to the network 47 without passing the data blocks<br>
through the cryptographic engine 126 in the network controller 52.<br>
On the receive side, when the network controller 52 receives a data block, the network<br>
controller 52 determines from a security control portion of the received data block if<br>
cryptographic process is needed, and if so, which key or keys to use to perform decryption<br>
and authentication.<br>
According to some embodiments, the security protocol implemented in the device 50<br>
and some other devices coupled to the network 47 includes an IPSEC protocol. IPSEC<br>
provides security services by enabling the device 50 to select required security protocols,<br>
determine the algorithm(s) to use for the service(s), and put in place any cryptographic keys<br>
employed to provide the requested services. Although this description refers to IPSEC<br>
security protocols such as the AH and ESP protocols, the invention is not to be limited in this<br>
respect. Other types of security protocols may be implemented in further embodiments.<br>
Further, in other embodiments, other types of transport and network layers besides TCP and<br>
IP layers may be used.<br>
In one embodiment, the IP security routine 411 performs IPSEC processing of an IP<br>
packet that is to be transmitted to or that has been received from the network 47. IPSEC<br>
processing includes converting an IP packet to an IPSEC packet and vice versa. The IPSEC<br>
packet may either be an ESP packet or an AH packet according to some embodiments.<br>
Security control information is included in the IPSEC packet. Referring to Figs. 4A-4C, after<br>
IPSEC processing, an IP datagram including an IP header 500 and an IP payload field 502<br>
(Fig. 4A) may be transformed to an ESP packet as illustrated in Figs. 4B and 4C. The ESP<br>
packets shown in Figs. 4B and 4C (representing ESP packets in transport mode and tunnel<br>
mode, respectively) include the following fields: an ESP header 504, an ESP trailer 506, and<br>
an ESP authorization field 508. In transport mode (Fig. 4B), the ESP security protocol is<br>
applied to the IP payload 502. In tunnel mode, however, the ESP security protocol is also<br>
applied to the IP header 500—consequently, a new IP header 510 is created for the ESP<br>
packet in tunnel mode (Fig. 4C) that identifies the address of a security gateway, for example.<br>
Tunnel mode ESP is typically used when communication over the network 47 occurs through<br>
two security gateways. In an AH packet (not shown), an AH header may be added before the<br>
IP payload (transport mode) or before the IP header and EP payload (in tunnel mode), but no<br>
trailer information is added.<br>
The ESP header and trailer fields 504 and 506 may include the following: a security<br>
parameters index (SPI), which in combination with certain other information identifies<br>
security services to be performed on a datagram; a sequence number that monotonically<br>
counts up and is included with the datagram as a defense against a replay attack; information<br>
such as cryptographic synchronization information; any padding employed for encryption<br>
such as used for a block cipher; and other information. The authentication field 508 is used<br>
with the authentication service.<br>
The ESP header 504 may also include IPSEC control information that identifies the<br>
cryptographic algorithms to be applied by the network controller 52, locations of keys,<br>
locations and lengths of data to be encrypted and/or signed, and other information employed<br>
for encryption and/or authentication. In addition, the ESP header 504 may also contain an<br>
indication of whether a datagram is to be transmitted over the network 47 after cryptographic<br>
processing or routed back to the system bus 72 in the loopback mode. The ESP header<br>
includes a protocol type field, which may point to TCP, UDP, and so forth, in which case the<br>
datagram is transmitted on to the network 47. Alternatively, if the protocol type field points<br>
to ESP or AH, loopback is performed.<br>
An AH header contains similar information to provide for authentication services.<br>
However, AH does not provide for encryption. In some embodiments, the AH and ESP<br>
protocols may be implemented in combination to provide security services.<br>
Encryption, decryption, and authentication algorithms are determined based on the<br>
security association (SA) of an IP datagram. An SA indicates the types of security services<br>
that are associated with the IP datagram. Further description of SAs is provided in RFC 2401<br>
referenced above. The security associations of different IP datagrams are stored in one or<br>
more security association databases (SADs) 520A and 520B, which may be stored in a<br>
storage medium such as the main memory 56 or a hard disk drive, as examples. Security<br>
associations may be managed by the policy management routine 413.<br>
In the illustrated embodiment, the SAD 520A is accessible by the IP security routine<br>
411, and the SAD 520B is accessible by the driver security routine 410. The SAD 520B may<br>
contain a subset of the SAD 520 A for quicker access by the driver security routine 410. In<br>
alternative embodiments, both security routines 410 and 411 may access the same SAD. In<br>
addition, for processing of a packet received by the network controller 52 over the network<br>
47, the network controller 52 includes an SAD 520C, which may be a subset of the<br>
information stored in SAD 520A or 520B.<br>
For inbound processing of a packet (which may either be an IPSEC packet or<br>
unencrypted IP datagram) received from the network 47, the SA of the packet is determined<br>
by the network controller 52 from the following information in the received packet: the<br>
destination IP address; the IPSEC protocol (AH or ESP); and the SPI value. The listed<br>
information from a received IPSEC datagram may be compared to information stored in<br>
entries 140 (referred to as flow tuples) in a storage device or memory 100 (which may be a<br>
static random access memory or SRAM, for example) in the network controller 52 to<br>
determine if a match occurs. The combination of such information may be used to index into<br>
the SAD 520C stored in the storage device 100. The SAD 520C stored in the network<br>
controller 52 may be updated based on a least recently used (LRU) replacement policy, first-<br>
in-first-out (FIFO) policy, or other policy.<br>
Thus, based on the SA (if any) of a received packet, suitable keys and other<br>
cryptographic information may be retrieved from a storage location (such as in a storage<br>
device 104 or other location) to perform decryption and authentication processing. Although<br>
the SAD 520C is stored inside the network controller in the illustrated embodiment, it is<br>
contemplated that the security association information and flow tuples may be stored in an<br>
external storage device coupled to the network controller.<br>
For outbound processing of an IP datagram to be transmitted over the network 47, the<br>
IP security routine 411 determines the SA associated with the outbound IP datagram based on<br>
certain fields of the IP datagram. Such fields may indicate source and destination devices and<br>
addresses, from which the types of security services may be determined for communications<br>
between the source and destination devices. For example, the devices may be coupled to a<br>
local area network, in which case a first set of security services may be performed. If the<br>
devices are coupled to security gateways (such as devices that couple a LAN to an unsecure<br>
link such as the Internet), then a second set of security services (that provide enhanced<br>
security) may be performed. The IP datagram is converted to an IPSEC packet that includes<br>
security control information based on the associated SA. The IPSEC packet is sent by the IP<br>
security routine 411 down to the driver security routine 410 in the network device driver 408,<br>
which repackages the IPSEC packet to forward to the network controller 52.<br>
Referring to Fig. 8, security operations performed by the IP security routine 411 are<br>
illustrated. If an IP packet to be transmitted is detected (at 650), the IP security routine 411<br>
determines (at 652) if the IP packet is subject to a security protocol based on its SA. This<br>
may be determined based on information in the SAD 520 A, and if not there, from a Security<br>
Policy Database (SPD) 522, which may be stored in a storage device such as the system<br>
memory 56.<br>
The SPD 522 indicates if a datagram is afforded IPSEC protection or if IPSEC<br>
protection is bypassed. If IPSEC protection is to be implemented for a datagram, then a<br>
selected entry in the SPD 522 maps to an SA that identifies security services to be performed<br>
on the datagram, including whether the AH or ESP protocol is to be employed, the<br>
cryptographic algorithms to be used for encryption/decryption and authentication, and so<br>
forth. The identified security services are coded into the security control information (located<br>
in an ESP or AH header, for example) by the IP security routine 411 for transmission to the<br>
network controller 52 to perform cryptographic processing.<br>
Information (referred to as selectors) in an IP datagram may be used to index into an<br>
entry in the SPD 522. Such selectors may include the following information: destination IP<br>
address; source IP address; transport layer protocol (e.g., TCP or UDP); and source and<br>
destination ports (e.g., a TCP or UDP port); and other information. The selectors associated<br>
with a datagram are then used to perform a lookup of the SPD 522 to retrieve information in<br>
an entry of the SPD 522. In turn, the SPD entry information is used to determine an SA of<br>
the IP datagram, which can then be loaded into a corresponding entry of the SAD 520A.<br>
Although reference is made to the SPD and SAD to identify security services to be<br>
performed on a data block, the invention is not to be limited in this respect. Other techniques<br>
for determining security services may be employed in further embodiments.<br>
If the IP security routine 411 determines (at 652) that IPSEC protection is not to be<br>
employed, then the IP datagram is forwarded (at 655) to the network device driver 408 for<br>
transmission as a regular IP datagram over the network 47 by the network controller 52. If,<br>
however, IPSEC protection is employed, the IP datagram is reformatted (at 654) as an IPSEC<br>
packet, as illustrated in Figs. 4A-4C in one example.<br>
Next, the IP security routine 411 determines (at 656) if cryptographic operations are<br>
to be offloaded to the network device driver 408 and network controller 52. Offloading<br>
according to some embodiments refers to the IP security routine 411 forwarding<br>
cryptographic operations to a lower layer (e.g., the network controller 52) rather than the IP<br>
security routine 411 performing cryptographic operations itself, which may take up valuable<br>
time of the main processor 54. Offloading security services may not be performed if, for<br>
example, a cryptographic operation is not supported by the network controller 52, if the cost<br>
of performing the cryptographic operation on the processor 54 is insubstantial, or if the cost<br>
of offloading would be higher compared to performing the cryptographic operation on the<br>
CPU 54.<br>
If offloading is desired, then offload commands (including the security control<br>
information) are prepared (at 658) by the IP security routine 411 in the header portion of the<br>
IPSEC packet to indicate the types of algorithms to use for encryption and/or authentication,<br>
locations of keys, locations and lengths of data to be encrypted and/or signed, and other<br>
related information. If offloading is not desired, then the IP security routine 411 performs the<br>
desired cryptographic operations (at 660) and a no-op command (to indicate no cryptographic<br>
operations are necessary) may be included in the IPSEC packet that is sent to the driver<br>
security routine 410 in the network device driver 408.<br>
Referring to Fig. 9 A, the transmit portion of the network device driver security<br>
routine 410 is illustrated. If transmission data is received (at 700) from the IP security<br>
routine 411, the driver security routine 410 determines (at 702) if the IPSEC packet is a<br>
secondary use packet (that is, a packet that originated from a secondary use process, e.g.,<br>
405). If so, then the IPSEC packet is marked (at 710) for loopback mode so that the packet<br>
can be returned to the secondary use process (e.g., process 405 in Fig. 1A) after<br>
cryptographic processing by the network controller 52. The packet is processed (at 706,<br>
described below) and sent to the network controller 52.<br>
If the IPSEC packet is not a secondary use packet, then the driver security routine 410<br>
determines (at 704) if the packet includes offload commands. If so, the driver security<br>
routine 410 determines (at 708) if the packet includes multiple commands (such as to perform<br>
multiple security protocols on the packet). If so, the IPSEC packet is marked (at 710) for<br>
loopback mode.<br>
Next, commands in the IPSEC packet are converted (at 706) to a format (including<br>
device specific operations) that can be understood by the network controller 52 for processing<br>
by the network controller 52. The IPSEC packet sent by the driver security routine 410 to the<br>
network controller 52 includes security control information that identifies the encryption<br>
and/or authentication algorithms to use, location of keys, location and lengths of data to be<br>
encrypted and/or signed, and other related information. Based on the security control<br>
information, cryptographic processing is performed by the network controller 52 before<br>
packets are transmitted to the network 47.<br>
Referring further to Fig. 9B, the receive portion of the driver security routine 410 is<br>
illustrated. The driver security routine 410 receives (at 700) from the network controller 52<br>
(which may be a packet received over the network 47 or a secondary use packet that is to be<br>
returned to a secondary use application process). Next, the driver security routine 410<br>
determines (at 672) if the packet is a secondary use packet. If so, the packet is sent back (at<br>
674) to the secondary use process (e.g., 405) through its driver, for example.<br>
If the received packet is not a secondary use packet, then the driver security routine<br>
410 determines (at 676) if the received packet is an IPSEC packet. If not, then the packet is<br>
sent up by the network device driver 408 (at 690) to the transport and network layers 406 for<br>
handling. If the packet is an IPSEC packet, the driver security routine 410 determines (at<br>
678) if the packet was "punted" by the network controller 52. The network controller 52 may<br>
have been unable to associate an S A with the received IPSEC packet based on a comparison<br>
with the limited SAD 520C. If the packet was punted by the network controller 52 due to<br>
inability to associate an SA in the SAD 520C stored in the network controller 52, the driver<br>
security routine 410 attempts (at 686) to match the received IPSEC packet with an entry in<br>
the SAD 520B. If a match cannot be found, then the packet is sent up (at 690) to the IP<br>
security routine 411 for handling. However, if an entry in the SAD 520B can be matched<br>
with the punted IPSEC packet, then the EPSEC packet is modified to include the security<br>
control information of the associated SA and the packet is sent back (at 684) to the network<br>
controller 52 with loopback mode set. This allows further cryptographic processing by the<br>
network controller 52. However, if the EPSEC packet was punted because the network<br>
controller 52 is unable to perform cryptographic processing, then the packet is forwarded up<br>
to the transport and network layers 406 for processing.<br>
If the driver security routine 410 determines (at 678) that the packet was not punted<br>
by the network controller 52, then the driver security routine 410 determines if additional<br>
IPSEC iterations are needed (at 680), such as for EPSEC packets with nested SAs. If not, the<br>
status information in the EPSEC packet (indicating processing performed by the network<br>
controller 52 including decryption and/or authentication, for example) is converted (at 688) to<br>
a syntax understood by the IP security routine 411. The packet is then sent (at 684) to the IP<br>
security routine 411.<br>
If, at 680, an additional EPSEC iteration is needed, the driver security routine 410<br>
attempts to match (at 682) an entry in the SAD 520B with the packet to identify its SA. If a<br>
match is found, then the packet is sent back (at 684) to the network controller 52 with<br>
loopback mode set. If the SA of the packet cannot be found in the SAD 520B, then the<br>
packet is sent up (at 690) to the IP security routine 411 for handling.<br>
Referring again to Fig. 8, when the EP security routine 411 receives a packet from the<br>
driver security routine 410, the IP security routine 411 determines (at 662) if the packet is an<br>
IP SEC packet. If not, the packet is sent (at 670) to the IP layer (406). If the packet is an<br>
EPSEC packet, then the EP security routine 411 determines (at 664) if the packet was punted<br>
by the network controller 52 and the network device driver 410. If so, the EP security routine<br>
performs (at 666) full EPSEC processing, including cryptographic processing of the packet.<br>
Alternatively, the EP security routine 411 can determine the SA of the packet by accessing the<br>
SAD 520A or SPD 522, and the security control information associated with the SA may be<br>
sent along with the packet down to the network controller 52 for cryptographic processing.<br>
If the IPSEC packet was not punted, then the IP security routine 411 performs (at 668)<br>
normal IP SEC processing to convert the packet back to an EP datagram to send (at 670) to the<br>
IP layer.<br>
Referring to Fig. 10, the act (at 652 in Fig. 8) performed by the EP security routine 411<br>
to determine if an EP packet can be associated with an SA includes determining (at 750) if an<br>
entry in the SAD 520A associated with the IP packet can be found. This can be based, for<br>
example, on certain selectors as described above. If a match in the SAD 520A is found, the<br>
SA has been identified and a success flag is returned. However, if a match is not found in the<br>
SAD 520A, then the SPD 522 is accessed (at 752) based on the selectors. If a match cannot<br>
be identified, then a fail flag is returned to indicate an SA does not exist for the IP datagram.<br>
However, if a match is identified in the SPD 522 (at 752), then the SA is identified (at 754)<br>
and loaded (at 756) into the SAD 520A. The IP security routine 411 then determines (at 758)<br>
if the security services associated with the identified SA can be offloaded to the network<br>
controller 52. During a setup phase, the IP security routine 411 queries the driver security<br>
routine 410 to determine security services that may be offloaded from the IP security routine<br>
411 to the driver security routine 410. This information may be kept in a storage location and<br>
may identify the types of encryption and authentication services that may be performed, the<br>
types of security protocols (e.g., AH and ESP) that are supported, and so forth, by the driver<br>
security routine 410. If the security services can be offloaded, the SA is also copied (at 760)<br>
to the SAD 520B and optionally to the SAD 520C in the network controller 52. If the<br>
security services cannot be offloaded, then the identified SA is not copied to the SAD 520B<br>
and 520C.<br>
When updating the SAD 520C in the network controller 52, the DP security routine<br>
411 determines if the SAD 520C is full, and if so, an SA is replaced using some replacement<br>
policy, e.g., least recently used, first-in-first-out, random, and so forth. Such update policies<br>
may also be performed with the SADs 520A and 520B.<br>
Referring to Fig. 2, an embodiment of the device 50 (which may be a computer<br>
system, for example) includes the network controller 52 (a local area network (LAN)<br>
controller, for example) that communicates packets of information with other networked<br>
devices (e.g., hosts, gateways, routers, etc.) over the network 47. The network controller 52<br>
may be adapted to perform operations that are typically performed by the main processor 54<br>
that executes one or more software layers (a network layer and a transport layer, as examples)<br>
of a network protocol stack (a TCP/IP stack, for example). As an example, these operations<br>
may include parsing headers of incoming packets to obtain characteristics (of the packet) that<br>
typically are extracted by execution of the software layers.<br>
In some embodiments, the characteristics, in turn, may identify an application process<br>
that is to receive data of the packet. Due to this identification by the network controller 52,<br>
the network controller 52 (and not a software layer of the stack) may directly control the<br>
transfer of the packet data to a buffer (in a system memory 56) that is associated with the<br>
application. As a result of this arrangement, data transfers between the network controller 52<br>
and the system memory 56 may take less time and more efficiently use memory space, as<br>
further described below.<br>
Referring to Fig. 3, the network controller 52 may include circuitry, such as a receive<br>
path 92 and a transmit path 94 to process packets that are received from, or are transmitted to,<br>
the network 47. For example, the receive path 92 may include a receive parser 98 to parse a<br>
header of each packet to extract characteristics of the packet, such as characteristics that<br>
associate a particular flow with the packet. Because the receive path 92 may be receiving<br>
incoming packets from many different flows (packets from different devices on the network<br>
47), the receive path 92 may include the memory 100 that stores flow tuples 140. Each flow<br>
tuple 140 uniquely identifies a flow that is to be parsed by the network controller 52.<br>
Referring to Fig. 6, each flow tuple 140 includes fields that identify characteristics of<br>
a particular flow. As an example, in some embodiments, at least one of the flow tuples 140<br>
may be associated with a Transmission Control Protocol (TCP), a User Datagram Protocol<br>
(UDP) and so forth, as examples. The flow tuple 140 may include a field 142 that indicates<br>
an Internet Protocol (IP) destination address (i.e., the address of the device to receive the<br>
packet); a field 144 that indicates an IP source address (i.e., the address of a device to<br>
transmit the packet); a field 146 that indicates a TCP destination port (i.e., the address of the<br>
application that caused generation of the packet); a field 148 that indicates a TCP source port<br>
(i.e., the address of the application that is to receive the packet); a field 150 that indicates<br>
security/authentication attributes of the packet; and an SPI field 152. Other fields may be<br>
included in a flow tuple 140. Other flow tuples 140 may be associated with other network<br>
protocols, such as UDP, for example.<br>
Referring again to Fig. 3, the transmit path 94 of the network controller 52 may<br>
include a transmit parser 114 that is coupled to the system bus interface 130 to receive<br>
outgoing packet data from the device 50 and form the header on the packets. To accomplish<br>
this, in some embodiments, the transmit parser 114 stores the headers of predetermined flows<br>
in a header memory 116. Because the headers of a particular flow may indicate a significant<br>
amount of the same information (port and IP addresses, for example), the transmit parser 114<br>
may slightly modify the stored header for each outgoing packet and assemble the modified<br>
header onto the outgoing packet. As an example, for a particular flow, the transmit parser<br>
114 may retrieve the header from the header memory 116 and parse the header to add such<br>
information as sequence and acknowledgment numbers (as examples) to the header of the<br>
outgoing packet. A checksum engine 120 may compute checksums for the IP and network<br>
headers of the outgoing packet and incorporate the checksums into the packet.<br>
The transmit path 94 may also include the cryptographic engine 126 that may encrypt<br>
and/or authenticate the data of the outgoing packets. In this manner, all packets of a<br>
particular flow may be encrypted and/or authenticated with a key that is associated with the<br>
flow, and the keys for the different flows may be stored in a key memory 124. As noted<br>
above, the cryptographic keys are based on the cryptographic algorithms used.<br>
In some embodiments, new keys may be added to the key memory 124 and existing<br>
keys may be modified or deleted by information passed through the transmit path 94 in fields<br>
of a control packet. The transmit path 94 may also include one or more FIFO memories 122<br>
to synchronize the flow of the packets through the transmit path 94. A parallel-to-serial<br>
conversion circuit 128 may be coupled to the FIFO memory(ies) 122 to retrieve packets that<br>
are ready for transmission for purposes of serializing the data of the outgoing packets. Once<br>
serialized, the circuit 128 may pass the data to the network interface 90 for transmission to<br>
the network 47.<br>
Referring to Fig. 5, the security operations of the network controller 52 are illustrated.<br>
Once a datagram to be transmitted is received (at 602), the transmit parser 114 accesses the<br>
security control information and commands of the IPSEC packet to determine if<br>
cryptographic processing is to be employed. If the security information and commands<br>
indicate that no security protocol is implemented (at 604), then the transmit parser 114 passes<br>
the datagram to a queue 122, which is forwarded (at 614) to the network interface 90 for<br>
transmission to the network 47. In this case, the cryptographic engine 126 is bypassed.<br>
If security services are requested based on the security control information and<br>
commands (at 604), then the associated key or keys are retrieved from the key memory 124<br>
and passed along to the cryptographic engine 126 (at 606) to perform encryption and<br>
authentication operations. If the key or keys are unavailable in the key memory 124, then the<br>
network controller 52 may access another storage location outside the network controller 52<br>
to retrieve the key or keys, as further described below. According to some embodiments,<br>
various types of encryption algorithms may be indicated by the security control information<br>
of the IPSEC packet, such as symmetric encryption algorithms including block ciphers or<br>
stream ciphers, public key algorithms, and others. Authentication algorithms may include the<br>
following examples: keyed message authentication codes (MACs) based on a symmetric<br>
encryption algorithm such as the data encryption standard (DES); one-way hash functions<br>
such as a message digest function (MD5) or a secure hash algorithm (SHA); or others.<br>
Descriptions of MACs, DES, MD5, and SHA may be found in Bruce Schneier, "Applied<br>
Cryptography," John Wiley &amp; Sons, Inc. (2d Ed. 1996).<br>
The cryptographic engine 126 then processes the data (at 608) for encryption and<br>
authentication based on the type or types of algorithms to be employed and keys retrieved<br>
from the key memory 124 (Fig. 3). The cryptographic engine 126 next determines (at 610)<br>
whether loopback mode is invoked, in which cryptographically processed data is routed back<br>
(at 612) to the receive path 92 over link 127 (Fig. 3). The data is sent back to the other layers<br>
(e.g., the security routines 410 and 411) of the device 50 for further processing. This may be<br>
determined based on information contained in the ESP or AH header of the IPSEC packet.<br>
Loopback mode may be used for a number of reasons, including datagrams that use nested<br>
SAs that employ multiple passes through the cryptographic engine 126 to complete the<br>
cryptographic process. Multiple nested SAs may be used if more than one security protocol<br>
is to be applied to a datagram such as combining the AH and ESP protocols or by use of IP<br>
tunneling.<br>
The loopback feature may also be used by application processes (secondary use<br>
processes, such as process 405) in the device 50 on data that are not transmitted over the<br>
network 47. For example, data from the application process 405 may be transmitted or<br>
received through some other interface in the device 50, such as a modem or other transceiver<br>
75 coupled to an expansion bus 70 or another bus. Such data may also need to be<br>
cryptographically processed. Instead of performing the cryptographic operations using the<br>
main processor 54 or another coprocessor, the operations may be performed by the<br>
cryptographic engine 126 in the network controller 52.<br>
The loopback feature may also be used when a received datagram is not recognizable<br>
based on the stored flow tuples 140 in the SPD 522. Such a datagram is passed on up through<br>
the receive path 92 to a higher layer, such as the security routines 410 and 411. The security<br>
routines 410 and 411 can then determine how to further process the received datagram. For<br>
example, in the embodiment in which only a portion of the SAD 520 is available in the<br>
network controller 52, the security routines 410 and 411 can access the full SAD in the<br>
device to determine the SA of the received data. If the security routines 410 and 411 are<br>
successful in determining the SA, then the SAD portion 520 in the network controller 52 can<br>
be updated and the data and related security information may be sent back to the network<br>
controller 52 for cryptographic processing.<br>
The security routines 410 and 411 may also have other capabilities, such as<br>
preventing a replay attack. To implement such other capabilities, the security routines 410<br>
and 411 may utilize the loopback feature to perform cryptographic processing as many times<br>
as needed.<br>
If loopback is not employed, as determined at 610, then the data processed by the<br>
cryptographic engine 126 is forwarded (at 614) for transmission by the network interface 90.<br>
Referring again to Fig. 3, the receive parser 98 in the receive path 92 may use the<br>
stored flow tuples 140 to determine if a received packet needs to be cryptographically<br>
processed according to a specified security protocol. In the receive path of a network<br>
controller 52 according to some embodiments, a receive parser 98 may compare information<br>
in a received datagram with a subset of a flow tuple 140 (Fig. 6) stored in the memory 100 to<br>
identify the SA of the datagram. For example, in some embodiments, the receive parser 98<br>
may use the fields 142,150 and 152 (the destination IP address; the IPSEC protocol (AH or<br>
ESP); and the SPI value) to identify a flow tuple hit so that the SA of the incoming datagram<br>
can be determined. If a flow tuple hit occurs, the flow tuple information is used to map into<br>
the SAD 520C to determine the SA of the data.<br>
Additional flow tuples 140 may be stored in the memory 100 and existing flow tuples<br>
140 may be removed from the memory 100 by the network device driver 408. In some<br>
embodiments, the memory 100 may also store information fields 141. Each field 141 maybe<br>
associated with a particular flow tuple 140 and may indicate, for example, a handler that<br>
identifies (for the network protocol stack) the flow and a pointer to a buffer of a system<br>
memory 56, as further described below.<br>
If the receive parser 98 recognizes (by the flow tuples 140) the flow that is associated<br>
with the incoming packet, then the receive path 92 may further process the packet. In some<br>
embodiments, the receive parser 98 may indicate (to other circuitry of the network controller<br>
52 and eventually to a network protocol stack) recognition of the flow associated with a<br>
particular packet and other detected attributes of the packet.<br>
If the receive parser 98 does not recognize the flow, then the receive path 92 marks<br>
the packet as punted and passes the incoming packet over a system bus interface 130 to the<br>
security routines 410 and 411 for processing, as described above.<br>
In some embodiments, once the SA of the incoming packet is determined, the<br>
associated key or keys may be retrieved from the key memory 104 so that the cryptographic<br>
engine 102 can perform its cryptographic operations. The keys in the key memory 104 are<br>
indexed by the SA of the receiveddata.<br>
Keys may be added to or removed from the key memory 104 by the network device<br>
driver 408. In this manner, if the engine 102 determines that the particular decryption key is<br>
not stored in the key memory 104, then the engine 102 may submit a request (over the system<br>
bus interface 130) to the device driver 408 (see Fig. 2) for the key. In this manner, the device<br>
driver 408 may cause the processor 54 to furnish the key in response to the request and<br>
interact with the system bus interface 130 to store the key in the key memory 104. In some<br>
embodiments, if the key is unavailable (i.e., the key is not available from the device driver<br>
408 or is not stored in the key memory 104), then the engine 102 does not decrypt the data<br>
portion of the packet. Instead, the system bus interface 130 stores the encrypted data in a<br>
predetermined location of the system memory 56 (see Fig. 2) so that software of one or more<br>
layers of the protocol stack may be executed to decrypt the data portion of the incoming<br>
packet, as discussed above.<br>
After parsing has been performed, the processing of the packet by the network<br>
controller 52 may include bypassing the execution of one or more software layers that are<br>
associated with the network protocol stack. For example, the receive path 92 may include a<br>
zero copy parser 110 that, via the system bus interface 130, may copy data associated with<br>
the packet into a memory buffer that is associated with an application process. In addition,<br>
the zero copy parser 110 may handle control issues between the network controller 52 and the<br>
protocol stack and may handle cases where an incoming packet is missing, as described<br>
below.<br>
The receive path 92 may also include one or more first-in-first-out (FIFO) memories<br>
106 to synchronize the flow of incoming packets through the receive path 92. A checksum<br>
engine 108 (of the receive path 92) may be coupled between the FIFO memory(ies) 106 and<br>
the system bus interface 130 for purposes of verifying checksums that are embedded in the<br>
packets.<br>
The receive path 92 may be interfaced to the system bus 72 over the system bus<br>
interface 130. The system bus interface 130 may include an emulated direct memory access<br>
(DMA) engine 131 that is used for purposes of transferring the data portions of the packets<br>
directly into the main memory 56.<br>
In some embodiments, the receive path 92 may include additional circuitry, such as a<br>
serial-to-parallel conversion circuit 96 that may receive a serial stream of bits from a network<br>
interface 90 when a packet is received from the network 47. In this manner, the conversion<br>
circuit 96 packages the bits into bytes and provides these bytes to the receive parser 98. The<br>
network interface 90 may be coupled to generate and receive signals to and from the network<br>
47.<br>
Referring to Fig. 7, a flow of operations in response to receipt of a packet over the<br>
network 47 in the network controller 52 is illustrated. The receive parser 98 may parse (at<br>
200) the header of each incoming packet. From the parsed information, the receive parser 98<br>
may determine if the packet (e.g., an IPSEC packet) is associated with some security protocol<br>
(at 201).<br>
If authentication or decryption is needed, then the receive parser 98 may use the<br>
parsed information from the header to determine (at 216) if a flow tuple hit has occurred to<br>
enable determination of the associated SA. If not, the receiver parser 98 transfers control to<br>
the zero copy parser 110 that performs end of packet checks (at 202). Otherwise, the receive<br>
parser 98 determines (at 220) if the key pointed to by the SA is available in the key memory<br>
104. If the key is available, then the receive parser 98 may start authentication and/or<br>
decryption of the packet (at 218) before passing control to the zero copy parser 110 that may<br>
perform a zero copy of the packet (at 202). If the key is not available, the receive parser 98<br>
may transfer control to the zero copy parser 110 to perform a zero copy operation (at 202).<br>
After performing the zero copy operation (at 202), the zero copy parser 110 may<br>
perform end of packet checks (at 204). In these checks, the receive parser 98 may perform<br>
checks that typically are associated with the data link layer. For example, the receive parser<br>
98 may ensure that the packet indicates the correct Ethernet MAC address, no cyclic<br>
redundancy check (CRC) errors have occurred, no receive status errors (collision, overrun,<br>
minimum/maximum frame length errors, as examples) have occurred and the length of the<br>
frame is greater than a minimum number (64, for example) of bytes. The receive parser 98<br>
may perform checks that typically are associated with the network layer. For example, the<br>
receive parser 98 may check on the size of the IP packet header, compute a checksum of the<br>
IP header, determine if the computed checksum of the IP header is consistent with a<br>
checksum indicated by the IP header, ensure that the packet indicates the correct IP<br>
destination address and determine if the IP indicates a recognized network protocol (the TCP<br>
or UDP protocols, as examples).<br>
The receive parser 98 may also perform checks that are typically associated with<br>
functions that are performed by the processor's execution of software that is associated with<br>
the transport layer. For example, the receive parser 98 may determine if the size of the<br>
protocol header is within predefined limits, may compute a checksum of the protocol header,<br>
and may determine if flags called ACK, URG, PSH, RST, FIN and/or SYN flags are set. If<br>
the PSH flag is set, then the receiver parser 98 may indicate this event to the driver program.<br>
If the RST, FIN or SYN flags are set, the receive parser 98 may surrender control to the<br>
transport layer. If the ACK flag is sent, then the receive parser 98 may interact either with<br>
the device driver 408 or the transmit path 94 to transmit an acknowledgment packet, as<br>
further described below.<br>
After the checks are complete, the zero copy parser 110 may determine (at 205)<br>
whether a data link error occurred, an error that may cause the packet to be unusable. If this<br>
is the case, then the zero copy parser 110 may reclaim (at 205) the memory that the driver<br>
program allocated for the packet, reclaim (at 207) the memory that was allocated for zero<br>
copy of the packet and reset (at 209) the DMA channel (emulated by the DMA engine 131)<br>
that was associated with the packet. Otherwise, the zero copy parser 110 compiles an error<br>
statistics stack for the protocol stack.<br>
Referring back to Fig. 2, besides the network controller 52, the computer system 50<br>
may include the processor 54 that is coupled to a host bus 58. The host bus 58 may be<br>
coupled by a bridge, or memory hub 60, to an Accelerated Graphics Port (AGP) bus 62, as<br>
described in the Accelerated Graphics Port Interface Specification, Revision 2.0, dated May<br>
1998. The AGP bus 62 may be coupled to, for example, a video controller 64 that controls a<br>
display 65. The memory hub 60 may also couple the AGP bus 62 and the host bus 58 to a<br>
memory bus 61. The memory bus 61, in turn, may be coupled to a system memory 56 that<br>
may, as examples, store the buffers 304 and a copy of the device driver 408.<br>
The memory hub 60 may also be coupled (via a hub link 66) to another bridge, or<br>
input/output (I/O) hub 68, that is coupled to an I/O expansion bus 70 and the system bus 72.<br>
The I/O hub 68 may also be coupled to, as examples, a compact disc (CD) or digital video<br>
disc (DVD) drive 82 and a hard disk drive 84. The I/O expansion bus 70 may be coupled to<br>
an I/O controller 74 that controls operation of a floppy disk drive 76 and receives input data<br>
from a keyboard 78 and a mouse 80, as examples.<br>
Various software or firmware (formed of modules, routines, or other layers, for<br>
example), including applications, operating system modules or routines, device drivers, BIOS<br>
modules or routines, and interrupt handlers, may be stored or otherwise tangibly embodied in<br>
one or more storage media in the device 50 and other like devices. Storage media suitable for<br>
tangibly embodying software and firmware instructions may include different forms of<br>
memory including semiconductor memory devices such as dynamic or static random access<br>
memories, erasable and programmable read-only memories (EPROMs), electrically erasable<br>
and programmable read-only memories (EEPROMs), and flash memories; magnetic disks<br>
such as fixed, floppy and removable disks; other magnetic media including tape; and optical<br>
media such as CD or DVD disks. The instructions stored in the storage media when executed<br>
cause the device 50 to perform programmed acts.<br>
The software or firmware can be loaded into the device 50 in one of many different<br>
ways. For example, instructions or other code segments stored on storage media or<br>
transported through a network interface card, modem, or other interface mechanism may be<br>
loaded into the device 50 and executed to perform programmed acts, hi the loading or<br>
transport process, data signals that are embodied as carrier waves (transmitted over telephone<br>
lines, network lines, wireless links, cables and the like) may communicate the instructions or<br>
code segments to the device 50.<br>
While the invention has been disclosed with respect to a limited number of<br>
embodiments, those skilled in the art will appreciate numerous modifications and variations<br>
therefrom. It is intended that the appended claims cover all such modifications and variations<br>
as fall within the true spirit and scope of the invention.<br>
WE CLAIM :<br>
1. A method for protection of information for use in a device coupled to a<br>
communications channel, said method comprising :<br>
determining a security service to perform with a data block ;<br>
generating security information to pass along with the data block, the<br>
security information identifying the security service ; and<br>
processing, in a controller adapted to control communication<br>
with the communications channel, the data block according to the security<br>
information.<br>
2. The method as claimed in claim 1, wherein during the processing there<br>
is provided a step of performing cryptographic processing of the data block.<br>
3. The method as claimed in claim 1, comprising :<br>
receiving the data block from a software routine ; and<br>
routing the processed data block back to the software routine after<br>
processing.<br>
4. The method as claimed in claim 1, comprising:<br>
determining if the security service can be performed by the controller;<br>
and if not, processing the data block according to the security service in a<br>
software routine instead of the controller.<br>
5. The method as claimed in claim 1, comprising identifying a security<br>
service according to an Internet Protocol security protocol.<br>
6. A device for protection of information, said device comprising a<br>
machine-reliable storage medium containing instructions for execution in a<br>
system having a controller adapted to control communications with a<br>
communications channel, the instructions when executed causing the system<br>
to :<br>
identify a security service to be performed on data to be transmitted<br>
over the communications channel; and<br>
prepare security control information to pass along with the data to<br>
the controller to perform processing according to the identified security<br>
service.<br>
7. The device as claimed in claim 6, wherein the storage medium<br>
contains instructions that when executed further causes the system to<br>
perform processing according to the identified security service instead of<br>
the controller if the security service cannot be performed by the controller.<br>
8. A method for protection of information for use in a device coupled to<br>
a communications channel, substantially as herein described, particularly<br>
with reference to and as illustrated in the accompanying drawings.<br>
9. A device for protection of information, substantially as herein<br>
described, particularly with reference to and as illustrated in the<br>
accompanying drawings.<br><br>
A method for protection of information for use in a device<br>
coupled to a communications channel, comprises   :<br>
determining a security service to perform with a data block;<br>
generating security information to pass along with the data<br>
block, the security information identifying the security service ;<br>
and<br>
processing in a controller adapted to control communication<br>
with the communications channel, the data block according to the<br>
security information.<br>
A device (50) for protection of information, comprises a<br>
machine-reliable storage medium containing instructions for<br>
execution in a system having a controller (52) adapted to control<br>
communications with a communications channel (47), the<br>
instructions when executed causing the system  to :<br>
identify a security service to be performed on data to be<br>
transmitted over the communications channel ; and<br>
prepare security control information to pass along with the<br>
data to the controller to perform processing according to the<br>
identified security service.<br></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=SU4tUENULTIwMDItMDAxNTYtS09MLSgwNi0wNy0yMDEyKS1GT1JNLTI3LnBkZg==" target="_blank" style="word-wrap:break-word;">IN-PCT-2002-00156-KOL-(06-07-2012)-FORM-27.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDItMTU2LWtvbC1ncmFudGVkLWFic3RyYWN0LnBkZg==" target="_blank" style="word-wrap:break-word;">in-pct-2002-156-kol-granted-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDItMTU2LWtvbC1ncmFudGVkLWFzc2lnbm1lbnQucGRm" target="_blank" style="word-wrap:break-word;">in-pct-2002-156-kol-granted-assignment.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDItMTU2LWtvbC1ncmFudGVkLWNsYWltcy5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2002-156-kol-granted-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDItMTU2LWtvbC1ncmFudGVkLWNvcnJlc3BvbmRlbmNlLnBkZg==" target="_blank" style="word-wrap:break-word;">in-pct-2002-156-kol-granted-correspondence.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDItMTU2LWtvbC1ncmFudGVkLWRlc2NyaXB0aW9uIChjb21wbGV0ZSkucGRm" target="_blank" style="word-wrap:break-word;">in-pct-2002-156-kol-granted-description (complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDItMTU2LWtvbC1ncmFudGVkLWRyYXdpbmdzLnBkZg==" target="_blank" style="word-wrap:break-word;">in-pct-2002-156-kol-granted-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDItMTU2LWtvbC1ncmFudGVkLWV4YW1pbmF0aW9uIHJlcG9ydC5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2002-156-kol-granted-examination report.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDItMTU2LWtvbC1ncmFudGVkLWZvcm0gMS5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2002-156-kol-granted-form 1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDItMTU2LWtvbC1ncmFudGVkLWZvcm0gMTgucGRm" target="_blank" style="word-wrap:break-word;">in-pct-2002-156-kol-granted-form 18.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDItMTU2LWtvbC1ncmFudGVkLWZvcm0gMi5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2002-156-kol-granted-form 2.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDItMTU2LWtvbC1ncmFudGVkLWZvcm0gMy5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2002-156-kol-granted-form 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDItMTU2LWtvbC1ncmFudGVkLWZvcm0gNS5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2002-156-kol-granted-form 5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDItMTU2LWtvbC1ncmFudGVkLWdwYS5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2002-156-kol-granted-gpa.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDItMTU2LWtvbC1ncmFudGVkLXJlcGx5IHRvIGV4YW1pbmF0aW9uIHJlcG9ydC5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2002-156-kol-granted-reply to examination report.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDItMTU2LWtvbC1ncmFudGVkLXNwZWNpZmljYXRpb24ucGRm" target="_blank" style="word-wrap:break-word;">in-pct-2002-156-kol-granted-specification.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=aW4tcGN0LTIwMDItMTU2LWtvbC1ncmFudGVkLXRyYW5zbGF0ZWQgY29weSBvZiBwcmlvcml0eSBkb2N1bWVudC5wZGY=" target="_blank" style="word-wrap:break-word;">in-pct-2002-156-kol-granted-translated copy of priority document.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="234593-height-adjustable-work-chair.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="234595-a-process-of-preparing-herbosomes-with-andrographolide-having-better-hepatoprotective-activity-and-product-thereof.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>234594</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>IN/PCT/2002/156/KOL</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>24/2009</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>12-Jun-2009</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>10-Jun-2009</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>31-Jan-2002</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>INTEL CORPORATION</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>2200 MISSION COLLEGE BOULEVARD, SANTA CLARA, CA 95052, USA.</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>PATEL BAIJU V</td>
											<td>10552, N.W.LA CASSEL CREST LANE, PORTLAND, OR 97229</td>
										</tr>
										<tr>
											<td>2</td>
											<td>ELZUR URI</td>
											<td>78 HASHOMER STREET, 30900 ZICHRON YAAKOV</td>
										</tr>
										<tr>
											<td>3</td>
											<td>ELZUR URI</td>
											<td>78 HASHOMER STREET, 30900 ZICHRON YAAKOV</td>
										</tr>
										<tr>
											<td>4</td>
											<td>PATEL BAIJU V</td>
											<td>10552, N.W.LA CASSEL CREST LANE, PORTLAND, OR 97229</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04L 29/06</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/US2000/16588</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2000-06-16</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>09/364,835</td>
									<td>1999-07-30</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/234594-a-method-a-device-for-protection-of-communications by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 14:20:13 GMT -->
</html>
