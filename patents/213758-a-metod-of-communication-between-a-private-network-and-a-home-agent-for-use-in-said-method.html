<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/213758-a-metod-of-communication-between-a-private-network-and-a-home-agent-for-use-in-said-method by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 06:31:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 213758:A METOD OF COMMUNICATION BETWEEN A PRIVATE NETWORK AND A HOME AGENT FOR USE IN SAID METHOD.</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">A METOD OF COMMUNICATION BETWEEN A PRIVATE NETWORK AND A HOME AGENT FOR USE IN SAID METHOD.</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>THE INVENTION PROVIDES COMMUNICATION BETWEEN A PRIVATE NETWORK (VPN) AND A ROAMING MOBILE NODE (MN) (1). THE VPN HAS A HOME AGENT (HA)(5) FOR THE MN AND A SECURE GATEWAY (2). COMMUNICATION PROTOCOLS INCLUDE DIFFERENT SECURITY ASSOCIATIONS BETWEEN THE MN AND GATEWAY FOR INBOUND AND OUTBOUND COMMUNICATIONS. ON A HANDOVER CAUSING A CHANGE OF IP ADDRESS, THE MN UPDATES ITS INBOUND SECURITY ASSOCIATION (ISA) FROM THE GATEWAY. THE ISA OF THE GATEWAY ACCEPTS THE MESSAGE WITHOUT CHECKING ITS SOURCE ADDRESS. THE GATEWAY FORWARDS THE MESSAGE WITHI THE VPN TO THE HA, WHICH CHECKS STHE VALIDITY BEFORE UPDATING ITS ADDRESS DATA AND SENDING A MESSAGE TO THE GATEWAY INDICATING THE NEW ADDRESS. THE GATEWAY THEN UPDATES ITS OUTBOUND SECURITY ASSOCIATION WITH THE MN.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>A METHOD OF COMMUNICATION BETWEEN A PRIVATE NETWORK AND<br>
A ROAMING MOBILE TERMINAL; A MOBILE TERMINAL, A GATEWAY<br>
AND A HOME AGENT FOR USE IN SAID METHOD<br>
Field of the invention<br>
This invention relates to a method of communication between a private<br>
network and a roaming mobile terminal, and to a mobile terminal, gateway and<br>
home agent for use in said method.<br>
Background of the invention<br>
Many organizations utilize private networks, whose communications with<br>
terminals outside the private network pass through security gateways that protect<br>
the private network using techniques including firewalls.<br>
Protection of private corporate information is of utmost importance when<br>
designing an information infrastructure. However, the separate private networking<br>
solutions are expensive and cannot be updated quickly to adapt to changes in<br>
business requirements. The Internet, on the other hand, is inexpensive but does not<br>
by itself ensure privacy. Virtual private networking is the collection of technologies<br>
applied to a public network - in particular the Internet - to provide solutions for<br>
private networking needs. Virtual private networks use obfuscation through secure<br>
tunnels, rather than physical separation, to keep communications private.<br>
Virtual private networks ("VPN") accordingly enable private networks to be<br>
extended to enable securitised communication with roaming terminals, that is to say<br>
terminals situated outside the private network, the communication passing for<br>
example through the Internet and possibly over mobile telephone networks. The<br>
Internet uses Internet Protocol ("IP") and the communications of mobile terminals<br>
often use Mobile Internet Protocol ("MIP").<br>
It is expected that the roaming usage of virtual private networks will become<br>
bigger and more frequent. Such frequently roaming users will need to be given the<br>
same level of security as fixed or occasional roaming terminals, through the<br>
corporate VPN / firewall architecture.<br>
Different communication and security protocols are used for the different<br>
networks. An example of Internet security protocol is the IPsec specification [S.<br>
Kent, R. Atkinson, "Security Architecture for the Internet Protocol", Internet<br>
Engineering Task Force (IETF), RFC 2401, November 1998]. Examples of mobile<br>
telephone communication protocols are the Mobile IPv4 specification [C. Perkins,<br>
"IP Mobility Support", RFC 2002, October 1996] and the Mobile IPv6 specification.<br>
When the VPN protocol is IPsec Encapsulating Security Payload and the mobility<br>
protocol is Mobile IP, both of them being implemented in the same -IP- layer, there<br>
is a need to specify how these two protocols must interact with each other when<br>
being simultaneously required.<br>
Beyond basic application order (either apply Mobile IP first, or apply IPsec<br>
first), the overall solution must aim at meeting three major requirements:<br>
• Security. The fact that VPN infrastructure can support Mobile-IP users must<br>
not create new security flaws to any corporate entity (corporate network &amp;<br>
mobile or occasionally roaming users). Mobile IP enabled devices must<br>
provide mobile users with the same level of security as if they were physically<br>
located within the corporate network. On the other hand, Mobile IP entities<br>
must be adequately protected by corporate security infrastructure (Firewalls)<br>
and Mobile IP specific security mechanism must not interfere with global<br>
security mechanism.<br>
• Compatibility. A solution that enables optimized interaction between Mobile<br>
IP and IPsec must avoid heavily modifying protocol specifications. Future<br>
evolutions of Mobile IP &amp; IPsec protocols must not be made excessively<br>
• difficult due to the use of an optimized combined solution. Optimally, such<br>
evolutions should be transparent to the use of the combined solution.<br>
• Performance. The invention must address specific needs of mobile users in<br>
terms of handover quality: the handover must be made as quick as possible.<br>
One example of a communication protocol for a virtual private network is the<br>
ESP (Encapsulating Security Payload) protocol (S. Kent, R. Atkinson, "IP<br>
Encapsulating Security Payload", Internet Engineering Task Force (IETF), RFC<br>
2406, November 1998), used in tunnel mode. The most significant points are the<br>
following:<br>
• The whole incoming IP packet is tunnelled into a new one; inner (original)<br>
source and destination addresses are not changed.<br>
• The whole incoming IP packet is encrypted and optionally (recommended)<br>
authenticated.<br>
ESP tunnel mode is by definition a unidirectional peer-to-peer protocol. The<br>
sender (the one that encrypts and tunnels) and the receiver (the one that detunnels<br>
and decrypts) must share a cryptographic secret (e.g. key and algorithm used for<br>
encryption/decryption). The set of security parameters (protocol, key, algorithm,<br>
sender address, receiver address, lifetime, ...) constitutes a so-called IPsec Security<br>
Association ("SA"). IPsec requires two SAs (an SA bundle) to obtain a secured<br>
unidirectional communication: one on the sender and one on the receiver (with<br>
some common parameters, for example the key).<br>
As a VPN communication is bidirectional (from Mobile Node ("MN") to VPN<br>
Gateway and from VPN Gateway to MN), two SA bundles are required: the first one<br>
describes the tunnel from MN to VPN Gateway, the second one describes the<br>
tunnel from VPN Gateway to MN. It must be noted that the designation "VPN<br>
Gateway" is not specified by the protocol: a VPN Gateway is simply the topologic<br>
entity that terminates, at the corporate network side, all VPN secure tunnels to/from<br>
roaming mobile nodes.<br>
SA selectors are used for the processing of IPsec packets. Basically, SA<br>
selectors are IP parameters that are used by IPsec layer to check that:<br>
• A packet that is about to be sent on a tunnel defined by a certain outbound<br>
SA is actually legitimate to be sent with that SA (e.g. source &amp; destination<br>
addresses of the packet match with source and destination address of the<br>
SA). This test is called the "outbound SA selector check".<br>
• A packet that has been received from a tunnel defined by a certain inbound<br>
SA is actually legitimate to have been received with this SA (e.g. source &amp;<br>
destination addresses of the packet match with source and destination<br>
address of the SA). This test is called the "inbound SA selector check".<br>
•<br>
It must be noted that, as illustrated in the two examples above, only source<br>
address &amp; destination address will be considered in this invention as SA selectors<br>
for both inbound and outbound Sas.<br>
Two families of proposals address this situation:<br>
IPsec tunnel in the MIP tunnel.<br>
With this family of proposals, the IPsec tunnel is established between the VPN<br>
Gateway and the Mobile Node Home Address.<br>
External home agent. The home agent is placed in front of the IPsec gateway<br>
and the corporate firewall, i.e. outside the home network. Obviously, there are deep<br>
security flaws; the main one is that the home agent is no longer protected by the<br>
common protection (corporate firewall) mechanism at the border of the network.<br>
Indeed, a home agent placed outside the gateway does not benefit from any<br>
protection and become an easy target. This kind of security flaw could not be<br>
accepted when designing a VPN solution aimed at securing communications.<br>
Another problem stems from the tunnelling mechanism that does not cipher<br>
the MIP packets (the IPsec tunnel is inside the MIP tunnel). The MIP header is in<br>
plain text and any attacker with bad intentions will have knowledge of all header<br>
fields, for instance the home address of the mobile node. Thus, this solution does<br>
not provide privacy and a malicious node might track all successive locations of a<br>
mobile node, identified through its home address.<br>
MIP proxy. This proposal is described in a draft (F. Adrangi, P. Iyer, "Mobile<br>
IPv4 Traversal across VPN or NAT &amp; VPN Gateway", IETF work in progress draft-<br>
adrangi-mobileip-natvpn-traversal-01.txt, February 2002). It assumes the creation of<br>
a new entity called a Mobile IP Proxy that appears as a surrogate home agent from<br>
a mobile node point of view and conversely is viewed as a mobile node by the home<br>
agent. This solution is also based on IPsec in MIP tunnelling, which is less<br>
confidential in terms of privacy than MIP in IPsec as stated above.<br>
The process of simple roaming requires new signalling messages between the<br>
MIP proxy, the VPN gateway, and the home agent: the MIP proxy acts as a relay<br>
between the mobile node and the home agent ("HA"); it must be aware of existing<br>
protection between the mobile node and the HA to forward valid request uniquely. It<br>
also interacts with the VPN gateway and a common packet from a correspondent<br>
node to a MN follows a heavy process: it is first MlP-encapsulated by the HA to the<br>
MIP proxy. Then the MIP proxy decapsulates it and gives it to the VPN gateway in<br>
order to realize encryption. The VPN gateway sends back the ciphered packets to<br>
the MIP proxy, which encapsulates it again in a new MIP packet.<br>
The MIP proxy is located outside the protected domain in the Demilitarized<br>
Zone ("DMZ"), that is to say a small network inserted as a "neutral zone" between a<br>
company"s private network and the outside public network. The security level of<br>
machines within the DMZ is far inferior to the corporate network. The firewalls must<br>
not interfere with the registration procedure between the proxy and the Home Agent.<br>
This architecture implies possible security flaws since the corporate firewall must let<br>
any packets between the MIP proxy and the Home Agent go through without further<br>
inspections: this can easily lead to compromise the entire corporate network if an<br>
attacker can manage to gain access to the MIP proxy.<br>
MIP tunnel in the IPsec tunnel<br>
With this family of proposals, an IPsec tunnel is established between the VPN<br>
Gateway and the Mobile Node Care-of Address.<br>
One proposal that includes the MIP tunnel in the IPsec tunnel has been<br>
described by the University of Bern, Switzerland at www.iam.unibe.ch/~rvs/<br>
publications/secmip_gi.pdf. The IPsec tunnel is reset before any new handover.<br>
When moving to a new network, it has to be re-established through the whole key<br>
distribution process. That handover mode creates unacceptable latencies of many<br>
seconds, incompatible with classical MIP requirements.<br>
Another issue with this proposal consists in assuming that IPsec offers a<br>
sufficient protection and, as a consequence, in disabling authentication and replay<br>
protections during the MIP registration procedure. Disabling protections on the<br>
Home Agent is an option that does not really improve speed and requires home<br>
agents dedicated to MIP-VPN users, as well as other home agents dedicated to<br>
simple MIP users that still use MIP protections.<br>
"US 6571289 describes negotiating access to a private network for a mobile<br>
node that has migrated beyond the private network, where a mobile station<br>
sends an unsecured registration request to a gateway, where the gateway then<br>
acts as a surrogate mobile node which sends a different registration request to<br>
the home agent."<br>
The present invention addresses the above and other problems.<br>
Summary of the invention<br>
The present invention provides a method of and apparatus for communication<br>
as described in the accompanying claims.<br>
Brief description of the accompanying drawings<br>
Figure 1 is a schematic diagram of a mobile virtual private network scenario.<br>
Figure 2 is a diagram of a data packet encapsulated in ESP tunnel mode,<br>
Figure 3 is a flow chart of exchanges in communication between a private<br>
network and a roaming mobile terminal in accordance with one embodiment of the<br>
invention, given by way of example, and<br>
Figure 4 is a flow chart of a process for reception of a registration request in<br>
the communication process illustrated in Figure 3.<br>
Detailed description of the preferred embodiments<br>
Figure 1 shows a mobile virtual private network scenario comprising a private<br>
network 1 including a security gateway comprising a VPN gateway 2 and a firewall<br>
3, a mobile node 4 situated in the private network 1 and a home agent 5 for the<br>
mobile node 4. The embodiment of the present invention shown in the drawings is<br>
applicable especially where the mobile node 4 is capable of communication over a<br>
wireless link, which improves its ability to roam, both within and outside the private<br>
network 1 but this embodiment of the invention is also applicable where the mobile<br>
node 4 communicates only over wire connections.<br>
Figure 1 shows a scenario where the advantages of this embodiment of the<br>
invention are particularly appreciable, where the mobile node 4 moves outside the<br>
private network 1, first to a visited network 6 having a foreign agent 7 functioning<br>
under mobile IPV4 protocol, enabling communication of the roaming mobile node 4<br>
in the network 6 through the internet 8 with the private network 1. In this scenario<br>
the roaming mobile node 4 then moves to a second visited network 9, having a<br>
foreign agent 10, also functioning under mobile IPV4 for communication through the<br>
internet 8 with the private network 1. While this embodiment of the invention<br>
functions with Mobile IPv4 protocols, it will be appreciated that the invention is also<br>
applicable to other protocols, especially the Mobile IPv6 protocol.<br>
When the mobile node 4 is roaming in the visited networks 6 or 9,<br>
communications with the private network 1 are established through the internet 8 in<br>
IPsec and MIP tunnels 11 and 12 respectively. More specifically, the protocol used<br>
is the encapsulating security payload ("ESP") protocol illustrated in Figure 2.<br>
According to this protocol, the original packet 13 comprises an original IP header 14<br>
and data 15. The packet 13 is encrypted with an ESP trailer 16 without changing the<br>
original IP header and destination address. The encrypted packet is encapsulated<br>
with an ESP header 17 and preferably an ESP authentication 18 and assembled<br>
with a new IP header 19 before transmission. Security association bundles, each<br>
comprising an outbound and inbound communication security association, are<br>
established for communications over the paths 11 and 12 with the VPN gateway 2.<br>
Security association selectors check that packets to be sent using the tunnel<br>
defined by each outbound security association are legitimate to be sent with that<br>
security association and, in particular, that the source and destination addresses of<br>
the packet match with the source and destination addresses of the security<br>
association, this test being the outbound SA selector check. Packets received from<br>
a tunnel defined by the inbound security association are checked for legitimacy of<br>
reception with this security association and, in particular, that the source and<br>
destination addresses of the packet match the source and destination addresses of<br>
the security association, this test being the inbound SA selector check.<br>
In this embodiment of the invention the inbound security association of the<br>
VPN gateway 2 does not contain the IP address of the mobile node 4 as source<br>
address but a wild card ("*"). This allows the VPN gateway 2 to receive and forward<br>
a packet from the mobile node 4 whatever Care-of address it may use. It will be<br>
noted that this is not contradictory with IPsec protocol, since the wild card value is<br>
authorized by this protocol for the source address selector in a security association.<br>
The tunnel order is that of an MIP tunnel in the IPsec tunnel, with the IPsec tunnel<br>
between the VPN gateway 2 and the mobile node 4, using the mobile node Care-of<br>
address as end point.<br>
The process for communications when the mobile node 4 is roaming is shown<br>
in Figure 3, in which references to outbound and inbound refer to packets at the<br>
mobile node 4. Initially, the IPsec tunnels are illustrated for the situation where<br>
communication is established at the current Care-of address of the mobile node 4.<br>
The outbound IPsec tunnel 20 has a security association at the mobile node 4,<br>
having the current mobile node Care-of address as source address and the address<br>
of the VPN gateway 2 as destination address, and a security association at the VPN<br>
gateway 2, having a wild card as the source address and the VPN gateway 2<br>
address as the destination address. The initial inbound IPsec tunnel has a security<br>
association at the mobile node 4, with the address of the VPN gateway 2 as source<br>
address and the current Care-of address of the mobile node 4 as destination<br>
address, and a security association at the VPN gateway 2, having the VPN gateway<br>
address as source address and the mobile node 4 Care-of address as destination<br>
address.<br>
When the mobile node moves at 22 from one visited network to another, for<br>
example, from the visited network 6 to the visited network 9, the mobile node 4<br>
recognizes that its location has changed, for example, from an incoming agent<br>
advertisement. It then configures a new Care-of address that is routable within the<br>
new visited network 7. The mobile node 4 contains VPN client software that<br>
responds to the change in mobile node location, for example, in response to<br>
network selection middleware or by monitoring the source addresses of outbound<br>
packets. The VPN client software then changes dynamically the inbound security<br>
association on the mobile node 4 so that its destination address is the new Care-of<br>
address of the mobile node, the inbound IPsec tunnel 21 becoming a temporary<br>
inbound IPsec tunnel 23. In this way the mobile node 4 will be able to receive<br>
packets securely sent by the VPN gateway 2 to its new Care-of address; otherwise<br>
the packets would be dropped as they would not match the destination address<br>
included in the former inbound IPsec tunnel 21. Similarly the VPN client software<br>
changes dynamically the outbound security association on the mobile node 4, so<br>
that its source address is the new Care-of address of the mobile node, the outbound<br>
IPsec tunnel 20 becoming an outbound IPsec tunnel 20"; otherwise the mobile node<br>
4 would not be able to send outgoing packets as they would not match the source<br>
address included in the former outbound IPsec tunnel 20.<br>
The mobile node 4 then sends a signalling message to its home agent to<br>
inform it of its new location, the signalling message passing through the outbound<br>
IPsec tunnel 20" and the VPN gateway 2. This signalling message is in the form of a<br>
registration request where the protocol used is mobile IPV4, as in this embodiment<br>
of the invention.<br>
The signalling message is received at the VPN gateway 2 in step 24. The SA<br>
selector in the VPN gateway for the outbound tunnel 20" does not reject the packet<br>
since the source address is a wild card field and the source address is therefore not<br>
verified and the packet is forwarded to the home agent 5. At step 25 the home<br>
agent 5 receives and processes the registration request message from the mobile<br>
node 4 indicating the new Care-of address. If the registration request is valid the<br>
home agent 5 sends a security information update message ("SIU") to the VPN<br>
gateway 2 containing an order to update the security association of the temporary<br>
IPsec tunnel 23 on the VPN gateway. This SIU message is processed at the VPN<br>
gateway 2 by a daemon, for example, that is to say a background programme that<br>
provides services to the system.<br>
In response to the SIU message the VPN gateway 2 updates its security<br>
association for the temporary inbound IPsec tunnel 23 to a new IPsec tunnel 26,<br>
having the new Care-of address of the mobile node 4 as destination address. This<br>
update is performed before any packet is sent to the mobile node 4, in particular the<br>
registration reply. In a preferred embodiment of the invention the SIU message from<br>
the home agent 5 to the VPN gateway 2 includes the registration reply to the mobile<br>
node 4.<br>
It will be appreciated that this particular routine of the home agent 1 is<br>
triggered only when the registration request is received through a VPN gateway<br>
such as 2, corresponding to a location of the mobile node 4 outside the private<br>
network 1. If the mobile node were situated within the private network 1, and<br>
therefore not using the VPN service, the home agent 5 would respond according to<br>
the normal routine with a normal registration reply.<br>
At step 27, the VPN gateway 2 forwards the registration reply to the mobile<br>
node 4 using the newly-established inbound IPsec tunnel 26 and sends all further<br>
data packets to the new Care-of address using the tunnel 26 until further notice.<br>
If at step 25 the registration request does not succeed at the home agent 5,<br>
the process is not irremediably compromised. No registration reply will be received<br>
at the mobile node 4, which will send a further registration request. If the home<br>
agent 5 continues not to accept the registration requests, the mobile node 4 will<br>
ultimately abandon the attempt and establish a new tunnel for a new Care-of<br>
address without taking advantage of the process of this embodiment of the<br>
invention. This situation is inherent in mobile IP scenarios.<br>
Figure 4 illustrates the routines followed by the home agent 5 during the above<br>
process. The routine begins at 28 and at step 29 an input is received in the form of<br>
a registration request from the mobile node 24. A check is made at step 30 whether<br>
the registration request is valid, and if the home agent 5 does not accept the<br>
registration, the routine terminates at 31. If the home agent 5 does accept the<br>
registration request, a check is made at 32 whether the registration request was<br>
received through a VPN gateway such as 2. If it was not, a registration reply is built<br>
and sent directly to the mobile node 4 over the private network 1 at step 33. If the<br>
registration request was received through a VPN gateway such as 2, a registration<br>
reply for the mobile node 4 is built at 34. This registration reply is then included in a<br>
new packet generated by the home agent 5 at 35 and which also contains the<br>
former Care-of address and the new Care-of address of the mobile node 4. That<br>
packet is then sent at step 36 to the VPN gateway 2 and the routine terminates<br>
again at 31.<br>
WE CLAIM :<br>
1. A method of communication between a private network (1) and a roaming<br>
mobile terminal (4), said private network (1) including a home agent (5) for said<br>
mobile terminal and a gateway (2, 3) through which said communication passes<br>
and which provides security protection for said private network (1), the protocols<br>
of said communication including security association bundles each including a<br>
security association between said mobile terminal (4) and said gateway (2, 3) for<br>
inbound communication and another security association for outbound<br>
communication,<br>
characterized in that, in response to a handover of communication causing an IP<br>
address (MN Co @) of said mobile terminal (4) to change to a new IP address<br>
(MN New Co @), said mobile terminal updates its inbound security association<br>
from said gateway (2, 3) so that it can receive packets sent to it with said new IP<br>
address (MN New Co @) as destination, said mobile terminal (4) sends a first<br>
signalling message with said home agent (5) as destination in a secure tunnel<br>
(20") to said gateway (2, 3), said first signalling message indicating said new IP<br>
address (MN New Co @) in secure form to said home agent (5), the inbound<br>
security association of said gateway (2, 3) from said mobile terminal (4) accepts<br>
said first signalling message without checking its source address, said gateway<br>
(2, 3) forwards said first signalling message within said private network (1) to<br>
said home agent (5), said home agent (5) checks the validity of said first<br>
signalling message and, if it is valid, updates its address data and sends a<br>
second signalling message to said gateway (2, 3) indicating said new address<br>
(MN New Co @), and said gateway (2, 3) updates its outbound security<br>
association with said mobile terminal (4) in response to the new address (MN<br>
New Co @) indicated.<br>
2. A method as claimed in claim 1, wherein communication between said mobile<br>
node (4) and said gateway (2, 3) is in accordance with an IPsec protocol<br>
specification.<br>
3. A method as claimed in claim 2, wherein communication between said gateway<br>
(2, 3) and said mobile terminal (4) is in accordance with an Encapsulating<br>
Security Payload protocol used in tunnel mode.<br>
4. A method as claimed in any preceding claim, wherein a registration reply for<br>
said mobile node (4) is included in said second signalling message.<br>
5. A mobile terminal for use in communication by a method as claimed in any one<br>
of claims 1 to 3, comprising means responsive to a handover of communication<br>
causing an IP address (MN Co @) of said mobile terminal to change to a new IP<br>
address (MN New Co @) for updating the inbound security association of said<br>
mobile terminal (4) from said gateway (2, 3) so that it can receive packets sent<br>
with said new IP address (MN New Co @) as destination and for sending a first<br>
signalling message with said home agent (5) as destination through a secure<br>
tunnel (20") to said gateway, said first signalling message indicating said new IP<br>
address (MN New Co @) in secure form to said home agent (5).<br>
6. A mobile terminal for use in communication by a method as claimed in any one<br>
of claims 1 to 3, comprising means responsive to a handover of communication<br>
causing an IP address (MN Co @) of said mobile terminal (4) to change to a<br>
new IP address (MN New Co @) for updating the outbound security association<br>
of said mobile terminal (4) to said gateway (2, 3) so that said mobile terminal (4)<br>
can send packets to said gateway (2, 3) with said new IP address (MN New Co<br>
@) as source address.<br>
7. A gateway for use in communication by a method as claimed in any one of<br>
claims 1 to 3, comprising means responsive to said first signalling message<br>
received in a secure tunnel (20") from said mobile terminal with said home agent<br>
(5) as destination for causing said inbound security association at said gateway<br>
(2, 3) from said mobile terminal (4) to accept said first signalling message<br>
without checking its source address and for forwarding said first signalling<br>
message to said home agent (5), and means responsive to said second<br>
signalling message indicating said new address (MN New Co @) for updating<br>
said outbound security association of said gateway (2, 3) with said mobile<br>
terminal (4) in response to the new address (MN New Co @) indicated.<br>
8. A home agent for use in communication by a method as claimed in any one of<br>
claims 1 to 3, comprising means responsive to said first signalling message<br>
received from said gateway (2, 3) for sending said second signalling message to<br>
said gateway (2, 3) indicating said new address (MN New Co @) for said<br>
gateway to update its outbound security association with said mobile terminal<br>
(4).<br>
The invention provides communication between a private network (VPN) and<br>
a roaming mobile node (MN) (1). The VPN has a home agent (HA)(5) for the MN<br>
and a secure gateway (2). Communication protocols include different security<br>
associations between the MN and gateway for inbound and outbound<br>
communications. On a handover causing a change of IP address, the MN updates<br>
its inbound security association (ISA) from the gateway. The MN sends its new IP<br>
address to the HA (5) in a secure tunnel (20") through the gateway. The ISA of the<br>
gateway accepts the message without checking its source address. The gateway<br>
forwards the message within the VPN to the HA, which checks the validity before<br>
updating its address data and sending a message to the gateway indicating the new<br>
address. The gateway then updates its outbound security association with the MN.</td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1LT0xOUC0yMDA1LSgyOC0wMy0yMDEyKS1BU1NJR05NRU5ULnBkZg==" target="_blank" style="word-wrap:break-word;">1655-KOLNP-2005-(28-03-2012)-ASSIGNMENT.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1LT0xOUC0yMDA1LSgyOC0wMy0yMDEyKS1DRVJUSUZJRUQgQ09QSUVTKE9USEVSIENPVU5UUklFUykucGRm" target="_blank" style="word-wrap:break-word;">1655-KOLNP-2005-(28-03-2012)-CERTIFIED COPIES(OTHER COUNTRIES).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1LT0xOUC0yMDA1LSgyOC0wMy0yMDEyKS1DT1JSRVNQT05ERU5DRS5wZGY=" target="_blank" style="word-wrap:break-word;">1655-KOLNP-2005-(28-03-2012)-CORRESPONDENCE.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1LT0xOUC0yMDA1LSgyOC0wMy0yMDEyKS1GT1JNLTE2LnBkZg==" target="_blank" style="word-wrap:break-word;">1655-KOLNP-2005-(28-03-2012)-FORM-16.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1LT0xOUC0yMDA1LSgyOC0wMy0yMDEyKS1QQS1DRVJUSUZJRUQgQ09QSUVTLnBkZg==" target="_blank" style="word-wrap:break-word;">1655-KOLNP-2005-(28-03-2012)-PA-CERTIFIED COPIES.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1LT0xOUC0yMDA1LUNPUlJFU1BPTkRFTkNFLnBkZg==" target="_blank" style="word-wrap:break-word;">1655-KOLNP-2005-CORRESPONDENCE.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1LT0xOUC0yMDA1LUZPUk0tMjcucGRm" target="_blank" style="word-wrap:break-word;">1655-KOLNP-2005-FORM-27.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1rb2xucC0yMDA1LWdyYW50ZWQtYWJzdHJhY3QucGRm" target="_blank" style="word-wrap:break-word;">1655-kolnp-2005-granted-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1rb2xucC0yMDA1LWdyYW50ZWQtYXNzaWdubWVudC5wZGY=" target="_blank" style="word-wrap:break-word;">1655-kolnp-2005-granted-assignment.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1rb2xucC0yMDA1LWdyYW50ZWQtY2xhaW1zLnBkZg==" target="_blank" style="word-wrap:break-word;">1655-kolnp-2005-granted-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1rb2xucC0yMDA1LWdyYW50ZWQtY29ycmVzcG9uZGVuY2UucGRm" target="_blank" style="word-wrap:break-word;">1655-kolnp-2005-granted-correspondence.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1rb2xucC0yMDA1LWdyYW50ZWQtZGVzY3JpcHRpb24gKGNvbXBsZXRlKS5wZGY=" target="_blank" style="word-wrap:break-word;">1655-kolnp-2005-granted-description (complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1rb2xucC0yMDA1LWdyYW50ZWQtZHJhd2luZ3MucGRm" target="_blank" style="word-wrap:break-word;">1655-kolnp-2005-granted-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1rb2xucC0yMDA1LWdyYW50ZWQtZXhhbWluYXRpb24gcmVwb3J0LnBkZg==" target="_blank" style="word-wrap:break-word;">1655-kolnp-2005-granted-examination report.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1rb2xucC0yMDA1LWdyYW50ZWQtZm9ybSAxLnBkZg==" target="_blank" style="word-wrap:break-word;">1655-kolnp-2005-granted-form 1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1rb2xucC0yMDA1LWdyYW50ZWQtZm9ybSAxOC5wZGY=" target="_blank" style="word-wrap:break-word;">1655-kolnp-2005-granted-form 18.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1rb2xucC0yMDA1LWdyYW50ZWQtZm9ybSAzLnBkZg==" target="_blank" style="word-wrap:break-word;">1655-kolnp-2005-granted-form 3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1rb2xucC0yMDA1LWdyYW50ZWQtZm9ybSA1LnBkZg==" target="_blank" style="word-wrap:break-word;">1655-kolnp-2005-granted-form 5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1rb2xucC0yMDA1LWdyYW50ZWQtbGV0dGVyIHBhdGVudC5wZGY=" target="_blank" style="word-wrap:break-word;">1655-kolnp-2005-granted-letter patent.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1rb2xucC0yMDA1LWdyYW50ZWQtcGEucGRm" target="_blank" style="word-wrap:break-word;">1655-kolnp-2005-granted-pa.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1rb2xucC0yMDA1LWdyYW50ZWQtcmVwbHkgdG8gZXhhbWluYXRpb24gcmVwb3J0LnBkZg==" target="_blank" style="word-wrap:break-word;">1655-kolnp-2005-granted-reply to examination report.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1rb2xucC0yMDA1LWdyYW50ZWQtc3BlY2lmaWNhdGlvbi5wZGY=" target="_blank" style="word-wrap:break-word;">1655-kolnp-2005-granted-specification.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1rb2xucC0yMDA1LWdyYW50ZWQtdHJhbnNsYXRlZCBjb3B5IG9mIHByaW9yaXR5IGRvY3VtZW50LnBkZg==" target="_blank" style="word-wrap:break-word;">1655-kolnp-2005-granted-translated copy of priority document.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MTY1NS1LT0xOUC0yMDA1LVBBLnBkZg==" target="_blank" style="word-wrap:break-word;">1655-KOLNP-2005-PA.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="213757-hydro-mechanical-transmission.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="213759-polypropylene-based-wrap-film.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>213758</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>1655/KOLNP/2005</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>03/2008</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>18-Jan-2008</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>16-Jan-2008</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>18-Aug-2005</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>MOTOROLA, INC.</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>1303 EAST ALGONQUIN ROAD, SCHAUMBURG, ILLINOIS 60196</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>CATALINA MIGUEL</td>
											<td>MOTOROLA SAS, PARC DES ALGORITHMES, SAINT AUBIN, F-91191 GIF-SUR-YVETTE</td>
										</tr>
										<tr>
											<td>2</td>
											<td>JANNETEAU CHRISTOPHE</td>
											<td>MOTOROLA SAS, PARC DES ALGORITHMES, SAINT AUBIN. F-91191 GIF-SUR-YVETTE</td>
										</tr>
										<tr>
											<td>3</td>
											<td>OLIVEREAUALEXIS</td>
											<td>MOTOROLA SAS, PARC DES ALGORITHMES, SAINT AUBIN, F-91191 GIF-SUR-YVETTE</td>
										</tr>
										<tr>
											<td>4</td>
											<td>HERY ISMAEL</td>
											<td>MOTOROLA SAS, PARC DES ALGORITHMES, SAINT AUBIN, F-91191 GIF-SUR-YVETTE</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>H04L 29/06</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/EP/2004/050310</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2004-03-15</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>03290770.1</td>
									<td>2002-03-27</td>
								    <td>EUROPEAN UNION</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/213758-a-metod-of-communication-between-a-private-network-and-a-home-agent-for-use-in-said-method by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 06:31:30 GMT -->
</html>
