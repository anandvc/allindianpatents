<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/207829-a-system-and-method-of-determining-the-authenticity-of-an-executable-image by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 04 Apr 2024 22:56:39 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 207829:&quot;A SYSTEM AND METHOD OF DETERMINING THE AUTHENTICITY OF AN EXECUTABLE IMAGE&quot;</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          <div class="alert fade in alert-error"><button class="close" data-dismiss="alert">&times;</button>That patent was not found in our database</div>
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">&quot;A SYSTEM AND METHOD OF DETERMINING THE AUTHENTICITY OF AN EXECUTABLE IMAGE&quot;</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>System and method for verifying the integrity of executable images (100) The system includes a run-time validator (204) that determines a reference digital signature (604) for an executable using the contents of the digital signature excluding those portions of the executable that are fixed-up by a program loader (208). The run-time validator (204) then subsequent to the loading of the executable image determines an integrity digital signature (614)to verify that the executable image (100) has not been improperly modified. In addition, the run-time validator (204) ensures that each of the pointers in the executable image(l00) have not been improperly redirected.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>- 1 -<br><br>
A SYSTEM AND METHOD OF DETERMINING THE AUTHENTICITY OF AN EXECUTABLE IMAGE<br>
Background of the Invention Field of the Invention<br>
The present invention relates to computer systems.  More particularly, the present invention relates to a system and method of verifying the authenticity of dynamically connectable executable images. Description of the Related Technology<br>
New object models now provide for the dynamic integration of software applications at run time. For example, Windows, an operating system licensed by Microsoft Inc., allows for the dynamic integration of a software application with a dynamic link library during the execution of the software application. Upon a user request for the execution of the software application, a program loader copies a "disk image" of the application from disk storage to main memory to create a "process image." The dish image refers to the executable image before it is loaded, whereas the process image refers to the executable image after it is loaded in memory. Both the disk image and the process image typically include a fix-up section that identifies which portions of the software need to be fixed-up to reference the dynamic link library at run time.<br>
Significantly, after loading, the process image is different then the disk image. As such, a checksum that had been prepared with respect to the disk image would no longer match the checksum of the process image, even if the process image had not been improperly tampered with.<br>
Therefore, there ts a need for a system that can verify the identity of a software application in a dynamic loading environment. In particular, the system should be able to determine whether a software application that has been dynamically connected to another data object has been tampered with subsequent to the execution of the software application.<br>
Summary of the Invention<br>
One embodiment of the invention includes a system for determining the authenticity of an executable image, the system comprising an executable image having one or more pointers, and a validator capable of generating at a first point in time a reference digital signature based upon a selected content of the executable image excluding each of the pointers, wherein the validator generates an authenticity digital signature at a second point in time based upon the selected content of the executable image excluding each of the pointers, and wherein the validator determines whether the reference digital signature matches the authenticity digital signature.<br>
Another embodiment of the invention includes a system for determining the authenticity of an executable image, the system comprising an executable image having one or more pointers and wherein the executable image includes information specifying whether each of the pointers reference locations that are within the executable image, and a validator capable of determining whether each of pointers references a respective location that is within the executable image.<br><br>
-   2   -<br>
Yet another embodiment of the invention includes a system for determining the authenticity of an executable image, the system comprising a first executable image, a second executable image that includes a pointer that references a location within the first executable image, and a validator capable of determining whether the pointer references a location within the first executable image.<br>
Yet another embodiment of the invention includes a system capable of determining the authenticity of an executable image, the system comprising: a first executable image, a second executable image, comprising an import table including the identifier of the first executable image and one or more external pointers, each of the external pointers referencing a location within the first executable image, and a code section containing machine code and one or more import pointers, each of the import pointers referencing a location within the import table, and a validator capable of generating at a first point in time a reference digital signature based upon a selected content of the executable image, the selected contents excluding each of the import pointers and the external pointers, wherein the validator generates an authenticity digital signature at a second point in time based upon the selected content of the<br>
executable image excluding each of the one or more pointers, wherein the validator determines whether the reference<br>
digital signature matches the authenticity digital signature, wherein the validator determines whether each of the<br>
import pointers reference a location within the first executable image, and wherein the validator determines whether the import pointer references a location within the first executable image.<br>
Accordingly, the present invention provides a system for determining the authenticity of an executable image, the system comprising : an executable image one or more pointers that are in need of fixing up by a program loader ; and a validator capable of generating at a first point in time a reference digital signature based upon a selected content of the executable image excluding each of the pointers, wherein the validator generates an authenticity digital signature at a second point in time based upon the selected content of the executable image excluding each of the pointers, and wherein the validator determines whether the reference digital signature matches the authenticity digital signature.<br><br>
-   3   -<br>
The present invention also provides a method of determining the authenticity of an executable image, the method comprising : identifying one or more locations within the executable image, each of the identified locations being modified by a program loader ; generating a reference digital signature based upon a selected content of the executable image excluding the one or more identified locations ; generating an authenticity digital signature based upon the selected content of the executable image excluding the one or more identified locations ; and determining whether the authenticity digital signature matches the reference digital signature.<br>
Brief Description of the Drawings<br>
Figure 1 is a high-level block diagram illustrating a computer of the present invention that is adapted to receive an executable image from one or more sources.<br>
Figure 2 is a block diagram illustrating a validator that is capable of determining the authenticity of one or more executable images that reside on the computer of Figure 1.<br>
Figure 3 is a block diagram illustrating the internal structure of one of the executable images of Figure 2.<br>
Figure 4 is a block diagram illustrating two of the executable images of Figure 2 being linked after a loading process.<br>
Figure 5 is a flowchart illustrating a process'performed by the validator of Figure 2 during an authenticity check of one of the executable images-shownin Figure '2.<br>
Figure 6 is a flowchart illustrating another process performed by the validator of Figure 2 during an authenticity check of one of the executable images shown in Figure 2.<br>
Detailed Description of the Invention<br>
The following detailed description is directed to certain specific embodiments of the invention. However, the invention can be embodied in a multitude of different ways as defined and covered by the claims.<br>
System Overview<br>
Figure I is a high-level block diagram illustrating a computer 90. The computer 90 enables an authenticity check with respect to one or more executable images 100 that are executing on the computer 90.<br><br>
-   4   -<br><br>
The computer 90 may utilize any conventional general purpose single- or multi-chip microprocessor such as a Pentium" processor, a Pentium" Pro processor, a 8051 processor, a MPS ' processor, a Power PC° processor, or an ALPHA0 processor. In addition, the computer 90 may utilize any conventional special purpose microprocessor such as a digital signal processor Dr a graphics processor.<br>
The computer 90 includes an operating system 95 and a memory 108. The operating system can be provided by any operating system vendor and can include. UNIX, LINUX, Disk Operating System (DOS), OS/2, Windows 3.X, Windows 95, Windows 98, and Windows NT. For convenience of description, an embodiment of the invention with respect to Windows 95 is set forth below.<br>
The computer 90 is in communication with one or more executable image sources 107 that provide the executable image 100 to the computer 90. As is shown in Figure 1, exemplary executable image providers include; a server I 10, an Internet 114, a database 118, a network 122, a hardware device 126, and/or a removable storage device 130.<br>
The executable image 100 is a data object that can define by itself or in conjunction with other executable images, one or more software applications. The software applications may include, for example: a word processor, a database, a digital rights management system, a personal finance utility, a graphics tool, an Internet browser, a computer game, a communications program, an authorization program, an electronic wallet, a multi-media Tenderer or a contract manager Furthermore, the executable image 100 is dynamically connectable with other executable images. For example, in an embodiment of the invention that is developed for use with the Windows 95, the executable image "is a dynamic link library (DLL).<br>
The Internet 114 includes network variations such as public internet, a private internet, a secure internet, a private network, a public network, a value-added network, an intranet and the like.<br>
The network 122 may include any type of electronically connected group of computers including, for instance, the following networks: Intranet, Local Area Networks (LAN) or Wide Area Networks (WAN). In addition, the connectivity to the network may be, for example, remote modem, Ethernet (IEEE 802 3), Token Ring (IEEE 802.5), Fiber Distributed Datalink Interface (FDDI) or Asynchronous Transfer Mode (ATM). Mote that computing devices may be desktop, server, portable, hand-held, set-top, or any other desired type of configuration. The hardware device 126 can be a logic chip, a ROM, a RAM, a smart card, or a central processing unit. The removable media storage 130 can be a floppy disk, a compact disk, a hard disk, a tape drive, a ROM, or other persistent storage medium.<br>
Figure 2 is a block diagram illustrating a validator 204. In one embodiment of the invention, the validator 204 is an executable image, similar in format to the executable image 100. In another embodiment of the invention, the validator 204 is integrated with the executable image 100. In yet another embodiment of the invention, the validator 204 is integrated with a program loader 208. One function of the program loader 208 is to copy an executable image 100 from the storage device 105 (Figure 1) to the memory 108 and to bind the code and data pointers to an appropriate address prior to the execution of the executable image 100. For convenience of description.<br><br>
-   5   -<br>
the following description assumes that the validator 204 is a separate application that is distinct from the executable image 100 and the program loader 208.<br>
The validator 204 verifies the authenticity of the executable image 100 under selected conditions which are described in  further detail below. As can be appreciated by the skilled technologist, the validator 204 and the program loader 208 are comprised of various sub-routines, procedures, definitional statements, and macros that are typically separately compiled and linked into a single executable program. Therefore, the following description is used for convenience to describe the functionality of the these items.<br>
The validator 204 and the program loader 208 (Figure 1) may be written in any programming language such as C, C + +, BASIC, Pascal, Java, and FORTRAN. C, C+ +, BASIC, Pascal, Java, and FORTRAN are industry standard programming languages for which many commercial compilers and interpreters can be used to create executable code.<br>
Figure 2 illustrates the executable image 100 after it has been connected to an executable image 200. It is noted that the executable image 200 can comprise the same types of data objects as described above with respect to the executable image 100. One function of the validator 204 is to verify the authenticity of the executable images, such as executable image 100 and executable image 200, after the executable images have been loaded into the memory 108.<br>
The process for verifying the authenticity of the executable images is set forth in detail with reference to Figure 5 and 6. However in brief, the validator 204 analyzes the executable image 100 before the executable image 100 is loaded into the memory 108 and generates a reference digital signature with respect to the executable image 100. After the executable image 100 is loaded, the validator 204 generates an authenticity digital signature to ensure that the executable image 100 has not been tampered with. In addition, the validator 204 examines the binding between the executable image 100 and the executable image 200 to ensure that binding between the executable image 100 has not been improperly re-directed to another executable image.<br>
Figure 3 is a block diagram illustrating in iurther detail the internal structure of one embodiment of the executable image 100 that has been built as a dynamically linked library and which has been stored on the storage device 105 (Figure 1).<br>
The executable image 100 includes a number of sections including a header section 300, code section 304, a data section 308, an import table 312, a relocation table 316, and an export table 320. It is also noted that executable image 100 includes a number of pointers that are described in further detail below. However, in general, a pointer is a reference that identifies a location within the memory 108 either absolutely with respect to the memory 108 (Figure 1) or relatively with respect to another location.<br>
The header section 300 identifies the relative location of other sections and/or tables that are within the executable image 100. The code section 304 includes the compiled machine code for the executable image 100. For example, the code section 304 includes the machine instructions for the computer 90 (Figure 1). As is shown in Figure 3, the code section 304 includes instructions that reference other sections within the executable image 100 as well as without the executable image 100. As ts shown by a block 320, the code section 304 includes instructions for the<br><br>
-   6   -<br>
assignment of the number "2" to a global variable "i". However, the actual address of the variable "i" as stored on the storage device 705 [Figure 1) is not defined in the memory 108 since the executable image 100 has not yet been loaded into the memory 108 (Figure 1). Furthermore, the code section 304 includes an instruction to call a function foo(). The call to the procedure foo{) includes an import pointer which references a location within the import table 312.<br>
The data section 308 is used to store the contents of any global variables that are identified in the code section 304. The import table 312 includes various items of information to assist the program loader 208 (Figure 2) in connecting the executable image 100 to another executable image. The import table 312 includes: an identifier, such as a name, for each of the procedures that are maintained by other executable images, the name of the executable image, and one or more external pointers which reference the addresses of externally maintained procedures. The import table 372, as is stored on the storage device 105 (Figure 1), does not yet reference the memory address of the procedure foo().<br>
The relocation table 316 identifies the position of each of the portions of the code section 304 that are in need of "fixmg-up" upon the loading of the executable image 100. The term fixing-up as used herein refers to the process of modifying the executable image 100 in memory such that any unresolved pointers reference the appropriate data and/or code locations. After a pointer has been fixed-up by the progiam loader 208, it is said to be "bound" to a selected address.<br>
The export table 320 identifies each of procedures that are made publicly available by the executable image 100. It is noted that the executable image 100 can include other information such as debug information or other tables to assist with the loading and/or linking process.<br>
The validator 204 (Figure 2) determines a leference digital signature with respect to the executable image 100 as it is stored on the storage device 105. The process for generaiing the reference signature is described in further detail with respect to Figure 6. In one embodiment of the invention, the validator 204 determines the reference digital signature with respect to the entire executable image 100 excluding any pointers that are in need of fixing up by the program loader 208 (Figure 2). In another embodiment of the invention, the validator 204 determines a reference digital signature with respect to selected sections, such as the code section 304 and/or the import table 312 of the executable image 100 excluding any of the addresses lhat are in need of fixing up by the program loader 208.<br>
Figure 4 is a block diagram illustrating the executable image 100 after it is has been fixed-up with respect to the executable image 200. As can be seen by inspection of Figure 4, a data pointer for the variable "i" has been bound to an address in the data section 308 according to tine fix-up information contained within the relocation table 316. Further, an external pointer in the import table 312 has been bound to an export table in the executable image 200. An export pointer at the referenced address in the export table of the second e&gt;ecutable image 200 has been bound to the actual location of the procedure foo( that resides within the executable image 200.<br><br>
-   7   -<br>
After being fixed-up, the validator 204 (Figure 2) performs various authenticity checks with respect to the executable image 100. Each of these authenticity checks are described in further detail with respect to Figure 5 and 6. However, in summary, the validator 204 performs the following described functions.<br>
First, the validator 204 determines an authenticity digital signature with respect to the same addresses that were used to generate the reference digital signature. If the authenticity digital signature differs from the reference digital signature, the validator 204 (Figure 2) assumes that the executable image 100 has been tampered with.<br>
Second, the validator 204 examines each of the bindings in the import table 312 to ensure the addresses which are referenced by the import table have not been tampered with. If the import table 312 is improperly modified, a procedure call to a selected function could be rerouted to an untrusted routine other than the routine intended by the provider of the executable image 100' Such an untrusted routine could accidentally or deliberately return false or other injurious data to the executable image 100.<br>
Figure 5 is a flowchart illustrating a process for verifying the authenticity of the executable image 100. Starting at a state 600, the validator 204 (Figure 2J receives a request for determining the authenticity of the executable module 100 (Figure 1). In one embodiment of the invention, the request is generated by the program loader 208. In another embodiment of the invention, the request is generated by the operating system 95 (Figure 1). In yet another embodiment of the invention, the request is generated by an executable image (not shown) executing on the computer 90 (Figure 1). In yet another embodiment of the invention, the request is generated by a routine in the validator 204.<br>
Continuing to a state 604, the validator 204 (Figure 2) identifies each of the pointers within the executable image 100 that are in need of fixing-up. In one embodiment of the invention, if the authenticity of only selected sections in the executable image 100 are to be determined, the validator 204 identifies only those pointers that fall within the selected sections of the executable image 100. For example, the validator 204 can be configured to identify only those pointers that fall within the code section 304 [Figure 3) or the import table 312 {Figure 3).<br>
In one embodiment of the invention, the validator 204 parses the relocation table 316 to identify each of these pointers (Figure 3). As discussed above with reference to Figure 3, the relocation table 316 identifies the location of an address relative to the base of the executable image 100. By examining the relocation table 316, the validator 204 can identify which portions of code section 304 are modified by the program loader 208 during loading.<br>
Continuing to a state 608, the validator 204 (Figure 2) generates s reference digital signature with respect to the executable image 100 (Figure 1). A digital signature as used herein is defined to include any methodology for identifying the contents of a selected set of data. In its simplest form, a digital signature can include a complete copy of the selected set of data that is to be signed. However, the digital signature can also include the results of a hashing function that has been applied to the selected set of data. Further, a digital signature can be a digital certificate. It is to be appreciated by the skilled technologist that one of any of a number of standard hashing functions may be used to generate the reference digital signature.<br><br>
-   8   -<br>
Still referring to the state 608, in one embodiment of the invention, the validator 204 determines the reference digital signature based upon the contents of the entire executable image 100 excluding any addresses that are in need of fixing-up by the program loader 208 (Figure 2). In another embodiment of the invention, the validator 204 determines a reference digital signature based upon the content of selected sections, such as the code section 304 and/or the import table 312 excluding any of the addresses that are in need of fixtng-up by the program loader 208.<br>
Proceeding to a state 612, the validator 204 (Figure 2] stores the reference digital signature for later retrieval. In one embodiment of the invention, the validator 204 stores the reference digital signature in the storage device 105 (Figure 1}. In another embodiment of the invention, the validator 204 stores the reference digital signature in a selected section of the executable image 100, such as a resource table {not shown). In yet another embodiment of the invention, the reference digital signature is appended to the executable image 100. In yet another embodiment of the invention, the reference digital signature is stored in a database, a web server, or on the network 122 (Figure 1). In yet another embodiment of the invention, the reference digital signature is created before the executable image 100 is provided to the computer 90. In this embodiment, the reference digital signature can be generated in any of the above described ways.<br>
Next, at a state 614, the validator 204 (Figure 2) determines an authenticity signature of the executable image 100 after or before the executable image 100 has been loaded by the program loader 208 into the memory 108 (Figure 2). At this step, the validator 204 reapplies the hashing function that was applied by the validator 204 during the state 608. The validator 204 can be configured to determine the authenticity digital signature upon the occurrence of one or more selected conditions, such as: the expiration of a timer, an authenticity self test of the executable image 100, an idle time of the computer 90 (Figure 7}, or upon a request of the executable image 100.<br>
Continuing to a decision state 618, the validator 204 (Figure 2) determines whether the reference digital signature (generated tn the state 608) matches the authenticity digital signature (generated in the state 614). If the reference digital signature does not match the authenticity digital signature, the validator 204 proceeds to a state 622, wherein the validator 204 initiates a security alert. At the state 622, the validator 204 may perform a plurality of functions such as: unload the executable image 100, load a new copy of the executable image 100 from the storage 105 {Figure 1) to the memory 108 (Figure 1), load a new version of the executable image 100 from the network 122, delete the executable image 100 from the storage 105, display a warning to a user residing at the computer 90 (Figure 1), transmit an error message to a remote computer {not shown} via the network 122, or undo one or more actions performed by the executable image 100.<br>
Referring again to the decision state 618, if the validator 204 (Figure 2) determines that the reference digital signature matches the authenticity digital signature, the validator 204 proceeds to an end state 624. Depending on the embodiment, the validator 204 (Figure 2) may return to the state 614 to re-determine the authenticity digital signature upon the occurrence of the selected conditions.<br><br>
-   9<br>
Figure 6 is a flowchart illustrating another process performed by the validator 204 of Figure 2 during an authenticity check of one of the executable images shown in Figure 2. The process performed by Figure 6 is distinct from the process performed by Figure 5 and can be performed in isolation or in conjunction with the processes performed by Figure 5. In particular, Figure B illustrates a process for verifying that each of the pointers in the executable image are bound to a proper location. The following text describes an authenticity check process with respect to import pointers in the code section 304 and export pointers in the import table 312 of the executable image 100. However, it is to be appreciated by the skilled technologist, that a similar process can be employed with respect to other types of pointers in the executable image 100.<br>
Starting at a state 700, the validator 204 (Figure 2) receives a request from a requestor for determining the authenticity of the executable module 100 (Figure 1). In one embodiment of the invention, the requestor is the program loader 208 (Figure 2). In another embodiment of the invention, the requestor is the operating system 95 (Figure 1). In yet another embodiment of the invention, the requestor is an executable image (not shown) executing on the computer 90 (Figure 1). In yet another embodiment of the invention, the requestor is a routine within the validator 204. Further, the request can be initiated by one of the requestors upon the occurrence of one or more selected conditions which include: the expiration of a timer, the detection of an idle time with respect to the computer 90 (Figure 1), and/or before the execution of a critical action, such as a bank transaction.<br>
Continuing to a state 704, the validator 204 (Figure 2) identifies each of the import pointers in the code section 304. In one embodiment of the invention, the validator 204 parses the relocation table 316 to identify each of these import pointers (Figure 3).<br>
Next, at a state 708, the validator 204 (Figure 2) examines each of the import pointers in the code section 320 to determine whether each of the import pointer;; are bound to locations that are within the import table 312. At this state, in one embodiment of the invention, the validator 204 reads the header 300 to determine the begin and end address of the import table 312.<br>
If each of the import pointers are not bound to a location that is within the import table 312 [Figure 3), the validator 204 (Figure 2) proceeds to a state 714 wherein the validator 204 initiates a security alert. At the state 714, the validator 204 may perform a plurality of functions such as: unload the executable image 100, load a new copy of the executable image 100 from the storage 105 (Figure 1) to the memory 108 (Figure 1), load a new copy of the executable image 100, delete the executable image 100 from the storage 105, display a warning to a user residing at the computer 90 (Figure 1), transmit an error message to a remote computer (not shown) via the network 122, or undo one or more actions performed by the executable image 100. The process flow moves to an end state 715 and ends.<br>
Referring again to the decision state 712, if the validator 204 (Figure 2) determines that each of the import pointers within the code section 304 are bound to the import table 312 (Figure 3), the validator 204 proceeds to a state 716. At the state 716, the validator 204 identifies each of the external pointers in the import tabfe 312.<br><br>
-   10   -<br>
Proceeding to a stale 720, the validaior 204 (Figure 2) determines the binding locations Df the external pointers in the import table 312 (Figure 2}. In one embodiment of the invention, the validator 204 stores the binding locations in an externa! pointer table [not shown) which is maintained by the validator 204.<br>
Continuing tD a decision state 722, the validator 204 determines whether the binding locations of the external pointers reside wsthsn one of the executable images identified by the import table 312 (Figure 2). For convenience of description, the executable images identified by the import table 312 are collectively referred to as the exporting executable images.<br>
In one embodiment of the invention, the validator 204 calls the operating system 95 [Figure 1) to determine the locations of the exporting executable images withm the memory 108 {Figure 1). For example, Windows 95 provides a procedure call named "GetModuleHandleO" which returns the base address of an executable image given the name of the executable image. Using the base addsess, the validator 204 can identify locations of the header as well as the other sections of the exporting executable images.<br>
Still referring to the state 722, if the validator 204 determines that each of the external pointers are not bound to the exporting executable images, the validator 204 proceeds to the state 714 which is described in further detail above. However, if the validator 204 determines that each of the external pointers are bound to the exporting executable images, the validator 204 proceeds to the end state 715 and ends.<br>
Advantageously, the present invention ellows for static, dynamic, and run-time verification of the authenticity of executable images and does not require changes to either the source or the object code of an executable image. The present invention ensures that an executable image is authentic and has not been tampered with after it has loaded. After a reference digital signature is determined, ihe validator 204 can subsequently generate an authenticity digital signature to ensure that the data object has not been modified. Further, the validator 204 can determine whether each of the pointers in the executable image have been bound to a correct location.<br>
For example, with respect to a data pointer in the code section 304, the validator 204 can check the relocation table 316 to ensme that the data pointer references a location within the data section 308. Further, for example, with respect to an external pointer in the import table 312, the validator 204 can ensure that the external pointer references a trusted executable image, the name of which is included in the import table 312. Since the name of the executable image is not modified by the program loader 208 (Figure 2), the validator 204 can ensure as well that the name of a trusted executable image has not changed by the use the reference and authenticity digital signatures.<br>
While the above detailed description has shown, described, and pointed out novel features of the invention as applied to various embodiments, it will be understood that various omissions, substitutions, and changes in the form and details of the device or piocess illustrated may be made by those skilled in the art without departing from the spirit of the invention. The scope of the invention is indicated hy the appended claims rather than by the foregoing description. All changes which come within the meaning and range of equivalency of the claims are to be embraced withm their scope.<br><br>
-11-<br>
WE CLAIM :<br>
1.	A system for determining the authenticity of an executable image, the system<br>
comprising :<br>
an executable image one or more pointers that are in need of fixing up by a program loader; and<br>
a validator capable of generating at a first point in time a reference digital signature based upon a selected content of the executable image excluding each of the pointers, wherein the validator generates an authenticity digital signature at a second point in time based upon the selected content of the executable image excluding each of the pointers, and wherein the validator determines whether the reference digital signature matches the authenticity digital signature.<br>
2.	The system as claimed in claim 1, wherein the reference digital signatured<br>
stored within the executable image.<br>
3.	The system as claimed in claim 1, wherein the reference digital signature is<br>
stored on a network.<br>
4.	The system as claimed in claim 1, wherein the reference digital signature is<br>
stored in a database.<br>
5.The system as claimed in claim 1, wherein the reference digital signature is stored in the validator.<br>
6. The system as claimed in claim 1, wherein the first point in time is prior to the executable image being processed by the program loader and wherein the second point in time is subsequent to the executable image being processed by the program loader.<br><br>
-12-<br>
7.	The system as claimed in claim 1, wherein the first point in time is prior to the<br>
executable image being processed by the program loader and wherein the second<br>
point in time is prior to the executable image being processed by the program<br>
loader.<br>
8.	The system as claimed  in claim  1, wherein the first point in time is<br>
subsequent to the executable image being processed by the program loader and<br>
wherein the second point in time is subsequent to the executable image being<br>
processed by the program loader.<br>
9.	The system as claimed in claim 1, wherein the validator generates a warning<br>
upon the determination that the reference digital signature does not match the<br>
authenticity digital signature.<br>
10.	The system as claimed in claim 1, wherein the validator generates a warning<br>
to a source of the executable image upon the determination that the reference<br>
digital signature does not match the authenticity digital signature.<br>
11.	The system as claimed in claim 1, wherein the validator generates a warning<br>
to a source of the validator upon the determination that the reference digital<br>
signature does not match the authenticity digital signature.<br>
12.	The system as claimed in claim 1, wherein the selected content comprises a<br>
code section and one or more of the pointers that reference an import table that is<br>
in the executable image.<br><br>
-13-<br>
13.	The system as claimed in claim 1, wherein the selected content comprises an<br>
import table and one or more of the pointers that reference an address in another<br>
executable image.<br>
14.	A system for determining the authenticity of an executable image, the system<br>
comprising:<br>
an executable image having one or more pointers that are in need of fixing -up by a program loader, wherein the executable image has information.specifying whether each of the pointers references locations that are within the executable image; and<br>
a validator capable of determining whether.each of the pointers references a respective location that is within the executable image.<br>
15.	The system as claimed in claim 14, wherein the pointers reference an import<br>
table that is in the executable image.<br>
16.	The system as claimed in claim 14, wherein the validator generates a<br>
warning upon the determination that the pointers do not reference a location within<br>
the executable image.<br>
17.	The system as claimed in claim 14, wherein the validator generates a<br>
warning to a source of the executable image upon the determination that the<br>
pointers do not reference a location within the executable image.<br>
18.	A system for determining the authenticity of an executable image, the system<br>
comprising :<br>
a first executable image;<br><br>
-14-<br>
a second executable image that has a pointer in need of fixing-up by a program loader, wherein the pointer references a location within the first executable image; and<br>
a validator capable of determining whether the pointer references a location within the first executable image.<br>
19.	The system as claimed in claim 18, wherein the validator generates a<br>
warning upon the determination that the pointer does, not reference a location within<br>
the first executable image.	<br><br><br>
20.	The system as claimed in claim 18, wherein the validator generates a<br>
warning to a provider of the executable image upon the determination that the<br>
pointer does not reference a location within the first executable image.<br><br>
21.	The system as claimed in claim 18, wherein the validator determines whether<br>
the pointer references a location within the first executable image by :<br>
requesting from an operating system the base address of the first executable image;<br>
reading a pre-defined header that is in the beginning of the first executable image, the header specifying a beginning and an end address for the first executable image; and<br>
determining whether the pointer references a location within the first executable image as specified by the pre-defined header.<br>
22.	A system for determining the authenticity of an executable image, the system<br>
comprising :<br>
a first executable image loadable into a memory ;<br><br>
-15-<br>
a second executable image loadable into the memory, comprising :<br>
an import table having the identifier of the first executable image and one or more external pointers, each of the external pointers referencing a location within the first executable image ; and<br>
a code section containing machine code and one or more import pointers, each of the import pointers referencing a location within the import table ; and<br>
a validator capable of generating at a first point in time a reference digital signature based upon a selected content of the executable image, the selected content excluding each of the import pointers and the external pointers, wherein the validator generates an authenticity digital signature at a second point in time based upon the selected content of the executable image "excluding each of the one or more pointers, wherein the validator determines whether the reference digital signature matches the authenticity digital signature, and wherein the validator determines whether each of the import pointers reference a location within the first executable image.<br>
23. A method of determining the authenticity of an executable image, the method comprising:<br>
identifying one or more locations within the executable image, each of the identified locations being modified by a program loader;<br>
generating a reference digital signature based upon a selected content of the executable image excluding the one or more identified locations ;<br>
generating an authenticity digital signature based upon the selected content of the executable image excluding the one or more identified locations ; and<br>
determining whether the authenticity digital signature matches the reference digital signature.<br><br>
-16-<br>
24.	The method as claimed in claim 23, comprising generating a warning upon<br>
the determination that the authenticity digital  signature does  not match the<br>
reference digital signature.<br>
25.	The method as claimed in claim 23, comprising generating a warning to a<br>
provider of the executable image upon the determination that the authenticity digital<br>
signature does not match the reference digital signature.<br>
26.	The method as claimed in claim 23, wherein the selected content comprises<br>
the entire executable image.<br>
27.	The method as claimed in claim 23, wherein trie-selected content comprises<br>
a section of machine code.<br>
28.	The method as claimed in claim 23, wherein the selected content comprises<br>
an import table that can reside in the executable image.<br>
29.	A method of determining the authenticity of an executable image, the method<br>
comprising :<br>
identifying one or more locations within an executable image that has been loaded into a memory, each of the identified locations having a pointer in need of fixing-up that has been bound to a selected address in the memory by a program loader; and<br>
determining whether each of the pointers at the identified locations reference a destination that is specified by the executable image.<br>
30.	The method as claimed in claim 29, wherein the destination is an address in<br>
an import table that can reside in the executable image.<br><br>
-17-<br>
31.	The method as claimed in claim 29, wherein the destination is an address in<br>
another executable image.<br>
32.	A system for determining the authenticity of an executable image, the system<br>
comprising :<br>
means for identifying one or more locations within an executable image that has been loaded in to a memory, each of the identified locations having a pointer in need of fixing-up that has been bound to a selected address in the memory by a program loader, and<br>
means for determining whether each of the pointers at the identified locations reference a destination that is specified by the executable'image.<br>
33.	The system as claimed in claim 32, wherein the destination is an address in<br>
an import table that can reside in the executable image.<br>
34.	The system as claimed in claim 32, wherein the destination is an address in<br>
another executable image.<br>
35.	A   system   for   determining   the   authenticity   of   an   executable   image,<br>
substantially as herein described, particularly with reference to and as illustrated in<br>
the accompanying drawings.<br>
36.	A   method   of   determining   the   authenticity   of   an   executable   image,<br>
substantially as herein described, particularly with reference to the accompanying<br>
drawings.<br>
System and method for verifying the integrity of executable images (100) The system includes a run-time validator (204) that determines a reference digital signature (604) for an executable using the contents of the digital signature excluding those portions of the executable that are fixed-up by a program loader (208). The run-time validator (204) then subsequent to the loading of the executable image determines an integrity digital signature (614)to verify that the executable image (100) has not been improperly modified. In addition, the run-time validator (204) ensures that each of the pointers in the executable image(l00) have not been improperly redirected.</td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAwNzAta29sbnAtMjAwMyBhYnN0cmFjdC5wZGY=" target="_blank" style="word-wrap:break-word;">00070-kolnp-2003 abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAwNzAta29sbnAtMjAwMyBjbGFpbXMucGRm" target="_blank" style="word-wrap:break-word;">00070-kolnp-2003 claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAwNzAta29sbnAtMjAwMyBjb3JyZXNwb25kZW5jZS5wZGY=" target="_blank" style="word-wrap:break-word;">00070-kolnp-2003 correspondence.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAwNzAta29sbnAtMjAwMyBkZXNjcmlwdGlvbihjb21wbGV0ZSkucGRm" target="_blank" style="word-wrap:break-word;">00070-kolnp-2003 description(complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAwNzAta29sbnAtMjAwMyBkcmF3aW5ncy5wZGY=" target="_blank" style="word-wrap:break-word;">00070-kolnp-2003 drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAwNzAta29sbnAtMjAwMyBmb3JtLTEucGRm" target="_blank" style="word-wrap:break-word;">00070-kolnp-2003 form-1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAwNzAta29sbnAtMjAwMyBmb3JtLTE4LnBkZg==" target="_blank" style="word-wrap:break-word;">00070-kolnp-2003 form-18.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAwNzAta29sbnAtMjAwMyBmb3JtLTMucGRm" target="_blank" style="word-wrap:break-word;">00070-kolnp-2003 form-3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAwNzAta29sbnAtMjAwMyBmb3JtLTUucGRm" target="_blank" style="word-wrap:break-word;">00070-kolnp-2003 form-5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAwNzAta29sbnAtMjAwMyBnLnAuYS5wZGY=" target="_blank" style="word-wrap:break-word;">00070-kolnp-2003 g.p.a.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAwNzAta29sbnAtMjAwMyBsZXR0ZXJzIHBhdGVudC5wZGY=" target="_blank" style="word-wrap:break-word;">00070-kolnp-2003 letters patent.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MDAwNzAta29sbnAtMjAwMyByZXBseSBmLmUuci5wZGY=" target="_blank" style="word-wrap:break-word;">00070-kolnp-2003 reply f.e.r.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAtS09MTlAtMjAwMy1GT1JNLTI3LnBkZg==" target="_blank" style="word-wrap:break-word;">70-KOLNP-2003-FORM-27.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAta29sbnAtMjAwMy1ncmFudGVkLWFic3RyYWN0LnBkZg==" target="_blank" style="word-wrap:break-word;">70-kolnp-2003-granted-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAta29sbnAtMjAwMy1ncmFudGVkLWNsYWltcy5wZGY=" target="_blank" style="word-wrap:break-word;">70-kolnp-2003-granted-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAta29sbnAtMjAwMy1ncmFudGVkLWRlc2NyaXB0aW9uIChjb21wbGV0ZSkucGRm" target="_blank" style="word-wrap:break-word;">70-kolnp-2003-granted-description (complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAta29sbnAtMjAwMy1ncmFudGVkLWRyYXdpbmdzLnBkZg==" target="_blank" style="word-wrap:break-word;">70-kolnp-2003-granted-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=NzAta29sbnAtMjAwMy1ncmFudGVkLXNwZWNpZmljYXRpb24ucGRm" target="_blank" style="word-wrap:break-word;">70-kolnp-2003-granted-specification.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="207828-multiple-tier-array-capacitor-and-methods-of-fabrication-therefor.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="207830-a-crew-management-system-for-distributing-a-work-order-to-a-geographically-distributed-field-crew.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>207829</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>70/KOLNP/2003</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>26/2007</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>29-Jun-2007</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>28-Jun-2007</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>20-Jan-2003</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>MACROVISION CORPORATION</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>1341 ORLEANS DRIVE SUNNYVALE ,CA-94089</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>BODROV DMITRY</td>
											<td>PMB 137,3525 DEL MAR HEIGHTS ROAD, SAN DIEGO, CA 92310</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>G 06 F 1/00</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/US00/20182</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2000-07-25</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td></td>
									<td></td>
								    <td>NA</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/207829-a-system-and-method-of-determining-the-authenticity-of-an-executable-image by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 04 Apr 2024 22:56:40 GMT -->
</html>
