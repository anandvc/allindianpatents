<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/260508-method-for-automatically-delleting-records-stored-in-a-data-structure-of-a-write-once-read-many-storage-system by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 00:33:03 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 260508:&quot;METHOD FOR AUTOMATICALLY DELLETING RECORDS STORED IN A DATA STRUCTURE OF A WRITE-ONCE-READ-MANY STORAGE SYSTEM&quot;</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">&quot;METHOD FOR AUTOMATICALLY DELLETING RECORDS STORED IN A DATA STRUCTURE OF A WRITE-ONCE-READ-MANY STORAGE SYSTEM&quot;</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>A method for automatically deleting records stored in a data structure of a write-once-read-many (WORM) storage system, where the data structure in the WORM storage system is stored across one or more rewritable storage devices (160), comprising establishing retention dates (505, 605) for predetermined records in the data structure; characterized by the steps of scanning the data structure and comparing (1504) the retention dates to a time value of a trusted clock (279), the trusted clock providing a reliable time, thereby enhancing tamper-proof operation of the storage system; and automatically deleting (1510) each of the records with a retention date that is equal to or earlier than the trusted clock time. Fig 2</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>SYSTEM AND METHOD FOR RECORD RETENTION DATE IN A WRITE ONCE READ MANY STORAGE SYSTEM<br>
RELATED APPLICATIONS<br>
This application is related to U.S. Patent Application Serial No. 10/391,245 entitled WRITE-ONCE-READ-MAKY STORAGE SYSTEM AND METHOD FOR IMPLEMENTING THE SAME, by William P. McGovem, etdt,. the tenchings of which are expressly incorporated herein by reference.<br>
FIELD OF THE INVENTION<br>
This invention relates to data storage systems having write-once-read-many capabilities for enhanced data integrity.<br>
BACKGROUND OF THE INVENTION<br>
A file server is a computer that provides file service relating to the organization of information on storage devices, such as disks. The file server or filer includes a storage operating system that implements a file system to logically organise the information as a hierarchical structure of directories and files on the disks. Each "on-disk" file may be implemented as a set of data structures., e.g., disk blocks, configured to store information. A directory, on the other hand, may be implemented as G specially formatted file in which information about other files and directories are stored.<br>
 A filer may be further configured to operate according to a client/server model of information delivery to thereby allow many clients to access files stored on a server, e.g., the filer. In this model, the client may comprise an application, much as a database application, executing on a computer that "connects" to the filer over a direct connection or computer network, such as a point-to-point link, shared local area network (LAN), wide area network (WAN), or virtual private network (VPN) implemented over ( a public network such as the Internet. Each client may request the services of the file system on the filer by issuing file system protocol messages (hi the farm of packets) to the filer over the network.<br><br>
A common type of file system is a "write in-place" file system, an example of which is the conventional Berkeley fast file system. By "file system" it is meant generally a structuring of data and metadata on a storage device, such as diste, which permits reading/writing of data on those disks. In a write in-place file system, the locations of the data structures, such as inodes and data blocks, on disk are typically fixed. An inode is a data structure used to store information, such as metadata, about a file, whereas the data blocks are structures used to store the actual data for the file. The information contained in an inode may include, e.g., ownership of the file, access permis-<br>
!<br>
sion for the file, size of the file, fife type and references to locations on disk of the data blocks for the file. The references to the locations of the file data are provided by pointers in the inode, which may farther reference indirect blocks thar in turn, refer-<br><br>
ence 'the data blocks, depending upon the quantity of data in the file. Changes to the inodes and data blocks are made "in-place" in accordance with the write in-place file . system. If an update to a file extends the quantity of data for the file, an additional data block is allocated and the appropriate inode is updated to reference that data block.<br>
Another type of file system is a write-anywhere file system that does not overwrite date on disks. If a data block on disk is retrieved (read) from disk into memory<br>
I	|<br>
and "dirtied" with new data, the data block is stored (written) to a new location on disk to thereby optimize write performance. A write-anywhere file system may initially assume an optimal layout such that the data is substantially contiguously arranged on disks. The optimal disk layout results in efficient access operations, particularly for sequential read operations, directed to the disks. A particular example of a write-anywhere file system that is configured to operate on a filer is the Write Anywhere File Layoput (WAFL™) file system available from Network Appliance, Inc. of Sunnyvale, California. The WAFL file system is implemented within a microbsrael as part of the overall protocol stack of the filer and associated disk storage. This microkernel is supplied as part of Network Appliance's Data ONTAP™ software, residing on the filer, that processes file-service requests from network-attached clients.<br>
As used herein, the term "storage operating system" generally refers to the computer-executable code operable, on a computer that manages data access and may, in the case of a filer, implement file system semantics, such as the Data ONTAP™<br>
storage operating system, implemented as a microkernel, and available from Network Appliance, Inc. of Sunnyvale, California, which implements a Write Anywhere File Layout (WAFL™) file system. The storage operating system can also be implemented as an application program operating over a general-purpose operating system, such as UNIX® or Windows NT®, or as a general-purpose operating system with configurable functionality, which is configured for storage applications as described herein.<br>
Disk storage is typically implemented as one or more storage 'volumes" that comprise physical storage disks, defining an overall logical arrangement of storage space. Currently available filer implementations can serve a large number of discrete volumes (150 or more, lor example). Bach volume is associated with its own file system and, for purposes hereof; volume and file system shall generally lie used synonymously. The disks within a volume are typically organized as one or more groups of Redundant Array of Independent (or Inexpensive) Disks (RAID). RAID implementations enhance the reliability/integrity of data storage through the redundant writing of data "stripes" across a given number of physical disks in the RAID group, and the appropriate caching of parity information with respect to the striped data. In the example of a WAFL file system, a RAID 4 implementation is advantageously employed. This implementation specifically entails the striping of data across a group of disks, and separate parity caching within a selected disk of the RAID group. As described herein, a volume typically comprises at least one data disk and one associated parity disk (or possibly data/parity partitions in a single disk) arranged according to a RAID 4, or equivalent high-reliability, implementation.<br>
!    Data storage is an increasingly crucial and central part of many industries dealing in financial transactions and other sensitive tasks, such as banks, government facili-ties/contractors, defense, health care institutions, pharmaceutical companies and securities brokerages. In many of these environments, ft is necessary to store selected data in an immutable and unalterable manner. This need continues to grow in the light of current concerns over institutional fraud and mismanagement, wherein the temptation on the part of wrongdoers to erase or after incriminating data is always present Forms of data that require immutable treatment often include e-mails, financial documents and transaction records, and any other record that may act as proof of an important action or<br><br>
decision. Even in less-critical/unregulated environments, the ability to store a secure unalterable data cache is highly desirable. For example engineering, medical, law and other professional firms may wish to establish a cache of key data (e.g. invention reports or design files, client communications, medical images, etc.), that will remain unaltered and online for long periods on tune. These caches can provide reliable references and proofs for clients and other interested parties.<br>
For an example of a highly regulated environment, the United. States Securities and Exchange Commission (SEC)—-the body that regulates all securities transactions and reporting relative to public corporations—promulgates SEC Rulo 17a-4 governing document retention for brokers and investment institutions. This rule requires that these entities store e-mails and other documents in connection with a variety of transactions and trades by clients of the entities unchanged and unchangeable for a number of years and to be able to provide these records to the SEC and other regulators on short<br>
i<br>
notice. Failure to comply with these rules can lead to significant sanctions.<br>
A variety of prior art approaches involving tape drives, elects-optical recordable media and the like have been employed over the years to implement a WORM stoitage system. Each of these systems has certain drawbacks in terras of storage size, speed maintenance requirements or a combination of these (and other) factors.<br>
In the above-incorporated-by-reference U.S. Patent application Serial No. 10/391,245 entitled WRITE-ONCE-READ-MANY STORAGE SYSTEM AMD MfiTHOD FOR IMPLEMENTING THE SAME, a particularly advantageous approach to WORM storage is taught, which employs conventional fault-tolerant (e.g. RAID-based) disk storage (or similar rewritable media) as a platform for a WORM storage<br>
system. This described system is advantageous in that such disks are large in storage<br>
capacity, relatively inexpensive and easily added to an existing storage implementation.<br>
However, these disks are also inherently rewritable and/or erasable, in light of existing<br><br>
operating systems and protocols that are typically designed with semantics that specifically enable the free rewriting and erasure of attached disks. The (described WORM storage approach is, therefore, specially configured to absolutely prevent alteration of any WORM-designated data. Also, to maintain longevity of the solution and make it available to as many clients as possible, the described WORM implementation utilizes<br><br>
open protocols such as CIFS and NFS and requires minimal alteration to these protocols or the applications that employ them and a minimal footprint on dent applications. The system is, thus, organized around WORM storage volumes that contain files, which when committed to WORM storage, cannot be deleted or modified. Any file path or directory tree structure used to identify the file within the WORM volume is locked and cannot be deleted.<br>
 In the described WORM system, an administrator creates a WORM volume (or other WORM-designated data organizational structure), capable of storing designated WORM files (or other "data sets"). The client men creates an appropriate WORM file using: the appropriate protocol semantics. The file is written to the volume and committed to WORM state by transhioning the file attributes from a not-r sad-only state to a read-only state. The file system persistently stores the WORM state of a file with the attributes and metadata for the file and uses this persistent WORM state to recognize WORM files on a WORM volume. Henceforth, any attempt to modily the file attributes, write to the file, or delete the file, by clients, administrators or o ther entities is rejected and a request denied message is returned to the attempting party. Since the file cannot be deleted, conventional file system semantics prevent deletion of the directory path: Likewise, the file system does not permit renaming of directories in an illustrative embodiment to thereby ensure the reliable and immutable identification of WORM files within the directory structure.<br>
Committing of the WORM file to the WORM storage volume can be performed by the client via a command line interface in an interactive manner. Alternatively, applications, which are familiar with the WORM semantics, can be adapted to commit the file using an appropriate application program interface or other programmatic command structure. Similarly, open protocols, such as NFS or CIFS, through which the<br><br>
clients communicate with the file server/file system can be modified, to enable auto-<br><br>
matic commit of created files upon a key event, such as closing of the file. The protocols and file system can be adapted to enable specialized WORM directories within the volume. An appropriate WORM file extension can be provided so "hat worm files<br>
i<br>
within the volume can be readily identified by the client Also, selected mirroring and<br><br>
backup functions may be allowed, while other backup functions that enable restoration or reversion of the volume to an earlier point in time may be disabled.<br>
Many regulatory schemes governing WORM data storage (for example SEC 240.17a-4) specify provisions for retention periods, after which the WORM data can be discarded. In the absence of a specified retention period, applied to the record on creation, tiie regulations generally specify permanent retention. in the case of removable media, such as tapes or electro-optical storage, the media are carefully indexed and stored (often in secure sites) during their retention periods. Upon expiration of an applicable retention date, the expired media is retrieved from storage and physically destroyed. Since, disk storage has the inherent ability to be rewritten and reused when a particular record is no longer needed, it is contemplated that the WORM protection on various on-disk records may carry a retention date, and when the retention date passes, the expired WORM record and associated data may be erased, thus preserving storage resources and ensuring the orderly and predictable removal of expired WORM data—without the material waste evoked by physical media destructioa<br>
One commercially available WORM storage system marketed under the trade-name Centers from EMC Corp. of Hopkinton, MA enables basic fonns of retention dates for record storage. the system utilizes a network-connected cluster of general-purpose computer systems running a customized variant of the Linux, operating system. A proprietary application programming interface (API) and proprietary protocols for interfacing with the storage system, as opposed to the open protocol and open standardized API approach is implemented by these computers. As such, applications can onl)| access the storage and manipulate records through proprietary Mechanisms or through a "gateway" interposed between the users and the storage system, which translates an open protocol to the proprietary protocols supported by the storage system,<br>
I    This form of WORM storage system utilizes, so-called "Content Addressable<br><br>
Storage," (CAS) for management of stored records. CAS relies on computing digital signatures;, using an algorithm such as an MD5 hash, of the contents of any WORM-stored records to create a unique key (of "content address") for each and every record. A representation of the digital signature of a record is used as the "key," or "content address," with which any future reference to the stored object must be made. This is<br>
often described as similar to a "claim check" system whereby the storage system generates a unique key for every object stored, which it returns to the application. The application is responsible for management and preservation of these content addresses, which must be performed external to the storage system.<br>
To associate retention information with a stored record, the proprietary API permits metadata, in a proprietary format, to be associated with a stored object This metadata information can include retention information for the record The API supports the ability to extend retention dates further into the future, and in certain configurations, to assign an infinite retention date to those records submitted without retention information. Because of the CAS architecture, every object written to the system, as long as it has unique contents, is stored as a unique object with a unique content address,  To enable WORM functionality the API prevents deletion of objects prior to the expiration of their associated retention period. Modification of existing objects is fan-possible because any changes in the contents of an object will result in a new content address, and hence a new object being created in the storage system.<br>
To track retention time and other tune-dependent functions, this system is believed to simply draw time values from the system hardware clocks within the nodes (computers) of the cluster for time reference and rely on the physical security of the stem to prevent tampering. SUMMARY OF THE INVENTION<br>
This invention overcomes the disadvantages of the prior art by providing a specified retention date within a data set that is locked against deletio a or modification within a WORM storage implementation. This retention date scheme does not utilize any proprietary application program interfaces (APIs) or protocols, but rather, employs native functionality within conventional file (or other data containers, data sets or<br>
r	k<br>
block-based logical unit numbers) properties available in commonly used operating systems. In an illustrative embodiment  the retention date/time is calculated by query* rag the file's last-modified time prior to commit, adding the retenrior, period to this value and thereby deriving a retention date after which the file can bo released from<br>
*<br>
WORM. Prior to commit, the computed retention date is stored in the file's "last ac-<br>
cess time" property/attribute field, or another metadata field (typically open protocol-based) that remains permanently associated with the file end that, in bsing used for retention date, does not interfere with file management in a WORM state. Since this field is non-essential and rarely utilized in a WORM context, it can be adapted to store this date. Once stored, the retention date in this field is locked against modification. Where extension (never reduction) of a retention period is desired, the last access time field be updated, wherein the retention period extension is added to the existing last access time value to derive a new, later retention date for the file, Upon expiry of the retention date^ the system allows deletion of the expired WORM file/data set.<br>
The procedure checks whether the retention date provided by the administrator, user or interface is allowed by a particular set of WORM rules governing a volume. To this end, there may be more than one set of WORM rules applicable to a storage system. For storage requiring strict (government regulatory, for example) compliance, a strict or regulatory WORM volume may be employed. Storage in this volume is subjected to strict minimum default retention periods or, in the absence of a specified period, infinite periods. No modification or deletion of files is permitted until an applicable retention date expires. (Conversely an "enterprise" volume, defined under a trusted administrator model may permit flexible setting of retention dates and/or no date as a defeult. Likewise, enterprise volumes may enable restoration from in earlier image of<br>
!<br>
the file/volume, or destruction of a volume where appropriate.<br>
:     In an illustrative embodiment, a secure compliance clock is jsed to gauge the time relative to the retention period. In one embodiment this clock uses a trusted time-base, such as a repetitive file server process to derive its time value The clock is tarn-per-proof, and its time value is guaranteed to be no sooner that actual time, but may be slightly longer to further ensure observance of the full retention period. In other embodiments, the clock can be based upon a trusted third-party clock {such as a govern-mdnt-based clock) or an additional secure hardware-based clock.<br>
The stored retention date/time can overcome certain limitations in bit range for older open protocols by providing a base time date (epoch) that is i datively contemporary with the present day.   The available date range under such bit range limitations can be extended generally by redefining the epoch (base time) to which the time value<br>
is relative. The identical format is used for dates within the epoch while wrap-around encoding of the date (e.g. using dates before the epoch as an extended range) for values appearing within the extended date range.<br>
BRIEF DESCRIPTION OF THE DRAWINGS<br>
The above and farther advantages of the invention may be bet:er understood by referring to the following description in conjunction with the accompanying drawings in which like reference numerals indicate identical or functionally similar elements:<br>
Fig. I is a schematic block diagram defining an exemplary network and file<br>
server environment including a file server and associated clients within which the prin<br>
ciples of this invention are implemented;	<br>
Fig. 2 is a schematic block diagram of an exemplary storage operating system in accordance with an illustrative embodiment of the present invention;<br>
Fig. 3 is a flow diagram of a WORM volume creation procedure according to an illustrative embodiment of the present invention;<br>
Fig. 4 is a schematic diagram of a directory tree showing an oxemplary WORM file pathway;<br>
Fig. 5 is a flow diagram of a WORM file creation and commit procedure for a Windows® client according to an illustrative embodiment of the present invention;<br>
Fig. 6 is a flow diagram of a WORM file creation and commit procedure for a Unix® client according to an illustrative embodiment of the present invention;<br>
Fig. 7 is a schematic diagram of a synchronous mirroring procedure according to an illustrative embodiment of the present invention;<br>
;     Fig. 8 is a schematic diagram of an asynchronous mirroring procedure according to an illustrative embodiment of the present invention; i<br>
'     Fig. 9 is a schematic representation of a generic header for 8 data format used in the asynchronous mirroring procedure of Fig. 8;<br>
Fig. 10 is a schematic representation of a WORM flag for a data file transmitted in accordance with the asynchronous mirroring procedure of Fig. 9;Fig. 11 is a flow diagram of a retention date/time setting procedure SOT WORM <br>
files according to an illustrative embodiment of this invention;<br>
Fig. 12 is a flow diagram of a procedure for extending a retention date/time in a committed WORM file according to an illustrative embodiment of this invention;<br>
Fig. 13 is a timeline for illustrating an exemplary technique for extending the available retention date range for certain open protocols having a limited bit range for dates according to one embodiment of this invention;<br>
Fig. 14 is a schematic representation of an exemplary secure compliance clock for use in tracking retention dates/times according to one embodiment of this invention; and<br>
Fig. 15 is a flow diagram of a procedure for determining expinition of a retention date/time of a subject file and unlocking WORM certain restrictions on the subject Hie according to an illustrative embodiment of this invention.<br>
DETAILED DESCRIPTION OF ANILLUSTRATIVE<br>
EMBODIMENT<br>
A.       Network and File Server Environment<br>
By way of farther background, Fig. I is a schematic block diagram of a storage system environment 100 that includes a file server 112 that may be a ivantageously used with the present invention. For the purposes of this description, the source system is a networked computer that manages storage of one or more storage disks 160 (can't find 162 in Fig 1).<br>
The file server or "filer" 112 manages one or more volumes 115 and 116, comprising arrays of disks 160. Hie filer 112 is linked to a network 118 that can comprise a Ideal or wide area network, such as the well-known Internet An appropriate network adapter 130 facilitates communication over the network 118. The filer 112 generally comprises a processor 120, a memory 125, a network adapter 130 and a storage adapter 140 interconnected by a system bus 145. Filer 112 also includes a storage op-<br>
r<br>
er4ting system 200 (Fig. 2) that implements a file system to logically organize the information as a hierarchical structure of directories and files on the disks.<br>
It will be understood to those skilled in the art that the inventive technique described herein may apply to any type of special-purpose computer (e.g., file serving appliance) or general-purpose computer, including a standalone computer, embodied as a storage system. To that end, the filer 112 can be broadly, and alternatively, referred to<br>
-lias a storage system. Moreover, the teachings of this invention can be adapted to a variety of storage system architectures including, but not limited to, a network-attached storage environment, a storage area network and disk assembly directly-attached to a client/host computer. The term "storage system" should, therefore, be taken broadly to include such arrangements.<br>
In the illustrative embodiment, the memory 125 comprises storage locations that are addressable by the processor and adapters for storing software program code. The memory comprises a form of random access memory (RAM) that is generally cleared by a power cycle or other reboot operation (i.e., it is "volatile" memory). The processor and adapters may, in rum, comprise processing elements and/or logic circuitry configured to execute the software code and manipulate the data structures. The storage operating system 200, portions of which are typically resident in meraory and executed by the processing elements, functionally organizes the filer by, inter ilia, invoking storage operations in support of a file service implemented by the filer. It will be apparent to those skilled in the art that other processing and memory means, including various computer readable media, may be used for storing and executing program instructions pertaining to the inventive technique described herein.<br>
The network adapter 130 comprises the mechanical, electric*I and signaling circuitry needed to connect the filer 112 to the network 118, which may comprise a point-to-point connection or a shared medium, such as a local area network. A client (170, 172) may interact with the destination filer 112 hi accordance with s. client/server model of information delivery, That is, the client may request the services of the filer, and the filer may return the results of the services requested by clients 170 and 172 by<br>
;•<br>
exchanging packets 155 encapsulating, e.g., the TCP/IP protocol or another network protocol (CIFS 174 and NFS 176, respectively) format over the network 118.<br>
1      The storage adapter 140 cooperates with the operating system 200 (Fig. 2) executing on the filer 112 to access information requested by the client. The information may be stored on the disks 160 that are attached, via the storage adopter 140 to the filer 112 or other node of a storage system as defined herein. The storage adapter 140 includes input/output (I/O) interface circuitry that couples to the disks over an I/O interconnect arrangement, such as a conventional high-performance, .'Fibre Channel serial<br><br>
link topology. The information is retrieved by the storage adapter anc. processed by the processor 120 as part of the snapshot procedure, to be described below, prior to being forwarded over the system bus 145 to the network adapter 130, where the information is formatted into packets and transmitted to the destination server as also described in detail below.<br>
The filer may also be interconnected with one or more clients 170 via the network adapter 130. The clients transmit requests for file service to the fiter 112 respectively, and receive responses to the requests over a LAN or other network (118). Data is transferred between the client 170,172 and the filer 112 using respective data packets defined as an encapsulation of the Common Internet File System (CIFS) protocol (174) or another appropriate protocol, such as NPS (176).<br>
In one exemplary filer implementation, the filer 112 can include a nonvolatile random access memory (NVRAM) 135 that provides fault-tolerant backup of data, enabling the integrity of filer transactions to survive a service interruption based upon a power failure, or other fault The size of the NVRAM depends in pint upon its implementation and function in the file server. It is typically sized sufficiently to log a certain time-based chunk of transactions (for example, several seconds worth). The NVRAM is filled, in parallel with the buffer cache, after each client request is completed, but before the result of the request is returned to the requesting client.<br>
An administrator's console 190 is also provided in an illustrative embodiment for controlling various file server functions and operations. The console 190 can be a client or terminal connected via a dedicated port to the file server, cr it can be networked via the network link 118, and reside at a remote location--potentially a longdistance away from the file server. Certain commands, to be described below, are entered through the console in an illustrative embodiment.<br>
I      In an illustrative embodiment, the disks 160 are arranged into a plurality of volumes, by way of example termed Volume 0 (115) and Volume 1 (116), in which each volume has a file system associated therewith. The volumes 115,116 each include one or more disks 160. In one embodiment, the physical disks 160 are configured into RAID groups. In one embodiment this organization is arranged so that some disks store striped data and some disks store separate parity for the data, in accordance with a<br>
preferred RAID 4 configuration. However, other configurations (e.g. RAID 5 having distributed parity across stripes) are also contemplated. In this embodiment, a minimum of one parity disk and one data disk is employed. However, atypical implementation may include three data and one parity disk per RAID group, and a multiplicity of RAID groups per volume. As will be described below, Volume 0 (115) is a regular storage volume with foil read and write access while Volume 1 (116) is a write-once-read-many (WORM) volume in which selected files cannot be modifif sd, erased or otherwise deleted once they are committed to storage.    .<br>
B.       Storage Operating SystemTo facilitate generalized access to the disks 160, the storage o}ojxerating system 200 (Fig. 2) implements a write-anywhere file system that logically organizes the information as a. hierarchical structure of directories and files on the disks. Bach "on-disk" file may be implemented as a set of disk blocks configured to store information, such as data, whereas the directory may be implemented as a specially fonnatted file hi which references to other files and directories are stored. As noted arid defined above, in the illustrative embodiment described herein, the storage operating system is the NetApp® DataONTAP™ operating system available from Network ..Appliance, Inc., of Sunnyvale, CA that implements the Write Anywhere File Layout (WAFL™) file system. It is expressly contemplated that any appropriate file system cau be used, and as such, where the term "WAFL" is employed, it should be taken broadly to refer to any file system that is otherwise adaptable to the teachings of this invention.<br>
'.    The organization of the preferred storage operating system for each of the exemplary filers is now described briefly. However, h is expressly contemplated that the principles of this invention can be implemented using a variety of alternate storage operating system architectures. As shown in Fig. 2, the exemplary storage operating sys-<br><br>
tern 200 comprises a series of software layers, including a media access layer 205 of network drivers (e.g., an Ethernet driver). The operating system, further includes net-<br><br>
work protocol layers, such as the Internet Protocol (IP) layer 210 and its supporting transport mechanisms, the Transport Control Protocol (TCP) layer 215 and the User Datagram Protocol (UDP) layer 220. A file system protocol layer provides multiprotocol data access and, to that end, includes support for the CIFS protocol 225, the<br>
iSCSIprotocol 224, the NFS protocol 230, the Hypertext Transfer Protocol (HTTP) protocol 235 and other protocols (not shown) that may be open or proprietary in format, such as NFS version 4, etc. In addition, the storage operating system 200 includes a disk storage layer 240 that implements a disk storage protocol, such as a RAID protocol, and a disk driver layer 245, that implements a disk control protocol such as the small computer system interface (SCSI).<br>
Bridging the disk software layers with the network and file system protocol layers is a file system layer 250 of the storage operating system 200. Generally, the file system layer 250 implements a file system having an on-disk format representation that is block-based using, e.g., 4-kilobyte (KB) data blocks and using modes or another data structure to describe the files. Note that while files are implemented in an illustrative embodiment, the term "file" or "files" should be taken broadly to include any type of data organization or "data container" including those used by block-level protocols such as SCSI. The term "data container" will therefore be used interchangeably herein.<br>
In response to transaction requests, the file system generates operations to load (retrieve) the requested data from volumes if it is not resident "in-ca:e", i.e., in the filer's memory 225. If the information is not in memory, the file system layer 250 indexes into the inode file using the inode number to access an appropriate entry and retrieve a volume block number. The file system layer 250 then passes the volume block number to the disk storage (RAID) layer 240, which maps that volume block number to a disk block number and sends the latter to an appropriate driver (for example, an encapsulation of SCSI implemented on a fibre channel disk interconnection) of the disk driver layer 245. The disk driver accesses the disk block number from volumes and loads the requested data in memory 125 for processing by the filer 112 (see Fig. I).<br>
:<br>
Upjtm completion of the request, the filer (and storage operating system) returns a reply, e.gi, a conventional acknowledgement packet defined by the CIFS fpecification, to the client 170 over the respective network connection 172.<br>
It should be noted that the software "path" 270 through the storage operating system layers described above needed to perform data storage access for the client request received at the filer may alternatively be implemented in harctware or a combination of hardware and software. That is, in an alternate embodiment of the invention, the<br>
storage access requestdata path 270 hray be implemented as logic circuitry embodied within a field programmable gate array (FPGA) or an application specific integrated circuit (ASIC). This type of hardware implementation increases the performance of the file service provided by the filer 112 in response to a file system request packet issued by this client 170.<br>
Before continuing with the detailed description of the figures, a brief discussion of baickups is appropriate. In order to improve reliability and facilitate disaster recovery in the event of a failure of 8 filer, 'tis associated disks or some portion of the storage infrastructure, ft is common to "mirror" or replicate some or all of tho underlying data and/or the file system that organizes the data. In one example, a mirror is established and stored at a remote site, making it more likely that recovery is possible in the event of a true disaster that may physically damage the main storage location or its infrastructure (e.g. a flood, power outage, act of war, etc.). The mirror is updated at regular intervals, typically set by an administrator, in an effort to catch the most recent changes to the file system.    One common form of update involves the use of a "snapshot" process in which the active file system at the storage site, consisting of inodes and blocks, is captured and the "snapshot" is transmitted as a whole, over a network (such as the well-known Internet) to the remote storage site. Generally, a snapshot is an ima|;e (typically readonly) of a file system at a point in time, which is stored on the same primary storage device as is the active file system and is accessible by users of the active file system. By: "active file system" it is meant the file system to which current input/output operations are being directed. The primary storage device, e.g., a set of disks, stores the active file system, while a secondary storage, e.g., a tape drive, may be utilized to store backups of the active file system. Once the snapshot is taken (i.e., the image captured) , the active file system is reestablished, leaving the snapshotted venaon in place for possible disaster recovery. Each time a snapshot is taken, the old active file system becomes the new snapshot, and the new active file system carries on, recording any new changes. A set number of snapshots may be retained depending upon various time-based and other criteria.<br>
"Snapshot" is atrademark of Network Appliance, Inc. It is ussd for purposes of this patent to designate a persistent consistency point (CP) image, A ;3ersistent consistency point image (PCPI) is a point-in-time representation of the storage system, and more particularly, of the active file system, stored on a storage device (e.g,, on disk) or in other persistent memory and having a name or other unique identiiier that distinguishes it from other PCPIs taken at other points in time. A PCPI can also include other information (metadata) about the active file system at the particular point in time for which the image is taken. The terms "PCPI" and "snapshot" shaft be used interchangeably through out this patent without derogation of Network Appliance's trademark rights.<br>
A PCPI/snapshotting process is described in further detail in United States Pat-eat Application Serial No. 09/932,578, entitled INSTANT SNAPSHOT by Blake Lewis et al., which is hereby incorporated by reference as though fully set forth herein. In addition, the native SnapshotTMcapabilities of the WAFL file system are further described in TR3002 File System Design for an NFS File Server Applimce by David Hrtz et al, published by Network Appliance, Inc., and in commonly owned II. S, Patent Noi 5,819,292, entitled METHOD FOR MAINTAINING CONSIS'nBOT STATES OF A FILE SYSTEM AND FOR CREATING USER-ACCESSIBLE KEAD-ONLY COPIES OF A FILE SYSTEM by David Hhz et al., which are hereby incorporated by reference.<br>
With renewed reference to Fig. 2, overlying the file system layer 250 is the user interface 285 for the administrator. This can be accessed via the various protocols (CJDFS, NFS, etc.) described above.<br>
Also, overlying the file system layer 250 is a specialized asynchronous volume and sub-volume (or "qtree") snapshot mirroring (or replication) application 290. This application is responsible for the generation of the mirrors at a remote destination storage volume based upon changes in snapshots at the source. The snapshot mirroring application 290 operates outside of the storage access request path 270, as shown by the direct links 292 and 294 to the TCP/DP layers 215,210 and the file system snapshot mechanism (280). This application enables "asynchronous" mirroring of changes in the respective sub-volume. That is mirroring is written incrementally (and not in real-time<br>
with respect to changes occurring on the source sub-volume) to a destination store that can be remote and linked by a network connection. A discussion of asynchronous mirroring at a volume and sub-volume (or q-tree) level is found in U.S. .Patent Application Serial No. 10/100,967, entitled SYSTEM AND METHOD FORT DETERMHSONG CHANGES IN TWO SNAPSHOTS AND FOR TRANSMITTING C3ANGES TO A DESTINATION SNAPSHOT by Michael L. Federwisch, et al., vrhtei is hereby incorporated by reference.<br>
Likewise a synchronous volume snapshot mirroring application 298 acting on the RAID layer is provided. This application provides synchronous (real-time) mirroring to a mirror store in response to &amp; mirror command initiated by an administrator. This mirroring creates a point-in-tune image of the source that copies it as it existed at the time the mirror command is acted upon. Approaches to volume-based remote mirroring of snapshots are described in detail in commonly owned U.S. Patent Application Serial No. 09/127,497, entitled FILE SYSTEM IMAGE TRANSFER by Steven Klei-man, et al. and U.S. Patent Application Serial No. 09/426,409, entitled FILE SYSTEM . IMAGE TRANSFER BETWEEN DISSIMILAR FILE SYSTEMS by Steven Kleiman, et at,, both of which patents are expressly incorporated herein by reference.<br>
Notably, the storage operating system includes a WORM utility 299 that resides generally in the file system layer 250. As will be described in detail below, this WORM utility is responsible for establishing specialized worm volumes 275 in the file system that are differentiated from conventional file system vohimesi 276. These vol-umfcs are carried respectively into the RAID layer as corresponding, differentiated WORM and non-WORM RAID volumes 277 and 278, respectively. Moreover, this utility is responsible for establish WORM files or like "WORM data containers" (e.g. clocks, etc.) within a WORM volume that are non-rewritable and non-erasable/deletable. By action of the utility 299, the respective directory pathways (or other identifying logical organization) of any WORM files/data containers are, likewise locked against deletion so long as a WORM file resides in the path/Tee.<br>
In accordance with an illustrative embodiment, the storage operating system 200 also includes a secure compliance clock 279 that, in an illustrative embodiment, is a oftware-based clock used in connection with the setting, tracking: and enforcement of<br><br>
retention periods on WOBM files as described in detail below. Alternatively, the com-pliance^Iock can be implemented as a fiuther hardware-based clock or a feed from a trusted third party (government-based, for example) clock. As described in detail below, all embodiments of a compliance clock can include mechanisms to thwart tampering and ensure reliability of the output time value.<br>
Before, proceeding with a more detailed description of the illustrative embodiment, the following definitions are provided. The term "data set" or "data container," as noted above, shall refer generally to a file, LUN (logical unit cumber), or any other separately or individually addressable data structure. The term "volume" shall refer to a logical group of data containers. The term "directory" shall refer to tin organizational structure that facilitates access of a given data container through traversal of trees or another logical indexing structure. Likewise the term "pathway" or "path" shall refer to the route taken by the storage operating system through the directory structure in addressing the data container. In addition, it is expressly contemplated that the teachings of this invention can be applies to a variety of storage environments and data types including, but not limited to, file data, database data, block-level data, etc..<br>
C.       WORM Volujne Creation	.<br>
, With reference to the flowchart in Fig. 3, a generalized procedure 300 for creating a WORM volume and the results of its creation is described. Ttiis procedure is implemented typically by the administrator using the administrative console and interface to input the appropriate volume create command The file system is modified to recognize a new semantic relative to the conventional (pre-WORM) volume create command that designates a WORM volume. In step 302 die adramisJxator initially creates fbe WORM volume having some general parameters such as for size in terms of number of disks. In one embodiment this is accomplished by typing in the following exemplary command including the volume name "volname" and the '"-L", the number of disks:<br>
vol create <volname> -L <mnriber ofdisks>.<br>
Next, in step 304, the volume is assigned the requested name (volname) on the file server. As such, it is identified as /voVvobtame. The disks that are associated with<br><br>
the volume are marked with a WORM attribute on their RAID labels in persistent storage so that they are identified as WORM volumes. This may require u modification of the conventional RAID layer structure to account for this added label. While WORM is enforced primarily at the file system layer, this tag serves both to identify the assigned disk as a WORM store. Here, the WORM designation is stored in non-volatile memory in the persistent label of a WORM disk. The label contains identification information regarding the disk that permits the storage operating system to map the disk to particular volumes, and is stored in a standardized location on the disks (for example, the beginning).  In this manner, the WORM designation is maintained on the disk itself containing the WORM file. Additionally, the WORM designation can be stored in NVRAM or other persistent/battery-backup memory structures and to prevent the inadvertent or deliberate destruction of the volume as discussed further below. Note that step 304 does not require user interaction as the volume name is assumed as part of the creation process for WORM volumes. This can be handled internally by the system. In step 306, the volume is then exported (for NFS clients) or shared (for OEFS clients) or otherwise made available for use by outside clients. The export/share step is a conventional process that gives appropriate use permissions to clients. In the example of an NFS client the simplified syntax of a suitable command is:<br>
exporfs [-o options] hol/vlncane Likewise in the example of a CIFS client, the syntax is: cifs shares -add <sharename> hvolvohane<br>
'••     Exports and shares may include appropriate access controls and privileges to clients so that only certain users may access the volume. Permissions are also entered. These generally control what can be done on and to the volume (aside from WORM) functionality. For example it is possible to create a read-only volume, but this would limit future writing to the volume. For example, in contradistinction to a Microsoft Office environment in which in which a user can revoke or release reai-only status, the WORM status is not revocable under any circumstance by a user, administrator or other so as to maintain the integrity of the WORM data.<br>
Finaliy, in step 308, the WORM volume is now on-line and accessible by clients. The WORM functionality is in operation and in force, and the restrictions it imposes are present In one embodiment these restrictions can include:<br>
1.	WORM disables the volume destroy command—in an illustrative embodi<br>
ment WORM volume destruction permitted so that a WORM volume is immutable.<br>
However, it is contemplated that, in the presence of retention dates, described below,<br>
that the volume may be subject to destruction after all retention periods residing on the<br>
volume have expired.<br>
2.	WORM disables conventional restoration of WORM volume or parts thereof<br>
from a snapshot—prevents improper reconstruction from an earlier point-in-time image<br>
that obliterates later modifications to files and WORM files comnritfrid after the point-<br>
in-time.<br>
It should be noted that the WORM principles described herei a can apply in at least two different scenarios, a more strict scenario in which the administrator is un-trusted (a government-regulated scenario) and one established upon the trusted administrator or "enterprise" model. In the case of an enterprise model, specific enterprise WORM volumes may be provided where flexibility exists to perform certain actions prohibited under the stricter model (in stricter-regulated volumes). For example, files enterprise volumes may be subject to restoration from a PCPI, destruction of a volume and flexibility in setting minimum retention periods.<br>
3.	Permissions (Set Attributes command "SETATTR" in NFS) (Set File Infor<br>
mation "TRANS2JSETJFILEJNFORMATION" command in CIFS) require that any<br>
file (or data container) within the volume be a WORM file if it is set to "read-only"<br>
from an initial not-read-only state—the file system layer distills all permissions from<br>
their respective protocols to cause WORM state to be assigned to files which undergo<br>
this not-read-only to read-only transition.<br><br>
4.	Any WORM file modifications (e.g. write, rename, delete (subject to reten<br>
tion dates, below), file attribute change, etc.) within the volume tint modify the state of<br>
the file, including attempted modification of date stamps, read-only status, etc. are re<br>
stricted. If file access/modification is requested the file system first checks the WORM<br>
state of the volume and then the target file's individual WORM state (Ascribed below) is checked before modification is permitted. If the file is WORM, then the modification is restricted, and the file server returns an appropriate file error message such as "read-only" or "access-denied" denying the modification request. As vill be described belowj with reference to the creation and handling of WORM file of retention dates, the setting of a retention date employs the last access time property field, which is set prior to commit. This set value is used to track retention periods for particular files. Upon expiration, other properties, such as deletion of the particular expired file, may be unlocked, allowing limited access for this purpose.<br>
More specifically, in an exemplary CIFS environment, conventional file attributes can include: the hidden file flag, read-only flag, archive flag (set before backup performed but after writing to file), creation timestamp, modification timestamp, access timestamp, access control lists (ACLs) and NT streams. These attributes are typically<br>
i<br>
locked against modification where such modification may allow improper changes to a file.<br>
la the NFS example, conventional file attributes that are locked can include access control and other permissions related to the file owner, group, etc;. NFSv4 has many similar attributes to be locked to those in dFS described above.   ,<br>
5.	Directory renaming is not permitted in a WORM volume in one embodi<br>
ment. This prevents the directory from being altered to potentially misplace a WORM<br>
file, jit is contemplated, in an alternate embodiment, that directory renaming is allowed<br>
as long as the renaming does not misplace any WORM files, however, in many in<br>
stants, the basic rule of preventing directory renaming in a WORM volume reduces,<br>
overhead and increases performance by eliminating the need to check' for the displace<br>
ment of any WORM files in a directory tree whenever a directory retaining command<br>
is entered.<br>
6.	Directory deletion is not permitted where a WORM file is present. As<br>
shown generally in Fig. 4, the committing of a WORM file 402 to a directory tree 400<br>
of a WORM volume makes it immutable and not subject to deletion or modification.<br>
Accordingly, its directory 404 and root (as well as any subdirectories along its path<br>
410) cannot be deleted in accordance with conventional file system semantics. In other<br>
words, if at least one undeleted file remains, the overlying directories cannot be deleted according to accepted file system rules in virtually all file systems. Where such a file system does not explicitly call for this rule, the file system should be overtly modified to restrict WORM filepath deletions. Other non-WORM directories 412 and 414 and their respective files 416 and 418 may be deleted normally according to this embodiment. Note that expiration of the retention period of all files in a given tree enables deletion of these files as described hereinbelow. When all WORM files in a tree are deleted; this thereby enables deletion of the directory as a whole. Alternatively, the operating system may be adapted to recognize expiration of all WORM files in a particular directory, thereby unlocking overall deletion of that directory.<br>
D.       Worm File Creatipn<br>
Once a WORM volume is created by the administrator as described above, ft is available for use by permitted clients. The WORM volume allows all conventional volume operations on non-WORM files and directories (e.g. create directories and files, write to files and delete directories and files) subject to the general restrictions above. In addition, the vohime allows the one-time writing of WORM files and the reading or copying of WORM files. WORM files are specialized files (or data sets/data containers) within the overall WORM volume. In other words, not all files within a volume are necessarily WORM files. WORM files are created by client and file server applications where needed to store or archive information that must remain immutable. One such application may be an e-mail archive program that gathers desired e-mail records on a continuous or periodic basis and stores the records in an archive 51e.<br>
In the example of a client running the well-known Windows®1 operating system (available from Microsoft Corporation of Redmond, WA), the procedure 500 for creation jaf a file and its commitment to WORM is shown in Fig. 5. First, in step 502 the client adds a network share for the WORM volume into which a WORM file is to be stored. In one example, this volume can be named "drive W." This drive then appears in the list of shared drives shown to the client. Next, in step 504 the file is saved to the WORM drive W using standard Windows commands. Once the WORM file is saved or copied onto the appropriate WORM volume, the user is allowed to enter a relevant retention period (step 505). The process for entering and handling such retention peri-<br>
ods is described in detail below. In general, entry of retention dates intc the appropriate attribute of the file is carried out either programmaticaUy using a standard Windows application program interface (API) by the client application that handles storage of the file, or using an available, non-Windows command line utility capable of setting the attribute for the file. Finally, in step 506 the client cafls up the "file properties" dialog and sets the read-only attribute for the WORM file on drive W. The file server's file system recognizes the transition of the file from not-read-only to read-only state and thenceforth designates the file as WOKM and all the above restriction? or modification, changes in attribute, etc. are enforced. Significantly, any subsequent attempt by the, 'client to modify the read-only state of the file is denied, and a permission denied message is returned to the client from the file server. la this manner, the final step 506 is termed the "commit" of the file to WORM, state. For any protocol, this commit step is needed to imbue the file with WORM characteristics.<br>
It should be noted that, in the. illustrative embodiment, the commit process is dependent not simply upon the storage of a read-only file in a WORM volume, but rather the transition of the file within the WORM volume from a not-read-only state to a read-only state. Copy utilities and other file-creating applications thf .t do not transition the file to read-only from a not-read-only state may not render a file its WORM.<br>
While the commit process according to an illustrative embodiment involves the<br>
transition of a file attribute from a not-read-only to a read-only state, it is contemplated<br>
i that'other transitions of other conventional attributes (such as the retaining of a file to a<br>
WORM file-type) or setting of other specialized attributes or metadata can be used to trigger commit. Alternatively, the storage of the data or file (or movement thereof) into a WORM-designated portion or structure of storage (such as a WORM directory) could actjas the trigger for commit<br>
;      In the example of a client running the well-known Unix® operating system, connected to the file server via NFS, the procedure 600 in Fig. 6 outlines the associated WORM file creation and commitment steps. First, in step 602 the WORM volume is mounted using conventional volume-mounting procedures. The exemplary command "mount filer:/vol/volname /worm " can be used. Give an exemplary not-read-only file,<br>
fiele txt to be WORM-stored, the file is then copied (step 604), and the typical command line shell command would be:<br>
t<br>
cpfile.hworm.<br>
This copies the file to the volume as a designated worm file. Once the WORM file is saved or copied onto the appropriate WORM volume, the user is allowed to enter a relevant retention period (step 605), The process for entering and handling such retention periods is described in detail below. After the WORM file is copied and any retention period is set, it must then be committed to WORM in accordance with step 606. Note that the retention period can be set interactively in a Unix system environment by the "touch" command with appropriate options to set the file attributo. A variety of available "touch" utilities, running n a Windows or other platform, cin be used to set the attribute. In the example of setting the last access time attribute, the exemplary command is:<br>
touch-a-t<date><fik>.<br>
;    Commit is then accomplished by removing all write permissions from all owners,; groups and users, thereby transitioning the file from a not-read-only to read-only state, and hence, WORM. The shell exemplary command for removal of permissions would be:<br>
     chmod--w/worm/fik.txt. In a conventional DOS shell, the commit is simply the expression:      Each of the above command line expressions are specifically used in interactive sessions at the client. In other words, the client user physically enters the command and awaits the appropriate response from the file server. These create and commit pro-<br>
cedures can be carried out internally within a program application ;is well. Each well-<br>
	'	•<br>
kriown operating system (Windows, Unix, etc.) supports application-based commit and<br><br>
attribute-change functions. The following function calls would be incorporated in ap-<br>
i        '	'<br>
plication programs to implement WORM. Note that other modifications to applications to recognize the WORM existence (such as changes to graphical user interfaces for the application) may also be required to fully implement WORM functionality. Also, ft is<br><br>
contemplated that WORM volumes are used only with applications tha; recognize and can employ a WORM volume's special properties and modified semantics. Byway of example, the following is a Windows-based C++ (Win32) application jjrbgram interface function call for commit to WORM (e.g. to set "read-only"):<br>
SetFiIeAttributes(<ftle>, FELE_ATTRIBUTE__READONLY) Likewise, for Unix-based systems, the application function call would be: fchmod(<file>t0444)<br>
As should be clear from the above description, the creation of WORM volumes as well as the storage of WORM files (data containers) according to this embodiment requires minimal alteration to the open protocols (CIFS, NFS, etc.), and similarly, minimal alteration of specific applications using the WORM functionality. This is because the majority of new functionality is contained within the file sy stem layer, and that file system layer is adapted to recognize simple modifications to volume-create commands and preexisting file attribute transitions (Le. not-read-only to read-only) to implement WORM within the file system layer. In addition, since the file system layer is largely independent the various open protocols and passes the information on to the storage layer with uniform WORM characteristics, minimal modifications must be made at the storage layer or other layers within the storage operating; system.<br>
It is contemplated that an automatic commit function can be incorporated into<br>
the open protocols according to an alternate embodiment. In particular, due to the<br>
stateful nature of CIFS, a procedure can be implemented that causes a commit to<br>
WdRM upon closing of a created WORM file. That is, the protocol recognizes the<br>
wopoa create dialog and proceeds with a commit (e.g. not-read-only to read-only attrib<br>
ute change) when the file is closed. This is more challenging in a stateless protocol<br>
sucih as NFS. However, NFSv4 supports a number of stateful operations and may pro<br>
vide a ready platform for automatic commit like CIFS. Other protocols may also be<br>
provided with automatic commit upon file closure.	•<br>
In another alternate embodiment, it is contemplated that further modifications can be made to the open protocols to accommodate a WORM-diretstory. In one implementation, only WORM files may have access to the worm directory. To this end, a<br>
".worm" file extension is provided so as to allow a user to view all files having a worm<br>
commit. An advantage to committing an entire directory atomically, b one transaction,<br>
is that it limits problems resulting from a partial commit of files that niay be followed<br>
by a crash or other interruption before the remaining files are committed. There may<br>
arise inconsistencies as result of the partial commit when the later files are finally<br>
committed.  In yet another alternate embodiment, any section of a filo can be written<br>
only once. Thus, an automatic commit mechanism can be employed, which would al<br>
low data to be appended to an existing file or to fill any "holes" in the; file, but would<br>
disallow attempted modifications to the existing written data in the file. Such a so<br>
called "incremental WORM commit" lends itself to applications like a WORM log file<br>
in which existing records in the file are WORM, but new records may be appended to<br>
the file end in the "unwritten" space.	<br>
It is also contemplated that WORM volume activity, such as volume creation and volume destruction (if permitted), WORM file writess etc, can bs detected and logged to the administrator via the Simple Network Management Protocol (SNMP). The filer can include a log or maintenance file and SMMP can use traps to detect this activity, In this manner a log of all WORM activity can be maintained, further facilitating data integrity and maintenance and audit of data access, e.g., for law enforcement or internal security purposes,<br>
E.       Mirroring and Replication Considerations<br>
;      As described briefly above, certain snapshot restoration furnitions may need to be disabled. Byway of background, Fig. 7 details a synchronous mirroring procedure 700 in which WORM volume data 702 is transmitted to a destination volume 706 in real-time as it is created and stored on the source WORM volume 7'04. The transmission generally occurs over a high-speed link 710 using a transport protocol (Fibre<br>
i<br>
Channel, iSCSI, etc.) capable of supporting a high-speed, real-time data transfer from source to destination. In essence, the mirror is another disk array, being filled at the same time as the source. Hence, whatever enters the source volurre, also enters the mirror destination volume. Since the majority of the mirror function is handled at the storage (RAID) layer, little intervention from the higher level file system on the source 'is needed.<br><br>
Before the destination volume is used, it is first created on the destination storage system- In one embodiment, a mirror volume, or other structure, is automatically created via the RAID level in the same filer or file server as the source* It transfers all the WORM functionality from the source to the destination in this instance. Creation of the destination volume is typically accomplished by act of an administrator using an appropriate volume create command. Typically, the destination volume is created as a WORM volume, requiring that the backup storage system, upon whicb the destination volume resides, have a file system that includes the WORM functionality. By using a WORM mirror volume, the integrity of the stored data is further protected and it complies with the general requirements for secure backup storage. It is possible and may sometimes be desirable to establish a non-WORM destination volume, but such a volume may violate rules for secure backup store.<br>
Because the destination volume is a WORM volume, any interruption in the mirroring process may be irreparable. In the event of an interruption, the system may be required to reinitialize the mirror including transferring all stored records, i.e., a level zero transfer to a newly created destination volume.<br>
As with other mirror processes to be described herein, the WORM nature of the source may impose limits on the reconstruction of a source from a dfjstination (e.g. a restore process) in the event of a disaster. Since WORM files in the source WORM volume are, by definition, non-rewritable, the preferred procedure to repair the source volume is to replace it with the mirrored destination volume. Partia, reconstruction of the source using the destination may be prohibited. In general, however, this is a minimal disadvantage in a synchronous mirroring approach since tie destination is pre-smhed to always contain the most up-to-date version of the source find can be easily<br>
'	i<br>
swapped, m its entirety, for the source if necessary.<br>
•      Fig. 8 shows a simplified diagram of an asynchronous mirroring procedure 800. This approach is described in detail in the above-incorporated U.S. Patent Application Serial No. 10/100,967, entitled SYSTEM AND METHOD FORT DETERMINING CHANGES IN TWO SNAPSHOTS AND FOR TRANSMITTING CHANGES TO A DESTINATION SNAPSHOT by Michael L. Federwisch, etaL, and should be referenced in conjunction with the following description.<br>
The file system of the source volume 802 is adapted to generate time-separated point-in-time images or "snapshots" (280 in Fig. 2) of the source volume data structure or the data structures of certain sub-volumes (for example q-4rees). Note that one such sub-volume can be a worm (a ".worm" extension, for example) directory structure as described above. In accordance with the above-incorporated reference, the snapshots are scanned by the asynchronous snapshot mirroring application to detect changes in files based upon noted differences between snapshots taken at different times. After establishment of an appropriate WORM volume at a destination 804, the changes are transmitted in a formatted data stream 806 over a conventional (typically lower-speed) network connection 810—that may include the well-known Internet. Because of the lower-speed connection, the changes are not generally changes occinTing in real-time, but are written to the destination "asynchronously" or in lazy write fashion at periodic intervals.<br>
In order to facilitate transfer of data from the source WORM volume 802 to the destination WORM volume in an asynchronous transfer, the data is formatted as a series of metadata (in the form of modes in one embodiment) and associated file data. To make this data meaningful to the destination file system, it is formatted using recognizable headers that separate various portions of the data transfer (e.g. metadata versus file data) and that signal which type of data transfer is occurring. Certain headers are also provided that stand alone and include information such as deleted fie lists. Fig. 9 details a simplified version of the header described in detail in the above-referenced Fed-erwisch, et cd. application. This header includes a generic part 902 of 1KB, a non-generic part 904 of 2 KB and an expansion segment 906 of 1 KB.  folded to the generic part 902 is a worm volume transfer flag 908 that signals the destination file system that WORM volume information is being transmitted in the data strean i to follow. This flag is located in the "public" portion of the header so as to be recognized by open protocols.<br>
Similarly, as shown in Fig. 10, each data file 1000 in the stream contains a WORM flag bit 1002. This bit, in combination with the header information is used to reconstruct new modes (metadata) in the destination WORM volume with an appropriate WORM state information about the file (or other data set/data container) to which<br><br>
the indde/metadata points. The destination file system's mirroring application is adapted to translate the encoded flags appropriately. More specific details regarding the procedure by which modes are constructed in the destination volume are provided in the'above-referenced application.<br>
In a further embodiment, it is contemplated that security between a source and destination file server may be enhanced by employing conventional encryption and/or authentication techniques or other security-enhancing measures in orc.erto establish a trust relationship between the source and destination. In such an implementation it is contemplated that certain restoration functions otherwise considered undesirable, may be employed with, safety.<br>
As described above with reference to WORM file creation in Figs 5 and 6, a retention period may be set in connection with a WORM file (or otfujr data set/data container). This retention period basically sets a file attribute before commit of the file to WORM that causes the system to observe all WORM properties described above (no deletion, modification, etc.) for the WORM file during the applicable retention period, but after expiration of the period allows the user to perform a limited set of non-W0RM actions on the now-expired WORM file. Namely, the expired WORM file may be deleted from the WORM volume, thereby freeing space for new storage.<br>
Fig. 11 shows a generalized procedure 1100 for setting retejition periods (with the effective date/time after the period elapses being termed a "retention date") in connection with WORM files. A file, intended to be stored as WORM, is initially created or; copied onto the worm volume (step 1102) as described generally in step 504 (for exemplary Windows® systems) and/or step 604 (for exemplary Unbt® systems). Either the administrator or user interactively sets a retention date using a client-based interface or other utility as described above, or the appropriate application sets the date based upon predetermined rules (step 1104). The utility determines whether the.retention period falls within an acceptable range. As described below, the peiod may be limited based upon the number of bits available in a given attribute. In addition, a minimum retention date may be specified. Assuming the period fells withir. the acceptable range,<br>
f<br>
then the period is accepted (decision step 1105). Otherwise, the period may be rejected<br><br>
and the system returns an invalid value error code. If the user or administrator opts for no period or the period is not a valid one, this is interpreted by the utility as a default value retention period (step 1110). The nature of this default value may depend upon a<br>
I<br>
variety of factors. For example, where the WORM volume is based upon an "enterprise" model with a relatively trusted administrator, the default may be f et to an arbitrarily defined value, or an infinite value or zero (no retention period), as appropriate. Similarly, where the default is based upon a strict regulatory regime, there may be a minimum or infinite retention period, defined by the applicable rules and practice, assigned to the file by default. Note that, where an infinite value is defined, a particular bitcode is written hi the property or attribute to signify an indefinite retention period,<br>
such as zero.<br>
i Note that in certain WORM regulatory regimes, a minimum retention date may<br>
be specified. Thus, rather than setting an infinite date, a finite rninknu tn default retention date can be specified should no date be provided by the user. Thin may also depend upon the nature of the WORM volume into which the file is storud. Some volumes may be set to a regulatory or "government regulation" default setting where the system, hi absence of a valid retention date, defaults to a minimum retention period Conversely, some volumes may be set to an "enterprise" default environment wherein the administrator is trusted and the rules provide more leniency in assigning retention dates. In tills instance, absence of a retention date may be presumed no assign an indefinite date or a particular finite date based upon the rules governing the particular enterprise WORM volume.<br>
Having received a valid retention period value (or no period), the procedure 1 lOf) queries the metadata file attributes or properties to determine the last modified time on the file (step 1106). In one embodiment, the last modified date is used as the bas£ data from which the retention date is computed. The last modified date is fixed oncie the file is committed to WORM—the file cannot be modified Jifter commit, given the recognition in a WORM volume of a read-only as a WORM.  In step 1106, the queried last-modified tune, prior to commit is the creation or copy time for the file. The last modified data is just one possible basis for the computation of retention date. A variety of other base time values that are considered reliable (such as a direct query<br>
of the compliance clock 279 or another trusted clock (e.g. a client clock) can be employed |n alternate embodiments.<br>
Having received a valid non-infinite retention period, the procedure then attempts to ensure that the period is sufficiently far in the future to account for clock skew and other factors that may affect the reporting of time by the compliance clock 279 (Fig. 2). According to decision step 1108, the retention period must be set to a minimum future time value following the last-modified time (for example one or two days in the future). Otherwise, the system assumes a default retention period is to be applied (step 1110).<br>
Once a retention period is chosen (finite or infinite), the procedure 1100 computes the time value to be observed in determining the data at which the file is to be released from WORM (step 1112). This entails adding the retention period time (for example, "retain file for 10 years") to the last modified time, and thereby deriving a future release date for the file.<br>
This computed retention date/time value is then applied to the last access time property or attribute in the file (step 1114). This attribute is also rarely, if ever, used in a WORM context, and even in a non-worm context, is not particularly critical. For example, in a Windows® environment, the majority of files are accessed each time the system is booted, making this attribute less informative for actual "access" of a given file. Accordingly, the last access time property/attribute is used by th s WOBM utility as the vehicle to store the critical retention date bitcode (if any).<br>
;   Having applied a retention date into the last access time field, the file can now be made immutable. Accordingly the read-only attribute us set as de:$cribed above, causing the WORM utility to refuse any further modifications to the ale. Likewise, the file's attributes/properties including last access time are fixed. In this manner the future retention date is fixed in the last access time field, and made immutable.<br>
i<br>
!<br>
There are circumstances hi which the retention period must be extended after initially setting it. For example, if a file or record destined for expireition becomes a subject of an investigation it may need to be retained indefinitely beyond the normal expiration date. Accordingly, the WORM utility includes provision for a limited modi-<br>
fication of the committed WORM file's properties to account for the extension of a retention period. Fig. 12 details a retention date/tune extension procedure 1200. A user or administrator typically initiates a request to extend the retention period of a particular file (step 1202). As with the initial setting of the retention date, the extension period date must fell within a value that is supported by the last access time fieUL If so, the procedure then queries the last access time to retrieve the existing field v ilue (step 1204).<br>
Decision step 1206 verifies that the requested date or period is further in the future than the existing date. If not the request to extend is denied. Conversely, if the request is for an extension sufficiently far ahead in the future, then a new extended retention date/time is computed (step 1212). The computation can occur in. a variety of ways. For example, die extended data can be based upon either the creation time or the last modify time where the new extended period is added to these value;. Alternatively., the extended retention date can be computed by adding the last access time value (tile current retention date/time) and the new extended period are added to compute the new extended retention date/time. In any of the above examples, if the extended period is infinite, then an appropriate representation for the indefinite retention period is computed. Note that once a period is made indefinite or permanent, ft cannot be later reduced (per steps 1206,1208 and 1210). Finally, in step 1214, the WO.'tM utility overrides the normal prohibition against any modification of the subject WORM file and allows the limited overwrite of the last access time property to contain the new computed extended retention date value (or indefinite retention indicator).<br>
As discussed herein, certain older open protocols, such as the commonly used NFSv2 and v3 use a 32-bit time format that is interpreted as seconds since January 1, 1970i(e.g. "time 0"). If interpreted as an unsigned value, this expression provides a last access time up to February 7,2016. However, many operating systems interpret this -time lvalue as a signed 32-bit integer that restricts the date range to an effective 31-bit value and impose an upper bound to time values of January 18,2038*. Hence, while future implementations will undoubtedly all support virtually unlimitsd date ranges (such as CEFS and NFSv4), current implementations must account for a somewhat Km-<br>
fted upper bound in date ranges that may be unacceptable in the long-tern storage of certain files.<br>
Thus, in order to support an extended range for record retention dales, given fee current recognition of only a 31-bit signed value, the WORM utility has been adapted to remap certain date values into an arbitrarily time-shifted regime. la this manner, the WORM utility is provided with a new, more contemporary baseline tinie or epoch (new time 0), of, for example, January 1,2003. However, rather than offsetting the entire time range to this new baseline, the WORM utility interprets (see timeline 1300 Fig. 13) last access times before January 1,2003 (new time zero) differently than those after January 1,2003. lathis manner all retention dates falling between new time zero and January 18,2038 (old upper bound) are retained as standard values (3 l-bft Date Range 1). However, since any last access time value that is a time before new time zero would fell before the effective date for the WORM system, these dates are reinterpreted or wrapped around (arrow 1301)) as an upper range of dates (31-bit Date Range 2) between January 18,2038 and January 1,2071. Together, the two 31-bit date ranges (before new time 0 and after new time 0) provide an overall 32-bit retention date range 1302 to a new exemplary upper bound of January 1,2071.<br>
Clearly, a variety of solutions to a limited bit range for time values can be employed. In addition, where sufficiently long time values can be applied to the last access attribute, a time-remapping technique is not needed<br>
i<br>
In order to track time values so that WORM files can be released at the proper expiration date/time, a secure compliance clock 279 (Fig. 2) is provided to the storage operating system. Hie compliance clock interacts with various aspects of the storage operating system as well as the WORM utility to generate a time va!.ue that is reliably targeted to provide the desired retention date over a typical retention period.<br>
An exemplary compliance clock 279 in accordance with an illustrative embodiment is shown in Fig. 14. The clock is typically implemented sis a software, rather than hardware mechanism. The clock includes a time value generator 1402 that receives a consistent pulse from a regularly-scheduled, continuous filer event 1404 such as a consistency point operation (CP), The generator 1402 has a scaling function that translates the CP or other event into a time-based value. For example, if a CP occurs<br>
every 11 seconds, the clock translates each CP into an 11-second advance in the time-base. A counter in the generator 1402 keeps a running total of events from which an ongoing date/time value 1410 is produced and output to the WORM utility and other interested components of the system. The generator receives its base time value (for example, time 0) and can store its running total time in an appropriate memory element. In practice, the time memory can be periodically committed to persistent storage using, for example, an on-disk record in, for example, an undeletable WORM file 1414 on the associated WORM volume. In general, this also means that the compliance clock travels with the WORM volume rather than the underlying filer. This file is accessed in the event of a system crash, failure, or replacement/upgrade of the filer. Thus, on boot-up of the filer, the clock file for each WORM volume is read and, as an added safety measure, the earliest clock time is selected as the value for the filer's overall compliance clock in its WORM operations. Where a new filer is deployed, that may have faster cycle time than the previous model used for the particular WO1&amp;M volume, the compliance clock generator 1402 is updated to account for this change in the timebase and the elapsed time count from the file 1414 is loaded to begin the count again with the new scale still outputting the desired accurate time count.<br>
While system downtime and other factors may cause a shift cr skew hi the compliance clock's reported time versus actual time (e.g. Greenwich Main Time and Date), this shift/skew can be accounted for by interfacing the compliance clock with another clock, such as the filer's system clock  As shown in Fig. 14, the compliance clock 279 can be provided with an input from the conventional system hardware/software system clock (or another generally trusted clock) 1416 from which it can compare its reported time to the allegedly actual time. This comparison can be both on art absolute basis (e.g: current reported date/time versus system reported date/time) and based upon the relative passage of time (e.g. number of seconds elapsed for the system clock versus the compliance clock). It is assumed that hi most deployments the hardware system clock will, in fact, be synchronized to a valid true time source. In order to decrease the skew of the compliance clock in relation to the hardware system clock, the compliance clock performs the described incremental counts of periodic events (CPS for example), but also "drifts" toward the hardware system clock time at a strictly bounded rate. This "bounded drifting" allows the compliance clock to track or lock onto the system hard-<br>
ware clock time to counteract the compounding of the clock skew over long periods of time. The bounded drift rate 1418 ensures, even if the administrator £.djuststhe clock forward by, for example 10 years, in an effort to prematurely delete WORM records, that the compliance clock drifts so slowly toward this new time as to make the subversion attempt ineffective. By way of example, if an allowable drift rate of only ±1000 seconds per year is permitted (Le. the compliance clock can "drift" by no more than 1000 seconds backward or forward during a 1-year period), then even if the system clock is (wrongly) set forward by 1 year, the compliance clock could take hundreds of years to skew by 1 year.<br>
As a further safety measure, if the compared values of the system clock and the compliance clock are sufficiently out of synchronization, then an alert can be issued to the administrator or a supervisor/regulator. In addition all alerts c an be logged to persistent/WORM storage in association with the volume and clock :!Ue. Given such an alert, appropriate action by authorities can be taken. Also, during an alert period, any deletion or modification of files could be disabled. Each of these ab ave-described features enhances the relatively tamper-proof nature of the compliance clock according to an illustrative embodiment. Similarly, a secure hardware clock or trusted third party (for example, government-based) clock can also provide a high degiee of tamper protection.<br>
While an exemplary compliance clock has been described at&gt;ove, a variety of mechanisms and techniques involving external, internal or a combination of internal and external time-keeping procedures are expressly contemplated. For example, an external master clock, such as a government-based atomic clock interconnected by a network can be employed.<br>
When a client attempts to manually delete a given file, or an appropriate application daemon process sweeps the volume to find and delete files, toe system must determine whether the retention date for a given file has expired and deletion thereof is permitted. Fig. 15 shows a generalized procedure for checking WC'RM retention dates and, when appropriate allowing limited unlocking of WORM status, from an expired file.<br>
According to step 1502, a user or administrator either request* action on a subject worm file (such as deletion), or an application daemon scans the file for possible deletion. At this point, the WORM utility queries the last access timt! attribute for the subject file. This is stored and the compliance clock is queried for the trusted date/time (step 1504).<br>
According to decision step 1506, if the retention date is not greater than or equal to the clock date (or some minimum future date after the clock date for further skew protection), then the requestor is prevented from taking any action on the file (step 1508). Naturally, where an indefinite retention date is set, it is never less than the clock date and action Is never permitted by the utility,<br>
.   Conversely, where the retention date is less than or equal to the compliance clock date (or dock date plus a "safety" margin), then the decision step 1506 branches to step 1510, and the user or administrator is permitted to take limited action on the file, or action is automatically taken. In an illustrative embodiment, that action is typically limited only to deletion of the file from the volume, however other file-handling options may be permitted for an enterprise model WORM implementation. In this manner,, other actions that may tamper with the integrity of the file white leaving it intact are Still prevented, Typically the read only-attribute that committed the file to WORM is retained while, in combination with an expired date enables a return to the limited file permission of deletion. The utility thus places only a dltion permission on the expired WORM file.<br>
As described above, a client can implement an automatic deletion of expired-retention-date files via operation of an application daemon or similar utility. In general, use; of a compliance or trusted clock to provide a reliable reference u&gt; expiration of retention dates facilitates an automatic deletion process. That is, the deletion can occur in an "automatic" manner based upon periodic scans of the volume (sue step 1502) to locate expired files—those with retention dates greater than or equal to the trusted clock time. To this end, a recent trusted clock time can be stored in system memory and compared to the time in each file to locate the expired ones. Alternatively, the retention, date of each file can be read and then a current clock time can be retrieved and compared. Deletion can occur on each file in turn after expiration is confirmed, or all ex-<br>
-37-<br>
pired files can be identified by the scan and deleted thereafter in a batch process. These files are then deleted by the application using appropriate file management scripts. While the daemon describe herein typically runs on the client, it is expressly contemplated that an automatic deletion process, based upon a trusted dock oan be implemented on either the client side, the file server side or both.<br>
Note that in an alternate embodiment the WORM filer or file server described herein can be implemented as a multi-protocol storage appliance and the resident storage operating system can be implemented as a virtualization system i vith virtualization modules embodied as a virtual disk ("vdisk") module and a SCSI target module (not shown). The vdisk module is layered on the file system 250 to enable access by administrative interfaces, such as a streamlined user interface (UI), in response to a system administrator issuing commands to the multi-protocol storage appliance. In es-' sence, the vdisk module manages SAN deployments by, among other tilings, implementing a comprehensive set of vdisk logical unit number (lun) commands issued through the UI by a system administrator. These vdisk commands are converted to primitive file system operations ("primitives") that interact with the file system 250 and the SCSI target module to implement the vdisks. This multi-protocol storage appliance arrangement is described in further detail in commonly owned U.S. Patent Application Serial No. 10/216,453, entitled STORAGE VIRTUALIZATION BY LAYERING VIRTUAL DISK OBJECTS ON A PILE SYSTEM, the teachings of which are expressly incorporated herein by reference. Since a lun can be represented in the storage system as a file, it is expressly contemplated that the various permissions and attributes that ascribe a WORM state to a file and allow it to have a set retention date can be applied to a lim structure.<br>
Note that, while open protocols are typically used to implenwsnt the WORM and , retention date functionalities of.the illustrative embodiment, it is expressly contemplated that proprietary protocols or significantly modified versions of open protocols<br>
:	*<br>
such as, for example, proprietary APIs can be use to implement various WORM features f this invention. For example, in an alternate embodiment, proprietary APIs can be used to implement retention dates. These can be combined with the trusted or compliance clock as described herein to ensure reliable retention and tamper-proof opera-<br>
tion. la addition, when used in conjunction with a trusted clock as described variously herein, it is expressly contemplated that the term "storage system" can include a content addressable storage system (CAS) as described generally above. Such a trusted clock could enhance reliability and tamper-proof operation of these types storage systems.<br>
The foregoing has been a detailed description of illustrative embodiments of the invention. Various modifications and additions can be made without departing from the spirit and scope of the invention. For example, while the retenlio:i date/time values associated with each data container, set or file are provided within a last accessed property field in an itostratiyeembodhnent, it js expre sjy ttnte<br>
lated thattins value can be applied to any property, attribute or other data associated with the container, set or<br>
file that can be made immutable and that does not interfere with the raanagement and<br><br>
handling of the container, set or file during its storage in WORM. In addition, while a file's retention date/time is set or extended according to an illustrative embodiment by querying the last modified date and adding the retention period thereto, a variety of base time values can be used to compute the retention date/time including, for example, the retrieval of a base time from the compliance clock or another trusted time source. Likewise, the internal architecture of the servers or their respective storage arrays, clients, as well as their network connectivity and protocols, are all highly variable. The operating systems used on various source and destination servers can differ. In addition, it is expressly contemplated that any of the operations and procedures described herein can be implemented using hardware, software comprising a computer-readable medium having program instructions executing on a computer, or a combination of hardware and software. Accordingly, this description is meant to be taken only byway of example and not to otherwise limit the scope of this invention.<br><br><br><br><br><br>
We Claim<br>
1.	A method for automatically deleting records stored in a data structure of a write-once-<br>
read-many (WORM) storage system, where the data structure in the WORM storage<br>
system is stored across one or more rewritable storage devices (160), comprising:<br>
establishing retention dates (505, 605) for predetermined records in the data structure;<br>
characterized by the steps of<br>
scanning the data structure and comparing (1504) the retention dates to a time value of a trusted clock (279), the trusted clock providing a reliable time, thereby enhancing tamper-proof operation of the storage system; and<br>
automatically deleting (1510) each of the records with a retention date that is equal to or earlier than the trusted clock time.<br>
2.	The method as claimed in claim 1, wherein the steps of scanning, comparing and automatically deleting are performed by a process running on a client (170, 172) interconnected to the storage system.<br>
3.	The method as claimed in claim 1, wherein the trusted clock (279) generates the time value based upon a periodic process running on the storage system and that persistently stores the time value in the data structure at predetermined times.<br>
4.	The method as claimed in claim 3, wherein the trusted clock (279) receives a time input from another clock and adjusts the time value at a bounded drift rate to approach a value of the time input.<br>
5.	The method as claimed in claim 4, wherein the another clock comprises a trusted third-party clock.<br>
6.	The method as claimed in claim 1, comprising comparing the another clock time input and the time value and issue an alert if the another clock time input and the time value differ by more than a predetermined value.<br>
7.	The method as claimed in claim 2, wherein the alert causes the storage system to prevent modification of all data sets in the storage system.<br>
8.	A write-once-read-many (WORM) storage system configured to store records in a write-once-read-many configuration comprising:<br>
one or more rewritable storage devices (160) configured to store the records of the<br>
WORM storage system; and<br>
an application program interface for applying a respective retention date in the form of<br>
metadata to each of the records;<br>
characterized by<br>
a trusted clock (279), the trusted clock providing a reliable time, thereby enhancing<br>
tamper-proof operation of the storage system, the trusted clock being separate from a<br>
system hardware clock and being used to unlock WORM features on each of the records<br>
when a respective retention date expires, wherein unlocking of the WORM features of<br>
allows deletion of each record.<br>
9.	The WORM storage system as claimed in claim 8, wherein the storage system comprises a cluster of interconnected computers and is a content addressable storage system.<br>
10.	The WORM storage system as claimed in claim 8, wherein the trusted clock (279) is a compliance clock, comprising:<br>
a counter that counts a plurality of repetitive events in the storage system and assigns a time value relative to a count of the events; and<br>
a generator that compares the count to an external clock time input and that adjusts the time value based upon the external clock time input based upon a bounded drift rate between the external clock input and the time value.<br>
11.	The WORM storage system as claimed in claim 10, wherein the generator is configured<br>
to compare the external clock time input and the time value and issue an alert if the<br>
external clock time input and the time value differ by more than a predetermined value.<br>
12.	The WORM storage system as claimed in claim 11, wherein the alert causes the storage system to prevent modification of all data sets in the storage system.<br>
13.	The WORM storage system as claimed in claim 10, wherein the external clock comprises a trusted third-party clock.</file></ftle></fik></date></sharename></mnriber></volname></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LUFic3RyYWN0LSgyNy0wNC0yMDExKS5wZGY=" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-Abstract-(27-04-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LWFic3RyYWN0LnBkZg==" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-abstract.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LWFzc2lnbm1lbnQucGRm" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-assignment.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LUNsYWltcy0oMTEtMDQtMjAxNCkucGRm" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-Claims-(11-04-2014).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LUNsYWltcy0oMjctMDQtMjAxMSkucGRm" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-Claims-(27-04-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LWNsYWltcy5wZGY=" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-claims.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LUNvcnJlc3BvbmRlbmNlIE90aGVycy0oMDMtMDQtMjAxNCkucGRm" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-Correspondence Others-(03-04-2014).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LUNvcnJlc3BvbmRlbmNlIE90aGVycy0oMTEtMDQtMjAxNCkucGRm" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-Correspondence Others-(11-04-2014).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1ERUxOUC0yMDA2LUNvcnJlc3BvbmRlbmNlIE90aGVycy0oMTYtMDgtMjAxMSkucGRm" target="_blank" style="word-wrap:break-word;">2477-DELNP-2006-Correspondence Others-(16-08-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1ERUxOUC0yMDA2LUNvcnJlc3BvbmRlbmNlIE90aGVycy0oMTctMDgtMjAxMSkucGRm" target="_blank" style="word-wrap:break-word;">2477-DELNP-2006-Correspondence Others-(17-08-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LUNvcnJlc3BvbmRlbmNlLU90aGVycy0oMjctMDQtMjAxMSkucGRm" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-Correspondence-Others-(27-04-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LWNvcnJlc3BvbmRlbmNlLW90aGVycy0xLnBkZg==" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-correspondence-others-1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LWNvcnJlc3BvbmRlbmNlLW90aGVycy5wZGY=" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-correspondence-others.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LWRlc2NyaXB0aW9uIChjb21wbGV0ZSkucGRm" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-description (complete).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LURyYXdpbmdzLSgyNy0wNC0yMDExKS5wZGY=" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-Drawings-(27-04-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LWRyYXdpbmdzLnBkZg==" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-drawings.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LUZvcm0tMS0oMjctMDQtMjAxMSkucGRm" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-Form-1-(27-04-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LWZvcm0tMTgucGRm" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-form-18.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LUZvcm0tMi0oMjctMDQtMjAxMSkucGRm" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-Form-2-(27-04-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LWZyb20tMS5wZGY=" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-from-1.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LWZyb20tMi5wZGY=" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-from-2.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LWZyb20tMy5wZGY=" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-from-3.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LWZyb20tNS5wZGY=" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-from-5.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LUdQQS0oMDMtMDQtMjAxNCkucGRm" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-GPA-(03-04-2014).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LUdQQS0oMjctMDQtMjAxMSkucGRm" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-GPA-(27-04-2011).pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LWdwYS5wZGY=" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-gpa.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LXBjdC0zMDEucGRm" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-pct-301.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LXBjdC0zMDQucGRm" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-pct-304.pdf</a></p>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/pdfviewer.aspx?AppNo=MjQ3Ny1kZWxucC0yMDA2LXBjdC0zMDgucGRm" target="_blank" style="word-wrap:break-word;">2477-delnp-2006-pct-308.pdf</a></p>
		<br>
		<div class="pull-left">
			<a href="260507-a-method-of-establishing-cryptographic-session-key.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="260509-cassette-containing-growth-medium.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>260508</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>2477/DELNP/2006</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>19/2014</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>09-May-2014</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>02-May-2014</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>03-May-2006</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>NETWORK APPLIANCE,INC</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>495 EAST JAVA DRIVE, SUNNYVALE, CA 94089, UNITED STATES OF AMERICA,</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>WILLIAM P. MCGOVERN</td>
											<td>1555 GARDEN GLEN WAY, SAN JOSE, CA 95125,USA</td>
										</tr>
										<tr>
											<td>2</td>
											<td>JEFFREY L. HELLER</td>
											<td>904 THERESA COURT, MENLO PARK, CA 94025, USA,</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>G06F</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>PCT/US2004/012378</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td>2004-04-22</td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>10/701,373</td>
									<td>2003-11-03</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/260508-method-for-automatically-delleting-records-stored-in-a-data-structure-of-a-write-once-read-many-storage-system by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 00:33:04 GMT -->
</html>
