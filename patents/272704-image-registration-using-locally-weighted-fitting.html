<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from www.allindianpatents.com/patents/272704-image-registration-using-locally-weighted-fitting by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 00:48:59 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Patents. 272704:IMAGE REGISTRATION USING LOCALLY-WEIGHTED FITTING</title>
    <meta content="authenticity_token" name="csrf-param" />
<meta content="cYcP52B8zyTWKbLwby2YPh9z/gvY/RLjWOwY4YXkiXg=" name="csrf-token" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.1/html5shiv.js" type="text/javascript"></script>
    <![endif]-->

    <link href="../assets/application-e80cf34975c5b1730c80b2f7170e7d26.css" media="all" rel="stylesheet" type="text/css" />

  </head>
  <body>

    <div class="navbar navbar-fluid-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../index.html">Indian Patents</a>
          <div class="container-fluid nav-collapse">
            <ul class="nav">
              <li><a href="../recently-granted.html">Recently Granted Patents</a></li>
              <li><a href="../recently-published.html">Recently Published Patents</a></li>
            </ul>
            <form id="gform" class="navbar-search pull-right" action="https://www.google.com/search" method="get" target="_blank" onsubmit="document.getElementById('gform').q.value='site:http://www.allindianpatents.com '+document.getElementById('gform').q.value">
                <input type="text" name="q" id="q" class="search-query" placeholder="Search" onclick="this.value=''" autocomplete="off">
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span12">

          <style>
          .allindianpatents-top { width: 320px; height: 50px; }
          @media(min-width: 500px) { .allindianpatents-top { width: 468px; height: 60px; } }
          @media(min-width: 800px) { .allindianpatents-top { width: 728px; height: 90px; } }
          </style>
          <center>
          </center>
          
          <div class="row-fluid">
	<div class="span8">

		<table class="table">
			<tr>
				<th>Title of Invention</th>
				<td><h1 style="font-size:large;">IMAGE REGISTRATION USING LOCALLY-WEIGHTED FITTING</h1></td>
			</tr>
			<tr>
				<th>Abstract</th>
				<td>A computer-implemented method for image registration includes accepting a three-dimensional (3-D) image of an organ. The image includes a first plurality of image points with respective image coordinates. A map defining a distribution of values of a physiological parameter over the organ is accepted. The map includes a second plurality of map points with respective map coordinates. Confidence levels are associated with one or more of the map coordinates and image coordinates. Weights are assigned to at least some of the map points and image points responsively to the confidence levels of the respectively map coordinates and image coordinates. The 3-D image is fitted with the map by calculating a geometrical transformation between the map coordinates and the image coordinates based on the weights.</td>
			</tr>
		</table>

					<style>
					.allindianpatents-post-abstract { width: 320px; height: 50px; }
					@media(min-width: 880px) { .allindianpatents-post-abstract { width: 468px; height: 60px; } }
					@media(min-width: 1267px) { .allindianpatents-post-abstract { width: 728px; height: 90px; } }
					</style>
					<center>
					<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- AllIndianPatents-post-abstract -->
					<ins class="adsbygoogle allindianpatents-post-abstract"
					     style="display:inline-block"
					     data-ad-client="ca-pub-7914358224572760"
					     data-ad-slot="9152759240"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>					
					</center>

		<table class="table">
			<tr>
				<th>Full Text</th>
				<td>IMAGE REGISTRATION USING LOCALLY-WEIGHTED FITTING<br>
FIELD OF THE INVENTION<br>
The present invention relates generally to medical imaging and mapping, and particularly to methods and systems for registering maps of physiological parameters with three-dimensional (3-D) images.<br>
BACKGROUND OF THE INVENTION<br>
In various medical applications, a computer-generated reconstruction of body parts or organs is displayed to a user. For example, U.S. Patent 6,456,867, whose disclosure is incorporated herein by reference, describes a method of reconstructing a map of a volume. The method includes determining coordinates of locations on a surface of the volume, and generating a grid , of points defining a reconstruction surface in 3-D space in proximity to the determined locations . For each of the points on the grid, a respective vector is defined dependent on a displacement between one or more of the points on the grid and one or more of the locations. The reconstruction surface is then adjusted by moving substantially each of the points on the grid responsive to the respective vector, so that the reconstruction surface is deformed to resemble the configuration of the surface.<br>
In some applications, images from multiple modalities, or imaging sources, are fitted with one another and presented . For example, U.S. Patent 5,568,384, whose disclosure is incorporated heroin by reference, describes a method for synthesizing 3-D multimodality image sets into a single composite image.<br><br><br>
Surfaces are initially extracted from two or more different images to be matched using semi-automatic segmentation techniques. The surfaces are represented as contours with common features to be matched. A distance transformation is performed for one surface image, and a cost function for the matching process is developed using the distance image. The geometric trans formation includes three-dimensional translation, rotation and scaling to accommodate images of different position, orientation and size. The matching process involves searching the multi-parameter space and adjusting a surface or surfaces to find the best fit among them, which minimizes the cost function.<br>
SUMMARY OF THE INVENTION<br>
Some medical methods and systems measure and present a map showing the distribution of a certain physiological parameter across an imaged organ. For example, an electro-anatomical map showing the distribution of local electrical potentials across the endocardium (the inner surface of the heart) is useful in various cardiological procedures .<br>
It is sometimes desirable to display the parameter map together with a 3-0 image of the organ, such as a Magnetic Resonance Imaging (MRI), Computerized Tomography (CT) , X-ray or ultrasound-based image. In order to jointly display the map and 3-D image, the two views of the organ should first be registered to a common coordinate system. In some cases, the coordinates of the parameter map and/or the 3-D image may have varying<br>
2<br><br>
confidence levels. Points or areas of the map or image having low confidence levels may have an adverse effect on the accuracy of the registration process.<br>
In order to improve the accuracy of the registration process, embodiments of the present invention provide methods and systems for registering a parameter map with a 3-D image while taking into account the varying confidence levels of the map coordinates and/or image coordinates. The Â¦ 3-D image typically comprises a plurality of image points with respective image coordinates. In some embodiments, the image points define a 3-D solid volume model, surface model or 3-D wire-frame . model of the imaged organ or parts thereof. In some embodiments, weights are assigned to the map points and image points responsively to confidence levels of the map and image coordinates. The map and the 3-D image are then fitted together by calculating and applying a geometrical, transformation based on the weights .<br>
In some exemplary embodiments described herein, the parameter map is obtained using a magnetic position tracking system. In these embodiments, a probe, such as a catheter, is fitted with a sensor, such as an electrode, which measures the physiological parameter at different locations in the imaged organ. The position tracking system is used to track the coordinates of the probe when making the measurements, so as to produce a map indicating a distribution of the parameter values across the organ.<br>
3<br><br>
There is therefore provided, , in accordance with an embodiment of the present invention, a computer-implemented method for image registration, including:<br>
accepting a three-dimensional (3-D) image of an organ, the image including a first plurality of image points with respective image "coordinates;<br>
accepting a map defining a distribution of values of a physiological parameter over the organ, the map including a second plurality oil map points with respective map coordinates;<br>
associating respective confidence levels with one or more of the map coordinates and image coordinates;<br>
assigning weights to at least some of the map points and image points responsively to the confidence levels of the respective map coordinates and image coordinates; and<br>
fitting the 3-D image with the map by calculating a geometrical transformation between the map coordinates and the image coordinates based on the weights.<br>
In an embodiment, accepting the map includes measuring the values of the physiological parameter at the respective map coordinates using a position tracking system. Measuring the Values and the map coordinates may include moving a probe including a position sensor and a sensor measuring the physiological parameter over multiple locations in the organ, and performing respective multiple measurements of the physiological parameter and of a position of the position sens or at the locations.<br>
In another embodiment, the method includes superimposing the values of the physiological parameter<br><br>
onto the 3-D image using the geometrical transformation, and displaying the superimposed values and 3-D image to a user.<br>
In yet another embodiment, fitting the 3-D image with the map includes; defining, distances between at least some of the image points and respective map points, applying the weights assigned to the respective map points and image points to the distances to produce weighted distances, and calculating a cumulative weighted distance metric based on the distances, the metric indicative of an accuracy of the geometrical transformation in fitting the 3-D image with the map.<br>
In still another embodiment, applying the weights includes multiplying a square of the distances by the respective weights to produce the weighted distances, and calculating the cumulative weighted distance metric includes summing the weighted distances.<br>
In an embodiment, fitting the 3-D image with the map Further includes modifying the geometrical transformation so as to minimize the cumulative weighted distance<br>
metric.<br>
In another embodiment, fitting the 3-D image with the map includes identifying an anatomical landmark external to the organ that appears in the 3-D image, acquiring a respective map point at a "location of the anatomical landmark, and registering an image coordinate of the anatomical landmark in the 3-D image with a map coordinate of. the acquired map point.<br>
5<br><br>
In yet another embodiment, associating the confidence levels includes accepting the confidence levels from a user. Additionally or alternatively, associating the confidence levels includes automatically determining the confidence levels based on the map points and image points. Automatically determining the confidence levels may include detecting a distortion in at least one of the map coordinates and image coordinates and assigning the confidence levels responsively to a level of the distortion. Additionally or alternatively, automatically determining the confidence levels includes assigning the confidence levels responsively to at least one of:<br>
a density of the respective one or more of the map coordinates in the map;<br>
an electrical tissue characteristic in a vicinity of the respective map coordinates and image coordinates ;<br>
a physiological tissue charactaristic in the vicinity of the respective map coordinates and image coordinates;<br>
a distance of the respective map coordinates and image coordinates from a registration landmark identified in both the map and the 3-D image; and<br>
a physiological characteristic of the registration landmark.<br>
In an embodiment, accepting the 3-D image includes accepting at least one of a solid model, a surface model and a wire-frame model of the organ defined by at least some of the image points .<br>
6<br><br>
There is additionally provided, in accordance with an embodiment of the present invention, apparatus for image registration, including:<br>
an interface, which is arranged to accept a three-dimensional (3-D) image of an organ, the image including a first plurality of image points with respective image coordinates, and to further accept a map defining a distribution of values of a physiological parameter over the organ, the map including a second plurality of map points with respective map coordinates; and<br>
a processor, which is arranged to associate respective confidence levels wil;h one or more of the map coordinates and image coordinates, to assign weights to at least some of the map points and image points responsively to the confidence levels of the respective map coordinates and imago coordinates, and to fit the 3-D imago with the map by calculating a geometrical transformation between the map coordinates and the image coordinates based on the weights.<br>
There is also provided, in accordance with an embodiment of the present invention, a computer software product for image registration, the product including a computer-readable medium in which instructions are stored, which instructions, when road by a computer, cause the computer to accept a pre-acquired three-dimensional (3-D) image of an organ, the, image including a first; plurality of image points with respective image coordinates, to accept a map defining a distribution of values of a physiological parameter over the organ, the map including a second plurality of map points with respective map coordinates, to associate respective<br>
7<br><br>
confidence levels with one or more of the map coordinates and image coordinates, to assign weights to the map points and image points responsively to the confidence . levels of the respective map coordinates and image coordinates, and to fit the 3-D image with the map by calculating a geometrical transformation between the map coordinates and the image coordinates based on the weights.<br>
The present invention will be more fully understood from the following detailed description of the embodiments thereof, taken together with the drawings in which:<br>
BRIEF DESCRIPTION OF THE DRAWINGS<br>
l:'.i.g. 1A is a schematic, pictorial, illustration of a system for magnetic position tracking, in accordance with an embodiment of the present invention ;<br>
Fig. 1B is a block diagram that; schematically illustrates a display processor, in accordance with an embodiment of the present invention;<br>
Fig. 2 is a schematic, pictorial illustration of: a catheter, in accordance with an embodiment of the present invention ;<br>
Figs. 3A and 3B are diagrams that schematically illustrate an electro-anatomical map projected onto a three-dimensional (3-D) image of a heart, in accordance with an embodiment of the present invention; and<br>
Fig . 1 is a flow chart that schematically illustrates a method for registering an electro-<br>
8<br><br>
anatomical map with a pre-acquired 3-D image, in accordance with an embodiment of the present invention.<br>
DETAILED DESCRIPTION OF EMBODIMENTS<br>
SYSTEM DESCRIPTION<br>
Fig. 1A is a schematic, pictorial illustration of a magnetic position tracking system 20 for imaging and mapping a heart 24 of a patient, in accordance with an embodiment of the present invention. The system of Fig. 1A serves to demonstrate an exemplary system, which can be used to obtain and present parameter maps. Although the embodiments described herein mainly refer to electro-anatomical maps obtained using a magnetic position tracking system, parameter maps can bo obtained using any other means known in the art, such as using ultrasonic or impedance-based tracking systems. Exemplary impedance-based tracking systems are described in U.S. Patents 5,983,126, 6,456,864, and 5,944,022, and in U.S. Patent Application 11/030,934, filed January 7, 2005, whose disclosures are incorporated heroin by reference .<br>
In system 20, a catheter 28 is inserted by a physician into a chamber of heart 2A through a vein or artery. System 20 determines and displays the position and orientation coordinates of catheter 28. Although the embedments described hereinbelow mainly refer to imaging of the heart, the methods and systems described herein can be used to image any suitable organ. Thus, in the context of the present invention and in the claims, the term "organ" is used to describe any imaged body part or tissue, which may comprise entire organs or parts the roof .<br>
9<br><br>
System 20 comprises field generators, such as field generating coils 30, which are located in fixed, known positions external to the patient. Coils 30 generate magnetic fields in a predefined working volume around heart 24. A position sensor fitted in the distal end of catheter 28 senses the magnetic fields in its vicinity.<br>
The position sensor produces and transmits, in response to the sensed fields, position signals to a console 34. The console comprises a tracking processor 36 that calculates the location and orientation of catheter 28 with respect to coils 30, based on the position signals sent by the position sensor. The location and orientation coordinates of catheter 28 are displayed to the physician using a display 44.<br>
system 20 comprises a display processor A2., which accepts the in forma t;:i on measured by t;he position tracking system, as well as externally-supplied pre-acquired 3-D images. Display processor 42 registers the parameter map with the pre-acquired 3-D image, and presents the registered map and image to the physician, as will be explained be low .<br>
Fig. 1B is a block diagram that schematically illustrates details of display processor 42, in accordance with an embodiment of the present invention. Processor 42 comprises an external interface 4b, which accepts the pro-acquired 3-D image and parameter map. Processor 42 also comprises a registration processor 4 6, which performs the registration methods described herein<br>
10<br><br>
and outputs the registered 3-D image and parameter map to display 44. Processor 42 interacts with a user, such as a physician, using a user input device 4 7, such as a keyboard, mouse or trackball. As noted above, display processor 42 can accept 3-D images and parameter maps from any suitable system or source.<br>
Typically, tracking processor 36 and display processor 42 comprise general-purpose computers, which are programmed in software to carry out the functions described herein. The software may be downloaded to the processors in electronic form, over a network, for example, or it may alternatively be supplied to the processors on tangible media, such as CD-ROM. Processors 36 and 42 may be standalone units. Alternatively, the functions of processors 36 and 42 may be combined with one another or integrated with other elements of system 20.<br>
Fig. 2 is a schematic, pictorial illustration of the distal end of catheter 28, in accordance with an embodiment of the present invention. Catheter 28 comprises a position sensor 50, which senses the magnetic fields generated by coils 30. In addition, catheter 28 comprises an electrode 52, which senses a physiological parameter in its vicinity.<br>
For example, in some embodiments electrode 52 senses the local electrical potential in its vicinity. In these embodiments, the distal end of catheter 28 is brought in close proximity to various points on the endocardium (the inner surface of the heart,) . Electrode 52 is then used to<br>
11<br><br>
sense the local electrical potentials on the endocardial surface. In alternative embodiments, catheter 28 may comprise . one or more electrodes 52 for sensing any other suitable physiological parameters, such as temperature and pressure. In some embodiments, the catheter may be fitted with a chemical sensor for sensing a particular chemical composition in its vicinity.<br>
Position sensor 50 and electrode 52 are connected to console 34 using suitable cables 54 running through catheter 28, or using a wireless connection (not shown}. Tracking processor 36 associates the measured location coordinates of catheter 2 8 with the parameter measured by electrode 52. Thus, by moving the catheter through a plurality of locations in the heart, the physician is able to obtain a three-dimensional map of the parameter.<br>
In the exemplary configuration of Figs. 1A and 2, f:or example, system 2 0 obtains and displays an electro-anatomical map showing the distribution of local electrical potentials across the endocardiac surface . Such electro-anatomical mapping can be used for detecting and/or predicting various heart disorders and for planning related medical procedures, such as ablation. In alternative embodiments, other types of electrodes and sensors can be used to obtain maps of other parameters of interest. Typically, the parameter map comprises a plurality of map points. Each map point comprises a particular value of the parameter and is associated with a respective map coordinate.<br>
12<br><br>
The system configuration of Figs. 1A and 2 is an exemplary configuration chosen for the sake of conceptual clarity. The methods described herein can be used in conjunction with any other suitable position tracking system or method. Some systems and methods for magnetic position tracking are described, for example, in PCT Patent Publication WO 96/05768, U.S. Patents 5, 391,199, 5,44 3,489, 6,690,963, 6,239,724, 6,618,612 and 6,332,08 9, and U.S. Patent Application Publications 2002/0065455 Al, 2 003/012 0150 Al and 2004/0068178 Al, whose disclosures are all incorporated herein by reference. As noted above, parameter maps may alternatively be produced using any other suitable method or system.<br>
REGISTRATION OF PARAMETER MAPS WITH IMAGES<br>
In some practical cases, it is desirable to display The parameter map projected onto a 3-D image of the mapped organ . In most, cases, the 3-D image is acquired in advance, prior to The mapping procedure, and is thus referred to as a "pro-acquired" image. Alternatively, the 3-D image may be acquired concurrently with the mapping process or afforwards . In any case, dual -modality display, combining map and image information, generally improves the physician's understanding of the parameter map. For example, features of interest in the imaged organ can be easier to locate and examine using such common display.<br>
The 3-D image may originate from a Magnetic Resonance Imaging (MRI) system, a Computerized Tomography (CT) system, an X-ray imaging system, an ultrasonic<br>
13<br><br>
imaging system or any other suitable imaging system or<br>
source. Since the map and the 3-D image originate from<br>
different systems generally having different coordinate<br>
systems, the two views of the imaged organ should be<br>
registered, or fitted with one another, before they are<br>
displayed.	<br>
Typically, the 3-D image is represented and provided<br>
to display processor 42 as a plurality of image points.<br>
Each image point comprises a value (e.g., grey level or<br>
color). and is associated with a respective image<br>
coordinate. In some cases, the imaged organ or parts<br>
thereof may be represented in the 3-D image as a solid<br>
volume model, surface model or wire-frame: model defined<br>
by at least part of the image points. In the context of<br>
the present patent application and in the claims, the<br>
term "image points" is used to describe any suitable<br>
representation of the 3-D image, such as various<br>
volumetric, surface and wire-frame representations<br>
defined by the image points. The registration methods<br>
described herein can be used to register parameter maps<br>
with 3-D images having any such representation. The 3-D<br>
image is typically provided to display processor 42 as a<br>
data file and may be provided using any convenient<br>
digital means, such as a network connection or a magnetic<br>
storage device, or using analog means such as a frame<br>
grabber.<br>
The process of registering the parameter map with the 3-D image can be formulated as a task of finding a geometrical transformation that best fits the map with the 3-D image. Such a geometrical transformation may<br>
14<br><br>
comprise translation, rotation and/or scaling of the image coordinates, so as to best fit the map. Alternatively, the geometrical transformation can be equivalently defined as fitting the parameter map onto the 3-D image, or transforming both map and image to an arbitrary reference coordinate system. The methods described below can be used to determine any such geometrical trans formation.<br>
In some embodiments, one of the two modalities used comprises a real-time modality, whereas the other modality comprises a non-real-time modality. For example, a parameter map measured in real-time by a position tracking system can be registered with a pre-acquired MRI or CT image. In such embodiments, it is often preferable, although not mandatory, to define the geometrical transformation as translatinq the coordinate system of the non-real-time modality to the coordinate system of the real-time modality.<br>
The quality of the registration process is often evaluated by a cumulative distance metric that quantifies the distance between the map and the 3-D image. For<br>
example, in some embodiments, each map point denoted Mi is associated with a corresponding image point denoted Ii. The distance between map point Mi and its<br>
corresponding image point Ii is denoted di . Distance di<br>
typically denotes a three-dimonsional. Euclidean distance calculated between the coordinates of the map point and image point. An exemplary cumulative distance metric is given by<br><br><br>
wherein 1 sums over the pairs of corresponding map points and image points. The registration of: the map with the 3-D image thus comprises determining a geometrical transformation that minimizes the cumulative distance metric D.<br>
In some cases, however, the coordinates of the map points and/or image points have varying confidence levels regarding the accuracy of the location of the point in question. For example, some areas of the parameter map may have a high density of map points, resulting in a higher confidence level. Other areas of the map may have fewer map points, often causing a lower confidence Level.<br>
Confidence levels can also be assigned in response to a distortion detected in the map or in the 3-D image (e.g., in specific image points or in areas of the solid, surface or wire-frame representation of the 3-D image ) . For example, areas of the map exhibiting high variance of the coordinate values may be assumed to contain a higher Level, of measurement noise, and consequently have a lower confidence level in comparison with smoothly-varying areas. Additionally or alternatively, an area of the imaged organ known to be characterized by high temporal variations (i.e., an area whose shape changes significantly and/or rapidly over time) can also be considered to have a lower confidence level.<br>
1 6<br><br>
The distortion in the map may also comprise a deformation in the geometrical shape of an area of the map, in comparison with the corresponding area in the 3-D image. Some exemplary methods, which can be used for determining areas of low confidence, level in a measured map are also described in U.S. Patent 6,456,867, cited above. Additionally or alternatively, the assignment of confidence levels to map points can be based on any other suitable criterion or combination of criteria.<br>
Image points or areas of the 3-D image may also have varying confidence levels related to their location accuracy. For example, areas of the 3-D image may have a wrong segmentation (e.g., an area of the organ missing from the image or remains of other organs or organ parts combined with the target organ). Some areas of the 3-D image may have lower spatial or temporal resolution.<br>
Map points and/or image points having low confidence levels can introduce errors into the geometrical transformation, resulting in a non-optimal registration. Therefore, it can be appreciated that taking the confidence levels into account when evaluating the geometrical transformation can significantly improve the quality of the registration. Areas of low confidence level can be prevented from distorting the transformation, and areas of higher confidence can be emphasized.<br>
In order to reduce the effect of map and image points having low confidence levels, the methods described herein assign weights to the map and/or image<br>
17<br><br>
points responsively to their confidence levels. The weights are then applied to the distances summed to provide the cumulative distance metric. The resulting metric is referred to as a weighted cumulative distance metric. Typically, the weights are proportional to the confidence levels so that map and image points having low confidence levels are assigned lower weights, and vice versa.<br>
For example, in some embodiments, each map point Mi<br>
is assigned a weight denoted Wi based on the confidence<br>
level of the map point. In these embodiments, an exemplary weighted cumulative distance metric is given by<br><br>
Al terns Lively, other suitable cumulative distance metrics based on weights applied to the distances can also bo used. Determining a geometrical transformation that minimizes the weighted cumulative distance metric provides a high accuracy registration of the parameter map with the pro-acquired 3-D image, taking into account the varying confidence levels of the map and image points.<br>
In some embodiments, the registration process can utilize anatomical landmarks located outside the organ. In those embodiments, the physician identifies one or more anatomical features outside the organ that appear in the 3-D image, to be used as registration landmarks, or anchors . For example, when mapping the heart, the physician may choose a point or points on the aorta, such<br>
18<br><br>
as the bifurcations of the major vessels from the aortic<br>
arch. As another example,	the physician may choose the<br>
ostium of the inferior	or superior vena cava. The<br>
physician then maneuvers	catheter 28 so that its tip<br>
contacts the feature in	question, and indicates the<br>
corresponding location, on	the pre-acqu:i red 3D image on<br>
display 44 .<br>
By registering the landmark, the physician effectively identifies a map point and a corresponding image point that are known to match one another. When using the aorta or vena cava as landmarks, the physician may register the landmark while inserting the catheter through the blood vessel into the heart. As a result:, the electro-anatomical map is already pre-registered with the pre-acquired 3-D image when catheter 28 enters the heart to begin the mapping procedure.<br>
Weights can be assigned either automatically by the system or manually by the user. In some embodiments, manual weight assignment can be performed at any time during the procedure. automatic weight assignment may depend on the tissue properties in the re Levant area. When external landmarks are used, the weight assignment may depend on the distance of the landmark from the map or image point in question. For example, a landmark in the inferior vena cava can be automatically assigned a lower weight due to its sof:t and floppy nature and its distance from the left atrium.<br>
Figs . 3A and 3B are diagrams that schematically illustrate the process of registering an electro-<br>
1 9<br><br>
anatomical map 56 with a three-dimensional (3-D) image 58 of the left atrium and associated blood vessels, in accordance with an embodiment of the present invention. Image 58 comprises a segmented pre-acquired image of the left atrium and pulmonary veins produced by a CT scanner.<br>
Fig. 3A shows the map and 3-D image before the registration process. As can be seen in the figure, the map and 3-D image are not registered to a common coordinate system and generally have translation, rotation and scaling offsets with respect to one another.<br>
Map 56 comprises an electro-anatomical map obtained using a catheter and a magnetic position tracking system, as described above. The map comprises a plurality of map points 60, each map point having a Local activation value (expressed in milliseconds) in relation to a reference annotation, and a respective map coordinate. The different local activation values are shown in the figure using different shading patterns. Sites in which the physician already performed radio frequency (RF) ablation are marked with round circles.<br>
The 3-D image comprises a plurality of image points 62, each having a respective imago coordinate. Four anatomical. landmarks denoted LAA, MPV, LIPV and MVA are identified both in map b6 and in 3-D image 58. The four landmarks respectively indicate the locations of the left atr;i al appendage, the medial pulmonary vein, the loft inferior. pulmonary vein arid the mitral valve annulus. Note that all landmarks reside outside the target organ, i.e., outside the left atrium.<br>
2{)<br><br>
Fig. 3B shows map 5 6 and 3-D image 5 8 after the registration process is performed, in accordance with the method of Fig. 4 below. As can be seen in the figure, the map and 3-D image are now registered with a common coordinate system and displayed together.<br>
REGISTRATION METHOD DESCRIPTION<br>
Fig. 4 is a flow chart that schematically illustrates a method for registering an electro-anatomical map with a pre-acquired 3-D image, in accordance with an embodiment of the present invention. The method of Fig. 4, carried out by display processor 42, takes into account varying confidence levels in the parameter map and/or 3-D image by assigning different weights l;o different: map and image points when evaluating and minimining a weighted cumulative distance metric.<br>
The method begins with processor 42 accepting a pre-acquired 3-D image of the organ, at an image acceptance sl:ep 70. The 3-D image is represented by a plurality of image points 62 and associated coordinates. As noted above, at least part of the image points may in some cases define a 3-D solid, surface or wire-frame model of! the imaged organ or parts thereof. Processor 42 further accepts an electro-anatomical. map of the organ, at a map acceptance step 72. In some embodiments, the map is produced by magnetic position tracking system 2.0, as described above. The map is represented by a plurality of map points 60 and associated coord mates . The 3-D image<br>
21<br><br>
and parameter map are accepted using interface 45 and provided to registration processor A 6 .<br>
For at least some of the map points and/or image points, registration processor 46 determines confidence levels of the corresponding map and/or image coordinates, at a confidence assignment step 74. In some embodiments, some or all of the confidence levels are indicated to processor 46 by the physician or by another user. For example, the physician may review the map and/or 3-D image displayed on display 44 and mark areas or points of low or high confidence level using input device 47.<br>
Additionally or alternatively, some or all of the confidence levels related to the map can be automatically determined by the system that produced the map (e.g., the position tracking system) during or after performing the location measurements, and provided to processor 46 along with the electro-anatomical map. Further additionally or alternatively, some or all of the confidence levels can be calculated automatically by processor 46 using the map and/or 3-D image, based on different criteria , such as the criteria described above .<br>
Processor 4 6 calculates a geometrical trans formation that best fits the map with the 3-D image, at a transformation calculation step 76. As described above, each map point is associated with a respective image point, and a distance is defined between the two points based on their coordinates. Jin order to reduce the effect of map and/or image points having low confidence levels and increase the effect of map and/or image points having<br>
2?.<br><br>
high confidence levels, processor 4 6 assigns weights to the distances, based on the confidence levels. Processor 46 evaluates a weighted cumulative distance metric, such as the metric given in equation [2] above.<br>
Processor 4 6 determines a geometrical transformation that minimizes the weighted cumulative distance metric, thus best fitting the map with the 3-D image, at a registration step 78. The resulting geometrical transformation typically comprises a combination of translation, rotation and/or scaling operations applied to either the map coordinates, the image coordinates, or to both. The registered map and 3-D image are then displayed to the physician using display 44, such as shown in Fig. 3B above.<br>
A i. though the embodiments described herein refer mainly to a cardiac imaging system that uses a catheter equipped with a potential-sensing electrode, the methods described herein can be used in conjunction with any other suitable system that produces maps comprising measured parameters associated with coordinates . The parameter may be measured cither locally or remotely. For example, a catheter flitted with an ultrasonic sensor and a position sensor can be used to produce maps of physiological. parameters such as tissue density. Those parameter maps can be registered with pre-acquired 3-D images using the methods described hereinabove .<br>
Additionally or alternatively, the sensor measuring<br>
the parameter can be fitted in any other suitable<br>
intrabody probe, such as an endoscope . Further<br>
'A3<br><br>
additionally or alternatively, the measurement of the parameter may be performed using an external sensor, such as an external ultrasonic transducer. The methods described herein can be used to process images and parameter maps of any other suitable organ, tissue or parts thereof, such as the aorta (AAA) , coronaries, spine, neurological or any other cavity in which minimal invasive procedures are performed .<br>
It will thus be appreciated that the embodiments described above are cited by way of example, and that the present invention is not limited to what has been particularly shown and described hereinabove . Rather, the scope of the present invention includes both combinations and sub-combinations of the various features described hereinabove, as well as variations and modifications thereof which would occur to persons skilled in the art upon reading the foregoing description and which are not disclosed in the prior art.<br><br>
CLAIMS<br>
1. A computer-implemented method for image registration, comprising:<br>
accepting a three-dimensional (3-D) image of an organ, the image comprising a first plurality of image points with respective image coordinates;<br>
accepting a map defining a distribution of values of a physiological parameter over the organ, the map comprising a second plurality of map points with respective; map coordinates ;<br>
associating respective confidence levels with one or more of the map coordinates and image coordinates;<br>
assigning weights to at least some of the map points and image points responsively to the confidence levels of; the respective map coordinates and image coordinates; and<br>
fitting the 3-D image with the map by calculating a geometrical transformation between the map coordinates and the image coordinates based on the weights.<br>
?. . The method according to claim 1, wherein accepting the map comprises measuring the values of the physiological parameter at the respective map coordinates using a position tracking system.<br>
3. The method according to claim 2, wherein measuring the values and the map coordinates comprises moving a probe comprising a position sensor and a sensor measuring the physiological parameter over multiple locations in the organ , and performing respective multiple<br><br>
measurements of the physiological parameter and of a position of the position sensor at the locations.<br>
4.	The method according to claim 1, and comprising<br>
superimposing the values of the physiological parameter<br>
onto the 3-D image using the geometrical transformation,<br>
and displaying the superimposed values and 3-D image to a<br>
user.<br>
5. The method according to claim 1, wherein fitting the<br>
3-D image with the map comprises defining distances<br>
between at least some of the image points and respective<br>
map points, applying the weights assigned to the<br>
respective map points and image points to The distances<br>
to produce weighted distances, and calculating a<br>
cumulative weighted distance metric based on the<br>
distances, the metric indicative of an accuracy of the<br>
geometrical transformation in fitting the 3-D imago with<br>
the map.<br>
6. The method according to claim 5, wherein applying<br>
the weights comprises multiplying a square of the<br>
distances by the respective weights to produce the<br>
weighted distances, and wherein calculating the<br>
cumulative weighted distance metric comprises summing the<br>
weighted distances.<br>
7. The method according to claim .5, wherein fitting the<br>
3-D image with the map further comprises modifying the<br>
26<br><br>
geometrical transformation so as to minimize the cumulative weighted distance metric.<br>
8. The method according to claim 1, wherein fitting the<br>
3-D image with the map comprises identifying an<br>
anatomical landmark external to the organ that appears in<br>
the 3-D image, acquiring a respective map point at a<br>
location of the anatomical landmark, and registering an<br>
image coordinate of the anatomical landmark in the 3-D<br>
image with a map coordinate of the acquired map point.<br>
9. The method according to claim 1, wherein associating<br>
the confidence levels comprises accepting the confidence<br>
levels from a user.<br>
10 . The method according to claim 1, wherein associating the confidence levels comprises automatically determining the confidence Levels based on the map points and image points.<br>
11. The method according to claim 10, wherein automatically determining the confidence levels comprises detecting a distortion in at least one of the map coordinates and image coord i nates and assigning the confidence Levels responsively to a level of the distortion.<br>
12 . The method according to claim 10, wherein automatically determining the confidence levels comprises<br>
71<br><br>
assigning the confidence levels responsively to at least-one of :<br>
a density of the respective one or more of the map coordinates in the map;<br>
an electrical tissue characteristic in a vicinity of the respective map coordinates and image coordinates ;<br>
a physiological tissue characteristic in the vicinity of the respective map coordinates and image coordinates;<br>
a distance of the respective map coordinates and image coordinates from a registration landmark identified in both the map and the 3-D image; and<br>
a physiological characteristic of the registration landmark.<br>
.1.3 . The method according to claim 1 , wherein accepting the 3-D image comprises accepting at least one of a solid model , a surface model and a wire-frame model, of the organ defined by at least some of the image points.<br>
14 . Apparatus for image registration, comprising:<br>
an interface, which is arranged to accept a three-dimensional. (3-D) image of an organ the image comprising a first plurality of image points with respective image coordinates, and to further accept a map defining a distribution of values of a physiologyical parameter over the organ, the map comprising a second plurality of map points with respective map coordinates ; and<br>
a processor, which is arranged to associate respective confidence layers with one or more of the map<br>
2 8<br><br>
coordinates and image coordinates, to assign weights to at least; some of the map points and image points responsively to the confidence levels of the respective map coordinates and image coordinates, and to fit the 3-D image with the map by calculating a geometrical transformation between the map coordinates and the image coordinates based on the weights.<br>
15 . The apparatus according to claim 14, wherein the interface is arranged to accept the map from a position tracking system, which measures the values of the physiological parameter at the respective map coordinates.<br>
16. The apparatus according to claim 14, wherein the position tracking system comprises a probe comprising a position sensor and a sensor measuring the physiological! parameter, which is moved over multiple locations in the organ so as to perform respective multiple measurements of the physiological parameter and of a position of the position sensor at the locations.<br>
17. The apparatus according to claim 14 , wherein the processor is further arranged to superimpose the values of the physiological parameter onto the 3-D imago using the geometrical transformation and to display the superimposed values and 3-D image to a user.<br>
29<br><br>
18. The apparatus according to claim 14, wherein the<br>
processor is arranged to define distances between at<br>
least some of the image points and respective map points,<br>
to apply the weights assigned to the respective map<br>
points and image points to the distances to produce<br>
weighted distances, and to calculate a cumulative<br>
weighted distance metric based on the distances, the<br>
metric indicative of' an accuracy of the geometrical<br>
transformation in filting the 3-D image with the map.<br>
19. The apparatus according to claim 18, wherein the<br>
processor is arranged to multiply a square of the<br>
distances by the respective weights to produce the<br>
weighted distances, and to sum the weighted distances to<br>
produce the cumulative weighted distance metric .<br>
70. The apparatus according to claim .18, wherein the processor is arranged to fit the 3-D image with the map by modifying the geometrical transformation so as to minimize the cumulative weighted distance metric.<br>
2X . The apparatus according to claim 14, wherein the processor is arranged to accept an identification of an anatomical landmark external to the organ that appears in the 3-D image and of a respective map point acquired at a location of the anatomical landmark, and to register an image coordinate of the anatomical landmark in the 3-D image with a map coordinate of the acquired map point.<br>
3 0<br><br>
22 . The apparatus according to claim 14, wherein the processor is arranged to accept the confidence levels from a user via the interface.<br>
23. The apparatus according to claim 14, wherein the processor is arranged to automatically determine the confidence levels based on the map points and image points.<br>
20. The apparatus according to claim 14, wherein the processor is arranged to detect a distortion in at least one of the map points and image points and to assign the confidence . levels responsively to a level of the distortion .<br>
25. The apparatus according to claim 14, wherein the processor is arranged to assign the confidence levels responsively to at least one of:<br>
a density of the respective one or more or the map coordinates in the map;<br>
an electrical tissue characteristic in a vicinity of the respective map coordinates and image coordinates ;<br>
a physiological tissue characteristic in the vicinity of the respective map coordinates and image coordinates;<br>
a distance of the, respective map coordinates and image coordinates from a registration landmark identified in both the map and the 3-D image; and<br>
a physiological characteristic of the registration landmark .<br>
31 <br><br>
26.	The apparatus according to claim 14, wherein the 3-D<br>
image comprises at least one of a solid model, a surface<br>
model and a wire-frame model of the organ defined by at<br>
least some of the image points.<br>
27.	A computer software product for image registration,<br>
the product comprising a computer-readable medium in<br>
which instructions are stored, which instructions, when<br>
read by a computer, cause the computer to accept a pre-<br>
acquired three-dimensional (3-D) image of: an organ, the<br>
image comprising a first plurality of" image points with<br>
respective image coordinates, to accept a map defining a<br>
distribution of values of a physiological parameter over<br>
the organ, the map comprising a second plurality of map<br>
points with respective map coordinates, to associate<br>
respective confidence levels with one or more of the map<br>
coordinates and image coordinates, to assign weights to<br>
the map points and image points responsively to the<br>
confidence levels of the respective map coordinates and<br>
image coordinates, and to fit the 3-D image with the map<br>
by calculating a geometrical transformation between the<br>
map coordinates and the image coordinates based on the<br>
weights .<br><br><br>
32<br><br><br>
A computer-implemented method for image registration includes accepting a three-dimensional (3-D) image of an organ. The image includes a first plurality of image points with respective image coordinates. A map defining a distribution of values of a physiological parameter over the organ is accepted. The map includes a second plurality of map points with respective map coordinates. Confidence levels are associated with one or more of the map coordinates and image coordinates. Weights are assigned to at least some of the map points and image points responsively to the confidence levels of the respectively map coordinates and image coordinates. The 3-D image is fitted with the map by calculating a geometrical transformation between the map coordinates and the image coordinates based on the weights.<br><br><br><br></td>
			</tr>
		</table>	
		<br>
		<h3>Documents:</h3>
				<p><a href="http://ipindiaonline.gov.in/patentsearch/GrantedSearch/viewdoc.aspx?id=4x9M6LEUF9WyZPeYrSVBKQ==&amp;amp;loc=wDBSZCsAt7zoiVrqcFJsRw==" target="_blank" style="word-wrap:break-word;">http://ipindiaonline.gov.in/patentsearch/GrantedSearch/viewdoc.aspx?id=4x9M6LEUF9WyZPeYrSVBKQ==&amp;amp;loc=wDBSZCsAt7zoiVrqcFJsRw==</a></p>
		<br>
		<div class="pull-left">
			<a href="272703-a-method-for-encrypting-a-wireless-transmission-and-a-communication-device.html">&laquo; Previous Patent</a>
		</div>
		<div class="pull-right">
			<a href="272705-method-of-establishing-a-hrpd-signal-link.html">Next Patent &raquo;</a>
		</div>			
	</div><!-- /span8 -->
	<div class="span4">
		<div class="well infobox">
			<table class="table table-condensed">
				<tr>
					<th>Patent Number</th>
					<td>272704</td>
				</tr>
				<tr>
					<th>Indian Patent Application Number</th>
					<td>379/KOL/2007</td>
				</tr>
				<tr>
					<th>PG Journal Number</th>
					<td>17/2016</td>
				</tr>
				<tr>
					<th>Publication Date</th>
					<td>22-Apr-2016</td>
				</tr>
				<tr>
					<th>Grant Date</th>
					<td>21-Apr-2016</td>
				</tr>
				<tr>
					<th>Date of Filing</th>
					<td>14-Mar-2007</td>
				</tr>
				<tr>
					<th>Name of Patentee</th>
					<td>BIOSENSE WEBSTER, INC.</td>
				</tr>
				<tr>
					<th>Applicant Address</th>
					<td>3333 DIAMOND CANYON ROAD, DIAMOND BAR, CA 91765.</td>
				</tr>
				<tr>
					<td colspan=2>
								<h5>Inventors:</h5>
								<table class="table">
									<tr>
										<th>#</th>
										<th>Inventor's Name</th>
										<th>Inventor's Address</th>
									</tr>

										<tr>
											<td>1</td>
											<td>ASSAF PREISS</td>
											<td>30 YUVALIM ST., SHIMSHIT 17906.</td>
										</tr>
										<tr>
											<td>2</td>
											<td>ZIV KITLARO</td>
											<td>MOSHAV AVIEL, M.P. MENASHE 37835.</td>
										</tr>
										<tr>
											<td>3</td>
											<td>ZAFRIR PATT</td>
											<td>HABANIM 13, RAMAT-HASHARON 47216.</td>
										</tr>
										<tr>
											<td>4</td>
											<td>ROY TAL</td>
											<td>KASHTAN 2, HAIFA 34984.</td>
										</tr>
								</table>
					</td>
				</tr>
				<tr>
					<th>PCT International Classification Number</th>
					<td>A61B 005/00</td>
				</tr>
				<tr>
					<th>PCT International Application Number</th>
					<td>N/A</td>
				</tr>
				<tr>
					<th>PCT International Filing date</th>
					<td></td>
				</tr>
				<tr>
					<td colspan=2>
						<h5>PCT Conventions:</h5>
						<table class="table">
							<tr>
								<th>#</th>
								<th>PCT Application Number</th>
								<th>Date of Convention</th>
								<th>Priority Country</th>
							</tr>

								<tr>
									<td>1</td>
									<td>11/385,060</td>
									<td>2006-03-21</td>
								    <td>U.S.A.</td>
								</tr>

						</table>
					</td>
				</tr>
			</table>
		</div><!-- /well -->
	</div><!-- /span4 -->
</div><!-- /row-fluid -->

        </div>

      </div><!--/row-->

      <footer class="footer">

        <style>
        .allindianpatents-footer { width: 320px; height: 50px; }
        @media(min-width: 500px) { .allindianpatents-footer { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .allindianpatents-footer { width: 728px; height: 90px; } }
        </style>
        <center>
        </center>

        <p>&copy; All Indian Patents, 2013-2021.</p>
        <p>Patent data available in the public domain from Indian Patents Office, Department of Industrial Policy and Promotions, Ministry of Commerce and Industry, Government of India.</p>
      </footer>

    </div> <!-- /container -->

    <!-- Javascripts
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/application-95f297ff0d8d2015987f04b30593c800.js" type="text/javascript"></script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
    var sc_project=8902313; 
    var sc_invisible=1; 
    var sc_security="3c1f8147"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="web stats"
    href="http://statcounter.com/free-web-stats/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/8902313/0/3c1f8147/1/"
    alt="web stats"></a></div></noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-244143-31', 'allindianpatents.com');
      ga('send', 'pageview');

    </script>

  </body>

<!-- Mirrored from www.allindianpatents.com/patents/272704-image-registration-using-locally-weighted-fitting by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Apr 2024 00:49:00 GMT -->
</html>
